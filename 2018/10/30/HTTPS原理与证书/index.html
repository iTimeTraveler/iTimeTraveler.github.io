<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>httpsåŸç†ä¸è¯ä¹¦ç”Ÿæˆ | iTimeTraveler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="HTTPS" />
  
  
  
  
  <meta name="description" content="HTTPSHTTPSä¸HTTPæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸‹HTTPä¸HTTPSçš„è¯·æ±‚è¿‡ç¨‹ï¼š  HTTPS åœ¨ TCP å’Œ HTTP ä¹‹é—´å¢åŠ äº† TLSï¼ˆTransport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨ï¼‰ï¼Œæä¾›äº†å†…å®¹åŠ å¯†ã€èº«ä»½è®¤è¯å’Œæ•°æ®å®Œæ•´æ€§ä¸‰å¤§åŠŸèƒ½ã€‚">
<meta name="keywords" content="HTTPS">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTPSåŸç†ä¸è¯ä¹¦ç”Ÿæˆ">
<meta property="og:url" content="http://github.com/2018/10/30/HTTPSåŸç†ä¸è¯ä¹¦/index.html">
<meta property="og:site_name" content="iTimeTraveler">
<meta property="og:description" content="HTTPSHTTPSä¸HTTPæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸‹HTTPä¸HTTPSçš„è¯·æ±‚è¿‡ç¨‹ï¼š  HTTPS åœ¨ TCP å’Œ HTTP ä¹‹é—´å¢åŠ äº† TLSï¼ˆTransport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨ï¼‰ï¼Œæä¾›äº†å†…å®¹åŠ å¯†ã€èº«ä»½è®¤è¯å’Œæ•°æ®å®Œæ•´æ€§ä¸‰å¤§åŠŸèƒ½ã€‚">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://github.com/gallery/common/https-banner.png">
<meta property="og:updated_time" content="2018-10-31T10:02:47.308Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTPSåŸç†ä¸è¯ä¹¦ç”Ÿæˆ">
<meta name="twitter:description" content="HTTPSHTTPSä¸HTTPæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸‹HTTPä¸HTTPSçš„è¯·æ±‚è¿‡ç¨‹ï¼š  HTTPS åœ¨ TCP å’Œ HTTP ä¹‹é—´å¢åŠ äº† TLSï¼ˆTransport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨ï¼‰ï¼Œæä¾›äº†å†…å®¹åŠ å¯†ã€èº«ä»½è®¤è¯å’Œæ•°æ®å®Œæ•´æ€§ä¸‰å¤§åŠŸèƒ½ã€‚">
<meta name="twitter:image" content="http://github.com/gallery/common/https-banner.png">
  
    <link rel="alternate" href="/atom.xml" title="iTimeTraveler" type="application/atom+xml">
  

  

  <link rel="icon" href="/gallery/avatar/0.jpg">
  <link rel="apple-touch-icon" href="/gallery/avatar/0.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
  <link rel="stylesheet" href="../../../../css/style.css">

  <script src="../../../../js/jquery-3.1.1.min.js"></script>
  <script src="../../../../js/bootstrap.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    <link rel="stylesheet" href="../../../../css/dialog.css">
  

  

  
    <link rel="stylesheet" href="/css/header-post.css" >
  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

</head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 border-width: 0px;  margin-top: 8px;"  
                href="#" data-toggle="modal" data-target="#myModal" >
                  <img width="62px" height="75px" alt="Hike News" src="/gallery/avatar/0.jpg">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="../../../../index.html">é¦–é¡µ</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../archives">å½’æ¡£</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../categories">åˆ†ç±»</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../tags">æ ‡ç­¾</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../funnysite">é…·ç«™</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../collection">æ”¶è—</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../about">å…³äº</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../mybooks">ğŸ</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="è¯·è¾“å…¥å…³é”®è¯..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'æ–‡ç« ',
            PAGES: 'é¡µé¢',
            CATEGORIES: 'åˆ†ç±»',
            TAGS: 'æ ‡ç­¾',
            UNTITLED: '(æ— æ ‡é¢˜)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '../../../../content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="../../../../js/insight.js"></script>

</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-HTTPSåŸç†ä¸è¯ä¹¦" style="width: 75%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="../../../../gallery/common/https-banner.png" rel="gallery_cjnwzz1sf000nj9fypjbezr7e">
        <img src="../../../../gallery/common/https-banner.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      HTTPSåŸç†ä¸è¯ä¹¦ç”Ÿæˆ
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="" class="article-date">
	  <time datetime="2018-10-30T03:08:00.000Z" itemprop="datePublished">2018-10-30</time>
	</a>

      
    <a class="article-category-link" href="../../../../categories/Web/">Web</a>

      
	<a class="article-views">
	<span id="busuanzi_container_page_pv">
		é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>
	</span>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>HTTPSä¸HTTPæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸‹HTTPä¸HTTPSçš„è¯·æ±‚è¿‡ç¨‹ï¼š</p>
<p><img src="/gallery/common/http-state.png" alt="HTTPè¯·æ±‚è¿‡ç¨‹"></p>
<p>HTTPS åœ¨ TCP å’Œ HTTP ä¹‹é—´å¢åŠ äº† TLSï¼ˆTransport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨ï¼‰ï¼Œæä¾›äº†<strong>å†…å®¹åŠ å¯†</strong>ã€<strong>èº«ä»½è®¤è¯</strong>å’Œ<strong>æ•°æ®å®Œæ•´æ€§</strong>ä¸‰å¤§åŠŸèƒ½ã€‚</p>
<p><img src="/gallery/common/https-state.png" alt="HTTPSè¯·æ±‚è¿‡ç¨‹"></p>
<a id="more"></a>
<p>HTTPSä¹Ÿå°±æ˜¯HTTP over SSL/TLSï¼Œæ‰€æœ‰çš„httpæ•°æ®éƒ½æ˜¯åœ¨SSL/TLSåè®®å°è£…ä¹‹ä¸Šä¼ è¾“çš„ã€‚Httpsåè®®åœ¨Httpåè®®çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ äº†SSL/TLSæ¡æ‰‹ä»¥åŠæ•°æ®åŠ å¯†ä¼ è¾“ï¼Œä¹Ÿå±äºåº”ç”¨å±‚åè®®ã€‚æ‰€ä»¥ï¼Œç ”ç©¶Httpsåè®®åŸç†ï¼Œæœ€ç»ˆå…¶å®æ˜¯ç ”ç©¶SSL/TLSåè®®ã€‚</p>
<p><img src="/gallery/common/diagram5-session-resumption.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå‡è®¾æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´å•æ¬¡ä¼ è¾“è€—æ—¶ 28msï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯éœ€è¦ç­‰åˆ° 168ms ä¹‹åæ‰èƒ½å¼€å§‹å‘é€ HTTP è¯·æ±‚æŠ¥æ–‡ï¼Œè¿™è¿˜æ²¡æŠŠå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¤„ç†æ—¶é—´ç®—è¿›å»ã€‚å…‰æ˜¯ TLS æ¡æ‰‹å°±éœ€è¦æ¶ˆè€—ä¸¤ä¸ª RTTï¼ˆRound-Trip Timeï¼Œå¾€è¿”æ—¶é—´ï¼‰ï¼Œè¿™å°±æ˜¯é€ æˆ HTTPS æ›´æ…¢çš„ä¸»è¦åŸå› ã€‚å½“ç„¶ï¼ŒHTTPS è¦æ±‚æ•°æ®åŠ å¯†ä¼ è¾“ï¼ŒåŠ è§£å¯†ç›¸æ¯” HTTP ä¹Ÿä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ï¼Œä¸è¿‡å¯¹ç§°åŠ å¯†æœ¬æ¥å°±å¾ˆå¿«ï¼ŒåŠ ä¸Šç¡¬ä»¶æ€§èƒ½è¶Šæ¥è¶Šå¥½ï¼Œæ‰€ä»¥è¿™éƒ¨åˆ†å¼€é”€è¿˜å¥½ã€‚</p>
<h3 id="TLSå†å²"><a href="#TLSå†å²" class="headerlink" title="TLSå†å²"></a>TLSå†å²</h3><p>ä¼ è¾“å±‚å®‰å…¨åè®®ï¼ˆTransport Layer Securityï¼Œç¼©å†™ï¼šTLSï¼‰ï¼ŒåŠå…¶å‰èº«å®‰å…¨å¥—æ¥å±‚ï¼ˆSecure Sockets Layerï¼Œç¼©å†™ï¼šSSLï¼‰æ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œç›®çš„æ˜¯ä¸ºäº’è”ç½‘é€šä¿¡æä¾›å®‰å…¨åŠæ•°æ®å®Œæ•´æ€§ä¿éšœã€‚</p>
<p><img src="/gallery/common/hpbn_0401.png" alt=""></p>
<p>SSLåŒ…å«è®°å½•å±‚ï¼ˆRecord Layerï¼‰å’Œä¼ è¾“å±‚ï¼Œè®°å½•å±‚åè®®ç¡®å®šäº†ä¼ è¾“å±‚æ•°æ®çš„å°è£…æ ¼å¼ã€‚ä¼ è¾“å±‚å®‰å…¨åè®®ä½¿ç”¨X.509è®¤è¯ï¼Œä¹‹ååˆ©ç”¨éå¯¹ç§°åŠ å¯†æ¼”ç®—æ¥å¯¹é€šä¿¡æ–¹åšèº«ä»½è®¤è¯ï¼Œä¹‹åäº¤æ¢å¯¹ç§°å¯†é’¥ä½œä¸ºä¼šè°ˆå¯†é’¥ï¼ˆSession keyï¼‰ã€‚è¿™ä¸ªä¼šè°ˆå¯†é’¥æ˜¯ç”¨æ¥å°†é€šä¿¡ä¸¤æ–¹äº¤æ¢çš„æ•°æ®åšåŠ å¯†ï¼Œä¿è¯ä¸¤ä¸ªåº”ç”¨é—´é€šä¿¡çš„ä¿å¯†æ€§å’Œå¯é æ€§ï¼Œä½¿å®¢æˆ·ä¸æœåŠ¡å™¨åº”ç”¨ä¹‹é—´çš„é€šä¿¡ä¸è¢«æ”»å‡»è€…çªƒå¬ã€‚</p>
<blockquote>
<p>1994å¹´æ—©æœŸï¼ŒNetScapeå…¬å¸è®¾è®¡äº†SSLåè®®ï¼ˆSecure Sockets Layerï¼‰çš„1.0ç‰ˆï¼Œä½†æ˜¯æœªå‘å¸ƒã€‚<br>1994å¹´11æœˆï¼ŒNetScapeå…¬å¸å‘å¸ƒSSL 2.0ç‰ˆï¼Œå¾ˆå¿«å‘ç°æœ‰ä¸¥é‡æ¼æ´ã€‚<br>1996å¹´11æœˆï¼ŒSSL 3.0ç‰ˆé—®ä¸–ï¼Œå¾—åˆ°å¤§è§„æ¨¡åº”ç”¨ã€‚<br>1999å¹´1æœˆï¼Œäº’è”ç½‘æ ‡å‡†åŒ–ç»„ç»‡ISOCæ¥æ›¿NetScapeå…¬å¸ï¼Œå‘å¸ƒäº†SSLçš„å‡çº§ç‰ˆ<a href="https://www.ietf.org/rfc/rfc2246.txt" target="_blank" rel="noopener">TLS 1.0ç‰ˆ</a>ã€‚<br>2006å¹´4æœˆå’Œ2008å¹´8æœˆï¼ŒTLSè¿›è¡Œäº†ä¸¤æ¬¡å‡çº§ï¼Œåˆ†åˆ«ä¸º<a href="https://tools.ietf.org/html/rfc4346" target="_blank" rel="noopener">TLS 1.1</a>ç‰ˆå’Œ<a href="https://tools.ietf.org/html/rfc5246" target="_blank" rel="noopener">TLS 1.2</a>ç‰ˆã€‚æœ€æ–°çš„å˜åŠ¨æ˜¯2011å¹´TLS 1.2çš„ä¿®è®¢ç‰ˆã€‚<br>ç°åœ¨æ­£åœ¨åˆ¶å®š <a href="https://github.com/tlswg/tls13-spec">tls 1.3</a>ã€‚</p>
</blockquote>
<h2 id="TLSæ¡æ‰‹è¿‡ç¨‹"><a href="#TLSæ¡æ‰‹è¿‡ç¨‹" class="headerlink" title="TLSæ¡æ‰‹è¿‡ç¨‹"></a>TLSæ¡æ‰‹è¿‡ç¨‹</h2><p>TLSçš„æ¡æ‰‹é˜¶æ®µæ˜¯å‘ç”Ÿåœ¨TCPæ¡æ‰‹ä¹‹åã€‚æ¡æ‰‹å®é™…ä¸Šæ˜¯ä¸€ç§åå•†çš„è¿‡ç¨‹ï¼Œå¯¹åè®®æ‰€å¿…éœ€çš„ä¸€äº›å‚æ•°è¿›è¡Œåå•†ã€‚TLSæ¡æ‰‹è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="/gallery/common/TLS-handshake-protocol.png" alt=""></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç®€è¿°å¦‚ä¸‹ï¼š</p>
<ul>
<li>ClientHelloï¼šå®¢æˆ·ç«¯ç”Ÿæˆä¸€ä¸ªéšæœºæ•° <code>random-client</code>ï¼Œä¼ åˆ°æœåŠ¡å™¨ç«¯ï¼ˆSay Hello)</li>
<li>ServerHelloï¼šæœåŠ¡å™¨ç«¯ç”Ÿæˆä¸€ä¸ªéšæœºæ•° <code>random-server</code>ï¼Œå’Œç€å…¬é’¥ï¼Œä¸€èµ·å›é¦ˆç»™å®¢æˆ·ç«¯ï¼ˆI got it)</li>
<li>å®¢æˆ·ç«¯æ”¶åˆ°çš„ä¸œè¥¿åŸå°ä¸åŠ¨ï¼ŒåŠ ä¸Š <code>premaster secret</code>ï¼ˆé€šè¿‡ <code>random-client</code>ã€<code>random-server</code> ç»è¿‡ä¸€å®šç®—æ³•ç”Ÿæˆçš„ä¸œè¥¿ï¼‰ï¼Œå†ä¸€æ¬¡é€ç»™æœåŠ¡å™¨ç«¯ï¼Œè¿™æ¬¡ä¼ è¿‡å»çš„ä¸œè¥¿ä¼šä½¿ç”¨å…¬é’¥åŠ å¯†</li>
<li>æœåŠ¡å™¨ç«¯å…ˆä½¿ç”¨ç§é’¥è§£å¯†ï¼Œæ‹¿åˆ° <code>premaster secret</code>ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½æ‹¥æœ‰äº†ä¸‰ä¸ªè¦ç´ ï¼š<code>random-client</code>ã€<code>random-server</code> å’Œ <code>premaster secret</code></li>
<li>æ­¤æ—¶å®‰å…¨é€šé“å·²ç»å»ºç«‹ï¼Œä»¥åçš„äº¤æµéƒ½ä¼šæ ¡æ£€ä¸Šé¢çš„ä¸‰ä¸ªè¦ç´ é€šè¿‡ç®—æ³•ç®—å‡ºçš„ <code>session key</code></li>
</ul>
<h3 id="Client-Hello-gt"><a href="#Client-Hello-gt" class="headerlink" title="Client Hello =&gt;"></a>Client Hello =&gt;</h3><p>åœ¨TLSæ¡æ‰‹é˜¶æ®µï¼Œå®¢æˆ·ç«¯é¦–å…ˆè¦å‘ŠçŸ¥æœåŠ¡ç«¯ï¼Œè‡ªå·±æ”¯æŒå“ªäº›åŠ å¯†ç®—æ³•ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯éœ€è¦å°†æœ¬åœ°æ”¯æŒçš„åŠ å¯†å¥—ä»¶(Cipher Suite)çš„åˆ—è¡¨ä¼ é€ç»™æœåŠ¡ç«¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®¢æˆ·ç«¯è¿˜è¦äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œä¼ é€ç»™æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯çš„éšæœºæ•°éœ€è¦è·ŸæœåŠ¡ç«¯äº§ç”Ÿçš„éšæœºæ•°ç»“åˆèµ·æ¥äº§ç”Ÿåé¢è¦è®²åˆ°çš„Master Secretã€‚å³ClientHelloä¸»è¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<blockquote>
<ol>
<li>æ”¯æŒçš„åè®®ç‰ˆæœ¬ï¼Œæ¯”å¦‚ TLS 1.2</li>
<li>ä¸€ä¸ªå®¢æˆ·ç«¯â½£æˆçš„éšæœºæ•°ï¼Œç¨åç”¨äºç”Ÿæˆâ€å¯¹è¯å¯†é’¥â€</li>
<li>æ”¯æŒçš„åŠ å¯†æ–¹æ³•ï¼Œâ½å¦‚ RSA å…¬é’¥åŠ å¯†ã€‚</li>
<li>æ”¯æŒçš„å‹ç¼©æ–¹æ³•ã€‚</li>
</ol>
</blockquote>
<h3 id="Server-Hello-lt"><a href="#Server-Hello-lt" class="headerlink" title="Server Hello &lt;="></a>Server Hello &lt;=</h3><p>ä¸Šå›¾ä¸­ï¼Œä»Server Helloåˆ°Server Doneï¼Œæœ‰äº›æœåŠ¡ç«¯çš„å®ç°æ˜¯æ¯æ¡å•ç‹¬å‘é€ï¼Œæœ‰æœåŠ¡ç«¯å®ç°æ˜¯åˆå¹¶åˆ°ä¸€èµ·å‘é€ã€‚Sever Helloå’ŒServer Doneéƒ½æ˜¯åªæœ‰å¤´æ²¡æœ‰å†…å®¹çš„æ•°æ®ã€‚</p>
<p>æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„Client Helloä¹‹åï¼ŒæœåŠ¡ç«¯éœ€è¦å°†è‡ªå·±çš„è¯ä¹¦å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¯ä¹¦æ˜¯éœ€è¦ç”³è¯·ï¼Œå¹¶ç”±ä¸“é—¨çš„æ•°å­—è¯ä¹¦è®¤è¯æœºæ„(CA)é€šè¿‡éå¸¸ä¸¥æ ¼çš„å®¡æ ¸ä¹‹åé¢å‘çš„ç”µå­è¯ä¹¦ã€‚é¢å‘è¯ä¹¦çš„åŒæ—¶ä¼šäº§ç”Ÿä¸€ä¸ªç§é’¥å’Œå…¬é’¥ã€‚ç§é’¥ç”±æœåŠ¡ç«¯è‡ªå·±ä¿å­˜ï¼Œä¸å¯æ³„æ¼ã€‚å…¬é’¥åˆ™æ˜¯é™„å¸¦åœ¨è¯ä¹¦çš„ä¿¡æ¯ä¸­ï¼Œå¯ä»¥å…¬å¼€ã€‚è¯ä¹¦æœ¬èº«ä¹Ÿé™„å¸¦ä¸€ä¸ªè¯ä¹¦ç”µå­ç­¾åï¼Œè¿™ä¸ªç­¾åç”¨æ¥éªŒè¯è¯ä¹¦çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ï¼Œå¯ä»¥é˜²æ­¢è¯ä¹¦è¢«ç¯¡æ”¹ã€‚å¦å¤–ï¼Œè¯ä¹¦è¿˜æœ‰æœ‰æ•ˆæœŸã€‚</p>
<p>åœ¨æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€çš„è¯ä¹¦ä¸­æ²¡æœ‰æä¾›è¶³å¤Ÿçš„ä¿¡æ¯çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªServer Key Exchangeã€‚</p>
<p>æ­¤å¤–ï¼Œå¯¹äºéå¸¸é‡è¦çš„ä¿å¯†æ•°æ®ï¼ŒæœåŠ¡ç«¯è¿˜éœ€è¦å¯¹å®¢æˆ·ç«¯è¿›è¡ŒéªŒè¯ï¼Œä»¥ä¿è¯æ•°æ®ä¼ é€ç»™äº†å®‰å…¨çš„åˆæ³•çš„å®¢æˆ·ç«¯ã€‚æœåŠ¡ç«¯å¯ä»¥å‘å®¢æˆ·ç«¯å‘å‡ºCerficate Requestæ¶ˆæ¯ï¼Œè¦æ±‚å®¢æˆ·ç«¯å‘é€è¯ä¹¦å¯¹å®¢æˆ·ç«¯çš„åˆæ³•æ€§è¿›è¡ŒéªŒè¯ã€‚</p>
<p>è·Ÿå®¢æˆ·ç«¯ä¸€æ ·ï¼ŒæœåŠ¡ç«¯ä¹Ÿéœ€è¦äº§ç”Ÿä¸€ä¸ªéšæœºæ•°å‘é€ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½éœ€è¦ä½¿ç”¨è¿™ä¸¤ä¸ªéšæœºæ•°æ¥äº§ç”ŸMaster Secretã€‚æœ€åæœåŠ¡ç«¯ä¼šå‘é€ä¸€ä¸ªServer Hello Doneæ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œè¡¨ç¤ºServer Helloæ¶ˆæ¯ç»“æŸäº†ã€‚</p>
<blockquote>
<ol>
<li>ç¡®è®¤ä½¿â½¤çš„åŠ å¯†é€šä¿¡åè®®ç‰ˆæœ¬ï¼Œâ½å¦‚ TLS 1.0 ç‰ˆæœ¬ã€‚å¦‚æœæµè§ˆå™¨ä¸æœåŠ¡å™¨â½€æŒçš„ç‰ˆæœ¬ä¸ä¸€è‡´ï¼ŒæœåŠ¡å™¨å…³é—­åŠ å¯†é€šä¿¡ã€‚</li>
<li>ä¸€ä¸ªæœåŠ¡å™¨â½£æˆçš„éšæœºæ•°ï¼Œç¨åç”¨äºç”Ÿæˆâ€å¯¹è¯å¯†é’¥â€ã€‚</li>
<li>ç¡®è®¤ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ï¼Œâ½å¦‚ RSA å…¬é’¥åŠ å¯†ã€‚</li>
<li>æœåŠ¡å™¨è¯ä¹¦</li>
</ol>
</blockquote>
<h3 id="Client-Key-Exchange-gt"><a href="#Client-Key-Exchange-gt" class="headerlink" title="Client Key Exchange =&gt;"></a>Client Key Exchange =&gt;</h3><p>å¦‚æœæœåŠ¡ç«¯éœ€è¦å¯¹å®¢æˆ·ç«¯è¿›è¡ŒéªŒè¯ï¼Œåœ¨å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„Server Helloæ¶ˆæ¯ä¹‹åï¼Œé¦–å…ˆéœ€è¦å‘æœåŠ¡ç«¯å‘é€å®¢æˆ·ç«¯çš„è¯ä¹¦ï¼Œè®©æœåŠ¡ç«¯æ¥éªŒè¯å®¢æˆ·ç«¯çš„åˆæ³•æ€§ã€‚</p>
<p>åœ¨æ­¤ä¹‹å‰çš„æ‰€æœ‰TLSæ¡æ‰‹ä¿¡æ¯éƒ½æ˜¯æ˜æ–‡ä¼ é€çš„ã€‚åœ¨æ”¶åˆ°æœåŠ¡ç«¯çš„è¯ä¹¦ç­‰ä¿¡æ¯ä¹‹åï¼Œå®¢æˆ·ç«¯ä¼šä½¿ç”¨ä¸€äº›åŠ å¯†ç®—æ³•(ä¾‹å¦‚ï¼šRSA, Diffie-Hellman)äº§ç”Ÿä¸€ä¸ª48ä¸ªå­—èŠ‚çš„éšæœºæ•°Keyï¼Œè¿™ä¸ªKeyå«PreMaster Secretï¼Œå¾ˆå¤šææ–™ä¸Šä¹Ÿè¢«ç§°ä½œ<code>PreMaster Key</code>ã€‚è¿™æ˜¯æ•´ä¸ªTLSæ¡æ‰‹æœŸé—´çš„ç¬¬ä¸‰ä¸ªéšæœºæ•°ã€‚æœ€ç»ˆé€šè¿‡<code>Master secret</code>ç”Ÿæˆ<code>session secret</code>ï¼Œ <code>session secret</code>å°±æ˜¯ç”¨æ¥å¯¹åº”ç”¨æ•°æ®è¿›è¡ŒåŠ è§£å¯†çš„ä¼šè¯ç§˜é’¥ã€‚ä¸ºä»€ä¹ˆéœ€è¦<code>PreMaster secret</code>è¿™ç¬¬ä¸‰ä¸ªéšæœºæ•°çš„Keyå‘¢ï¼Ÿå› ä¸ºå‰ä¸¤ä¸ªéšæœºæ•°Client Randomå’ŒServer Randoméƒ½æ˜¯æ˜æ–‡ä¼ è¾“çš„ã€‚ä¸­é—´äººå¯èƒ½æ—©å·²ç›‘å¬åˆ°äº†ã€‚å¦‚æœåªä½¿ç”¨è¿™ä¸¤ä¸ªéšæœºæ•°è®¡ç®—æœ€ç»ˆçš„ä¼šè¯ç§˜é’¥ä¸­é—´äººä¹Ÿå¯ä»¥ç”Ÿæˆã€‚æ‰€ä»¥<code>PreMaster secret</code>ä½¿ç”¨RSAéå¯¹ç§°åŠ å¯†çš„æ–¹å¼ï¼Œä½¿ç”¨æœåŠ¡ç«¯ä¼ è¿‡æ¥çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œç„¶åä¼ ç»™æœåŠ¡ç«¯ã€‚</p>
<p>æ¥ç€ï¼Œå®¢æˆ·ç«¯éœ€è¦å¯¹æœåŠ¡ç«¯çš„è¯ä¹¦è¿›è¡Œæ£€æŸ¥ï¼Œæ£€æŸ¥è¯ä¹¦çš„å®Œæ•´æ€§ä»¥åŠè¯ä¹¦è·ŸæœåŠ¡ç«¯åŸŸåæ˜¯å¦å»åˆã€‚</p>
<p>ChangeCipherSpecæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åè®®ï¼Œä½“ç°åœ¨æ•°æ®åŒ…ä¸­å°±æ˜¯ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œç”¨äºå‘ŠçŸ¥æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯å·²ç»åˆ‡æ¢åˆ°ä¹‹å‰åå•†å¥½çš„åŠ å¯†å¥—ä»¶çš„çŠ¶æ€ï¼Œå‡†å¤‡ä½¿ç”¨ä¹‹å‰åå•†å¥½çš„åŠ å¯†å¥—ä»¶åŠ å¯†æ•°æ®å¹¶ä¼ è¾“äº†ã€‚</p>
<p>åœ¨ChangecipherSpecä¼ è¾“å®Œæ¯•ä¹‹åï¼Œå®¢æˆ·ç«¯ä¼šä½¿ç”¨ä¹‹å‰åå•†å¥½çš„åŠ å¯†å¥—ä»¶å’Œsession secretåŠ å¯†ä¸€æ®µFinishçš„æ•°æ®ä¼ é€ç»™æœåŠ¡ç«¯ï¼Œæ­¤æ•°æ®æ˜¯ä¸ºäº†åœ¨æ­£å¼ä¼ è¾“åº”ç”¨æ•°æ®ä¹‹å‰å¯¹åˆšåˆšæ¡æ‰‹å»ºç«‹èµ·æ¥çš„åŠ è§£å¯†é€šé“è¿›è¡ŒéªŒè¯ã€‚</p>
<blockquote>
<ol>
<li>ä¸€ä¸ªéšæœºæ•°<code>PreMaster Key</code>ã€‚è¯¥éšæœºæ•°ç”¨æœåŠ¡å™¨å…¬é’¥åŠ å¯†ï¼Œé˜²â½Œè¢«çªƒå¬ã€‚</li>
<li>ç¼–ç æ”¹å˜é€šçŸ¥ï¼Œè¡¨ç¤ºéšåçš„ä¿¡æ¯éƒ½å°†â½¤åŒâ½…å•†å®šçš„åŠ å¯†â½…æ³•å’Œå¯†é’¥å‘é€ã€‚</li>
<li>å®¢æˆ·ç«¯æ¡â¼¿ç»“æŸé€šçŸ¥ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯çš„æ¡â¼¿é˜¶æ®µå·²ç»ç»“æŸã€‚è¿™â¼€é¡¹åŒæ—¶ä¹Ÿæ˜¯å‰â¾¯å‘é€çš„æ‰€æœ‰å†…å®¹çš„ hash å€¼ï¼Œâ½¤æ¥ä¾›æœåŠ¡å™¨æ ¡éªŒã€‚</li>
</ol>
</blockquote>
<h3 id="Server-Finish-lt"><a href="#Server-Finish-lt" class="headerlink" title="Server Finish &lt;="></a>Server Finish &lt;=</h3><p>æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„PreMasteråŠ å¯†æ•°æ®ä¹‹åï¼Œä½¿ç”¨ç§é’¥å¯¹è¿™æ®µåŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œä¹Ÿä¼šä½¿ç”¨è·Ÿå®¢æˆ·ç«¯åŒæ ·çš„æ–¹å¼ç”Ÿæˆ<code>session secret</code>ï¼Œä¸€åˆ‡å‡†å¤‡å¥½ä¹‹åï¼Œä¼šç»™å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªChangeCipherSpecï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯å·²ç»åˆ‡æ¢åˆ°åå•†è¿‡çš„åŠ å¯†å¥—ä»¶çŠ¶æ€ï¼Œå‡†å¤‡ä½¿ç”¨åŠ å¯†å¥—ä»¶å’Œ<code>session secret</code>åŠ å¯†æ•°æ®äº†ã€‚ä¹‹åï¼ŒæœåŠ¡ç«¯ä¹Ÿä¼šä½¿ç”¨<code>session secret</code>åŠ å¯†åä¸€æ®µFinishæ¶ˆæ¯å‘é€ç»™å®¢æˆ·ç«¯ï¼Œä»¥éªŒè¯ä¹‹å‰é€šè¿‡æ¡æ‰‹å»ºç«‹èµ·æ¥çš„åŠ è§£å¯†é€šé“æ˜¯å¦æˆåŠŸã€‚</p>
<blockquote>
<ol>
<li>ç¼–ç æ”¹å˜é€šçŸ¥ï¼Œè¡¨ç¤ºéšåçš„ä¿¡æ¯éƒ½å°†â½¤åŒæ–¹å•†å®šçš„åŠ å¯†â½…æ³•å’Œå¯†é’¥å‘é€ã€‚</li>
<li>æœåŠ¡å™¨æ¡â¼¿ç»“æŸé€šçŸ¥ï¼Œè¡¨ç¤ºæœåŠ¡å™¨çš„æ¡â¼¿é˜¶æ®µå·²ç»ç»“æŸã€‚è¿™â¼€é¡¹åŒæ—¶ä¹Ÿæ˜¯å‰â¾¯å‘é€çš„æ‰€æœ‰å†…å®¹çš„ hash å€¼ï¼Œâ½¤æ¥ä¾›å®¢æˆ·ç«¯æ ¡éªŒã€‚</li>
</ol>
</blockquote>
<h3 id="åº”ç”¨æ•°æ®ä¼ è¾“"><a href="#åº”ç”¨æ•°æ®ä¼ è¾“" class="headerlink" title="åº”ç”¨æ•°æ®ä¼ è¾“"></a>åº”ç”¨æ•°æ®ä¼ è¾“</h3><p>åœ¨æ‰€æœ‰çš„æ¡æ‰‹é˜¶æ®µéƒ½å®Œæˆä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹ä¼ é€åº”ç”¨æ•°æ®äº†ã€‚åº”ç”¨æ•°æ®åœ¨ä¼ è¾“ä¹‹å‰ï¼Œé¦–å…ˆè¦é™„åŠ ä¸ŠMAC secretï¼Œç„¶åå†å¯¹è¿™ä¸ªæ•°æ®åŒ…ä½¿ç”¨write encryption keyè¿›è¡ŒåŠ å¯†ã€‚åœ¨æœåŠ¡ç«¯æ”¶åˆ°å¯†æ–‡ä¹‹åï¼Œä½¿ç”¨Client write encryption keyè¿›è¡Œè§£å¯†ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„æ•°æ®ä¹‹åä½¿ç”¨Server write encryption keyè¿›è¡Œè§£å¯†ï¼Œç„¶åä½¿ç”¨å„è‡ªçš„write MAC keyå¯¹æ•°æ®çš„å®Œæ•´æ€§åŒ…æ‹¬æ˜¯å¦è¢«ä¸²æ”¹è¿›è¡ŒéªŒè¯ã€‚</p>
<h2 id="å‡ ä¸ªåè¯"><a href="#å‡ ä¸ªåè¯" class="headerlink" title="å‡ ä¸ªåè¯"></a>å‡ ä¸ªåè¯</h2><p>åœ¨è¯¦è¿°è¿‡ç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹ï¼Œåœ¨è¿‡ç¨‹ä¸­ä¼šå‡ºç°çš„å†…å®¹ã€‚</p>
<ul>
<li><code>session key</code>: è¿™æ˜¯ TLS/SSL æœ€ååå•†çš„ç»“æœï¼Œç”¨æ¥è¿›è¡Œå¯¹ç§°åŠ å¯†ã€‚</li>
<li><code>client random</code>: æ˜¯ä¸€ä¸ª 32B çš„åºåˆ—å€¼ï¼Œæ¯æ¬¡è¿æ¥æ¥æ—¶ï¼Œéƒ½ä¼šåŠ¨æ€ç”Ÿæˆï¼Œå³ï¼Œæ¯æ¬¡è¿æ¥ç”Ÿæˆçš„å€¼éƒ½ä¸ä¼šä¸€æ ·ã€‚å› ä¸ºï¼Œä»–åŒ…å«äº† 4B çš„æ—¶é—´æˆ³å’Œ 28B çš„éšæœºæ•°ã€‚</li>
<li><code>server random</code>: å’Œ <code>client random</code> ä¸€æ ·ï¼Œåªæ˜¯ç”± server ç«¯ç”Ÿæˆã€‚</li>
<li><code>premaster secret</code>: è¿™æ˜¯ 48B çš„ blob æ•°æ®ã€‚å®ƒèƒ½å’Œ client &amp; server random é€šè¿‡ <code>pseudorandom</code> (PRF) ä¸€èµ·ç”Ÿæˆ session keyã€‚</li>
<li><code>cipher suite</code>: ç”¨æ¥å®šä¹‰ TLS è¿æ¥ç”¨åˆ°çš„ç®—æ³•ã€‚é€šå¸¸æœ‰ 4 éƒ¨åˆ†ï¼š<ul>
<li>éå¯¹ç§°åŠ å¯† (ECDH æˆ– RSA)</li>
<li>è¯ä¹¦éªŒè¯ (è¯ä¹¦çš„ç±»å‹)</li>
<li>ä¿å¯†æ€§ (å¯¹ç§°åŠ å¯†ç®—æ³•)</li>
<li>æ•°æ®å®Œæ•´æ€§ (äº§ç”Ÿ hash çš„å‡½æ•°) æ¯”å¦‚<code>AES128-SHA</code>ä»£è¡¨ç€ï¼š<ul>
<li>RSA ç®—æ³•è¿›è¡Œéå¯¹ç§°åŠ å¯†</li>
<li>RSA è¿›è¡Œè¯ä¹¦éªŒè¯</li>
<li>128bit AES å¯¹ç§°åŠ å¯†</li>
<li>160bit SHA æ•°æ®åŠ å¯†ç®—æ³•</li>
</ul>
</li>
<li>æ¯”å¦‚<code>ECDHE-ECDSA-AES256-GCM-SHA384</code>ä»£è¡¨ç€<ul>
<li>ECDHE ç®—æ³•è¿›è¡Œéå¯¹ç§°åŠ å¯†</li>
<li>ECDSA è¿›è¡Œè¯ä¹¦éªŒè¯</li>
<li>265bit AES å¯¹ç§°åŠ å¯†</li>
<li>384bit SHA æ•°æ®åŠ å¯†ç®—æ³•</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ä¸Šé¢ä¸»è¦æ˜¯æ ¹æ® RSA åŠ å¯†æ–¹å¼æ¥è®²è§£çš„ã€‚å› ä¸º RSA æ‰ä¼šåœ¨ TLS/SSL è¿‡ç¨‹ä¸­ï¼Œå°† pre-master secret æ˜¾ç¤ºçš„è¿›è¡Œä¼ è¾“ï¼Œè¿™æ ·çš„ç»“æœæœ‰å¯èƒ½é€ æˆï¼Œhacker æ‹¿åˆ°äº† private key é‚£ä¹ˆä»–ä¹Ÿå¯ä»¥ç”Ÿæˆä¸€æ¨¡ä¸€æ ·çš„ sessionKeyã€‚å³ï¼Œè¯¥æ¬¡è¿æ¥çš„å®‰å…¨æ€§å°±æ²¡äº†ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸»è¦è®²è§£ä¸€ä¸‹å¦å¤–ä¸€ç§åŠ å¯†æ–¹å¼ DHã€‚å®ƒå’Œ RSA çš„ä¸»è¦åŒºåˆ«å°±æ˜¯ï¼Œåˆ°åº•ä¼ ä¸ä¼  pre-master secretã€‚RSA ä¼ è€Œ DH ä¸ä¼ ã€‚æ ¹æ® <a href="https://blog.cloudflare.com/keyless-ssl-the-nitty-gritty-technical-details/nwmm4058zw/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-10-16%2022.38.38.png" target="_blank" rel="noopener">cloudflare</a> çš„è®²è§£å¯ä»¥æ¸…æ¥šçš„äº†è§£åˆ°ä¸¤è€…çš„åŒºåˆ«ï¼š</p>
<p>è¿™æ˜¯ RSA çš„ä¼ è¾“æ–¹å¼ï¼ŒåŸºæœ¬è¿‡ç¨‹å¦‚ä¸Šè¿°ã€‚</p>
<p><img src="/gallery/common/https_handshake.png" alt="ä½¿ç”¨RSAåŠ å¯†ç®—æ³•çš„TLSæ¡æ‰‹è¿‡ç¨‹"></p>
<p>è€Œ DH å…·ä½“åŒºåˆ«åœ¨ä¸‹å›¾ï¼š</p>
<p><img src="/gallery/common/ssl_handshake_diffie_hellman.jpg" alt="ä½¿ç”¨DHåŠ å¯†ç®—æ³•çš„TLSæ¡æ‰‹è¿‡ç¨‹"></p>
<p>è¿™é‡Œå…ˆè¡¥å……ä¸€ä¸‹ DH ç®—æ³•çš„çŸ¥è¯†ã€‚å› ä¸ºï¼ŒPreMaster secret å°±æ˜¯æ ¹æ®è¿™ä¸ªç”Ÿæˆçš„ã€‚DH åŸºæœ¬è¿‡ç¨‹ä¹Ÿä¸ç®—å¤ªéš¾ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒ <a href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange#Description" target="_blank" rel="noopener">wiki</a>ã€‚ å®ƒä¸»è¦è¿ç”¨åˆ°çš„å…¬å¼å°±æ˜¯:</p>
<p><img src="/gallery/common/7b09ebb75344061a3bd483c1369b31a45adad94f.svg" alt=""></p>
<p>ä¸ºäº†é˜²æ­¢åœ¨ DH å‚æ•°äº¤æ¢æ—¶ï¼Œæ•°æ®è¿‡å¤§ï¼ŒDH ä½¿ç”¨çš„æ˜¯å–æ¨¡æ•°çš„æ–¹å¼ï¼Œè¿™æ ·å°±èƒ½é™åˆ¶ä¼ è¾“çš„å€¼æ°¸è¿œåœ¨ [1,p-1]ã€‚è¿™é‡Œï¼Œå…ˆè¯´æ˜ä¸€ä¸‹ DH ç®—æ³•çš„åŸºæœ¬æ¡ä»¶ï¼š</p>
<ul>
<li>å…¬å…±æ¡ä»¶ï¼š p å’Œ g éƒ½æ˜¯å·²çŸ¥ï¼Œå¹¶ä¸”å…¬å¼€ã€‚å³ï¼Œç¬¬ä¸‰æ–¹ä¹Ÿå¯ä»¥éšä¾¿è·å–åˆ°ã€‚</li>
<li>ç§æœ‰æ¡ä»¶ï¼š a å’Œ b æ˜¯ä¸¤ç«¯è‡ªå·±ç”Ÿæˆçš„ï¼Œç¬¬ä¸‰æ–¹è·å–ä¸åˆ°ã€‚</li>
</ul>
<p>åŸºæœ¬æµç¨‹å°±æ˜¯ï¼š</p>
<p><img src="/gallery/common/å±å¹•å¿«ç…§ 2016-10-17 11.24.41.png" alt="DHç®—æ³•æµç¨‹"></p>
<p>æˆ‘ä»¬åªè¦æŠŠä¸Šå›¾çš„ DH parameter æ›¿æ¢ä¸ºç›¸å¯¹åº”çš„ X/Y å³å¯ã€‚è€Œæœ€åçš„ Z å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ Premaster secretã€‚ ä¹‹åï¼Œå°±å’Œ RSA åŠ å¯†ç®—æ³•ä¸€è‡´ï¼ŒåŠ ä¸Šä¸¤è¾¹çš„ random-num ç”Ÿæˆ sessionKeyã€‚é€šè¿‡ï¼Œæˆ‘ä»¬å¸¸å¸¸ç§° DH ä¹Ÿå«ä½œ <code>Ephemeral Diffie-Hellman handshake</code>ã€‚ å› ä¸ºï¼Œä»–æ¯æ¬¡ä¸€çš„ sessionKey éƒ½æ˜¯ä¸åŒçš„ã€‚</p>
<p>è€Œ RSA å’Œ DH ä¸¤è€…ä¹‹é—´çš„å…·ä½“çš„åŒºåˆ«å°±åœ¨äºï¼šRSA ä¼šå°† premaster secret æ˜¾ç¤ºçš„ä¼ è¾“ï¼Œè¿™æ ·æœ‰å¯èƒ½ä¼šé€ æˆç§é’¥æ³„éœ²å¼•èµ·çš„å®‰å…¨é—®é¢˜ã€‚è€Œ DH ä¸ä¼šå°† premaster secret æ˜¾ç¤ºçš„ä¼ è¾“ã€‚</p>
<h2 id="å®é™…æŠ“åŒ…"><a href="#å®é™…æŠ“åŒ…" class="headerlink" title="å®é™…æŠ“åŒ…"></a>å®é™…æŠ“åŒ…</h2><p>é€šè¿‡ Wireshark æŠ“åŒ…å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å®Œæ•´ TLS æ¡æ‰‹è¿‡ç¨‹æ‰€éœ€çš„ä¸¤ä¸ª RTTï¼Œå¦‚ä¸‹å›¾ï¼ˆæ¥è‡ªï¼š<a href="https://imququ.com/post/optimize-tls-handshake.html" target="_blank" rel="noopener">TLS æ¡æ‰‹ä¼˜åŒ–è¯¦è§£</a>ï¼‰ï¼š</p>
<p><img src="/gallery/common/wireshake-tls-full-handshake.png" alt=""></p>
<h2 id="ç§é’¥çš„ä½œç”¨"><a href="#ç§é’¥çš„ä½œç”¨" class="headerlink" title="ç§é’¥çš„ä½œç”¨"></a>ç§é’¥çš„ä½œç”¨</h2><p>æ¡æ‰‹é˜¶æ®µæœ‰ä¸‰ç‚¹éœ€è¦æ³¨æ„ã€‚</p>
<blockquote>
<p>ï¼ˆ1ï¼‰ç”Ÿæˆå¯¹è¯å¯†é’¥ä¸€å…±éœ€è¦ä¸‰ä¸ªéšæœºæ•°ã€‚</p>
<p>ï¼ˆ2ï¼‰æ¡æ‰‹ä¹‹åçš„å¯¹è¯ä½¿ç”¨â€å¯¹è¯å¯†é’¥â€åŠ å¯†ï¼ˆå¯¹ç§°åŠ å¯†ï¼‰ï¼ŒæœåŠ¡å™¨çš„å…¬é’¥å’Œç§é’¥åªç”¨äºåŠ å¯†å’Œè§£å¯†â€å¯¹è¯å¯†é’¥â€ï¼ˆéå¯¹ç§°åŠ å¯†ï¼‰ï¼Œæ— å…¶ä»–ä½œç”¨ã€‚</p>
<p>ï¼ˆ3ï¼‰æœåŠ¡å™¨å…¬é’¥æ”¾åœ¨æœåŠ¡å™¨çš„æ•°å­—è¯ä¹¦ä¹‹ä¸­ã€‚</p>
</blockquote>
<p>ä»ä¸Šé¢ç¬¬äºŒç‚¹å¯çŸ¥ï¼Œæ•´ä¸ªå¯¹è¯è¿‡ç¨‹ä¸­ï¼ˆæ¡æ‰‹é˜¶æ®µå’Œå…¶åçš„å¯¹è¯ï¼‰ï¼ŒæœåŠ¡å™¨çš„å…¬é’¥å’Œç§é’¥åªéœ€è¦ç”¨åˆ°ä¸€æ¬¡ã€‚è¿™å°±æ˜¯CloudFlareèƒ½å¤Ÿæä¾›KeylessæœåŠ¡çš„æ ¹æœ¬åŸå› ã€‚</p>
<p>æŸäº›å®¢æˆ·ï¼ˆæ¯”å¦‚é“¶è¡Œï¼‰æƒ³è¦ä½¿ç”¨å¤–éƒ¨CDNï¼ŒåŠ å¿«è‡ªå®¶ç½‘ç«™çš„è®¿é—®é€Ÿåº¦ï¼Œä½†æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¸èƒ½æŠŠç§é’¥äº¤ç»™CDNæœåŠ¡å•†ã€‚è¿™æ—¶ï¼Œå®Œå…¨å¯ä»¥æŠŠç§é’¥ç•™åœ¨è‡ªå®¶æœåŠ¡å™¨ï¼Œåªç”¨æ¥è§£å¯†å¯¹è¯å¯†é’¥ï¼Œå…¶ä»–æ­¥éª¤éƒ½è®©CDNæœåŠ¡å•†å»å®Œæˆã€‚</p>
<p><img src="/gallery/common/bg2014092006.png" alt=""></p>
<p>ä¸Šå›¾ä¸­ï¼Œé“¶è¡Œçš„æœåŠ¡å™¨åªå‚ä¸ç¬¬å››æ­¥ï¼Œåé¢çš„å¯¹è¯éƒ½ä¸å†ä¼šç”¨åˆ°ç§é’¥äº†ã€‚</p>
<h2 id="è‡ªç­¾åè¯ä¹¦"><a href="#è‡ªç­¾åè¯ä¹¦" class="headerlink" title="è‡ªç­¾åè¯ä¹¦"></a>è‡ªç­¾åè¯ä¹¦</h2><p>ä»€ä¹ˆå«è‡ªç­¾åå‘¢ï¼Ÿå°±æ˜¯è‡ªå·±é€šè¿‡keytoolå»ç”Ÿæˆä¸€ä¸ªè¯ä¹¦ï¼Œç„¶åä½¿ç”¨ï¼Œå¹¶ä¸æ˜¯CAæœºæ„å»é¢å‘çš„ã€‚ä½¿ç”¨è‡ªç­¾åè¯ä¹¦çš„ç½‘ç«™ï¼Œå¤§å®¶åœ¨ä½¿ç”¨æµè§ˆå™¨è®¿é—®çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½æ˜¯æŠ¥é£é™©è­¦å‘Šï¼Œæ¯”å¦‚ä¹‹å‰çš„12306å°±æ˜¯è¿™ä¹ˆå¹²çš„ï¼Œ<a href="https://kyfw.12306.cn/otn/" target="_blank" rel="noopener">https://kyfw.12306.cn/otn/</a> ï¼Œç‚¹å‡»è¿›å…¥12306çš„è´­ç¥¨é¡µé¢å°±èƒ½çœ‹åˆ°äº†ã€‚å½“ç„¶ç°åœ¨æˆ‘é‡æ–°è¯•äº†ä¸€ä¸‹å·²ç»ä¸æ˜¯è¿™æ ·äº†ã€‚</p>
<p><img src="/gallery/common/1440987432776078.png" alt=""></p>
<h3 id="æœåŠ¡ç«¯è¯ä¹¦ç”Ÿæˆ"><a href="#æœåŠ¡ç«¯è¯ä¹¦ç”Ÿæˆ" class="headerlink" title="æœåŠ¡ç«¯è¯ä¹¦ç”Ÿæˆ"></a>æœåŠ¡ç«¯è¯ä¹¦ç”Ÿæˆ</h3><p>GolangæœåŠ¡ç«¯å¯ä»¥å‚è€ƒè¿™é‡Œï¼š<a href="https://gist.github.com/denji/12b3a568f092ab951456" target="_blank" rel="noopener">https://gist.github.com/denji/12b3a568f092ab951456</a></p>
<h4 id="ç”ŸæˆæœåŠ¡ç«¯ç§é’¥-Generate-private-key-key"><a href="#ç”ŸæˆæœåŠ¡ç«¯ç§é’¥-Generate-private-key-key" class="headerlink" title="ç”ŸæˆæœåŠ¡ç«¯ç§é’¥ Generate private key (.key)"></a>ç”ŸæˆæœåŠ¡ç«¯ç§é’¥ Generate private key (.key)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Key considerations for algorithm "RSA" â‰¥ 2048-bit</span></span><br><span class="line">openssl genrsa -out server.key 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># Key considerations for algorithm "ECDSA" â‰¥ secp384r1</span></span><br><span class="line"><span class="comment"># List ECDSA the supported curves (openssl ecparam -list_curves)</span></span><br><span class="line">openssl ecparam -genkey -name secp384r1 -out server.key</span><br></pre></td></tr></table></figure>
<h4 id="ç”ŸæˆæœåŠ¡ç«¯è‡ªç­¾åè¯ä¹¦-Generation-of-self-signed-x509-public-key-PEM-encodings-pem-crt-based-on-the-private-key"><a href="#ç”ŸæˆæœåŠ¡ç«¯è‡ªç­¾åè¯ä¹¦-Generation-of-self-signed-x509-public-key-PEM-encodings-pem-crt-based-on-the-private-key" class="headerlink" title="ç”ŸæˆæœåŠ¡ç«¯è‡ªç­¾åè¯ä¹¦ Generation of self-signed(x509) public key (PEM-encodings .pem|.crt) based on the private (.key)"></a>ç”ŸæˆæœåŠ¡ç«¯è‡ªç­¾åè¯ä¹¦ Generation of self-signed(x509) public key (PEM-encodings <code>.pem</code>|<code>.crt</code>) based on the private (<code>.key</code>)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -x509 -sha256 -key server.key -out server.crt -days 3650</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œéœ€è¦å¤§å®¶å¡«å†™èµ„æ–™ï¼ˆæœ‰äº›åœ°æ–¹å¯ä»¥ç©ºç€ï¼‰</p>
<blockquote>
<p> Country Name (2 letter code) [AU]:CN<br> State or Province Name (full name) [Some-State]:Guangdong<br> Locality Name (eg, city) []:FoShan<br> Organization Name (eg, company) [Internet Widgits Pty Ltd]:TestCA<br> Organizational Unit Name (eg, section) []:<br> Common Name (e.g. server FQDN or YOUR name) []:localhost<br> Email Address []:</p>
</blockquote>
<p>è¿™é‡Œæœ‰ç‚¹è¦æ³¨æ„ï¼Œ <code>Common Name (e.g. server FQDN or YOUR name) []:</code> è¿™ä¸€é¡¹ï¼Œæ˜¯æœ€åå¯ä»¥è®¿é—®çš„åŸŸåï¼Œæˆ‘è¿™é‡Œä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œå†™æˆ localhost ï¼Œå¦‚æœæ˜¯ä¸ºäº†ç»™ç½‘ç«™ç”Ÿæˆè¯ä¹¦ï¼Œéœ€è¦å†™æˆ xxxx.com ã€‚</p>
<h4 id="Simple-Golang-HTTPS-TLS-Server"><a href="#Simple-Golang-HTTPS-TLS-Server" class="headerlink" title="Simple Golang HTTPS/TLS Server"></a>Simple Golang HTTPS/TLS Server</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="comment">// "fmt"</span></span><br><span class="line">    <span class="comment">// "io"</span></span><br><span class="line">    <span class="string">"net/http"</span></span><br><span class="line">    <span class="string">"log"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HelloServer</span><span class="params">(w http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">    w.Header().Set(<span class="string">"Content-Type"</span>, <span class="string">"text/plain"</span>)</span><br><span class="line">    w.Write([]<span class="keyword">byte</span>(<span class="string">"This is an example server.\n"</span>))</span><br><span class="line">    <span class="comment">// fmt.Fprintf(w, "This is an example server.\n")</span></span><br><span class="line">    <span class="comment">// io.WriteString(w, "This is an example server.\n")</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    http.HandleFunc(<span class="string">"/hello"</span>, HelloServer)</span><br><span class="line">    err := http.ListenAndServeTLS(<span class="string">":443"</span>, <span class="string">"server.crt"</span>, <span class="string">"server.key"</span>, <span class="literal">nil</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatal(<span class="string">"ListenAndServe: "</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å®¢æˆ·ç«¯è®¿é—®ï¼ˆAndroidï¼‰"><a href="#å®¢æˆ·ç«¯è®¿é—®ï¼ˆAndroidï¼‰" class="headerlink" title="å®¢æˆ·ç«¯è®¿é—®ï¼ˆAndroidï¼‰"></a>å®¢æˆ·ç«¯è®¿é—®ï¼ˆAndroidï¼‰</h3><p>å½“å¤§å®¶ä½¿ç”¨Android ä¸­çš„OkHttpè®¿é—®ä¸€ä¸ªä½¿ç”¨è‡ªç­¾åçš„HTTPSçš„ç«™ç‚¹ï¼Œå®ƒä¼šæŠ›å‡ºä¸€ä¸ª<code>SSLHandshakeException</code>çš„å¼‚å¸¸ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor <span class="keyword">for</span> certification path not found.</span><br><span class="line">    at com.android.org.conscrypt.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:<span class="number">322</span>)</span><br><span class="line">    at com.android.okhttp.Connection.upgradeToTls(Connection.java:<span class="number">201</span>)</span><br><span class="line">    at com.android.okhttp.Connection.connect(Connection.java:<span class="number">155</span>)</span><br><span class="line">    at com.android.okhttp.internal.http.HttpEngine.connect(HttpEngine.java:<span class="number">276</span>)</span><br><span class="line">    at com.android.okhttp.internal.http.HttpEngine.sendRequest(HttpEngine.java:<span class="number">211</span>)</span><br><span class="line">    at com.android.okhttp.internal.http.HttpURLConnectionImpl.execute(HttpURLConnectionImpl.java:<span class="number">382</span>)</span><br><span class="line">    at com.android.okhttp.internal.http.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:<span class="number">332</span>)</span><br><span class="line">    at com.android.okhttp.internal.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:<span class="number">199</span>)</span><br><span class="line">    at com.android.okhttp.internal.http.DelegatingHttpsURLConnection.getInputStream(DelegatingHttpsURLConnection.java:<span class="number">210</span>)</span><br><span class="line">    at com.android.okhttp.internal.http.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:<span class="number">25</span>)</span><br><span class="line">    at me.longerian.abcandroid.datetimepicker.TestDateTimePickerActivity$<span class="number">1</span>.run(TestDateTimePickerActivity.java:<span class="number">236</span>)</span><br><span class="line">Caused by: java.security.cert.CertificateException: java.security.cert.CertPathValidatorException: Trust anchor <span class="keyword">for</span> certification path not found.</span><br><span class="line">    at com.android.org.conscrypt.TrustManagerImpl.checkTrusted(TrustManagerImpl.java:<span class="number">318</span>)</span><br><span class="line">    at com.android.org.conscrypt.TrustManagerImpl.checkServerTrusted(TrustManagerImpl.java:<span class="number">219</span>)</span><br><span class="line">    at com.android.org.conscrypt.Platform.checkServerTrusted(Platform.java:<span class="number">114</span>)</span><br><span class="line">    at com.android.org.conscrypt.OpenSSLSocketImpl.verifyCertificateChain(OpenSSLSocketImpl.java:<span class="number">550</span>)</span><br><span class="line">    at com.android.org.conscrypt.NativeCrypto.SSL_do_handshake(Native Method)</span><br><span class="line">    at com.android.org.conscrypt.OpenSSLSocketImpl.startHandshake(OpenSSLSocketImpl.java:<span class="number">318</span>)</span><br><span class="line"> ... <span class="number">10</span> more</span><br><span class="line">Caused by: java.security.cert.CertPathValidatorException: Trust anchor <span class="keyword">for</span> certification path not found.</span><br><span class="line"> ... <span class="number">16</span> more</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å› ä¸ºAndroid æ‰‹æœºæœ‰ä¸€å¥—å…±äº«è¯ä¹¦çš„æœºåˆ¶ï¼Œå¦‚æœç›®æ ‡ URL æœåŠ¡å™¨ä¸‹å‘çš„è¯ä¹¦ä¸åœ¨å·²ä¿¡ä»»çš„è¯ä¹¦åˆ—è¡¨é‡Œï¼Œæˆ–è€…è¯¥è¯ä¹¦æ˜¯è‡ªç­¾åçš„ï¼Œä¸æ˜¯ç”±æƒå¨æœºæ„é¢å‘ï¼Œé‚£ä¹ˆä¼šå‡ºå¼‚å¸¸ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªå®šä¹‰çš„éªŒè¯æœºåˆ¶è®©è¯ä¹¦é€šè¿‡éªŒè¯ã€‚è§£å†³æ–¹æ¡ˆå¤§å®¶å¯ä»¥ç§»æ­¥è¿™é‡Œï¼š<a href="http://pingguohe.net/2016/02/26/Android-App-secure-ssl.html" target="_blank" rel="noopener">Android App å®‰å…¨çš„HTTPS é€šä¿¡</a></p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank" rel="noopener">SSL/TLSåè®®è¿è¡Œæœºåˆ¶çš„æ¦‚è¿°</a> - é˜®ä¸€å³°</li>
<li><a href="https://www.barretlee.com/blog/2015/10/05/how-to-build-a-https-server/" target="_blank" rel="noopener">HTTPSè¯ä¹¦ç”ŸæˆåŸç†å’Œéƒ¨ç½²ç»†èŠ‚</a></li>
<li><a href="https://imququ.com/post/optimize-tls-handshake.html" target="_blank" rel="noopener">TLS æ¡æ‰‹ä¼˜åŒ–è¯¦è§£</a></li>
<li><a href="https://www.villainhr.com/page/2016/10/26/TLS%20&amp;%20SSL%20%E5%BF%AB%E9%80%9F%E8%BF%9B%E9%98%B6" target="_blank" rel="noopener">TLS &amp; SSL å¿«é€Ÿè¿›é˜¶</a></li>
<li><a href="http://pingguohe.net/2016/02/26/Android-App-secure-ssl.html" target="_blank" rel="noopener">Android App å®‰å…¨çš„HTTPS é€šä¿¡</a></li>
<li><a href="https://colobu.com/2016/06/07/simple-golang-tls-examples/" target="_blank" rel="noopener">ä½¿ç”¨Goå®ç°TLS æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      
        <div id="donation_div"></div>

<script src="../../../../js/vdonate.js"></script>
<script>
var a = new Donate({
  title: 'å¦‚æœè§‰å¾—æˆ‘çš„æ–‡ç« å¯¹æ‚¨æœ‰ç”¨ï¼Œè¯·éšæ„æ‰“èµã€‚æ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œ!', // å¯é€‰å‚æ•°ï¼Œæ‰“èµæ ‡é¢˜
  btnText: 'æ‰“èµæ”¯æŒ', // å¯é€‰å‚æ•°ï¼Œæ‰“èµæŒ‰é’®æ–‡å­—
  el: document.getElementById('donation_div'),
  wechatImage: 'https://raw.githubusercontent.com/iTimeTraveler/iTimeTraveler.github.io/site/source/about/donate/images/WeChanQR.png',
  alipayImage: 'https://raw.githubusercontent.com/iTimeTraveler/iTimeTraveler.github.io/site/source/about/donate/images/AliPayQR.jpg'
});
</script>
      
      
        
	<div id="comment">
		<!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
		</div>
		<!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->
	</div>



      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/HTTPS/">HTTPS</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="../../27/WebSocketåè®®æµ…æ/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
      <div class="article-nav-title">WebSocketåè®®æµ…æ</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="toc-sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
    
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTPS"><span class="nav-number">1.</span> <span class="nav-text">HTTPS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#TLSå†å²"><span class="nav-number">1.1.</span> <span class="nav-text">TLSå†å²</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TLSæ¡æ‰‹è¿‡ç¨‹"><span class="nav-number">2.</span> <span class="nav-text">TLSæ¡æ‰‹è¿‡ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Client-Hello-gt"><span class="nav-number">2.1.</span> <span class="nav-text">Client Hello =&gt;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Server-Hello-lt"><span class="nav-number">2.2.</span> <span class="nav-text">Server Hello &lt;=</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Client-Key-Exchange-gt"><span class="nav-number">2.3.</span> <span class="nav-text">Client Key Exchange =&gt;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Server-Finish-lt"><span class="nav-number">2.4.</span> <span class="nav-text">Server Finish &lt;=</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åº”ç”¨æ•°æ®ä¼ è¾“"><span class="nav-number">2.5.</span> <span class="nav-text">åº”ç”¨æ•°æ®ä¼ è¾“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡ ä¸ªåè¯"><span class="nav-number">3.</span> <span class="nav-text">å‡ ä¸ªåè¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®é™…æŠ“åŒ…"><span class="nav-number">4.</span> <span class="nav-text">å®é™…æŠ“åŒ…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç§é’¥çš„ä½œç”¨"><span class="nav-number">5.</span> <span class="nav-text">ç§é’¥çš„ä½œç”¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è‡ªç­¾åè¯ä¹¦"><span class="nav-number">6.</span> <span class="nav-text">è‡ªç­¾åè¯ä¹¦</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æœåŠ¡ç«¯è¯ä¹¦ç”Ÿæˆ"><span class="nav-number">6.1.</span> <span class="nav-text">æœåŠ¡ç«¯è¯ä¹¦ç”Ÿæˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç”ŸæˆæœåŠ¡ç«¯ç§é’¥-Generate-private-key-key"><span class="nav-number">6.1.1.</span> <span class="nav-text">ç”ŸæˆæœåŠ¡ç«¯ç§é’¥ Generate private key (.key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ç”ŸæˆæœåŠ¡ç«¯è‡ªç­¾åè¯ä¹¦-Generation-of-self-signed-x509-public-key-PEM-encodings-pem-crt-based-on-the-private-key"><span class="nav-number">6.1.2.</span> <span class="nav-text">ç”ŸæˆæœåŠ¡ç«¯è‡ªç­¾åè¯ä¹¦ Generation of self-signed(x509) public key (PEM-encodings .pem|.crt) based on the private (.key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Simple-Golang-HTTPS-TLS-Server"><span class="nav-number">6.1.3.</span> <span class="nav-text">Simple Golang HTTPS/TLS Server</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å®¢æˆ·ç«¯è®¿é—®ï¼ˆAndroidï¼‰"><span class="nav-number">6.2.</span> <span class="nav-text">å®¢æˆ·ç«¯è®¿é—®ï¼ˆAndroidï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒèµ„æ–™"><span class="nav-number">7.</span> <span class="nav-text">å‚è€ƒèµ„æ–™</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2013 - 2018 iTimeTraveler All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				è®¿å®¢æ•° : <span id="busuanzi_value_site_uv"></span> |  
				è®¿é—®é‡ : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
    <a href="../../../../categories" class="mobile-nav-link">Categories</a>
  
    <a href="../../../../tags" class="mobile-nav-link">Tags</a>
  
    <a href="../../../../funnysite" class="mobile-nav-link">é…·ç«™</a>
  
    <a href="../../../../collection" class="mobile-nav-link">æ”¶è—</a>
  
    <a href="../../../../about" class="mobile-nav-link">About</a>
  
    <a href="../../../../mybooks" class="mobile-nav-link">ğŸ</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="../../../../fancybox/jquery.fancybox.css">
  <script src="../../../../fancybox/jquery.fancybox.pack.js"></script>


<script src="../../../../js/scripts.js"></script>




  <script src="../../../../js/dialog.js"></script>








	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">è®¾ç½®</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              æ­£æ–‡å­—å·å¤§å°
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            æ‚¨å·²è°ƒæ•´é¡µé¢å­—ä½“å¤§å°
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              å¤œé—´æŠ¤çœ¼æ¨¡å¼
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            å¤œé—´æ¨¡å¼å·²ç»å¼€å¯ï¼Œå†æ¬¡å•å‡»æŒ‰é’®å³å¯å…³é—­ 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å…³ äº&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            iTimeTraveler
          </div>
          <div class="panel-body">
            Copyright Â© 2018 Mr.Seven All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
    <a id="menu-switch"><i class="fa fa-bars fa-lg"></i></a>
  
</body>
</html>