<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ | iTimeTraveler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="keywords" content="Algorithm" />
  
  
  
  
  <meta name="description" content="æœ¬æ–‡æ¥è‡ªï¼š ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ â€” miskcoo  æ¦‚è¿°è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•ï¼Œæˆ–è€…è®¡ç®—ä¸¤ä¸ªå¤§æ•´æ•°çš„ä¹˜æ³•æ˜¯åœ¨è®¡ç®—æœºä¸­å¾ˆå¸¸è§çš„è¿ç®—ï¼Œå¦‚æœç”¨æ™®é€šçš„æ–¹æ³•è¿›è¡Œï¼Œå¤æ‚åº¦å°†ä¼šæ˜¯$ \mathcal O(n^2) â€‹$çš„ï¼Œè¿˜æœ‰ä¸€ç§åˆ†æ²»ä¹˜æ³•ï¼Œå¯ä»¥åšåˆ° $\mathcal O(n^{\log_23}) â€‹$æ—¶é—´è®¡ç®—ï¼ˆå¯ä»¥çœ‹Karatsuba ä¹˜æ³•ï¼‰ã€‚ä¸‹é¢ä»è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•å‡ºå‘ï¼Œä»‹ç»å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFast">
<meta name="keywords" content="Algorithm">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢">
<meta property="og:url" content="http://github.com/2017/09/08/ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢/index.html">
<meta property="og:site_name" content="iTimeTraveler">
<meta property="og:description" content="æœ¬æ–‡æ¥è‡ªï¼š ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ â€” miskcoo  æ¦‚è¿°è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•ï¼Œæˆ–è€…è®¡ç®—ä¸¤ä¸ªå¤§æ•´æ•°çš„ä¹˜æ³•æ˜¯åœ¨è®¡ç®—æœºä¸­å¾ˆå¸¸è§çš„è¿ç®—ï¼Œå¦‚æœç”¨æ™®é€šçš„æ–¹æ³•è¿›è¡Œï¼Œå¤æ‚åº¦å°†ä¼šæ˜¯$ \mathcal O(n^2) â€‹$çš„ï¼Œè¿˜æœ‰ä¸€ç§åˆ†æ²»ä¹˜æ³•ï¼Œå¯ä»¥åšåˆ° $\mathcal O(n^{\log_23}) â€‹$æ—¶é—´è®¡ç®—ï¼ˆå¯ä»¥çœ‹Karatsuba ä¹˜æ³•ï¼‰ã€‚ä¸‹é¢ä»è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•å‡ºå‘ï¼Œä»‹ç»å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFast">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://github.com/gallery/android_common/FFT-of-Cosine-Summation-Function.png">
<meta property="og:updated_time" content="2018-03-14T08:13:59.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢">
<meta name="twitter:description" content="æœ¬æ–‡æ¥è‡ªï¼š ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ â€” miskcoo  æ¦‚è¿°è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•ï¼Œæˆ–è€…è®¡ç®—ä¸¤ä¸ªå¤§æ•´æ•°çš„ä¹˜æ³•æ˜¯åœ¨è®¡ç®—æœºä¸­å¾ˆå¸¸è§çš„è¿ç®—ï¼Œå¦‚æœç”¨æ™®é€šçš„æ–¹æ³•è¿›è¡Œï¼Œå¤æ‚åº¦å°†ä¼šæ˜¯$ \mathcal O(n^2) â€‹$çš„ï¼Œè¿˜æœ‰ä¸€ç§åˆ†æ²»ä¹˜æ³•ï¼Œå¯ä»¥åšåˆ° $\mathcal O(n^{\log_23}) â€‹$æ—¶é—´è®¡ç®—ï¼ˆå¯ä»¥çœ‹Karatsuba ä¹˜æ³•ï¼‰ã€‚ä¸‹é¢ä»è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•å‡ºå‘ï¼Œä»‹ç»å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFast">
<meta name="twitter:image" content="http://github.com/gallery/android_common/FFT-of-Cosine-Summation-Function.png">
  
    <link rel="alternate" href="/atom.xml" title="iTimeTraveler" type="application/atom+xml">
  

  

  <link rel="icon" href="/gallery/avatar/0.jpg">
  <link rel="apple-touch-icon" href="/gallery/avatar/0.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
  <link rel="stylesheet" href="../../../../css/style.css">

  <script src="../../../../js/jquery-3.1.1.min.js"></script>
  <script src="../../../../js/bootstrap.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    <link rel="stylesheet" href="../../../../css/dialog.css">
  

  

  
    <link rel="stylesheet" href="/css/header-post.css" >
  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

</head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 border-width: 0px;  margin-top: 8px;"  
                href="#" data-toggle="modal" data-target="#myModal" >
                  <img width="62px" height="75px" alt="Hike News" src="/gallery/avatar/0.jpg">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="../../../../index.html">é¦–é¡µ</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../archives">å½’æ¡£</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../categories">åˆ†ç±»</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../tags">æ ‡ç­¾</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../funnysite">é…·ç«™</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../collection">æ”¶è—</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../about">å…³äº</a> </li>
                
                  <li> <a class="main-nav-link" href="../../../../mybooks">ğŸ</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="è¯·è¾“å…¥å…³é”®è¯..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'æ–‡ç« ',
            PAGES: 'é¡µé¢',
            CATEGORIES: 'åˆ†ç±»',
            TAGS: 'æ ‡ç­¾',
            UNTITLED: '(æ— æ ‡é¢˜)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '../../../../content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="../../../../js/insight.js"></script>

</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢" style="width: 75%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="../../../../gallery/android_common/FFT-of-Cosine-Summation-Function.png" rel="gallery_cjgdba1jy0092sns615ku9i9c">
        <img src="../../../../gallery/android_common/FFT-of-Cosine-Summation-Function.png" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="" class="article-date">
	  <time datetime="2017-09-08T04:20:55.000Z" itemprop="datePublished">2017-09-08</time>
	</a>

      
    <a class="article-category-link" href="../../../../categories/Algorithm/">Algorithm</a>

      
	<a class="article-views">
	<span id="busuanzi_container_page_pv">
		é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>
	</span>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>æœ¬æ–‡æ¥è‡ªï¼š <a href="http://blog.miskcoo.com/2015/04/polynomial-multiplication-and-fast-fourier-transform" target="_blank" rel="noopener">ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢</a> â€” <a href="http://blog.miskcoo.com/about" target="_blank" rel="noopener">miskcoo</a></p>
</blockquote>
<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•ï¼Œæˆ–è€…è®¡ç®—ä¸¤ä¸ªå¤§æ•´æ•°çš„ä¹˜æ³•æ˜¯åœ¨è®¡ç®—æœºä¸­å¾ˆå¸¸è§çš„è¿ç®—ï¼Œå¦‚æœç”¨æ™®é€šçš„æ–¹æ³•è¿›è¡Œï¼Œå¤æ‚åº¦å°†ä¼šæ˜¯$ \mathcal O(n^2) â€‹$çš„ï¼Œè¿˜æœ‰ä¸€ç§åˆ†æ²»ä¹˜æ³•ï¼Œå¯ä»¥åšåˆ° $\mathcal O(n^{\log_23}) â€‹$æ—¶é—´è®¡ç®—ï¼ˆå¯ä»¥çœ‹<a href="http://blog.miskcoo.com/2014/10/karatsuba-multiplication" target="_blank" rel="noopener">Karatsuba ä¹˜æ³•</a>ï¼‰ã€‚ä¸‹é¢ä»è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•å‡ºå‘ï¼Œä»‹ç»<strong>å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFast Fourier Transform, FFTï¼‰</strong>å¦‚ä½•åœ¨ $\mathcal O(n\log n) â€‹$çš„æ—¶é—´å†…è®¡ç®—å‡ºä¸¤ä¸ªå¤šé¡¹å¼çš„ä¹˜ç§¯ã€‚</p>
<h2 id="å‡†å¤‡çŸ¥è¯†"><a href="#å‡†å¤‡çŸ¥è¯†" class="headerlink" title="å‡†å¤‡çŸ¥è¯†"></a>å‡†å¤‡çŸ¥è¯†</h2><p>è¿™é‡Œä»‹ç»ä¸€äº›åé¢å¯èƒ½ä¼šç”¨åˆ°çš„çŸ¥è¯†ï¼ˆä¸»è¦æ˜¯å…³äºå¤šé¡¹å¼ã€å·ç§¯ä»¥åŠå¤æ•°çš„ï¼‰ï¼Œå¦‚æœä½ å·²ç»çŸ¥é“è§‰å¾—å®ƒå¤ªæ°´äº†æˆ–è€…æƒ³ç”¨åˆ°çš„æ—¶å€™å†çœ‹å°±è·³è¿‡å§ã€‚</p>
<h2 id="å¤šé¡¹å¼"><a href="#å¤šé¡¹å¼" class="headerlink" title="å¤šé¡¹å¼"></a>å¤šé¡¹å¼</h2><p>ç®€å•æ¥è¯´ï¼Œå½¢å¦‚ $ a_0+a_1X+a_2X^2+\cdots+a_nX^n $ çš„ä»£æ•°è¡¨è¾¾å¼å«åš<strong>å¤šé¡¹å¼</strong>ï¼Œå¯ä»¥è®°ä½œ$P(X)=a_0+a_1X+a_2X^2+\cdots+a_nX^n$ï¼Œ$a_0, a_1, \cdots, a_n $å«åšå¤šé¡¹å¼çš„<strong>ç³»æ•°</strong>ï¼Œ$X $æ˜¯ä¸€ä¸ªä¸å®šå…ƒï¼Œä¸è¡¨ç¤ºä»»ä½•å€¼ï¼Œä¸å®šå…ƒåœ¨å¤šé¡¹å¼ä¸­æœ€å¤§é¡¹çš„æ¬¡æ•°ç§°ä½œå¤šé¡¹å¼çš„<strong>æ¬¡æ•°</strong></p>
<h3 id="å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•"><a href="#å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•" class="headerlink" title="å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•"></a>å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•</h3><p>åƒåˆšåˆšæˆ‘ä»¬æåˆ°çš„é‚£äº›å¤šé¡¹å¼ï¼Œéƒ½æ˜¯ä»¥ç³»æ•°å½¢å¼è¡¨ç¤ºçš„ï¼Œä¹Ÿå°±æ˜¯å°† n æ¬¡å¤šé¡¹å¼$ A(x) $çš„ç³»æ•° $a_0, a_1, \cdots, a_n $çœ‹ä½œ $n+1 $ç»´å‘é‡$ \vec a=(a_0,a_1,\cdots,a_n)$ï¼Œå…¶<strong>ç³»æ•°è¡¨ç¤ºï¼ˆcoefficient representationï¼‰</strong>å°±æ˜¯å‘é‡$ \vec a$ ã€‚</p>
<a id="more"></a>
<h3 id="å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºæ³•"><a href="#å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºæ³•" class="headerlink" title="å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºæ³•"></a>å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºæ³•</h3><p>å¦‚æœé€‰å–$ n+1 $ä¸ªä¸åŒçš„æ•° $x_0, x_1, \cdots, x_n $å¯¹å¤šé¡¹å¼è¿›è¡Œæ±‚å€¼ï¼Œå¾—åˆ°$ A(x_0), A(x_1), \cdots, A(x_n)$ï¼Œé‚£ä¹ˆå°±ç§°$ {\left(x_i, A(x_i)\right) : 0 \leq i \leq n, i \in \mathbb Z} $ä¸ºå¤šé¡¹å¼$ A(x)$ çš„<strong>ç‚¹å€¼è¡¨ç¤ºï¼ˆpoint-value representationï¼‰</strong></p>
<p>å¤šé¡¹å¼$ A(x) $çš„ç‚¹å€¼è¡¨ç¤ºä¸æ­¢ä¸€ç§ï¼Œä½ åªè¦é€‰å–ä¸åŒçš„æ•°å°±å¯ä»¥å¾—åˆ°ä¸åŒçš„ç‚¹å€¼è¡¨ç¤ºï¼Œä½†æ˜¯ä»»ä½•ä¸€ç§ç‚¹å€¼è¡¨ç¤ºéƒ½èƒ½å”¯ä¸€ç¡®å®šä¸€ä¸ªå¤šé¡¹å¼ï¼Œä¸ºäº†ä»ç‚¹å€¼è¡¨ç¤ºè½¬æ¢æˆç³»æ•°è¡¨ç¤ºï¼Œå¯ä»¥ç›´æ¥é€šè¿‡<strong>æ’å€¼</strong>çš„æ–¹æ³•</p>
<h2 id="å¤æ•°"><a href="#å¤æ•°" class="headerlink" title="å¤æ•°"></a>å¤æ•°</h2><p>åé¢æåˆ°çš„$ i$ï¼Œé™¤éä½œä¸º$ \sum $æ±‚å’Œçš„å˜é‡ï¼Œå…¶ä½™çš„éƒ½è¡¨ç¤ºè™šæ•°å•ä½ $\sqrt{-1}$</p>
<h3 id="å•ä½æ ¹"><a href="#å•ä½æ ¹" class="headerlink" title="å•ä½æ ¹"></a>å•ä½æ ¹</h3><p>$n $æ¬¡å•ä½æ ¹æ˜¯æŒ‡èƒ½å¤Ÿæ»¡è¶³æ–¹ç¨‹$ z^n=1 $çš„å¤æ•°ï¼Œè¿™äº›å¤æ•°ä¸€å…±æœ‰$ n $ä¸ªå®ƒä»¬éƒ½åˆ†å¸ƒåœ¨å¤å¹³é¢çš„å•ä½åœ†ä¸Šï¼Œå¹¶ä¸”æ„æˆä¸€ä¸ªæ­£ $n $è¾¹å½¢ï¼Œå®ƒä»¬æŠŠå•ä½åœ†ç­‰åˆ†æˆ$ n $ä¸ªéƒ¨åˆ†</p>
<p>æ ¹æ®å¤æ•°ä¹˜æ³•ç›¸å½“äºæ¨¡é•¿ç›¸ä¹˜ï¼Œå¹…è§’ç›¸åŠ å°±å¯ä»¥çŸ¥é“ï¼Œ$n $æ¬¡å•ä½æ ¹çš„æ¨¡é•¿ä¸€å®šæ˜¯$ 1$ï¼Œå¹…è§’çš„$ n $å€æ˜¯$ 0$<br>è¿™æ ·ï¼Œ$n$ æ¬¡å•ä½æ ¹ä¹Ÿå°±æ˜¯</p>
<p>$$ e^{\frac{2\pi ki}{n}}, k = 0, 1, 2, \cdots, n - 1 $$<br>å†æ ¹æ®æ¬§æ‹‰å…¬å¼</p>
<p>$$ e^{\theta i}=\cos\theta + i\sin\theta $$<br>å°±å¯ä»¥çŸ¥é“ n æ¬¡å•ä½æ ¹çš„ç®—æœ¯è¡¨ç¤º</p>
<p>å¦‚æœè®°$ \omega_n=e^{\frac{2\pi i}{n}}$ï¼Œé‚£ä¹ˆ$ n $æ¬¡å•ä½æ ¹å°±æ˜¯ $\omega_n^0, \omega_n^1, \cdots, \omega_n^{n-1}$</p>
<h2 id="å¤šé¡¹å¼çš„ä¹˜æ³•"><a href="#å¤šé¡¹å¼çš„ä¹˜æ³•" class="headerlink" title="å¤šé¡¹å¼çš„ä¹˜æ³•"></a>å¤šé¡¹å¼çš„ä¹˜æ³•</h2><p>ç»™å®šä¸¤ä¸ªå¤šé¡¹å¼$ A(x), B(x)$<br>
$$
A(x) = \sum_{i=0}^na_ix^i = a_nx^n+a_{n-1}x^{n-1}+\cdots+a_1x+a_0 \\ B(x) = \sum_{i=0}^nb_ix^i = b_nx^n+b_{n-1}x^{n-1}+\cdots+b_1x+b_0 
$$
<br>å°†è¿™ä¸¤ä¸ªå¤šé¡¹å¼ç›¸ä¹˜å¾—åˆ°$ C(x) = \sum_{i=0}^{2n}c_ix^i$ï¼Œåœ¨è¿™é‡Œ</p>

$$
c_i=\sum_{j+k=i,0\leq j,k\leq n}a_jb_kx^i 
$$

<p>å¦‚æœä¸€ä¸ªä¸ªå»ç®—$ c_i $çš„è¯ï¼Œè¦èŠ±è´¹$ \mathcal O(n^2) $çš„æ—¶é—´æ‰å¯ä»¥å®Œæˆï¼Œä½†æ˜¯ï¼Œè¿™æ˜¯åœ¨ç³»æ•°è¡¨ç¤ºä¸‹è®¡ç®—çš„ï¼Œå¦‚æœè½¬æ¢æˆç‚¹å€¼è¡¨ç¤ºï¼ŒçŸ¥é“äº†$ A(x), B(x) $çš„ç‚¹å€¼è¡¨ç¤ºåï¼Œç”±äºåªæœ‰$ n+1$ ä¸ªç‚¹ï¼Œå°±å¯ä»¥ç›´æ¥å°†å…¶ç›¸ä¹˜ï¼Œåœ¨ $\mathcal O(n) $çš„æ—¶é—´å†…å¾—åˆ°$ C(x)$ çš„ç‚¹å€¼è¡¨ç¤º</p>
<p>å¦‚æœèƒ½å¤Ÿæ‰¾åˆ°ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•å¸®åŠ©æˆ‘ä»¬åœ¨å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºå’Œç³»æ•°è¡¨ç¤ºä¹‹é—´è½¬æ¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¿«é€Ÿåœ°è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•äº†ï¼Œå¿«é€Ÿå‚…é‡Œå¶å˜æ¢å°±å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹</p>
<h2 id="å¿«é€Ÿå‚…é‡Œå¶å˜æ¢"><a href="#å¿«é€Ÿå‚…é‡Œå¶å˜æ¢" class="headerlink" title="å¿«é€Ÿå‚…é‡Œå¶å˜æ¢"></a>å¿«é€Ÿå‚…é‡Œå¶å˜æ¢</h2><p>å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ä½ å¯ä»¥è®¤ä¸ºæœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼ŒDFT å’Œ IDFTï¼Œåˆ†åˆ«å¯ä»¥åœ¨$ \mathcal O(n\log n) $çš„æ—¶é—´å†…å°†å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºè½¬åŒ–æˆç‚¹å€¼è¡¨ç¤ºï¼Œå¹¶ä¸”è½¬å›æ¥ï¼Œå°±åƒä¸‹é¢è¿™å¼ å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/gallery/fft/polynomial-multiplication.png" alt=""></p>
<h3 id="Cooley-Tukeyç®—æ³•"><a href="#Cooley-Tukeyç®—æ³•" class="headerlink" title="Cooley-Tukeyç®—æ³•"></a>Cooley-Tukeyç®—æ³•</h3><p>FFT æœ€å¸¸è§çš„ç®—æ³•æ˜¯ Cooley-Tukey ç®—æ³•ï¼Œå®ƒçš„åŸºæœ¬æ€è·¯åœ¨ 1965 å¹´ç”± J. W. Cooley å’Œ J. W. Tukey æå‡ºçš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºåˆ†æ²»ç­–ç•¥çš„ç®—æ³•</p>
<p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ª$ n-1 $æ¬¡å¤šé¡¹å¼$ A(x)=\sum_{i=0}^{n-1}a_ix^i$ï¼ˆä¸ºäº†æ–¹ä¾¿ï¼Œå‡è®¾$ n=2^m, m\in \mathbb Z$ï¼Œå¦‚æœä¸è¶³å¯ä»¥åœ¨é«˜æ¬¡é¡¹ç³»æ•°è¡¥æˆ 0ï¼‰</p>
<p>å°†$ n $ä¸ª$ n $æ¬¡å•ä½æ ¹$ \omega_n^0, \omega_n^1, \cdots, \omega_n^{n-1}$ å¸¦å…¥$ A(x) $å°†å…¶è½¬æ¢æˆç‚¹å€¼è¡¨è¾¾</p>

$$
A(\omega_n^k) = \sum_{i=0}^{n-1}a_i\omega^{ki} , k = 0, 1, \cdots, n - 1 
$$

<p>ç‚¹å€¼å‘é‡ $ \vec y=(A(\omega_n^0), A(\omega_n^1), \cdots, A(\omega_n^{n-1})) $ ç§°ä½œç³»æ•°å‘é‡$Â \vec a=(a_0, a_1, \cdots, a_{n-1})Â $çš„<strong>ç¦»æ•£å‚…é‡Œå¶å˜æ¢</strong>ï¼ˆDiscrete Fourier Transform, DFTï¼‰ï¼Œä¹Ÿè®°ä½œ$ \vec y=DFT_n(\vec a) $</p>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œç›´æ¥è®¡ç®—$ DFT_n(\vec a) $è¿˜æ˜¯éœ€è¦$ \mathcal O(n^2) $çš„æ—¶é—´ï¼ŒCooley-Tukey ç®—æ³•æ¥ä¸‹æ¥åšçš„äº‹æƒ…æ˜¯å°†æ¯ä¸€é¡¹æŒ‰ç…§æŒ‡æ•°å¥‡å¶åˆ†ç±»</p>

$$
\begin{eqnarray*} A(\omega_n^k) &=& \sum_{i=0}^{n-1}a_i\omega_n^{ki} \\ &=& \sum_{i=0}^{\frac{n}{2}-1}a_{2i}\omega_n^{2ki}+\omega_n^k\sum_{i=0}^{\frac{n}{2}-1}a_{2i+1}\omega_n^{2ki} \\ \end{eqnarray*} 
$$

<p>ä½†æ˜¯ï¼Œå¦‚æœç›´æ¥è¿™æ ·é€’å½’ä¸‹å»ï¼Œä½ éœ€è¦å¸¦å…¥çš„å€¼è¿˜æ˜¯æœ‰$ n $ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç°åœ¨åªæ˜¯å°†ç³»æ•°å‡åŠï¼Œè€Œæ²¡æœ‰å°†éœ€è¦å¸¦å…¥çš„å€¼å‡åŠï¼Œä¸Šé¢çš„$ k $è¿˜æ˜¯$ 0, 1, \cdots, n - 1$ï¼Œè¿™æ ·çš„è¯å¤æ‚åº¦è¿˜æ˜¯$ \mathcal O(n^2)$</p>
<p>ä½†æ˜¯ä½ ä¼šæ³¨æ„åˆ°ï¼Œæ ¹æ®å‡†å¤‡çŸ¥è¯†ä¸­$Â \omega_n^2=\left(e^{\frac{2\pi i}{n}}\right)^2=e^{\frac{2\pi i}{n/2}}=\omega_{\frac{n}{2}}$ ï¼Œå¹¶ä¸”$ \frac{n}{2} $æ¬¡å•ä½æ ¹åªæœ‰$ \frac{n}{2} $ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦å¸¦å…¥çš„å€¼å†å¹³æ–¹ä»¥åä¼¼ä¹å˜å°‘äº†ä¸€åŠï¼Ÿä»”ç»†æƒ³æƒ³å°±ä¼šå‘ç°ï¼Œæ—¢ç„¶å•ä½æ ¹æŠŠå•ä½åœ†ç­‰åˆ†ï¼Œé‚£ä¹ˆè‚¯å®šä¼šå¯¹ç§°ï¼Œä¹Ÿå°±æ˜¯æœ‰ä¸€ä¸ªæ­£çš„ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªè´Ÿçš„ï¼Œå¹³æ–¹åè¿™ä¸¤ä¸ªå½“ç„¶å°±ç›¸åŒäº†ã€‚ä¸¥æ ¼ä¸€ç‚¹çš„è¯æ˜å°±æ˜¯</p>

$$
\omega_n^{\frac{n}{2}+k} = \omega_n^{\frac{n}{2}}\cdot \omega_n^k = -\omega_n^k 
$$

<p>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äº$ k &lt; \frac{n}{2}$ çš„æ—¶å€™</p>

$$
A(\omega_n^k) = \sum_{i=0}^{\frac{n}{2}-1}a_{2i}\omega_{\frac{n}{2}}^{ki}+\omega_n^{k}\sum_{i=0}^{\frac{n}{2}-1}a_{2i+1}\omega_{\frac{n}{2}}^{ki} 
$$

<p>å¹¶ä¸”</p>

$$
\begin{eqnarray*} A(\omega_n^{k+\frac{n}{2}}) &=& \sum_{i=0}^{\frac{n}{2}-1}a_{2i}\omega_{\frac{n}{2}}^{ki}+\omega_n^{k+\frac{n}{2}}\sum_{i=0}^{\frac{n}{2}-1}a_{2i+1}\omega_{\frac{n}{2}}^{ki} \\ &=&\sum_{i=0}^{\frac{n}{2}-1}a_{2i}\omega_{\frac{n}{2}}^{ki}-\omega_n^k\sum_{i=0}^{\frac{n}{2}-1}a_{2i+1}\omega_{\frac{n}{2}}^{ki} \end{eqnarray*} 
$$

<p>è¿™æ ·æˆ‘ä»¬å°±å°†éœ€è¦å¸¦å…¥çš„å€¼ä¹Ÿå‡å°‘æˆäº† $Â 1, \omega_{\frac{n}{2}}, \omega_{\frac{n}{2}}^2, \cdots, \omega_{\frac{n}{2}}^{\frac{n}{2}-1} $ï¼Œé—®é¢˜å˜æˆäº†ä¸¤ä¸ªè§„æ¨¡å‡åŠçš„å­é—®é¢˜ï¼Œåªè¦é€’å½’ä¸‹å»è®¡ç®—å°±å¯ä»¥äº†ï¼Œè‡³äºå¤æ‚åº¦</p>

$$
T(n) = 2T(\frac{n}{2})+\mathcal O(n) = \mathcal O(n\log n) 
$$

<h3 id="å‚…é‡Œå¶é€†å˜æ¢ï¼ˆIDFTï¼‰"><a href="#å‚…é‡Œå¶é€†å˜æ¢ï¼ˆIDFTï¼‰" class="headerlink" title="å‚…é‡Œå¶é€†å˜æ¢ï¼ˆIDFTï¼‰"></a>å‚…é‡Œå¶é€†å˜æ¢ï¼ˆIDFTï¼‰</h3><p>åˆšåˆšè®¡ç®—çš„æ˜¯$ \vec y = DFT_n(\vec a)$ï¼Œå¯ä»¥å°†å¤šé¡¹å¼è½¬åŒ–æˆç‚¹å€¼è¡¨ç¤ºï¼Œç°åœ¨ä¸ºäº†å°†ç‚¹å€¼è¡¨ç¤ºè½¬åŒ–æˆç³»æ•°è¡¨ç¤ºï¼Œéœ€è¦è®¡ç®— IDFTï¼ˆInverse Discrete Fourier Transformï¼‰ï¼Œå®ƒæ˜¯ DFT çš„é€†</p>
<p>è¿™ä¸ªé—®é¢˜å®é™…ä¸Šç›¸å½“äºæ˜¯ä¸€ä¸ªè§£çº¿æ€§æ–¹ç¨‹ç»„çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ç»™å‡ºäº†$ n $ä¸ªçº¿æ€§æ–¹ç¨‹</p>

$$
\begin{equation*} \left\{ \begin{array}{ccccccccc} a_0(\omega_n^0)^{0}&+&\cdots&+&a_{n-2}(\omega_n^0)^{n-2}&+&+a_{n-1}(\omega_n^0)^{n-1}&=&A(\omega_n^0) \\ a_0(\omega_n^1)^{0}&+&\cdots&+&a_{n-2}(\omega_n^1)^{n-2}&+&+a_{n-1}(\omega_n^1)^{n-1}&=&A(\omega_n^1) \\ \vdots & & \vdots & &\vdots& & \vdots & & \vdots\\ a_0(\omega_n^{n-1})^{0}&+&\cdots&+&a_{n-2}(\omega_n^{n-1})^{n-2}&+&+a_{n-1}(\omega_n^{n-1})^{n-1}&=&A(\omega_n^{n-1}) \end{array} \right. \end{equation*}
$$

<p>å†™æˆçŸ©é˜µæ–¹ç¨‹çš„å½¢å¼å°±æ˜¯</p>

$$
\begin{equation} \label{IDFT-equation} \begin{bmatrix} (\omega_n^0)^0 & (\omega_n^0)^1 & \cdots & (\omega_n^0)^{n-1} \\ (\omega_n^1)^0 & (\omega_n^1)^1 & \cdots & (\omega_n^1)^{n-1} \\ \vdots & \vdots & \ddots & \vdots \\ (\omega_n^{n-1})^0 & (\omega_n^{n-1})^1 & \cdots & (\omega_n^{n-1})^{n-1} \end{bmatrix} \begin{bmatrix} a_0 \\ a_1 \\ \vdots \\ a_{n-1} \end{bmatrix} = \begin{bmatrix} A(\omega_n^0) \\ A(\omega_n^1) \\ \vdots \\ A(\omega_n^{n-1}) \end{bmatrix} \end{equation}
$$

<p>è®°ä¸Šé¢çš„ç³»æ•°çŸ©é˜µä¸º$ \mathbf V$ ç°åœ¨è€ƒè™‘ä¸‹é¢è¿™ä¸ªçŸ©é˜µ$ d_{ij}=\omega_n^{-ij}$</p>

$$
\begin{equation*} \mathbf D = \begin{bmatrix} (\omega_n^{-0})^0 & (\omega_n^{-0})^1 & \cdots & (\omega_n^{-0})^{n-1} \\ (\omega_n^{-1})^0 & (\omega_n^{-1})^1 & \cdots & (\omega_n^{-1})^{n-1} \\ \vdots & \vdots & \ddots & \vdots \\ (\omega_n^{-(n-1)})^0 & (\omega_n^{-(n-1)})^1 & \cdots & (\omega_n^{-(n-1)})^{n-1} \end{bmatrix} \end{equation*}
$$

<p>è®¾å®ƒä»¬ç›¸ä¹˜åçš„ç»“æœæ˜¯$ \mathbf E=\mathbf D \cdot \mathbf V$</p>

$$
\begin{eqnarray*} e_{ij} &=& \sum_{k=0}^{n-1} d_{ik} v_{kj} \\ &=& \sum_{k=0}^{n-1} \omega_n^{-ik}\omega_n^{kj} \\ &=& \sum_{k=0}^{n-1} \omega_n^{k(j-i)} \end{eqnarray*}
$$

<p>å½“$ i=j $æ—¶ï¼Œ$e_{ij}=n$</p>
<p>å½“$ i\neq j $æ—¶ï¼Œ</p>

$$
\begin{eqnarray*} e_{ij} &=& \sum_{k=0}^{n-1} (\omega_n^{j-i})^k \\ &=& \frac{1-(\omega_n^{j-i})^n}{1-\omega_n^{j-i}}\\ &=& 0 \end{eqnarray*}
$$

<p>å› æ­¤å¯ä»¥çŸ¥é“$ \mathbf I_n=\frac{1}{n}\mathbf E$ï¼Œæ‰€ä»¥$ \frac{1}{n}\mathbf D = \mathbf V^{-1}$</p>
<p>å°†$ \frac{1}{n}\mathbf D $åœ¨$ \ref{IDFT-equation} $ å·¦ä¹˜å°±ä¼šå¾—åˆ°</p>

$$
\begin{equation*} \begin{bmatrix} a_0 \\ a_1 \\ \vdots \\ a_{n-1} \end{bmatrix} = \frac{1}{n} \begin{bmatrix} (\omega_n^{-0})^0 & (\omega_n^{-0})^1 & \cdots & (\omega_n^{-0})^{n-1} \\ (\omega_n^{-1})^0 & (\omega_n^{-1})^1 & \cdots & (\omega_n^{-1})^{n-1} \\ \vdots & \vdots & \ddots & \vdots \\ (\omega_n^{-(n-1)})^0 & (\omega_n^{-(n-1)})^1 & \cdots & (\omega_n^{-(n-1)})^{n-1} \end{bmatrix} \begin{bmatrix} A(\omega_n^0) \\ A(\omega_n^1) \\ \vdots \\ A(\omega_n^{n-1}) \end{bmatrix} \end{equation*}
$$

<p>è¿™æ ·ï¼ŒIDFT å°±ç›¸å½“äºæŠŠ DFT è¿‡ç¨‹ä¸­çš„$ \omega_n^i $æ¢æˆ$ \omega_n^{-i}$ï¼Œç„¶ååšä¸€æ¬¡ DFTï¼Œä¹‹åç»“æœé™¤ä»¥$ n$ å°±å¯ä»¥äº†ã€‚</p>
<h3 id="ç®—æ³•å®ç°"><a href="#ç®—æ³•å®ç°" class="headerlink" title="ç®—æ³•å®ç°"></a>ç®—æ³•å®ç°</h3><h4 id="é€’å½’å®ç°"><a href="#é€’å½’å®ç°" class="headerlink" title="é€’å½’å®ç°"></a>é€’å½’å®ç°</h4><p>æ ¹æ®å‰é¢çš„è¯´æ˜ï¼Œé€’å½’å®ç°çš„ FFT åº”è¯¥ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä¸‹é¢å°±ç›´æ¥ç»™å‡º C++ ä»£ç äº†ï¼ˆä¸»æ„ nè¦è¡¥é½åˆ° $2^m$ï¼‰</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt;* buffer, <span class="keyword">int</span> offset, <span class="keyword">int</span> step, <span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt;* epsilon)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n == <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">int</span> m = n &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	fft(m, buffer, offset, step &lt;&lt; <span class="number">1</span>, epsilon);</span><br><span class="line">	fft(m, buffer, offset + step, step &lt;&lt; <span class="number">1</span>, epsilon);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k != m; ++k)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> pos = <span class="number">2</span> * step * k;</span><br><span class="line">		temp[k] = buffer[pos + offset] + epsilon[k * step] * buffer[pos + offset + step];</span><br><span class="line">		temp[k + m] = buffer[pos + offset] - epsilon[k * step] * buffer[pos + offset + step];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i != n; ++i)</span><br><span class="line">		buffer[i * step + offset] = temp[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„ <code>epsilon</code>æ˜¯äº‹å…ˆæ‰“å¥½äº†çš„$ \omega_n $çš„è¡¨</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_epsilon</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i != n; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		epsilon[i] = <span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt;(<span class="built_in">cos</span>(<span class="number">2.0</span> * pi * i / n), <span class="built_in">sin</span>(<span class="number">2.0</span> * pi * i / n)); </span><br><span class="line">		arti_epsilon[i] = conj(epsilon[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è¿­ä»£å®ç°"><a href="#è¿­ä»£å®ç°" class="headerlink" title="è¿­ä»£å®ç°"></a>è¿­ä»£å®ç°</h4><p>å‡è®¾ç°åœ¨æœ‰$ 16 $ä¸ªæ•°è¦è¿›è¡Œ$DFT $æ¥çœ‹çœ‹é€’å½’çš„è¿‡ç¨‹</p>
<p><img src="/gallery/fft/bit-reverse.png" alt=""></p>
<p>åœ¨ Step1 -&gt; Step2 çš„è¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§å¥‡å¶åˆ†ç±»ï¼ŒäºŒè¿›åˆ¶ä½ä¸­æœ€åä¸€ä½ç›¸åŒçš„è¢«åˆ†åˆ°åŒä¸€ç»„</p>
<p>åœ¨ Step2 -&gt; Step3 çš„è¿‡ç¨‹ä¸­ï¼Œä»ç„¶æŒ‰ç…§å¥‡å¶ï¼Œåªä¸è¿‡ä¸æ˜¯æŒ‰ç…§æ•°å­—çš„å¥‡å¶æ€§ï¼Œè€Œæ˜¯ä¸‹æ ‡çš„å¥‡å¶æ€§ï¼ŒäºŒè¿›åˆ¶ä½ä¸­æœ€åä¸¤ä½ç›¸åŒçš„æ‰è¢«åˆ†åˆ°åŒä¸€ç»„</p>
<p>åœ¨ Step3 -&gt; Step4 çš„è¿‡ç¨‹ä¸­ï¼ŒäºŒè¿›åˆ¶ä½ä¸­æœ€åä¸‰ä½ç›¸åŒçš„æ•°å­—è¢«åˆ†åœ¨åŒä¸€ç»„</p>
<p>ç°åœ¨å°†æ•´ä¸ªäºŒè¿›åˆ¶ä½åè½¬ï¼Œä¾‹å¦‚ 0010 å°±å˜æˆ 0100ï¼Œè¿™æ—¶å€™æ¯æ¬¡åœ¨åŒä¸€ç»„çš„æ•°å­—ï¼Œåè½¬åçš„äºŒè¿›åˆ¶ä½å‰å‡ ä½éƒ½æ˜¯ç›¸åŒçš„ï¼Œè¿™ä¼¼ä¹ååˆ†ç±»ä¼¼åŠ æ³•ï¼Œç›¸é‚»ä¸¤ç»„äºŒè¿›åˆ¶ä½åè½¬ä¹‹åæ•°å­—ä¼šæ˜¯è¿ç»­çš„ä¸€æ®µåŒºé—´ã€‚ä¾‹å¦‚åœ¨ Step3 ä¸­ï¼Œ1ã€5ã€9ã€13 è¿™ä¸€ç»„ï¼Œåè½¬äºŒè¿›åˆ¶åæ˜¯ 1(1000)ã€5(1010)ã€9(1001)ã€13(1011)ï¼Œåˆ†ç»„åæ˜¯ 1(1000)ã€9(1001) å’Œ 5(1010)ã€13(1011)</p>
<p>å‡è®¾<code>reverse(i)</code>æ˜¯å°†äºŒè¿›åˆ¶ä½åè½¬çš„æ“ä½œï¼ŒDFT æœ€åä¸€æ­¥çš„æ•°ç»„æ˜¯ Bï¼ŒåŸæ¥çš„æ•°ç»„æ˜¯ Aï¼Œé‚£ä¹ˆ A å’Œ B ä¹‹é—´æœ‰è¿™æ ·çš„å…³ç³»<code>B[reverse(i)]=A[i]</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ <code>B[i + 1]=A[reverse(reverse(i)+ 1)]</code>ï¼ŒB ä¸­ç¬¬ i é¡¹çš„ä¸‹ä¸€é¡¹å°±æ˜¯å°† i åè½¬ååŠ  1 å†åè½¬å›æ¥ A ä¸­çš„é‚£ä¸€é¡¹ï¼Œæ‰€ä»¥ç°åœ¨è¦æ¨¡æ‹Ÿçš„å°±æ˜¯ä»é«˜ä½å¼€å§‹çš„äºŒè¿›åˆ¶åŠ æ³•</p>
<p>è€ƒè™‘æ­£å‘äºŒè¿›åˆ¶åŠ æ³•çš„è¿‡ç¨‹ï¼Œç›¸å½“äºä»æœ€ä½ä½å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª 0ï¼Œç„¶åæŠŠè¿™ä¸ª 0 æ”¹æˆ 1ï¼Œä¹‹å‰çš„ 1 å…¨éƒ¨å˜æˆ 0ã€‚é‚£ä¹ˆåå‘äºŒè¿›åˆ¶åŠ æ³•å°±æ˜¯ä»æœ€é«˜ä½å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª 0ï¼Œç„¶åæŠŠè¿™ä¸ª 0 æ”¹æˆ 1ï¼Œå‰é¢çš„ 1 å…¨éƒ¨æ”¹æˆ 0ï¼Œæ‰€ä»¥å°±æ˜¯è¿™æ ·</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">reverse_add</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">1</span> &lt;&lt; bit_length; (x ^= l) &lt; l; l &gt;&gt;= <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†ä»åŸæ¥çš„ A æ•°ç»„ï¼Œå¾—åˆ°æœ€åä¸€æ­¥æ‰€éœ€è¦çš„ B æ•°ç»„ï¼Œåªè¦ç»´æŠ¤ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯å½“å‰ä¸‹æ ‡ iï¼Œä¸€ä¸ªæ˜¯åå‘åŠ çš„ä¸‹æ ‡ jï¼Œè¡¨ç¤º B[i] åº”è¯¥æ”¾ A[j] æ”¾çš„ä¸œè¥¿ï¼Œå¦‚æœ i &gt; jï¼Œåªè¦å°† i å’Œ j å­˜çš„ä¸œè¥¿äº¤æ¢ï¼Œè¿™æ ·æœ€åå°±å¯ä»¥å¾—åˆ°æ‰€éœ€è¦çš„ B æ•°ç»„</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è¿™æ—¶å€™ n å·²ç»è¡¥é½åˆ° 2 çš„å¹‚æ¬¡ */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bit_reverse</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">complex_t</span> *x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i != n; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(i &gt; j) swap(x[i], x[j]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> l = n &gt;&gt; <span class="number">1</span>; (j ^= l) &lt; l; l &gt;&gt;= <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å·²ç»æŠŠè¦å˜æ¢çš„å…ƒç´ æ’åœ¨ç›¸é‚»ä½ç½®äº†ï¼Œæ‰€ä»¥ä»ä¸‹å¾€ä¸Š $2 $å¼€å§‹åˆ° $2^m $æ¥è¿›è¡Œè®¡ç®—ï¼Œæ¯æ¬¡æšä¸¾ä¸€å—å¾€ä¸Šè¿­ä»£å³å¯ï¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">transform</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">complex_t</span> *x, <span class="keyword">complex_t</span> *w)</span> </span>&#123;</span><br><span class="line">	bit_reverse(n, x);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> m = i &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k != m; ++k)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">complex_t</span> z = x[j + m + k] * w[n / i * k];</span><br><span class="line">				x[j + m + k] = x[j + k] - z;</span><br><span class="line">				x[j + k] += z;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å¿«é€Ÿæ•°è®ºå˜æ¢"><a href="#å¿«é€Ÿæ•°è®ºå˜æ¢" class="headerlink" title="å¿«é€Ÿæ•°è®ºå˜æ¢"></a>å¿«é€Ÿæ•°è®ºå˜æ¢</h2><p>ç”±äº FFT æ¶‰åŠåˆ°å¤æ•°è¿ç®—ï¼Œéš¾å…æœ‰ç²¾åº¦é—®é¢˜ï¼Œåœ¨è®¡ç®—ä¸€äº›åªè¦æ±‚æ•´æ•°çš„å·ç§¯æˆ–é«˜ç²¾åº¦ä¹˜æ³•çš„æ—¶å€™å°±æœ‰å¯èƒ½ç”±äºç²¾åº¦å‡ºç°é”™è¯¯ï¼Œè¿™ä¾¿è®©æˆ‘ä»¬è€ƒè™‘æ˜¯å¦æœ‰åœ¨æ¨¡æ„ä¹‰ä¸‹çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯<strong>å¿«é€Ÿæ•°è®ºå˜æ¢</strong>ï¼ˆFast Number-Theoretic Transformï¼ŒFNTï¼‰</p>
<p>é¦–å…ˆæ¥çœ‹ FFT ä¸­èƒ½åœ¨$ \mathcal O(n\log n) $æ—¶é—´å†…å˜æ¢ç”¨åˆ°äº†å•ä½æ ¹ $\omega $çš„ä»€ä¹ˆæ€§è´¨</p>
<ol>
<li><p>$\omega_n^n=1$</p>
</li>
<li><p>$\omega_n^0, \omega_n^1, \cdots, \omega_n^{n-1} $æ˜¯äº’ä¸ç›¸åŒçš„ï¼Œè¿™æ ·å¸¦å…¥è®¡ç®—å‡ºæ¥çš„ç‚¹å€¼æ‰å¯ä»¥ç”¨æ¥è¿˜åŸå‡ºç³»æ•°</p>
</li>
<li><p>$ \omega_n^2=\omega_{\frac{n}{2}}, \omega_n^{\frac{n}{2}+k}=-\omega_n^k $ ï¼Œè¿™ä½¿å¾—åœ¨æŒ‰ç…§æŒ‡æ•°å¥‡å¶åˆ†ç±»ä¹‹åèƒ½å¤ŸæŠŠå¸¦å…¥çš„å€¼ä¹Ÿå‡åŠä½¿å¾—é—®é¢˜è§„æ¨¡èƒ½å¤Ÿå‡åŠ</p>
</li>
<li>$$ \sum_{k=0}^{n-1} (\omega_n^{j-i})^k = \begin{eqnarray*} \left\{ \begin{aligned}0, ~~~&i \neq j\\ n, ~~~&i = j \end{aligned} \right. \end{eqnarray*} $$ 
<p>â€‹</p>
<p>è¿™ç‚¹ä¿è¯äº†èƒ½å¤Ÿä½¿ç”¨ç›¸åŒçš„æ–¹æ³•è¿›è¡Œé€†å˜æ¢å¾—åˆ°ç³»æ•°è¡¨ç¤º</p>
</li>
</ol>
<h3 id="åŸæ ¹"><a href="#åŸæ ¹" class="headerlink" title="åŸæ ¹"></a>åŸæ ¹</h3><p>ç°åœ¨æˆ‘ä»¬è¦åœ¨æ•°è®ºä¸­å¯»æ‰¾æ»¡è¶³è¿™ä¸‰ä¸ªæ€§è´¨çš„æ•°ï¼Œé¦–å…ˆæ¥ä»‹ç»åŸæ ¹çš„æ¦‚å¿µï¼Œæ ¹æ®è´¹é©¬å®šç†æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€ä¸ªç´ æ•°$ p$ï¼Œæœ‰ä¸‹é¢è¿™æ ·çš„å…³ç³»</p>

$$
a^{p-1} \equiv 1 \pmod p 
$$

<p>è¿™ä¸€ç‚¹å’Œå•ä½æ ¹ $\omega$ ååˆ†ç›¸ä¼¼ï¼Œ$p$ çš„<strong>åŸæ ¹</strong> $g $å®šä¹‰ä¸ºä½¿å¾— $g^0, g^1, \cdots, g^{p-2} \pmod p $äº’ä¸ç›¸åŒçš„æ•°</p>
<p>å¦‚æœæˆ‘ä»¬å–ç´ æ•°$ p = k\cdot 2^n + 1$ï¼Œå¹¶ä¸”æ‰¾åˆ°å®ƒçš„åŸæ ¹$ g$ï¼Œç„¶åæˆ‘ä»¬ä»¤$ g_n\equiv g^k\pmod p$ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿å¾—$ g_n^0, g_n^1, \cdots, g_n^{n-1} \pmod p $äº’ä¸ç›¸åŒï¼Œå¹¶ä¸”$ g_n^n\equiv 1\pmod p$ï¼Œè¿™ä¾¿æ»¡è¶³äº†æ€§è´¨ä¸€å’Œæ€§è´¨äºŒ</p>
<p>ç”±äº$ p $æ˜¯ç´ æ•°ï¼Œå¹¶ä¸”$ g_n^n \equiv 1 \mod p$ï¼Œè¿™æ · $g_n^\frac{n}{2} \bmod p $å¿…ç„¶æ˜¯$ -1 $æˆ– $1$ï¼Œå†æ ¹æ®$ g^k $äº’ä¸ç›¸åŒè¿™ä¸ªç‰¹ç‚¹ï¼Œæ‰€ä»¥$ g_n^\frac{n}{2} \equiv -1 \pmod p$ï¼Œæ»¡è¶³æ€§è´¨ä¸‰</p>
<p>å¯¹äºæ€§è´¨å››ï¼Œå’Œå‰é¢ä¸€æ ·ä¹Ÿå¯ä»¥éªŒè¯æ˜¯æ»¡è¶³çš„ï¼Œå› æ­¤å† FNT ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŸæ ¹æ›¿ä»£å•ä½æ ¹ï¼Œ<a href="http://blog.miskcoo.com/2014/07/fft-prime-table" target="_blank" rel="noopener">è¿™é‡Œ</a>å·²ç»æœ‰äº†ä¸€äº›æ•°$ p $åŠå…¶åŸæ ¹ï¼Œå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚</p>
<h3 id="æ¨¡æ•°ä»»æ„çš„è§£å†³æ–¹æ¡ˆ"><a href="#æ¨¡æ•°ä»»æ„çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="æ¨¡æ•°ä»»æ„çš„è§£å†³æ–¹æ¡ˆ"></a>æ¨¡æ•°ä»»æ„çš„è§£å†³æ–¹æ¡ˆ</h3><p>å‰é¢è¯´äº†ï¼Œè¦è¿›è¡Œå¿«é€Ÿæ•°è®ºå˜æ¢éœ€è¦æ¨¡æ•°æ˜¯ $a\cdot 2^k + 1 $å½¢å¼çš„ç´ æ•°ï¼Œä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¦æ±‚çš„æ¨¡æ•°å¯èƒ½ä¸æ˜¯è¿™æ ·çš„å½¢å¼ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªåˆæ•°ï¼</p>
<p>å‡è®¾ç°åœ¨éœ€è¦æ¨¡ $m$ï¼Œå¹¶ä¸”è¿›è¡Œå˜æ¢çš„é•¿åº¦æ˜¯$ n$</p>
<p>é‚£ä¹ˆè¿™æ ·ä»»ä½•å¤šé¡¹å¼ç³»æ•°çš„èŒƒå›´æ˜¯$ [0, m)$ï¼Œä¸¤ä¸ªç›¸ä¹˜ï¼Œä¸ä¼šè¶…è¿‡$ (m - 1)^2$ï¼Œä¸€å…± $n $é¡¹ç›¸åŠ ï¼Œä¸ä¼šè¶…è¿‡ $n(m-1)^2$</p>
<p>è¿™æ ·çš„è¯ï¼Œé€‰å–$ k $ä¸ªæœ‰ä¸Šé¢å½¢å¼çš„ç´ æ•°$ p_1, p_2, \cdots, p_k$ï¼Œè¦æ±‚æ»¡è¶³</p>

$$
\prod_{i=1}^k p_k > n(m-1)^2 
$$

<p>ç„¶ååˆ†åˆ«åœ¨$ \bmod k $çš„å‰©ä½™ç³»ä¸‹åšå˜æ¢ï¼Œæœ€åä½¿ç”¨<a href="http://blog.miskcoo.com/2014/09/chinese-remainder-theorem" target="_blank" rel="noopener">ä¸­å›½å‰©ä½™å®šç†</a>åˆå¹¶ï¼ˆå½“ç„¶è¿™æ—¶å€™æˆ–è®¸æ˜¯éœ€è¦é«˜ç²¾åº¦æˆ–è€…<code>__int128</code> çš„ï¼‰</p>
<h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p>FNT çš„ä»£ç å®ç°å’Œ FFT æ˜¯ä¸€æ ·çš„ï¼Œåªè¦æŠŠå¤æ•°è¿ç®—æ¢æˆåœ¨ $\bmod p$ å‰©ä½™ç³»ä¸‹çš„è¿ç®—å³å¯</p>
<h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><h3 id="å¿«é€Ÿå·ç§¯"><a href="#å¿«é€Ÿå·ç§¯" class="headerlink" title="å¿«é€Ÿå·ç§¯"></a>å¿«é€Ÿå·ç§¯</h3><p>ç°æœ‰ä¸¤ä¸ªå®šä¹‰åœ¨$ \mathbb N $ä¸Šçš„å‡½æ•°$ f(n), g(n)$ï¼Œå®šä¹‰$ f $å’Œ $g $çš„<strong>å·ç§¯</strong>ï¼ˆconvolutionï¼‰ä¸º $f \otimes g$</p>

$$
(f \otimes g)(n) = \sum_{i=0}^n f(i)g(n-i) 
$$

<p><img src="/gallery/fft/convolution.png" alt=""></p>
<p>å°±åƒä¸Šé¢çš„å›¾ä¸€æ ·ï¼Œæ³¨æ„åˆ°å·ç§¯çš„å½¢å¼å’Œå¤šé¡¹å¼ä¹˜æ³•çš„å½¢å¼æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå¤šé¡¹å¼$ A(x), B(x)$ï¼Œä»¤$ C(x) = A(x)B(x)$ï¼Œé‚£ä¹ˆä¼šæœ‰$ c_i=(a \otimes b)(i)$ï¼Œå› æ­¤å¯ä»¥ç”¨ FFT æ¥è®¡ç®—å·ç§¯</p>
<p>å¯¹äºè¦è®¡ç®—æŸäº›å½¢å¦‚  $h(k) = \sum_{i=0}^n f(i)g(i+k)Â $ çš„é—®é¢˜ï¼Œå¯ä»¥ä»¤$ fâ€™(x) = f(n-x)$ï¼Œè¿™æ ·é—®é¢˜å°±å˜æˆè®¡ç®—$ \sum_{i=0}^n fâ€™(n-i)g(i+k)$ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå·ç§¯çš„å½¢å¼</p>
<h4 id="ä¾‹1ï¼š-ZJOI2014-åŠ›"><a href="#ä¾‹1ï¼š-ZJOI2014-åŠ›" class="headerlink" title="ä¾‹1ï¼š[ZJOI2014]åŠ›"></a>ä¾‹1ï¼š<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=3527" target="_blank" rel="noopener">[ZJOI2014]åŠ›</a></h4><p>é¢˜ç›®ç»™å‡º$ n $ä¸ªæ•°$ q_1, q_2, \cdots, q_n$ï¼Œè¦æ±‚è®¡ç®—</p>

$$
F_i = \sum_{j=1}^{i-1}\frac{q_iq_j}{(j-i)^i}-\sum_{j=i+1}^{n}\frac{q_iq_j}{(j-i)^i} 
$$

<p>è§‚å¯Ÿä¸€ä¸‹ï¼Œå‡è®¾æœ‰å››ä¸ªæ•°$ q_1, q_2, q_3, q_4$ï¼Œé‚£ä¹ˆ</p>

$$
\begin{eqnarray*} \frac{F_1}{q_1} &=& -\frac{q_2}{1^2}-\frac{q_3}{2^2}-\frac{q_4}{3^2} \\ 
\frac{F_2}{q_2} &=& +\frac{q_1}{1^2}-\frac{q_3}{1^2}-\frac{q_4}{2^2} \\ 
\frac{F_3}{q_3} &=& +\frac{q_1}{2^2}+\frac{q_2}{1^2}-\frac{q_4}{1^2} \\ 
\frac{F_4}{q_4} &=& +\frac{q_1}{3^2}+\frac{q_2}{2^2}+\frac{q_3}{1^2} \\ 
\end{eqnarray*} 
$$

<p>åˆçœ‹ä¹‹ä¸‹ä¼¼ä¹æ²¡ä»€ä¹ˆè§„å¾‹ï¼Œä½†æ˜¯è¿™ä¹‹ä¸­å‡ºç°çš„å‡ ä¸ªæ•°åˆ—å‡ºæ¥</p>
<table>
<thead>
<tr>
<th>q_1</th>
<th>q_2</th>
<th>q_3</th>
<th>q_4</th>
<th>0</th>
<th>0</th>
<th>0</th>
</tr>
</thead>
<tbody>
<tr>
<td>$-\frac{1}{3^2}$</td>
<td>$-\frac{1}{2^2}$</td>
<td>$-\frac{1}{1^2}$</td>
<td>$0$</td>
<td>$\frac{1}{1^2}$</td>
<td>$\frac{1}{2^2}$</td>
<td>$\frac{1}{3^2}$</td>
</tr>
</tbody>
</table>
<p>åˆ—å‡ºæ¥ä¹‹åä½ çœ‹çœ‹æ¯ä¸ª $\frac{F_i}{q_i} $çš„è®¡ç®—ï¼Œå°±ä¼šå‘ç°åˆšå¥½æ˜¯åƒä¸Šé¢é‚£å¼ å›¾ä¸€æ ·çš„é¡ºåºç›¸ä¹˜å†ç›¸åŠ ï¼Œæ˜¯ä¸ªå·ç§¯çš„å½¢å¼ï¼å› æ­¤æœ€ååªéœ€è¦ç”¨ FFT ä¼˜åŒ–è®¡ç®—å·ç§¯ï¼Œå°±å¯ä»¥è§£å†³æ­¤é—®é¢˜ï¼Œä¸è¿‡è¦æ³¨æ„ç²¾åº¦é—®é¢˜</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;complex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MaxL = <span class="number">18</span>, MaxN = <span class="number">1</span> &lt;&lt; MaxL;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="keyword">complex</span>&lt;<span class="keyword">double</span>&gt; <span class="keyword">complex_t</span>;</span><br><span class="line"><span class="keyword">complex_t</span> f[MaxN], g[MaxN];</span><br><span class="line"><span class="keyword">complex_t</span> eps[MaxN], inv_eps[MaxN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_eps</span><span class="params">(<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">double</span> angle = <span class="number">2.0</span> * pi / p;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i != p; ++i)</span><br><span class="line">		eps[i] = <span class="keyword">complex_t</span>(<span class="built_in">cos</span>(<span class="number">2.0</span> * pi * i / p), <span class="built_in">sin</span>(<span class="number">2.0</span> * pi * i / p));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i != p; ++i)</span><br><span class="line">		inv_eps[i] = conj(eps[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">transform</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">complex_t</span> *x, <span class="keyword">complex_t</span> *w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i != n; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(i &gt; j) <span class="built_in">std</span>::swap(x[i], x[j]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> l = n &gt;&gt; <span class="number">1</span>; (j ^= l) &lt; l; l &gt;&gt;= <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> m = i &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k != m; ++k)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">complex_t</span> z = x[j + m + k] * w[n / i * k];</span><br><span class="line">				x[j + m + k] = x[j + k] - z;</span><br><span class="line">				x[j + k] += z;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">0</span>, p = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(p &lt; n) ++l, p &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">	++l, p &lt;&lt;= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i != p; ++i)</span><br><span class="line">		f[i] = g[i] = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i != n; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">double</span> x;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;x);</span><br><span class="line">		f[i] = x;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i + <span class="number">1</span> &lt; n; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		g[i] = <span class="number">1.0</span> / ((n - i - <span class="number">1.0</span>) * (n - i - <span class="number">1.0</span>));</span><br><span class="line">		g[<span class="number">2</span> * n - i - <span class="number">2</span>] = -g[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	init_eps(p);</span><br><span class="line">	<span class="built_in">std</span>::reverse(g, g + p);</span><br><span class="line"></span><br><span class="line">	transform(p, f, eps);</span><br><span class="line">	transform(p, g, eps);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i != p; ++i)</span><br><span class="line">		f[i] *= g[i];</span><br><span class="line">	transform(p, f, inv_eps);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = p - n; i != p; ++i)</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">printf</span>(<span class="string">"%.3lf\n"</span>, f[i].real() / p);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆå‡½æ•°è¿ç®—"><a href="#ç”Ÿæˆå‡½æ•°è¿ç®—" class="headerlink" title="ç”Ÿæˆå‡½æ•°è¿ç®—"></a>ç”Ÿæˆå‡½æ•°è¿ç®—</h3><p>å¯¹äºä¸€äº›éœ€è¦ç”¨åˆ°ç”Ÿæˆå‡½æ•°çš„è®¡æ•°é—®é¢˜ï¼Œåœ¨åˆ—å‡ºç”Ÿæˆå‡½æ•°ä¹‹åæœ‰å¯èƒ½éœ€è¦å°†å…¶å¹³æ–¹ã€æ±‚å¯¹æ•°ã€æ±‚é€†å…ƒæˆ–è€…å¼€æ–¹ï¼Œè¿™æ—¶ä¾¿å¯ä»¥ç”¨ FFT æ¥åŠ é€Ÿè®¡ç®—</p>
<h4 id="ä¾‹2ï¼š-BZOJ3771-Triple"><a href="#ä¾‹2ï¼š-BZOJ3771-Triple" class="headerlink" title="ä¾‹2ï¼š[BZOJ3771]Triple"></a>ä¾‹2ï¼š<a href="http://blog.miskcoo.com/2015/04/bzoj-3771" target="_blank" rel="noopener">[BZOJ3771]Triple</a></h4><p>è¿™ä¸ªé—®é¢˜å°±æ˜¯ç”¨ FFT åŠ é€Ÿå¤šé¡¹å¼ä¹˜æ³•çš„è¿‡ç¨‹ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸Šé¢è¿™ç¯‡é¢˜è§£</p>
<h3 id="å¤šé¡¹å¼æ±‚é€†ã€é™¤æ³•ã€å–æ¨¡"><a href="#å¤šé¡¹å¼æ±‚é€†ã€é™¤æ³•ã€å–æ¨¡" class="headerlink" title="å¤šé¡¹å¼æ±‚é€†ã€é™¤æ³•ã€å–æ¨¡"></a>å¤šé¡¹å¼æ±‚é€†ã€é™¤æ³•ã€å–æ¨¡</h3><p>å…³äºå¤šé¡¹å¼çš„æ±‚é€†å…ƒï¼Œå¯ä»¥çœ‹<a href="http://blog.miskcoo.com/2015/05/polynomial-inverse" target="_blank" rel="noopener">è¿™é‡Œ</a></p>
<p>å…³äºå¤šé¡¹å¼çš„é™¤æ³•å’Œæ±‚æ¨¡ï¼Œå¯ä»¥çœ‹<a href="http://blog.miskcoo.com/2015/05/polynomial-division" target="_blank" rel="noopener">è¿™é‡Œ</a></p>
<h3 id="å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼"><a href="#å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼" class="headerlink" title="å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼"></a>å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼</h3><p>å…³äºå¤šé¡¹å¼çš„å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼ï¼Œå¯ä»¥çœ‹<a href="http://blog.miskcoo.com/2015/05/polynomial-multipoint-eval-and-interpolation" target="_blank" rel="noopener">è¿™é‡Œ</a></p>
<h2 id="Related-Posts"><a href="#Related-Posts" class="headerlink" title="Related Posts:"></a>Related Posts:</h2><ol>
<li><a href="http://blog.miskcoo.com/2014/07/fft-prime-table" target="_blank" rel="noopener">FFTç”¨åˆ°çš„å„ç§ç´ æ•°</a></li>
<li><a href="http://blog.miskcoo.com/2015/05/polynomial-inverse" target="_blank" rel="noopener">å¤šé¡¹å¼æ±‚é€†å…ƒ</a></li>
<li><a href="http://blog.miskcoo.com/2015/05/polynomial-multipoint-eval-and-interpolation" target="_blank" rel="noopener">å¤šé¡¹å¼çš„å¤šç‚¹æ±‚å€¼ä¸å¿«é€Ÿæ’å€¼</a></li>
<li><a href="http://blog.miskcoo.com/2015/06/polynomial-with-newton-method" target="_blank" rel="noopener">ç‰›é¡¿è¿­ä»£æ³•åœ¨å¤šé¡¹å¼è¿ç®—çš„åº”ç”¨</a></li>
<li><a href="http://blog.miskcoo.com/2015/08/special-polynomial-linear-interpolation" target="_blank" rel="noopener">ç‰¹æ®Šå¤šé¡¹å¼åœ¨æ•´ç‚¹ä¸Šçš„çº¿æ€§æ’å€¼æ–¹æ³•</a></li>
<li><a href="http://blog.miskcoo.com/2014/10/karatsuba-multiplication" target="_blank" rel="noopener">Karatsuba ä¹˜æ³•</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      
        <div id="donation_div"></div>

<script src="../../../../js/vdonate.js"></script>
<script>
var a = new Donate({
  title: 'å¦‚æœè§‰å¾—æˆ‘çš„æ–‡ç« å¯¹æ‚¨æœ‰ç”¨ï¼Œè¯·éšæ„æ‰“èµã€‚æ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œ!', // å¯é€‰å‚æ•°ï¼Œæ‰“èµæ ‡é¢˜
  btnText: 'æ‰“èµæ”¯æŒ', // å¯é€‰å‚æ•°ï¼Œæ‰“èµæŒ‰é’®æ–‡å­—
  el: document.getElementById('donation_div'),
  wechatImage: 'https://raw.githubusercontent.com/iTimeTraveler/iTimeTraveler.github.io/site/source/about/donate/images/WeChanQR.png',
  alipayImage: 'https://raw.githubusercontent.com/iTimeTraveler/iTimeTraveler.github.io/site/source/about/donate/images/AliPayQR.jpg'
});
</script>
      
      
        
	<div id="comment">
		<!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
		</div>
		<!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->
	</div>



      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/Algorithm/">Algorithm</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../../20/ã€Javaã€‘try-catch-finallyè¯­å¥ä¸­returnçš„æ‰§è¡Œé¡ºåºæ€è€ƒ/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
      <div class="article-nav-title">
        
          ã€Javaã€‘try-catch-finallyè¯­å¥ä¸­returnçš„æ‰§è¡Œé¡ºåºæ€è€ƒ
        
      </div>
    </a>
  
  
    <a href="../../../08/22/ã€ç®—æ³•ã€‘å¤§æ•°ç›¸ä¹˜é—®é¢˜åŠå…¶é«˜æ•ˆç®—æ³•/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
      <div class="article-nav-title">ã€ç®—æ³•ã€‘å¤§æ•°ä¹˜æ³•é—®é¢˜åŠå…¶é«˜æ•ˆç®—æ³•</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="toc-sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
    
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¦‚è¿°"><span class="nav-number">1.</span> <span class="nav-text">æ¦‚è¿°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡†å¤‡çŸ¥è¯†"><span class="nav-number">2.</span> <span class="nav-text">å‡†å¤‡çŸ¥è¯†</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¤šé¡¹å¼"><span class="nav-number">3.</span> <span class="nav-text">å¤šé¡¹å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•"><span class="nav-number">3.1.</span> <span class="nav-text">å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºæ³•"><span class="nav-number">3.2.</span> <span class="nav-text">å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºæ³•</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¤æ•°"><span class="nav-number">4.</span> <span class="nav-text">å¤æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å•ä½æ ¹"><span class="nav-number">4.1.</span> <span class="nav-text">å•ä½æ ¹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¤šé¡¹å¼çš„ä¹˜æ³•"><span class="nav-number">5.</span> <span class="nav-text">å¤šé¡¹å¼çš„ä¹˜æ³•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¿«é€Ÿå‚…é‡Œå¶å˜æ¢"><span class="nav-number">6.</span> <span class="nav-text">å¿«é€Ÿå‚…é‡Œå¶å˜æ¢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cooley-Tukeyç®—æ³•"><span class="nav-number">6.1.</span> <span class="nav-text">Cooley-Tukeyç®—æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‚…é‡Œå¶é€†å˜æ¢ï¼ˆIDFTï¼‰"><span class="nav-number">6.2.</span> <span class="nav-text">å‚…é‡Œå¶é€†å˜æ¢ï¼ˆIDFTï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®—æ³•å®ç°"><span class="nav-number">6.3.</span> <span class="nav-text">ç®—æ³•å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#é€’å½’å®ç°"><span class="nav-number">6.3.1.</span> <span class="nav-text">é€’å½’å®ç°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è¿­ä»£å®ç°"><span class="nav-number">6.3.2.</span> <span class="nav-text">è¿­ä»£å®ç°</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¿«é€Ÿæ•°è®ºå˜æ¢"><span class="nav-number">7.</span> <span class="nav-text">å¿«é€Ÿæ•°è®ºå˜æ¢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åŸæ ¹"><span class="nav-number">7.1.</span> <span class="nav-text">åŸæ ¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¨¡æ•°ä»»æ„çš„è§£å†³æ–¹æ¡ˆ"><span class="nav-number">7.2.</span> <span class="nav-text">æ¨¡æ•°ä»»æ„çš„è§£å†³æ–¹æ¡ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»£ç å®ç°"><span class="nav-number">7.3.</span> <span class="nav-text">ä»£ç å®ç°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åº”ç”¨"><span class="nav-number">8.</span> <span class="nav-text">åº”ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¿«é€Ÿå·ç§¯"><span class="nav-number">8.1.</span> <span class="nav-text">å¿«é€Ÿå·ç§¯</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¾‹1ï¼š-ZJOI2014-åŠ›"><span class="nav-number">8.1.1.</span> <span class="nav-text">ä¾‹1ï¼š[ZJOI2014]åŠ›</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç”Ÿæˆå‡½æ•°è¿ç®—"><span class="nav-number">8.2.</span> <span class="nav-text">ç”Ÿæˆå‡½æ•°è¿ç®—</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¾‹2ï¼š-BZOJ3771-Triple"><span class="nav-number">8.2.1.</span> <span class="nav-text">ä¾‹2ï¼š[BZOJ3771]Triple</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šé¡¹å¼æ±‚é€†ã€é™¤æ³•ã€å–æ¨¡"><span class="nav-number">8.3.</span> <span class="nav-text">å¤šé¡¹å¼æ±‚é€†ã€é™¤æ³•ã€å–æ¨¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼"><span class="nav-number">8.4.</span> <span class="nav-text">å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Related-Posts"><span class="nav-number">9.</span> <span class="nav-text">Related Posts:</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2013 - 2018 iTimeTraveler All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				è®¿å®¢æ•° : <span id="busuanzi_value_site_uv"></span> |  
				è®¿é—®é‡ : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
    <a href="../../../../categories" class="mobile-nav-link">Categories</a>
  
    <a href="../../../../tags" class="mobile-nav-link">Tags</a>
  
    <a href="../../../../funnysite" class="mobile-nav-link">é…·ç«™</a>
  
    <a href="../../../../collection" class="mobile-nav-link">æ”¶è—</a>
  
    <a href="../../../../about" class="mobile-nav-link">About</a>
  
    <a href="../../../../mybooks" class="mobile-nav-link">ğŸ</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="../../../../fancybox/jquery.fancybox.css">
  <script src="../../../../fancybox/jquery.fancybox.pack.js"></script>


<script src="../../../../js/scripts.js"></script>




  <script src="../../../../js/dialog.js"></script>








	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">è®¾ç½®</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              æ­£æ–‡å­—å·å¤§å°
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            æ‚¨å·²è°ƒæ•´é¡µé¢å­—ä½“å¤§å°
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              å¤œé—´æŠ¤çœ¼æ¨¡å¼
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            å¤œé—´æ¨¡å¼å·²ç»å¼€å¯ï¼Œå†æ¬¡å•å‡»æŒ‰é’®å³å¯å…³é—­ 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å…³ äº&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            iTimeTraveler
          </div>
          <div class="panel-body">
            Copyright Â© 2018 Mr.Seven All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
    <a id="menu-switch"><i class="fa fa-bars fa-lg"></i></a>
  
</body>
</html>