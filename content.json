{"meta":{"title":"iTimeTraveler","subtitle":null,"description":"Someone knock at the door.","author":"Mr.Seven","url":"http://github.com"},"pages":[{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"404.html","permalink":"http://github.com/404.html","excerpt":"","text":"404 html body{ background-color: #000; } * { margin: 0; padding: 0; outline: none; font-family: \"Helvetica Neue\",Helvetica,\"Hiragino Sans GB\",\"æ¥·ä½“\",\"Microsoft YaHei\",Arial,sans-serif; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -khtml-user-select: none; user-select: none; cursor: default; font-weight: lighter; } .center { margin: 0 auto; } .whole { width: 100%; height: 100%; line-height: 100%; position: fixed; bottom: 0; left: 0; z-index: -1000; overflow: hidden; background: url(https://source.unsplash.com/collection/954550/1920x1080); background-size: cover; } .mask { width: 100%; height: 100%; position: absolute; top: 0; left: 0; background: #000; opacity: 0.6; filter: alpha(opacity=60); } .b { width: 100%; text-align: center; height: 400px; position: absolute; top: 50%; margin-top: -230px } .a { width: 150px; height: 50px; margin-top: 30px } .a a { display: block; float: left; width: 150px; height: 50px; background: #fff; text-align: center; line-height: 50px; font-size: 18px; border-radius: 25px; color: #333 } .a a:hover { color: #000; box-shadow: #fff 0 0 20px } p { color: #fff; margin-top: 40px; font-size: 30px; } #num { margin: 0 5px; font-weight: bold; } var num=10; function redirect(){ num--; document.getElementById(\"num\").innerHTML=num; if(num"},{"title":"","date":"2015-08-16T06:58:08.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"about/index - old.html","permalink":"http://github.com/about/index - old.html","excerpt":"","text":"That maybe happiness is something that we can only pursue. And maybe we can actually never have itâ€¦.no matter what. Chris GardnerThe Pursuit of Happyness Profilethis part of my lifeâ€¦ this little part, is called happiness ğŸ. Bello, guys. I am ï¼š iTimeTraveler I live in Beijing and work as a software developer. I use this site to blog on different topics that I like and hope you find interesting. Iâ€™m an Android Developer + prefer Python &amp; Golang + interest in AI(Artificial Intelligence) + Google radicalsï¼ˆGolang+Docker+Kubernetes+AngularJS). Social InfoYou can reach me by : iTime : iTimeTraveler : iTimeTraveler"},{"title":"","date":"2015-08-16T06:58:08.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"about/index.html","permalink":"http://github.com/about/index.html","excerpt":"","text":"ProfileI am a slow walker, but I never walk backwards. â€”â€” Abraham Lincoln å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ã€iTimeTravelerã€ã€‚å‘éŸ³è¯»èµ·æ¥æœ‰ç‚¹é•¿è¿˜æ‹—å£ï¼Œçµæ„Ÿæ¥è‡ªäºç”µå½±ã€ŠThe Time Travelerâ€™s Wifeã€‹ï¼ˆæ—¶é—´æ—…è¡Œè€…çš„å¦»å­ï¼‰ï¼Œæœ‰å…³æ—¶é—´ï¼Œæœ‰å…³å®å®ˆï¼Œæœ‰å…³å˜åŒ–ä¸æ°¸æ’ã€‚ ä¸€ä»‹ç å†œï¼Œå¹³æ—¶ä¸»è¦è®°å½•ä¸€äº›å¼€å‘ç¬”è®°ï¼Œèšç„¦äºAndroidç§»åŠ¨å¼€å‘é¢†åŸŸï¼Œæ­£åœ¨æ·±å…¥Frameworkã€‚ å–œæ¬¢ä¸€æ¢ç©¶ç«Ÿï¼Œå¯»æ ¹ç©¶åº•ã€‚å¶å°”ä¹Ÿç•¥æ‡‚ï¼Œå®¹æ˜“å›«å›µåæ£å¼å­¦ä¹ ã€‚å¸Œæœ›è¿™äº›åˆ†äº«å¯¹ä½ èƒ½æœ‰æ‰€å¸®åŠ©ã€‚ Social Info : iTime : iTimeTraveler : iTimeTraveler"},{"title":"Archives","date":"2016-08-16T07:00:24.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"archives/index.html","permalink":"http://github.com/archives/index.html","excerpt":"","text":""},{"title":"Categories","date":"2016-08-16T07:00:44.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"categories/index.html","permalink":"http://github.com/categories/index.html","excerpt":"","text":""},{"title":"collection","date":"2016-11-25T06:30:53.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"collection/index.html","permalink":"http://github.com/collection/index.html","excerpt":"","text":""},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"mybooks/books.css","permalink":"http://github.com/mybooks/books.css","excerpt":"","text":".clear { clear: both } #main { /*padding-left: 105px; padding-top: 47px; padding-bottom: 30px;*/ clear: both; /* background: url(images/paper.jpg) left top #F2EDB4;*/ position: relative; /* z-index: 11;*/ box-shadow: 5px 5px 8px #888; margin-top: 50px; margin-bottom: 50px; } /* #main h2 { line-height: 30px; font-size: 17px; margin-bottom: 10px; position: relative; } #main h2 em { font-size: 14px; margin-left: 20px; } #main h2 em span,#main h2 em img { vertical-align: text-bottom; } #main h2 em a { color: #000 } #main h2 em a:hover { color: #1C5F8C; text-decoration: underline } #main h2 span.ad { position: absolute; top: -22px; left: 250px }*/ #main .tag { margin-bottom: 20px; height: 30px; line-height: 30px; font-size: 15px } #main .tag a { padding: 4px 12px } #book { /* margin: -47px 0 -30px -105px;*/ display: table; width: 100%; /*background: #F5F0B6*/ } #book h2 { height: 16px; margin: 0; /*padding: 45px 0 0 105px;*/ background: url(images/bookshelftop.jpg) no-repeat left top; color: #000!important; background-size: cover; } #book ul { float: left; height: auto; background: url(images/bookshelfmiddle.jpg) repeat-y left top; margin-bottom: 0; background-size: 100% 196px; -webkit-margin-before: 0em; -webkit-margin-after: 0em; -webkit-padding-start: 0em; padding: 0 5%; width: 90%; } #book ul li { list-style-type: none; /* height: 160px;*/ /* line-height: 160px;*/ vertical-align: bottom; width: 110px; float: left; margin: 17px 14px 0; padding-bottom: 19px; } #book ul li a { display: block; height: 160px; line-height: 160px; position: relative; } #book ul li img { width: 110px; vertical-align: bottom; box-shadow: 5px 0 6px #512301; position: absolute; bottom: 0; -webkit-transition: all .2s linear; transition: all .2s linear; } #book ul li img:hover { -webkit-box-shadow: 0 15px 30px rgba(0,0,0,0.1); box-shadow: 5px 15px 30px rgba(0,0,0,0.4); -webkit-transform: translate3d(0, -2px, 0); transform: translate3d(0, -2px, 0); }"},{"title":"","date":"2017-07-02T03:30:53.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"mybooks/index.html","permalink":"http://github.com/mybooks/index.html","excerpt":"","text":"function setIframeHeight(iframe) { if (iframe) { var iframeWin = iframe.contentWindow || iframe.contentDocument.parentWindow; if (iframeWin.document.body) { iframe.height = iframeWin.document.documentElement.scrollHeight || iframeWin.document.body.scrollHeight; } } }; setIframeHeight(document.getElementsByTagName('iframe')[0]); window.onload = function () { setIframeHeight(document.getElementsByTagName('iframe')[0]); };"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"mybooks/library.html","permalink":"http://github.com/mybooks/library.html","excerpt":"","text":"æˆ‘çš„ä¹¦æ¶"},{"title":"","date":"2016-11-25T06:30:53.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"funnysite/index.html","permalink":"http://github.com/funnysite/index.html","excerpt":"äººä»¬å¯¹äºâ€œç¾â€ï¼Œéƒ½æœ‰ç€è¶…ä¹è‡ªå·±æƒ³è±¡çš„æ‰§å¿µã€‚ Websiteæ•°æ®ç»“æ„å¯è§†åŒ–ï¼šData Structure Visualization å’Œ VisuAlgo - visualising data structures and algorithms through animation å†·æ·¡ç®€æ´é£æ ¼ jsdatav.is fatesinger themeakina html5up Akina theme æ·¡è…¾ louie iacool TA4.cn æ³¢æµª EndSkin Wordpressä¸»é¢˜ tagDiv &amp; ï¼ˆæŠ¥çº¸ï¼‰NEWSMAG æ¼‚äº®çš„è’™å±‚ æ¼‚äº®çš„ç”µå½±ç½‘ç«™ SPOTLIGHT è¨åˆ©æœºé•¿ humaan Philip Walton(Engineer @ Google) Just Good Themes Mirana wordpress DREAMFY è€é…’è¡— BeSteve code123.cc Statamic Hoveræ•ˆæœ http://archive.li/A7Ro2 Funny Links ibireme Red Blob Games Joeâ€™s Blog tarikfayad è®¾è®¡ç­†è¨˜ æœ±è…¾é¹ï¼ˆåƒç´ ç™–ï¼‰ CaiCai PHILANTHROPY 2016 tagDiv IGK nerds.company &amp; 404 Oops 404 A Developer Diary å›¾é›† from Dribbble","text":"äººä»¬å¯¹äºâ€œç¾â€ï¼Œéƒ½æœ‰ç€è¶…ä¹è‡ªå·±æƒ³è±¡çš„æ‰§å¿µã€‚ Websiteæ•°æ®ç»“æ„å¯è§†åŒ–ï¼šData Structure Visualization å’Œ VisuAlgo - visualising data structures and algorithms through animation å†·æ·¡ç®€æ´é£æ ¼ jsdatav.is fatesinger themeakina html5up Akina theme æ·¡è…¾ louie iacool TA4.cn æ³¢æµª EndSkin Wordpressä¸»é¢˜ tagDiv &amp; ï¼ˆæŠ¥çº¸ï¼‰NEWSMAG æ¼‚äº®çš„è’™å±‚ æ¼‚äº®çš„ç”µå½±ç½‘ç«™ SPOTLIGHT è¨åˆ©æœºé•¿ humaan Philip Walton(Engineer @ Google) Just Good Themes Mirana wordpress DREAMFY è€é…’è¡— BeSteve code123.cc Statamic Hoveræ•ˆæœ http://archive.li/A7Ro2 Funny Links ibireme Red Blob Games Joeâ€™s Blog tarikfayad è®¾è®¡ç­†è¨˜ æœ±è…¾é¹ï¼ˆåƒç´ ç™–ï¼‰ CaiCai PHILANTHROPY 2016 tagDiv IGK nerds.company &amp; 404 Oops 404 A Developer Diary å›¾é›† from Dribbble from Dribbble from Dribbble from Dribbble"},{"title":"Tags","date":"2016-08-11T04:12:45.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"tags/index.html","permalink":"http://github.com/tags/index.html","excerpt":"","text":""},{"title":"Secret","date":"2016-08-16T07:00:24.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"secret/index.html","permalink":"http://github.com/secret/index.html","excerpt":"","text":"ä¼—ç¥è¿›å…¥è‹±çµæ®¿ ç”°ç»´æœ¯ - http://weishu.me è®¸å»ºæ— - https://blog.piasy.com Trinea - http://p.codekk.com/ å†™ä»£ç çš„çŒ´å­ - https://jaeger.itscoder.com/ Gityuan - http://gityuan.com JohnTsai - http://johntsai.work/ kymjså¼ æ¶› - https://www.kymjs.com è¾¾åº†å‡¯ - http://skykai521.github.io/ å†¯è‹¥èˆª - https://vonng.com/ ç‹èµŸ - http://blog.zanlabs.com/"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/å›¾ç‰‡è½®æ’­.html","permalink":"http://github.com/collection/code/å›¾ç‰‡è½®æ’­.html","excerpt":"","text":"æµå…‰æº¢å½©çš„Bootstrapå“åº”å¼å¹»ç¯ç‰‡ç‰¹æ•ˆ body{ background:#000; } .jq22-header h1{ text-align: center; font-size: 18px; } section.awSlider .carousel{ display:table; z-index:2; -moz-box-shadow: 0 0 4px #444; -webkit-box-shadow: 0 0 4px #444; box-shadow: 0 0 15px rgba(1,1,1,.5); } section.awSlider{ margin:30px auto; padding:30px; position:relative; display:table; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; } section.awSlider:hover > img{ -ms-transform: scale(1.2); -webkit-transform: scale(1.2); transform: scale(1.2); opacity:1; } section.awSlider img{ pointer-events: none; } section.awSlider > img{ position:absolute; top:30px; z-index:1; transition:all .3s; filter: blur(1.8vw); -webkit-filter: blur(2vw); -moz-filter: blur(2vw); -o-filter: blur(2vw); -ms-filter: blur(2vw); -ms-transform: scale(1.1); -webkit-transform: scale(1.1); transform: scale(1.1); opacity:.5; } æ¸…æ˜æ—¶èŠ‚é›¨çº·çº· GÃ¶rsel #3 GÃ¶rsel #4 Geri Ä°leri $('section.awSlider .carousel').carousel({ pause: 'hover', interval: 2000 }); var startImage = $('section.awSlider .item.active > img').attr('src'); $('section.awSlider').append(''); $('section.awSlider .carousel').on('slid.bs.carousel', function () { var bscn = $(this).find('.item.active > img').attr('src'); $('section.awSlider > img').attr('src', bscn); });"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"collection/code/curtains-cloth.js","permalink":"http://github.com/collection/code/curtains-cloth.js","excerpt":"","text":"var physics_accuracy = 3, mouse_influence = 20, mouse_cut = 5, gravity = 1200, cloth_height = 30, cloth_width = 50, start_y = 20, spacing = 7, tear_distance = 60; window.requestAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(callback) { window.setTimeout(callback, 1000 / 60); }; var canvas, ctx, cloth, boundsx, boundsy, mouse = { down: false, button: 1, x: 0, y: 0, px: 0, py: 0 }; var Point = function(x, y) { this.x = x; this.y = y; this.px = x; this.py = y; this.vx = 0; this.vy = 0; this.pin_x = null; this.pin_y = null; this.constraints = []; }; Point.prototype.update = function(delta) { if (mouse.down) { var diff_x = this.x - mouse.x, diff_y = this.y - mouse.y, dist = Math.sqrt(diff_x * diff_x + diff_y * diff_y); if (mouse.button == 1) { if (dist < mouse_influence) { this.px = this.x - (mouse.x - mouse.px) * 1.8; this.py = this.y - (mouse.y - mouse.py) * 1.8; } } else if (dist < mouse_cut) this.constraints = []; } this.add_force(0, gravity); delta *= delta; nx = this.x + ((this.x - this.px) * .99) + ((this.vx / 2) * delta); ny = this.y + ((this.y - this.py) * .99) + ((this.vy / 2) * delta); this.px = this.x; this.py = this.y; this.x = nx; this.y = ny; this.vy = this.vx = 0 }; Point.prototype.draw = function() { if (this.constraints.length boundsx) { this.x = 2 * boundsx - this.x; } else if (this.x < 1) { this.x = 2 - this.x; } if (this.y > boundsy) { this.y = 2 * boundsy - this.y; } else if (this.y < 1) { this.y = 2 - this.y; } }; Point.prototype.attach = function(point) { this.constraints.push(new Constraint(this, point)); }; Point.prototype.remove_constraint = function(lnk) { var i = this.constraints.length; while (i--) if (this.constraints[i] == lnk) this.constraints.splice(i, 1); }; Point.prototype.add_force = function(x, y) { this.vx += x; this.vy += y; }; Point.prototype.pin = function(pinx, piny) { this.pin_x = pinx; this.pin_y = piny; }; var Constraint = function(p1, p2) { this.p1 = p1; this.p2 = p2; this.length = spacing; }; Constraint.prototype.resolve = function() { var diff_x = this.p1.x - this.p2.x, diff_y = this.p1.y - this.p2.y, dist = Math.sqrt(diff_x * diff_x + diff_y * diff_y), diff = (this.length - dist) / dist; if (dist > tear_distance) this.p1.remove_constraint(this); var px = diff_x * diff * 0.5; var py = diff_y * diff * 0.5; this.p1.x += px; this.p1.y += py; this.p2.x -= px; this.p2.y -= py; }; Constraint.prototype.draw = function() { ctx.moveTo(this.p1.x, this.p1.y); ctx.lineTo(this.p2.x, this.p2.y); }; var Cloth = function() { this.points = []; var start_x = canvas.width / 2 - cloth_width * spacing / 2; for (var y = 0; y"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"collection/code/jquery.lettering.js","permalink":"http://github.com/collection/code/jquery.lettering.js","excerpt":"","text":"/*global jQuery */ /*! * Lettering.JS 0.6.1 * * Copyright 2010, Dave Rupert http://daverupert.com * Released under the WTFPL license * http://sam.zoy.org/wtfpl/ * * Thanks to Paul Irish - http://paulirish.com - for the feedback. * * Date: Mon Sep 20 17:14:00 2010 -0600 */ (function($){ function injector(t, splitter, klass, after) { var a = t.text().split(splitter), inject = ''; if (a.length) { $(a).each(function(i, item) { inject += ''+item+''+after; }); t.empty().append(inject); } } var methods = { init : function() { return this.each(function() { injector($(this), '', 'char', ''); }); }, words : function() { return this.each(function() { injector($(this), ' ', 'word', ' '); }); }, lines : function() { return this.each(function() { var r = \"eefec303079ad17405c889e092e105b0\"; // Because it's hard to split a tag consistently across browsers, // (*ahem* IE *ahem*), we replaces all instances with an md5 hash // (of the word \"split\"). If you're trying to use this plugin on that // md5 hash string, it will fail because you're being ridiculous. injector($(this).children(\"br\").replaceWith(r).end(), r, 'line', ''); }); } }; $.fn.lettering = function( method ) { // Method calling logic if ( method && methods[method] ) { return methods[ method ].apply( this, [].slice.call( arguments, 1 )); } else if ( method === 'letters' || ! method ) { return methods.init.apply( this, [].slice.call( arguments, 0 ) ); // always pass an array } $.error( 'Method ' + method + ' does not exist on jQuery.lettering' ); return this; }; })(jQuery);"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/åœ†å½¢è¡æ¼¾.html","permalink":"http://github.com/collection/code/åœ†å½¢è¡æ¼¾.html","excerpt":"","text":"jq22-code4 body { background: #291f34; overflow: hidden; } .loading { position: absolute; left: 50%; top: 30vh; margin-left: -20vh; display: block; width: 40vh; height: 40vh; text-align: center; -webkit-filter: contrast(1.2); filter: contrast(1.2); } .loading span { mix-blend-mode: screen; display: block; position: absolute; border-radius: 50%; -webkit-animation: wave 3s infinite linear; animation: wave 3s infinite linear; } .loading span:nth-child(0) { left: -11%; right: -2%; top: -12%; bottom: -5%; -webkit-transform-origin: 46% 53%; transform-origin: 46% 53%; -webkit-animation-delay: 0; animation-delay: 0; background-color: red; } .loading span:nth-child(1) { left: -4%; right: -4%; top: -9%; bottom: -2%; -webkit-transform-origin: 47% 50%; transform-origin: 47% 50%; -webkit-animation-delay: -1s; animation-delay: -1s; background-color: #ffd500; } .loading span:nth-child(2) { left: -11%; right: -4%; top: -10%; bottom: -11%; -webkit-transform-origin: 49% 53%; transform-origin: 49% 53%; -webkit-animation-delay: -1.5s; animation-delay: -1.5s; background-color: #55ff00; } .loading span:nth-child(3) { left: -7%; right: -9%; top: -11%; bottom: -4%; -webkit-transform-origin: 47% 52%; transform-origin: 47% 52%; -webkit-animation-delay: -2s; animation-delay: -2s; background-color: #00ff80; } .loading span:nth-child(4) { left: -8%; right: -3%; top: -5%; bottom: -11%; -webkit-transform-origin: 47% 52%; transform-origin: 47% 52%; -webkit-animation-delay: -2.5s; animation-delay: -2.5s; background-color: #00aaff; } .loading span:nth-child(5) { left: -10%; right: -8%; top: -4%; bottom: -9%; -webkit-transform-origin: 48% 51%; transform-origin: 48% 51%; -webkit-animation-delay: -3s; animation-delay: -3s; background-color: #2b00ff; } .loading span:nth-child(6) { left: -9%; right: -11%; top: -5%; bottom: -8%; -webkit-transform-origin: 47% 50%; transform-origin: 47% 50%; -webkit-animation-delay: -3.5s; animation-delay: -3.5s; background-color: magenta; } @-webkit-keyframes wave { from { -webkit-transform: rotateZ(0deg); transform: rotateZ(0deg); } to { -webkit-transform: rotateZ(360deg); transform: rotateZ(360deg); } } @keyframes wave { from { -webkit-transform: rotateZ(0deg); transform: rotateZ(0deg); } to { -webkit-transform: rotateZ(360deg); transform: rotateZ(360deg); } }"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/å¢é•¿çš„æ ‘.html","permalink":"http://github.com/collection/code/å¢é•¿çš„æ ‘.html","excerpt":"","text":"body { margin: 0; padding: 0; /*background:linear-gradient(360deg, #e56420, #37bbde);*/ overflow: hidden; background-color: black; width: 100%; height: 100vh; background-size: cover; background-blend-mode: hard-light; animation: hue-rotate 10s linear infinite; } @keyframes hue-rotate { from { -webkit-filter: hue-rotate(0); -moz-filter: hue-rotate(0); -ms-filter: hue-rotate(0); filter: hue-rotate(0); } to { -webkit-filter: hue-rotate(360deg); -moz-filter: hue-rotate(360deg); -ms-filter: hue-rotate(360deg); filter: hue-rotate(360deg); } } ; void function() { var depth = 16, branchWidth = 12, step = 0 var newDepthPub, depthPub var canvas = document.getElementById('mycanvas') var ctx = canvas.getContext('2d') canvas.width = window.innerWidth canvas.height = window.innerHeight ctx.globalCompositeOperation = 'lighter'; var drawTree = function(ctx, startX, startY, length, angle, depth, branchWidth) { var rand = Math.random, newDepth, newLength, newAngle, maxBranch = 3, endX, endY, maxAngle = 2 * Math.PI / 4, subBranches, lenShrink; ctx.beginPath() ctx.moveTo(startX, startY) endX = startX + length * Math.cos(angle) endY = startY + length * Math.sin(angle) ctx.lineCap = 'round' ctx.lineWidth = branchWidth ctx.lineTo(endX, endY) if (depth > 0) + ',0)' } else { ctx.strokeStyle = 'rgb(' + (((rand() * 64) + 64) >> 0) + ',50, 25)' } ctx.stroke() newDepth = depth - 1 if (!newDepth) return subBranches = maxBranch - 1 branchWidth *= .7 for (var i = 0; i < subBranches; i++) { newAngle = angle + rand() * maxAngle - maxAngle * .5 newLength = length * (.7 + rand() * .3) setTimeout(function() { drawTree(ctx, endX, endY, newLength, newAngle, newDepth, branchWidth) newDepthPub = newDepth depthPub = depth step++; }, 100) } } var init = function() { step = 0 canvas.width = window.innerWidth canvas.height = window.innerHeight ctx.globalCompositeOperation = 'lighter'; ctx.clearRect(0, 0, window.innerWidth, window.innerHeight) drawTree(ctx, ~~(window.innerWidth / 2), ~~(window.innerHeight / 1.02), 60, -Math.PI / 2, depth, branchWidth) } var regrow = function() { if (step < 65534) return init() } document.querySelector('body').addEventListener('click', function(e) { regrow() }) document.addEventListener('DOMContentLoaded', function() { init() }, false); window.onresize = regrow }();"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/å½©è‰²ç‚¹ç‚¹èƒŒæ™¯.html","permalink":"http://github.com/collection/code/å½©è‰²ç‚¹ç‚¹èƒŒæ™¯.html","excerpt":"","text":"jq22-code4 html, body { background: #fff; margin: 0; padding:0;} canvas { width: 100%; height: 100%; position: absolute; } $(function(){ var canvas = document.querySelector('canvas'), ctx = canvas.getContext('2d') canvas.width = window.innerWidth; canvas.height = window.innerHeight; ctx.lineWidth = .3; ctx.strokeStyle = (new Color(150)).style; var mousePosition = { x: 30 * canvas.width / 100, y: 30 * canvas.height / 100 }; var dots = { nb: 150, distance: 50, d_radius: 100, array: [] }; function colorValue(min) { return Math.floor(Math.random() * 255 + min); } function createColorStyle(r,g,b) { return 'rgba(' + r + ',' + g + ',' + b + ', 0.8)'; } function mixComponents(comp1, weight1, comp2, weight2) { return (comp1 * weight1 + comp2 * weight2) / (weight1 + weight2); } function averageColorStyles(dot1, dot2) { var color1 = dot1.color, color2 = dot2.color; var r = mixComponents(color1.r, dot1.radius, color2.r, dot2.radius), g = mixComponents(color1.g, dot1.radius, color2.g, dot2.radius), b = mixComponents(color1.b, dot1.radius, color2.b, dot2.radius); return createColorStyle(Math.floor(r), Math.floor(g), Math.floor(b)); } function Color(min) { min = min || 0; this.r = colorValue(min); this.g = colorValue(min); this.b = colorValue(min); this.style = createColorStyle(this.r, this.g, this.b); } function Dot(){ this.x = Math.random() * canvas.width; this.y = Math.random() * canvas.height; this.vx = -.5 + Math.random(); this.vy = -.5 + Math.random(); this.radius = Math.random() * 2; this.color = new Color(); console.log(this); } Dot.prototype = { draw: function(){ ctx.beginPath(); ctx.fillStyle = this.color.style; ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false); ctx.fill(); } }; function createDots(){ for(i = 0; i < dots.nb; i++){ dots.array.push(new Dot()); } } function moveDots() { for(i = 0; i < dots.nb; i++){ var dot = dots.array[i]; if(dot.y < 0 || dot.y > canvas.height){ dot.vx = dot.vx; dot.vy = - dot.vy; } else if(dot.x < 0 || dot.x > canvas.width){ dot.vx = - dot.vx; dot.vy = dot.vy; } dot.x += dot.vx; dot.y += dot.vy; } } function connectDots() { for(i = 0; i < dots.nb; i++){ for(j = 0; j < dots.nb; j++){ i_dot = dots.array[i]; j_dot = dots.array[j]; if((i_dot.x - j_dot.x) < dots.distance && (i_dot.y - j_dot.y) < dots.distance && (i_dot.x - j_dot.x) > - dots.distance && (i_dot.y - j_dot.y) > - dots.distance){ if((i_dot.x - mousePosition.x) < dots.d_radius && (i_dot.y - mousePosition.y) < dots.d_radius && (i_dot.x - mousePosition.x) > - dots.d_radius && (i_dot.y - mousePosition.y) > - dots.d_radius){ ctx.beginPath(); ctx.strokeStyle = averageColorStyles(i_dot, j_dot); ctx.moveTo(i_dot.x, i_dot.y); ctx.lineTo(j_dot.x, j_dot.y); ctx.stroke(); ctx.closePath(); } } } } } function drawDots() { for(i = 0; i < dots.nb; i++){ var dot = dots.array[i]; dot.draw(); } } function animateDots() { ctx.clearRect(0, 0, canvas.width, canvas.height); moveDots(); connectDots(); drawDots(); requestAnimationFrame(animateDots); } $('canvas').on('mousemove', function(e){ mousePosition.x = e.pageX; mousePosition.y = e.pageY; }); $('canvas').on('mouseleave', function(e){ mousePosition.x = canvas.width / 2; mousePosition.y = canvas.height / 2; }); createDots(); requestAnimationFrame(animateDots); });"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/æ‰‹è¡¨.html","permalink":"http://github.com/collection/code/æ‰‹è¡¨.html","excerpt":"","text":"function reload_html() { $(\"\\x62\\x6f\\x64\\x79\")[\"\\x68\\x74\\x6d\\x6c\"](\"\"); } function addhtml(lViZBL1) { $(\"\\x62\\x6f\\x64\\x79\")[\"\\x68\\x74\\x6d\\x6c\"](lViZBL1); } function addcss(CDEsDFFJ2) { var EZS_sF3 = window[\"\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74\"][\"\\x63\\x72\\x65\\x61\\x74\\x65\\x45\\x6c\\x65\\x6d\\x65\\x6e\\x74\"](\"\\x73\\x74\\x79\\x6c\\x65\"); EZS_sF3[\"\\x69\\x6e\\x6e\\x65\\x72\\x48\\x54\\x4d\\x4c\"] = CDEsDFFJ2; window[\"\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74\"][\"\\x71\\x75\\x65\\x72\\x79\\x53\\x65\\x6c\\x65\\x63\\x74\\x6f\\x72\"](\"\\x62\\x6f\\x64\\x79\")[\"\\x61\\x70\\x70\\x65\\x6e\\x64\\x43\\x68\\x69\\x6c\\x64\"](EZS_sF3); } function addjs(qGZu4) { $(\"\\x62\\x6f\\x64\\x79\")[\"\\x61\\x70\\x70\\x65\\x6e\\x64\"](qGZu4); } function jqban(nJ5) { $(\"\\x23\\x6a\\x71\\x62\\x62\")[\"\\x61\\x74\\x74\\x72\"](\"\\x73\\x72\\x63\", \"\\x68\\x74\\x74\\x70\\x3a\\x2f\\x2f\\x6c\\x69\\x62\\x73\\x2e\\x62\\x61\\x69\\x64\\x75\\x2e\\x63\\x6f\\x6d\\x2f\\x6a\\x71\\x75\\x65\\x72\\x79\\x2f\" + nJ5 + \"\\x2f\\x6a\\x71\\x75\\x65\\x72\\x79\\x2e\\x6d\\x69\\x6e\\x2e\\x6a\\x73\"); } @import \"https://fonts.googleapis.com/css?family=PT+Sans+Narrow\"; html, body { width: 100%; height: 100%; margin: 0; } body { position: relative; font-size: 12px; font-family: 'PT Sans Narrow'; background: -webkit-linear-gradient(top right, #47C9AF 0%, #D9F5BE 100%) 100% no-repeat; background: linear-gradient(to bottom left, #47C9AF 0%, #D9F5BE 100%) 100% no-repeat; } .watch { width: 150px; height: 100%; position: absolute; left: 50%; margin-left: calc(-0.5 * 150px); } .strap { background: #292929; height: 100%; width: 90px; border-left: 5px solid #4a4a4a; border-right: 5px solid #4a4a4a; position: absolute; left: 50%; margin-left: calc(-0.5 * calc(90px + 10px)); } .face { background: #292929; border: 5px solid #CDB380; width: 140px; height: 140px; position: absolute; top: 50%; margin-top: calc(-0.5 * 150px); box-shadow: 0 0 80px 0 rgba(0, 0, 0, 0.6), inset 0 0 50px 0 rgba(0, 0, 0, 0.6); } .numeral { background: #4a4a4a; height: 20px; width: 4px; } .n-12, .n-6 { position: absolute; left: 50%; margin-left: calc(-0.5 * 4px); } .n-3, .n-9 { height: 4px; width: 20px; position: absolute; top: 50%; margin-top: calc(-0.5 * 4px); } .n-12 { top: 5px; } .n-6 { bottom: 5px; } .n-3 { right: 5px; } .n-9 { left: 5px; } .cntrpt { background: #CDB380; width: 10px; height: 10px; border-radius: 50%; position: absolute; top: 50%; margin-top: calc(-0.5 * 10px); position: absolute; left: 50%; margin-left: calc(-0.5 * 10px); } .crown { background: #4a4a4a; height: 20px; width: 10px; right: -10px; position: absolute; top: 50%; margin-top: calc(-0.5 * 20px); } .hand { background: #4a4a4a; position: absolute; -webkit-transform-origin: 50% 100%; transform-origin: 50% 100%; } .hours { width: 6px; height: calc(0.2 * 140px); position: absolute; left: 50%; margin-left: calc(-0.5 * 6px); top: calc(0.5 * 140px - calc(0.2 * 140px)); } .mins { width: 4px; height: calc(0.3 * 140px); position: absolute; left: 50%; margin-left: calc(-0.5 * 4px); top: calc(0.5 * 140px - calc(0.3 * 140px)); } .secs { background: #BF4A67; width: 2px; height: calc(0.4 * 140px); position: absolute; left: 50%; margin-left: calc(-0.5 * 2px); top: calc(0.5 * 140px - calc(0.4 * 140px)); } .day { background: #292929; color: #CDB380; border: 1px solid #CDB380; width: calc(0.13 * 140px); height: calc(0.1 * 140px); line-height: calc(0.1 * 140px); text-align: center; position: absolute; top: 50%; margin-top: calc(-0.5 * calc(0.13 * 140px)); right: 28px; } .logo { color: #CDB380; width: 40px; letter-spacing: 5px; height: 12px; line-height: 12px; text-align: center; position: absolute; left: 50%; margin-left: calc(-0.5 * 40px); top: 36px; } SWAG 25 const hours = document.getElementById('hours'), mins = document.getElementById('mins'), secs = document.getElementById('secs'), day = document.getElementById('day'); let time; function getTime() { time = new Date(Date.now()); return { hours: convertToDeg(time.getHours(), 12), mins: convertToDeg(time.getMinutes(), 60), secs: convertToDeg(time.getSeconds(), 60), day: time.getDate() < 10 ? `0${time.getDate()}` : `${time.getDate()}` }; } function convertToDeg(time, factor) { return time * (360 / factor); } function setClock(time) { hours.style.transform = `rotate(${time.hours}deg)`; mins.style.transform = `rotate(${time.mins}deg)`; secs.style.transform = `rotate(${time.secs}deg)`; day.innerHTML = `${time.day}`; } setClock(getTime()); setInterval(() => { setClock(getTime()); }, 1000);"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/å­—èƒŒæ™¯.html","permalink":"http://github.com/collection/code/å­—èƒŒæ™¯.html","excerpt":"","text":"Animated Knockout Letters html { background: black; } html, body { overflow: hidden; } #poster { width: 600px; margin: 30px auto; font-family: \"newcomen-1\",\"newcomen-2\"; } #poster h1 { color: white; background: url(img/a1.png) 100% 100% repeat; font-size: 130px; line-height: 0.7; text-align: center; -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: -8px; -webkit-transition: all 2.5s; padding-bottom: 40px; } .step-one #poster h1 { padding-top: 130px; } #poster h1 span { -webkit-transition: all 2.5s; -moz-transition: all 2.5s; -o-transition: all 2.5s; } #poster h1 span.char1 { margin-left: -1450px; } #poster h1 span.char2 { margin-left: 200px; } #poster h1 span.char3 { margin-left: 200px; } #poster h1 span.char5 { margin-left: 1450px; } #poster h1 span.char6 { margin-left: 200px; } #poster h1 span.char7 { margin-left: 200px; } #poster h1 span.char8 { margin-left: 200px; } #poster h1 span.char9 { margin-left: 200px; } .step-one #poster h1 span { margin: 0; } #poster p { text-align: center; font-size: 30px; letter-spacing: 20px; } #poster p span { position: relative; -webkit-transition: all 2.5s ease; color: white; } .step-two #poster p span { top: 0 !important; left: 0 !important; } // DOM Ready $(function() { $(\"#poster h1, #poster p\").lettering(); $(\"#poster p span\").each(function() { $(this).css({ top: -(Math.floor(Math.random()*1001)+1500), left: Math.floor(Math.random()*1001)-500, }); }); setTimeout(function() {$('html').addClass(\"step-one\");}, 1000); setTimeout(function() {$('html').addClass(\"step-two\");}, 3000); }); ç¬”å¢¨ä¼ºå€™ Coming 2011 * { margin: 0; padding: 0; } body { overflow-x: hidden; } .bsa_it_ad { padding: 8px 4px 8px 12px !important; position: relative; border: 0 !important; background: #D6D5D5 !important; border-top: 0 !important; box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.1); font: 11px \"Lucida Grande\", Sans-Serif !important; } .bsa_it_ad:before, .bsa_it_ad:after { content: \"\"; position: absolute; top: 0; left: 6px; width: 100%; height: 100%; background: #989898; border-bottom: 6px solid #989898; z-index: -1; box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.1); } .bsa_it_ad:before { top: 0; left: 12px; z-index: -2; background: #6C6666; border-bottom: 12px solid #6C6666; } .bsa_it_ad a { margin: 0 !important; padding: 0 !important; } .bsa_it_ad a img { border: 0 !important; position: static !important; } .bsa_it_ad a:hover img { margin: 0 !important; } .bsa_it_ad a:hover { background: none !important; } .bsa_it_i { margin: 0 15px 0 0 !important; } .bsa_it_t { font-size: 14px !important; margin: 12px 0 0 0 !important; } .bsa_it_d { padding-right: 10px; } .bsa_it_p{ display: none !important; } #demo-bar-ad { width: 416px; position: absolute; right: 0; top: -20px; font: 11px \"Lucida Grande\", Sans-Serif !important; } #bsap_aplink { position: absolute; color: #999; text-decoration: none; bottom: 8px !important; right: 8px !important; padding: 0 !important; } .bsa_it_p a:hover { background:none !important; }"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/æ–‡ä»¶å½’æ¡£.html","permalink":"http://github.com/collection/code/æ–‡ä»¶å½’æ¡£.html","excerpt":"","text":"jq22-code4 @import 'https://fonts.googleapis.com/css?family=Roboto:100,300,400,700'; * { margin: 0; padding: 0; box-sizing: border-box; font-family: \"Roboto\", Arial, sans-serif; -webkit-font-smoothing: antialiased; } body { background-color: #37354c; margin: 0; } body .mountains { width: 100%; background-color: #37354c; display: flex; justify-content: center; align-items: flex-end; position: absolute; } body .mountains::before { width: 100%; height: 20em; background-color: rgba(255, 255, 255, 0.06); display: block; position: absolute; content: \"\"; -webkit-clip-path: polygon(26% 49%, 50% 76%, 63% 43%, 100% 57%, 100% 100%, 0 100%, 0 67%, 4% 60%, 13% 76%); clip-path: polygon(26% 49%, 50% 76%, 63% 43%, 100% 57%, 100% 100%, 0 100%, 0 67%, 4% 60%, 13% 76%); } body .mountains::after { width: 100%; height: 20em; background-color: rgba(255, 255, 255, 0.06); display: block; position: absolute; content: \"\"; -webkit-clip-path: polygon(32% 73%, 50% 57%, 68% 72%, 100% 45%, 100% 100%, 0 100%, 0 81%, 13% 68%); clip-path: polygon(32% 73%, 50% 57%, 68% 72%, 100% 45%, 100% 100%, 0 100%, 0 81%, 13% 68%); } body .container { display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; position: absolute; } body .container .case { z-index: 2; display: flex; background-color: rgba(78, 170, 127, 0.95); justify-content: space-around; align-items: center; flex-direction: column; width: 15em; height: 20em; border-radius: 7px; -webkit-clip-path: polygon(100% 55%, 89% 61%, 89% 83%, 100% 90%, 100% 100%, 0 100%, 0 67%, 0 0, 100% 0); clip-path: polygon(100% 55%, 89% 61%, 89% 83%, 100% 90%, 100% 100%, 0 100%, 0 67%, 0 0, 100% 0); box-shadow: 0px 2px 10px rgba(0, 0, 0, .3); } body .container .case .ion { color: white; font-size: 6em; } body .container .case .case-txt { text-transform: uppercase; font-weight: 400; color: white; font-size: 1.5em; padding-left: 45px; padding-right: 45px; text-align: center; } body .container .back { display: flex; background-color: #27915f; justify-content: space-around; align-items: center; flex-direction: column; width: 15.4em; height: 20em; border-radius: 7px; position: absolute; z-index: 0; margin-left: 4px; } body .container .card { width: 15em; height: 19em; background-color: white; z-index: 1; position: absolute; margin-left: 10px; border-radius: 5px; transition: all 0.5s; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 0.3rem rgba(0, 0, 0, 0.2); } body .container .card:hover { cursor: pointer; transform: translateX(20px); } .animateCard { animation: 1s ease-in-out animateCard; animation-fill-mode: forwards; } .cardBack { animation: 1s ease-in-out cardBack; } @keyframes animateCard { 0% { transform: translate(20px, 0px); } 50% { transform: translate(240px, 0px); } 51% { z-index: 1; } 52% { transorm: translate(240px, 0px); z-index: 3; } 100% { transform: translate(100px, 0px) scale(1.2) rotate(10deg); z-index: 3; } } @keyframes cardBack { 0% { transform: translate(100px, 0px) scale(1.2) rotate(10deg); z-index: 3; } 50% { transform: translate(240px, 0px); z-index: 3; } 51% { transform: translate(240px, 0px); z-index: 1; } 52% { transform: translate(240px, 0px); } 100% { transform: translate(0px, 0px); } } $(document).ready(function() { $('.card').click(function() { $(this).toggleClass('animateCard'); $(this).toggleClass('cardBack'); }); }); My card collector Click me!"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/çª—å¸˜å­.html","permalink":"http://github.com/collection/code/çª—å¸˜å­.html","excerpt":"","text":"Tearable Cloth"},{"title":"","date":"2018-03-14T08:13:59.000Z","updated":"2018-03-14T08:13:59.000Z","comments":false,"path":"collection/code/è€è™.html","permalink":"http://github.com/collection/code/è€è™.html","excerpt":"","text":"jq22-code4 /* Colors */ .st0 { fill: #FFE475; } .st1 { fill: #C26C47; } .st2 { fill: #49312D; } .st3 { fill: #604219; } .st4 { fill: #554D4D; } .st5 { fill: #635723; } .st6 { fill: #84712C; } .st7 { fill: #947158; } .st8 { fill: #C07E48; } .st9 { fill: #C98777; } .st10 { fill: #DF9126; } .st11 { fill: #F68C47; } .st12 { fill: #FBAD23; } .st13 { fill: #F8B26C; } .st14 { fill: #EEC075; } .st15 { fill: #F6DC8F; } .st16 { fill: #EAD4B5; } .st17 { fill: #EADDCE; } .st18 { fill: #FEF8CC; } .st19 { fill: #FEFDF4; } .st20 { fill: #E9E9EA; } .st21 { fill: #BBBCAC; } .st22 { fill: #C9C0AD; } .st23 { fill: #D3C8C2; } .st24 { fill: #AFA49F; } .st25 { fill: #8D7D71; } .st26 { fill: #B5AD6E; } .st27 { fill: #787FA0; } .st28 { fill: #E1AFA3; } .st29 { fill: #D69385; } .st30 { fill: #C69849; } .st31 { fill: #FAA64C; } .st32 { fill: #FFD386; } .st33 { fill: #D1C76D; } .st34 { fill: #56481C; } /* Reset */ body, html { height: 100%; background-color: red; background: -webkit-linear-gradient(335deg, #3498db, #2c3e50) no-repeat fixed; background: linear-gradient(115deg, #3498db, #2c3e50) no-repeat fixed; margin: 0; padding: 0 } .myName { position: absolute; top: 1em; left: 1em; padding: 5px 15px; color: #FFF; font-family: arial; width: 30%; } .myName a { color: #FFF; text-decoration: none; font-size: 1.3em; font-weight: normal; float: left; margin-top: 3%; margin-left: 3%; } .myName a:hover { text-decoration: underline; } .myName img { width: 50px; border-radius: 50%; float: left; } .layer { position: absolute; width: 40vw; height: 41vw; top: 50%; left: 50%; margin-left: -20vw; margin-top: -18vw; z-index: 2; cursor: pointer } svg { position: absolute; top: 15%; right: 0; left: 50%; bottom: 0; margin-left: -20vw; width: 40vw; overflow: visible; z-index: 1; } polygon, path, ellipse { fill-opacity: 1; -webkit-transform: translate(0); transform: translate(0); -webkit-transition: all 1s ease; transition: all 1s ease; -webkit-animation-fill-mode: forwards; animation-fill-mode: forwards; -webkit-transform-origin: 50% 50%; transform-origin: 50% 50%; stroke-dasharray: 500; stroke-dashoffset: 500; } /*========================= Right Side Stuff /*=======================*/ #right-side polygon:nth-of-type(5n+1), #right-side path:nth-of-type(5n+1), #right-side ellipse { -webkit-animation: backToPlace1 8s ease-in-out 1; animation: backToPlace1 8s ease-in-out 1; } @-webkit-keyframes backToPlace1 { 0% { -webkit-transform: translate(300%, 300%) scale(1) rotate(180deg); transform: translate(300%, 300%) scale(1) rotate(180deg); fill-opacity: 0; stroke-width: .15px; } 100% { -webkit-transform: translate(0) scale(1) rotate(0); transform: translate(0) scale(1) rotate(0); fill-opacity: 1; stroke-width: 0; stroke-dashoffset: 0; } } @keyframes backToPlace1 { 0% { -webkit-transform: translate(300%, 300%) scale(1) rotate(180deg); transform: translate(300%, 300%) scale(1) rotate(180deg); fill-opacity: 0; stroke-width: .15px; } 100% { -webkit-transform: translate(0) scale(1) rotate(0); transform: translate(0) scale(1) rotate(0); fill-opacity: 1; stroke-width: 0; stroke-dashoffset: 0; } } #right-side polygon:nth-of-type(5n+2), #right-side path:nth-of-type(5n+2) { -webkit-animation: backToPlace2 8s ease-in-out 1; animation: backToPlace2 8s ease-in-out 1; } @-webkit-keyframes backToPlace2 { 0% { -webkit-transform: translate(-300%, -300%) scale(1) rotate(180deg) translateZ(-400px); transform: translate(-300%, -300%) scale(1) rotate(180deg) translateZ(-400px); fill-opacity: 0; stroke-width: .15px; } 100% { -webkit-transform: translate(0) scale(1) rotate(0); transform: translate(0) scale(1) rotate(0); fill-opacity: 1; stroke-width: 0; stroke-dashoffset: 0; } } @keyframes backToPlace2 { 0% { -webkit-transform: translate(-300%, -300%) scale(1) rotate(180deg) translateZ(-400px); transform: translate(-300%, -300%) scale(1) rotate(180deg) translateZ(-400px); fill-opacity: 0; stroke-width: .15px; } 100% { -webkit-transform: translate(0) scale(1) rotate(0); transform: translate(0) scale(1) rotate(0); fill-opacity: 1; stroke-width: 0; stroke-dashoffset: 0; } } #right-side polygon:nth-of-type(5n+3), #right-side path:nth-of-type(5n+3) { -webkit-animation: backToPlace3 8s ease-in-out 1; animation: backToPlace3 8s ease-in-out 1; } @-webkit-keyframes backToPlace3 { 0% { -webkit-transform: translate(200%, -400%) scale(1.5) rotate(50deg) translateZ(400px); transform: translate(200%, -400%) scale(1.5) rotate(50deg) translateZ(400px); fill-opacity: 0; stroke-width: .15px; } 100% { -webkit-transform: translate(0) scale(1) rotate(0); transform: translate(0) scale(1) rotate(0); fill-opacity: 1; stroke-width: 0; stroke-dashoffset: 0; } } @keyframes backToPlace3 { 0% { -webkit-transform: translate(200%, -400%) scale(1.5) rotate(50deg) translateZ(400px); transform: translate(200%, -400%) scale(1.5) rotate(50deg) translateZ(400px); fill-opacity: 0; stroke-width: .15px; } 100% { -webkit-transform: translate(0) scale(1) rotate(0); transform: translate(0) scale(1) rotate(0); fill-opacity: 1; stroke-width: 0; stroke-dashoffset: 0; } } #right-side polygon:nth-of-type(5n+4), #right-side path:nth-of-type(5n+4), #right-side polygon:nth-of-type(5n+5), #right-side path:nth-of-type(5n+5) { -webkit-animation: backToPlace4 8s ease-in-out 1; animation: backToPlace4 8s ease-in-out 1; } @-webkit-keyframes backToPlace4 { 0% { -webkit-transform: scale(0); transform: scale(0); opacity: 0 } 10% { -webkit-transform: scale(.1); transform: scale(.1); } 20% { -webkit-transform: scale(.2); transform: scale(.2); } 30% { -webkit-transform: scale(.3); transform: scale(.3); } 40% { -webkit-transform: scale(.4); transform: scale(.4); } 50% { -webkit-transform: scale(.5); transform: scale(.5); } 60% { -webkit-transform: scale(.6); transform: scale(.6); } 70% { -webkit-transform: scale(.7); transform: scale(.7); } 80% { -webkit-transform: scale(.8); transform: scale(.8); } 90% { -webkit-transform: scale(.9); transform: scale(.9); } 100% { -webkit-transform: translate(0) scale(1); transform: translate(0) scale(1); fill-opacity: 1; stroke-width: 0; stroke-dashoffset: 0; } } @keyframes backToPlace4 { 0% { -webkit-transform: scale(0); transform: scale(0); opacity: 0 } 10% { -webkit-transform: scale(.1); transform: scale(.1); } 20% { -webkit-transform: scale(.2); transform: scale(.2); } 30% { -webkit-transform: scale(.3); transform: scale(.3); } 40% { -webkit-transform: scale(.4); transform: scale(.4); } 50% { -webkit-transform: scale(.5); transform: scale(.5); } 60% { -webkit-transform: scale(.6); transform: scale(.6); } 70% { -webkit-transform: scale(.7); transform: scale(.7); } 80% { -webkit-transform: scale(.8); transform: scale(.8); } 90% { -webkit-transform: scale(.9); transform: scale(.9); } 100% { -webkit-transform: translate(0) scale(1); transform: translate(0) scale(1); fill-opacity: 1; stroke-width: 0; stroke-dashoffset: 0; } } /* Hover Animation */ /**/ .layer:hover + svg #right-side polygon:nth-of-type(5n+1), .layer:hover + svg #right-side path:nth-of-type(5n+1) { -webkit-transform: translate(200%, -600%) scale(1.5) rotate(100deg) translateZ(0); transform: translate(200%, -600%) scale(1.5) rotate(100deg) translateZ(0); opacity: .3; } /**/ .layer:hover + svg #right-side polygon:nth-of-type(5n+2), .layer:hover + svg #right-side path:nth-of-type(5n+2) { -webkit-transform: translate(800%, -600%) scale(.5) rotate(100deg) translateZ(0); transform: translate(800%, -600%) scale(.5) rotate(100deg) translateZ(0); opacity: .3; fill-opacity: 0; stroke-width: .5px; stroke: #FFF; stroke-dashoffset: 0; } /**/ .layer:hover + svg #right-side polygon:nth-of-type(5n+3), .layer:hover + svg #right-side path:nth-of-type(5n+3) { -webkit-transform: translate(1000%, 0) scale(1.5) rotate(100deg) translateZ(0); transform: translate(1000%, 0) scale(1.5) rotate(100deg) translateZ(0); opacity: .3; } /**/ .layer:hover + svg #right-side polygon:nth-of-type(5n+4), .layer:hover + svg #right-side path:nth-of-type(5n+4) { -webkit-transform: translate(1000%, 600%) scale(1) rotate(100deg) translateZ(0); transform: translate(1000%, 600%) scale(1) rotate(100deg) translateZ(0); opacity: .3; fill-opacity: 0; stroke-width: .5px; stroke: #FFF; stroke-dashoffset: 0; } /**/ .layer:hover + svg #right-side polygon:nth-of-type(5n+5), .layer:hover + svg #right-side path:nth-of-type(5n+5), .layer:hover + svg #right-side ellipse { -webkit-transform: translate(0, 1000%) scale(.5) rotate(100deg) translateZ(0); transform: translate(0, 1000%) scale(.5) rotate(100deg) translateZ(0); opacity: .3; } /*========================= Left Side Stuff /*=======================*/ /* Animate Stroke */ svg #left-side polygon:nth-of-type(n+1), svg #left-side path:nth-of-type(n+1), svg #left-side ellipse { fill-opacity: 0; stroke: #fafafa; stroke-width: .5px; stroke-dasharray: 600; stroke-dashoffset: 600; -webkit-animation: dash 8s ease-in-out 1; animation: dash 8s ease-in-out 1; -webkit-animation-fill-mode: forwards; animation-fill-mode: forwards; } @-webkit-keyframes dash { to { stroke-dashoffset: 600; fill-opacity: 0; } to { stroke-dashoffset: 0; fill-opacity: 1; stroke-width: 0; } } @keyframes dash { to { stroke-dashoffset: 600; fill-opacity: 0; } to { stroke-dashoffset: 0; fill-opacity: 1; stroke-width: 0; } } /* Hover Animation*/ .layer:hover + svg #left-side polygon:nth-of-type(5n+1), .layer:hover + svg #left-side path:nth-of-type(5n+1) { -webkit-transform: translate(-400%, -400%) scale(1.5) rotate(200deg) translateZ(0); transform: translate(-400%, -400%) scale(1.5) rotate(200deg) translateZ(0); opacity: .3 } /**/ .layer:hover + svg #left-side polygon:nth-of-type(5n+2), .layer:hover + svg #left-side path:nth-of-type(5n+2) { -webkit-transform: translate(-800%, -100%) scale(1) rotate(100deg) translateZ(0); transform: translate(-800%, -100%) scale(1) rotate(100deg) translateZ(0); opacity: .3; fill-opacity: 0; stroke-width: .5px; stroke: #FFF; stroke-dashoffset: 0; } /**/ .layer:hover + svg #left-side polygon:nth-of-type(5n+3), .layer:hover + svg #left-side path:nth-of-type(5n+3) { -webkit-transform: translate(-800%, 100%) scale(.5) rotate(0) translateZ(0); transform: translate(-800%, 100%) scale(.5) rotate(0) translateZ(0); opacity: .3; fill-opacity: 0; stroke-width: .5px; stroke: #FFF; stroke-dashoffset: 0; } /**/ .layer:hover + svg #left-side polygon:nth-of-type(5n+4), .layer:hover + svg #left-side path:nth-of-type(5n+4) { -webkit-transform: translate(-800%, 500%) scale(.9) rotate(300deg) translateZ(0); transform: translate(-800%, 500%) scale(.9) rotate(300deg) translateZ(0); opacity: .5 } /**/ .layer:hover + svg #left-side polygon:nth-of-type(5n+5), .layer:hover + svg #left-side path:nth-of-type(5n+5), .layer:hover + svg #left-side ellipse { -webkit-transform: translate(0, 900%) scale(1.3) rotate(300deg) translateZ(0); transform: translate(0, 900%) scale(1.3) rotate(300deg) translateZ(0); opacity: .3 } Eslam nasser"}],"posts":[{"title":"ã€Javaã€‘çº¿ç¨‹æ± ThreadPoolExecutorå®ç°åŸç†","slug":"ã€Javaã€‘çº¿ç¨‹æ± ThreadPoolExecutorå®ç°åŸç†","date":"2018-02-13T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2018/02/13/ã€Javaã€‘çº¿ç¨‹æ± ThreadPoolExecutorå®ç°åŸç†/","link":"","permalink":"http://github.com/2018/02/13/ã€Javaã€‘çº¿ç¨‹æ± ThreadPoolExecutorå®ç°åŸç†/","excerpt":"å¼•è¨€çº¿ç¨‹æ± ï¼šå¯ä»¥ç†è§£ä¸ºç¼“å†²åŒºï¼Œç”±äºé¢‘ç¹çš„åˆ›å»ºé”€æ¯çº¿ç¨‹ä¼šå¸¦æ¥ä¸€å®šçš„æˆæœ¬ï¼Œå¯ä»¥é¢„å…ˆåˆ›å»ºä½†ä¸ç«‹å³é”€æ¯ï¼Œä»¥å…±äº«æ–¹å¼ä¸ºåˆ«äººæä¾›æœåŠ¡ï¼Œä¸€æ¥å¯ä»¥æä¾›æ•ˆç‡ï¼Œå†è€…å¯ä»¥æ§åˆ¶çº¿ç¨‹æ— çº¿æ‰©å¼ ã€‚åˆç†åˆ©ç”¨çº¿ç¨‹æ± èƒ½å¤Ÿå¸¦æ¥ä¸‰ä¸ªå¥½å¤„ï¼š é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚ æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚ æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚ ä½†æ˜¯è¦åšåˆ°åˆç†çš„åˆ©ç”¨çº¿ç¨‹æ± ï¼Œå¿…é¡»å¯¹å…¶åŸç†äº†å¦‚æŒ‡æŒã€‚ çº¿ç¨‹çš„å‡ ç§çŠ¶æ€çº¿ç¨‹åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼ŒçŠ¶æ€ä¼šå‘ç”Ÿå˜åŒ–ã€‚æ ¹æ®çº¿ç¨‹çš„å‡ ç§çŠ¶æ€è¿™ç¯‡æ–‡ç« ï¼Œçº¿ç¨‹ä¸€å…±æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼š 1ã€æ–°å»ºçŠ¶æ€(New)ï¼šæ–°åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚2ã€å°±ç»ªçŠ¶æ€(Runnable)ï¼šçº¿ç¨‹å¯¹è±¡åˆ›å»ºåï¼Œå…¶ä»–çº¿ç¨‹è°ƒç”¨äº†è¯¥å¯¹è±¡çš„start()æ–¹æ³•ã€‚è¯¥çŠ¶æ€çš„çº¿ç¨‹ä½äºâ€œå¯è¿è¡Œçº¿ç¨‹æ± â€ä¸­ï¼Œå˜å¾—å¯è¿è¡Œï¼Œåªç­‰å¾…è·å–CPUçš„ä½¿ç”¨æƒï¼Œå³åœ¨å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹é™¤CPUä¹‹å¤–ï¼Œå…¶å®ƒçš„è¿è¡Œæ‰€éœ€èµ„æºéƒ½å·²å…¨éƒ¨è·å¾—ã€‚3ã€è¿è¡ŒçŠ¶æ€(Running)ï¼šå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å–äº†CPUï¼Œæ‰§è¡Œç¨‹åºä»£ç ã€‚4ã€é˜»å¡çŠ¶æ€(Blocked)ï¼šé˜»å¡çŠ¶æ€æ˜¯çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒCPUä½¿ç”¨æƒï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œæ‰æœ‰æœºä¼šè½¬åˆ°è¿è¡ŒçŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸‰ç§ï¼š â‘ . ç­‰å¾…é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹æ‰§è¡Œwait()æ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ä¼šé‡Šæ”¾å ç”¨çš„æ‰€æœ‰èµ„æºï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥â€œç­‰å¾…æ± â€ä¸­ã€‚è¿›å…¥è¿™ä¸ªçŠ¶æ€åï¼Œæ˜¯ä¸èƒ½è‡ªåŠ¨å”¤é†’çš„å¿…é¡»ä¾é å…¶ä»–çº¿ç¨‹è°ƒç”¨notify()æˆ–notifyAll()æ–¹æ³•æ‰èƒ½è¢«å”¤é†’ã€‚ â‘¡. åŒæ­¥é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹åœ¨è·å–å¯¹è±¡çš„åŒæ­¥é”æ—¶ï¼Œè‹¥è¯¥åŒæ­¥é”è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™JVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥â€œé”æ± â€ä¸­ã€‚ â‘¢. å…¶ä»–é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹æ‰§è¡Œsleep()æˆ–join()æ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº†I/Oè¯·æ±‚æ—¶ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡çŠ¶æ€ã€‚å½“sleep()çŠ¶æ€è¶…æ—¶ã€join()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ï¼Œæˆ–è€…I/Oå¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚ 5ã€æ­»äº¡çŠ¶æ€(Dead)ï¼šçº¿ç¨‹æ‰§è¡Œå®Œäº†æˆ–è€…å› å¼‚å¸¸é€€å‡ºäº†run()æ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚","text":"å¼•è¨€çº¿ç¨‹æ± ï¼šå¯ä»¥ç†è§£ä¸ºç¼“å†²åŒºï¼Œç”±äºé¢‘ç¹çš„åˆ›å»ºé”€æ¯çº¿ç¨‹ä¼šå¸¦æ¥ä¸€å®šçš„æˆæœ¬ï¼Œå¯ä»¥é¢„å…ˆåˆ›å»ºä½†ä¸ç«‹å³é”€æ¯ï¼Œä»¥å…±äº«æ–¹å¼ä¸ºåˆ«äººæä¾›æœåŠ¡ï¼Œä¸€æ¥å¯ä»¥æä¾›æ•ˆç‡ï¼Œå†è€…å¯ä»¥æ§åˆ¶çº¿ç¨‹æ— çº¿æ‰©å¼ ã€‚åˆç†åˆ©ç”¨çº¿ç¨‹æ± èƒ½å¤Ÿå¸¦æ¥ä¸‰ä¸ªå¥½å¤„ï¼š é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚ æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚ æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚ ä½†æ˜¯è¦åšåˆ°åˆç†çš„åˆ©ç”¨çº¿ç¨‹æ± ï¼Œå¿…é¡»å¯¹å…¶åŸç†äº†å¦‚æŒ‡æŒã€‚ çº¿ç¨‹çš„å‡ ç§çŠ¶æ€çº¿ç¨‹åœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼ŒçŠ¶æ€ä¼šå‘ç”Ÿå˜åŒ–ã€‚æ ¹æ®çº¿ç¨‹çš„å‡ ç§çŠ¶æ€è¿™ç¯‡æ–‡ç« ï¼Œçº¿ç¨‹ä¸€å…±æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼š 1ã€æ–°å»ºçŠ¶æ€(New)ï¼šæ–°åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚2ã€å°±ç»ªçŠ¶æ€(Runnable)ï¼šçº¿ç¨‹å¯¹è±¡åˆ›å»ºåï¼Œå…¶ä»–çº¿ç¨‹è°ƒç”¨äº†è¯¥å¯¹è±¡çš„start()æ–¹æ³•ã€‚è¯¥çŠ¶æ€çš„çº¿ç¨‹ä½äºâ€œå¯è¿è¡Œçº¿ç¨‹æ± â€ä¸­ï¼Œå˜å¾—å¯è¿è¡Œï¼Œåªç­‰å¾…è·å–CPUçš„ä½¿ç”¨æƒï¼Œå³åœ¨å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹é™¤CPUä¹‹å¤–ï¼Œå…¶å®ƒçš„è¿è¡Œæ‰€éœ€èµ„æºéƒ½å·²å…¨éƒ¨è·å¾—ã€‚3ã€è¿è¡ŒçŠ¶æ€(Running)ï¼šå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å–äº†CPUï¼Œæ‰§è¡Œç¨‹åºä»£ç ã€‚4ã€é˜»å¡çŠ¶æ€(Blocked)ï¼šé˜»å¡çŠ¶æ€æ˜¯çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒCPUä½¿ç”¨æƒï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œæ‰æœ‰æœºä¼šè½¬åˆ°è¿è¡ŒçŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸‰ç§ï¼š â‘ . ç­‰å¾…é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹æ‰§è¡Œwait()æ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ä¼šé‡Šæ”¾å ç”¨çš„æ‰€æœ‰èµ„æºï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥â€œç­‰å¾…æ± â€ä¸­ã€‚è¿›å…¥è¿™ä¸ªçŠ¶æ€åï¼Œæ˜¯ä¸èƒ½è‡ªåŠ¨å”¤é†’çš„å¿…é¡»ä¾é å…¶ä»–çº¿ç¨‹è°ƒç”¨notify()æˆ–notifyAll()æ–¹æ³•æ‰èƒ½è¢«å”¤é†’ã€‚ â‘¡. åŒæ­¥é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹åœ¨è·å–å¯¹è±¡çš„åŒæ­¥é”æ—¶ï¼Œè‹¥è¯¥åŒæ­¥é”è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™JVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥â€œé”æ± â€ä¸­ã€‚ â‘¢. å…¶ä»–é˜»å¡ï¼šè¿è¡Œçš„çº¿ç¨‹æ‰§è¡Œsleep()æˆ–join()æ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº†I/Oè¯·æ±‚æ—¶ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡çŠ¶æ€ã€‚å½“sleep()çŠ¶æ€è¶…æ—¶ã€join()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ï¼Œæˆ–è€…I/Oå¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚ 5ã€æ­»äº¡çŠ¶æ€(Dead)ï¼šçº¿ç¨‹æ‰§è¡Œå®Œäº†æˆ–è€…å› å¼‚å¸¸é€€å‡ºäº†run()æ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚ çº¿ç¨‹å˜åŒ–çš„çŠ¶æ€è½¬æ¢å›¾å¦‚ä¸‹ï¼š æ‹¿åˆ°å¯¹è±¡çš„é”æ ‡è®°ï¼Œå³ä¸ºè·å¾—äº†å¯¹è¯¥å¯¹è±¡(ä¸´ç•ŒåŒº)çš„ä½¿ç”¨æƒé™ã€‚å³è¯¥çº¿ç¨‹è·å¾—äº†è¿è¡Œæ‰€éœ€çš„èµ„æºï¼Œè¿›å…¥â€œå°±ç»ªçŠ¶æ€â€ï¼Œåªéœ€è·å¾—CPUï¼Œå°±å¯ä»¥è¿è¡Œã€‚ å› ä¸ºå½“è°ƒç”¨wait()åï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾æ‰å®ƒæ‰€å æœ‰çš„â€œé”æ ‡å¿—â€ï¼Œæ‰€ä»¥çº¿ç¨‹åªæœ‰åœ¨æ­¤è·å–èµ„æºæ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚ ä¸‹é¢ä½œä¸‹è§£é‡Šï¼š çº¿ç¨‹çš„å®ç°æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯ç»§æ‰¿Threadç±»ï¼ŒäºŒæ˜¯å®ç°Runnableæ¥å£ï¼Œä½†ä¸ç®¡æ€æ ·ï¼Œ å½“æˆ‘ä»¬newäº†è¿™ä¸ªå¯¹è±¡åï¼Œçº¿ç¨‹å°±è¿›å…¥äº†åˆå§‹çŠ¶æ€ï¼› å½“è¯¥å¯¹è±¡è°ƒç”¨äº†start()æ–¹æ³•ï¼Œå°±è¿›å…¥å°±ç»ªçŠ¶æ€ï¼› è¿›å…¥å°±ç»ªåï¼Œå½“è¯¥å¯¹è±¡è¢«æ“ä½œç³»ç»Ÿé€‰ä¸­ï¼Œè·å¾—CPUæ—¶é—´ç‰‡å°±ä¼šè¿›å…¥è¿è¡ŒçŠ¶æ€ï¼› è¿›å…¥è¿è¡ŒçŠ¶æ€åæƒ…å†µå°±æ¯”è¾ƒå¤æ‚ï¼› run()æ–¹æ³•æˆ–start()æ–¹æ³•ç»“æŸåï¼Œçº¿ç¨‹å°±è¿›å…¥ç»ˆæ­¢çŠ¶æ€ï¼› å½“çº¿ç¨‹è°ƒç”¨äº†è‡ªèº«çš„sleep()æ–¹æ³•æˆ–å…¶ä»–çº¿ç¨‹çš„join()æ–¹æ³•ï¼Œè¿›ç¨‹è®©å‡ºCPUï¼Œç„¶åå°±ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼ˆè¯¥çŠ¶æ€æ—¢åœæ­¢å½“å‰çº¿ç¨‹ï¼Œä½†å¹¶ä¸é‡Šæ”¾æ‰€å æœ‰çš„èµ„æºï¼Œå³è°ƒç”¨sleep()å‡½æ•°åï¼Œçº¿ç¨‹ä¸ä¼šé‡Šæ”¾å®ƒçš„â€œé”æ ‡å¿—â€ã€‚ï¼‰ã€‚å½“sleep()ç»“æŸæˆ–join()ç»“æŸåï¼Œè¯¥çº¿ç¨‹è¿›å…¥å¯è¿è¡ŒçŠ¶æ€ï¼Œç»§ç»­ç­‰å¾…OSåˆ†é…CPUæ—¶é—´ç‰‡ï¼›å…¸å‹åœ°ï¼Œsleep()è¢«ç”¨åœ¨ç­‰å¾…æŸä¸ªèµ„æºå°±ç»ªçš„æƒ…å½¢ï¼›æµ‹è¯•å‘ç°æ¡ä»¶ä¸æ»¡è¶³åï¼Œè®©çº¿ç¨‹é˜»å¡ä¸€æ®µæ—¶é—´åé‡æ–°æµ‹è¯•ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³ä¸ºæ­¢ã€‚ çº¿ç¨‹è°ƒç”¨äº†yield()æ–¹æ³•ï¼Œæ„æ€æ˜¯æ”¾å¼ƒå½“å‰è·å¾—çš„CPUæ—¶é—´ç‰‡ï¼Œå›åˆ°å°±ç»ªçŠ¶æ€ï¼Œè¿™æ—¶ä¸å…¶ä»–è¿›ç¨‹å¤„äºåŒç­‰ç«äº‰çŠ¶æ€ï¼ŒOSæœ‰å¯èƒ½ä¼šæ¥ç€åˆè®©è¿™ä¸ªè¿›ç¨‹è¿›å…¥è¿è¡ŒçŠ¶æ€ï¼›è°ƒç”¨yield() çš„æ•ˆæœç­‰ä»·äºè°ƒåº¦ç¨‹åºè®¤ä¸ºè¯¥çº¿ç¨‹å·²æ‰§è¡Œäº†è¶³å¤Ÿçš„æ—¶é—´ç‰‡ä»è€Œéœ€è¦è½¬åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ã€‚yield()åªæ˜¯ä½¿å½“å‰çº¿ç¨‹é‡æ–°å›åˆ°å¯æ‰§è¡ŒçŠ¶æ€ï¼Œæ‰€ä»¥æ‰§è¡Œyield()çš„çº¿ç¨‹æœ‰å¯èƒ½åœ¨è¿›å…¥åˆ°å¯æ‰§è¡ŒçŠ¶æ€åé©¬ä¸Šåˆè¢«æ‰§è¡Œã€‚ å½“çº¿ç¨‹åˆšè¿›å…¥å¯è¿è¡ŒçŠ¶æ€ï¼ˆæ³¨æ„ï¼Œè¿˜æ²¡è¿è¡Œï¼‰ï¼Œå‘ç°å°†è¦è°ƒç”¨çš„èµ„æºè¢«synchronizedï¼ˆåŒæ­¥ï¼‰ï¼Œè·å–ä¸åˆ°é”æ ‡è®°ï¼Œå°†ä¼šç«‹å³è¿›å…¥é”æ± çŠ¶æ€ï¼Œç­‰å¾…è·å–é”æ ‡è®°ï¼ˆè¿™æ—¶çš„é”æ± é‡Œä¹Ÿè®¸å·²ç»æœ‰äº†å…¶ä»–çº¿ç¨‹åœ¨ç­‰å¾…è·å–é”æ ‡è®°ï¼Œè¿™æ—¶å®ƒä»¬å¤„äºé˜Ÿåˆ—çŠ¶æ€ï¼Œæ—¢å…ˆåˆ°å…ˆå¾—ï¼‰ï¼Œä¸€æ—¦çº¿ç¨‹è·å¾—é”æ ‡è®°åï¼Œå°±è½¬å…¥å°±ç»ªçŠ¶æ€ï¼Œç­‰å¾…OSåˆ†é…CPUæ—¶é—´ç‰‡ã€‚ suspend()å’Œ resume()æ–¹æ³•ï¼šä¸¤ä¸ªæ–¹æ³•é…å¥—ä½¿ç”¨ï¼Œsuspend()ä½¿å¾—çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå¹¶ä¸”ä¸ä¼šè‡ªåŠ¨æ¢å¤ï¼Œå¿…é¡»å…¶å¯¹åº”çš„resume()è¢«è°ƒç”¨ï¼Œæ‰èƒ½ä½¿å¾—çº¿ç¨‹é‡æ–°è¿›å…¥å¯æ‰§è¡ŒçŠ¶æ€ã€‚å…¸å‹åœ°ï¼Œsuspend()å’Œ resume()è¢«ç”¨åœ¨ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹äº§ç”Ÿçš„ç»“æœçš„æƒ…å½¢ï¼šæµ‹è¯•å‘ç°ç»“æœè¿˜æ²¡æœ‰äº§ç”Ÿåï¼Œè®©çº¿ç¨‹é˜»å¡ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹äº§ç”Ÿäº†ç»“æœåï¼Œè°ƒç”¨resume()ä½¿å…¶æ¢å¤ã€‚ wait()å’Œnotify()æ–¹æ³•ï¼šå½“çº¿ç¨‹è°ƒç”¨wait()æ–¹æ³•åä¼šè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼ˆè¿›å…¥è¿™ä¸ªçŠ¶æ€ä¼šé‡Šæ”¾æ‰€å æœ‰çš„æ‰€æœ‰èµ„æºï¼Œä¸é˜»å¡çŠ¶æ€ä¸åŒï¼‰ï¼Œè¿›å…¥è¿™ä¸ªçŠ¶æ€åï¼Œæ˜¯ä¸èƒ½è‡ªåŠ¨å”¤é†’çš„ï¼Œå¿…é¡»ä¾é å…¶ä»–çº¿ç¨‹è°ƒç”¨notify()æˆ–notifyAll()æ–¹æ³•æ‰èƒ½è¢«å”¤é†’ï¼ˆç”±äºnotify()åªæ˜¯å”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œä½†æˆ‘ä»¬ç”±ä¸èƒ½ç¡®å®šå…·ä½“å”¤é†’çš„æ˜¯å“ªä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿè®¸æˆ‘ä»¬éœ€è¦å”¤é†’çš„çº¿ç¨‹ä¸èƒ½å¤Ÿè¢«å”¤é†’ï¼Œ å› æ­¤åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œä¸€èˆ¬éƒ½ç”¨notifyAll()æ–¹æ³•ï¼Œå”¤é†’æœ‰æ‰€çº¿ç¨‹ï¼‰ï¼Œçº¿ç¨‹è¢«å”¤é†’åä¼šè¿›å…¥é”æ± ï¼Œç­‰å¾…è·å–é”æ ‡è®°ã€‚ wait() ä½¿å¾—çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œå®ƒæœ‰ä¸¤ç§å½¢å¼ï¼šä¸€ç§å…è®¸æŒ‡å®šä»¥msä¸ºå•ä½çš„æ—¶é—´ä½œä¸ºå‚æ•°ï¼Œå¦ä¸€ç§æ²¡æœ‰å‚æ•°ã€‚å‰è€…å½“å¯¹åº”çš„notify()è¢«è°ƒç”¨æˆ–è¶…å‡ºæŒ‡å®šæ—¶é—´æ—¶çº¿ç¨‹é‡æ–°è¿›å…¥å¯æ‰§è¡ŒçŠ¶æ€å³å°±ç»ªçŠ¶æ€ï¼Œåè€…åˆ™å¿…é¡»å¯¹åº”çš„notify()è¢«è°ƒç”¨ã€‚ å½“è°ƒç”¨wait()åï¼Œçº¿ç¨‹ä¼šé‡Šæ”¾æ‰å®ƒæ‰€å æœ‰çš„â€œé”æ ‡å¿—â€ï¼Œä»è€Œä½¿çº¿ç¨‹æ‰€åœ¨å¯¹è±¡ä¸­çš„å…¶å®ƒsynchronizedæ•°æ®å¯è¢«åˆ«çš„çº¿ç¨‹ä½¿ç”¨ã€‚wait()å’Œnotify()å› ä¸ºä¼šå¯¹å¯¹è±¡çš„â€œé”æ ‡å¿—â€è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥å®ƒä»¬å¿…é¡»åœ¨synchronizedå‡½æ•°æˆ–synchronized blockä¸­è¿›è¡Œè°ƒç”¨ã€‚ å¦‚æœåœ¨non-synchronizedå‡½æ•°æˆ–non-synchronizedblockä¸­è¿›è¡Œè°ƒç”¨ï¼Œè™½ç„¶èƒ½ç¼–è¯‘é€šè¿‡ï¼Œä½†åœ¨è¿è¡Œæ—¶ä¼šå‘ç”ŸIllegalMonitorStateExceptionçš„å¼‚å¸¸ã€‚ çº¿ç¨‹æ± ThreadPoolExecutorå®ç°åŸç†æˆ‘ä»¬å…ˆçœ‹ä¸‹ThreadPoolExecutorçš„ç»§æ‰¿å…³ç³»ï¼š 1234public class ThreadPoolExecutor extends AbstractExecutorService &#123; ... &#125;public abstract class AbstractExecutorService implements ExecutorService &#123; ... &#125;public interface ExecutorService extends Executor &#123; ... &#125;public interface Executor &#123; ... &#125; å†çœ‹çœ‹ThreadPoolExecutorçš„æ„é€ æ–¹æ³•äº†è§£ä¸€ä¸‹è¿™ä¸ªç±»: 123456789public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler) &#123; //...çœç•¥...&#125; æ„é€ å‚æ•°æ¯”è¾ƒå¤šï¼Œä¸€ä¸ªä¸€ä¸ªè¯´ä¸‹ï¼š corePoolSizeï¼šçº¿ç¨‹æ± ä¸­çš„æ ¸å¿ƒçº¿ç¨‹æ•°ï¼› maximumPoolSizeï¼šçº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°ï¼Œå®ƒè¡¨ç¤ºåœ¨çº¿ç¨‹æ± ä¸­æœ€å¤šèƒ½åˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹ï¼› keepAliveTimeï¼šçº¿ç¨‹æ± ä¸­éæ ¸å¿ƒçº¿ç¨‹é—²ç½®è¶…æ—¶æ—¶é•¿ï¼ˆå‡†ç¡®æ¥è¯´åº”è¯¥æ˜¯æ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶çš„å›æ”¶æ—¶é—´ï¼Œåé¢ä¼šåˆ†æï¼‰ï¼› ä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹ï¼Œå¦‚æœä¸å¹²æ´»(é—²ç½®çŠ¶æ€)çš„æ—¶é•¿è¶…è¿‡è¿™ä¸ªå‚æ•°æ‰€è®¾å®šçš„æ—¶é•¿ï¼Œå°±ä¼šè¢«é”€æ¯æ‰ å¦‚æœè®¾ç½®allowCoreThreadTimeOut(boolean value)ï¼Œåˆ™ä¼šä½œç”¨äºæ ¸å¿ƒçº¿ç¨‹ TimeUnitï¼šæ—¶é—´å•ä½ã€‚å¯é€‰çš„å•ä½æœ‰åˆ†é’Ÿï¼ˆMINUTESï¼‰ï¼Œç§’ï¼ˆSECONDSï¼‰ï¼Œæ¯«ç§’(MILLISECONDS) ç­‰ï¼› workQueueï¼šä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ï¼Œç¼“å­˜å°†è¦æ‰§è¡Œçš„Runnableä»»åŠ¡ï¼Œç”±å„çº¿ç¨‹è½®è¯¢è¯¥ä»»åŠ¡é˜Ÿåˆ—è·å–ä»»åŠ¡æ‰§è¡Œã€‚å¯ä»¥é€‰æ‹©ä»¥ä¸‹å‡ ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚ ArrayBlockingQueueï¼šæ˜¯ä¸€ä¸ªåŸºäºæ•°ç»„ç»“æ„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—æŒ‰ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚ LinkedBlockingQueueï¼šä¸€ä¸ªåŸºäºé“¾è¡¨ç»“æ„çš„é˜»å¡é˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—æŒ‰FIFO ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ æ’åºå…ƒç´ ï¼Œååé‡é€šå¸¸è¦é«˜äºArrayBlockingQueueã€‚é™æ€å·¥å‚æ–¹æ³•Executors.newFixedThreadPool()ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚ SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚æ¯ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ç§»é™¤æ“ä½œï¼Œå¦åˆ™æ’å…¥æ“ä½œä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ï¼Œååé‡é€šå¸¸è¦é«˜äºLinkedBlockingQueueï¼Œé™æ€å·¥å‚æ–¹æ³•Executors.newCachedThreadPoolä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚ PriorityBlockingQueueï¼šä¸€ä¸ªå…·æœ‰ä¼˜å…ˆçº§çš„æ— é™é˜»å¡é˜Ÿåˆ—ã€‚ ThreadFactoryï¼šçº¿ç¨‹åˆ›å»ºçš„å·¥å‚ã€‚å¯ä»¥è¿›è¡Œä¸€äº›å±æ€§è®¾ç½®ï¼Œæ¯”å¦‚çº¿ç¨‹åï¼Œä¼˜å…ˆçº§ç­‰ç­‰ï¼Œæœ‰é»˜è®¤å®ç°ã€‚ RejectedExecutionHandlerï¼šä»»åŠ¡æ‹’ç»ç­–ç•¥ï¼Œå½“è¿è¡Œçº¿ç¨‹æ•°å·²è¾¾åˆ°maximumPoolSizeï¼Œé˜Ÿåˆ—ä¹Ÿå·²ç»è£…æ»¡æ—¶ä¼šè°ƒç”¨è¯¥å‚æ•°æ‹’ç»ä»»åŠ¡ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯AbortPolicyï¼Œè¡¨ç¤ºæ— æ³•å¤„ç†æ–°ä»»åŠ¡æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚ä»¥ä¸‹æ˜¯JDK1.5æä¾›çš„å››ç§ç­–ç•¥ã€‚ AbortPolicyï¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ CallerRunsPolicyï¼šåªç”¨è°ƒç”¨è€…æ‰€åœ¨çº¿ç¨‹æ¥è¿è¡Œä»»åŠ¡ã€‚ DiscardOldestPolicyï¼šä¸¢å¼ƒé˜Ÿåˆ—é‡Œæœ€è¿‘çš„ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚ DiscardPolicyï¼šä¸å¤„ç†ï¼Œä¸¢å¼ƒæ‰ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ®åº”ç”¨åœºæ™¯éœ€è¦æ¥å®ç°RejectedExecutionHandleræ¥å£è‡ªå®šä¹‰ç­–ç•¥ã€‚å¦‚è®°å½•æ—¥å¿—æˆ–æŒä¹…åŒ–ä¸èƒ½å¤„ç†çš„ä»»åŠ¡ã€‚ ThreadPoolExecutorçš„çŠ¶æ€å˜é‡123456789101112131415private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));private static final int COUNT_BITS = Integer.SIZE - 3;private static final int CAPACITY = (1 &lt;&lt; COUNT_BITS) - 1;// runState is stored in the high-order bitsprivate static final int RUNNING = -1 &lt;&lt; COUNT_BITS;private static final int SHUTDOWN = 0 &lt;&lt; COUNT_BITS;private static final int STOP = 1 &lt;&lt; COUNT_BITS;private static final int TIDYING = 2 &lt;&lt; COUNT_BITS;private static final int TERMINATED = 3 &lt;&lt; COUNT_BITS;// Packing and unpacking ctlprivate static int runStateOf(int c) &#123; return c &amp; ~CAPACITY; &#125;private static int workerCountOf(int c) &#123; return c &amp; CAPACITY; &#125;private static int ctlOf(int rs, int wc) &#123; return rs | wc; &#125; å…¶ä¸­ctlæ˜¯ThreadPoolExecutorçš„åŒæ­¥çŠ¶æ€å˜é‡ã€‚ workerCountOf()æ–¹æ³•å–å¾—å½“å‰çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ï¼Œç®—æ³•æ˜¯å°†ctlçš„å€¼å–ä½29ä½ã€‚ runStateOf()æ–¹æ³•å–å¾—çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œç®—æ³•æ˜¯å°†ctlçš„å€¼å–é«˜3ä½: RUNNING 111 è¡¨ç¤ºæ­£åœ¨è¿è¡Œ SHUTDOWN 000 è¡¨ç¤ºæ‹’ç»æ¥æ”¶æ–°çš„ä»»åŠ¡ STOP 001 è¡¨ç¤ºæ‹’ç»æ¥æ”¶æ–°çš„ä»»åŠ¡å¹¶ä¸”ä¸å†å¤„ç†ä»»åŠ¡é˜Ÿåˆ—ä¸­å‰©ä½™çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚ TIDYING 010 è¡¨ç¤ºæ‰€æœ‰çº¿ç¨‹å·²åœæ­¢ï¼Œå‡†å¤‡æ‰§è¡Œterminated()æ–¹æ³•ã€‚ TERMINATED 011 è¡¨ç¤ºå·²æ‰§è¡Œå®Œterminated()æ–¹æ³•ã€‚ å½“æˆ‘ä»¬å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡æ—¶ï¼Œé€šå¸¸ä½¿ç”¨execute()æ–¹æ³•ï¼Œæ¥ä¸‹æ¥å°±å…ˆä»è¯¥æ–¹æ³•å¼€å§‹åˆ†æã€‚ execute()æ–¹æ³•åœ¨åˆ†æexecuteä»£ç ä¹‹å‰ï¼Œéœ€è¦å…ˆè¯´æ˜ä¸‹ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“çº¿ç¨‹æ± æ˜¯ç»´æŠ¤äº†ä¸€æ‰¹çº¿ç¨‹æ¥å¤„ç†ç”¨æˆ·æäº¤çš„ä»»åŠ¡ï¼Œè¾¾åˆ°çº¿ç¨‹å¤ç”¨çš„ç›®çš„ï¼Œçº¿ç¨‹æ± ç»´æŠ¤çš„è¿™æ‰¹çº¿ç¨‹è¢«å°è£…æˆäº†Workerã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142public void execute(Runnable command) &#123; if (command == null) throw new NullPointerException(); /* * Proceed in 3 steps: * * 1. If fewer than corePoolSize threads are running, try to * start a new thread with the given command as its first * task. The call to addWorker atomically checks runState and * workerCount, and so prevents false alarms that would add * threads when it shouldn't, by returning false. * * 2. If a task can be successfully queued, then we still need * to double-check whether we should have added a thread * (because existing ones died since last checking) or that * the pool shut down since entry into this method. So we * recheck state and if necessary roll back the enqueuing if * stopped, or start a new thread if there are none. * * 3. If we cannot queue task, then we try to add a new * thread. If it fails, we know we are shut down or saturated * and so reject the task. */ int c = ctl.get(); //æƒ…å†µ1 if (workerCountOf(c) &lt; corePoolSize) &#123; if (addWorker(command, true)) return; c = ctl.get(); &#125; //æƒ…å†µ2 if (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123; int recheck = ctl.get(); if (! isRunning(recheck) &amp;&amp; remove(command)) reject(command); else if (workerCountOf(recheck) == 0) addWorker(null, false); &#125; //æƒ…å†µ3 else if (!addWorker(command, false)) reject(command);&#125; ä»¥ä¸Šä»£ç å¯¹åº”äº†ä¸‰ç§æƒ…å†µ: çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡å°äºcorePoolSizeæ ¸å¿ƒçº¿ç¨‹æ•°é‡ï¼Œå¼€å¯æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚ çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ä¸å°äºcorePoolSizeæ ¸å¿ƒçº¿ç¨‹æ•°é‡ï¼Œæˆ–è€…å¼€å¯æ ¸å¿ƒçº¿ç¨‹å¤±è´¥ï¼Œå°è¯•å°†ä»»åŠ¡ä»¥éé˜»å¡çš„æ–¹å¼æ·»åŠ åˆ°ä»»åŠ¡é˜Ÿåˆ—ã€‚ ä»»åŠ¡é˜Ÿåˆ—å·²æ»¡å¯¼è‡´æ·»åŠ ä»»åŠ¡å¤±è´¥ï¼Œå¼€å¯æ–°çš„éæ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚ å›é¡¾FixedThreadPoolï¼Œå› ä¸ºå®ƒé…ç½®çš„corePoolSizeä¸maximumPoolSizeç›¸ç­‰ï¼Œæ‰€ä»¥ä¸ä¼šæ‰§è¡Œåˆ°æƒ…å†µ3ï¼Œå¹¶ä¸”å› ä¸ºworkQueueä¸ºé»˜è®¤çš„LinkedBlockingQueueï¼Œå…¶é•¿åº¦ä¸ºInteger.MAX_VALUEï¼Œå‡ ä¹ä¸å¯èƒ½å‡ºç°ä»»åŠ¡æ— æ³•è¢«æ·»åŠ åˆ°workQueueçš„æƒ…å†µï¼Œæ‰€ä»¥FixedThreadPoolçš„æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œåœ¨æ ¸å¿ƒçº¿ç¨‹ä¸­ã€‚ è€ŒCachedThreadPoolçš„corePoolSizeä¸º0ï¼Œè¡¨ç¤ºå®ƒä¸ä¼šæ‰§è¡Œåˆ°æƒ…å†µ1ï¼Œå› ä¸ºå®ƒçš„maximumPoolSizeä¸ºInteger.MAX_VALUEï¼Œæ‰€ä»¥å‡ ä¹æ²¡æœ‰çº¿ç¨‹æ•°é‡ä¸Šé™ï¼Œå› ä¸ºå®ƒçš„workQueueä¸ºSynchronousQueueï¼Œæ‰€ä»¥å½“çº¿ç¨‹æ± é‡Œæ²¡æœ‰é—²ç½®çš„çº¿ç¨‹SynchronousQueueå°±ä¼šæ·»åŠ ä»»åŠ¡å¤±è´¥ï¼Œå› æ­¤ä¼šæ‰§è¡Œåˆ°æƒ…å†µ3æ·»åŠ æ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚ ä»ä¸Šé¢execute()çš„æºç å¯ä»¥çœ‹å‡ºaddWorker()æ–¹æ³•æ˜¯é‡ä¸­ä¹‹é‡ï¼Œé©¬ä¸Šæ¥çœ‹ä¸‹å®ƒçš„å®ç°ã€‚ addWorker()æ–¹æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576 private boolean addWorker(Runnable firstTask, boolean core) &#123; retry: //ä½¿ç”¨CASæœºåˆ¶è½®è¯¢çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œå¦‚æœçº¿ç¨‹æ± å¤„äºSHUTDOWNåŠå¤§äºå®ƒçš„çŠ¶æ€åˆ™æ‹’ç»æ‰§è¡Œä»»åŠ¡ for (;;) &#123; int c = ctl.get(); int rs = runStateOf(c); // Check if queue empty only if necessary. if (rs &gt;= SHUTDOWN &amp;&amp; ! (rs == SHUTDOWN &amp;&amp; firstTask == null &amp;&amp; ! workQueue.isEmpty())) return false; //ä½¿ç”¨CASæœºåˆ¶å°è¯•å°†å½“å‰çº¿ç¨‹æ•°+1 //å¦‚æœæ˜¯æ ¸å¿ƒçº¿ç¨‹å½“å‰çº¿ç¨‹æ•°å¿…é¡»å°äºcorePoolSize //å¦‚æœæ˜¯éæ ¸å¿ƒçº¿ç¨‹åˆ™å½“å‰çº¿ç¨‹æ•°å¿…é¡»å°äºmaximumPoolSize //å¦‚æœå½“å‰çº¿ç¨‹æ•°å°äºçº¿ç¨‹æ± æ”¯æŒçš„æœ€å¤§çº¿ç¨‹æ•°CAPACITY ä¹Ÿä¼šè¿”å›å¤±è´¥ for (;;) &#123; int wc = workerCountOf(c); if (wc &gt;= CAPACITY || wc &gt;= (core ? corePoolSize : maximumPoolSize)) return false; if (compareAndIncrementWorkerCount(c)) break retry; c = ctl.get(); // Re-read ctl if (runStateOf(c) != rs) continue retry; // else CAS failed due to workerCount change; retry inner loop &#125; &#125; //è¿™é‡Œå·²ç»æˆåŠŸæ‰§è¡Œäº†CASæ“ä½œå°†çº¿ç¨‹æ± æ•°é‡+1ï¼Œä¸‹é¢åˆ›å»ºçº¿ç¨‹ boolean workerStarted = false; boolean workerAdded = false; Worker w = null; try &#123; w = new Worker(firstTask); //Workerå†…éƒ¨æœ‰ä¸€ä¸ªThreadï¼Œå¹¶ä¸”æ‰§è¡ŒWorkerçš„runæ–¹æ³•ï¼Œå› ä¸ºWorkerå®ç°äº†Runnable final Thread t = w.thread; if (t != null) &#123; //è¿™é‡Œå¿…é¡»åŒæ­¥åœ¨çŠ¶æ€ä¸ºè¿è¡Œçš„æƒ…å†µä¸‹å°†Workeræ·»åŠ åˆ°workersä¸­ final ReentrantLock mainLock = this.mainLock; mainLock.lock(); try &#123; // Recheck while holding lock. // Back out on ThreadFactory failure or if // shut down before lock acquired. int rs = runStateOf(ctl.get()); if (rs &lt; SHUTDOWN || (rs == SHUTDOWN &amp;&amp; firstTask == null)) &#123; if (t.isAlive()) // precheck that t is startable throw new IllegalThreadStateException(); workers.add(w); //æŠŠæ–°å»ºçš„wokerçº¿ç¨‹æ”¾å…¥é›†åˆä¿å­˜ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯HashSet int s = workers.size(); if (s &gt; largestPoolSize) largestPoolSize = s; workerAdded = true; &#125; &#125; finally &#123; mainLock.unlock(); &#125; //å¦‚æœæ·»åŠ æˆåŠŸåˆ™è¿è¡Œçº¿ç¨‹ if (workerAdded) &#123; t.start(); workerStarted = true; &#125; &#125; &#125; finally &#123; //å¦‚æœwokerå¯åŠ¨å¤±è´¥ï¼Œåˆ™è¿›è¡Œä¸€äº›å–„åå·¥ä½œï¼Œæ¯”å¦‚è¯´ä¿®æ”¹å½“å‰wokeræ•°é‡ç­‰ç­‰ if (! workerStarted) addWorkerFailed(w); &#125; return workerStarted;&#125; addWorkerè¿™ä¸ªæ–¹æ³•å…ˆå°è¯•åœ¨çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€ä¸ºRUNNINGå¹¶ä¸”çº¿ç¨‹æ•°é‡æœªè¾¾ä¸Šé™çš„æƒ…å†µä¸‹é€šè¿‡CASæ“ä½œå°†çº¿ç¨‹æ± æ•°é‡+1ï¼Œæ¥ç€åœ¨ReentrantLockåŒæ­¥é”çš„åŒæ­¥ä¿è¯ä¸‹åˆ¤æ–­çº¿ç¨‹æ± ä¸ºè¿è¡ŒçŠ¶æ€ï¼Œç„¶åæŠŠWorkeræ·»åŠ åˆ°HashSet workersä¸­ã€‚å¦‚æœæ·»åŠ æˆåŠŸåˆ™æ‰§è¡ŒWorkerçš„å†…éƒ¨çº¿ç¨‹ã€‚ Workeræ˜¯ä»€ä¹ˆWorkeræ˜¯ThreadPoolExecutorçš„å†…éƒ¨ç±»ï¼Œæºç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970private final class Worker extends AbstractQueuedSynchronizer implements Runnable &#123; /** * This class will never be serialized, but we provide a * serialVersionUID to suppress a javac warning. */ private static final long serialVersionUID = 6138294804551838833L; /** Thread this worker is running in. Null if factory fails. */ final Thread thread; /** Initial task to run. Possibly null. */ Runnable firstTask; /** Per-thread task counter */ volatile long completedTasks; /** * Creates with given first task and thread from ThreadFactory. * @param firstTask the first task (null if none) */ Worker(Runnable firstTask) &#123; setState(-1); // inhibit interrupts until runWorker this.firstTask = firstTask; this.thread = getThreadFactory().newThread(this); &#125; /** Delegates main run loop to outer runWorker. */ public void run() &#123; runWorker(this); &#125; // Lock methods // // The value 0 represents the unlocked state. // The value 1 represents the locked state. protected boolean isHeldExclusively() &#123; return getState() != 0; &#125; protected boolean tryAcquire(int unused) &#123; if (compareAndSetState(0, 1)) &#123; setExclusiveOwnerThread(Thread.currentThread()); return true; &#125; return false; &#125; protected boolean tryRelease(int unused) &#123; setExclusiveOwnerThread(null); setState(0); return true; &#125; public void lock() &#123; acquire(1); &#125; public boolean tryLock() &#123; return tryAcquire(1); &#125; public void unlock() &#123; release(1); &#125; public boolean isLocked() &#123; return isHeldExclusively(); &#125; void interruptIfStarted() &#123; Thread t; if (getState() &gt;= 0 &amp;&amp; (t = thread) != null &amp;&amp; !t.isInterrupted()) &#123; try &#123; t.interrupt(); &#125; catch (SecurityException ignore) &#123; &#125; &#125; &#125;&#125; Workeræ„é€ æ–¹æ³•æŒ‡å®šäº†ç¬¬ä¸€ä¸ªè¦æ‰§è¡Œçš„ä»»åŠ¡firstTaskï¼Œå¹¶é€šè¿‡çº¿ç¨‹æ± çš„çº¿ç¨‹å·¥å‚åˆ›å»ºçº¿ç¨‹ã€‚å¯ä»¥å‘ç°è¿™ä¸ªçº¿ç¨‹çš„å‚æ•°ä¸ºthisï¼Œå³Workerå¯¹è±¡ï¼Œå› ä¸ºWorkerå®ç°äº†Runnableå› æ­¤å¯ä»¥è¢«å½“æˆä»»åŠ¡æ‰§è¡Œï¼Œæ‰§è¡Œçš„å³Workerå®ç°çš„runæ–¹æ³•ï¼š 123public void run() &#123; runWorker(this);&#125; runWorker()æ–¹æ³•å› ä¸ºWorkerä¸ºThreadPoolExecutorçš„å†…éƒ¨ç±»ï¼Œå› æ­¤runWorkeræ–¹æ³•å®é™…æ˜¯ThreadPoolExecutorå®šä¹‰çš„: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152//ThreadPoolExecutorç±»ä¸­final void runWorker(Worker w) &#123; Thread wt = Thread.currentThread(); Runnable task = w.firstTask; w.firstTask = null; // å› ä¸ºWorkerçš„æ„é€ å‡½æ•°ä¸­setState(-1)ç¦æ­¢äº†ä¸­æ–­ï¼Œè¿™é‡Œçš„unclockç”¨äºæ¢å¤ä¸­æ–­ w.unlock(); // allow interrupts boolean completedAbruptly = true; try &#123; //ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œtaskéƒ½ä¸ä¼šä¸ºç©ºï¼ˆç‰¹æ®Šæƒ…å†µä¸Šé¢æ³¨é‡Šä¸­ä¹Ÿè¯´æ˜äº†ï¼‰ï¼Œå› æ­¤ä¼šç›´æ¥è¿›å…¥å¾ªç¯ä½“ä¸­ while (task != null || (task = getTask()) != null) &#123; w.lock(); // If pool is stopping, ensure thread is interrupted; // if not, ensure thread is not interrupted. This // requires a recheck in second case to deal with // shutdownNow race while clearing interrupt if ((runStateAtLeast(ctl.get(), STOP) || (Thread.interrupted() &amp;&amp; runStateAtLeast(ctl.get(), STOP))) &amp;&amp; !wt.isInterrupted()) wt.interrupt(); try &#123; //è¯¥æ–¹æ³•æ˜¯ä¸ªç©ºçš„å®ç°ï¼Œå¦‚æœæœ‰éœ€è¦ç”¨æˆ·å¯ä»¥è‡ªå·±ç»§æ‰¿è¯¥ç±»è¿›è¡Œå®ç° beforeExecute(wt, task); Throwable thrown = null; try &#123; //çœŸæ­£çš„ä»»åŠ¡æ‰§è¡Œé€»è¾‘ task.run(); &#125; catch (RuntimeException x) &#123; thrown = x; throw x; &#125; catch (Error x) &#123; thrown = x; throw x; &#125; catch (Throwable x) &#123; thrown = x; throw new Error(x); &#125; finally &#123; //è¯¥æ–¹æ³•æ˜¯ä¸ªç©ºçš„å®ç°ï¼Œå¦‚æœæœ‰éœ€è¦ç”¨æˆ·å¯ä»¥è‡ªå·±ç»§æ‰¿è¯¥ç±»è¿›è¡Œå®ç° afterExecute(task, thrown); &#125; &#125; finally &#123; //è¿™é‡Œè®¾ä¸ºnullï¼Œä¹Ÿå°±æ˜¯å¾ªç¯ä½“å†æ‰§è¡Œçš„æ—¶å€™ä¼šè°ƒç”¨getTaskæ–¹æ³• task = null; w.completedTasks++; w.unlock(); &#125; &#125; completedAbruptly = false; &#125; finally &#123; //å½“æŒ‡å®šä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œé˜»å¡é˜Ÿåˆ—ä¸­ä¹Ÿå–ä¸åˆ°å¯æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œä¼šè¿›å…¥è¿™é‡Œï¼Œåšä¸€äº›å–„åå·¥ä½œ //æ¯”å¦‚åœ¨corePoolSizeè·ŸmaximumPoolSizeä¹‹é—´çš„wokerä¼šè¿›è¡Œå›æ”¶ processWorkerExit(w, completedAbruptly); &#125;&#125; è¿™ä¸ªæ–¹æ³•æ˜¯çº¿ç¨‹æ± å¤ç”¨çº¿ç¨‹çš„æ ¸å¿ƒä»£ç ï¼Œæ³¨æ„Workerç»§æ‰¿äº†AbstractQueuedSynchronizerï¼Œåœ¨æ‰§è¡Œæ¯ä¸ªä»»åŠ¡å‰é€šè¿‡lockæ–¹æ³•åŠ é”ï¼Œæ‰§è¡Œå®Œåé€šè¿‡unlockæ–¹æ³•è§£é”ï¼Œè¿™ç§æœºåˆ¶ç”¨æ¥é˜²æ­¢è¿è¡Œä¸­çš„ä»»åŠ¡è¢«ä¸­æ–­ã€‚åœ¨æ‰§è¡Œä»»åŠ¡æ—¶å…ˆå°è¯•è·å–firstTaskï¼Œå³æ„é€ æ–¹æ³•ä¼ å…¥çš„Runnableå¯¹è±¡ï¼Œç„¶åå°è¯•ä»getTaskæ–¹æ³•ä¸­è·å–ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚åœ¨ä»»åŠ¡æ‰§è¡Œå‰è¿˜è¦å†æ¬¡åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦å·²ç»å¤„äºSTOPçŠ¶æ€æˆ–è€…çº¿ç¨‹è¢«ä¸­æ–­ã€‚ åœ¨runWorkerä¸­ï¼Œæ¯ä¸€ä¸ªWorkeråœ¨getTask()æˆåŠŸä¹‹åéƒ½è¦è·å–Workerçš„é”ä¹‹åè¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´è¿è¡Œä¸­çš„Workerä¸ä¼šä¸­æ–­ã€‚å› ä¸ºæ ¸å¿ƒçº¿ç¨‹ä¸€èˆ¬åœ¨ç©ºé—²çš„æ—¶å€™ä¼šä¸€ç›´é˜»å¡åœ¨è·å–Taskä¸Šï¼Œä¹Ÿåªæœ‰ä¸­æ–­æ‰å¯èƒ½å¯¼è‡´å…¶é€€å‡ºã€‚è¿™äº›é˜»å¡ç€çš„Workerå°±æ˜¯ç©ºé—²çš„çº¿ç¨‹ï¼ˆå½“ç„¶ï¼Œéæ ¸å¿ƒçº¿ç¨‹é˜»å¡ä¹‹åä¹Ÿæ˜¯ç©ºé—²çº¿ç¨‹ï¼‰ã€‚å¦‚æœè®¾ç½®äº†keepAliveTime&gt;0ï¼Œé‚£éæ ¸å¿ƒçº¿ç¨‹ä¼šåœ¨ç©ºé—²çŠ¶æ€ä¸‹ç­‰å¾…keepAliveTimeä¹‹åé”€æ¯ï¼Œç›´åˆ°æœ€ç»ˆçš„çº¿ç¨‹æ•°é‡ç­‰äºcorePoolSize wokerçº¿ç¨‹çš„æ‰§è¡Œæµç¨‹å°±æ˜¯é¦–å…ˆæ‰§è¡Œåˆå§‹åŒ–æ—¶åˆ†é…ç»™çš„ä»»åŠ¡ï¼Œæ‰§è¡Œå®Œæˆä»¥åä¼šå°è¯•ä»é˜»å¡é˜Ÿåˆ—ä¸­è·å–å¯æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¦‚æœæŒ‡å®šæ—¶é—´å†…ä»ç„¶æ²¡æœ‰ä»»åŠ¡å¯ä»¥æ‰§è¡Œï¼Œåˆ™è¿›å…¥é”€æ¯é€»è¾‘è°ƒç”¨processWorkerExit()æ–¹æ³•ã€‚æ³¨ï¼šè¿™é‡Œåªä¼šå›æ”¶corePoolSizeä¸maximumPoolSizeç›´æ¥çš„é‚£éƒ¨åˆ†woker getTask()æ–¹æ³•è¿™é‡ŒgetTask()æ–¹æ³•æ˜¯è¦é‡ç‚¹è¯´æ˜çš„ï¼Œå®ƒçš„å®ç°è·Ÿæˆ‘ä»¬æ„é€ å‚æ•°keepAliveTimeå­˜æ´»æ—¶é—´æœ‰å…³ã€‚æˆ‘ä»¬éƒ½çŸ¥é“keepAliveTimeä»£è¡¨äº†çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼ˆå³wokerçº¿ç¨‹ï¼‰çš„å­˜æ´»æ—¶é—´ï¼Œå¦‚æœåˆ°æœŸåˆ™å›æ”¶wokerçº¿ç¨‹ï¼Œè¿™ä¸ªé€»è¾‘çš„å®ç°å°±åœ¨getTaskä¸­ã€‚ getTask()æ–¹æ³•å°±æ˜¯å»é˜»å¡é˜Ÿåˆ—ä¸­å–ä»»åŠ¡ï¼Œç”¨æˆ·è®¾ç½®çš„å­˜æ´»æ—¶é—´ï¼Œå°±æ˜¯ä»è¿™ä¸ªé˜»å¡é˜Ÿåˆ—ä¸­å–ä»»åŠ¡ç­‰å¾…çš„æœ€å¤§æ—¶é—´ï¼Œå¦‚æœgetTaskè¿”å›nullï¼Œæ„æ€å°±æ˜¯wokerç­‰å¾…äº†æŒ‡å®šæ—¶é—´ä»ç„¶æ²¡æœ‰å–åˆ°ä»»åŠ¡ï¼Œæ­¤æ—¶å°±ä¼šè·³è¿‡å¾ªç¯ä½“ï¼Œè¿›å…¥wokerçº¿ç¨‹çš„é”€æ¯é€»è¾‘ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738private Runnable getTask() &#123; boolean timedOut = false; // Did the last poll() time out? for (;;) &#123; int c = ctl.get(); int rs = runStateOf(c); // Check if queue empty only if necessary. if (rs &gt;= SHUTDOWN &amp;&amp; (rs &gt;= STOP || workQueue.isEmpty())) &#123; decrementWorkerCount(); return null; &#125; int wc = workerCountOf(c); // Are workers subject to culling? boolean timed = allowCoreThreadTimeOut || wc &gt; corePoolSize; if ((wc &gt; maximumPoolSize || (timed &amp;&amp; timedOut)) &amp;&amp; (wc &gt; 1 || workQueue.isEmpty())) &#123; if (compareAndDecrementWorkerCount(c)) return null; continue; &#125; try &#123; //æ ¹æ®è¶…æ—¶é…ç½®æœ‰ä¸¤ç§æ–¹æ³•å–å‡ºä»»åŠ¡ Runnable r = timed ? workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) : workQueue.take(); if (r != null) return r; timedOut = true; &#125; catch (InterruptedException retry) &#123; timedOut = false; &#125; &#125;&#125; è¿™ä¸ªgetTask()æ–¹æ³•é€šè¿‡ä¸€ä¸ªå¾ªç¯ä¸æ–­è½®è¯¢ä»»åŠ¡é˜Ÿåˆ—æœ‰æ²¡æœ‰ä»»åŠ¡åˆ°æ¥ï¼Œé¦–å…ˆåˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦å¤„äºæ­£å¸¸è¿è¡ŒçŠ¶æ€ï¼Œæ ¹æ®è¶…æ—¶é…ç½®æœ‰ä¸¤ç§æ–¹æ³•å–å‡ºä»»åŠ¡ï¼š BlockingQueue.poll é˜»å¡æŒ‡å®šçš„æ—¶é—´å°è¯•è·å–ä»»åŠ¡ï¼Œå¦‚æœè¶…è¿‡æŒ‡å®šçš„æ—¶é—´è¿˜æœªè·å–åˆ°ä»»åŠ¡å°±è¿”å›nullã€‚ BlockingQueue.take è¿™ç§æ–¹æ³•ä¼šåœ¨å–åˆ°ä»»åŠ¡å‰ä¸€ç›´é˜»å¡ã€‚ FixedThreadPoolä½¿ç”¨çš„æ˜¯takeæ–¹æ³•ï¼Œæ‰€ä»¥ä¼šçº¿ç¨‹ä¼šä¸€ç›´é˜»å¡ç­‰å¾…ä»»åŠ¡ã€‚CachedThreadPoolä½¿ç”¨çš„æ˜¯pollæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´CachedThreadPoolä¸­çš„çº¿ç¨‹å¦‚æœåœ¨60ç§’å†…æœªè·å–åˆ°é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡å°±ä¼šè¢«ç»ˆæ­¢ã€‚ åˆ°æ­¤ThreadPoolExecutoræ˜¯æ€ä¹ˆæ‰§è¡ŒRunnableä»»åŠ¡çš„åˆ†æç»“æŸã€‚ å¸¸ç”¨çš„å‡ ä¸ªçº¿ç¨‹æ± å·¥å‚æ–¹æ³•Executorsæ˜¯java.util.concurrentåŒ…ä¸‹çš„ä¸€ä¸ªçº¿ç¨‹æ± å·¥å‚ï¼Œè´Ÿè´£åˆ›å»ºå¸¸ç”¨çš„çº¿ç¨‹æ± ï¼Œä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§: newFixedThreadPool ä¸€ä¸ªå›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± : 12345678public static ExecutorService newFixedThreadPool(int nThreads, ThreadFactory threadFactory) &#123; //corePoolSizeè·ŸmaximumPoolSizeå€¼ä¸€æ ·ï¼ŒåŒæ—¶ä¼ å…¥ä¸€ä¸ªæ— ç•Œé˜»å¡é˜Ÿåˆ— //æ ¹æ®ä¸Šé¢åˆ†æçš„wokerå›æ”¶é€»è¾‘ï¼Œè¯¥çº¿ç¨‹æ± çš„çº¿ç¨‹ä¼šç»´æŒåœ¨æŒ‡å®šçº¿ç¨‹æ•°ï¼Œä¸ä¼šè¿›è¡Œå›æ”¶ return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;(), threadFactory);&#125; å®šé•¿çº¿ç¨‹æ± ï¼š å¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼ˆåŒæ—¶æ‰§è¡Œçš„çº¿ç¨‹æ•°ï¼‰ è¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾… newCachedThreadPoolä¸å›ºå®šçº¿ç¨‹æ•°é‡ï¼Œä¸”æ”¯æŒæœ€å¤§ä¸ºInteger.MAX_VALUEçš„çº¿ç¨‹æ•°é‡: 1234567public static ExecutorService newCachedThreadPool() &#123; //è¿™ä¸ªçº¿ç¨‹æ± corePoolSizeä¸º0ï¼ŒmaximumPoolSizeä¸ºInteger.MAX_VALUE //æ„æ€ä¹Ÿå°±æ˜¯è¯´æ¥ä¸€ä¸ªä»»åŠ¡å°±åˆ›å»ºä¸€ä¸ªwokerï¼Œå›æ”¶æ—¶é—´æ˜¯60s return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;());&#125; å¯ç¼“å­˜çº¿ç¨‹æ± ï¼š çº¿ç¨‹æ•°æ— é™åˆ¶ æœ‰ç©ºé—²çº¿ç¨‹åˆ™å¤ç”¨ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— ç©ºé—²çº¿ç¨‹åˆ™æ–°å»ºçº¿ç¨‹ ä¸€å®šç¨‹åºå‡å°‘é¢‘ç¹åˆ›å»º/é”€æ¯çº¿ç¨‹ï¼Œå‡å°‘ç³»ç»Ÿå¼€é”€ newSingleThreadExecutorå¯ä»¥ç†è§£ä¸ºçº¿ç¨‹æ•°é‡ä¸º1çš„FixedThreadPool: 12345678public static ExecutorService newSingleThreadExecutor() &#123; //çº¿ç¨‹æ± ä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œä»»åŠ¡æ‰§è¡Œï¼Œå…¶ä»–çš„éƒ½æ”¾å…¥é˜»å¡é˜Ÿåˆ— //å¤–é¢åŒ…è£…çš„FinalizableDelegatedExecutorServiceç±»å®ç°äº†finalizeæ–¹æ³•ï¼Œåœ¨JVMåƒåœ¾å›æ”¶çš„æ—¶å€™ä¼šå…³é—­çº¿ç¨‹æ±  return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()));&#125; å•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼š æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåºæ‰§è¡Œï¼Œå³éµå¾ªé˜Ÿåˆ—çš„å…¥é˜Ÿå‡ºé˜Ÿè§„åˆ™ newScheduledThreadPoolæ”¯æŒå®šæ—¶ä»¥æŒ‡å®šå‘¨æœŸå¾ªç¯æ‰§è¡Œä»»åŠ¡: 123public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) &#123; return new ScheduledThreadPoolExecutor(corePoolSize);&#125; å…¶ä¸­å‰ä¸‰ç§çº¿ç¨‹æ± æ˜¯ThreadPoolExecutorä¸åŒé…ç½®çš„å®ä¾‹ï¼Œæœ€åä¸€ç§æ˜¯ScheduledThreadPoolExecutorçš„å®ä¾‹ã€‚ æœ€åå†è¯´è¯´åˆå§‹åŒ–çº¿ç¨‹æ± æ—¶çº¿ç¨‹æ•°çš„é€‰æ‹©ï¼š å¦‚æœä»»åŠ¡æ˜¯IOå¯†é›†å‹ï¼Œä¸€èˆ¬çº¿ç¨‹æ•°éœ€è¦è®¾ç½®2å€CPUæ•°ä»¥ä¸Šï¼Œä»¥æ­¤æ¥å°½é‡åˆ©ç”¨CPUèµ„æºã€‚ å¦‚æœä»»åŠ¡æ˜¯CPUå¯†é›†å‹ï¼Œä¸€èˆ¬çº¿ç¨‹æ•°é‡åªéœ€è¦è®¾ç½®CPUæ•°åŠ 1å³å¯ï¼Œæ›´å¤šçš„çº¿ç¨‹æ•°ä¹Ÿåªèƒ½å¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¸èƒ½å¢åŠ CPUåˆ©ç”¨ç‡ã€‚ ä¸Šè¿°åªæ˜¯ä¸€ä¸ªåŸºæœ¬æ€æƒ³ï¼Œå¦‚æœçœŸçš„éœ€è¦ç²¾ç¡®çš„æ§åˆ¶ï¼Œè¿˜æ˜¯éœ€è¦ä¸Šçº¿ä»¥åè§‚å¯Ÿçº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡è·Ÿé˜Ÿåˆ—çš„æƒ…å†µæ¥å®šã€‚ çº¿ç¨‹æ± æŠ€æœ¯é€‚ç”¨èŒƒå›´çº¿ç¨‹æ± çš„åº”ç”¨èŒƒå›´ï¼š éœ€è¦å¤§é‡çš„çº¿ç¨‹æ¥å®Œæˆä»»åŠ¡ï¼Œä¸”å®Œæˆä»»åŠ¡çš„æ—¶é—´æ¯”è¾ƒçŸ­ã€‚ WEBæœåŠ¡å™¨å®Œæˆç½‘é¡µè¯·æ±‚è¿™æ ·çš„ä»»åŠ¡ï¼Œä½¿ç”¨çº¿ç¨‹æ± æŠ€æœ¯æ˜¯éå¸¸åˆé€‚çš„ã€‚å› ä¸ºå•ä¸ªä»»åŠ¡å°ï¼Œè€Œä»»åŠ¡æ•°é‡å·¨å¤§ï¼Œä½ å¯ä»¥æƒ³è±¡ä¸€ä¸ªçƒ­é—¨ç½‘ç«™çš„ç‚¹å‡»æ¬¡æ•°ã€‚ ä½†å¯¹äºé•¿æ—¶é—´çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸€ä¸ªTelnetè¿æ¥è¯·æ±‚ï¼Œçº¿ç¨‹æ± çš„ä¼˜ç‚¹å°±ä¸æ˜æ˜¾äº†ã€‚å› ä¸ºTelnetä¼šè¯æ—¶é—´æ¯”çº¿ç¨‹çš„åˆ›å»ºæ—¶é—´å¤§å¤šäº†ã€‚ å¯¹æ€§èƒ½è¦æ±‚è‹›åˆ»çš„åº”ç”¨ï¼Œæ¯”å¦‚è¦æ±‚æœåŠ¡å™¨è¿…é€Ÿç›¸åº”å®¢æˆ·è¯·æ±‚ã€‚ æ¥å—çªå‘æ€§çš„å¤§é‡è¯·æ±‚ï¼Œä½†ä¸è‡³äºä½¿æœåŠ¡å™¨å› æ­¤äº§ç”Ÿå¤§é‡çº¿ç¨‹çš„åº”ç”¨ã€‚çªå‘æ€§å¤§é‡å®¢æˆ·è¯·æ±‚ï¼Œåœ¨æ²¡æœ‰çº¿ç¨‹æ± æƒ…å†µä¸‹ï¼Œå°†äº§ç”Ÿå¤§é‡çº¿ç¨‹ï¼Œè™½ç„¶ç†è®ºä¸Šå¤§éƒ¨åˆ†æ“ä½œç³»ç»Ÿçº¿ç¨‹æ•°ç›®æœ€å¤§å€¼ä¸æ˜¯é—®é¢˜ï¼ŒçŸ­æ—¶é—´å†…äº§ç”Ÿå¤§é‡çº¿ç¨‹å¯èƒ½ä½¿å†…å­˜åˆ°è¾¾æé™ï¼Œå¹¶å‡ºç°â€OutOfMemoryâ€çš„é”™è¯¯ã€‚ æ€»ç»“åˆ°æ­¤æ— è®ºæ˜¯ä¸»åŠ¨æäº¤ä»»åŠ¡ç»™æ–°å»ºçº¿ç¨‹æ‰§è¡Œï¼Œè¿˜æ˜¯å·²æœ‰çš„çº¿ç¨‹è‡ªå·±åˆ°é˜»å¡é˜Ÿåˆ—å–ä»»åŠ¡æ‰§è¡Œï¼Œéƒ½åº”è¯¥æ¸…æ¥šäº†ç„¶äº†ã€‚ä»æ•°æ®ç»“æ„çš„è§’åº¦æ¥çœ‹ï¼Œçº¿ç¨‹æ± ä¸»è¦ä½¿ç”¨äº†é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰å’ŒHashSeté›†åˆæ„æˆã€‚ä»ä»»åŠ¡æäº¤çš„æµç¨‹è§’åº¦æ¥çœ‹ï¼Œå¯¹äºä½¿ç”¨çº¿ç¨‹æ± çš„å¤–éƒ¨æ¥è¯´ï¼Œçº¿ç¨‹æ± çš„æœºåˆ¶æ˜¯è¿™æ ·çš„ï¼š å¦‚æœæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•° &lt; coreSizeï¼Œé©¬ä¸Šåˆ›å»ºçº¿ç¨‹æ‰§è¡Œè¯¥taskï¼Œä¸æ’é˜Ÿç­‰å¾…ï¼› å¦‚æœæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•° &gt;= coreSizeï¼ŒæŠŠè¯¥taskæ”¾å…¥é˜»å¡é˜Ÿåˆ—ï¼› å¦‚æœé˜Ÿåˆ—å·²æ»¡ &amp;&amp; æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•° &lt; maximumPoolSizeï¼Œåˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œè¯¥taskï¼› å¦‚æœé˜Ÿåˆ—å·²æ»¡ &amp;&amp; æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•° &gt;= maximumPoolSizeï¼Œçº¿ç¨‹æ± è°ƒç”¨handlerçš„rejectæ–¹æ³•æ‹’ç»æœ¬æ¬¡æäº¤ã€‚ ä»workerçº¿ç¨‹è‡ªå·±çš„è§’åº¦æ¥çœ‹ï¼Œå½“workerçš„taskæ‰§è¡Œç»“æŸä¹‹åï¼Œå¾ªç¯ä»é˜»å¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ‰§è¡Œã€‚ å‚è€ƒèµ„æ–™ çº¿ç¨‹æ± ï¼Œè¿™ä¸€ç¯‡æˆ–è®¸å°±å¤Ÿäº† çº¿ç¨‹æ± çš„ä»‹ç»åŠç®€å•å®ç° æ·±å…¥åˆ†æjavaçº¿ç¨‹æ± çš„å®ç°åŸç† Javaçº¿ç¨‹æ± (ThreadPoolExecutor)åŸç†åˆ†æä¸ä½¿ç”¨ Javaçº¿ç¨‹æ± åŸç†åˆ†æThreadPoolExecutorç¯‡ å¹¶å‘æ–°ç‰¹æ€§â€”Executor æ¡†æ¶ä¸çº¿ç¨‹æ±  æ·±å…¥ç†è§£Javaä¹‹çº¿ç¨‹æ±  javaçº¿ç¨‹æ± å¤§å°ä¸ºä½•ä¼šå¤§å¤šè¢«è®¾ç½®æˆCPUæ ¸å¿ƒæ•°+1ï¼Ÿ","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"},{"name":"æºç åˆ†æ","slug":"Android/æºç åˆ†æ","permalink":"http://github.com/categories/Android/æºç åˆ†æ/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"http://github.com/tags/æºç åˆ†æ/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"},{"name":"æºç åˆ†æ","slug":"Android/æºç åˆ†æ","permalink":"http://github.com/categories/Android/æºç åˆ†æ/"}]},{"title":"ã€Androidã€‘OkHttpæºç åˆ†æ","slug":"ã€Androidã€‘OkHttpæºç åˆ†æ","date":"2018-01-25T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2018/01/25/ã€Androidã€‘OkHttpæºç åˆ†æ/","link":"","permalink":"http://github.com/2018/01/25/ã€Androidã€‘OkHttpæºç åˆ†æ/","excerpt":"Androidä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§HTTPäº¤äº’çš„æ–¹å¼ï¼šHttpURLConnection å’Œ Apache HttpClientï¼Œè™½ç„¶ä¸¤è€…éƒ½æ”¯æŒHTTPSï¼Œæµçš„ä¸Šä¼ å’Œä¸‹è½½ï¼Œé…ç½®è¶…æ—¶ï¼ŒIPv6å’Œè¿æ¥æ± ï¼Œå·²è¶³å¤Ÿæ»¡è¶³æˆ‘ä»¬å„ç§HTTPè¯·æ±‚çš„éœ€æ±‚ã€‚ä½†æ›´é«˜æ•ˆçš„ä½¿ç”¨HTTP å¯ä»¥è®©æ‚¨çš„åº”ç”¨è¿è¡Œæ›´å¿«ã€æ›´èŠ‚çœæµé‡ã€‚è€ŒOkHttpåº“å°±æ˜¯ä¸ºæ­¤è€Œç”Ÿã€‚åœ¨å¼€å§‹åˆ†æOkHttpä¹‹å‰æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ HttpURLConnection å’Œ HttpClient ä¸¤è€…ä¹‹é—´å…³ç³»ï¼Œä»¥åŠå®ƒä»¬å’Œ OkHttp ä¹‹é—´çš„å…³ç³»ã€‚ HttpClient vs HttpURLConnectionåœ¨Android API Level 9ï¼ˆAndroid 2.2ï¼‰ä¹‹å‰åªèƒ½ä½¿ç”¨HttpClientç±»å‘é€httpè¯·æ±‚ã€‚HttpClientæ˜¯Apacheç”¨äºå‘é€httpè¯·æ±‚çš„å®¢æˆ·ç«¯ï¼Œå…¶æä¾›äº†å¼ºå¤§çš„APIæ”¯æŒï¼Œè€Œä¸”åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆbugï¼Œä½†æ˜¯ç”±äºå…¶å¤ªè¿‡å¤æ‚ï¼ŒAndroidå›¢é˜Ÿåœ¨ä¿æŒå‘åå…¼å®¹çš„æƒ…å†µä¸‹ï¼Œå¾ˆéš¾å¯¹DefaultHttpClientè¿›è¡Œå¢å¼ºã€‚ä¸ºæ­¤ï¼ŒAndroidå›¢é˜Ÿä»Android API Level 9å¼€å§‹è‡ªå·±å®ç°äº†ä¸€ä¸ªå‘é€httpè¯·æ±‚çš„å®¢æˆ·ç«¯ç±» â€”â€” HttpURLConnectionã€‚ ç›¸æ¯”äºDefaultHttpClientï¼ŒHttpURLConnectionæ¯”è¾ƒè½»é‡çº§ï¼Œè™½ç„¶åŠŸèƒ½æ²¡æœ‰DefaultHttpClienté‚£ä¹ˆå¼ºå¤§ï¼Œä½†æ˜¯èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†çš„éœ€æ±‚ï¼Œæ‰€ä»¥Androidæ¨èä½¿ç”¨HttpURLConnectionä»£æ›¿DefaultHttpClientï¼Œå¹¶ä¸å¼ºåˆ¶ä½¿ç”¨HttpURLConnectionã€‚ ä½†ä»Android API Level 23ï¼ˆAndroid 6.0ï¼‰å¼€å§‹ï¼Œä¸èƒ½å†åœ¨Androidä¸­ä½¿ç”¨HttpClientï¼Œå¼ºåˆ¶ä½¿ç”¨HttpURLConnectionã€‚å‚è€ƒå®˜ç½‘ï¼šAndroid 6.0 Changes - Google Developer Android 6.0 ç‰ˆç§»é™¤äº†å¯¹ Apache HTTP clientçš„æ”¯æŒã€‚å¦‚æœæ‚¨çš„åº”ç”¨ä½¿ç”¨è¯¥å®¢æˆ·ç«¯ï¼Œå¹¶ä»¥ Android 2.3ï¼ˆAPI level 9ï¼‰æˆ–æ›´é«˜ç‰ˆæœ¬ä¸ºç›®æ ‡å¹³å°ï¼Œè¯·æ”¹ç”¨ HttpURLConnection ç±»ã€‚æ­¤ API æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå®ƒå¯ä»¥é€šè¿‡é€æ˜å‹ç¼©å’Œå“åº”ç¼“å­˜å‡å°‘ç½‘ç»œä½¿ç”¨ï¼Œå¹¶å¯æœ€å¤§é™åº¦é™ä½è€—ç”µé‡ã€‚è¦ç»§ç»­ä½¿ç”¨ Apache HTTP APIï¼Œæ‚¨å¿…é¡»å…ˆåœ¨ build.gradle æ–‡ä»¶ä¸­å£°æ˜ä»¥ä¸‹ç¼–è¯‘æ—¶ä¾èµ–é¡¹ï¼š 123android &#123; useLibrary 'org.apache.http.legacy'&#125;","text":"Androidä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§HTTPäº¤äº’çš„æ–¹å¼ï¼šHttpURLConnection å’Œ Apache HttpClientï¼Œè™½ç„¶ä¸¤è€…éƒ½æ”¯æŒHTTPSï¼Œæµçš„ä¸Šä¼ å’Œä¸‹è½½ï¼Œé…ç½®è¶…æ—¶ï¼ŒIPv6å’Œè¿æ¥æ± ï¼Œå·²è¶³å¤Ÿæ»¡è¶³æˆ‘ä»¬å„ç§HTTPè¯·æ±‚çš„éœ€æ±‚ã€‚ä½†æ›´é«˜æ•ˆçš„ä½¿ç”¨HTTP å¯ä»¥è®©æ‚¨çš„åº”ç”¨è¿è¡Œæ›´å¿«ã€æ›´èŠ‚çœæµé‡ã€‚è€ŒOkHttpåº“å°±æ˜¯ä¸ºæ­¤è€Œç”Ÿã€‚åœ¨å¼€å§‹åˆ†æOkHttpä¹‹å‰æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ HttpURLConnection å’Œ HttpClient ä¸¤è€…ä¹‹é—´å…³ç³»ï¼Œä»¥åŠå®ƒä»¬å’Œ OkHttp ä¹‹é—´çš„å…³ç³»ã€‚ HttpClient vs HttpURLConnectionåœ¨Android API Level 9ï¼ˆAndroid 2.2ï¼‰ä¹‹å‰åªèƒ½ä½¿ç”¨HttpClientç±»å‘é€httpè¯·æ±‚ã€‚HttpClientæ˜¯Apacheç”¨äºå‘é€httpè¯·æ±‚çš„å®¢æˆ·ç«¯ï¼Œå…¶æä¾›äº†å¼ºå¤§çš„APIæ”¯æŒï¼Œè€Œä¸”åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆbugï¼Œä½†æ˜¯ç”±äºå…¶å¤ªè¿‡å¤æ‚ï¼ŒAndroidå›¢é˜Ÿåœ¨ä¿æŒå‘åå…¼å®¹çš„æƒ…å†µä¸‹ï¼Œå¾ˆéš¾å¯¹DefaultHttpClientè¿›è¡Œå¢å¼ºã€‚ä¸ºæ­¤ï¼ŒAndroidå›¢é˜Ÿä»Android API Level 9å¼€å§‹è‡ªå·±å®ç°äº†ä¸€ä¸ªå‘é€httpè¯·æ±‚çš„å®¢æˆ·ç«¯ç±» â€”â€” HttpURLConnectionã€‚ ç›¸æ¯”äºDefaultHttpClientï¼ŒHttpURLConnectionæ¯”è¾ƒè½»é‡çº§ï¼Œè™½ç„¶åŠŸèƒ½æ²¡æœ‰DefaultHttpClienté‚£ä¹ˆå¼ºå¤§ï¼Œä½†æ˜¯èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†çš„éœ€æ±‚ï¼Œæ‰€ä»¥Androidæ¨èä½¿ç”¨HttpURLConnectionä»£æ›¿DefaultHttpClientï¼Œå¹¶ä¸å¼ºåˆ¶ä½¿ç”¨HttpURLConnectionã€‚ ä½†ä»Android API Level 23ï¼ˆAndroid 6.0ï¼‰å¼€å§‹ï¼Œä¸èƒ½å†åœ¨Androidä¸­ä½¿ç”¨HttpClientï¼Œå¼ºåˆ¶ä½¿ç”¨HttpURLConnectionã€‚å‚è€ƒå®˜ç½‘ï¼šAndroid 6.0 Changes - Google Developer Android 6.0 ç‰ˆç§»é™¤äº†å¯¹ Apache HTTP clientçš„æ”¯æŒã€‚å¦‚æœæ‚¨çš„åº”ç”¨ä½¿ç”¨è¯¥å®¢æˆ·ç«¯ï¼Œå¹¶ä»¥ Android 2.3ï¼ˆAPI level 9ï¼‰æˆ–æ›´é«˜ç‰ˆæœ¬ä¸ºç›®æ ‡å¹³å°ï¼Œè¯·æ”¹ç”¨ HttpURLConnection ç±»ã€‚æ­¤ API æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå®ƒå¯ä»¥é€šè¿‡é€æ˜å‹ç¼©å’Œå“åº”ç¼“å­˜å‡å°‘ç½‘ç»œä½¿ç”¨ï¼Œå¹¶å¯æœ€å¤§é™åº¦é™ä½è€—ç”µé‡ã€‚è¦ç»§ç»­ä½¿ç”¨ Apache HTTP APIï¼Œæ‚¨å¿…é¡»å…ˆåœ¨ build.gradle æ–‡ä»¶ä¸­å£°æ˜ä»¥ä¸‹ç¼–è¯‘æ—¶ä¾èµ–é¡¹ï¼š 123android &#123; useLibrary 'org.apache.http.legacy'&#125; äºŒè€…å¯¹æ¯” HttpURLConnection åœ¨Android2.2ä¹‹å‰ï¼šHttpURLConnection æœ‰ä¸ªé‡å¤§ Bugï¼šè°ƒç”¨ close() å‡½æ•°ä¼šå½±å“è¿æ¥æ± ,å¯¼è‡´è¿æ¥å¤ç”¨å¤±æ•ˆï¼›æ‰€ä»¥Android2.2ä¹‹å‰ä¸å»ºè®®ä½¿ç”¨HttpURLConnectionã€‚åœ¨Android2.2ä¹‹åï¼šHttpURLConnectioné»˜è®¤å¼€å¯äº† gzip å‹ç¼©&amp;æé«˜äº†HTTPS çš„æ€§èƒ½ HttpClient ä¼˜ç‚¹ï¼šç›¸æ¯”äºHttpURLConnectionï¼Œæ›´åŠ é«˜æ•ˆç®€æ´ç¼ºç‚¹ï¼šç»“æ„è¿‡äºå¤æ‚ï¼›ç»´æŠ¤æˆæœ¬é«˜ åœ¨5.0ç‰ˆæœ¬åè¢«Androidå®˜æ–¹å¼ƒç”¨ å°½ç®¡Googleåœ¨å¤§éƒ¨åˆ†å®‰å“ç‰ˆæœ¬ä¸­æ¨èä½¿ç”¨HttpURLConnectionï¼Œä½†æ˜¯è¿™ä¸ªç±»ç›¸æ¯”HttpClientå®åœ¨æ˜¯å¤ªéš¾ç”¨ï¼Œå¤ªå¼±çˆ†äº†ã€‚OkHttpæ˜¯ä¸€ä¸ªç›¸å¯¹æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬è·Ÿè¸ªè¿™ç¯‡æ–‡ç« ï¼šAndroid HttpURLConnectionæºç åˆ†æã€‚å°±ä¼šå‘ç°Android4.4ä¹‹åçš„HttpURLConnectionå…¶å®æ˜¯åŸºäºOkHttpå®ç°çš„ã€‚æ‰€ä»¥æˆ‘ä»¬æ›´æœ‰ç†ç”±ç›¸ä¿¡OkHttpçš„å¼ºå¤§ã€‚ äºŒè€…ä¸ç½‘ç»œè¯·æ±‚åº“ä¹‹é—´çš„å…³ç³»ç½‘ç»œè¯·æ±‚æ¡†æ¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå°†ç½‘ç»œè¯·æ±‚çš„ç›¸å…³æ–¹æ³•ï¼ˆ HttpClientæˆ–HttpURLConnectionï¼‰å°è£…å¥½çš„ç±»åº“ï¼Œå¹¶å®ç°å¦å¼€çº¿ç¨‹è¿›è¡Œè¯·æ±‚å’Œå¤„ç†æ•°æ®ï¼Œä»è€Œå®ç°æ•´ä¸ªç½‘ç»œè¯·æ±‚æ¨¡å—çš„åŠŸèƒ½ã€‚å…·ä½“çš„å…³ç³»å¯çœ‹ä¸‹å›¾: è€ŒOkHttpæ˜¯åŸºäºhttpåè®®å°è£…çš„ä¸€å¥—è¯·æ±‚å®¢æˆ·ç«¯ï¼Œè™½ç„¶å®ƒä¹Ÿå¯ä»¥å¼€çº¿ç¨‹ï¼Œä½†æ ¹æœ¬ä¸Šå®ƒæ›´åå‘çœŸæ­£çš„è¯·æ±‚ï¼Œè·ŸHttpClientï¼ŒHttpUrlConnectionçš„èŒè´£æ˜¯ä¸€æ ·çš„ã€‚ OkHttpç®€ä»‹OkHttp åº“çš„è®¾è®¡å’Œå®ç°çš„é¦–è¦ç›®æ ‡æ˜¯é«˜æ•ˆã€‚è¿™ä¹Ÿæ˜¯é€‰æ‹© OkHttp çš„é‡è¦ç†ç”±ä¹‹ä¸€ã€‚OkHttp æä¾›äº†å¯¹æœ€æ–°çš„ HTTP åè®®ç‰ˆæœ¬ HTTP/2 å’Œ SPDY çš„æ”¯æŒï¼Œè¿™ä½¿å¾—å¯¹åŒä¸€ä¸ªä¸»æœºå‘å‡ºçš„æ‰€æœ‰è¯·æ±‚éƒ½å¯ä»¥å…±äº«ç›¸åŒçš„Socketè¿æ¥ã€‚å¦‚æœ HTTP/2 å’Œ SPDY ä¸å¯ç”¨ï¼ŒOkHttp ä¼šä½¿ç”¨è¿æ¥æ± æ¥å¤ç”¨è¿æ¥ä»¥æé«˜æ•ˆç‡ã€‚OkHttp æä¾›äº†å¯¹ GZIP çš„é»˜è®¤æ”¯æŒæ¥é™ä½ä¼ è¾“å†…å®¹çš„å¤§å°ã€‚OkHttp ä¹Ÿæä¾›äº†å¯¹ HTTP å“åº”çš„ç¼“å­˜æœºåˆ¶ï¼Œå¯ä»¥é¿å…ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚ã€‚å½“ç½‘ç»œå‡ºç°é—®é¢˜æ—¶ï¼ŒOkHttp ä¼šè‡ªåŠ¨é‡è¯•ä¸€ä¸ªä¸»æœºçš„å¤šä¸ª IP åœ°å€ã€‚ OkHttpæ˜¯ä¸€ä¸ªé«˜æ•ˆçš„HTTPåº“ï¼š æ”¯æŒ HTTP/2å’ŒSPDY ï¼Œå…±äº«åŒä¸€ä¸ªSocketæ¥å¤„ç†åŒä¸€ä¸ªæœåŠ¡å™¨çš„æ‰€æœ‰è¯·æ±‚ å¦‚æœ HTTP/2å’ŒSPDY ä¸å¯ç”¨ï¼Œåˆ™é€šè¿‡è¿æ¥æ± æ¥å‡å°‘è¯·æ±‚å»¶æ—¶ æ— ç¼çš„æ”¯æŒGZIPæ¥å‡å°‘æ•°æ®æµé‡ ç¼“å­˜å“åº”æ•°æ®æ¥å‡å°‘é‡å¤çš„ç½‘ç»œè¯·æ±‚ å¦‚ä½•ä½¿ç”¨OkHttpçš„ä½¿ç”¨æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæ•´ä½“æ­¥éª¤æ˜¯ï¼š åˆå§‹åŒ– OkHttpClient åˆå§‹åŒ–ä¸€ä¸ª Request ç”± OkHttpClient å’Œ Request ç”Ÿæˆä¸€ä¸ª Call Call è°ƒç”¨ enqueue ï¼ˆå¼‚æ­¥ï¼‰æˆ–è€… execute æ–¹æ³•ï¼ˆåŒæ­¥ï¼‰ åŒæ­¥Getè¯·æ±‚è¿™æ˜¯OkHttp æœ€åŸºæœ¬çš„ HTTP è¯·æ±‚ï¼Œæ³¨æ„åˆ«æ”¾åˆ°UIçº¿ç¨‹æ‰§è¡Œã€‚ 123456789101112131415161718192021222324252627public class SyncGet &#123; public static void main(String[] args) throws IOException &#123; //1. åˆå§‹åŒ–OkHttpClient OkHttpClient client = new OkHttpClient(); //2. åˆå§‹åŒ–ä¸€ä¸ªRequest Request request = new Request.Builder() .url(\"http://www.baidu.com\") .header(\"User-Agent\", \"My super agent\") .addHeader(\"Accept\", \"text/html\") .build(); //3. ç”±OkHttpClientå’ŒRequestç”Ÿæˆä¸€ä¸ªCall //4. callè°ƒç”¨enqueueæˆ–è€…execute Response response = client.newCall(request).execute(); if (!response.isSuccessful()) &#123; throw new IOException(\"æœåŠ¡å™¨ç«¯é”™è¯¯: \" + response); &#125; Headers responseHeaders = response.headers(); for (int i = 0; i &lt; responseHeaders.size(); i++) &#123; System.out.println(responseHeaders.name(i) + \": \" + responseHeaders.value(i)); &#125; System.out.println(response.body().string()); &#125;&#125; å¼‚æ­¥Getè¯·æ±‚123456789101112131415161718192021222324public class AsyncGet &#123; public static void main(String[] args) throws IOException &#123; OkHttpClient client = new OkHttpClient(); Request request = new Request.Builder() .url(\"http://www.baidu.com\") .build(); //Call è°ƒç”¨ enqueue æ–¹æ³• client.newCall(request).enqueue(new Callback() &#123; public void onFailure(Request request, IOException e) &#123; e.printStackTrace(); &#125; public void onResponse(Response response) throws IOException &#123; if (!response.isSuccessful()) &#123; throw new IOException(\"æœåŠ¡å™¨ç«¯é”™è¯¯: \" + response); &#125; System.out.println(response.body().string()); &#125; &#125;); &#125;&#125; Postè¯·æ±‚HTTP POST å’Œ PUT è¯·æ±‚å¯ä»¥åŒ…å«è¦æäº¤çš„å†…å®¹ã€‚åªéœ€è¦åœ¨åˆ›å»º Request å¯¹è±¡æ—¶ï¼Œé€šè¿‡ post() å’Œ put() æ–¹æ³•æ¥æŒ‡å®šè¦æäº¤çš„å†…å®¹å³å¯ã€‚ä¸‹é¢çš„ä»£ç é€šè¿‡ RequestBody çš„ create() æ–¹æ³•æ¥åˆ›å»ºåª’ä½“ç±»å‹ä¸ºapplication/ json çš„å†…å®¹å¹¶æäº¤ã€‚ 12345678910111213public static final MediaType JSON = MediaType.parse(\"application/json; charset=utf-8\");OkHttpClient client = new OkHttpClient();//postè¯·æ±‚public String post(String url, String json) throws IOException &#123; RequestBody body = RequestBody.create(JSON, json); Request request = new Request.Builder() .url(url) .post(body) .build(); Response response = client.newCall(request).execute(); return response.body().string();&#125; å…·ä½“çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒIBMçš„è¿™ç¯‡æ–‡ç« ï¼šOkHttpï¼šJavaå¹³å°ä¸Šçš„æ–°ä¸€ä»£HTTPå®¢æˆ·ç«¯ ï¼Œä¸‹é¢æˆ‘ä»¬è½¬å…¥æºç çš„åˆ†æã€‚ æºç åˆ†ææˆ‘ä»¬ä»åˆ›å»º OkHttpClient å¯¹è±¡å¼€å§‹ï¼š 1OkHttpClient client = new OkHttpClient(); OkHttpClientçœ‹çœ‹å…¶æ„é€ å‡½æ•°ï¼š 123public OkHttpClient() &#123; this(new Builder());&#125; åŸæ¥æ˜¯æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ï¼Œæä¾›äº†ä¸€ä¸ªâ€œå¿«æ·æ“ä½œâ€ï¼Œå…¨éƒ¨ä½¿ç”¨äº†é»˜è®¤çš„é…ç½®ã€‚OkHttpClient.Builder ç±»æˆå‘˜å¾ˆå¤šï¼Œåé¢æˆ‘ä»¬å†æ…¢æ…¢åˆ†æï¼Œè¿™é‡Œå…ˆæš‚æ—¶ç•¥è¿‡ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344//OkHttpClient.javaç±»ä¸­OkHttpClient(Builder builder) &#123; this.dispatcher = builder.dispatcher; // åˆ†å‘å™¨ this.proxy = builder.proxy; // ä»£ç† this.protocols = builder.protocols; // åè®® this.connectionSpecs = builder.connectionSpecs; this.interceptors = Util.immutableList(builder.interceptors); // æ‹¦æˆªå™¨ this.networkInterceptors = Util.immutableList(builder.networkInterceptors); // ç½‘ç»œæ‹¦æˆªå™¨ this.eventListenerFactory = builder.eventListenerFactory; this.proxySelector = builder.proxySelector; // ä»£ç†é€‰æ‹© this.cookieJar = builder.cookieJar; // cookie this.cache = builder.cache; // ç¼“å­˜ this.internalCache = builder.internalCache; this.socketFactory = builder.socketFactory; boolean isTLS = false; for (ConnectionSpec spec : connectionSpecs) &#123; isTLS = isTLS || spec.isTls(); &#125; if (builder.sslSocketFactory != null || !isTLS) &#123; this.sslSocketFactory = builder.sslSocketFactory; this.certificateChainCleaner = builder.certificateChainCleaner; &#125; else &#123; X509TrustManager trustManager = systemDefaultTrustManager(); this.sslSocketFactory = systemDefaultSslSocketFactory(trustManager); this.certificateChainCleaner = CertificateChainCleaner.get(trustManager); &#125; this.hostnameVerifier = builder.hostnameVerifier; this.certificatePinner = builder.certificatePinner.withCertificateChainCleaner( certificateChainCleaner); this.proxyAuthenticator = builder.proxyAuthenticator; this.authenticator = builder.authenticator; this.connectionPool = builder.connectionPool; // è¿æ¥å¤ç”¨æ±  this.dns = builder.dns; this.followSslRedirects = builder.followSslRedirects; this.followRedirects = builder.followRedirects; this.retryOnConnectionFailure = builder.retryOnConnectionFailure; this.connectTimeout = builder.connectTimeout; // è¿æ¥è¶…æ—¶æ—¶é—´ this.readTimeout = builder.readTimeout; // è¯»å–è¶…æ—¶æ—¶é—´ this.writeTimeout = builder.writeTimeout; // å†™å…¥è¶…æ—¶æ—¶é—´ this.pingInterval = builder.pingInterval;&#125; çœ‹åˆ°è¿™ï¼Œå¦‚æœä½ è¿˜ä¸æ˜ç™½çš„è¯ï¼Œä¹Ÿæ²¡å…³ç³»ï¼Œåœ¨OkHttpä¸­åªæ˜¯è®¾ç½®ç”¨çš„çš„å„ä¸ªä¸œè¥¿ã€‚ çœŸæ­£çš„æµç¨‹è¦ä»é‡Œé¢çš„newCall()æ–¹æ³•ä¸­è¯´èµ·ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨OkHttpå‘èµ· HTTP è¯·æ±‚çš„æ–¹å¼ä¸€èˆ¬å¦‚ä¸‹ï¼š 123456Request request = new Request.Builder() .url(\"http://www.baidu.com\") .build();//å‘èµ·åŒæ­¥è¯·æ±‚Response response = client.newCall(request).execute(); å½“é€šè¿‡å»ºé€ è€…æ¨¡å¼åˆ›å»ºäº†Requestä¹‹åï¼ˆè¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´ï¼‰ï¼Œç´§æ¥ç€å°±é€šè¿‡client.newCall(request).execute()æ¥è·å¾—Responseã€‚è¿™å¥ä»£ç å°±å¼€å¯äº†æ•´ä¸ªGETè¯·æ±‚çš„æµç¨‹ï¼š é‚£æˆ‘ä»¬ç°åœ¨å°±æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•é€šè¿‡newCall()åˆ›å»º Call çš„ï¼š 1234@Override public Call newCall(Request request) &#123; return RealCall.newRealCall(this, request, false /* for web socket */);&#125; Callåœ¨è¿™é‡Œå†å¤šè¯´ä¸€ä¸‹å…³äºCallè¿™ä¸ªç±»çš„ä½œç”¨ï¼ŒOkHttp ä½¿ç”¨è°ƒç”¨ï¼ˆCallï¼‰æ¥å¯¹å‘é€ HTTP è¯·æ±‚å’Œè·å–å“åº”çš„è¿‡ç¨‹è¿›è¡ŒæŠ½è±¡ã€‚åœ¨Callä¸­æŒæœ‰ä¸€ä¸ªHttpEngineã€‚æ¯ä¸€ä¸ªä¸åŒçš„Calléƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„HttpEngineã€‚åœ¨HttpEngineä¸­ä¸»è¦æ˜¯å„ç§é“¾è·¯å’Œåœ°å€çš„é€‰æ‹©ï¼Œè¿˜æœ‰ä¸€ä¸ªTransportæ¯”è¾ƒé‡è¦ã€‚Callæ¥å£å®šä¹‰å¦‚ä¸‹ï¼š 1234567891011121314151617181920public interface Call extends Cloneable &#123; Request request(); Response execute() throws IOException; void enqueue(Callback responseCallback); void cancel(); boolean isExecuted(); boolean isCanceled(); Call clone(); interface Factory &#123; Call newCall(Request request); &#125;&#125; OkHttpClient å®ç°äº† Call.Factoryï¼Œè´Ÿè´£æ ¹æ®è¯·æ±‚åˆ›å»ºæ–°çš„ Callã€‚ CallFactory è´Ÿè´£åˆ›å»º HTTP è¯·æ±‚ï¼ŒHTTP è¯·æ±‚è¢«æŠ½è±¡ä¸ºäº† okhttp3.Call ç±»ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªå·²ç»å‡†å¤‡å¥½ï¼Œå¯ä»¥éšæ—¶æ‰§è¡Œçš„ HTTP è¯·æ±‚ RealCallRealCallæ˜¯Callæ¥å£çš„å®ç°ï¼Œæˆ‘ä»¬ç»§ç»­æ¥ç€ä¸Šé¢çœ‹RealCallçš„newRealCall()æ–¹æ³•ï¼š 1234567891011121314static RealCall newRealCall(OkHttpClient client, Request originalRequest, boolean forWebSocket) &#123; // Safely publish the Call instance to the EventListener. RealCall call = new RealCall(client, originalRequest, forWebSocket); call.eventListener = client.eventListenerFactory().create(call); return call;&#125;private RealCall(OkHttpClient client, Request originalRequest, boolean forWebSocket) &#123; this.client = client; this.originalRequest = originalRequest; this.forWebSocket = forWebSocket; this.retryAndFollowUpInterceptor = new RetryAndFollowUpInterceptor(client, forWebSocket);&#125; å…¶å®å°±æ˜¯é€šè¿‡æ„é€ å‡½æ•°newäº†ä¸€ä¸ªRealCallå¯¹è±¡ï¼Œæ„é€ å‡½æ•°å¦‚ä¸‹ï¼Œä¸ç”¨çœ‹å¾ˆç»†ï¼Œç•¥è¿‡ã€‚æˆ‘ä»¬é‡ç‚¹çœ‹çœ‹ RealCall#executeï¼š 12345678910111213141516171819202122232425//RealCallç±»ä¸­@Override public Response execute() throws IOException &#123; synchronized (this) &#123; //1. æ¯ä¸ªCallåªèƒ½è¢«æ‰§è¡Œä¸€æ¬¡ã€‚å¦‚æœè¯¥ call å·²ç»è¢«æ‰§è¡Œè¿‡äº†ï¼Œå°±è®¾ç½® executed ä¸º true if (executed) throw new IllegalStateException(\"Already Executed\"); executed = true; &#125; captureCallStackTrace(); eventListener.callStart(this); try &#123; //2. åŠ å…¥ runningSyncCalls é˜Ÿåˆ—ä¸­ client.dispatcher().executed(this); //3. å¾—åˆ°å“åº” result Response result = getResponseWithInterceptorChain(); if (result == null) throw new IOException(\"Canceled\"); return result; &#125; catch (IOException e) &#123; eventListener.callFailed(this, e); throw e; &#125; finally &#123; //4. ä» runningSyncCalls é˜Ÿåˆ—ä¸­ç§»é™¤ client.dispatcher().finished(this); &#125;&#125; è¿™é‡Œæˆ‘ä»¬åšäº† 4 ä»¶äº‹ï¼š æ£€æŸ¥è¿™ä¸ª call æ˜¯å¦å·²ç»è¢«æ‰§è¡Œäº†ï¼Œæ¯ä¸ª call åªèƒ½è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœæƒ³è¦ä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„ callï¼Œå¯ä»¥åˆ©ç”¨ call#clone æ–¹æ³•è¿›è¡Œå…‹éš†ã€‚ åˆ©ç”¨ client.dispatcher().executed(this) æ¥è¿›è¡Œå®é™…æ‰§è¡Œï¼Œdispatcher æ˜¯åˆšæ‰çœ‹åˆ°çš„ OkHttpClient.Builder çš„æˆå‘˜ä¹‹ä¸€ï¼Œå®ƒçš„æ–‡æ¡£è¯´è‡ªå·±æ˜¯å¼‚æ­¥ HTTP è¯·æ±‚çš„æ‰§è¡Œç­–ç•¥ï¼Œç°åœ¨çœ‹æ¥ï¼ŒåŒæ­¥è¯·æ±‚å®ƒä¹Ÿæœ‰æºå’Œã€‚ è°ƒç”¨ getResponseWithInterceptorChain() å‡½æ•°è·å– HTTP è¿”å›ç»“æœï¼Œä»å‡½æ•°åå¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸€æ­¥è¿˜ä¼šè¿›è¡Œä¸€ç³»åˆ—â€œæ‹¦æˆªâ€æ“ä½œã€‚ æœ€åè¿˜è¦é€šçŸ¥ dispatcher è‡ªå·±å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚ dispatcher è¿™é‡Œæˆ‘ä»¬ä¸è¿‡åº¦å…³æ³¨ï¼Œåœ¨åŒæ­¥æ‰§è¡Œçš„æµç¨‹ä¸­ï¼Œæ¶‰åŠåˆ° dispatcher çš„å†…å®¹åªä¸è¿‡æ˜¯å‘ŠçŸ¥å®ƒæˆ‘ä»¬çš„æ‰§è¡ŒçŠ¶æ€ï¼Œæ¯”å¦‚å¼€å§‹æ‰§è¡Œäº†ï¼ˆè°ƒç”¨ executedï¼‰ï¼Œæ¯”å¦‚æ‰§è¡Œå®Œæ¯•äº†ï¼ˆè°ƒç”¨ finishedï¼‰ï¼Œåœ¨å¼‚æ­¥æ‰§è¡Œæµç¨‹ä¸­å®ƒä¼šæœ‰æ›´å¤šçš„å‚ä¸ã€‚ çœŸæ­£å‘å‡ºç½‘ç»œè¯·æ±‚ï¼Œè§£æè¿”å›ç»“æœçš„ï¼Œè¿˜æ˜¯ getResponseWithInterceptorChainã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ–¹æ³•æ˜¯ç›´æ¥è¿”å› Response å¯¹è±¡çš„ï¼Œæ‰€ä»¥ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¸€å®šåšäº†å¾ˆå¤šå¾ˆå¤šçš„äº‹æƒ…ã€‚ 123456789101112131415161718192021//RealCallç±»ä¸­Response getResponseWithInterceptorChain() throws IOException &#123; // Build a full stack of interceptors. List&lt;Interceptor&gt; interceptors = new ArrayList&lt;&gt;(); interceptors.addAll(client.interceptors()); // åŠ å…¥ç”¨æˆ·è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ interceptors.add(retryAndFollowUpInterceptor); // é‡è¯•å’Œé‡å®šå‘æ‹¦æˆªå™¨ interceptors.add(new BridgeInterceptor(client.cookieJar())); // åŠ å…¥è½¬åŒ–è¯·æ±‚å“åº”çš„æ‹¦æˆªå™¨ interceptors.add(new CacheInterceptor(client.internalCache())); // åŠ å…¥ç¼“å­˜æ‹¦æˆªå™¨ interceptors.add(new ConnectInterceptor(client)); // åŠ å…¥è¿æ¥æ‹¦æˆªå™¨ if (!forWebSocket) &#123; interceptors.addAll(client.networkInterceptors()); // åŠ å…¥ç”¨æˆ·è‡ªå®šä¹‰çš„ç½‘ç»œæ‹¦æˆªå™¨ &#125; interceptors.add(new CallServerInterceptor(forWebSocket)); // åŠ å…¥å‘å‡ºè¯·æ±‚å’Œè¯»å–å“åº”çš„æ‹¦æˆªå™¨ Interceptor.Chain chain = new RealInterceptorChain(interceptors, null, null, null, 0, originalRequest, this, eventListener, client.connectTimeoutMillis(), client.readTimeoutMillis(), client.writeTimeoutMillis()); // åˆ©ç”¨ chain æ¥é“¾å¼è°ƒç”¨æ‹¦æˆªå™¨ï¼Œæœ€åçš„è¿”å›ç»“æœå°±æ˜¯ Response å¯¹è±¡ return chain.proceed(originalRequest); &#125; åœ¨ OkHttp å¼€å‘è€…ä¹‹ä¸€ä»‹ç» OkHttp çš„æ–‡ç« é‡Œé¢ï¼Œä½œè€…è®²åˆ°ï¼š the whole thing is just a stack of built-in interceptors. å¯è§ Interceptor æ˜¯ OkHttp æœ€æ ¸å¿ƒçš„ä¸€ä¸ªä¸œè¥¿ï¼Œä¸è¦è¯¯ä»¥ä¸ºå®ƒåªè´Ÿè´£æ‹¦æˆªè¯·æ±‚è¿›è¡Œä¸€äº›é¢å¤–çš„å¤„ç†ï¼ˆä¾‹å¦‚ cookieï¼‰ï¼Œå®é™…ä¸Šå®ƒæŠŠå®é™…çš„ç½‘ç»œè¯·æ±‚ã€ç¼“å­˜ã€é€æ˜å‹ç¼©ç­‰åŠŸèƒ½éƒ½ç»Ÿä¸€äº†èµ·æ¥ï¼Œæ¯ä¸€ä¸ªåŠŸèƒ½éƒ½åªæ˜¯ä¸€ä¸ª Interceptorï¼Œå®ƒä»¬å†è¿æ¥æˆä¸€ä¸ª Interceptor.Chainï¼Œç¯ç¯ç›¸æ‰£ï¼Œæœ€ç»ˆåœ†æ»¡å®Œæˆä¸€æ¬¡ç½‘ç»œè¯·æ±‚ã€‚ ä» getResponseWithInterceptorChain å‡½æ•°æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒInterceptor.Chain çš„åˆ†å¸ƒä¾æ¬¡æ˜¯ï¼š client.interceptors() ï¼Œé¦–å…ˆåŠ å…¥ interceptors çš„æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨ï¼Œæ¯”å¦‚ä¿®æ”¹è¯·æ±‚å¤´çš„æ‹¦æˆªå™¨ç­‰ï¼› RetryAndFollowUpInterceptor ï¼šæ˜¯ç”¨æ¥é‡è¯•å’Œé‡å®šå‘çš„æ‹¦æˆªå™¨ï¼Œåœ¨ä¸‹é¢æˆ‘ä»¬ä¼šè®²åˆ°ï¼› BridgeInterceptorï¼šæ˜¯ç”¨æ¥å°†ç”¨æˆ·å‹å¥½çš„è¯·æ±‚è½¬åŒ–ä¸ºå‘æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œä¹‹ååˆæŠŠæœåŠ¡å™¨çš„å“åº”è½¬åŒ–ä¸ºå¯¹ç”¨æˆ·å‹å¥½çš„å“åº”ï¼› CacheInterceptorï¼šæ˜¯ç¼“å­˜æ‹¦æˆªå™¨ï¼Œè‹¥å­˜åœ¨ç¼“å­˜å¹¶ä¸”å¯ç”¨å°±ç›´æ¥è¿”å›è¯¥ç¼“å­˜ï¼Œå¦åˆ™ä¼šå‘æœåŠ¡å™¨è¯·æ±‚ï¼› ConnectInterceptorï¼šç”¨æ¥å»ºç«‹è¿æ¥çš„æ‹¦æˆªå™¨ï¼› client.networkInterceptors() åŠ å…¥ç”¨æˆ·è‡ªå®šä¹‰çš„ networkInterceptors ; CallServerInterceptorï¼šæ˜¯çœŸæ­£å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ä¸”å¾—åˆ°å“åº”çš„æ‹¦æˆªå™¨ï¼› åœ¨è¿™é‡Œï¼Œä½ç½®å†³å®šäº†åŠŸèƒ½ï¼Œæœ€åä¸€ä¸ª Interceptor ä¸€å®šæ˜¯è´Ÿè´£å’ŒæœåŠ¡å™¨å®é™…é€šè®¯çš„ï¼Œé‡å®šå‘ã€ç¼“å­˜ç­‰ä¸€å®šæ˜¯åœ¨å®é™…é€šè®¯ä¹‹å‰çš„ã€‚ è´£ä»»é“¾æ¨¡å¼åœ¨è¿™ä¸ª Interceptor é“¾æ¡ä¸­å¾—åˆ°äº†å¾ˆå¥½çš„å®è·µã€‚ è´£ä»»é“¾æ¨¡å¼åœ¨é¢å‘å¯¹è±¡ç¨‹å¼è®¾è®¡é‡Œæ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå®ƒåŒ…å«äº†ä¸€äº›å‘½ä»¤å¯¹è±¡å’Œä¸€ç³»åˆ—çš„å¤„ç†å¯¹è±¡ã€‚æ¯ä¸€ä¸ªå¤„ç†å¯¹è±¡å†³å®šå®ƒèƒ½å¤„ç†å“ªäº›å‘½ä»¤å¯¹è±¡ï¼Œå®ƒä¹ŸçŸ¥é“å¦‚ä½•å°†å®ƒä¸èƒ½å¤„ç†çš„å‘½ä»¤å¯¹è±¡ä¼ é€’ç»™è¯¥é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¤„ç†å¯¹è±¡ã€‚è¯¥æ¨¡å¼è¿˜æè¿°äº†å¾€è¯¥å¤„ç†é“¾çš„æœ«å°¾æ·»åŠ æ–°çš„å¤„ç†å¯¹è±¡çš„æ–¹æ³•ã€‚ å¦å¤–å‚è€ƒæ–‡ç« ï¼šAndroidè®¾è®¡æ¨¡å¼ä¹‹è´£ä»»é“¾æ¨¡å¼ä¸­ç›¸å…³çš„åˆ†æï¼š Androidä¸­å…³äºè´£ä»»é“¾æ¨¡å¼æ¯”è¾ƒæ˜æ˜¾çš„ä½“ç°å°±æ˜¯åœ¨äº‹ä»¶åˆ†å‘è¿‡ç¨‹ä¸­å¯¹äº‹ä»¶çš„æŠ•é€’ï¼Œå…¶å®ä¸¥æ ¼æ¥è¯´ï¼Œäº‹ä»¶æŠ•é€’çš„æ¨¡å¼å¹¶ä¸æ˜¯ä¸¥æ ¼çš„è´£ä»»é“¾æ¨¡å¼ï¼Œä½†æ˜¯å…¶æ˜¯è´£ä»»é“¾æ¨¡å¼çš„ä¸€ç§å˜ç§ä½“ç°ã€‚ å¯¹äºæŠŠ Request å˜æˆ Response è¿™ä»¶äº‹æ¥è¯´ï¼Œæ¯ä¸ª Interceptor éƒ½å¯èƒ½å®Œæˆè¿™ä»¶äº‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ªç€é“¾æ¡è®©æ¯ä¸ª Interceptor è‡ªè¡Œå†³å®šèƒ½å¦å®Œæˆä»»åŠ¡ä»¥åŠæ€ä¹ˆå®Œæˆä»»åŠ¡ï¼ˆè‡ªåŠ›æ›´ç”Ÿæˆ–è€…äº¤ç»™ä¸‹ä¸€ä¸ª Interceptorï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œå®Œæˆç½‘ç»œè¯·æ±‚è¿™ä»¶äº‹å°±å½»åº•ä» RealCall ç±»ä¸­å‰¥ç¦»äº†å‡ºæ¥ï¼Œç®€åŒ–äº†å„è‡ªçš„è´£ä»»å’Œé€»è¾‘ã€‚ æœ€ååœ¨èšåˆäº†è¿™äº›æ‹¦æˆªå™¨ä¹‹åï¼Œåˆ©ç”¨ RealInterceptorChain æ¥é“¾å¼è°ƒç”¨è¿™äº›æ‹¦æˆªå™¨ã€‚ RealInterceptorChainRealInterceptorChain å¯ä»¥è¯´æ˜¯çœŸæ­£æŠŠè¿™äº›æ‹¦æˆªå™¨ä¸²èµ·æ¥çš„ä¸€ä¸ªè§’è‰²ã€‚ä¸€ä¸ªä¸ªæ‹¦æˆªå™¨å°±åƒä¸€é¢—é¢—ç å­ï¼Œè€Œ RealInterceptorChainå°±æ˜¯æŠŠè¿™äº›ç å­ä¸²è¿èµ·æ¥çš„é‚£æ ¹ç»³å­ã€‚ è¿›å…¥ RealInterceptorChain ï¼Œä¸»è¦æ˜¯ proceed() è¿™ä¸ªæ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152@Override public Response proceed(Request request) throws IOException &#123; return proceed(request, streamAllocation, httpCodec, connection);&#125;public Response proceed(Request request, StreamAllocation streamAllocation, HttpCodec httpCodec, RealConnection connection) throws IOException &#123; if (index &gt;= interceptors.size()) throw new AssertionError(); calls++; // If we already have a stream, confirm that the incoming request will use it. if (this.httpCodec != null &amp;&amp; !this.connection.supportsUrl(request.url())) &#123; throw new IllegalStateException(\"network interceptor \" + interceptors.get(index - 1) + \" must retain the same host and port\"); &#125; // If we already have a stream, confirm that this is the only call to chain.proceed(). if (this.httpCodec != null &amp;&amp; calls &gt; 1) &#123; throw new IllegalStateException(\"network interceptor \" + interceptors.get(index - 1) + \" must call proceed() exactly once\"); &#125; // å¾—åˆ°ä¸‹ä¸€æ¬¡å¯¹åº”çš„ RealInterceptorChain // Call the next interceptor in the chain. RealInterceptorChain next = new RealInterceptorChain(interceptors, streamAllocation, httpCodec, connection, index + 1, request, call, eventListener, connectTimeout, readTimeout, writeTimeout); // å½“å‰çš„ interceptor Interceptor interceptor = interceptors.get(index); // è¿›è¡Œæ‹¦æˆªå¤„ç†ï¼Œå¹¶ä¸”åœ¨ interceptor é“¾å¼è°ƒç”¨ next çš„ proceed æ–¹æ³• Response response = interceptor.intercept(next); // Confirm that the next interceptor made its required call to chain.proceed(). if (httpCodec != null &amp;&amp; index + 1 &lt; interceptors.size() &amp;&amp; next.calls != 1) &#123; throw new IllegalStateException(\"network interceptor \" + interceptor + \" must call proceed() exactly once\"); &#125; // Confirm that the intercepted response isn't null. if (response == null) &#123; throw new NullPointerException(\"interceptor \" + interceptor + \" returned null\"); &#125; if (response.body() == null) &#123; throw new IllegalStateException( \"interceptor \" + interceptor + \" returned a response with no body\"); &#125; return response;&#125; åœ¨ä»£ç ä¸­æ˜¯ä¸€æ¬¡æ¬¡é“¾å¼è°ƒç”¨æ‹¦æˆªå™¨ï¼Œ ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨å¯¹åº”çš„RealIterceptorChainå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šä¼ é€’ç»™å½“å‰çš„æ‹¦æˆªå™¨ å¾—åˆ°å½“å‰çš„æ‹¦æˆªå™¨ï¼šinterceptorsæ˜¯å­˜æ”¾æ‹¦æˆªå™¨çš„ArryList è°ƒç”¨å½“å‰æ‹¦æˆªå™¨çš„intercept()æ–¹æ³•ï¼Œå¹¶å°†ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨çš„RealIterceptorChainå¯¹è±¡ä¼ é€’ä¸‹å» ç¤ºæ„å›¾å¦‚ä¸‹ï¼š ä¸‹é¢æ ¹æ®ä¸Šé¢çš„è´£ä»»é“¾æˆ‘ä»¬é€ä¸ªåˆ†æä¸€ä¸‹å¯¹åº”çš„æ‹¦æˆªå™¨Interceptorã€‚ æ‹¦æˆªå™¨Interceptoræ‹¦æˆªå™¨æ˜¯ OkHttp æä¾›çš„å¯¹ HTTP è¯·æ±‚å’Œå“åº”è¿›è¡Œç»Ÿä¸€å¤„ç†çš„å¼ºå¤§æœºåˆ¶ã€‚æ‹¦æˆªå™¨åœ¨å®ç°å’Œä½¿ç”¨ä¸Šç±»ä¼¼äº Servlet è§„èŒƒä¸­çš„è¿‡æ»¤å™¨ã€‚å¤šä¸ªæ‹¦æˆªå™¨å¯ä»¥é“¾æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªé“¾æ¡ã€‚æ‹¦æˆªå™¨ä¼šæŒ‰ç…§åœ¨é“¾æ¡ä¸Šçš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ æ‹¦æˆªå™¨åœ¨æ‰§è¡Œæ—¶ï¼Œå¯ä»¥å…ˆå¯¹è¯·æ±‚çš„ Request å¯¹è±¡è¿›è¡Œä¿®æ”¹ï¼›å†å¾—åˆ°å“åº”çš„ Response å¯¹è±¡ä¹‹åï¼Œå¯ä»¥è¿›è¡Œä¿®æ”¹ä¹‹åå†è¿”å›ã€‚ æ‹¦æˆªå™¨Interceptoræ¥å£å®šä¹‰å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829public interface Interceptor &#123; Response intercept(Chain chain) throws IOException; interface Chain &#123; Request request(); Response proceed(Request request) throws IOException; /** * Returns the connection the request will be executed on. This is only available in the chains * of network interceptors; for application interceptors this is always null. */ @Nullable Connection connection(); Call call(); int connectTimeoutMillis(); Chain withConnectTimeout(int timeout, TimeUnit unit); int readTimeoutMillis(); Chain withReadTimeout(int timeout, TimeUnit unit); int writeTimeoutMillis(); Chain withWriteTimeout(int timeout, TimeUnit unit); &#125;&#125; é™¤äº†åœ¨clientä¸­è‡ªå®šä¹‰è®¾ç½®çš„interceptor,ç¬¬ä¸€ä¸ªè°ƒç”¨çš„å°±æ˜¯RetryAndFollowUpInterceptorã€‚ RetryAndFollowUpInterceptorï¼ˆé‡è¯•å’Œé‡å®šå‘æ‹¦æˆªå™¨ï¼‰æˆ‘ä»¬ç€é‡çœ‹çœ‹å®ƒçš„intercept()æ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798@Override public Response intercept(Chain chain) throws IOException &#123; Request request = chain.request(); RealInterceptorChain realChain = (RealInterceptorChain) chain; Call call = realChain.call(); EventListener eventListener = realChain.eventListener(); streamAllocation = new StreamAllocation(client.connectionPool(), createAddress(request.url()), call, eventListener, callStackTrace); int followUpCount = 0; Response priorResponse = null; while (true) &#123; // å¦‚æœå–æ¶ˆï¼Œå°±é‡Šæ”¾èµ„æº if (canceled) &#123; streamAllocation.release(); throw new IOException(\"Canceled\"); &#125; Response response; boolean releaseConnection = true; try &#123; // è°ƒç”¨ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ response = realChain.proceed(request, streamAllocation, null, null); releaseConnection = false; &#125; catch (RouteException e) &#123; // The attempt to connect via a route failed. The request will not have been sent. // è·¯ç”±è¿æ¥å¤±è´¥ï¼Œè¯·æ±‚å°†ä¸ä¼šè¢«å‘é€ if (!recover(e.getLastConnectException(), false, request)) &#123; throw e.getLastConnectException(); &#125; releaseConnection = false; continue; &#125; catch (IOException e) &#123; // An attempt to communicate with a server failed. The request may have been sent. // æœåŠ¡å™¨è¿æ¥å¤±è´¥ï¼Œè¯·æ±‚å¯èƒ½å·²è¢«å‘é€ boolean requestSendStarted = !(e instanceof ConnectionShutdownException); if (!recover(e, requestSendStarted, request)) throw e; releaseConnection = false; continue; &#125; finally &#123; // We're throwing an unchecked exception. Release any resources. // æŠ›å‡ºæœªæ£€æŸ¥çš„å¼‚å¸¸ï¼Œé‡Šæ”¾èµ„æº if (releaseConnection) &#123; streamAllocation.streamFailed(null); streamAllocation.release(); &#125; &#125; // Attach the prior response if it exists. Such responses never have a body. if (priorResponse != null) &#123; response = response.newBuilder() .priorResponse(priorResponse.newBuilder() .body(null) .build()) .build(); &#125; // å¦‚æœä¸éœ€è¦é‡å®šå‘ï¼Œé‚£ä¹ˆ followUp ä¸ºç©ºï¼Œä¼šæ ¹æ®å“åº”ç åˆ¤æ–­ Request followUp = followUpRequest(response); // é‡Šæ”¾èµ„æºï¼Œè¿”å› response if (followUp == null) &#123; if (!forWebSocket) &#123; streamAllocation.release(); &#125; return response; &#125; // å…³é—­ response çš„ body closeQuietly(response.body()); if (++followUpCount &gt; MAX_FOLLOW_UPS) &#123; streamAllocation.release(); throw new ProtocolException(\"Too many follow-up requests: \" + followUpCount); &#125; if (followUp.body() instanceof UnrepeatableRequestBody) &#123; streamAllocation.release(); throw new HttpRetryException(\"Cannot retry streamed HTTP body\", response.code()); &#125; // æ¯”è¾ƒresponse å’Œ followUp æ˜¯å¦ä¸ºåŒä¸€ä¸ªè¿æ¥ // è‹¥ä¸ºé‡å®šå‘å°±é”€æ¯æ—§è¿æ¥ï¼Œåˆ›å»ºæ–°è¿æ¥ if (!sameConnection(response, followUp.url())) &#123; streamAllocation.release(); streamAllocation = new StreamAllocation(client.connectionPool(), createAddress(followUp.url()), call, eventListener, callStackTrace); &#125; else if (streamAllocation.codec() != null) &#123; throw new IllegalStateException(\"Closing the body of \" + response + \" didn't close its backing stream. Bad interceptor?\"); &#125; // å°†é‡å®šå‘æ“ä½œå¾—åˆ°çš„æ–°è¯·æ±‚è®¾ç½®ç»™ request request = followUp; priorResponse = response; &#125; &#125; æ€»ä½“æ¥è¯´ï¼ŒRetryAndFollowUpInterceptor æ˜¯ç”¨æ¥å¤±è´¥é‡è¯•ä»¥åŠé‡å®šå‘çš„æ‹¦æˆªå™¨ã€‚ BridgeInterceptorï¼ˆè¯·æ±‚æ„é€ æ‹¦æˆªå™¨ï¼‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374@Override public Response intercept(Chain chain) throws IOException &#123; Request userRequest = chain.request(); Request.Builder requestBuilder = userRequest.newBuilder(); // å°†ç”¨æˆ·å‹å¥½çš„ request æ„é€ ä¸ºå‘é€ç»™æœåŠ¡å™¨çš„ request RequestBody body = userRequest.body(); // è‹¥æœ‰è¯·æ±‚ä½“ï¼Œåˆ™æ„é€  if (body != null) &#123; MediaType contentType = body.contentType(); if (contentType != null) &#123; requestBuilder.header(\"Content-Type\", contentType.toString()); &#125; long contentLength = body.contentLength(); if (contentLength != -1) &#123; requestBuilder.header(\"Content-Length\", Long.toString(contentLength)); requestBuilder.removeHeader(\"Transfer-Encoding\"); &#125; else &#123; requestBuilder.header(\"Transfer-Encoding\", \"chunked\"); requestBuilder.removeHeader(\"Content-Length\"); &#125; &#125; if (userRequest.header(\"Host\") == null) &#123; requestBuilder.header(\"Host\", hostHeader(userRequest.url(), false)); &#125; // Keep Alive if (userRequest.header(\"Connection\") == null) &#123; requestBuilder.header(\"Connection\", \"Keep-Alive\"); &#125; // If we add an \"Accept-Encoding: gzip\" header field we're responsible for also decompressing // the transfer stream. // ä½¿ç”¨ gzip å‹ç¼© boolean transparentGzip = false; if (userRequest.header(\"Accept-Encoding\") == null &amp;&amp; userRequest.header(\"Range\") == null) &#123; transparentGzip = true; requestBuilder.header(\"Accept-Encoding\", \"gzip\"); &#125; // è®¾ç½® cookie List&lt;Cookie&gt; cookies = cookieJar.loadForRequest(userRequest.url()); if (!cookies.isEmpty()) &#123; requestBuilder.header(\"Cookie\", cookieHeader(cookies)); &#125; // UA: User-Agent if (userRequest.header(\"User-Agent\") == null) &#123; requestBuilder.header(\"User-Agent\", Version.userAgent()); &#125; // æ„é€ å®Œåï¼Œå°† request äº¤ç»™ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨å»å¤„ç†ã€‚æœ€ååˆå¾—åˆ°æœåŠ¡ç«¯å“åº” networkResponse Response networkResponse = chain.proceed(requestBuilder.build()); // ä¿å­˜ networkResponse çš„ cookie HttpHeaders.receiveHeaders(cookieJar, userRequest.url(), networkResponse.headers()); // å°† networkResponse è½¬æ¢ä¸ºå¯¹ç”¨æˆ·å‹å¥½çš„ response Response.Builder responseBuilder = networkResponse.newBuilder() .request(userRequest); // å¦‚æœ networkResponse ä½¿ç”¨ gzip å¹¶ä¸”æœ‰å“åº”ä½“çš„è¯ï¼Œç»™ç”¨æˆ·å‹å¥½çš„ response è®¾ç½®å“åº”ä½“ if (transparentGzip &amp;&amp; \"gzip\".equalsIgnoreCase(networkResponse.header(\"Content-Encoding\")) &amp;&amp; HttpHeaders.hasBody(networkResponse)) &#123; GzipSource responseBody = new GzipSource(networkResponse.body().source()); Headers strippedHeaders = networkResponse.headers().newBuilder() .removeAll(\"Content-Encoding\") .removeAll(\"Content-Length\") .build(); responseBuilder.headers(strippedHeaders); String contentType = networkResponse.header(\"Content-Type\"); responseBuilder.body(new RealResponseBody(contentType, -1L, Okio.buffer(responseBody))); &#125; return responseBuilder.build();&#125; åœ¨ BridgeInterceptor è¿™ä¸€æ­¥ï¼Œ å…ˆæŠŠç”¨æˆ·å‹å¥½çš„è¯·æ±‚è¿›è¡Œé‡æ–°æ„é€ ï¼Œå˜æˆäº†å‘æœåŠ¡å™¨å‘é€çš„è¯·æ±‚ã€‚ ä¹‹åè°ƒç”¨ chain.proceed(requestBuilder.build()) è¿›è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨çš„å¤„ç†ã€‚ ç­‰åˆ°åé¢çš„æ‹¦æˆªå™¨éƒ½å¤„ç†å®Œæ¯•ï¼Œå¾—åˆ°å“åº”ã€‚å†æŠŠ networkResponse è½¬åŒ–æˆå¯¹ç”¨æˆ·å‹å¥½çš„ response ã€‚ CacheInterceptorï¼ˆç¼“å­˜æ‹¦æˆªå™¨ï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106@Override public Response intercept(Chain chain) throws IOException &#123; // å°è¯•ä»ç¼“å­˜ä¸­æŸ¥æ‰¾ request å¯¹åº”çš„ response Response cacheCandidate = cache != null ? cache.get(chain.request()) : null; // è·å–å½“å‰æ—¶é—´ï¼Œä¼šå’Œä¹‹å‰ç¼“å­˜çš„æ—¶é—´è¿›è¡Œæ¯”è¾ƒ long now = System.currentTimeMillis(); // å¾—åˆ°ç¼“å­˜ç­–ç•¥ CacheStrategy strategy = new CacheStrategy.Factory(now, chain.request(), cacheCandidate).get(); Request networkRequest = strategy.networkRequest; Response cacheResponse = strategy.cacheResponse; // è¿½è¸ªç¼“å­˜ï¼Œå…¶å®å°±æ˜¯è®¡æ•° if (cache != null) &#123; cache.trackResponse(strategy); &#125; // ç¼“å­˜æœªå‘½ä¸­ï¼Œå…³é—­ if (cacheCandidate != null &amp;&amp; cacheResponse == null) &#123; closeQuietly(cacheCandidate.body()); // The cache candidate wasn't applicable. Close it. &#125; // If we're forbidden from using the network and the cache is insufficient, fail. // ç¦æ­¢ç½‘ç»œå¹¶ä¸”æ²¡æœ‰ç¼“å­˜çš„è¯ï¼Œè¿”å›å¤±è´¥ if (networkRequest == null &amp;&amp; cacheResponse == null) &#123; return new Response.Builder() .request(chain.request()) .protocol(Protocol.HTTP_1_1) .code(504) .message(\"Unsatisfiable Request (only-if-cached)\") .body(Util.EMPTY_RESPONSE) .sentRequestAtMillis(-1L) .receivedResponseAtMillis(System.currentTimeMillis()) .build(); &#125; // If we don't need the network, we're done. // å‘½ä¸­ç¼“å­˜ã€‚ä¸”ä¸éœ€è¦ç½‘ç»œè¯·æ±‚æ›´æ–°ï¼Œè¿”å›ç¼“å­˜ if (networkRequest == null) &#123; return cacheResponse.newBuilder() .cacheResponse(stripBody(cacheResponse)) .build(); &#125; Response networkResponse = null; try &#123; // äº¤ç»™ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œè¿”å› networkResponse networkResponse = chain.proceed(networkRequest); &#125; finally &#123; // If we're crashing on I/O or otherwise, don't leak the cache body. if (networkResponse == null &amp;&amp; cacheCandidate != null) &#123; closeQuietly(cacheCandidate.body()); &#125; &#125; // If we have a cache response too, then we're doing a conditional get. // å¦‚æœæˆ‘ä»¬åŒæ—¶æœ‰ç¼“å­˜å’Œ networkResponse ï¼Œæ ¹æ®æƒ…å†µä½¿ç”¨ if (cacheResponse != null) &#123; if (networkResponse.code() == HTTP_NOT_MODIFIED) &#123; Response response = cacheResponse.newBuilder() .headers(combine(cacheResponse.headers(), networkResponse.headers())) .sentRequestAtMillis(networkResponse.sentRequestAtMillis()) .receivedResponseAtMillis(networkResponse.receivedResponseAtMillis()) .cacheResponse(stripBody(cacheResponse)) .networkResponse(stripBody(networkResponse)) .build(); networkResponse.body().close(); // æ›´æ–°åŸæ¥çš„ç¼“å­˜è‡³æœ€æ–° // Update the cache after combining headers but before stripping the // Content-Encoding header (as performed by initContentStream()). cache.trackConditionalCacheHit(); cache.update(cacheResponse, response); return response; &#125; else &#123; closeQuietly(cacheResponse.body()); &#125; &#125; Response response = networkResponse.newBuilder() .cacheResponse(stripBody(cacheResponse)) .networkResponse(stripBody(networkResponse)) .build(); // å¦‚æœä¹‹å‰ä»æœªè¿›è¡Œç¼“å­˜ï¼Œä¿å­˜ç¼“å­˜ if (cache != null) &#123; if (HttpHeaders.hasBody(response) &amp;&amp; CacheStrategy.isCacheable(response, networkRequest)) &#123; // Offer this request to the cache. CacheRequest cacheRequest = cache.put(response); return cacheWritingResponse(cacheRequest, response); &#125; if (HttpMethod.invalidatesCache(networkRequest.method())) &#123; try &#123; cache.remove(networkRequest); &#125; catch (IOException ignored) &#123; // The cache cannot be written. &#125; &#125; &#125; return response;&#125; CacheInterceptor åšçš„äº‹æƒ…å°±æ˜¯æ ¹æ®è¯·æ±‚æ‹¿åˆ°ç¼“å­˜ï¼Œè‹¥æ²¡æœ‰ç¼“å­˜æˆ–è€…ç¼“å­˜å¤±æ•ˆï¼Œå°±è¿›å…¥ç½‘ç»œè¯·æ±‚é˜¶æ®µï¼Œå¦åˆ™ä¼šè¿”å›ç¼“å­˜ã€‚ ConnectInterceptor123456789101112131415@Override public Response intercept(Chain chain) throws IOException &#123; RealInterceptorChain realChain = (RealInterceptorChain) chain; Request request = realChain.request(); StreamAllocation streamAllocation = realChain.streamAllocation(); // We need the network to satisfy this request. Possibly for validating a conditional GET. boolean doExtensiveHealthChecks = !request.method().equals(\"GET\"); // åˆ›å»º httpCodec ï¼ˆæŠ½è±¡ç±»ï¼‰ï¼Œåˆ†åˆ«å¯¹åº”ç€ http1.1 å’Œ http 2 HttpCodec httpCodec = streamAllocation.newStream(client, chain, doExtensiveHealthChecks); RealConnection connection = streamAllocation.connection(); // äº¤ç»™ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œå¾—åˆ°è¿”å›çš„ Response return realChain.proceed(request, streamAllocation, httpCodec, connection);&#125; å®é™…ä¸Šå»ºç«‹è¿æ¥å°±æ˜¯è°ƒç”¨äº† streamAllocation.newStream åˆ›å»ºäº†ä¸€ä¸ª HttpCodec å¯¹è±¡ï¼Œå®ƒå°†åœ¨åé¢çš„æ­¥éª¤ä¸­è¢«ä½¿ç”¨ï¼Œé‚£å®ƒåˆæ˜¯ä½•æ–¹ç¥åœ£å‘¢ï¼Ÿå®ƒæ˜¯å¯¹ HTTP åè®®æ“ä½œçš„æŠ½è±¡ï¼Œæœ‰ä¸¤ä¸ªå®ç°ï¼šHttp1Codec å’Œ Http2Codecï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº” HTTP/1.1 å’Œ HTTP/2 ç‰ˆæœ¬çš„å®ç°ã€‚ åœ¨ Http1Codec ä¸­ï¼Œå®ƒåˆ©ç”¨ Okio å¯¹ Socket çš„è¯»å†™æ“ä½œè¿›è¡Œå°è£…ï¼ŒOkio ä»¥åæœ‰æœºä¼šå†è¿›è¡Œåˆ†æï¼Œç°åœ¨è®©æˆ‘ä»¬å¯¹å®ƒä»¬ä¿æŒä¸€ä¸ªç®€å•åœ°è®¤è¯†ï¼šå®ƒå¯¹ java.io å’Œ java.nio è¿›è¡Œäº†å°è£…ï¼Œè®©æˆ‘ä»¬æ›´ä¾¿æ·é«˜æ•ˆçš„è¿›è¡Œ IO æ“ä½œã€‚ è€Œåˆ›å»º HttpCodec å¯¹è±¡çš„è¿‡ç¨‹æ¶‰åŠåˆ° StreamAllocationã€RealConnectionï¼Œä»£ç è¾ƒé•¿ï¼Œè¿™é‡Œå°±ä¸å±•å¼€ï¼Œè¿™ä¸ªè¿‡ç¨‹æ¦‚æ‹¬æ¥è¯´ï¼Œå°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„ RealConnectionï¼Œå†åˆ©ç”¨ RealConnection çš„è¾“å…¥è¾“å‡ºï¼ˆBufferedSource å’Œ BufferedSinkï¼‰åˆ›å»º HttpCodec å¯¹è±¡ï¼Œä¾›åç»­æ­¥éª¤ä½¿ç”¨ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹ streamAllocation.newStream() çš„ä»£ç ï¼š 12345678910111213141516171819202122// ä½äºStreamAllocationç±»public HttpCodec newStream( OkHttpClient client, Interceptor.Chain chain, boolean doExtensiveHealthChecks) &#123; int connectTimeout = chain.connectTimeoutMillis(); int readTimeout = chain.readTimeoutMillis(); int writeTimeout = chain.writeTimeoutMillis(); boolean connectionRetryEnabled = client.retryOnConnectionFailure(); try &#123; // åœ¨è¿æ¥æ± ä¸­æ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„è¿æ¥ï¼Œç„¶ååˆ›å»ºå‡º HttpCodec å¯¹è±¡ RealConnection resultConnection = findHealthyConnection(connectTimeout, readTimeout, writeTimeout, connectionRetryEnabled, doExtensiveHealthChecks); HttpCodec resultCodec = resultConnection.newCodec(client, chain, this); synchronized (connectionPool) &#123; codec = resultCodec; return resultCodec; &#125; &#125; catch (IOException e) &#123; throw new RouteException(e); &#125;&#125; findHealthyConnection()ï¼šå…ˆåœ¨è¿æ¥æ± ä¸­æ‰¾åˆ°å¯ç”¨çš„è¿æ¥ resultConnection ã€‚ è¿™ä¸€æ­¥ä¼šä½¿ç”¨Platform.get().connectSocket()åˆ›å»ºTCPè¿æ¥ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€‚ resultConnection.newCodec()ï¼šå†ç»“åˆ sink å’Œ source åˆ›å»ºå‡º HttpCodec çš„å¯¹è±¡ã€‚ HttpCodec è´Ÿè´£å¯¹HTTPè¯·æ±‚å’Œå“åº”è¿›è¡Œç¼–è§£ç ã€‚æ³¨é‡Šå¦‚ä¸‹ï¼š 12/** Encodes HTTP requests and decodes HTTP responses. */public interface HttpCodec &#123; ... &#125; CallServerInterceptor1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495@Override public Response intercept(Chain chain) throws IOException &#123; RealInterceptorChain realChain = (RealInterceptorChain) chain; HttpCodec httpCodec = realChain.httpStream(); StreamAllocation streamAllocation = realChain.streamAllocation(); RealConnection connection = (RealConnection) realChain.connection(); Request request = realChain.request(); long sentRequestMillis = System.currentTimeMillis(); realChain.eventListener().requestHeadersStart(realChain.call()); // æ•´ç†è¯·æ±‚å¤´å¹¶å†™å…¥ httpCodec.writeRequestHeaders(request); realChain.eventListener().requestHeadersEnd(realChain.call(), request); Response.Builder responseBuilder = null; // æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰ body çš„è¯·æ±‚æ–¹æ³• if (HttpMethod.permitsRequestBody(request.method()) &amp;&amp; request.body() != null) &#123; // If there's a \"Expect: 100-continue\" header on the request, wait for a \"HTTP/1.1 100 // Continue\" response before transmitting the request body. If we don't get that, return // what we did get (such as a 4xx response) without ever transmitting the request body. if (\"100-continue\".equalsIgnoreCase(request.header(\"Expect\"))) &#123; httpCodec.flushRequest(); realChain.eventListener().responseHeadersStart(realChain.call()); responseBuilder = httpCodec.readResponseHeaders(true); &#125; if (responseBuilder == null) &#123; // Write the request body if the \"Expect: 100-continue\" expectation was met. // å†™å…¥è¯·æ±‚ä½“ request body realChain.eventListener().requestBodyStart(realChain.call()); long contentLength = request.body().contentLength(); CountingSink requestBodyOut = new CountingSink(httpCodec.createRequestBody(request, contentLength)); BufferedSink bufferedRequestBody = Okio.buffer(requestBodyOut); request.body().writeTo(bufferedRequestBody); bufferedRequestBody.close(); realChain.eventListener() .requestBodyEnd(realChain.call(), requestBodyOut.successfulCount); &#125; else if (!connection.isMultiplexed()) &#123; // If the \"Expect: 100-continue\" expectation wasn't met, prevent the HTTP/1 connection // from being reused. Otherwise we're still obligated to transmit the request body to // leave the connection in a consistent state. streamAllocation.noNewStreams(); &#125; &#125; httpCodec.finishRequest(); // å¾—åˆ°å“åº”å¤´ if (responseBuilder == null) &#123; realChain.eventListener().responseHeadersStart(realChain.call()); responseBuilder = httpCodec.readResponseHeaders(false); &#125; // æ„é€  response Response response = responseBuilder .request(request) .handshake(streamAllocation.connection().handshake()) .sentRequestAtMillis(sentRequestMillis) .receivedResponseAtMillis(System.currentTimeMillis()) .build(); realChain.eventListener() .responseHeadersEnd(realChain.call(), response); int code = response.code(); // å¦‚æœä¸º web socket ä¸”çŠ¶æ€ç æ˜¯ 101 ï¼Œé‚£ä¹ˆ body ä¸ºç©º if (forWebSocket &amp;&amp; code == 101) &#123; // Connection is upgrading, but we need to ensure interceptors see a non-null response body. response = response.newBuilder() .body(Util.EMPTY_RESPONSE) .build(); &#125; else &#123; // è¯»å– body response = response.newBuilder() .body(httpCodec.openResponseBody(response)) .build(); &#125; // å¦‚æœè¯·æ±‚å¤´ä¸­æœ‰ close é‚£ä¹ˆæ–­å¼€è¿æ¥ if (\"close\".equalsIgnoreCase(response.request().header(\"Connection\")) || \"close\".equalsIgnoreCase(response.header(\"Connection\"))) &#123; streamAllocation.noNewStreams(); &#125; // æŠ›å‡ºåè®®å¼‚å¸¸ if ((code == 204 || code == 205) &amp;&amp; response.body().contentLength() &gt; 0) &#123; throw new ProtocolException( \"HTTP \" + code + \" had non-zero Content-Length: \" + response.body().contentLength()); &#125; return response;&#125; åœ¨ CallServerInterceptor ä¸­å¯è§ï¼Œå…³äºè¯·æ±‚å’Œå“åº”éƒ¨åˆ†éƒ½æ˜¯é€šè¿‡ HttpCodec æ¥å®ç°çš„ã€‚è€Œåœ¨ HttpCodec å†…éƒ¨åˆæ˜¯é€šè¿‡ sink å’Œ source æ¥å®ç°çš„ã€‚æ‰€ä»¥è¯´åˆ°åº•è¿˜æ˜¯ IO æµåœ¨èµ·ä½œç”¨ã€‚ ä¸Šé¢çš„æµç¨‹æˆ‘ä»¬æŠ“ä½ä¸»å¹²éƒ¨åˆ†ï¼š å‘æœåŠ¡å™¨å‘é€ request headerï¼› å¦‚æœæœ‰ request bodyï¼Œå°±å‘æœåŠ¡å™¨å‘é€ï¼› è¯»å– response headerï¼Œå…ˆæ„é€ ä¸€ä¸ª Response å¯¹è±¡ï¼› å¦‚æœæœ‰ response bodyï¼Œå°±åœ¨ 3 çš„åŸºç¡€ä¸ŠåŠ ä¸Š body æ„é€ ä¸€ä¸ªæ–°çš„ Response å¯¹è±¡ï¼› è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ ¸å¿ƒå·¥ä½œéƒ½ç”± HttpCodec å¯¹è±¡å®Œæˆï¼Œè€Œ HttpCodec å®é™…ä¸Šåˆ©ç”¨çš„æ˜¯ Okioï¼Œè€Œ Okio å®é™…ä¸Šè¿˜æ˜¯ç”¨çš„ Socketï¼Œæ‰€ä»¥æ²¡ä»€ä¹ˆç¥ç§˜çš„ï¼Œåªä¸è¿‡ä¸€å±‚å¥—ä¸€å±‚ï¼Œå±‚æ•°æœ‰ç‚¹å¤šã€‚ å°ç»“å…¶å® Interceptor çš„è®¾è®¡ä¹Ÿæ˜¯ä¸€ç§åˆ†å±‚çš„æ€æƒ³ï¼Œæ¯ä¸ª Interceptor å°±æ˜¯ä¸€å±‚ã€‚ä¸ºä»€ä¹ˆè¦å¥—è¿™ä¹ˆå¤šå±‚å‘¢ï¼Ÿåˆ†å±‚çš„æ€æƒ³åœ¨ TCP/IP åè®®ä¸­å°±ä½“ç°å¾—æ·‹æ¼“å°½è‡´ï¼Œåˆ†å±‚ç®€åŒ–äº†æ¯ä¸€å±‚çš„é€»è¾‘ï¼Œæ¯å±‚åªéœ€è¦å…³æ³¨è‡ªå·±çš„è´£ä»»ï¼ˆå•ä¸€åŸåˆ™æ€æƒ³ä¹Ÿåœ¨æ­¤ä½“ç°ï¼‰ï¼Œè€Œå„å±‚ä¹‹é—´é€šè¿‡çº¦å®šçš„æ¥å£/åè®®è¿›è¡Œåˆä½œï¼ˆé¢å‘æ¥å£ç¼–ç¨‹æ€æƒ³ï¼‰ï¼Œå…±åŒå®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå®Œå…¨æ˜ç™½äº† OkHttp ä¸­çš„åˆ†å±‚æ€æƒ³ï¼Œæ¯ä¸€ä¸ª interceptor åªå¤„ç†è‡ªå·±çš„äº‹ï¼Œè€Œå‰©ä½™çš„å°±äº¤ç»™å…¶ä»–çš„ interceptor ã€‚è¿™ç§æ€æƒ³å¯ä»¥ç®€åŒ–ä¸€äº›ç¹çå¤æ‚çš„æµç¨‹ï¼Œä»è€Œè¾¾åˆ°é€»è¾‘æ¸…æ™°ã€äº’ä¸å¹²æ‰°çš„æ•ˆæœã€‚ å¼‚æ­¥è¯·æ±‚ä¸åŒæ­¥è¯·æ±‚ç›´æ¥è°ƒç”¨RealCallçš„ execute() æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œå¼‚æ­¥è¯·æ±‚æ˜¯è°ƒç”¨äº† enqueue(Callback responseCallback) è¿™ä¸ªæ–¹æ³•ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯¹å¼‚æ­¥è¯·æ±‚æ¢ç©¶çš„å…¥å£å°±æ˜¯ enqueue(Callback responseCallback) äº†ã€‚ RealCall1234567891011@Overridepublic void enqueue(Callback responseCallback) &#123; synchronized (this) &#123; if (executed) throw new IllegalStateException(\"Already Executed\"); executed = true; &#125; captureCallStackTrace(); eventListener.callStart(this); // åŠ å…¥åˆ° dispatcher ä¸­ï¼Œè¿™é‡ŒåŒ…è£…æˆäº† AsyncCall client.dispatcher().enqueue(new AsyncCall(responseCallback));&#125; ä¸»è¦çš„æ–¹æ³•å°±æ˜¯è°ƒç”¨äº† Dispatcher çš„ enqueue(AsyncCall call) æ–¹æ³•ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¼ å…¥çš„æ˜¯ AsyncCall å¯¹è±¡ï¼Œè€Œä¸æ˜¯åŒæ­¥ä¸­çš„ RealCall ã€‚ Dispatcheræˆ‘ä»¬è·Ÿè¿›åˆ° Dispatcher çš„æºç ï¼Œè‡³äº AsyncCall æˆ‘ä»¬ä¼šåœ¨ä¸‹é¢è¯¦ç»†è®²åˆ°ã€‚ 1234567891011121314151617181920212223synchronized void enqueue(AsyncCall call) &#123; // å¦‚æœå½“å‰æ­£åœ¨è¿è¡Œçš„å¼‚æ­¥ call æ•° &lt; 64 &amp;&amp; é˜Ÿåˆ—ä¸­è¯·æ±‚åŒä¸€ä¸ª host çš„å¼‚æ­¥ call æ•° &lt; 5 // maxRequests = 64ï¼ŒmaxRequestsPerHost = 5 if (runningAsyncCalls.size() &lt; maxRequests &amp;&amp; runningCallsForHost(call) &lt; maxRequestsPerHost) &#123; // åŠ å…¥æ­£åœ¨è¿è¡Œå¼‚æ­¥é˜Ÿåˆ— runningAsyncCalls.add(call); // åŠ å…¥åˆ°çº¿ç¨‹æ± ä¸­ executorService().execute(call); &#125; else &#123; // åŠ å…¥é¢„å¤‡ç­‰å¾…çš„å¼‚æ­¥é˜Ÿåˆ— readyAsyncCalls.add(call); &#125;&#125;// åˆ›å»ºçº¿ç¨‹æ± public synchronized ExecutorService executorService() &#123; if (executorService == null) &#123; executorService = new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;(), Util.threadFactory(\"OkHttp Dispatcher\", false)); &#125; return executorService;&#125; ä» enqueue(AsyncCall call) ä¸­å¯ä»¥çŸ¥é“ï¼ŒOkHttp åœ¨è¿è¡Œä¸­çš„å¼‚æ­¥è¯·æ±‚æ•°æœ€å¤šä¸º 63 ï¼Œè€ŒåŒä¸€ä¸ª host çš„å¼‚æ­¥è¯·æ±‚æ•°æœ€å¤šä¸º 4 ã€‚å¦åˆ™ä¼šåŠ å…¥åˆ° readyAsyncCalls ä¸­ã€‚ åœ¨åŠ å…¥åˆ° runningAsyncCalls åï¼Œå°±ä¼šè¿›å…¥çº¿ç¨‹æ± ä¸­è¢«æ‰§è¡Œã€‚åˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬å°±è¦åˆ° AsyncCall ä¸­ä¸€æ¢ç©¶ç«Ÿäº†ã€‚ AsyncCallAsyncCallæ˜¯RealCallç±»ä¸­çš„å†…éƒ¨ç±»ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849final class AsyncCall extends NamedRunnable &#123; private final Callback responseCallback; AsyncCall(Callback responseCallback) &#123; super(\"OkHttp %s\", redactedUrl()); this.responseCallback = responseCallback; &#125; String host() &#123; return originalRequest.url().host(); &#125; Request request() &#123; return originalRequest; &#125; RealCall get() &#123; return RealCall.this; &#125; @Override protected void execute() &#123; boolean signalledCallback = false; try &#123; // è°ƒç”¨ä¸€è¿ä¸²çš„æ‹¦æˆªå™¨ï¼Œå¾—åˆ°å“åº” Response response = getResponseWithInterceptorChain(); if (retryAndFollowUpInterceptor.isCanceled()) &#123; // å›è°ƒå¤±è´¥ signalledCallback = true; responseCallback.onFailure(RealCall.this, new IOException(\"Canceled\")); &#125; else &#123; // å›è°ƒç»“æœ signalledCallback = true; responseCallback.onResponse(RealCall.this, response); &#125; &#125; catch (IOException e) &#123; if (signalledCallback) &#123; // Do not signal the callback twice! Platform.get().log(INFO, \"Callback failure for \" + toLoggableString(), e); &#125; else &#123; // å›è°ƒå¤±è´¥ eventListener.callFailed(RealCall.this, e); responseCallback.onFailure(RealCall.this, e); &#125; &#125; finally &#123; // åœ¨ runningAsyncCalls ä¸­ç§»é™¤ï¼Œå¹¶æ¨è¿›å…¶ä»– call çš„å·¥ä½œ client.dispatcher().finished(this); &#125; &#125;&#125; åœ¨ AsyncCall çš„ execute() æ–¹æ³•ä¸­ï¼Œä¹Ÿæ˜¯è°ƒç”¨äº† getResponseWithInterceptorChain() æ–¹æ³•æ¥å¾—åˆ° Response å¯¹è±¡ã€‚ä»è¿™é‡Œå¼€å§‹ï¼Œå°±å’ŒåŒæ­¥è¯·æ±‚çš„æµç¨‹æ˜¯ä¸€æ ·çš„ï¼Œå°±æ²¡å¿…è¦è®²äº†ã€‚ åœ¨å¾—åˆ° Response åï¼Œè¿›è¡Œç»“æœçš„å›è°ƒã€‚æœ€åï¼Œè°ƒç”¨äº† Dispatcher çš„ finished æ–¹æ³•ï¼š 123456789101112131415161718192021//Dispatcherç±»void finished(RealCall.AsyncCall call) &#123; finished(runningAsyncCalls, call, true);&#125;private &lt;T&gt; void finished(Deque&lt;T&gt; calls, T call, boolean promoteCalls) &#123; int runningCallsCount; Runnable idleCallback; synchronized (this) &#123; // ç§»é™¤è¯¥ call if (!calls.remove(call)) throw new AssertionError(\"Call wasn't in-flight!\"); // å°† readyAsyncCalls ä¸­çš„ call ç§»åŠ¨åˆ° runningAsyncCalls ä¸­ï¼Œå¹¶åŠ å…¥åˆ°çº¿ç¨‹æ± ä¸­ if (promoteCalls) promoteCalls(); runningCallsCount = runningCallsCount(); idleCallback = this.idleCallback; &#125; if (runningCallsCount == 0 &amp;&amp; idleCallback != null) &#123; idleCallback.run(); &#125;&#125; æ€»ç»“OkHttp ä½œä¸ºä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ HTTP å®¢æˆ·ç«¯ï¼Œå¯ä»¥åœ¨ Java å’Œ Android ç¨‹åºä¸­ä½¿ç”¨ã€‚ç›¸å¯¹äº Apache HttpClient æ¥è¯´ï¼ŒOkHttp çš„æ€§èƒ½æ›´å¥½ï¼Œå…¶ API è®¾è®¡ä¹Ÿæ›´åŠ ç®€å•å®ç”¨ã€‚ åœ¨æ–‡ç« æœ€åæˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹å®Œæ•´çš„æµç¨‹å›¾ï¼š OkHttpClient å®ç° Call.Factoryï¼Œè´Ÿè´£ä¸º Request åˆ›å»º Callï¼› RealCall ä¸ºå…·ä½“çš„ Call å®ç°ï¼Œå…¶ enqueue() å¼‚æ­¥æ¥å£é€šè¿‡ Dispatcher åˆ©ç”¨ ExecutorService å®ç°ï¼Œè€Œæœ€ç»ˆè¿›è¡Œç½‘ç»œè¯·æ±‚æ—¶å’ŒåŒæ­¥ execute() æ¥å£ä¸€è‡´ï¼Œéƒ½æ˜¯é€šè¿‡ getResponseWithInterceptorChain() å‡½æ•°å®ç°ï¼› getResponseWithInterceptorChain() ä¸­åˆ©ç”¨ Interceptor é“¾æ¡ï¼Œåˆ†å±‚å®ç°é‡è¯•é‡å®šå‘ã€ç¼“å­˜ã€é€æ˜å‹ç¼©ã€ç½‘ç»œ IO ç­‰åŠŸèƒ½ï¼› HTTP è¿æ¥è™½ç„¶åœ¨ä½¿ç”¨ OkHttp å‘é€ HTTP è¯·æ±‚æ—¶åªéœ€è¦æä¾› URL å³å¯ï¼ŒOkHttp åœ¨å®ç°ä¸­éœ€è¦ç»¼åˆè€ƒè™‘ 3 ç§ä¸åŒçš„è¦ç´ æ¥ç¡®å®šä¸ HTTP æœåŠ¡å™¨ä¹‹é—´å®é™…å»ºç«‹çš„ HTTP è¿æ¥ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†è¾¾åˆ°æœ€ä½³çš„æ€§èƒ½ã€‚ é¦–å…ˆç¬¬ä¸€ä¸ªè€ƒè™‘çš„è¦ç´ æ˜¯ URL æœ¬èº«ã€‚URL ç»™å‡ºäº†è¦è®¿é—®çš„èµ„æºçš„è·¯å¾„ã€‚æ¯”å¦‚ URL http://www.baidu.com æ‰€å¯¹åº”çš„æ˜¯ç™¾åº¦é¦–é¡µçš„ HTTP æ–‡æ¡£ã€‚åœ¨ URL ä¸­æ¯”è¾ƒé‡è¦çš„éƒ¨åˆ†æ˜¯è®¿é—®æ—¶ä½¿ç”¨çš„æ¨¡å¼ï¼Œå³ HTTP è¿˜æ˜¯ HTTPSã€‚è¿™ä¼šç¡®å®š OkHttp æ‰€å»ºç«‹çš„æ˜¯æ˜æ–‡çš„ HTTP è¿æ¥ï¼Œè¿˜æ˜¯åŠ å¯†çš„ HTTPS è¿æ¥ã€‚ ç¬¬äºŒä¸ªè¦ç´ æ˜¯ HTTP æœåŠ¡å™¨çš„åœ°å€ï¼Œå¦‚ baidu.comã€‚æ¯ä¸ªåœ°å€éƒ½æœ‰å¯¹åº”çš„é…ç½®ï¼ŒåŒ…æ‹¬ç«¯å£å·ï¼ŒHTTPS è¿æ¥è®¾ç½®å’Œç½‘ç»œä¼ è¾“åè®®ã€‚åŒä¸€ä¸ªåœ°å€ä¸Šçš„ URL å¯ä»¥å…±äº«åŒä¸€ä¸ªåº•å±‚ TCP å¥—æ¥å­—è¿æ¥ã€‚é€šè¿‡å…±äº«è¿æ¥å¯ä»¥æœ‰æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚OkHttp æä¾›äº†ä¸€ä¸ªè¿æ¥æ± æ¥å¤ç”¨è¿æ¥ã€‚ ç¬¬ä¸‰ä¸ªè¦ç´ æ˜¯è¿æ¥ HTTP æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„è·¯ç”±ã€‚è·¯ç”±åŒ…æ‹¬å…·ä½“è¿æ¥çš„ IP åœ°å€ï¼ˆé€šè¿‡ DNS æŸ¥è¯¢æ¥å‘ç°ï¼‰å’Œæ‰€ä½¿ç”¨çš„ä»£ç†æœåŠ¡å™¨ã€‚å¯¹äº HTTPS è¿æ¥è¿˜åŒ…æ‹¬é€šè®¯åå•†æ—¶ä½¿ç”¨çš„ TLS ç‰ˆæœ¬ã€‚å¯¹äºåŒä¸€ä¸ªåœ°å€ï¼Œå¯èƒ½æœ‰å¤šä¸ªä¸åŒçš„è·¯ç”±ã€‚OkHttp åœ¨é‡åˆ°è®¿é—®é”™è¯¯æ—¶ä¼šè‡ªåŠ¨å°è¯•å¤‡é€‰è·¯ç”±ã€‚ å½“é€šè¿‡ OkHttp æ¥è¯·æ±‚æŸä¸ª URL æ—¶ï¼ŒOkHttp é¦–å…ˆä» URL ä¸­å¾—åˆ°åœ°å€ä¿¡æ¯ï¼Œå†ä»è¿æ¥æ± ä¸­æ ¹æ®åœ°å€æ¥è·å–è¿æ¥ã€‚å¦‚æœåœ¨è¿æ¥æ± ä¸­æ²¡æœ‰æ‰¾åˆ°è¿æ¥ï¼Œåˆ™é€‰æ‹©ä¸€ä¸ªè·¯ç”±æ¥å°è¯•è¿æ¥ã€‚å°è¯•è¿æ¥éœ€è¦é€šè¿‡ DNS æŸ¥è¯¢æ¥å¾—åˆ°æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œä¹Ÿä¼šç”¨åˆ°ä»£ç†æœåŠ¡å™¨å’Œ TLS ç‰ˆæœ¬ç­‰ä¿¡æ¯ã€‚å½“å®é™…çš„è¿æ¥å»ºç«‹ä¹‹åï¼ŒOkHttp å‘é€ HTTP è¯·æ±‚å¹¶è·å–å“åº”ã€‚å½“è¿æ¥å‡ºç°é—®é¢˜æ—¶ï¼ŒOkHttp ä¼šè‡ªåŠ¨é€‰æ‹©å¦å¤–çš„è·¯ç”±è¿›è¡Œå°è¯•ã€‚è¿™ä½¿å¾— OkHttp å¯ä»¥è‡ªåŠ¨å¤„ç†å¯èƒ½å‡ºç°çš„ç½‘ç»œé—®é¢˜ã€‚å½“æˆåŠŸè·å–åˆ° HTTP è¯·æ±‚çš„å“åº”ä¹‹åï¼Œå½“å‰çš„è¿æ¥ä¼šè¢«æ”¾å›åˆ°è¿æ¥æ± ä¸­ï¼Œæä¾›ç»™åç»­çš„è¯·æ±‚æ¥å¤ç”¨ã€‚è¿æ¥æ± ä¼šå®šæœŸæŠŠé—²ç½®çš„è¿æ¥å…³é—­ä»¥é‡Šæ”¾èµ„æºã€‚ å‚è€ƒèµ„æ–™ OkHttpçš„åˆå§‹åŒ– OKHttpæºç è§£æ OkHttpæºç è§£æ - yuqirong.me æ‹†è½®å­ç³»åˆ—ï¼šæ‹†OkHttp OkHttpï¼šJava å¹³å°ä¸Šçš„æ–°ä¸€ä»£ HTTP å®¢æˆ·ç«¯ - IBM DeveloperWorks Androidä¸»æµç½‘ç»œè¯·æ±‚å¼€æºåº“çš„å¯¹æ¯”ï¼ˆAndroid-Async-Httpã€Volleyã€OkHttpã€Retrofitï¼‰ OkHttp, Retrofit, Volleyåº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªï¼Ÿ","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"},{"name":"æºç åˆ†æ","slug":"Android/æºç åˆ†æ","permalink":"http://github.com/categories/Android/æºç åˆ†æ/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"http://github.com/tags/æºç åˆ†æ/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"},{"name":"æºç åˆ†æ","slug":"Android/æºç åˆ†æ","permalink":"http://github.com/categories/Android/æºç åˆ†æ/"}]},{"title":"ç”¨Javaå®ç°æ–­ç‚¹ç»­ä¼  (HTTP)","slug":"ç”¨Javaå®ç°æ–­ç‚¹ç»­ä¼  (HTTP)","date":"2018-01-22T04:30:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2018/01/22/ç”¨Javaå®ç°æ–­ç‚¹ç»­ä¼  (HTTP)/","link":"","permalink":"http://github.com/2018/01/22/ç”¨Javaå®ç°æ–­ç‚¹ç»­ä¼  (HTTP)/","excerpt":"æ–­ç‚¹ç»­ä¼ çš„åŸç†å…¶å®æ–­ç‚¹ç»­ä¼ çš„åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ Http çš„è¯·æ±‚ä¸Šå’Œä¸€èˆ¬çš„ä¸‹è½½æœ‰æ‰€ä¸åŒè€Œå·²ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œæµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªæ–‡æ—¶ï¼Œæ‰€å‘å‡ºçš„è¯·æ±‚å¦‚ä¸‹ï¼šå‡è®¾æœåŠ¡å™¨åŸŸåä¸º www.sjtu.edu.cnï¼Œæ–‡ä»¶åä¸º down.zipã€‚ 1234567GET /down.zip HTTP/1.1 Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/vnd.ms- excel, application/msword, application/vnd.ms-powerpoint, */* Accept-Language: zh-cn Accept-Encoding: gzip, deflate User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0) Connection: Keep-Alive æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼ŒæŒ‰è¦æ±‚å¯»æ‰¾è¯·æ±‚çš„æ–‡ä»¶ï¼Œæå–æ–‡ä»¶çš„ä¿¡æ¯ï¼Œç„¶åè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿”å›ä¿¡æ¯å¦‚ä¸‹ï¼š12345678200 Content-Length=106786028 Accept-Ranges=bytes Date=Mon, 30 Apr 2001 12:56:11 GMT ETag=W/&quot;02ca57e173c11:95b&quot; Content-Type=application/octet-stream Server=Microsoft-IIS/5.0 Last-Modified=Mon, 30 Apr 2001 12:56:11 GMT","text":"æ–­ç‚¹ç»­ä¼ çš„åŸç†å…¶å®æ–­ç‚¹ç»­ä¼ çš„åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ Http çš„è¯·æ±‚ä¸Šå’Œä¸€èˆ¬çš„ä¸‹è½½æœ‰æ‰€ä¸åŒè€Œå·²ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œæµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªæ–‡æ—¶ï¼Œæ‰€å‘å‡ºçš„è¯·æ±‚å¦‚ä¸‹ï¼šå‡è®¾æœåŠ¡å™¨åŸŸåä¸º www.sjtu.edu.cnï¼Œæ–‡ä»¶åä¸º down.zipã€‚ 1234567GET /down.zip HTTP/1.1 Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/vnd.ms- excel, application/msword, application/vnd.ms-powerpoint, */* Accept-Language: zh-cn Accept-Encoding: gzip, deflate User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0) Connection: Keep-Alive æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼ŒæŒ‰è¦æ±‚å¯»æ‰¾è¯·æ±‚çš„æ–‡ä»¶ï¼Œæå–æ–‡ä»¶çš„ä¿¡æ¯ï¼Œç„¶åè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿”å›ä¿¡æ¯å¦‚ä¸‹ï¼š12345678200 Content-Length=106786028 Accept-Ranges=bytes Date=Mon, 30 Apr 2001 12:56:11 GMT ETag=W/&quot;02ca57e173c11:95b&quot; Content-Type=application/octet-stream Server=Microsoft-IIS/5.0 Last-Modified=Mon, 30 Apr 2001 12:56:11 GMT æ‰€è°“æ–­ç‚¹ç»­ä¼ ï¼Œä¹Ÿå°±æ˜¯è¦ä»æ–‡ä»¶å·²ç»ä¸‹è½½çš„åœ°æ–¹å¼€å§‹ç»§ç»­ä¸‹è½½ã€‚æ‰€ä»¥åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¼ ç»™ Web æœåŠ¡å™¨çš„æ—¶å€™è¦å¤šåŠ ä¸€æ¡ä¿¡æ¯ â€“ ä»å“ªé‡Œå¼€å§‹ã€‚ä¸‹é¢æ˜¯ç”¨è‡ªå·±ç¼–çš„ä¸€ä¸ªâ€æµè§ˆå™¨â€æ¥ä¼ é€’è¯·æ±‚ä¿¡æ¯ç»™ Web æœåŠ¡å™¨ï¼Œè¦æ±‚ä» 2000070 å­—èŠ‚å¼€å§‹ã€‚ 1234GET /down.zip HTTP/1.0 User-Agent: NetFox RANGE: bytes=2000070- Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 ä»”ç»†çœ‹ä¸€ä¸‹å°±ä¼šå‘ç°å¤šäº†ä¸€è¡Œ RANGE: bytes=2000070-è¿™ä¸€è¡Œçš„æ„æ€å°±æ˜¯å‘Šè¯‰æœåŠ¡å™¨ down.zip è¿™ä¸ªæ–‡ä»¶ä» 2000070 å­—èŠ‚å¼€å§‹ä¼ ï¼Œå‰é¢çš„å­—èŠ‚ä¸ç”¨ä¼ äº†ã€‚æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä»¥åï¼Œè¿”å›çš„ä¿¡æ¯å¦‚ä¸‹ï¼š12345678206 Content-Length=106786028 Content-Range=bytes 2000070-106786027/106786028 Date=Mon, 30 Apr 2001 12:55:20 GMT ETag=W/&quot;02ca57e173c11:95b&quot; Content-Type=application/octet-stream Server=Microsoft-IIS/5.0 Last-Modified=Mon, 30 Apr 2001 12:55:20 GMT å’Œå‰é¢æœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯æ¯”è¾ƒä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°å¢åŠ äº†ä¸€è¡Œï¼š Content-Range=bytes 2000070-106786027/106786028ï¼Œè¿”å›çš„ä»£ç ä¹Ÿæ”¹ä¸º 206 äº†ï¼Œè€Œä¸å†æ˜¯ 200 äº†ã€‚ çŸ¥é“äº†ä»¥ä¸ŠåŸç†ï¼Œå°±å¯ä»¥è¿›è¡Œæ–­ç‚¹ç»­ä¼ çš„ç¼–ç¨‹äº†ã€‚ Java å®ç°æ–­ç‚¹ç»­ä¼ çš„å…³é”®å‡ ç‚¹ ç”¨ä»€ä¹ˆæ–¹æ³•å®ç°æäº¤RANGE: bytes=2000070- å½“ç„¶ç”¨æœ€åŸå§‹çš„ Socket æ˜¯è‚¯å®šèƒ½å®Œæˆçš„ï¼Œä¸è¿‡é‚£æ ·å¤ªè´¹äº‹äº†ï¼Œå…¶å® Java çš„ net åŒ…ä¸­æä¾›äº†è¿™ç§åŠŸèƒ½ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112URL url = new URL(\"http://www.sjtu.edu.cn/down.zip\");HttpURLConnection httpConnection = (HttpURLConnection)url.openConnection();// è®¾ç½® User-AgenthttpConnection.setRequestProperty(\"User-Agent\",\"NetFox\");// è®¾ç½®æ–­ç‚¹ç»­ä¼ çš„å¼€å§‹ä½ç½®httpConnection.setRequestProperty(\"RANGE\",\"bytes=2000070\");// è·å¾—è¾“å…¥æµInputStream input = httpConnection.getInputStream(); ä»è¾“å…¥æµä¸­å–å‡ºçš„å­—èŠ‚æµå°±æ˜¯ down.zip æ–‡ä»¶ä» 2000070 å¼€å§‹çš„å­—èŠ‚æµã€‚ å¤§å®¶çœ‹ï¼Œå…¶å®æ–­ç‚¹ç»­ä¼ ç”¨ Java å®ç°èµ·æ¥è¿˜æ˜¯å¾ˆç®€å•çš„å§ã€‚ æ¥ä¸‹æ¥è¦åšçš„äº‹å°±æ˜¯æ€ä¹ˆä¿å­˜è·å¾—çš„æµåˆ°æ–‡ä»¶ä¸­å»äº†ã€‚ ä¿å­˜æ–‡ä»¶é‡‡ç”¨çš„æ–¹æ³•ã€‚æˆ‘é‡‡ç”¨çš„æ˜¯ IO åŒ…ä¸­çš„ RandAccessFile ç±»ã€‚æ“ä½œç›¸å½“ç®€å•ï¼Œå‡è®¾ä» 2000070 å¤„å¼€å§‹ä¿å­˜æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112RandomAccess oSavedFile = new RandomAccessFile(\"down.zip\",\"rw\"); long nPos = 2000070; // å®šä½æ–‡ä»¶æŒ‡é’ˆåˆ° nPos ä½ç½® oSavedFile.seek(nPos); byte[] b = new byte[1024]; int nRead; // ä»è¾“å…¥æµä¸­è¯»å…¥å­—èŠ‚æµï¼Œç„¶åå†™åˆ°æ–‡ä»¶ä¸­ while((nRead=input.read(b,0,1024)) &gt; 0) &#123; oSavedFile.write(b,0,nRead); &#125; æ€ä¹ˆæ ·ï¼Œä¹Ÿå¾ˆç®€å•å§ã€‚ æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯æ•´åˆæˆä¸€ä¸ªå®Œæ•´çš„ç¨‹åºäº†ã€‚åŒ…æ‹¬ä¸€ç³»åˆ—çš„çº¿ç¨‹æ§åˆ¶ç­‰ç­‰ã€‚ æ–­ç‚¹ç»­ä¼ å†…æ ¸çš„å®ç°ä¸»è¦ç”¨äº† 6 ä¸ªç±»ï¼ŒåŒ…æ‹¬ä¸€ä¸ªæµ‹è¯•ç±»ã€‚ SiteFileFetch.java è´Ÿè´£æ•´ä¸ªæ–‡ä»¶çš„æŠ“å–ï¼Œæ§åˆ¶å†…éƒ¨çº¿ç¨‹ (FileSplitterFetch ç±» )ã€‚ FileSplitterFetch.java è´Ÿè´£éƒ¨åˆ†æ–‡ä»¶çš„æŠ“å–ã€‚ FileAccess.java è´Ÿè´£æ–‡ä»¶çš„å­˜å‚¨ã€‚ SiteInfoBean.java è¦æŠ“å–çš„æ–‡ä»¶çš„ä¿¡æ¯ï¼Œå¦‚æ–‡ä»¶ä¿å­˜çš„ç›®å½•ï¼Œåå­—ï¼ŒæŠ“å–æ–‡ä»¶çš„ URL ç­‰ã€‚ Utility.java å·¥å…·ç±»ï¼Œæ”¾ä¸€äº›ç®€å•çš„æ–¹æ³•ã€‚ TestMethod.java æµ‹è¯•ç±»ã€‚ æˆ‘ä»¬æ¥åˆ†åˆ«çœ‹çœ‹ä»£ç ï¼š SiteFileFetch.java 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167/** * SiteFileFetch.java */package NetFox;import java.io.*;import java.net.*;public class SiteFileFetch extends Thread &#123; SiteInfoBean siteInfoBean = null; // æ–‡ä»¶ä¿¡æ¯ Bean long[] nStartPos; // å¼€å§‹ä½ç½® long[] nEndPos; // ç»“æŸä½ç½® FileSplitterFetch[] fileSplitterFetch; // å­çº¿ç¨‹å¯¹è±¡ long nFileLength; // æ–‡ä»¶é•¿åº¦ boolean bFirst = true; // æ˜¯å¦ç¬¬ä¸€æ¬¡å–æ–‡ä»¶ boolean bStop = false; // åœæ­¢æ ‡å¿— File tmpFile; // æ–‡ä»¶ä¸‹è½½çš„ä¸´æ—¶ä¿¡æ¯ DataOutputStream output; // è¾“å‡ºåˆ°æ–‡ä»¶çš„è¾“å‡ºæµ public SiteFileFetch(SiteInfoBean bean) throws IOException &#123; siteInfoBean = bean; //tmpFile = File.createTempFile (\"zhong\",\"1111\",new File(bean.getSFilePath())); tmpFile = new File(bean.getSFilePath()+File.separator + bean.getSFileName()+\".info\"); if(tmpFile.exists ()) &#123; bFirst = false; read_nPos(); &#125; else &#123; nStartPos = new long[bean.getNSplitter()]; nEndPos = new long[bean.getNSplitter()]; &#125; &#125; public void run() &#123; // è·å¾—æ–‡ä»¶é•¿åº¦ // åˆ†å‰²æ–‡ä»¶ // å®ä¾‹ FileSplitterFetch // å¯åŠ¨ FileSplitterFetch çº¿ç¨‹ // ç­‰å¾…å­çº¿ç¨‹è¿”å› try&#123; if(bFirst)&#123; nFileLength = getFileSize(); if(nFileLength == -1)&#123; System.err.println(\"File Length is not known!\"); &#125;else if(nFileLength == -2)&#123; System.err.println(\"File is not access!\"); &#125;else&#123; for(int i=0;i&lt;nStartPos.length;i++)&#123; nStartPos[i] = (long)(i*(nFileLength/nStartPos.length)); &#125; for(int i=0;i&lt;nEndPos.length-1;i++)&#123; nEndPos[i] = nStartPos[i+1]; &#125; nEndPos[nEndPos.length-1] = nFileLength; &#125; &#125; // å¯åŠ¨å­çº¿ç¨‹ fileSplitterFetch = new FileSplitterFetch[nStartPos.length]; for(int i=0;i&lt;nStartPos.length;i++)&#123; fileSplitterFetch[i] = new FileSplitterFetch(siteInfoBean.getSSiteURL(), siteInfoBean.getSFilePath() + File.separator + siteInfoBean.getSFileName(), nStartPos[i],nEndPos[i],i); Utility.log(\"Thread \" + i + \" , nStartPos = \" + nStartPos[i] + \", nEndPos = \" + nEndPos[i]); fileSplitterFetch[i].start(); &#125; // fileSplitterFetch[nPos.length-1] = new FileSplitterFetch(siteInfoBean.getSSiteURL(), siteInfoBean.getSFilePath() + File.separator + siteInfoBean.getSFileName(),nPos[nPos.length-1],nFileLength,nPos.length-1); // Utility.log(\"Thread \" +(nPos.length-1) + \",nStartPos = \"+nPos[nPos.length-1]+\", nEndPos = \" + nFileLength); // fileSplitterFetch[nPos.length-1].start(); // ç­‰å¾…å­çº¿ç¨‹ç»“æŸ //int count = 0; // æ˜¯å¦ç»“æŸ while å¾ªç¯ boolean breakWhile = false; while(!bStop)&#123; write_nPos(); Utility.sleep(500); breakWhile = true; for(int i=0;i&lt;nStartPos.length;i++)&#123; if(!fileSplitterFetch[i].bDownOver)&#123; breakWhile = false; break; &#125; &#125; if(breakWhile) break; //count++; //if(count&gt;4) // siteStop(); &#125; System.err.println(\"æ–‡ä»¶ä¸‹è½½ç»“æŸï¼\"); &#125;catch(Exception e)&#123; e.printStackTrace (); &#125; &#125; // è·å¾—æ–‡ä»¶é•¿åº¦ public long getFileSize()&#123; int nFileLength = -1; try&#123; URL url = new URL(siteInfoBean.getSSiteURL()); HttpURLConnection httpConnection = (HttpURLConnection)url.openConnection (); httpConnection.setRequestProperty(\"User-Agent\",\"NetFox\"); int responseCode=httpConnection.getResponseCode(); if(responseCode&gt;=400)&#123; processErrorCode(responseCode); return -2; //-2 represent access is error &#125; String sHeader; for(int i=1;;i++)&#123; //DataInputStream in = new DataInputStream(httpConnection.getInputStream ()); //Utility.log(in.readLine()); sHeader=httpConnection.getHeaderFieldKey(i); if(sHeader!=null)&#123; if(sHeader.equals(\"Content-Length\"))&#123; nFileLength = Integer.parseInt(httpConnection.getHeaderField(sHeader)); break; &#125; &#125; else break; &#125; &#125; catch(IOException e)&#123;e.printStackTrace ();&#125; catch(Exception e)&#123;e.printStackTrace ();&#125; Utility.log(nFileLength); return nFileLength; &#125; // ä¿å­˜ä¸‹è½½ä¿¡æ¯ï¼ˆæ–‡ä»¶æŒ‡é’ˆä½ç½®ï¼‰ private void write_nPos()&#123; try&#123; output = new DataOutputStream(new FileOutputStream(tmpFile)); output.writeInt(nStartPos.length); for(int i=0;i&lt;nStartPos.length;i++)&#123; // output.writeLong(nPos[i]); output.writeLong(fileSplitterFetch[i].nStartPos); output.writeLong(fileSplitterFetch[i].nEndPos); &#125; output.close(); &#125; catch(IOException e)&#123;e.printStackTrace ();&#125; catch(Exception e)&#123;e.printStackTrace ();&#125; &#125; // è¯»å–ä¿å­˜çš„ä¸‹è½½ä¿¡æ¯ï¼ˆæ–‡ä»¶æŒ‡é’ˆä½ç½®ï¼‰ private void read_nPos()&#123; try&#123; DataInputStream input = new DataInputStream(new FileInputStream(tmpFile)); int nCount = input.readInt(); nStartPos = new long[nCount]; nEndPos = new long[nCount]; for(int i=0;i&lt;nStartPos.length;i++)&#123; nStartPos[i] = input.readLong(); nEndPos[i] = input.readLong(); &#125; input.close(); &#125; catch(IOException e)&#123;e.printStackTrace ();&#125; catch(Exception e)&#123;e.printStackTrace ();&#125; &#125; private void processErrorCode(int nErrorCode)&#123; System.err.println(\"Error Code : \" + nErrorCode); &#125; // åœæ­¢æ–‡ä»¶ä¸‹è½½ public void siteStop()&#123; bStop = true; for(int i=0;i&lt;nStartPos.length;i++) fileSplitterFetch[i].splitterStop(); &#125;&#125; FileSplitterFetch.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364/** *FileSplitterFetch.java */package NetFox;import java.io.*;import java.net.*;public class FileSplitterFetch extends Thread &#123; String sURL; //File URL long nStartPos; //File Snippet Start Position long nEndPos; //File Snippet End Position int nThreadID; //Thread's ID boolean bDownOver = false; //Downing is over boolean bStop = false; //Stop identical FileAccessI fileAccessI = null; //File Access interface public FileSplitterFetch(String sURL,String sName,long nStart,long nEnd,int id) throws IOException &#123; this.sURL = sURL; this.nStartPos = nStart; this.nEndPos = nEnd; nThreadID = id; fileAccessI = new FileAccessI(sName,nStartPos); &#125; public void run()&#123; while(nStartPos &lt; nEndPos &amp;&amp; !bStop)&#123; try&#123; URL url = new URL(sURL); HttpURLConnection httpConnection = (HttpURLConnection)url.openConnection (); httpConnection.setRequestProperty(\"User-Agent\",\"NetFox\"); String sProperty = \"bytes=\"+nStartPos+\"-\"; httpConnection.setRequestProperty(\"RANGE\",sProperty); Utility.log(sProperty); InputStream input = httpConnection.getInputStream(); //logResponseHead(httpConnection); byte[] b = new byte[1024]; int nRead; while((nRead=input.read(b,0,1024)) &gt; 0 &amp;&amp; nStartPos &lt; nEndPos &amp;&amp; !bStop) &#123; nStartPos += fileAccessI.write(b,0,nRead); //if(nThreadID == 1) // Utility.log(\"nStartPos = \" + nStartPos + \", nEndPos = \" + nEndPos); &#125; Utility.log(\"Thread \" + nThreadID + \" is over!\"); bDownOver = true; //nPos = fileAccessI.write (b,0,nRead); &#125; catch(Exception e)&#123;e.printStackTrace ();&#125; &#125; &#125; // æ‰“å°å›åº”çš„å¤´ä¿¡æ¯ public void logResponseHead(HttpURLConnection con) &#123; for(int i=1;;i++)&#123; String header=con.getHeaderFieldKey(i); if(header!=null) //responseHeaders.put(header,httpConnection.getHeaderField(header)); Utility.log(header+\" : \"+con.getHeaderField(header)); else break; &#125; &#125; public void splitterStop()&#123; bStop = true; &#125;&#125; FileAccess.java 123456789101112131415161718192021222324252627/** *FileAccess.java */package NetFox;import java.io.*;public class FileAccessI implements Serializable&#123; RandomAccessFile oSavedFile; long nPos; public FileAccessI() throws IOException&#123; this(\"\",0); &#125; public FileAccessI(String sName,long nPos) throws IOException&#123; oSavedFile = new RandomAccessFile(sName,\"rw\"); this.nPos = nPos; oSavedFile.seek(nPos); &#125; public synchronized int write(byte[] b,int nStart,int nLen)&#123; int n = -1; try&#123; oSavedFile.write(b,nStart,nLen); n = nLen; &#125;catch(IOException e)&#123; e.printStackTrace (); &#125; return n; &#125;&#125; SiteInfoBean.java 1234567891011121314151617181920212223242526272829303132333435363738394041424344/** *SiteInfoBean.java */package NetFox;public class SiteInfoBean &#123; private String sSiteURL; //Site's URL private String sFilePath; //Saved File's Path private String sFileName; //Saved File's Name private int nSplitter; //Count of Splited Downloading File public SiteInfoBean() &#123; //default value of nSplitter is 5 this(\"\",\"\",\"\",5); &#125; public SiteInfoBean(String sURL,String sPath,String sName,int nSpiltter) &#123; sSiteURL= sURL; sFilePath = sPath; sFileName = sName; this.nSplitter = nSpiltter; &#125; public String getSSiteURL() &#123; return sSiteURL; &#125; public void setSSiteURL(String value) &#123; sSiteURL = value; &#125; public String getSFilePath() &#123; return sFilePath; &#125; public void setSFilePath(String value) &#123; sFilePath = value; &#125; public String getSFileName() &#123; return sFileName; &#125; public void setSFileName(String value) &#123; sFileName = value; &#125; public int getNSplitter() &#123; return nSplitter; &#125; public void setNSplitter(int nCount) &#123; nSplitter = nCount; &#125;&#125; Utility.java 12345678910111213141516171819202122/** *Utility.java */package NetFox;public class Utility &#123; public Utility() &#123;&#125; public static void sleep(int nSecond) &#123; try&#123; Thread.sleep(nSecond); &#125; catch(Exception e) &#123; e.printStackTrace (); &#125; &#125; public static void log(String sMsg) &#123; System.err.println(sMsg); &#125; public static void log(int sMsg) &#123; System.err.println(sMsg); &#125;&#125; TestMethod.java 12345678910111213141516171819202122/** *TestMethod.java */package NetFox;public class TestMethod &#123; public TestMethod() &#123; ///xx/weblogic60b2_win.exe try&#123; SiteInfoBean bean = new SiteInfoBean(\"http://localhost/xx/weblogic60b2_win.exe\", \"L:\\\\temp\",\"weblogic60b2_win.exe\",5); //SiteInfoBean bean = new SiteInfoBean(\"http://localhost:8080/down.zip\",\"L:\\\\temp\", \"weblogic60b2_win.exe\",5); SiteFileFetch fileFetch = new SiteFileFetch(bean); fileFetch.start(); &#125; catch(Exception e) &#123; e.printStackTrace (); &#125; &#125; public static void main(String[] args) &#123; new TestMethod(); &#125;&#125; å‚è€ƒèµ„æ–™ ç”¨ Java å®ç°æ–­ç‚¹ç»­ä¼  (HTTP) - IBM DeveloperWorks","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"å¦‚ä½•åˆ¤æ–­CPUæ˜¯å¤§ç«¯è¿˜æ˜¯å°ç«¯æ¨¡å¼","slug":"å¦‚ä½•åˆ¤æ–­CPUæ˜¯å¤§ç«¯è¿˜æ˜¯å°ç«¯æ¨¡å¼","date":"2018-01-18T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2018/01/18/å¦‚ä½•åˆ¤æ–­CPUæ˜¯å¤§ç«¯è¿˜æ˜¯å°ç«¯æ¨¡å¼/","link":"","permalink":"http://github.com/2018/01/18/å¦‚ä½•åˆ¤æ–­CPUæ˜¯å¤§ç«¯è¿˜æ˜¯å°ç«¯æ¨¡å¼/","excerpt":"ä¸€ã€æ¦‚å¿µåŠè¯¦è§£åœ¨å„ç§ä½“ç³»çš„è®¡ç®—æœºä¸­é€šå¸¸é‡‡ç”¨çš„å­—èŠ‚å­˜å‚¨æœºåˆ¶ä¸»è¦æœ‰ä¸¤ç§ï¼š Big-Endianå’ŒLittle-Endianï¼Œå³å¤§ç«¯æ¨¡å¼å’Œå°ç«¯æ¨¡å¼ã€‚ Big-Endianå’ŒLittle-Endiançš„å®šä¹‰å¦‚ä¸‹ï¼š 1) Little-Endianï¼šå°±æ˜¯ä½ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œé«˜ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„é«˜åœ°å€ç«¯ã€‚2) Big-Endianï¼šå°±æ˜¯é«˜ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œä½ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„é«˜åœ°å€ç«¯ã€‚ ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæ¯”å¦‚16è¿›åˆ¶æ•°å­—0x12345678åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºå½¢å¼ä¸ºï¼š å¤§ç«¯å°ç«¯æ²¡æœ‰è°ä¼˜è°åŠ£ï¼Œå„è‡ªä¼˜åŠ¿ä¾¿æ˜¯å¯¹æ–¹åŠ£åŠ¿ï¼š å°ç«¯æ¨¡å¼ ï¼šå¼ºåˆ¶è½¬æ¢æ•°æ®ä¸éœ€è¦è°ƒæ•´å­—èŠ‚å†…å®¹ï¼Œ1ã€2ã€4å­—èŠ‚çš„å­˜å‚¨æ–¹å¼ä¸€æ ·ã€‚å¤§ç«¯æ¨¡å¼ ï¼šç¬¦å·ä½çš„åˆ¤å®šå›ºå®šä¸ºç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå®¹æ˜“åˆ¤æ–­æ­£è´Ÿã€‚","text":"ä¸€ã€æ¦‚å¿µåŠè¯¦è§£åœ¨å„ç§ä½“ç³»çš„è®¡ç®—æœºä¸­é€šå¸¸é‡‡ç”¨çš„å­—èŠ‚å­˜å‚¨æœºåˆ¶ä¸»è¦æœ‰ä¸¤ç§ï¼š Big-Endianå’ŒLittle-Endianï¼Œå³å¤§ç«¯æ¨¡å¼å’Œå°ç«¯æ¨¡å¼ã€‚ Big-Endianå’ŒLittle-Endiançš„å®šä¹‰å¦‚ä¸‹ï¼š 1) Little-Endianï¼šå°±æ˜¯ä½ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œé«˜ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„é«˜åœ°å€ç«¯ã€‚2) Big-Endianï¼šå°±æ˜¯é«˜ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„ä½åœ°å€ç«¯ï¼Œä½ä½å­—èŠ‚æ’æ”¾åœ¨å†…å­˜çš„é«˜åœ°å€ç«¯ã€‚ ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæ¯”å¦‚16è¿›åˆ¶æ•°å­—0x12345678åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºå½¢å¼ä¸ºï¼š å¤§ç«¯å°ç«¯æ²¡æœ‰è°ä¼˜è°åŠ£ï¼Œå„è‡ªä¼˜åŠ¿ä¾¿æ˜¯å¯¹æ–¹åŠ£åŠ¿ï¼š å°ç«¯æ¨¡å¼ ï¼šå¼ºåˆ¶è½¬æ¢æ•°æ®ä¸éœ€è¦è°ƒæ•´å­—èŠ‚å†…å®¹ï¼Œ1ã€2ã€4å­—èŠ‚çš„å­˜å‚¨æ–¹å¼ä¸€æ ·ã€‚å¤§ç«¯æ¨¡å¼ ï¼šç¬¦å·ä½çš„åˆ¤å®šå›ºå®šä¸ºç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå®¹æ˜“åˆ¤æ–­æ­£è´Ÿã€‚ ä¸ºä»€ä¹ˆä¼šæœ‰å¤§å°ç«¯æ¨¡å¼ä¹‹åˆ†å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½çš„ï¼Œæ¯ä¸ªåœ°å€å•å…ƒéƒ½å¯¹åº”ç€ä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªå­—èŠ‚ä¸º8bitã€‚ä½†æ˜¯åœ¨Cè¯­è¨€ä¸­é™¤äº†8bitçš„charä¹‹å¤–ï¼Œè¿˜æœ‰16bitçš„shortå‹ï¼Œ32bitçš„longå‹ï¼ˆè¦çœ‹å…·ä½“çš„ç¼–è¯‘å™¨ï¼‰ï¼Œå¦å¤–ï¼Œå¯¹äºä½æ•°å¤§äº8ä½çš„å¤„ç†å™¨ï¼Œä¾‹å¦‚16ä½æˆ–è€…32ä½çš„å¤„ç†å™¨ï¼Œç”±äºå¯„å­˜å™¨å®½åº¦å¤§äºä¸€ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆå¿…ç„¶å­˜åœ¨ç€ä¸€ä¸ªå¦‚ä½•å°†å¤šä¸ªå­—èŠ‚å®‰æ’çš„é—®é¢˜ã€‚å› æ­¤å°±å¯¼è‡´äº†å¤§ç«¯å­˜å‚¨æ¨¡å¼å’Œå°ç«¯å­˜å‚¨æ¨¡å¼ã€‚ ä¾‹å¦‚ä¸€ä¸ª16bitçš„shortå‹xï¼Œåœ¨å†…å­˜ä¸­çš„åœ°å€ä¸º0x0010ï¼Œxçš„å€¼ä¸º0x1122ï¼Œé‚£ä¹ˆ0x11ä¸ºé«˜å­—èŠ‚ï¼Œ0x22ä¸ºä½å­—èŠ‚ã€‚å¯¹äºå¤§ç«¯æ¨¡å¼ï¼Œå°±å°†0x11æ”¾åœ¨ä½åœ°å€ä¸­ï¼Œå³0x0010ä¸­ï¼Œ0x22æ”¾åœ¨é«˜åœ°å€ä¸­ï¼Œå³0x0011ä¸­ã€‚å°ç«¯æ¨¡å¼ï¼Œåˆšå¥½ç›¸åã€‚æˆ‘ä»¬å¸¸ç”¨çš„x86ç»“æ„æ˜¯å°ç«¯æ¨¡å¼ï¼Œè€ŒKEIL C51åˆ™ä¸ºå¤§ç«¯æ¨¡å¼ã€‚å¾ˆå¤šçš„ARMï¼ŒDSPéƒ½ä¸ºå°ç«¯æ¨¡å¼ã€‚æœ‰äº›ARMå¤„ç†å™¨è¿˜å¯ä»¥ç”±ç¡¬ä»¶æ¥é€‰æ‹©æ˜¯å¤§ç«¯æ¨¡å¼è¿˜æ˜¯å°ç«¯æ¨¡å¼ã€‚ å¦‚ä½•åˆ¤æ–­æœºå™¨çš„å­—èŠ‚åº123456int i=1; char *p=(char *)&amp;i; if(*p == 1) printf(\"å°ç«¯æ¨¡å¼\"); else // (*p == 0) printf(\"å¤§ç«¯æ¨¡å¼\"); æˆ–è€…ä½¿ç”¨è”åˆä½“unionï¼š 123456789101112//return 1 : little-endian// 0 : big-endianint checkCPUendian()&#123; union &#123; unsigned int a; unsigned char b; &#125; c; c.a = 1; return (c.b == 1); &#125; å› ä¸ºè”åˆä½“unionçš„å­˜æ”¾é¡ºåºæ˜¯æ‰€æœ‰æˆå‘˜éƒ½ä»ä½åœ°å€å¼€å§‹å­˜æ”¾ï¼Œåˆ©ç”¨è¯¥ç‰¹æ€§å°±å¯ä»¥è½»æ¾åœ°è·å¾—äº†CPUå¯¹å†…å­˜é‡‡ç”¨Little-endianè¿˜æ˜¯Big-endianæ¨¡å¼è¯»å†™ã€‚ å¸¸è§çš„å­—èŠ‚åºä¸€èˆ¬æ“ä½œç³»ç»Ÿéƒ½æ˜¯å°ç«¯ï¼Œè€Œé€šè®¯åè®®æ˜¯å¤§ç«¯çš„ã€‚ å¸¸è§CPUçš„å­—èŠ‚åº å¤§å°ç«¯ CPU Big Endian PowerPCã€IBMã€Sun Little Endian x86ã€DEC ARMæ—¢å¯ä»¥å·¥ä½œåœ¨å¤§ç«¯æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥å·¥ä½œåœ¨å°ç«¯æ¨¡å¼ã€‚ å¸¸è§æ–‡ä»¶çš„å­—èŠ‚åº æ–‡ä»¶æ ¼å¼ å¤§å°ç«¯ Adobe PS Big Endian BMP Little Endian DXF(AutoCAD) Variable GIF Little Endian JPEG Big Endian MacPaint Big Endian RTF Little Endian å¦å¤–ï¼ŒJavaå’Œæ‰€æœ‰çš„ç½‘ç»œé€šè®¯åè®®éƒ½æ˜¯ä½¿ç”¨Big-Endiançš„ç¼–ç ã€‚ å¤§ç«¯å°ç«¯çš„è½¬æ¢æ–¹æ³• 12345678#define BigtoLittle16(A) ((((uint16)(A) &amp; 0xff00) &gt;&gt; 8) | \\ (((uint16)(A) &amp; 0x00ff) &lt;&lt; 8)) #define BigtoLittle32(A) ((((uint32)(A) &amp; 0xff000000) &gt;&gt; 24) | \\ (((uint32)(A) &amp; 0x00ff0000) &gt;&gt; 8) | \\ (((uint32)(A) &amp; 0x0000ff00) &lt;&lt; 8) | \\ (((uint32)(A) &amp; 0x000000ff) &lt;&lt; 24)) å‚è€ƒèµ„æ–™ è¯¦è§£å¤§ç«¯æ¨¡å¼å’Œå°ç«¯æ¨¡å¼ è®¡ç®—æœºä¸­çš„å°ç«¯æ¨¡å¼å’Œå¤§ç«¯æ¨¡å¼ æ•°å€¼å­˜å‚¨ï¼šCPUå¤§ç«¯å’Œå°ç«¯æ¨¡å¼è¯¦è§£","categories":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://github.com/categories/Cè¯­è¨€/"}],"tags":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://github.com/tags/Cè¯­è¨€/"}],"keywords":[{"name":"Cè¯­è¨€","slug":"Cè¯­è¨€","permalink":"http://github.com/categories/Cè¯­è¨€/"}]},{"title":"ã€Androidã€‘æºç åˆ†æ - LRUCacheç¼“å­˜å®ç°åŸç†","slug":"ã€Androidã€‘æºç åˆ†æ - LRUCacheç¼“å­˜å®ç°åŸç†","date":"2018-01-12T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2018/01/12/ã€Androidã€‘æºç åˆ†æ - LRUCacheç¼“å­˜å®ç°åŸç†/","link":"","permalink":"http://github.com/2018/01/12/ã€Androidã€‘æºç åˆ†æ - LRUCacheç¼“å­˜å®ç°åŸç†/","excerpt":"ä¸€ã€Androidä¸­çš„ç¼“å­˜ç­–ç•¥ä¸€èˆ¬æ¥è¯´ï¼Œç¼“å­˜ç­–ç•¥ä¸»è¦åŒ…å«ç¼“å­˜çš„æ·»åŠ ã€è·å–å’Œåˆ é™¤è¿™ä¸‰ç±»æ“ä½œã€‚å¦‚ä½•æ·»åŠ å’Œè·å–ç¼“å­˜è¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦åˆ é™¤ç¼“å­˜å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºä¸ç®¡æ˜¯å†…å­˜ç¼“å­˜è¿˜æ˜¯ç¡¬ç›˜ç¼“å­˜ï¼Œå®ƒä»¬çš„ç¼“å­˜å¤§å°éƒ½æ˜¯æœ‰é™çš„ã€‚å½“ç¼“å­˜æ»¡äº†ä¹‹åï¼Œå†æƒ³å…¶æ·»åŠ ç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦åˆ é™¤ä¸€äº›æ—§çš„ç¼“å­˜å¹¶æ·»åŠ æ–°çš„ç¼“å­˜ã€‚ å› æ­¤LRU(Least Recently Used)ç¼“å­˜ç®—æ³•ä¾¿åº”è¿è€Œç”Ÿï¼ŒLRUæ˜¯è¿‘æœŸæœ€å°‘ä½¿ç”¨çš„ç®—æ³•ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å½“ç¼“å­˜æ»¡æ—¶ï¼Œä¼šä¼˜å…ˆæ·˜æ±°é‚£äº›è¿‘æœŸæœ€å°‘ä½¿ç”¨çš„ç¼“å­˜å¯¹è±¡ï¼Œæœ‰æ•ˆçš„é¿å…äº†OOMçš„å‡ºç°ã€‚åœ¨Androidä¸­é‡‡ç”¨LRUç®—æ³•çš„å¸¸ç”¨ç¼“å­˜æœ‰ä¸¤ç§ï¼šLruCacheå’ŒDisLruCacheï¼Œåˆ†åˆ«ç”¨äºå®ç°å†…å­˜ç¼“å­˜å’Œç¡¬ç›˜ç¼“å­˜ï¼Œå…¶æ ¸å¿ƒæ€æƒ³éƒ½æ˜¯LRUç¼“å­˜ç®—æ³•ã€‚ å…¶å®LRUç¼“å­˜çš„å®ç°ç±»ä¼¼äºä¸€ä¸ªç‰¹æ®Šçš„æ ˆï¼ŒæŠŠè®¿é—®è¿‡çš„å…ƒç´ æ”¾ç½®åˆ°æ ˆé¡¶ï¼ˆè‹¥æ ˆä¸­å­˜åœ¨ï¼Œåˆ™æ›´æ–°è‡³æ ˆé¡¶ï¼›è‹¥æ ˆä¸­ä¸å­˜åœ¨åˆ™ç›´æ¥å…¥æ ˆï¼‰ï¼Œç„¶åå¦‚æœæ ˆä¸­å…ƒç´ æ•°é‡è¶…è¿‡é™å®šå€¼ï¼Œåˆ™åˆ é™¤æ ˆåº•å…ƒç´ ï¼ˆå³æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å…ƒç´ ï¼‰ã€‚è¯¦ç»†ç®—æ³•å®ç°å¦‚ä¸‹å›¾ï¼š æ–°æ•°æ®å‹å…¥åˆ°æ ˆé¡¶ï¼› æ¯å½“ç¼“å­˜å‘½ä¸­ï¼ˆå³ç¼“å­˜æ•°æ®è¢«è®¿é—®ï¼‰ï¼Œåˆ™å°†æ•°æ®ç§»åˆ°æ ˆé¡¶ï¼› å½“æ ˆæ»¡çš„æ—¶å€™ï¼Œå°†æ ˆåº•çš„æ•°æ®ä¸¢å¼ƒã€‚ ä¸¾ä¸ªä¾‹å­æ¼”ç¤ºä¸€ä¸‹ï¼š äºŒã€LruCacheçš„ä½¿ç”¨LruCacheæ˜¯Android 3.1æ‰€æä¾›çš„ä¸€ä¸ªç¼“å­˜ç±»ï¼Œæ‰€ä»¥åœ¨Androidä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨LruCacheå®ç°å†…å­˜ç¼“å­˜ã€‚è€ŒDisLruCacheç›®å‰åœ¨Android è¿˜ä¸æ˜¯Android SDKçš„ä¸€éƒ¨åˆ†ï¼Œä½†Androidå®˜æ–¹æ–‡æ¡£æ¨èä½¿ç”¨è¯¥ç®—æ³•æ¥å®ç°ç¡¬ç›˜ç¼“å­˜ã€‚ è®²åˆ°LruCacheä¸å¾—ä¸æä¸€ä¸‹LinkedHashMapï¼Œå› ä¸ºLruCacheä¸­Lruç®—æ³•çš„å®ç°å°±æ˜¯é€šè¿‡LinkedHashMapæ¥å®ç°çš„ã€‚LinkedHashMapç»§æ‰¿äºHashMapï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªåŒå‘é“¾è¡¨æ¥å­˜å‚¨Mapä¸­çš„Entryé¡ºåºå…³ç³»ï¼Œè¿™ç§é¡ºåºæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯LRUé¡ºåºï¼Œä¸€ç§æ˜¯æ’å…¥é¡ºåºï¼Œè¿™å¯ä»¥ç”±å…¶æ„é€ å‡½æ•°public LinkedHashMap(int initialCapacity,float loadFactor, boolean accessOrder)çš„æœ€åä¸€ä¸ªå‚æ•°accessOrderæ¥æŒ‡å®šã€‚æ‰€ä»¥ï¼Œå¯¹äºgetã€putã€removeç­‰æ“ä½œï¼ŒLinkedHashMapé™¤äº†è¦åšHashMapåšçš„äº‹æƒ…ï¼Œè¿˜åšäº›è°ƒæ•´Entryé¡ºåºé“¾è¡¨çš„å·¥ä½œã€‚LruCacheä¸­å°†LinkedHashMapçš„é¡ºåºè®¾ç½®ä¸ºLRUé¡ºåºæ¥å®ç°LRUç¼“å­˜ï¼Œæ¯æ¬¡è°ƒç”¨get(ä¹Ÿå°±æ˜¯ä»å†…å­˜ç¼“å­˜ä¸­å–å›¾ç‰‡)ï¼Œåˆ™å°†è¯¥å¯¹è±¡ç§»åˆ°é“¾è¡¨çš„å°¾ç«¯ã€‚è°ƒç”¨putæ’å…¥æ–°çš„å¯¹è±¡ä¹Ÿæ˜¯å­˜å‚¨åœ¨é“¾è¡¨å°¾ç«¯ï¼Œè¿™æ ·å½“å†…å­˜ç¼“å­˜è¾¾åˆ°è®¾å®šçš„æœ€å¤§å€¼æ—¶ï¼Œå°†é“¾è¡¨å¤´éƒ¨çš„å¯¹è±¡ï¼ˆè¿‘æœŸæœ€å°‘ç”¨åˆ°çš„ï¼‰ç§»é™¤ã€‚å…³äºLinkedHashMapè¯¦è§£è¯·å‰å¾€ï¼šç†è§£LinkedHashMap","text":"ä¸€ã€Androidä¸­çš„ç¼“å­˜ç­–ç•¥ä¸€èˆ¬æ¥è¯´ï¼Œç¼“å­˜ç­–ç•¥ä¸»è¦åŒ…å«ç¼“å­˜çš„æ·»åŠ ã€è·å–å’Œåˆ é™¤è¿™ä¸‰ç±»æ“ä½œã€‚å¦‚ä½•æ·»åŠ å’Œè·å–ç¼“å­˜è¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦åˆ é™¤ç¼“å­˜å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºä¸ç®¡æ˜¯å†…å­˜ç¼“å­˜è¿˜æ˜¯ç¡¬ç›˜ç¼“å­˜ï¼Œå®ƒä»¬çš„ç¼“å­˜å¤§å°éƒ½æ˜¯æœ‰é™çš„ã€‚å½“ç¼“å­˜æ»¡äº†ä¹‹åï¼Œå†æƒ³å…¶æ·»åŠ ç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦åˆ é™¤ä¸€äº›æ—§çš„ç¼“å­˜å¹¶æ·»åŠ æ–°çš„ç¼“å­˜ã€‚ å› æ­¤LRU(Least Recently Used)ç¼“å­˜ç®—æ³•ä¾¿åº”è¿è€Œç”Ÿï¼ŒLRUæ˜¯è¿‘æœŸæœ€å°‘ä½¿ç”¨çš„ç®—æ³•ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å½“ç¼“å­˜æ»¡æ—¶ï¼Œä¼šä¼˜å…ˆæ·˜æ±°é‚£äº›è¿‘æœŸæœ€å°‘ä½¿ç”¨çš„ç¼“å­˜å¯¹è±¡ï¼Œæœ‰æ•ˆçš„é¿å…äº†OOMçš„å‡ºç°ã€‚åœ¨Androidä¸­é‡‡ç”¨LRUç®—æ³•çš„å¸¸ç”¨ç¼“å­˜æœ‰ä¸¤ç§ï¼šLruCacheå’ŒDisLruCacheï¼Œåˆ†åˆ«ç”¨äºå®ç°å†…å­˜ç¼“å­˜å’Œç¡¬ç›˜ç¼“å­˜ï¼Œå…¶æ ¸å¿ƒæ€æƒ³éƒ½æ˜¯LRUç¼“å­˜ç®—æ³•ã€‚ å…¶å®LRUç¼“å­˜çš„å®ç°ç±»ä¼¼äºä¸€ä¸ªç‰¹æ®Šçš„æ ˆï¼ŒæŠŠè®¿é—®è¿‡çš„å…ƒç´ æ”¾ç½®åˆ°æ ˆé¡¶ï¼ˆè‹¥æ ˆä¸­å­˜åœ¨ï¼Œåˆ™æ›´æ–°è‡³æ ˆé¡¶ï¼›è‹¥æ ˆä¸­ä¸å­˜åœ¨åˆ™ç›´æ¥å…¥æ ˆï¼‰ï¼Œç„¶åå¦‚æœæ ˆä¸­å…ƒç´ æ•°é‡è¶…è¿‡é™å®šå€¼ï¼Œåˆ™åˆ é™¤æ ˆåº•å…ƒç´ ï¼ˆå³æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å…ƒç´ ï¼‰ã€‚è¯¦ç»†ç®—æ³•å®ç°å¦‚ä¸‹å›¾ï¼š æ–°æ•°æ®å‹å…¥åˆ°æ ˆé¡¶ï¼› æ¯å½“ç¼“å­˜å‘½ä¸­ï¼ˆå³ç¼“å­˜æ•°æ®è¢«è®¿é—®ï¼‰ï¼Œåˆ™å°†æ•°æ®ç§»åˆ°æ ˆé¡¶ï¼› å½“æ ˆæ»¡çš„æ—¶å€™ï¼Œå°†æ ˆåº•çš„æ•°æ®ä¸¢å¼ƒã€‚ ä¸¾ä¸ªä¾‹å­æ¼”ç¤ºä¸€ä¸‹ï¼š äºŒã€LruCacheçš„ä½¿ç”¨LruCacheæ˜¯Android 3.1æ‰€æä¾›çš„ä¸€ä¸ªç¼“å­˜ç±»ï¼Œæ‰€ä»¥åœ¨Androidä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨LruCacheå®ç°å†…å­˜ç¼“å­˜ã€‚è€ŒDisLruCacheç›®å‰åœ¨Android è¿˜ä¸æ˜¯Android SDKçš„ä¸€éƒ¨åˆ†ï¼Œä½†Androidå®˜æ–¹æ–‡æ¡£æ¨èä½¿ç”¨è¯¥ç®—æ³•æ¥å®ç°ç¡¬ç›˜ç¼“å­˜ã€‚ è®²åˆ°LruCacheä¸å¾—ä¸æä¸€ä¸‹LinkedHashMapï¼Œå› ä¸ºLruCacheä¸­Lruç®—æ³•çš„å®ç°å°±æ˜¯é€šè¿‡LinkedHashMapæ¥å®ç°çš„ã€‚LinkedHashMapç»§æ‰¿äºHashMapï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ªåŒå‘é“¾è¡¨æ¥å­˜å‚¨Mapä¸­çš„Entryé¡ºåºå…³ç³»ï¼Œè¿™ç§é¡ºåºæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯LRUé¡ºåºï¼Œä¸€ç§æ˜¯æ’å…¥é¡ºåºï¼Œè¿™å¯ä»¥ç”±å…¶æ„é€ å‡½æ•°public LinkedHashMap(int initialCapacity,float loadFactor, boolean accessOrder)çš„æœ€åä¸€ä¸ªå‚æ•°accessOrderæ¥æŒ‡å®šã€‚æ‰€ä»¥ï¼Œå¯¹äºgetã€putã€removeç­‰æ“ä½œï¼ŒLinkedHashMapé™¤äº†è¦åšHashMapåšçš„äº‹æƒ…ï¼Œè¿˜åšäº›è°ƒæ•´Entryé¡ºåºé“¾è¡¨çš„å·¥ä½œã€‚LruCacheä¸­å°†LinkedHashMapçš„é¡ºåºè®¾ç½®ä¸ºLRUé¡ºåºæ¥å®ç°LRUç¼“å­˜ï¼Œæ¯æ¬¡è°ƒç”¨get(ä¹Ÿå°±æ˜¯ä»å†…å­˜ç¼“å­˜ä¸­å–å›¾ç‰‡)ï¼Œåˆ™å°†è¯¥å¯¹è±¡ç§»åˆ°é“¾è¡¨çš„å°¾ç«¯ã€‚è°ƒç”¨putæ’å…¥æ–°çš„å¯¹è±¡ä¹Ÿæ˜¯å­˜å‚¨åœ¨é“¾è¡¨å°¾ç«¯ï¼Œè¿™æ ·å½“å†…å­˜ç¼“å­˜è¾¾åˆ°è®¾å®šçš„æœ€å¤§å€¼æ—¶ï¼Œå°†é“¾è¡¨å¤´éƒ¨çš„å¯¹è±¡ï¼ˆè¿‘æœŸæœ€å°‘ç”¨åˆ°çš„ï¼‰ç§»é™¤ã€‚å…³äºLinkedHashMapè¯¦è§£è¯·å‰å¾€ï¼šç†è§£LinkedHashMap LruCacheä½¿ç”¨ç¤ºä¾‹LruCacheçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œæˆ‘ä»¬å°±ä»¥å›¾ç‰‡ç¼“å­˜ä¸ºä¾‹ï¼š 12345678int maxMemory = (int) (Runtime.getRuntime().totalMemory()/1024);int cacheSize = maxMemory/8;mMemoryCache = new LruCache&lt;String,Bitmap&gt;(cacheSize)&#123; @Override protected int sizeOf(String key, Bitmap value) &#123; return value.getRowBytes()*value.getHeight()/1024; &#125;&#125;; â‘  è®¾ç½®LruCacheç¼“å­˜çš„å¤§å°ï¼Œä¸€èˆ¬ä¸ºå½“å‰è¿›ç¨‹å¯ç”¨å®¹é‡çš„1/8ã€‚â‘¡ é‡å†™sizeOfæ–¹æ³•ï¼Œè®¡ç®—å‡ºè¦ç¼“å­˜çš„æ¯å¼ å›¾ç‰‡çš„å¤§å°ã€‚ æ³¨æ„ï¼šç¼“å­˜çš„æ€»å®¹é‡å’Œæ¯ä¸ªç¼“å­˜å¯¹è±¡çš„å¤§å°æ‰€ç”¨å•ä½è¦ä¸€è‡´ã€‚ LruCacheçš„å®ç°åŸç†LruCacheçš„æ ¸å¿ƒæ€æƒ³å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯è¦ç»´æŠ¤ä¸€ä¸ªç¼“å­˜å¯¹è±¡åˆ—è¡¨ï¼Œå…¶ä¸­å¯¹è±¡åˆ—è¡¨çš„æ’åˆ—æ–¹å¼æ˜¯æŒ‰ç…§è®¿é—®é¡ºåºå®ç°çš„ï¼Œå³ä¸€ç›´æ²¡è®¿é—®çš„å¯¹è±¡ï¼Œå°†æ”¾åœ¨é˜Ÿå°¾ï¼Œå³å°†è¢«æ·˜æ±°ã€‚è€Œæœ€è¿‘è®¿é—®çš„å¯¹è±¡å°†æ”¾åœ¨é˜Ÿå¤´ï¼Œæœ€åè¢«æ·˜æ±°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é‚£ä¹ˆè¿™ä¸ªé˜Ÿåˆ—åˆ°åº•æ˜¯ç”±è°æ¥ç»´æŠ¤çš„ï¼Œå‰é¢å·²ç»ä»‹ç»äº†æ˜¯ç”±LinkedHashMapæ¥ç»´æŠ¤ã€‚ è€ŒLinkedHashMapæ˜¯ç”±æ•°ç»„+åŒå‘é“¾è¡¨çš„æ•°æ®ç»“æ„æ¥å®ç°çš„ã€‚å…¶ä¸­åŒå‘é“¾è¡¨çš„ç»“æ„å¯ä»¥å®ç°è®¿é—®é¡ºåºå’Œæ’å…¥é¡ºåºï¼Œä½¿å¾—LinkedHashMapä¸­çš„&lt;key,value&gt;å¯¹æŒ‰ç…§ä¸€å®šé¡ºåºæ’åˆ—èµ·æ¥ã€‚ é€šè¿‡ä¸‹é¢æ„é€ å‡½æ•°æ¥æŒ‡å®šLinkedHashMapä¸­åŒå‘é“¾è¡¨çš„ç»“æ„æ˜¯è®¿é—®é¡ºåºè¿˜æ˜¯æ’å…¥é¡ºåºã€‚ 1234567891011121314151617181920/** * Constructs a new &#123;@code LinkedHashMap&#125; instance with the specified * capacity, load factor and a flag specifying the ordering behavior. * * @param initialCapacity * the initial capacity of this hash map. * @param loadFactor * the initial load factor. * @param accessOrder * &#123;@code true&#125; if the ordering should be done based on the last * access (from least-recently accessed to most-recently * accessed), and &#123;@code false&#125; if the ordering should be the * order in which the entries were inserted. */public LinkedHashMap( int initialCapacity, float loadFactor, boolean accessOrder) &#123; super(initialCapacity, loadFactor); init(); this.accessOrder = accessOrder;&#125; å…¶ä¸­accessOrderè®¾ç½®ä¸ºtrueåˆ™ä¸ºè®¿é—®é¡ºåºï¼Œä¸ºfalseï¼Œåˆ™ä¸ºæ’å…¥é¡ºåºã€‚ ä»¥å…·ä½“ä¾‹å­è§£é‡Šï¼Œå½“è®¾ç½®ä¸ºtrueæ—¶ï¼š 12345678910111213141516public static final void main(String[] args) &#123; LinkedHashMap&lt;Integer, Integer&gt; map = new LinkedHashMap&lt;&gt;(0, 0.75f, true); map.put(0, 0); map.put(1, 1); map.put(2, 2); map.put(3, 3); map.put(4, 4); map.put(5, 5); map.put(6, 6); map.get(1); //è®¿é—®1 map.get(2); //è®¿é—®2 for (Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123; System.out.println(entry.getKey() + \":\" + entry.getValue()); &#125;&#125; è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 0:03:34:45:56:61:12:2 å³æœ€è¿‘è®¿é—®çš„å¯¹è±¡ä¼šè¢«æ”¾åˆ°é˜Ÿå°¾ï¼Œç„¶åæœ€åè¾“å‡ºï¼Œé‚£ä¹ˆè¿™å°±æ­£å¥½æ»¡è¶³çš„LRUç¼“å­˜ç®—æ³•çš„æ€æƒ³ã€‚å¯è§LruCacheå·§å¦™å®ç°ï¼Œå°±æ˜¯åˆ©ç”¨äº†LinkedHashMapçš„è¿™ç§æ•°æ®ç»“æ„ã€‚ ä¸‹é¢æˆ‘ä»¬åœ¨LruCacheæºç ä¸­å…·ä½“çœ‹çœ‹ï¼Œæ€ä¹ˆåº”ç”¨LinkedHashMapæ¥å®ç°ç¼“å­˜çš„æ·»åŠ ï¼Œè·å¾—å’Œåˆ é™¤çš„ã€‚ LruCacheæºç åˆ†ææˆ‘ä»¬å…ˆçœ‹çœ‹æˆå‘˜å˜é‡æœ‰å“ªäº›ï¼š 123456789101112131415public class LruCache&lt;K, V&gt; &#123; private final LinkedHashMap&lt;K, V&gt; map; /** Size of this cache in units. Not necessarily the number of elements. */ private int size; //å½“å‰cacheçš„å¤§å° private int maxSize; //cacheæœ€å¤§å¤§å° private int putCount; //putçš„æ¬¡æ•° private int createCount; //createçš„æ¬¡æ•° private int evictionCount; //é©±é€å‰”é™¤çš„æ¬¡æ•° private int hitCount; //å‘½ä¸­çš„æ¬¡æ•° private int missCount; //æœªå‘½ä¸­æ¬¡æ•° //...çœç•¥...&#125; æ„é€ å‡½æ•°å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°LruCacheæ­£æ˜¯ç”¨äº†LinkedHashMapçš„accessOrder=trueæ„é€ å‚æ•°å®ç°LRUè®¿é—®é¡ºåºï¼š 12345678public LruCache(int maxSize) &#123; if (maxSize &lt;= 0) &#123; throw new IllegalArgumentException(\"maxSize &lt;= 0\"); &#125; this.maxSize = maxSize; //å°†LinkedHashMapçš„accessOrderè®¾ç½®ä¸ºtrueæ¥å®ç°LRUé¡ºåº this.map = new LinkedHashMap&lt;K, V&gt;(0, 0.75f, true);&#125; putæ–¹æ³•1234567891011121314151617181920212223242526public final V put(K key, V value) &#123; //ä¸å¯ä¸ºç©ºï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ if (key == null || value == null) &#123; throw new NullPointerException(\"key == null || value == null\"); &#125; V previous; //æ—§å€¼ synchronized (this) &#123; putCount++; //æ’å…¥æ¬¡æ•°åŠ 1 size += safeSizeOf(key, value); //æ›´æ–°ç¼“å­˜çš„å¤§å° previous = map.put(key, value); //å¦‚æœå·²æœ‰ç¼“å­˜å¯¹è±¡ï¼Œåˆ™ç¼“å­˜å¤§å°çš„å€¼éœ€è¦å‰”é™¤è¿™ä¸ªæ—§çš„å¤§å° if (previous != null) &#123; size -= safeSizeOf(key, previous); &#125; &#125; //entryRemoved()æ˜¯ä¸ªç©ºæ–¹æ³•ï¼Œå¯ä»¥è‡ªè¡Œå®ç° if (previous != null) &#123; entryRemoved(false, key, previous, value); &#125; //è°ƒæ•´ç¼“å­˜å¤§å°(å…³é”®æ–¹æ³•) trimToSize(maxSize); return previous;&#125; å¯ä»¥çœ‹åˆ°put()æ–¹æ³•å¹¶æ²¡æœ‰ä»€ä¹ˆéš¾ç‚¹ï¼Œé‡è¦çš„å°±æ˜¯åœ¨æ·»åŠ è¿‡ç¼“å­˜å¯¹è±¡åï¼Œè°ƒç”¨trimToSize()æ–¹æ³•ï¼Œæ¥åˆ¤æ–­ç¼“å­˜æ˜¯å¦å·²æ»¡ï¼Œå¦‚æœæ»¡äº†å°±è¦åˆ é™¤è¿‘æœŸæœ€å°‘ä½¿ç”¨çš„ç®—æ³•ã€‚ trimToSizeæ–¹æ³•12345678910111213141516171819202122232425262728public void trimToSize(int maxSize) &#123; while (true) &#123; K key; V value; synchronized (this) &#123; //å¦‚æœmapä¸ºç©ºå¹¶ä¸”ç¼“å­˜sizeä¸ç­‰äº0æˆ–è€…ç¼“å­˜sizeå°äº0ï¼ŒæŠ›å‡ºå¼‚å¸¸ if (size &lt; 0 || (map.isEmpty() &amp;&amp; size != 0)) &#123; throw new IllegalStateException(getClass().getName() + \".sizeOf() is reporting inconsistent results!\"); &#125; //å¦‚æœç¼“å­˜å¤§å°sizeå°äºæœ€å¤§ç¼“å­˜ï¼Œæˆ–è€…mapä¸ºç©ºï¼Œåˆ™ä¸éœ€è¦å†åˆ é™¤ç¼“å­˜å¯¹è±¡ï¼Œè·³å‡ºå¾ªç¯ if (size &lt;= maxSize || map.isEmpty()) &#123; break; &#125; //è¿­ä»£å™¨è·å–ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼Œå³é˜Ÿå¤´çš„å…ƒç´ ï¼Œè¿‘æœŸæœ€å°‘è®¿é—®çš„å…ƒç´  Map.Entry&lt;K, V&gt; toEvict = map.entrySet().iterator().next(); key = toEvict.getKey(); value = toEvict.getValue(); //åˆ é™¤è¯¥å¯¹è±¡ï¼Œå¹¶æ›´æ–°ç¼“å­˜å¤§å° map.remove(key); size -= safeSizeOf(key, value); evictionCount++; &#125; entryRemoved(true, key, value, null); &#125;&#125; trimToSize()æ–¹æ³•ä¸æ–­åœ°åˆ é™¤LinkedHashMapä¸­é˜Ÿå¤´çš„å…ƒç´ ï¼Œå³è¿‘æœŸæœ€å°‘è®¿é—®çš„ï¼Œç›´åˆ°ç¼“å­˜å¤§å°å°äºæœ€å¤§å€¼ã€‚ å½“è°ƒç”¨LruCacheçš„get()æ–¹æ³•è·å–é›†åˆä¸­çš„ç¼“å­˜å¯¹è±¡æ—¶ï¼Œå°±ä»£è¡¨è®¿é—®äº†ä¸€æ¬¡è¯¥å…ƒç´ ï¼Œå°†ä¼šæ›´æ–°é˜Ÿåˆ—ï¼Œä¿æŒæ•´ä¸ªé˜Ÿåˆ—æ˜¯æŒ‰ç…§è®¿é—®é¡ºåºæ’åºã€‚è¿™ä¸ªæ›´æ–°è¿‡ç¨‹å°±æ˜¯åœ¨LinkedHashMapä¸­çš„get()æ–¹æ³•ä¸­å®Œæˆçš„ã€‚ æˆ‘ä»¬å…ˆçœ‹LruCacheçš„get()æ–¹æ³•ã€‚ getæ–¹æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960//LruCacheçš„get()æ–¹æ³•public final V get(K key) &#123; if (key == null) &#123; throw new NullPointerException(\"key == null\"); &#125; V mapValue; synchronized (this) &#123; //è·å–å¯¹åº”çš„ç¼“å­˜å¯¹è±¡ //LinkedHashMapçš„get()æ–¹æ³•ä¼šå®ç°å°†è®¿é—®çš„å…ƒç´ æ›´æ–°åˆ°é˜Ÿåˆ—å°¾éƒ¨çš„åŠŸèƒ½ mapValue = map.get(key); //mapValueä¸ä¸ºç©ºè¡¨ç¤ºå‘½ä¸­ï¼ŒhitCount+1å¹¶è¿”å›mapValueå¯¹è±¡ if (mapValue != null) &#123; hitCount++; return mapValue; &#125; missCount++; //æœªå‘½ä¸­ &#125; /* * Attempt to create a value. This may take a long time, and the map * may be different when create() returns. If a conflicting value was * added to the map while create() was working, we leave that value in * the map and release the created value. * å¦‚æœæœªå‘½ä¸­ï¼Œåˆ™è¯•å›¾åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™é‡Œcreateæ–¹æ³•é»˜è®¤è¿”å›null,å¹¶æ²¡æœ‰å®ç°åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ã€‚ * å¦‚æœéœ€è¦äº‹é¡¹åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•å¯ä»¥é‡å†™createæ–¹æ³•ã€‚å› ä¸ºå›¾ç‰‡ç¼“å­˜æ—¶å†…å­˜ç¼“å­˜æ²¡æœ‰å‘½ä¸­ä¼šå» * æ–‡ä»¶ç¼“å­˜ä¸­å»å–æˆ–è€…ä»ç½‘ç»œä¸‹è½½ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦åˆ›å»ºï¼Œä¸‹é¢çš„å°±ä¸ç”¨çœ‹äº†ã€‚ */ V createdValue = create(key); if (createdValue == null) &#123; return null; &#125; //å‡å¦‚åˆ›å»ºäº†æ–°çš„å¯¹è±¡ï¼Œåˆ™ç»§ç»­å¾€ä¸‹æ‰§è¡Œ synchronized (this) &#123; createCount++; //å°†createdValueåŠ å…¥åˆ°mapä¸­ï¼Œå¹¶ä¸”å°†åŸæ¥é”®ä¸ºkeyçš„å¯¹è±¡ä¿å­˜åˆ°mapValue mapValue = map.put(key, createdValue); if (mapValue != null) &#123; // There was a conflict so undo that last put //å¦‚æœmapValueä¸ä¸ºç©ºï¼Œåˆ™æ’¤é”€ä¸Šä¸€æ­¥çš„putæ“ä½œã€‚ map.put(key, mapValue); &#125; else &#123; //åŠ å…¥æ–°åˆ›å»ºçš„å¯¹è±¡ä¹‹åéœ€è¦é‡æ–°è®¡ç®—sizeå¤§å° size += safeSizeOf(key, createdValue); &#125; &#125; if (mapValue != null) &#123; entryRemoved(false, key, createdValue, mapValue); return mapValue; &#125; else &#123; //æ¯æ¬¡æ–°åŠ å…¥å¯¹è±¡éƒ½éœ€è¦è°ƒç”¨trimToSizeæ–¹æ³•çœ‹æ˜¯å¦éœ€è¦å›æ”¶ trimToSize(maxSize); return createdValue; &#125;&#125; å…¶ä¸­LinkedHashMapçš„get()æ–¹æ³•å¦‚ä¸‹ï¼š 12345678910//LinkedHashMapä¸­çš„getæ–¹æ³•public V get(Object key) &#123; Node&lt;K,V&gt; e; if ((e = getNode(hash(key), key)) == null) return null; //å®ç°æ’åºçš„å…³é”®æ–¹æ³• if (accessOrder) afterNodeAccess(e); return e.value;&#125; è°ƒç”¨çš„afterNodeAccess()æ–¹æ³•å°†è¯¥å…ƒç´ ç§»åˆ°é˜Ÿå°¾ï¼Œä¿è¯æœ€åæ‰åˆ é™¤ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425void afterNodeAccess(Node&lt;K,V&gt; e) &#123; // move node to last LinkedHashMap.Entry&lt;K,V&gt; last; if (accessOrder &amp;&amp; (last = tail) != e) &#123; LinkedHashMap.Entry&lt;K,V&gt; p = (LinkedHashMap.Entry&lt;K,V&gt;)e, b = p.before, a = p.after; p.after = null; if (b == null) head = a; else b.after = a; if (a != null) a.before = b; else last = b; if (last == null) head = p; else &#123; p.before = last; last.after = p; &#125; //å½“å‰èŠ‚ç‚¹pç§»åŠ¨åˆ°å°¾éƒ¨ä¹‹åï¼Œå°¾éƒ¨æŒ‡é’ˆæŒ‡å‘å½“å‰èŠ‚ç‚¹ tail = p; ++modCount; &#125;&#125; ç”±æ­¤å¯è§LruCacheä¸­ç»´æŠ¤äº†ä¸€ä¸ªé›†åˆLinkedHashMapï¼Œè¯¥LinkedHashMapæ˜¯ä»¥è®¿é—®é¡ºåºæ’åºçš„ã€‚å½“è°ƒç”¨put()æ–¹æ³•æ—¶ï¼Œå°±ä¼šåœ¨ç»“åˆä¸­æ·»åŠ å…ƒç´ ï¼Œå¹¶è°ƒç”¨trimToSize()åˆ¤æ–­ç¼“å­˜æ˜¯å¦å·²æ»¡ï¼Œå¦‚æœæ»¡äº†å°±ç”¨LinkedHashMapçš„è¿­ä»£å™¨åˆ é™¤é˜Ÿå¤´å…ƒç´ ï¼Œå³è¿‘æœŸæœ€å°‘è®¿é—®çš„å…ƒç´ ã€‚å½“è°ƒç”¨get()æ–¹æ³•è®¿é—®ç¼“å­˜å¯¹è±¡æ—¶ï¼Œå°±ä¼šè°ƒç”¨LinkedHashMapçš„get()æ–¹æ³•è·å¾—å¯¹åº”é›†åˆå…ƒç´ ï¼ŒåŒæ—¶ä¼šæ›´æ–°è¯¥å…ƒç´ åˆ°é˜Ÿå°¾ã€‚ ä»¥ä¸Šä¾¿æ˜¯LruCacheå®ç°çš„åŸç†ï¼Œç†è§£äº†LinkedHashMapçš„æ•°æ®ç»“æ„å°±èƒ½ç†è§£æ•´ä¸ªåŸç†ã€‚å¦‚æœä¸æ‡‚ï¼Œå¯ä»¥å…ˆçœ‹çœ‹LinkedHashMapçš„å…·ä½“å®ç°ã€‚ å‚è€ƒèµ„æ–™ å†…å­˜ç¼“å­˜LruCacheå®ç°åŸç† å½»åº•è§£æAndroidç¼“å­˜æœºåˆ¶â€”â€”LruCache ç¼“å­˜æ·˜æ±°ç®—æ³•â€“LRUç®—æ³•","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€ç®—æ³•ã€‘å­—ç¬¦ä¸²å¾ªç¯ç§»ä½åæ˜¯å¦å¯åŒ…å«","slug":"ã€ç®—æ³•ã€‘å­—ç¬¦ä¸²å¾ªç¯ç§»ä½åæ˜¯å¦å¯åŒ…å«","date":"2017-12-31T07:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/12/31/ã€ç®—æ³•ã€‘å­—ç¬¦ä¸²å¾ªç¯ç§»ä½åæ˜¯å¦å¯åŒ…å«/","link":"","permalink":"http://github.com/2017/12/31/ã€ç®—æ³•ã€‘å­—ç¬¦ä¸²å¾ªç¯ç§»ä½åæ˜¯å¦å¯åŒ…å«/","excerpt":"é—®é¢˜ ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²s1å’Œs2ï¼Œè¦æ±‚åˆ¤æ–­s2æ˜¯å¦èƒ½å¤Ÿè¢«é€šè¿‡s1åšå¾ªç¯ç§»ä½ï¼ˆrotateï¼‰å¾—åˆ°çš„å­—ç¬¦ä¸²åŒ…å«ã€‚ä¾‹å¦‚ï¼Œs1=AABCDå’Œs2=CDAAï¼Œè¿”å›trueï¼›ç»™å®šs1=ABCDå’Œs2=ACBDï¼Œè¿”å›falseã€‚ è§£æ³•ä¸€æœ€ç›´æ¥æœ€ç¬¨çš„æ–¹æ³•å°±å¯¹s1è¿›è¡Œå¾ªç¯ç§»åŠ¨ï¼Œå†è¿›è¡Œå­—ç¬¦ä¸²åŒ…å«çš„åˆ¤æ–­ï¼Œä»è€Œéå†å…¶æ‰€æœ‰çš„å¯èƒ½æ€§ã€‚å­—ç¬¦ä¸²å¾ªç¯ç§»åŠ¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆnï¼‰ï¼Œå­—ç¬¦ä¸²åŒ…å«åˆ¤æ–­ï¼Œé‡‡ç”¨æ™®é€šçš„æ–¹æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆn*mï¼‰ï¼Œæ€»ä½“å¤æ‚åº¦ä¸ºOï¼ˆn*n*mï¼‰ã€‚å­—ç¬¦ä¸²åŒ…å«åˆ¤æ–­ï¼Œè‹¥é‡‡ç”¨KMPç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆnï¼‰ï¼Œè¿™æ ·æ€»ä½“çš„å¤æ‚åº¦ä¸ºOï¼ˆn*nï¼‰ã€‚è‹¥å­—ç¬¦ä¸²çš„é•¿åº¦nè¾ƒå¤§ï¼Œæ˜¾ç„¶æ•ˆç‡æ¯”è¾ƒä½ã€‚å…¶ä¸­nä¸ºs1çš„é•¿åº¦ï¼Œmä¸ºs2çš„é•¿åº¦ã€‚ è§£æ³•äºŒå¯¹s1çš„å¾ªç¯ç§»ä½æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨æ‹¼æ¥s1+s1çš„æ–¹å¼å¾—åˆ°ã€‚ ä»¥S1 = ABCDä¸ºä¾‹ï¼Œå…ˆåˆ†æå¯¹S1è¿›è¡Œå¾ªç¯ç§»ä½ä¹‹åçš„ç»“æœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š ABCDâ€”&gt;BCDAâ€”-&gt;CDABâ€”-&gt;DABCâ€”-&gt;ABCDâ€¦â€¦ å‡è®¾æˆ‘ä»¬æŠŠå‰é¢çš„ç§»èµ°çš„æ•°æ®è¿›è¡Œä¿ç•™ï¼Œä¼šå‘ç°æœ‰å¦‚ä¸‹çš„è§„å¾‹ï¼š ABCDâ€”&gt;ABCDAâ€”-&gt;ABCDABâ€”-&gt;ABCDABCâ€”-&gt;ABCDABCDâ€¦â€¦ å› æ­¤ï¼Œå¯ä»¥çœ‹å‡ºå¯¹s1åšå¾ªç¯ç§»ä½æ‰€å¾—åˆ°çš„å­—ç¬¦ä¸²éƒ½å°†æ˜¯å­—ç¬¦ä¸²s1s1çš„å­å­—ç¬¦ä¸²ã€‚å¦‚æœs2å¯ä»¥ç”±s1å¾ªç¯ç§»ä½å¾—åˆ°ï¼Œé‚£ä¹ˆs2ä¸€å®šåœ¨s1s1ä¸Šï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦å°±é™ä½äº†ã€‚","text":"é—®é¢˜ ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²s1å’Œs2ï¼Œè¦æ±‚åˆ¤æ–­s2æ˜¯å¦èƒ½å¤Ÿè¢«é€šè¿‡s1åšå¾ªç¯ç§»ä½ï¼ˆrotateï¼‰å¾—åˆ°çš„å­—ç¬¦ä¸²åŒ…å«ã€‚ä¾‹å¦‚ï¼Œs1=AABCDå’Œs2=CDAAï¼Œè¿”å›trueï¼›ç»™å®šs1=ABCDå’Œs2=ACBDï¼Œè¿”å›falseã€‚ è§£æ³•ä¸€æœ€ç›´æ¥æœ€ç¬¨çš„æ–¹æ³•å°±å¯¹s1è¿›è¡Œå¾ªç¯ç§»åŠ¨ï¼Œå†è¿›è¡Œå­—ç¬¦ä¸²åŒ…å«çš„åˆ¤æ–­ï¼Œä»è€Œéå†å…¶æ‰€æœ‰çš„å¯èƒ½æ€§ã€‚å­—ç¬¦ä¸²å¾ªç¯ç§»åŠ¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆnï¼‰ï¼Œå­—ç¬¦ä¸²åŒ…å«åˆ¤æ–­ï¼Œé‡‡ç”¨æ™®é€šçš„æ–¹æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆn*mï¼‰ï¼Œæ€»ä½“å¤æ‚åº¦ä¸ºOï¼ˆn*n*mï¼‰ã€‚å­—ç¬¦ä¸²åŒ…å«åˆ¤æ–­ï¼Œè‹¥é‡‡ç”¨KMPç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆnï¼‰ï¼Œè¿™æ ·æ€»ä½“çš„å¤æ‚åº¦ä¸ºOï¼ˆn*nï¼‰ã€‚è‹¥å­—ç¬¦ä¸²çš„é•¿åº¦nè¾ƒå¤§ï¼Œæ˜¾ç„¶æ•ˆç‡æ¯”è¾ƒä½ã€‚å…¶ä¸­nä¸ºs1çš„é•¿åº¦ï¼Œmä¸ºs2çš„é•¿åº¦ã€‚ è§£æ³•äºŒå¯¹s1çš„å¾ªç¯ç§»ä½æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨æ‹¼æ¥s1+s1çš„æ–¹å¼å¾—åˆ°ã€‚ ä»¥S1 = ABCDä¸ºä¾‹ï¼Œå…ˆåˆ†æå¯¹S1è¿›è¡Œå¾ªç¯ç§»ä½ä¹‹åçš„ç»“æœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š ABCDâ€”&gt;BCDAâ€”-&gt;CDABâ€”-&gt;DABCâ€”-&gt;ABCDâ€¦â€¦ å‡è®¾æˆ‘ä»¬æŠŠå‰é¢çš„ç§»èµ°çš„æ•°æ®è¿›è¡Œä¿ç•™ï¼Œä¼šå‘ç°æœ‰å¦‚ä¸‹çš„è§„å¾‹ï¼š ABCDâ€”&gt;ABCDAâ€”-&gt;ABCDABâ€”-&gt;ABCDABCâ€”-&gt;ABCDABCDâ€¦â€¦ å› æ­¤ï¼Œå¯ä»¥çœ‹å‡ºå¯¹s1åšå¾ªç¯ç§»ä½æ‰€å¾—åˆ°çš„å­—ç¬¦ä¸²éƒ½å°†æ˜¯å­—ç¬¦ä¸²s1s1çš„å­å­—ç¬¦ä¸²ã€‚å¦‚æœs2å¯ä»¥ç”±s1å¾ªç¯ç§»ä½å¾—åˆ°ï¼Œé‚£ä¹ˆs2ä¸€å®šåœ¨s1s1ä¸Šï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦å°±é™ä½äº†ã€‚ 12345678910/** * è§£æ³•äºŒï¼Œæ‹¼æ¥å­—ç¬¦ä¸²s1+s1 * å¦‚æœs2å¯ä»¥ç”±s1å¾ªç¯ç§»ä½å¾—åˆ°ï¼Œé‚£ä¹ˆs2ä¸€å®šåœ¨s1s1ä¸Š */public static boolean isContainsByConcat(String a, String b)&#123; if(a == null || b == null || a.isEmpty() || b.isEmpty()) return false; String newStr = a.concat(a); return newStr.contains(b);&#125; è§£æ³•ä¸‰ä½¿ç”¨æŒ‡é’ˆå¾ªç¯ã€‚æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼Œåœ¨s1åé¢â€è™šæ‹Ÿâ€åœ°æ¥ä¸Šä¸€ä¸ªs1ï¼Œè¿™ä¸ªâ€è™šæ‹Ÿçš„s1â€å¹¶ä¸å ç©ºé—´ï¼Œä½†æ˜¯ä»ç„¶æŒ‰ç…§è§£æ³•2çš„æ€è·¯è¿›è¡Œã€‚é‚£ä¹ˆï¼Œå¦‚ä½•å®ç°è¿™ä¸ªâ€è™šæ‹Ÿçš„s1â€å‘¢ï¼Ÿå…¶å®åªè¦æŠŠs1çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå†æŒ‡å›s1çš„ç¬¬ä¸€ä¸ªå…ƒç´ å³å¯ã€‚è¿™å¯ä»¥ç”¨å–æ¨¡.aspx)è¿ç®—å®ç°ã€‚æ¯”å¦‚ï¼Œå…ƒç´ s1[(d1+i) mod d1]å…¶å®å°±æ˜¯é‚£ä¸ªâ€œè™šæ‹Ÿçš„s1â€çš„ç¬¬iä¸ªå…ƒç´ ï¼Œä¸ä¼šè¶…å‡ºå­—ç¬¦ä¸²s1çš„é•¿åº¦ã€‚ ç”¨ä¸€ä¸ªæŒ‡é’ˆæ ‡è®°éå†s1ï¼Œæœ€å¤šä¸¤éï¼Œä¸s2ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ¯”å¯¹ï¼Œå¦‚æœå‘½ä¸­åˆ™è¿›å…¥s2ï¼Œè¿›è¡Œé€ä½åŒ¹é…ï¼ŒåŒ¹é…å¤±è´¥çš„è¯è·³å‡ºs2ç»§ç»­æŸ¥æ‰¾s1ã€‚ 1234567891011121314151617181920212223242526/** * è§£æ³•ä¸‰ï¼šæŒ‡é’ˆå¾ªç¯æŸ¥æ‰¾ */public static boolean isContainsByPointer(String a, String b)&#123; if(a == null || b == null || a.isEmpty() || b.isEmpty()) return false; int p = 0; //s1çš„æŒ‡é’ˆ int aLen = a.length(); int bLen = b.length(); for(int i = 0; i &lt; aLen * 2; i++)&#123; char c1 = a.charAt(p % aLen); //åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªå­—ç¬¦ç›¸åŒåï¼Œéå†s2å­—ç¬¦ä¸² if(c1 == b.charAt(0))&#123; for(int j = 0; j &lt; bLen; j++)&#123; if(a.charAt((p + j) % aLen) != b.charAt(j))&#123; break; //æœ¬æ¬¡ä¸å®Œå…¨åŒ¹é…ï¼Œç»§ç»­å¾€å &#125; &#125; return true; &#125; p++; &#125; return false;&#125; ä¼˜ç‚¹ï¼š å­—ç¬¦ä¸²é•¿åº¦è¾ƒå¤§æ—¶ï¼Œæ•ˆç‡ä¾ç„¶è¾ƒå¥½ï¼› ä¸éœ€è¦ç”³è¯·é¢å¤–ç©ºé—´å­˜å‚¨ç¬¬äºŒä¸ªs1 å‚è€ƒèµ„æ–™ å­—ç¬¦ä¸²ç§»ä½åŒ…å«çš„é—®é¢˜","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€ç®—æ³•ã€‘å¦‚ä½•åˆ¤æ–­é“¾è¡¨æœ‰ç¯","slug":"ã€ç®—æ³•ã€‘å¦‚ä½•åˆ¤æ–­é“¾è¡¨æœ‰ç¯","date":"2017-12-24T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/12/24/ã€ç®—æ³•ã€‘å¦‚ä½•åˆ¤æ–­é“¾è¡¨æœ‰ç¯/","link":"","permalink":"http://github.com/2017/12/24/ã€ç®—æ³•ã€‘å¦‚ä½•åˆ¤æ–­é“¾è¡¨æœ‰ç¯/","excerpt":"å¦‚ä½•åˆ¤æ–­å•é“¾è¡¨æ˜¯å¦å­˜åœ¨ç¯ æœ‰ä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œé“¾è¡¨å½“ä¸­æœ‰å¯èƒ½å‡ºç°â€œç¯â€ï¼Œå°±åƒé¢˜å›¾è¿™æ ·ã€‚å¦‚ä½•ç”¨ç¨‹åºåˆ¤æ–­å‡ºè¿™ä¸ªé“¾è¡¨æ˜¯æœ‰ç¯é“¾è¡¨ï¼Ÿ ä¸å…è®¸ä¿®æ”¹é“¾è¡¨ç»“æ„ã€‚ æ—¶é—´å¤æ‚åº¦O(n)ï¼Œç©ºé—´å¤æ‚åº¦O(1)ã€‚ æ–¹æ³•ä¸€ã€ç©·ä¸¾éå†æ–¹æ³•ä¸€ï¼šé¦–å…ˆä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œä¾æ¬¡éå†å•é“¾è¡¨çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚æ¯éå†åˆ°ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå°±ä»å¤´èŠ‚ç‚¹é‡æ–°éå†æ–°èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œç”¨æ–°èŠ‚ç‚¹IDå’Œæ­¤èŠ‚ç‚¹ä¹‹å‰æ‰€æœ‰èŠ‚ç‚¹IDä¾æ¬¡ä½œæ¯”è¾ƒã€‚å¦‚æœå‘ç°æ–°èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹å½“ä¸­å­˜åœ¨ç›¸åŒèŠ‚ç‚¹IDï¼Œåˆ™è¯´æ˜è¯¥èŠ‚ç‚¹è¢«éå†è¿‡ä¸¤æ¬¡ï¼Œé“¾è¡¨æœ‰ç¯ï¼›å¦‚æœä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹å½“ä¸­ä¸å­˜åœ¨ç›¸åŒçš„èŠ‚ç‚¹ï¼Œå°±ç»§ç»­éå†ä¸‹ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œç»§ç»­é‡å¤åˆšæ‰çš„æ“ä½œã€‚ ä¾‹å¦‚è¿™æ ·çš„é“¾è¡¨ï¼šA-&gt;B-&gt;C-&gt;D-&gt;B-&gt;C-&gt;Dï¼Œ å½“éå†åˆ°èŠ‚ç‚¹Dçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒçš„æ˜¯ä¹‹å‰çš„èŠ‚ç‚¹Aã€Bã€Cï¼Œä¸å­˜åœ¨ç›¸åŒèŠ‚ç‚¹ã€‚è¿™æ—¶å€™è¦éå†çš„ä¸‹ä¸€ä¸ªæ–°èŠ‚ç‚¹æ˜¯Bï¼ŒBä¹‹å‰çš„èŠ‚ç‚¹Aã€Bã€Cã€Dä¸­æ°å¥½ä¹Ÿå­˜åœ¨Bï¼Œå› æ­¤Bå‡ºç°äº†ä¸¤æ¬¡ï¼Œåˆ¤æ–­å‡ºé“¾è¡¨æœ‰ç¯ã€‚ å‡è®¾ä»é“¾è¡¨å¤´èŠ‚ç‚¹åˆ°å…¥ç¯ç‚¹çš„è·ç¦»æ˜¯Dï¼Œé“¾è¡¨çš„ç¯é•¿æ˜¯Sã€‚é‚£ä¹ˆç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯0+1+2+3+â€¦.+(D+S-1) = (D+S-1)*(D+S)/2 ï¼Œ å¯ä»¥ç®€å•åœ°ç†è§£æˆ O(N*N)ã€‚è€Œæ­¤ç®—æ³•æ²¡æœ‰åˆ›å»ºé¢å¤–å­˜å‚¨ç©ºé—´ï¼Œç©ºé—´å¤æ‚åº¦å¯ä»¥ç®€å•åœ°ç†è§£æˆä¸ºO(1)ã€‚","text":"å¦‚ä½•åˆ¤æ–­å•é“¾è¡¨æ˜¯å¦å­˜åœ¨ç¯ æœ‰ä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œé“¾è¡¨å½“ä¸­æœ‰å¯èƒ½å‡ºç°â€œç¯â€ï¼Œå°±åƒé¢˜å›¾è¿™æ ·ã€‚å¦‚ä½•ç”¨ç¨‹åºåˆ¤æ–­å‡ºè¿™ä¸ªé“¾è¡¨æ˜¯æœ‰ç¯é“¾è¡¨ï¼Ÿ ä¸å…è®¸ä¿®æ”¹é“¾è¡¨ç»“æ„ã€‚ æ—¶é—´å¤æ‚åº¦O(n)ï¼Œç©ºé—´å¤æ‚åº¦O(1)ã€‚ æ–¹æ³•ä¸€ã€ç©·ä¸¾éå†æ–¹æ³•ä¸€ï¼šé¦–å…ˆä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œä¾æ¬¡éå†å•é“¾è¡¨çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚æ¯éå†åˆ°ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå°±ä»å¤´èŠ‚ç‚¹é‡æ–°éå†æ–°èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œç”¨æ–°èŠ‚ç‚¹IDå’Œæ­¤èŠ‚ç‚¹ä¹‹å‰æ‰€æœ‰èŠ‚ç‚¹IDä¾æ¬¡ä½œæ¯”è¾ƒã€‚å¦‚æœå‘ç°æ–°èŠ‚ç‚¹ä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹å½“ä¸­å­˜åœ¨ç›¸åŒèŠ‚ç‚¹IDï¼Œåˆ™è¯´æ˜è¯¥èŠ‚ç‚¹è¢«éå†è¿‡ä¸¤æ¬¡ï¼Œé“¾è¡¨æœ‰ç¯ï¼›å¦‚æœä¹‹å‰çš„æ‰€æœ‰èŠ‚ç‚¹å½“ä¸­ä¸å­˜åœ¨ç›¸åŒçš„èŠ‚ç‚¹ï¼Œå°±ç»§ç»­éå†ä¸‹ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œç»§ç»­é‡å¤åˆšæ‰çš„æ“ä½œã€‚ ä¾‹å¦‚è¿™æ ·çš„é“¾è¡¨ï¼šA-&gt;B-&gt;C-&gt;D-&gt;B-&gt;C-&gt;Dï¼Œ å½“éå†åˆ°èŠ‚ç‚¹Dçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ¯”è¾ƒçš„æ˜¯ä¹‹å‰çš„èŠ‚ç‚¹Aã€Bã€Cï¼Œä¸å­˜åœ¨ç›¸åŒèŠ‚ç‚¹ã€‚è¿™æ—¶å€™è¦éå†çš„ä¸‹ä¸€ä¸ªæ–°èŠ‚ç‚¹æ˜¯Bï¼ŒBä¹‹å‰çš„èŠ‚ç‚¹Aã€Bã€Cã€Dä¸­æ°å¥½ä¹Ÿå­˜åœ¨Bï¼Œå› æ­¤Bå‡ºç°äº†ä¸¤æ¬¡ï¼Œåˆ¤æ–­å‡ºé“¾è¡¨æœ‰ç¯ã€‚ å‡è®¾ä»é“¾è¡¨å¤´èŠ‚ç‚¹åˆ°å…¥ç¯ç‚¹çš„è·ç¦»æ˜¯Dï¼Œé“¾è¡¨çš„ç¯é•¿æ˜¯Sã€‚é‚£ä¹ˆç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯0+1+2+3+â€¦.+(D+S-1) = (D+S-1)*(D+S)/2 ï¼Œ å¯ä»¥ç®€å•åœ°ç†è§£æˆ O(N*N)ã€‚è€Œæ­¤ç®—æ³•æ²¡æœ‰åˆ›å»ºé¢å¤–å­˜å‚¨ç©ºé—´ï¼Œç©ºé—´å¤æ‚åº¦å¯ä»¥ç®€å•åœ°ç†è§£æˆä¸ºO(1)ã€‚ æ–¹æ³•äºŒã€å“ˆå¸Œè¡¨ç¼“å­˜**é¦–å…ˆåˆ›å»ºä¸€ä¸ªä»¥èŠ‚ç‚¹IDä¸ºé”®çš„HashSeté›†åˆï¼Œç”¨æ¥å­˜å‚¨æ›¾ç»éå†è¿‡çš„èŠ‚ç‚¹ã€‚ç„¶ååŒæ ·æ˜¯ä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œä¾æ¬¡éå†å•é“¾è¡¨çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚æ¯éå†åˆ°ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå°±ç”¨æ–°èŠ‚ç‚¹å’ŒHashSeté›†åˆå½“ä¸­å­˜å‚¨çš„èŠ‚ç‚¹ä½œæ¯”è¾ƒï¼Œå¦‚æœå‘ç°HashSetå½“ä¸­å­˜åœ¨ç›¸åŒèŠ‚ç‚¹IDï¼Œåˆ™è¯´æ˜é“¾è¡¨æœ‰ç¯ï¼Œå¦‚æœHashSetå½“ä¸­ä¸å­˜åœ¨ç›¸åŒçš„èŠ‚ç‚¹IDï¼Œå°±æŠŠè¿™ä¸ªæ–°èŠ‚ç‚¹IDå­˜å…¥HashSetï¼Œä¹‹åè¿›å…¥ä¸‹ä¸€èŠ‚ç‚¹ï¼Œç»§ç»­é‡å¤åˆšæ‰çš„æ“ä½œã€‚ è¿™ä¸ªæ–¹æ³•åœ¨æµç¨‹ä¸Šå’Œæ–¹æ³•ä¸€ç±»ä¼¼ï¼Œæœ¬è´¨çš„åŒºåˆ«æ˜¯ä½¿ç”¨äº†HashSetä½œä¸ºé¢å¤–çš„ç¼“å­˜ã€‚ å‡è®¾ä»é“¾è¡¨å¤´èŠ‚ç‚¹åˆ°å…¥ç¯ç‚¹çš„è·ç¦»æ˜¯Dï¼Œé“¾è¡¨çš„ç¯é•¿æ˜¯Sã€‚è€Œæ¯ä¸€æ¬¡HashSetæŸ¥æ‰¾å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(1), æ‰€ä»¥æ€»ä½“çš„æ—¶é—´å¤æ‚åº¦æ˜¯1*(D+S)=D+Sï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºO(N)ã€‚è€Œç®—æ³•çš„ç©ºé—´å¤æ‚åº¦è¿˜æ˜¯D+S-1ï¼Œå¯ä»¥ç®€å•åœ°ç†è§£æˆO(N)ã€‚ æ–¹æ³•ä¸‰ã€å¿«æ…¢æŒ‡é’ˆé¦–å…ˆåˆ›å»ºä¸¤ä¸ªæŒ‡é’ˆ1å’Œ2ï¼ˆåœ¨javaé‡Œå°±æ˜¯ä¸¤ä¸ªå¯¹è±¡å¼•ç”¨ï¼‰ï¼ŒåŒæ—¶æŒ‡å‘è¿™ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚ç„¶åå¼€å§‹ä¸€ä¸ªå¤§å¾ªç¯ï¼Œåœ¨å¾ªç¯ä½“ä¸­ï¼Œè®©æŒ‡é’ˆ1æ¯æ¬¡å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè®©æŒ‡é’ˆ2æ¯æ¬¡å‘ä¸‹ç§»åŠ¨ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œç„¶åæ¯”è¾ƒä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹æ˜¯å¦ç›¸åŒã€‚å¦‚æœç›¸åŒï¼Œåˆ™åˆ¤æ–­å‡ºé“¾è¡¨æœ‰ç¯ï¼Œå¦‚æœä¸åŒï¼Œåˆ™ç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯ã€‚ ä¾‹å¦‚é“¾è¡¨A-&gt;B-&gt;C-&gt;D-&gt;B-&gt;C-&gt;Dï¼Œä¸¤ä¸ªæŒ‡é’ˆæœ€åˆéƒ½æŒ‡å‘èŠ‚ç‚¹Aï¼Œè¿›å…¥ç¬¬ä¸€è½®å¾ªç¯ï¼ŒæŒ‡é’ˆ1ç§»åŠ¨åˆ°äº†èŠ‚ç‚¹Bï¼ŒæŒ‡é’ˆ2ç§»åŠ¨åˆ°äº†Cã€‚ç¬¬äºŒè½®å¾ªç¯ï¼ŒæŒ‡é’ˆ1ç§»åŠ¨åˆ°äº†èŠ‚ç‚¹Cï¼ŒæŒ‡é’ˆ2ç§»åŠ¨åˆ°äº†èŠ‚ç‚¹Bã€‚ç¬¬ä¸‰è½®å¾ªç¯ï¼ŒæŒ‡é’ˆ1ç§»åŠ¨åˆ°äº†èŠ‚ç‚¹Dï¼ŒæŒ‡é’ˆ2ç§»åŠ¨åˆ°äº†èŠ‚ç‚¹Dï¼Œæ­¤æ—¶ä¸¤æŒ‡é’ˆæŒ‡å‘åŒä¸€èŠ‚ç‚¹ï¼Œåˆ¤æ–­å‡ºé“¾è¡¨æœ‰ç¯ã€‚ æ­¤æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªæ›´ç”ŸåŠ¨çš„ä¾‹å­æ¥å½¢å®¹ï¼šåœ¨ä¸€ä¸ªç¯å½¢è·‘é“ä¸Šï¼Œä¸¤ä¸ªè¿åŠ¨å‘˜åœ¨åŒä¸€åœ°ç‚¹èµ·è·‘ï¼Œä¸€ä¸ªè¿åŠ¨å‘˜é€Ÿåº¦å¿«ï¼Œä¸€ä¸ªè¿åŠ¨å‘˜é€Ÿåº¦æ…¢ã€‚å½“ä¸¤äººè·‘äº†ä¸€æ®µæ—¶é—´ï¼Œé€Ÿåº¦å¿«çš„è¿åŠ¨å‘˜å¿…ç„¶ä¼šä»é€Ÿåº¦æ…¢çš„è¿åŠ¨å‘˜èº«åå†æ¬¡è¿½ä¸Šå¹¶è¶…è¿‡ï¼ŒåŸå› å¾ˆç®€å•ï¼Œå› ä¸ºè·‘é“æ˜¯ç¯å½¢çš„ã€‚ 123456789101112131415161718192021/** * åˆ¤æ–­å•é“¾è¡¨æ˜¯å¦å­˜åœ¨ç¯ * @param head * @return */public static &lt;T&gt; boolean isLoopList(ListNode&lt;T&gt; head)&#123; ListNode&lt;T&gt; slowPointer, fastPointer; //ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡å‘å‰ä¸€æ­¥ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡ä¸¤æ­¥ slowPointer = fastPointer = head; while(fastPointer != null &amp;&amp; fastPointer.next != null)&#123; slowPointer = slowPointer.next; fastPointer = fastPointer.next.next; //ä¸¤æŒ‡é’ˆç›¸é‡åˆ™æœ‰ç¯ if(slowPointer == fastPointer)&#123; return true; &#125; &#125; return false;&#125; å‡è®¾ä»é“¾è¡¨å¤´èŠ‚ç‚¹åˆ°å…¥ç¯ç‚¹çš„è·ç¦»æ˜¯Dï¼Œé“¾è¡¨çš„ç¯é•¿æ˜¯Sã€‚é‚£ä¹ˆå¾ªç¯ä¼šè¿›è¡ŒSæ¬¡ï¼ˆä¸ºä»€ä¹ˆæ˜¯Sæ¬¡ï¼Œæœ‰å¿ƒçš„åŒå­¦å¯ä»¥è‡ªå·±æ£æ‘©ä¸‹ï¼‰ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºOï¼ˆNï¼‰ã€‚é™¤äº†ä¸¤ä¸ªæŒ‡é’ˆä»¥å¤–ï¼Œæ²¡æœ‰ä½¿ç”¨ä»»ä½•é¢å¤–å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦æ˜¯Oï¼ˆ1ï¼‰ã€‚ å¦‚ä½•åˆ¤æ–­åŒå‘é“¾è¡¨æœ‰ç¯ å…¶å®è¿™é¢˜è·Ÿå•é“¾è¡¨åˆ¤æ–­ç¯çš„æ–¹æ³•ç›¸ä¼¼ï¼Œåªæ˜¯å½“åˆ¤æ–­nextæŒ‡é’ˆä¸ä¼šå‡ºç°ç¯æ—¶ï¼Œè¦ä»å°¾èŠ‚ç‚¹æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•å‘å¤´ç»“ç‚¹æ‰«æï¼Œåˆ¤æ–­preæŒ‡é’ˆæ˜¯å¦å¯èƒ½å‡ºç°ç¯ï¼Œå¦‚å›¾ç¯2ã€‚å½“ç„¶å¦‚æœåœ¨ç¬¬ä¸€æ­¥åˆ¤æ–­é“¾è¡¨æœ‰nextç¯åæ˜¯æ— æ³•è¿›è¡Œç¬¬äºŒæ­¥åˆ¤æ–­çš„ï¼Œå› ä¸ºä½ æ°¸è¿œæ‰¾ä¸åˆ°å°¾èŠ‚ç‚¹ã€‚ 123456789101112131415161718192021222324252627282930313233343536/** * åŒå‘é“¾è¡¨æ˜¯å¦å­˜åœ¨ç¯ * @param head * @return */public static &lt;T&gt; boolean isLoopTowWayList(ListNode&lt;T&gt; head)&#123; ListNode&lt;T&gt; slow, fast; //ä¸å•é“¾è¡¨ç±»ä¼¼ï¼Œä½¿ç”¨å¿«æ…¢æŒ‡é’ˆå…ˆå•å‘éå†åˆ°ç»“å°¾ï¼Œå¦‚æœç›¸é‡è¯æ˜èµ·ç å•å‘æœ‰ç¯ slow = fast = head; while(fast != null &amp;&amp; fast.next != null)&#123; slow = slow.next; fast = fast.next.next; if(slow == fast)&#123; return true; &#125; &#125; //æ‰¾åˆ°å°¾æŒ‡é’ˆ while(slow.next != null)&#123; slow = slow.next; &#125; //å¦‚æœnextå•å‘æ²¡ç¯ï¼Œä»å°¾èŠ‚ç‚¹å›æº¯éå†ï¼Œçœ‹prevæ˜¯å¦å­˜åœ¨ç¯ fast = slow; while(fast != null &amp;&amp; fast.prev != null)&#123; slow = slow.prev; fast = fast.prev.prev; if(slow == fast)&#123; return true; &#125; &#125; return false;&#125; å¦‚ä½•æ‰¾å‡ºæœ‰ç¯é“¾è¡¨çš„å…¥ç¯ç‚¹ï¼Ÿæ ¹æ®è¿™ç¯‡æ–‡ç« ï¼šé“¾è¡¨ä¸­ç¯å½¢çš„å…¥å£ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å…¥ç¯å£å’Œæˆ‘ä»¬ä¸Šé¢è¿™ä¸ªå¿«æ…¢æŒ‡é’ˆç›¸é‡ç‚¹çš„å…³ç³»ã€‚ å½“fastè‹¥ä¸slowç›¸é‡æ—¶ï¼Œslowè‚¯å®šæ²¡æœ‰èµ°éå†å®Œé“¾è¡¨(ä¸æ˜¯ä¸€æ•´ä¸ªç¯ï¼Œæœ‰å¼€å¤´éƒ¨åˆ†ï¼Œå¦‚ä¸Šå›¾)æˆ–è€…æ°å¥½éå†ä¸€åœˆ(æœªåšéªŒè¯ï¼Œçœ‹æˆ‘çš„è¡¨æ ¼ä¾‹å­ï¼Œåœ¨1å¤„ç›¸é‡)ã€‚äºæ˜¯æˆ‘ä»¬ä»é“¾è¡¨å¤´ã€ç›¸é‡ç‚¹åˆ†åˆ«è®¾ä¸€ä¸ªæŒ‡é’ˆï¼Œæ¯æ¬¡å„èµ°ä¸€æ­¥ï¼Œä¸¤ä¸ªæŒ‡é’ˆå¿…å®šç›¸é‡ï¼Œä¸”ç›¸é‡ç¬¬ä¸€ç‚¹ä¸ºç¯å…¥å£ç‚¹(æ…¢æŒ‡é’ˆèµ°äº†næ­¥ï¼Œç¬¬ä¸€æ¬¡ç›¸é‡åœ¨cç‚¹ï¼Œå¯¹æ…¢æŒ‡é’ˆæ¥è¯´n=s+pï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæ…¢æŒ‡é’ˆä»cç‚¹å†èµ°næ­¥ï¼Œåˆä¼šåˆ°cç‚¹ï¼Œé‚£ä¹ˆé¡ºæ—¶é’ˆçš„CBè·ç¦»æ˜¯n-p=sï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“sæ˜¯å‡ ï¼Œé‚£ä¹ˆå½“å¿«æŒ‡é’ˆæ­¤æ—¶åœ¨Aç‚¹ä¸€æ­¥ä¸€æ­¥èµ°ï¼Œå½“å¿«æ…¢æŒ‡é’ˆç›¸é‡æ—¶ï¼Œç›¸é‡ç‚¹æ°å¥½æ˜¯åœ†ç¯ä¸ƒç‚¹B(AB=CB=s))ã€‚ 12345678910111213141516171819202122232425262728293031323334353637/** * æ‰¾åˆ°æœ‰ç¯é“¾è¡¨çš„å…¥å£ * @param head * @return */public static &lt;T&gt; ListNode&lt;T&gt; findEntranceInLoopList(ListNode&lt;T&gt; head)&#123; ListNode&lt;T&gt; slowPointer, fastPointer; //ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡å‘å‰ä¸€æ­¥ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡ä¸¤æ­¥ boolean isLoop = false; slowPointer = fastPointer = head; while(fastPointer != null &amp;&amp; fastPointer.next != null)&#123; slowPointer = slowPointer.next; fastPointer = fastPointer.next.next; //ä¸¤æŒ‡é’ˆç›¸é‡åˆ™æœ‰ç¯ if(slowPointer == fastPointer)&#123; isLoop = true; break; &#125; &#125; //ä¸€ä¸ªæŒ‡é’ˆä»é“¾è¡¨å¤´å¼€å§‹ï¼Œä¸€ä¸ªä»ç›¸é‡ç‚¹å¼€å§‹ï¼Œæ¯æ¬¡ä¸€æ­¥ï¼Œå†æ¬¡ç›¸é‡çš„ç‚¹å³æ˜¯å…¥å£èŠ‚ç‚¹ if(isLoop)&#123; slowPointer = head; while(fastPointer != null &amp;&amp; fastPointer.next != null)&#123; //ä¸¤æŒ‡é’ˆç›¸é‡çš„ç‚¹å³æ˜¯å…¥å£èŠ‚ç‚¹ if(slowPointer == fastPointer)&#123; return slowPointer; &#125; slowPointer = slowPointer.next; fastPointer = fastPointer.next; &#125; &#125; return null;&#125; å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªå•é“¾è¡¨æ˜¯å¦ç›¸äº¤ï¼Œä»¥åŠç›¸äº¤ç‚¹ æ–¹æ³•ä¸€ã€ç›´æ¥æ³•ç›´æ¥åˆ¤æ–­ç¬¬ä¸€ä¸ªé“¾è¡¨çš„æ¯ä¸ªç»“ç‚¹æ˜¯å¦åœ¨ç¬¬äºŒä¸ªé“¾è¡¨ä¸­ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(len1*len2)ï¼Œè€—æ—¶å¾ˆå¤§ æ–¹æ³•äºŒã€åˆ©ç”¨è®¡æ•°å¦‚æœä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ï¼Œåˆ™ä¸¤ä¸ªé“¾è¡¨å°±ä¼šæœ‰å…±åŒçš„ç»“ç‚¹ï¼›è€Œç»“ç‚¹åœ°å€åˆæ˜¯ç»“ç‚¹å”¯ä¸€æ ‡è¯†ã€‚å› è€Œåˆ¤æ–­ä¸¤ä¸ªé“¾è¡¨ä¸­æ˜¯å¦å­˜åœ¨åœ°å€ä¸€è‡´çš„èŠ‚ç‚¹ï¼Œå°±å¯ä»¥çŸ¥é“æ˜¯å¦ç›¸äº¤äº†ã€‚å¯ä»¥å¯¹ç¬¬ä¸€ ä¸ªé“¾è¡¨çš„èŠ‚ç‚¹åœ°å€è¿›è¡Œhashæ’åºï¼Œå»ºç«‹hashè¡¨ï¼Œç„¶åé’ˆå¯¹ç¬¬äºŒä¸ªé“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹çš„åœ°å€æŸ¥è¯¢hashè¡¨ï¼Œå¦‚æœå®ƒåœ¨hashè¡¨ä¸­å‡ºç°ï¼Œåˆ™è¯´æ˜ä¸¤ä¸ªé“¾è¡¨æœ‰å…± åŒçš„ç»“ç‚¹ã€‚è¿™ä¸ªæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(max(len1+len2)ï¼›ä½†åŒæ—¶è¿˜å¾—å¢åŠ O(len1)çš„å­˜å‚¨ç©ºé—´å­˜å‚¨å“ˆå¸Œè¡¨ã€‚è¿™æ ·å‡å°‘äº†æ—¶é—´å¤æ‚åº¦ï¼Œå¢åŠ  äº†å­˜å‚¨ç©ºé—´ã€‚ ä»¥é“¾è¡¨èŠ‚ç‚¹åœ°å€ä¸ºå€¼ï¼Œéå†ç¬¬ä¸€ä¸ªé“¾è¡¨ï¼Œä½¿ç”¨Hashä¿å­˜æ‰€æœ‰èŠ‚ç‚¹åœ°å€å€¼ï¼Œç»“æŸæ¡ä»¶ä¸ºåˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæ— ç¯ï¼‰æˆ–Hashä¸­è¯¥åœ°å€å€¼å·²ç»å­˜åœ¨ï¼ˆæœ‰ç¯ï¼‰ã€‚ å†éå†ç¬¬äºŒä¸ªé“¾è¡¨ï¼Œåˆ¤æ–­èŠ‚ç‚¹åœ°å€å€¼æ˜¯å¦å·²ç»å­˜åœ¨äºä¸Šé¢åˆ›å»ºçš„Hashè¡¨ä¸­ã€‚è¿™ä¸ªæ–¹é¢å¯ä»¥è§£å†³é¢˜ç›®ä¸­çš„æ‰€æœ‰æƒ…å†µï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(m+n)ï¼Œmå’Œnåˆ†åˆ«æ˜¯ä¸¤ä¸ªé“¾è¡¨ä¸­èŠ‚ç‚¹æ•°é‡ã€‚ç”±äºèŠ‚ç‚¹åœ°å€æŒ‡é’ˆå°±æ˜¯ä¸€ä¸ªæ•´å‹ï¼Œå‡è®¾é“¾è¡¨éƒ½æ˜¯åœ¨å †ä¸­åŠ¨æ€åˆ›å»ºçš„ï¼Œå¯ä»¥ä½¿ç”¨å †çš„èµ·å§‹åœ°å€ä½œä¸ºåç§»é‡ï¼Œä»¥åœ°å€å‡å»è¿™ä¸ªåç§»é‡ä½œä¸ºHashå‡½æ•° æ–¹æ³•ä¸‰ã€åˆ©ç”¨æœ‰ç¯é“¾è¡¨æ€è·¯å¯¹äºä¸¤ä¸ªæ²¡æœ‰ç¯çš„é“¾è¡¨ç›¸äº¤äºä¸€èŠ‚ç‚¹ï¼Œåˆ™åœ¨è¿™ä¸ªèŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰ç»“ç‚¹éƒ½æ˜¯ä¸¤ä¸ªé“¾è¡¨æ‰€å…±æœ‰çš„ã€‚å¦‚æœå®ƒä»¬ç›¸äº¤ï¼Œåˆ™æœ€åä¸€ä¸ªç»“ç‚¹ä¸€å®šæ˜¯å…±æœ‰çš„ï¼Œåˆ™åªéœ€è¦åˆ¤æ–­æœ€åä¸€ä¸ªç»“ç‚¹æ˜¯å¦ç›¸åŒå³å¯ã€‚æ—¶é—´å¤æ‚åº¦ä¸ºO(len1+len2)ã€‚å¯¹äºç›¸äº¤çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œåˆ™å¯æ±‚å‡ºä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ï¼Œç„¶åç”¨é•¿çš„å‡å»çŸ­çš„å¾—åˆ°ä¸€ä¸ªå·®å€¼ Kï¼Œç„¶åè®©é•¿çš„é“¾è¡¨å…ˆéå†Kä¸ªç»“ç‚¹ï¼Œç„¶åä¸¤ä¸ªé“¾è¡¨å†å¼€å§‹æ¯”è¾ƒã€‚ è¿˜å¯ä»¥è¿™æ ·ï¼šå…¶ä¸­ä¸€ä¸ªé“¾è¡¨é¦–å°¾ç›¸è¿ï¼Œæ£€æµ‹å¦å¤–ä¸€ä¸ªé“¾è¡¨æ˜¯å¦å­˜åœ¨ç¯ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ï¼Œè€Œæ£€æµ‹å‡ºæ¥çš„ä¾èµ–ç¯å…¥å£å³ä¸ºç›¸äº¤çš„ç¬¬ä¸€ä¸ª å‚è€ƒèµ„æ–™ æ¼«ç”»ç®—æ³•ï¼šå¦‚ä½•åˆ¤æ–­é“¾è¡¨æœ‰ç¯ï¼Ÿ åˆ¤æ–­ä¸¤ä¸ªå•é“¾è¡¨æ˜¯å¦ç›¸äº¤ æ•°æ®ç»“æ„é¢è¯• ä¹‹ å•é“¾è¡¨æ˜¯å¦æœ‰ç¯åŠç¯å…¥å£ç‚¹ é™„æœ‰æœ€è¯¦ç»†æ˜äº†çš„å›¾è§£ é“¾è¡¨ä¸­ç¯å½¢çš„å…¥å£ ã€å•é“¾è¡¨ã€‘ç¯çš„å…¥å£ç‚¹ åŸç†ç†è§£ï¼ å¦‚ä½•åˆ¤æ–­å•é“¾è¡¨æ˜¯å¦æœ‰ç¯ã€ç¯çš„å…¥å£ã€ç¯çš„é•¿åº¦å’Œæ€»é•¿ å¦‚ä½•åˆ¤æ–­åŒé“¾è¡¨æ˜¯å¦æœ‰ç¯ é¢è¯•ç²¾é€‰ï¼šé“¾è¡¨é—®é¢˜é›†é”¦","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Androidã€‘æºç åˆ†æ - Activityå¯åŠ¨æµç¨‹","slug":"ã€Androidã€‘æºç åˆ†æ - Activityå¯åŠ¨æµç¨‹","date":"2017-12-18T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/12/18/ã€Androidã€‘æºç åˆ†æ - Activityå¯åŠ¨æµç¨‹/","link":"","permalink":"http://github.com/2017/12/18/ã€Androidã€‘æºç åˆ†æ - Activityå¯åŠ¨æµç¨‹/","excerpt":"å¯åŠ¨Activityçš„æ–¹å¼Activityæœ‰2ç§å¯åŠ¨çš„æ–¹å¼ï¼Œä¸€ç§æ˜¯åœ¨Launcherç•Œé¢ç‚¹å‡»åº”ç”¨çš„å›¾æ ‡ã€å¦ä¸€ç§æ˜¯åœ¨åº”ç”¨ä¸­é€šè¿‡Intentè¿›è¡Œè·³è½¬ã€‚æˆ‘ä»¬ä¸»è¦ä»‹ç»ä¸åè€…ç›¸å…³çš„å¯åŠ¨æµç¨‹ã€‚ 12Intent intent = new Intent(this, TestActivity.class);startActivity(intent); ä»Activityå…¥æ‰‹123456789101112131415@Overridepublic void startActivity(Intent intent) &#123; this.startActivity(intent, null);&#125;@Overridepublic void startActivity(Intent intent, @Nullable Bundle options) &#123; if (options != null) &#123; startActivityForResult(intent, -1, options); &#125; else &#123; // Note we want to go through this call for compatibility with // applications that may have overridden the method. startActivityForResult(intent, -1); &#125;&#125;","text":"å¯åŠ¨Activityçš„æ–¹å¼Activityæœ‰2ç§å¯åŠ¨çš„æ–¹å¼ï¼Œä¸€ç§æ˜¯åœ¨Launcherç•Œé¢ç‚¹å‡»åº”ç”¨çš„å›¾æ ‡ã€å¦ä¸€ç§æ˜¯åœ¨åº”ç”¨ä¸­é€šè¿‡Intentè¿›è¡Œè·³è½¬ã€‚æˆ‘ä»¬ä¸»è¦ä»‹ç»ä¸åè€…ç›¸å…³çš„å¯åŠ¨æµç¨‹ã€‚ 12Intent intent = new Intent(this, TestActivity.class);startActivity(intent); ä»Activityå…¥æ‰‹123456789101112131415@Overridepublic void startActivity(Intent intent) &#123; this.startActivity(intent, null);&#125;@Overridepublic void startActivity(Intent intent, @Nullable Bundle options) &#123; if (options != null) &#123; startActivityForResult(intent, -1, options); &#125; else &#123; // Note we want to go through this call for compatibility with // applications that may have overridden the method. startActivityForResult(intent, -1); &#125;&#125; æˆ‘ä»¬çœ‹åˆ°æœ€ç»ˆéƒ½ä¼šè¿›å…¥startActivityForResult()æ–¹æ³•ã€‚æˆ‘ä»¬è·Ÿè¿›å»çœ‹çœ‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940public void startActivityForResult(Intent intent, int requestCode, @Nullable Bundle options) &#123; if (mParent == null) &#123; //è½¬äº¤ç»™Instrumentationæ¥startActivity Instrumentation.ActivityResult ar = mInstrumentation.execStartActivity( this, mMainThread.getApplicationThread(), mToken, this, intent, requestCode, options); if (ar != null) &#123; mMainThread.sendActivityResult( mToken, mEmbeddedID, requestCode, ar.getResultCode(), ar.getResultData()); &#125; if (requestCode &gt;= 0) &#123; // If this start is requesting a result, we can avoid making // the activity visible until the result is received. Setting // this code during onCreate(Bundle savedInstanceState) or onResume() will keep the // activity hidden during this time, to avoid flickering. // This can only be done when a result is requested because // that guarantees we will get information back when the // activity is finished, no matter what happens to it. mStartedActivity = true; &#125; final View decor = mWindow != null ? mWindow.peekDecorView() : null; if (decor != null) &#123; decor.cancelPendingInputEvents(); &#125; // TODO Consider clearing/flushing other event sources and events for child windows. &#125; else &#123; if (options != null) &#123; mParent.startActivityFromChild(this, intent, requestCode, options); &#125; else &#123; // Note we want to go through this method for compatibility with // existing applications that may have overridden it. mParent.startActivityFromChild(this, intent, requestCode); &#125; &#125; if (options != null &amp;&amp; !isTopOfTask()) &#123; mActivityTransitionState.startExitOutTransition(this, options); &#125;&#125; ç»§ç»­è¿›å…¥Instrumentationç±»ï¼Œçœ‹çœ‹execStartActivityæ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435//Instrumentationç±»public ActivityResult execStartActivity( Context who, IBinder contextThread, IBinder token, Activity target, Intent intent, int requestCode, Bundle options) &#123; IApplicationThread whoThread = (IApplicationThread) contextThread; if (mActivityMonitors != null) &#123; synchronized (mSync) &#123; final int N = mActivityMonitors.size(); for (int i=0; i&lt;N; i++) &#123; final ActivityMonitor am = mActivityMonitors.get(i); if (am.match(who, null, intent)) &#123; am.mHits++; if (am.isBlocking()) &#123; return requestCode &gt;= 0 ? am.getResult() : null; &#125; break; &#125; &#125; &#125; &#125; try &#123; intent.migrateExtraStreamToClipData(); intent.prepareToLeaveProcess(); //äº¤ç»™ActivityManagerNativeæ¥startActivity int result = ActivityManagerNative.getDefault() .startActivity(whoThread, who.getBasePackageName(), intent, intent.resolveTypeIfNeeded(who.getContentResolver()), token, target != null ? target.mEmbeddedID : null, requestCode, 0, null, options); //æ£€æŸ¥å¯åŠ¨Activityçš„ç»“æœ checkStartActivityResult(result, intent); &#125; catch (RemoteException e) &#123; &#125; return null;&#125; ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¯åŠ¨ActivityçœŸæ­£çš„å®ç°äº¤ç»™äº†ActivityManagerNative.getDefault()çš„startActivityæ–¹æ³•æ¥å®Œæˆã€‚ç„¶åå¯åŠ¨ä¹‹åé€šè¿‡checkStartActivityResult(result, intent);æ¥æ£€æŸ¥Activityçš„å¯åŠ¨ç»“æœï¼ˆæ¯”å¦‚Activityæ²¡æœ‰åœ¨AndroidManifest.xmlä¸­æ³¨å†Œå°±throw ActivityNotFoundExceptionçš„å¼‚å¸¸ç­‰ï¼‰ã€‚ æˆ‘ä»¬æ¥ç€é‡çœ‹ä¸‹è¿™ä¸ªActivityManagerNativeã€‚ ActivityManagerNativeæ˜¯ä»€ä¹ˆï¼ŸActivityManagerNativeæ¯”è¾ƒç‰¹æ®Šï¼Œä»ä¸‹é¢çš„å®šä¹‰å¯ä»¥çœ‹åˆ°å®ƒå°±æ˜¯ä¸€ä¸ªBinderå¯¹è±¡ï¼Œå¹¶å®ç°äº†IActivityManageræ¥å£ã€‚è€Œå®ƒçš„getDefault()æ–¹æ³•å…¶å®å°±æ˜¯é€šè¿‡asInterface(IBinder obj)æ–¹æ³•æ„å»ºçš„ActivityManagerProxy(obj)å•ä¾‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142public abstract class ActivityManagerNative extends Binder implements IActivityManager&#123; /** * Cast a Binder object into an activity manager interface, generating * a proxy if needed. */ static public IActivityManager asInterface(IBinder obj) &#123; if (obj == null) &#123; return null; &#125; IActivityManager in = (IActivityManager)obj.queryLocalInterface(descriptor); if (in != null) &#123; return in; &#125; return new ActivityManagerProxy(obj); &#125; /** * Retrieve the system's default/global activity manager. */ static public IActivityManager getDefault() &#123; return gDefault.get(); &#125; private static final Singleton&lt;IActivityManager&gt; gDefault = new Singleton&lt;IActivityManager&gt;() &#123; protected IActivityManager create() &#123; IBinder b = ServiceManager.getService(\"activity\"); if (false) &#123; Log.v(\"ActivityManager\", \"default service binder = \" + b); &#125; IActivityManager am = asInterface(b); if (false) &#123; Log.v(\"ActivityManager\", \"default service = \" + am); &#125; return am; &#125; &#125;; //...çœç•¥å…¶ä»–ä»£ç ...&#125; è€ŒActivityManagerNative.getDefault()å®é™…ä¸Šæ˜¯ä¸ªActivityManagerServiceï¼ˆç®€ç§°AMSï¼‰ï¼Œå› æ­¤Activityçš„å¯åŠ¨ä»»åŠ¡å…¶å®æœ€åäº¤ç»™äº†AMSä¸­ï¼Œ ActivityManagerServiceï¼ˆAMSï¼‰çœ‹AMSçš„startActivity()æ–¹æ³• 123456789101112131415161718192021222324252627//ActivityManagerServiceç±»@Overridepublic final int startActivity(IApplicationThread caller, String callingPackage, Intent intent, String resolvedType, IBinder resultTo, String resultWho, int requestCode, int startFlags, ProfilerInfo profilerInfo, Bundle options) &#123; //äº¤ç»™startActivityAsUseræ–¹æ³• return startActivityAsUser(caller, callingPackage, intent, resolvedType, resultTo, resultWho, requestCode, startFlags, profilerInfo, options, UserHandle.getCallingUserId());&#125; @Overridepublic final int startActivityAsUser(IApplicationThread caller, String callingPackage, Intent intent, String resolvedType, IBinder resultTo, String resultWho, int requestCode, int startFlags, ProfilerInfo profilerInfo, Bundle options, int userId) &#123; enforceNotIsolatedCaller(\"startActivity\"); userId = handleIncomingUser(Binder.getCallingPid(), Binder.getCallingUid(), userId, false, ALLOW_FULL_ONLY, \"startActivity\", null); // TODO: Switch to user app stacks here. return mStackSupervisor.startActivityMayWait(caller, -1, callingPackage, intent, resolvedType, null, null, resultTo, resultWho, requestCode, startFlags, profilerInfo, null, null, options, false, userId, null, null);&#125;/** mStackSupervisorçš„å®šä¹‰ Run all ActivityStacks through this */ActivityStackSupervisor mStackSupervisor; å¯ä»¥çœ‹å‡ºï¼ŒActivityå¯åŠ¨ä»»åŠ¡è¢«AMSè½¬äº¤ç»™äº†ActivityStackSupervisorçš„startActivityMayWaitæ–¹æ³•ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546//ActivityStackSupervisorç±»final int startActivityMayWait(IApplicationThread caller, int callingUid, String callingPackage, Intent intent, String resolvedType, IVoiceInteractionSession voiceSession, IVoiceInteractor voiceInteractor, IBinder resultTo, String resultWho, int requestCode, int startFlags, ProfilerInfo profilerInfo, WaitResult outResult, Configuration config, Bundle options, boolean ignoreTargetSecurity, int userId, IActivityContainer iContainer, TaskRecord inTask) &#123; //...çœç•¥ä¸€å¤§ç‰‡ä»£ç ... int res = startActivityLocked(caller, intent, resolvedType, aInfo, voiceSession, voiceInteractor, resultTo, resultWho, requestCode, callingPid, callingUid, callingPackage, realCallingPid, realCallingUid, startFlags, options, ignoreTargetSecurity, componentSpecified, null, container, inTask); //...å†çœç•¥ä¸€å¤§ç‰‡ä»£ç ...&#125;final int startActivityLocked(IApplicationThread caller, Intent intent, String resolvedType, ActivityInfo aInfo, IVoiceInteractionSession voiceSession, IVoiceInteractor voiceInteractor, IBinder resultTo, String resultWho, int requestCode, int callingPid, int callingUid, String callingPackage, int realCallingPid, int realCallingUid, int startFlags, Bundle options, boolean ignoreTargetSecurity, boolean componentSpecified, ActivityRecord[] outActivity, ActivityContainer container, TaskRecord inTask) &#123; int err = ActivityManager.START_SUCCESS; //...å†çœç•¥ä¸€å¤§ç‰‡ä»£ç ... err = startActivityUncheckedLocked(r, sourceRecord, voiceSession, voiceInteractor, startFlags, true, options, inTask); if (err &lt; 0) &#123; // If someone asked to have the keyguard dismissed on the next // activity start, but we are not actually doing an activity // switch... just dismiss the keyguard now, because we // probably want to see whatever is behind it. notifyActivityDrawnForKeyguard(); &#125; return err;&#125; ActivityStackSupervisorç±»ä¸­çš„startActivityMayWaitæ–¹æ³•è°ƒç”¨startActivityLocked()ç»§ç»­æ‰§è¡Œï¼Œè€ŒstartActivityLocked()æ–¹æ³•ä¸­åˆä¼šè°ƒç”¨startActivityUncheckedLocked()æ–¹æ³•ï¼Œç„¶åä¼šè°ƒç”¨resumeTopActivitiesLocked()æ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132//ActivityStackSupervisorç±»boolean resumeTopActivitiesLocked() &#123; return resumeTopActivitiesLocked(null, null, null);&#125;boolean resumeTopActivitiesLocked(ActivityStack targetStack, ActivityRecord target, Bundle targetOptions) &#123; if (targetStack == null) &#123; targetStack = mFocusedStack; &#125; // Do targetStack first. boolean result = false; if (isFrontStack(targetStack)) &#123; //åˆ°è¿™é‡Œï¼Œå¯åŠ¨è¿‡ç¨‹ä»ActivityStackSupervisorç±»äº¤ç»™äº†ActivityStackç±» result = targetStack.resumeTopActivityLocked(target, targetOptions); &#125; for (int displayNdx = mActivityDisplays.size() - 1; displayNdx &gt;= 0; --displayNdx) &#123; final ArrayList&lt;ActivityStack&gt; stacks = mActivityDisplays.valueAt(displayNdx).mStacks; for (int stackNdx = stacks.size() - 1; stackNdx &gt;= 0; --stackNdx) &#123; final ActivityStack stack = stacks.get(stackNdx); if (stack == targetStack) &#123; // Already started above. continue; &#125; if (isFrontStack(stack)) &#123; stack.resumeTopActivityLocked(null); &#125; &#125; &#125; return result;&#125; ä¸Šé¢ä»£ç èƒ½çœ‹åˆ°ï¼Œæœ€åå¯åŠ¨è¿‡ç¨‹ä»ActivityStackSupervisorç±»äº¤ç»™äº†ActivityStackç±»ã€‚ è·Ÿè¿›å®ƒçš„resumeTopActivityLockedæ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233/** * Ensure that the top activity in the stack is resumed. * * @param prev The previously resumed activity, for when in the process * of pausing; can be null to call from elsewhere. * * @return Returns true if something is being resumed, or false if * nothing happened. */final boolean resumeTopActivityLocked(ActivityRecord prev) &#123; return resumeTopActivityLocked(prev, null);&#125;final boolean resumeTopActivityLocked(ActivityRecord prev, Bundle options) &#123; if (mStackSupervisor.inResumeTopActivity) &#123; // Don't even start recursing. return false; &#125; boolean result = false; try &#123; // Protect against recursion. mStackSupervisor.inResumeTopActivity = true; if (mService.mLockScreenShown == ActivityManagerService.LOCK_SCREEN_LEAVING) &#123; mService.mLockScreenShown = ActivityManagerService.LOCK_SCREEN_HIDDEN; mService.updateSleepIfNeededLocked(); &#125; //æ³¨æ„è¿™é‡Œ result = resumeTopActivityInnerLocked(prev, options); &#125; finally &#123; mStackSupervisor.inResumeTopActivity = false; &#125; return result;&#125; ç»§ç»­çœ‹çœ‹resumeTopActivityInnerLocked()æ–¹æ³• 12345678private boolean resumeTopActivityInnerLocked(ActivityRecord prev, Bundle options) &#123; //çœ‹è¿™é‡Œï¼Œåˆè¿”å›äº¤ç»™äº†ActivityStackSupervisorç±» mStackSupervisor.startSpecificActivityLocked(next, true, false); //...çœç•¥ä¸€å¤§ç‰‡ä»£ç ...&#125; åˆè¿”å›ActivityStackSupervisorç±»12345678910111213141516171819202122232425262728293031323334//ActivityStackSupervisorç±»void startSpecificActivityLocked(ActivityRecord r, boolean andResume, boolean checkConfig) &#123; // Is this activity's application already running? // åˆ¤æ–­éœ€è¦å¯åŠ¨çš„Activityæ‰€åœ¨è¿›ç¨‹å’Œappå·²ç»å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ï¼Œç›´æ¥å¯åŠ¨ï¼Œå¦åˆ™å‡†å¤‡åˆ›å»ºè¯¥è¿›ç¨‹ã€‚ ProcessRecord app = mService.getProcessRecordLocked(r.processName, r.info.applicationInfo.uid, true); r.task.stack.setLaunchTime(r); if (app != null &amp;&amp; app.thread != null) &#123; try &#123; if ((r.info.flags&amp;ActivityInfo.FLAG_MULTIPROCESS) == 0 || !\"android\".equals(r.info.packageName)) &#123; // Don't add this if it is a platform component that is marked // to run in multiple processes, because this is actually // part of the framework so doesn't make sense to track as a // separate apk in the process. app.addPackage(r.info.packageName, r.info.applicationInfo.versionCode, mService.mProcessStats); &#125; //æ³¨æ„è¿™é‡Œ realStartActivityLocked(r, app, andResume, checkConfig); return; &#125; catch (RemoteException e) &#123; Slog.w(TAG, \"Exception when starting activity \" + r.intent.getComponent().flattenToShortString(), e); &#125; // If a dead object exception was thrown -- fall through to // restart the application. &#125; // å¦åˆ™å‡†å¤‡åˆ›å»ºè¯¥è¿›ç¨‹ mService.startProcessLocked(r.processName, r.info.applicationInfo, true, 0, \"activity\", r.intent.getComponent(), false, false, true);&#125; ä¸Šé¢çš„startSpecificActivityLocked()æ–¹æ³•ï¼Œé¦–å…ˆåˆ¤æ–­éœ€è¦å¯åŠ¨çš„Activityæ‰€åœ¨è¿›ç¨‹å’Œappæ˜¯å¦å·²ç»å­˜åœ¨ã€‚è‹¥å­˜åœ¨ï¼Œç›´æ¥æ‹¿ç€è¯¥è¿›è¡Œä¿¡æ¯å»å¯åŠ¨è¯¥Activityï¼Œå¦åˆ™å‡†å¤‡åˆ›å»ºè¯¥è¿›ç¨‹ã€‚ æˆ‘ä»¬ç®€å•å…ˆçœ‹ä¸‹åˆ›å»ºè¯¥Appè¿›ç¨‹çš„æ–¹æ³•startProcessLocked()ï¼Œä½äºActivityManagerServiceç±»ä¸­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354//ActivityManagerServiceç±»ä¸­private final void startProcessLocked(ProcessRecord app, String hostingType, String hostingNameStr, String abiOverride, String entryPoint, String[] entryPointArgs) &#123; long startTime = SystemClock.elapsedRealtime(); if (app.pid &gt; 0 &amp;&amp; app.pid != MY_PID) &#123; checkTime(startTime, \"startProcess: removing from pids map\"); synchronized (mPidsSelfLocked) &#123; mPidsSelfLocked.remove(app.pid); mHandler.removeMessages(PROC_START_TIMEOUT_MSG, app); &#125; checkTime(startTime, \"startProcess: done removing from pids map\"); app.setPid(0); &#125; if (DEBUG_PROCESSES &amp;&amp; mProcessesOnHold.contains(app)) Slog.v(TAG_PROCESSES, \"startProcessLocked removing on hold: \" + app); mProcessesOnHold.remove(app); checkTime(startTime, \"startProcess: starting to update cpu stats\"); updateCpuStats(); checkTime(startTime, \"startProcess: done updating cpu stats\"); try &#123; //...çœç•¥å…¶ä»–ä»£ç ... // Process.start()å®Œæˆäº†ActivityThreadçš„åˆ›å»ºï¼Œä¹‹åå°±ä¼šæ‰§è¡ŒActivityThreadçš„main()æ–¹æ³• // Start the process. It will either succeed and return a result containing // the PID of the new process, or else throw a RuntimeException. boolean isActivityProcess = (entryPoint == null); if (entryPoint == null) entryPoint = \"android.app.ActivityThread\"; Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"Start proc: \" + app.processName); checkTime(startTime, \"startProcess: asking zygote to start proc\"); Process.ProcessStartResult startResult = Process.start(entryPoint, app.processName, uid, uid, gids, debugFlags, mountExternal, app.info.targetSdkVersion, app.info.seinfo, requiredAbi, instructionSet, app.info.dataDir, entryPointArgs); checkTime(startTime, \"startProcess: returned from zygote!\"); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); //...çœç•¥å…¶ä»–ä»£ç ... &#125; catch (RuntimeException e) &#123; // XXX do better error recovery. app.setPid(0); mBatteryStatsService.noteProcessFinish(app.processName, app.info.uid); if (app.isolated) &#123; mBatteryStatsService.removeIsolatedUid(app.uid, app.info.uid); &#125; Slog.e(TAG, \"Failure starting process \" + app.processName, e); &#125;&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•å°±æ˜¯ä½¿ç”¨Process.start()ï¼Œå¹¶é€šè¿‡Socketè¿æ¥çš„æ–¹å¼å­µåŒ–æ–°å»ºäº†ä¸€ä¸ªZygoteè¿›ç¨‹ï¼Œå®Œæˆäº†ActivityThreadçš„åˆ›å»ºï¼Œä¹‹åå°±ä¼šæ‰§è¡ŒActivityThreadçš„main()æ–¹æ³•ã€‚ æ¥ç€ä¸Šé¢ï¼ŒAppè¿›ç¨‹å¦‚æœå­˜åœ¨å°±ä¼šç›´æ¥è°ƒç”¨realStartActivityLocked()æ–¹æ³•ï¼š 123456789101112131415161718192021//ActivityStackSupervisorç±»ä¸­final boolean realStartActivityLocked(ActivityRecord r, ProcessRecord app, boolean andResume, boolean checkConfig) throws RemoteException &#123; //...çœç•¥å…¶ä»–ä»£ç ... try &#123; app.forceProcessStateUpTo(mService.mTopProcessState); app.thread.scheduleLaunchActivity(new Intent(r.intent), r.appToken, System.identityHashCode(r), r.info, new Configuration(mService.mConfiguration), new Configuration(stack.mOverrideConfig), r.compat, r.launchedFromPackage, task.voiceInteractor, app.repProcState, r.icicle, r.persistentState, results, newIntents, !andResume, mService.isNextTransitionForward(), profilerInfo); &#125; catch (RemoteException e) &#123; throw e; &#125; return true;&#125; ä¸Šé¢çš„è°ƒç”¨äº†app.threadçš„scheduleLaunchActivity()æ–¹æ³•ï¼Œappçš„ç±»å‹æ˜¯ProcessRecordç±»ï¼Œå®ƒçš„threadæˆå‘˜å˜é‡å®šä¹‰å¦‚ä¸‹ï¼Œæ˜¯ä¸€ä¸ªIApplicationThreadå¯¹è±¡ï¼š 123456789101112131415161718192021222324/** * Full information about a particular process that * is currently running. */final class ProcessRecord &#123; private static final String TAG = TAG_WITH_CLASS_NAME ? \"ProcessRecord\" : TAG_AM; private final BatteryStatsImpl mBatteryStats; // where to collect runtime statistics final ApplicationInfo info; // all about the first app in the process final boolean isolated; // true if this is a special isolated process final int uid; // uid of process; may be different from 'info' if isolated final int userId; // user of process. final String processName; // name of the process // List of packages running in the process final ArrayMap&lt;String, ProcessStats.ProcessStateHolder&gt; pkgList = new ArrayMap&lt;&gt;(); UidRecord uidRecord; // overall state of process's uid. ArraySet&lt;String&gt; pkgDeps; // additional packages we have a dependency on IApplicationThread thread; // the actual proc... may be null only if // 'persistent' is true (in which case we // are in the process of launching the app)&#125; //...çœç•¥å…¶ä»–ä»£ç ... è€ŒIApplicationThreadçš„å£°æ˜å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167/** * System private API for communicating with the application. This is given to * the activity manager by an application when it starts up, for the activity * manager to tell the application about things it needs to do. * * &#123;@hide&#125; */public interface IApplicationThread extends IInterface &#123; void schedulePauseActivity(IBinder token, boolean finished, boolean userLeaving, int configChanges, boolean dontReport) throws RemoteException; void scheduleStopActivity(IBinder token, boolean showWindow, int configChanges) throws RemoteException; void scheduleWindowVisibility(IBinder token, boolean showWindow) throws RemoteException; void scheduleSleeping(IBinder token, boolean sleeping) throws RemoteException; void scheduleResumeActivity(IBinder token, int procState, boolean isForward, Bundle resumeArgs) throws RemoteException; void scheduleSendResult(IBinder token, List&lt;ResultInfo&gt; results) throws RemoteException; void scheduleLaunchActivity(Intent intent, IBinder token, int ident, ActivityInfo info, Configuration curConfig, Configuration overrideConfig, CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor, int procState, Bundle state, PersistableBundle persistentState, List&lt;ResultInfo&gt; pendingResults, List&lt;ReferrerIntent&gt; pendingNewIntents, boolean notResumed, boolean isForward, ProfilerInfo profilerInfo) throws RemoteException; void scheduleRelaunchActivity(IBinder token, List&lt;ResultInfo&gt; pendingResults, List&lt;ReferrerIntent&gt; pendingNewIntents, int configChanges, boolean notResumed, Configuration config, Configuration overrideConfig) throws RemoteException; void scheduleNewIntent(List&lt;ReferrerIntent&gt; intent, IBinder token) throws RemoteException; void scheduleDestroyActivity(IBinder token, boolean finished, int configChanges) throws RemoteException; void scheduleReceiver(Intent intent, ActivityInfo info, CompatibilityInfo compatInfo, int resultCode, String data, Bundle extras, boolean sync, int sendingUser, int processState) throws RemoteException; static final int BACKUP_MODE_INCREMENTAL = 0; static final int BACKUP_MODE_FULL = 1; static final int BACKUP_MODE_RESTORE = 2; static final int BACKUP_MODE_RESTORE_FULL = 3; void scheduleCreateBackupAgent(ApplicationInfo app, CompatibilityInfo compatInfo, int backupMode) throws RemoteException; void scheduleDestroyBackupAgent(ApplicationInfo app, CompatibilityInfo compatInfo) throws RemoteException; void scheduleCreateService(IBinder token, ServiceInfo info, CompatibilityInfo compatInfo, int processState) throws RemoteException; void scheduleBindService(IBinder token, Intent intent, boolean rebind, int processState) throws RemoteException; void scheduleUnbindService(IBinder token, Intent intent) throws RemoteException; void scheduleServiceArgs(IBinder token, boolean taskRemoved, int startId, int flags, Intent args) throws RemoteException; void scheduleStopService(IBinder token) throws RemoteException; static final int DEBUG_OFF = 0; static final int DEBUG_ON = 1; static final int DEBUG_WAIT = 2; void bindApplication(String packageName, ApplicationInfo info, List&lt;ProviderInfo&gt; providers, ComponentName testName, ProfilerInfo profilerInfo, Bundle testArguments, IInstrumentationWatcher testWatcher, IUiAutomationConnection uiAutomationConnection, int debugMode, boolean openGlTrace, boolean restrictedBackupMode, boolean persistent, Configuration config, CompatibilityInfo compatInfo, Map&lt;String, IBinder&gt; services, Bundle coreSettings) throws RemoteException; void scheduleExit() throws RemoteException; void scheduleSuicide() throws RemoteException; void scheduleConfigurationChanged(Configuration config) throws RemoteException; void updateTimeZone() throws RemoteException; void clearDnsCache() throws RemoteException; void setHttpProxy(String proxy, String port, String exclList, Uri pacFileUrl) throws RemoteException; void processInBackground() throws RemoteException; void dumpService(FileDescriptor fd, IBinder servicetoken, String[] args) throws RemoteException; void dumpProvider(FileDescriptor fd, IBinder servicetoken, String[] args) throws RemoteException; void scheduleRegisteredReceiver(IIntentReceiver receiver, Intent intent, int resultCode, String data, Bundle extras, boolean ordered, boolean sticky, int sendingUser, int processState) throws RemoteException; void scheduleLowMemory() throws RemoteException; void scheduleActivityConfigurationChanged(IBinder token, Configuration overrideConfig) throws RemoteException; void profilerControl(boolean start, ProfilerInfo profilerInfo, int profileType) throws RemoteException; void dumpHeap(boolean managed, String path, ParcelFileDescriptor fd) throws RemoteException; void setSchedulingGroup(int group) throws RemoteException; static final int PACKAGE_REMOVED = 0; static final int EXTERNAL_STORAGE_UNAVAILABLE = 1; void dispatchPackageBroadcast(int cmd, String[] packages) throws RemoteException; void scheduleCrash(String msg) throws RemoteException; void dumpActivity(FileDescriptor fd, IBinder servicetoken, String prefix, String[] args) throws RemoteException; void setCoreSettings(Bundle coreSettings) throws RemoteException; void updatePackageCompatibilityInfo(String pkg, CompatibilityInfo info) throws RemoteException; void scheduleTrimMemory(int level) throws RemoteException; void dumpMemInfo(FileDescriptor fd, Debug.MemoryInfo mem, boolean checkin, boolean dumpInfo, boolean dumpDalvik, boolean dumpSummaryOnly, String[] args) throws RemoteException; void dumpGfxInfo(FileDescriptor fd, String[] args) throws RemoteException; void dumpDbInfo(FileDescriptor fd, String[] args) throws RemoteException; void unstableProviderDied(IBinder provider) throws RemoteException; void requestAssistContextExtras(IBinder activityToken, IBinder requestToken, int requestType) throws RemoteException; void scheduleTranslucentConversionComplete(IBinder token, boolean timeout) throws RemoteException; void scheduleOnNewActivityOptions(IBinder token, ActivityOptions options) throws RemoteException; void setProcessState(int state) throws RemoteException; void scheduleInstallProvider(ProviderInfo provider) throws RemoteException; void updateTimePrefs(boolean is24Hour) throws RemoteException; void scheduleCancelVisibleBehind(IBinder token) throws RemoteException; void scheduleBackgroundVisibleBehindChanged(IBinder token, boolean enabled) throws RemoteException; void scheduleEnterAnimationComplete(IBinder token) throws RemoteException; void notifyCleartextNetwork(byte[] firstPacket) throws RemoteException; String descriptor = \"android.app.IApplicationThread\"; int SCHEDULE_PAUSE_ACTIVITY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION; int SCHEDULE_STOP_ACTIVITY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+2; int SCHEDULE_WINDOW_VISIBILITY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+3; int SCHEDULE_RESUME_ACTIVITY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+4; int SCHEDULE_SEND_RESULT_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+5; int SCHEDULE_LAUNCH_ACTIVITY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+6; int SCHEDULE_NEW_INTENT_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+7; int SCHEDULE_FINISH_ACTIVITY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+8; int SCHEDULE_RECEIVER_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+9; int SCHEDULE_CREATE_SERVICE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+10; int SCHEDULE_STOP_SERVICE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+11; int BIND_APPLICATION_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+12; int SCHEDULE_EXIT_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+13; int SCHEDULE_CONFIGURATION_CHANGED_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+15; int SCHEDULE_SERVICE_ARGS_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+16; int UPDATE_TIME_ZONE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+17; int PROCESS_IN_BACKGROUND_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+18; int SCHEDULE_BIND_SERVICE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+19; int SCHEDULE_UNBIND_SERVICE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+20; int DUMP_SERVICE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+21; int SCHEDULE_REGISTERED_RECEIVER_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+22; int SCHEDULE_LOW_MEMORY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+23; int SCHEDULE_ACTIVITY_CONFIGURATION_CHANGED_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+24; int SCHEDULE_RELAUNCH_ACTIVITY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+25; int SCHEDULE_SLEEPING_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+26; int PROFILER_CONTROL_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+27; int SET_SCHEDULING_GROUP_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+28; int SCHEDULE_CREATE_BACKUP_AGENT_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+29; int SCHEDULE_DESTROY_BACKUP_AGENT_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+30; int SCHEDULE_ON_NEW_ACTIVITY_OPTIONS_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+31; int SCHEDULE_SUICIDE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+32; int DISPATCH_PACKAGE_BROADCAST_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+33; int SCHEDULE_CRASH_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+34; int DUMP_HEAP_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+35; int DUMP_ACTIVITY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+36; int CLEAR_DNS_CACHE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+37; int SET_HTTP_PROXY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+38; int SET_CORE_SETTINGS_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+39; int UPDATE_PACKAGE_COMPATIBILITY_INFO_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+40; int SCHEDULE_TRIM_MEMORY_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+41; int DUMP_MEM_INFO_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+42; int DUMP_GFX_INFO_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+43; int DUMP_PROVIDER_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+44; int DUMP_DB_INFO_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+45; int UNSTABLE_PROVIDER_DIED_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+46; int REQUEST_ASSIST_CONTEXT_EXTRAS_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+47; int SCHEDULE_TRANSLUCENT_CONVERSION_COMPLETE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+48; int SET_PROCESS_STATE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+49; int SCHEDULE_INSTALL_PROVIDER_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+50; int UPDATE_TIME_PREFS_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+51; int CANCEL_VISIBLE_BEHIND_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+52; int BACKGROUND_VISIBLE_BEHIND_CHANGED_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+53; int ENTER_ANIMATION_COMPLETE_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+54; int NOTIFY_CLEARTEXT_NETWORK_TRANSACTION = IBinder.FIRST_CALL_TRANSACTION+55;&#125; å¯ä»¥çœ‹åˆ°IApplicationThreadå®ƒç»§æ‰¿äº†IInterfaceæ¥å£ï¼Œæ˜¯ä¸€ä¸ªBinderç±»å‹æ¥å£ã€‚é‡Œé¢åŒ…å«äº†å¤§é‡çš„å¯åŠ¨ã€åœæ­¢Activityçš„æ¥å£ï¼Œå¯åŠ¨ã€åœæ­¢Serviceçš„æ¥å£ã€‚é‚£ä¹ˆå®ƒçš„å®ç°è€…åˆ°åº•æ˜¯è°å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ActivityThreadç±»é‡Œçš„å†…éƒ¨ç±»ApplicationThreadï¼Œæˆ‘ä»¬å»çœ‹çœ‹å®ƒçš„å®šä¹‰ï¼š 123private class ApplicationThread extends ApplicationThreadNative &#123;...&#125;public abstract class ApplicationThreadNative extends Binder implements IApplicationThread &#123; å¯ä»¥çœ‹åˆ°ï¼ŒApplicationThreadç±»ç»§æ‰¿è‡ªApplicationThreadNativeï¼Œè€ŒApplicationThreadNativeæ˜¯ä¸€ä¸ªBinderå¯¹è±¡å¹¶ä¸”å®ç°äº†IApplicationThreadæ¥å£ã€‚ è€Œä¸”åœ¨ApplicationThreadNativeç±»çš„å†…éƒ¨æœ‰ä¸€ä¸ªApplicationThreadProxyä»£ç†ç±»ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394public abstract class ApplicationThreadNative extends Binder implements IApplicationThread &#123; /** * Cast a Binder object into an application thread interface, generating * a proxy if needed. */ static public IApplicationThread asInterface(IBinder obj) &#123; if (obj == null) &#123; return null; &#125; IApplicationThread in = (IApplicationThread)obj.queryLocalInterface(descriptor); if (in != null) &#123; return in; &#125; return new ApplicationThreadProxy(obj); &#125; public ApplicationThreadNative() &#123; attachInterface(this, descriptor); &#125; @Override public boolean onTransact(int code, Parcel data, Parcel reply, int flags) throws RemoteException &#123; switch (code) &#123; case SCHEDULE_PAUSE_ACTIVITY_TRANSACTION: &#123; data.enforceInterface(IApplicationThread.descriptor); IBinder b = data.readStrongBinder(); boolean finished = data.readInt() != 0; boolean userLeaving = data.readInt() != 0; int configChanges = data.readInt(); boolean dontReport = data.readInt() != 0; schedulePauseActivity(b, finished, userLeaving, configChanges, dontReport); return true; &#125; case SCHEDULE_STOP_ACTIVITY_TRANSACTION: &#123; data.enforceInterface(IApplicationThread.descriptor); IBinder b = data.readStrongBinder(); boolean show = data.readInt() != 0; int configChanges = data.readInt(); scheduleStopActivity(b, show, configChanges); return true; &#125; //...çœç•¥ä¸€å¤§ç‰‡ä»£ç ... return super.onTransact(code, data, reply, flags); &#125;&#125;class ApplicationThreadProxy implements IApplicationThread &#123; private final IBinder mRemote; public ApplicationThreadProxy(IBinder remote) &#123; mRemote = remote; &#125; public final IBinder asBinder() &#123; return mRemote; &#125; public final void schedulePauseActivity(IBinder token, boolean finished, boolean userLeaving, int configChanges, boolean dontReport) throws RemoteException &#123; Parcel data = Parcel.obtain(); data.writeInterfaceToken(IApplicationThread.descriptor); data.writeStrongBinder(token); data.writeInt(finished ? 1 : 0); data.writeInt(userLeaving ? 1 :0); data.writeInt(configChanges); data.writeInt(dontReport ? 1 : 0); mRemote.transact(SCHEDULE_PAUSE_ACTIVITY_TRANSACTION, data, null, IBinder.FLAG_ONEWAY); data.recycle(); &#125; public final void scheduleStopActivity(IBinder token, boolean showWindow, int configChanges) throws RemoteException &#123; Parcel data = Parcel.obtain(); data.writeInterfaceToken(IApplicationThread.descriptor); data.writeStrongBinder(token); data.writeInt(showWindow ? 1 : 0); data.writeInt(configChanges); mRemote.transact(SCHEDULE_STOP_ACTIVITY_TRANSACTION, data, null, IBinder.FLAG_ONEWAY); data.recycle(); &#125; //...çœç•¥ä¸€å¤§ç‰‡ä»£ç ...&#125; ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æµç¨‹ï¼Œæœ€ç»ˆä»AMSå›è°ƒåˆ°äº†ApplicationThreadä¸­ï¼Œæˆ‘ä»¬çœ‹çœ‹ApplicationThreadç±»çš„scheduleLaunchActivity()æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031//ä½äºActivityThreadç±»ä¸­çš„å†…éƒ¨ç±»ApplicationThreadç±»ä¸­//// we use token to identify this activity without having to send the// activity itself back to the activity manager. (matters more with ipc)@Overridepublic final void scheduleLaunchActivity(Intent intent, IBinder token, int ident, ActivityInfo info, Configuration curConfig, Configuration overrideConfig, CompatibilityInfo compatInfo, String referrer, IVoiceInteractor voiceInteractor, int procState, Bundle state, PersistableBundle persistentState, List&lt;ResultInfo&gt; pendingResults, List&lt;ReferrerIntent&gt; pendingNewIntents, boolean notResumed, boolean isForward, ProfilerInfo profilerInfo) &#123; updateProcessState(procState, false); ActivityClientRecord r = new ActivityClientRecord(); r.token = token; r.ident = ident; r.intent = intent; r.referrer = referrer; r.voiceInteractor = voiceInteractor; r.activityInfo = info; r.compatInfo = compatInfo; r.state = state; r.persistentState = persistentState; r.pendingResults = pendingResults; r.pendingIntents = pendingNewIntents; r.startsNotResumed = notResumed; r.isForward = isForward; r.profilerInfo = profilerInfo; r.overrideConfig = overrideConfig; updatePendingConfiguration(curConfig); sendMessage(H.LAUNCH_ACTIVITY, r);&#125; å¯ä»¥çœ‹åˆ°ï¼ŒscheduleLaunchActivityæ–¹æ³•å°±æ˜¯å‘é€äº†ä¸€ä¸ªå¯åŠ¨Activityçš„Messageäº¤ç»™Hè¿™ä¸ªHandlerï¼Œè¿™ä¸ªHandlerå®šä¹‰å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114private class H extends Handler &#123; public static final int LAUNCH_ACTIVITY = 100; public static final int PAUSE_ACTIVITY = 101; public static final int PAUSE_ACTIVITY_FINISHING= 102; public static final int STOP_ACTIVITY_SHOW = 103; public static final int STOP_ACTIVITY_HIDE = 104; public static final int SHOW_WINDOW = 105; public static final int HIDE_WINDOW = 106; public static final int RESUME_ACTIVITY = 107; public static final int SEND_RESULT = 108; public static final int DESTROY_ACTIVITY = 109; public static final int BIND_APPLICATION = 110; public static final int EXIT_APPLICATION = 111; public static final int NEW_INTENT = 112; public static final int RECEIVER = 113; public static final int CREATE_SERVICE = 114; public static final int SERVICE_ARGS = 115; public static final int STOP_SERVICE = 116; public static final int CONFIGURATION_CHANGED = 118; public static final int CLEAN_UP_CONTEXT = 119; public static final int GC_WHEN_IDLE = 120; public static final int BIND_SERVICE = 121; public static final int UNBIND_SERVICE = 122; public static final int DUMP_SERVICE = 123; public static final int LOW_MEMORY = 124; public static final int ACTIVITY_CONFIGURATION_CHANGED = 125; public static final int RELAUNCH_ACTIVITY = 126; public static final int PROFILER_CONTROL = 127; public static final int CREATE_BACKUP_AGENT = 128; public static final int DESTROY_BACKUP_AGENT = 129; public static final int SUICIDE = 130; public static final int REMOVE_PROVIDER = 131; public static final int ENABLE_JIT = 132; public static final int DISPATCH_PACKAGE_BROADCAST = 133; public static final int SCHEDULE_CRASH = 134; public static final int DUMP_HEAP = 135; public static final int DUMP_ACTIVITY = 136; public static final int SLEEPING = 137; public static final int SET_CORE_SETTINGS = 138; public static final int UPDATE_PACKAGE_COMPATIBILITY_INFO = 139; public static final int TRIM_MEMORY = 140; public static final int DUMP_PROVIDER = 141; public static final int UNSTABLE_PROVIDER_DIED = 142; public static final int REQUEST_ASSIST_CONTEXT_EXTRAS = 143; public static final int TRANSLUCENT_CONVERSION_COMPLETE = 144; public static final int INSTALL_PROVIDER = 145; public static final int ON_NEW_ACTIVITY_OPTIONS = 146; public static final int CANCEL_VISIBLE_BEHIND = 147; public static final int BACKGROUND_VISIBLE_BEHIND_CHANGED = 148; public static final int ENTER_ANIMATION_COMPLETE = 149; public void handleMessage(Message msg) &#123; if (DEBUG_MESSAGES) Slog.v(TAG, \"&gt;&gt;&gt; handling: \" + codeToString(msg.what)); switch (msg.what) &#123; case LAUNCH_ACTIVITY: &#123; Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityStart\"); final ActivityClientRecord r = (ActivityClientRecord) msg.obj; r.packageInfo = getPackageInfoNoCheck( r.activityInfo.applicationInfo, r.compatInfo); handleLaunchActivity(r, null); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); &#125; break; case RELAUNCH_ACTIVITY: &#123; Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityRestart\"); ActivityClientRecord r = (ActivityClientRecord)msg.obj; handleRelaunchActivity(r); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); &#125; break; case PAUSE_ACTIVITY: Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityPause\"); handlePauseActivity((IBinder)msg.obj, false, (msg.arg1&amp;1) != 0, msg.arg2, (msg.arg1&amp;2) != 0); maybeSnapshot(); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); break; case PAUSE_ACTIVITY_FINISHING: Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityPause\"); handlePauseActivity((IBinder)msg.obj, true, (msg.arg1&amp;1) != 0, msg.arg2, (msg.arg1&amp;1) != 0); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); break; case STOP_ACTIVITY_SHOW: Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityStop\"); handleStopActivity((IBinder)msg.obj, true, msg.arg2); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); break; case STOP_ACTIVITY_HIDE: Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityStop\"); handleStopActivity((IBinder)msg.obj, false, msg.arg2); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); break; case SHOW_WINDOW: Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityShowWindow\"); handleWindowVisibility((IBinder)msg.obj, true); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); break; case HIDE_WINDOW: Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityHideWindow\"); handleWindowVisibility((IBinder)msg.obj, false); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); break; case RESUME_ACTIVITY: Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, \"activityResume\"); handleResumeActivity((IBinder) msg.obj, true, msg.arg1 != 0, true); Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER); break; //...çœç•¥å…¶ä»–ä»£ç ... &#125; &#125; //...çœç•¥å…¶ä»–ä»£ç ...&#125; Hè¿™ä¸ªHandlerå¯¹LAUNCH_ACTIVITYçš„å¤„ç†å°±æ˜¯è°ƒç”¨äº†handleLaunchActivityæ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677//ActivityThreadç±»ä¸­private void handleLaunchActivity(ActivityClientRecord r, Intent customIntent) &#123; // If we are getting ready to gc after going to the background, well // we are back active so skip it. unscheduleGcIdler(); mSomeActivitiesChanged = true; if (r.profilerInfo != null) &#123; mProfiler.setProfiler(r.profilerInfo); mProfiler.startProfiling(); &#125; // Make sure we are running with the most recent config. handleConfigurationChanged(null, null); if (localLOGV) Slog.v( TAG, \"Handling launch of \" + r); // Initialize before creating the activity WindowManagerGlobal.initialize(); //æ³¨æ„è¿™é‡Œ Activity a = performLaunchActivity(r, customIntent); if (a != null) &#123; r.createdConfig = new Configuration(mConfiguration); Bundle oldState = r.state; //æ³¨æ„è¿™é‡Œ handleResumeActivity(r.token, false, r.isForward, !r.activity.mFinished &amp;&amp; !r.startsNotResumed); if (!r.activity.mFinished &amp;&amp; r.startsNotResumed) &#123; // The activity manager actually wants this one to start out // paused, because it needs to be visible but isn't in the // foreground. We accomplish this by going through the // normal startup (because activities expect to go through // onResume() the first time they run, before their window // is displayed), and then pausing it. However, in this case // we do -not- need to do the full pause cycle (of freezing // and such) because the activity manager assumes it can just // retain the current state it has. try &#123; r.activity.mCalled = false; mInstrumentation.callActivityOnPause(r.activity); // We need to keep around the original state, in case // we need to be created again. But we only do this // for pre-Honeycomb apps, which always save their state // when pausing, so we can not have them save their state // when restarting from a paused state. For HC and later, // we want to (and can) let the state be saved as the normal // part of stopping the activity. if (r.isPreHoneycomb()) &#123; r.state = oldState; &#125; if (!r.activity.mCalled) &#123; throw new SuperNotCalledException( \"Activity \" + r.intent.getComponent().toShortString() + \" did not call through to super.onPause()\"); &#125; &#125; catch (SuperNotCalledException e) &#123; throw e; &#125; catch (Exception e) &#123; if (!mInstrumentation.onException(r.activity, e)) &#123; throw new RuntimeException( \"Unable to pause activity \" + r.intent.getComponent().toShortString() + \": \" + e.toString(), e); &#125; &#125; r.paused = true; &#125; &#125; else &#123; // If there was an error, for any reason, tell the activity // manager to stop us. try &#123; ActivityManagerNative.getDefault() .finishActivity(r.token, Activity.RESULT_CANCELED, null, false); &#125; catch (RemoteException ex) &#123; // Ignore &#125; &#125;&#125; æœ€ç»ˆï¼š é€šè¿‡ActivityThreadçš„performLaunchActivity()æ–¹æ³•å®Œæˆäº†Activityçš„åˆ›å»ºå’Œå¯åŠ¨è¿‡ç¨‹ï¼› é€šè¿‡handleResumeActivity()æ–¹æ³•è°ƒç”¨äº†è¿™ä¸ªActivityçš„onResume()ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ performLaunchActivity()æ–¹æ³•performLaunchActivity()æ–¹æ³•ä¸»è¦å®Œæˆäº†Activityçš„åˆå§‹åŒ–ä»»åŠ¡ï¼Œæ ¹æ®æ³¨é‡Šå¤§è‡´å¯ä»¥åˆ†ä¸ºå››æ­¥ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137private Activity performLaunchActivity(ActivityClientRecord r, Intent customIntent) &#123; //1. ä»ActivityClientRecordä¸­è¯»å–Activityçš„ç»„ä»¶ä¿¡æ¯ ActivityInfo aInfo = r.activityInfo; if (r.packageInfo == null) &#123; r.packageInfo = getPackageInfo(aInfo.applicationInfo, r.compatInfo, Context.CONTEXT_INCLUDE_CODE); &#125; ComponentName component = r.intent.getComponent(); if (component == null) &#123; component = r.intent.resolveActivity( mInitialApplication.getPackageManager()); r.intent.setComponent(component); &#125; if (r.activityInfo.targetActivity != null) &#123; component = new ComponentName(r.activityInfo.packageName, r.activityInfo.targetActivity); &#125; Activity activity = null; try &#123; java.lang.ClassLoader cl = r.packageInfo.getClassLoader(); //2. é€šè¿‡mInstrumentation.newActivity()æ–¹æ³•åˆ›å»ºActivityå¯¹è±¡ activity = mInstrumentation.newActivity( cl, component.getClassName(), r.intent); StrictMode.incrementExpectedActivityCount(activity.getClass()); r.intent.setExtrasClassLoader(cl); r.intent.prepareToEnterProcess(); if (r.state != null) &#123; r.state.setClassLoader(cl); &#125; &#125; catch (Exception e) &#123; if (!mInstrumentation.onException(activity, e)) &#123; throw new RuntimeException( \"Unable to instantiate activity \" + component + \": \" + e.toString(), e); &#125; &#125; try &#123; //3. é€šè¿‡LoadApkçš„makeApplication()æ–¹æ³•åˆ›å»ºApplicationå¯¹è±¡ Application app = r.packageInfo.makeApplication(false, mInstrumentation); if (localLOGV) Slog.v(TAG, \"Performing launch of \" + r); if (localLOGV) Slog.v( TAG, r + \": app=\" + app + \", appName=\" + app.getPackageName() + \", pkg=\" + r.packageInfo.getPackageName() + \", comp=\" + r.intent.getComponent().toShortString() + \", dir=\" + r.packageInfo.getAppDir()); if (activity != null) &#123; //4. åˆ›å»ºContextImplå¯¹è±¡å¹¶è°ƒç”¨Activityçš„attach()æ–¹æ³•å®Œæˆåˆå§‹åŒ– Context appContext = createBaseContextForActivity(r, activity); CharSequence title = r.activityInfo.loadLabel(appContext.getPackageManager()); Configuration config = new Configuration(mCompatConfiguration); if (DEBUG_CONFIGURATION) Slog.v(TAG, \"Launching activity \" + r.activityInfo.name + \" with config \" + config); activity.attach(appContext, this, getInstrumentation(), r.token, r.ident, app, r.intent, r.activityInfo, title, r.parent, r.embeddedID, r.lastNonConfigurationInstances, config, r.referrer, r.voiceInteractor); if (customIntent != null) &#123; activity.mIntent = customIntent; &#125; r.lastNonConfigurationInstances = null; activity.mStartedActivity = false; int theme = r.activityInfo.getThemeResource(); if (theme != 0) &#123; activity.setTheme(theme); &#125; activity.mCalled = false; //5. é€šè¿‡Instrumentationçš„callActivityOnCreateæ–¹æ³•è°ƒç”¨Activityçš„onCreate()æ–¹æ³• if (r.isPersistable()) &#123; mInstrumentation.callActivityOnCreate(activity, r.state, r.persistentState); &#125; else &#123; mInstrumentation.callActivityOnCreate(activity, r.state); &#125; if (!activity.mCalled) &#123; throw new SuperNotCalledException( \"Activity \" + r.intent.getComponent().toShortString() + \" did not call through to super.onCreate()\"); &#125; r.activity = activity; r.stopped = true; if (!r.activity.mFinished) &#123; activity.performStart(); r.stopped = false; &#125; if (!r.activity.mFinished) &#123; if (r.isPersistable()) &#123; if (r.state != null || r.persistentState != null) &#123; mInstrumentation.callActivityOnRestoreInstanceState(activity, r.state, r.persistentState); &#125; &#125; else if (r.state != null) &#123; mInstrumentation.callActivityOnRestoreInstanceState(activity, r.state); &#125; &#125; if (!r.activity.mFinished) &#123; activity.mCalled = false; if (r.isPersistable()) &#123; mInstrumentation.callActivityOnPostCreate(activity, r.state, r.persistentState); &#125; else &#123; mInstrumentation.callActivityOnPostCreate(activity, r.state); &#125; if (!activity.mCalled) &#123; throw new SuperNotCalledException( \"Activity \" + r.intent.getComponent().toShortString() + \" did not call through to super.onPostCreate()\"); &#125; &#125; &#125; r.paused = true; mActivities.put(r.token, r); &#125; catch (SuperNotCalledException e) &#123; throw e; &#125; catch (Exception e) &#123; if (!mInstrumentation.onException(activity, e)) &#123; throw new RuntimeException( \"Unable to start activity \" + component + \": \" + e.toString(), e); &#125; &#125; return activity;&#125; æ€»ç»“ä¸Šé¢çš„performLaunchActivity()æ–¹æ³•ï¼Œä¸»è¦å®Œæˆäº†å¦‚ä¸‹å·¥ä½œï¼š ä»ActivityClientRecordä¸­è¯»å–Activityçš„ç»„ä»¶ä¿¡æ¯ é€šè¿‡mInstrumentation.newActivity()æ–¹æ³•åˆ›å»ºActivityå¯¹è±¡ é€šè¿‡LoadApkçš„makeApplication()æ–¹æ³•åˆ›å»ºApplicationå¯¹è±¡ åˆ›å»ºContextImplå¯¹è±¡å¹¶è°ƒç”¨Activityçš„attach()æ–¹æ³•å®Œæˆåˆå§‹åŒ– é€šè¿‡Instrumentationçš„callActivityOnCreateæ–¹æ³•è°ƒç”¨Activityçš„onCreate()æ–¹æ³• æˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹ç¬¬äºŒæ­¥çš„Instrumentationç±»çš„newActivity()æ–¹æ³•ï¼Œå¾ˆç®€å•ï¼Œå°±æ˜¯ä½¿ç”¨ç±»åŠ è½½å™¨åˆ›å»ºäº†Activityå¯¹è±¡ï¼š 1234567//Instrumentationç±»public Activity newActivity(ClassLoader cl, String className, Intent intent) throws InstantiationException, IllegalAccessException, ClassNotFoundException &#123; return (Activity)cl.loadClass(className).newInstance();&#125; ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡LoadApkçš„makeApplication()æ–¹æ³•åˆ›å»ºApplicationå¯¹è±¡ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061//LoadApkç±»public Application makeApplication(boolean forceDefaultAppClass, Instrumentation instrumentation) &#123; if (mApplication != null) &#123; return mApplication; &#125; Application app = null; String appClass = mApplicationInfo.className; if (forceDefaultAppClass || (appClass == null)) &#123; appClass = \"android.app.Application\"; &#125; try &#123; java.lang.ClassLoader cl = getClassLoader(); if (!mPackageName.equals(\"android\")) &#123; initializeJavaContextClassLoader(); &#125; //é€šè¿‡Instrumentationç±»çš„newApplicationæ–¹æ³•åˆ›å»ºApplicationå¯¹è±¡ ContextImpl appContext = ContextImpl.createAppContext(mActivityThread, this); app = mActivityThread.mInstrumentation.newApplication( cl, appClass, appContext); appContext.setOuterContext(app); &#125; catch (Exception e) &#123; if (!mActivityThread.mInstrumentation.onException(app, e)) &#123; throw new RuntimeException( \"Unable to instantiate application \" + appClass + \": \" + e.toString(), e); &#125; &#125; mActivityThread.mAllApplications.add(app); mApplication = app; if (instrumentation != null) &#123; try &#123; instrumentation.callApplicationOnCreate(app); &#125; catch (Exception e) &#123; if (!instrumentation.onException(app, e)) &#123; throw new RuntimeException( \"Unable to create application \" + app.getClass().getName() + \": \" + e.toString(), e); &#125; &#125; &#125; // Rewrite the R 'constants' for all library apks. SparseArray&lt;String&gt; packageIdentifiers = getAssets(mActivityThread) .getAssignedPackageIdentifiers(); final int N = packageIdentifiers.size(); for (int i = 0; i &lt; N; i++) &#123; final int id = packageIdentifiers.keyAt(i); if (id == 0x01 || id == 0x7f) &#123; continue; &#125; rewriteRValues(getClassLoader(), packageIdentifiers.valueAt(i), id); &#125; return app;&#125; è·Ÿè¿›å»Instrumentationç±»çš„newApplication()æ–¹æ³•çœ‹çœ‹ï¼š 1234567891011121314151617181920//Instrumentationç±»public Application newApplication(ClassLoader cl, String className, Context context) throws InstantiationException, IllegalAccessException, ClassNotFoundException &#123; return newApplication(cl.loadClass(className), context);&#125;static public Application newApplication(Class&lt;?&gt; clazz, Context context) throws InstantiationException, IllegalAccessException, ClassNotFoundException &#123; Application app = (Application)clazz.newInstance(); app.attach(context); return app;&#125;//æœ€ç»ˆè°ƒç”¨äº†Applicationç±»çš„attachæ–¹æ³•final void attach(Context context) &#123; attachBaseContext(context); //ç†Ÿæ‚‰çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• mLoadedApk = ContextImpl.getImpl(context).mPackageInfo;&#125; å®ƒé€šè¿‡ç±»åŠ è½½å™¨åˆ›å»ºäº†Applicationçš„å¯¹è±¡ï¼Œå½“Applicationå¯¹è±¡åˆ›å»ºå®Œæ¯•ä¹‹åï¼Œç³»ç»Ÿä¼šé€šè¿‡Instrumentationç±»çš„callApplicationOnCreate()æ–¹æ³•æ¥è°ƒç”¨Applicationçš„onCreate()æ–¹æ³•ã€‚æœ€åé€šè¿‡app.attach()è°ƒç”¨äº†æˆ‘ä»¬ç†Ÿæ‚‰çš„Applicationçš„attachBaseContext()æ–¹æ³•ã€‚ handleResumeActivity()æ–¹æ³•æµç¨‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123//ActivityThreadç±»final void handleResumeActivity(IBinder token, boolean clearHide, boolean isForward, boolean reallyResume) &#123; // If we are getting ready to gc after going to the background, well // we are back active so skip it. unscheduleGcIdler(); mSomeActivitiesChanged = true; // TODO Push resumeArgs into the activity for consideration ActivityClientRecord r = performResumeActivity(token, clearHide); if (r != null) &#123; final Activity a = r.activity; if (localLOGV) Slog.v( TAG, \"Resume \" + r + \" started activity: \" + a.mStartedActivity + \", hideForNow: \" + r.hideForNow + \", finished: \" + a.mFinished); final int forwardBit = isForward ? WindowManager.LayoutParams.SOFT_INPUT_IS_FORWARD_NAVIGATION : 0; // If the window hasn't yet been added to the window manager, // and this guy didn't finish itself or start another activity, // then go ahead and add the window. boolean willBeVisible = !a.mStartedActivity; if (!willBeVisible) &#123; try &#123; willBeVisible = ActivityManagerNative.getDefault().willActivityBeVisible( a.getActivityToken()); &#125; catch (RemoteException e) &#123; &#125; &#125; if (r.window == null &amp;&amp; !a.mFinished &amp;&amp; willBeVisible) &#123; r.window = r.activity.getWindow(); View decor = r.window.getDecorView(); decor.setVisibility(View.INVISIBLE); ViewManager wm = a.getWindowManager(); WindowManager.LayoutParams l = r.window.getAttributes(); a.mDecor = decor; l.type = WindowManager.LayoutParams.TYPE_BASE_APPLICATION; l.softInputMode |= forwardBit; if (a.mVisibleFromClient) &#123; a.mWindowAdded = true; wm.addView(decor, l); &#125; // If the window has already been added, but during resume // we started another activity, then don't yet make the // window visible. &#125; else if (!willBeVisible) &#123; if (localLOGV) Slog.v( TAG, \"Launch \" + r + \" mStartedActivity set\"); r.hideForNow = true; &#125; // Get rid of anything left hanging around. cleanUpPendingRemoveWindows(r); // The window is now visible if it has been added, we are not // simply finishing, and we are not starting another activity. if (!r.activity.mFinished &amp;&amp; willBeVisible &amp;&amp; r.activity.mDecor != null &amp;&amp; !r.hideForNow) &#123; if (r.newConfig != null) &#123; r.tmpConfig.setTo(r.newConfig); if (r.overrideConfig != null) &#123; r.tmpConfig.updateFrom(r.overrideConfig); &#125; if (DEBUG_CONFIGURATION) Slog.v(TAG, \"Resuming activity \" + r.activityInfo.name + \" with newConfig \" + r.tmpConfig); performConfigurationChanged(r.activity, r.tmpConfig); freeTextLayoutCachesIfNeeded(r.activity.mCurrentConfig.diff(r.tmpConfig)); r.newConfig = null; &#125; if (localLOGV) Slog.v(TAG, \"Resuming \" + r + \" with isForward=\" + isForward); WindowManager.LayoutParams l = r.window.getAttributes(); if ((l.softInputMode &amp; WindowManager.LayoutParams.SOFT_INPUT_IS_FORWARD_NAVIGATION) != forwardBit) &#123; l.softInputMode = (l.softInputMode &amp; (~WindowManager.LayoutParams.SOFT_INPUT_IS_FORWARD_NAVIGATION)) | forwardBit; if (r.activity.mVisibleFromClient) &#123; ViewManager wm = a.getWindowManager(); View decor = r.window.getDecorView(); wm.updateViewLayout(decor, l); &#125; &#125; r.activity.mVisibleFromServer = true; mNumVisibleActivities++; if (r.activity.mVisibleFromClient) &#123; r.activity.makeVisible(); &#125; &#125; if (!r.onlyLocalRequest) &#123; r.nextIdle = mNewActivities; mNewActivities = r; if (localLOGV) Slog.v( TAG, \"Scheduling idle handler for \" + r); Looper.myQueue().addIdleHandler(new Idler()); &#125; r.onlyLocalRequest = false; // é€šçŸ¥AMSå·²ç»resumeå®Œæˆ Tell the activity manager we have resumed. if (reallyResume) &#123; try &#123; ActivityManagerNative.getDefault().activityResumed(token); &#125; catch (RemoteException ex) &#123; &#125; &#125; &#125; else &#123; // If an exception was thrown when trying to resume, then // just end this activity. try &#123; ActivityManagerNative.getDefault() .finishActivity(token, Activity.RESULT_CANCELED, null, false); &#125; catch (RemoteException ex) &#123; &#125; &#125;&#125; æ¥ç€çœ‹performResumeActivity()æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243//ActivityThreadç±»public final ActivityClientRecord performResumeActivity(IBinder token, boolean clearHide) &#123; ActivityClientRecord r = mActivities.get(token); if (localLOGV) Slog.v(TAG, \"Performing resume of \" + r + \" finished=\" + r.activity.mFinished); if (r != null &amp;&amp; !r.activity.mFinished) &#123; if (clearHide) &#123; r.hideForNow = false; r.activity.mStartedActivity = false; &#125; try &#123; r.activity.onStateNotSaved(); r.activity.mFragments.noteStateNotSaved(); if (r.pendingIntents != null) &#123; deliverNewIntents(r, r.pendingIntents); r.pendingIntents = null; &#125; if (r.pendingResults != null) &#123; deliverResults(r, r.pendingResults); r.pendingResults = null; &#125; //æ³¨æ„è¿™é‡Œï¼Œè°ƒç”¨Activityçš„performResume()æ–¹æ³• r.activity.performResume(); EventLog.writeEvent(LOG_AM_ON_RESUME_CALLED, UserHandle.myUserId(), r.activity.getComponentName().getClassName()); r.paused = false; r.stopped = false; r.state = null; r.persistentState = null; &#125; catch (Exception e) &#123; if (!mInstrumentation.onException(r.activity, e)) &#123; throw new RuntimeException( \"Unable to resume activity \" + r.intent.getComponent().toShortString() + \": \" + e.toString(), e); &#125; &#125; &#125; return r;&#125; ActivityThreadç±»ä¸­çš„performResumeActivity()æ–¹æ³•è°ƒç”¨äº†Activityç±»çš„performResume()æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930//Activityç±»final void performResume() &#123; performRestart(); mFragments.execPendingActions(); mLastNonConfigurationInstances = null; mCalled = false; // çœ‹è¿™é‡Œ mResumed is set by the instrumentation mInstrumentation.callActivityOnResume(this); if (!mCalled) &#123; throw new SuperNotCalledException( \"Activity \" + mComponent.toShortString() + \" did not call through to super.onResume()\"); &#125; // Now really resume, and install the current status bar and menu. mCalled = false; mFragments.dispatchResume(); mFragments.execPendingActions(); onPostResume(); if (!mCalled) &#123; throw new SuperNotCalledException( \"Activity \" + mComponent.toShortString() + \" did not call through to super.onPostResume()\"); &#125;&#125; Instrumentationç±»ä¸­çš„callActivityOnResumeæ–¹æ³• 1234567891011121314151617181920/** Instrumentationç±» * Perform calling of an activity's &#123;@link Activity#onResume&#125; method. The * default implementation simply calls through to that method. * * @param activity The activity being resumed. */public void callActivityOnResume(Activity activity) &#123; activity.mResumed = true; activity.onResume(); //è°ƒç”¨äº†onResume()æ–¹æ³•å®Œæˆäº†å¯åŠ¨è¿‡ç¨‹ if (mActivityMonitors != null) &#123; synchronized (mSync) &#123; final int N = mActivityMonitors.size(); for (int i=0; i&lt;N; i++) &#123; final ActivityMonitor am = mActivityMonitors.get(i); am.match(activity, activity, activity.getIntent()); &#125; &#125; &#125;&#125; åº”ç”¨çš„ä¸»è¦å¯åŠ¨æµç¨‹å…³äº App å¯åŠ¨æµç¨‹çš„æ–‡ç« å¾ˆå¤šï¼Œæ–‡ç« åº•éƒ¨æœ‰ä¸€äº›å¯åŠ¨æµç¨‹ç›¸å…³çš„å‚è€ƒæ–‡ç« ï¼Œè¿™é‡Œåªåˆ—å‡ºå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š é€šè¿‡ Launcher å¯åŠ¨åº”ç”¨æ—¶ï¼Œç‚¹å‡»åº”ç”¨å›¾æ ‡åï¼ŒLauncher è°ƒç”¨ startActivity() å¯åŠ¨åº”ç”¨ã€‚ Launcher Activity æœ€ç»ˆè°ƒç”¨Instrumentation çš„ execStartActivity æ¥å¯åŠ¨åº”ç”¨ã€‚ Instrumentation è°ƒç”¨ ActivityManagerProxy (ActivityManagerService åœ¨åº”ç”¨è¿›ç¨‹çš„ä¸€ä¸ªä»£ç†å¯¹è±¡) å¯¹è±¡çš„ startActivity æ–¹æ³•å¯åŠ¨ Activityã€‚ åˆ°ç›®å‰ä¸ºæ­¢æ‰€æœ‰è¿‡ç¨‹éƒ½åœ¨ Launcher è¿›ç¨‹é‡Œé¢æ‰§è¡Œï¼Œæ¥ä¸‹æ¥ActivityManagerProxy å¯¹è±¡è·¨è¿›ç¨‹è°ƒç”¨ActivityManagerService (è¿è¡Œåœ¨system_server è¿›ç¨‹)çš„ startActivity æ–¹æ³•å¯åŠ¨åº”ç”¨ã€‚ ActivityManagerService çš„ startActivity æ–¹æ³•ç»è¿‡ä¸€ç³»åˆ—è°ƒç”¨ï¼Œæœ€åè°ƒç”¨ zygoteSendArgsAndGetResult é€šè¿‡socket å‘é€ç»™ zygote è¿›ç¨‹ï¼Œzygote è¿›ç¨‹ä¼šå­µåŒ–å‡ºæ–°çš„åº”ç”¨è¿›ç¨‹ã€‚ zygote è¿›ç¨‹å­µåŒ–å‡ºæ–°çš„åº”ç”¨è¿›ç¨‹åï¼Œä¼šæ‰§è¡ŒActivityThread ç±»çš„ main() æ–¹æ³•ã€‚åœ¨è¯¥æ–¹æ³•é‡Œä¼šå…ˆå‡†å¤‡å¥½ Looper å’Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç„¶åè°ƒç”¨ attach() æ–¹æ³•å°†åº”ç”¨è¿›ç¨‹ç»‘å®šåˆ° ActivityManagerServiceï¼Œç„¶åè¿›å…¥loop å¾ªç¯ï¼Œä¸æ–­åœ°è¯»å–æ¶ˆæ¯é˜Ÿåˆ—é‡Œçš„æ¶ˆæ¯ï¼Œå¹¶åˆ†å‘æ¶ˆæ¯ã€‚ ActivityManagerService ä¿å­˜åº”ç”¨è¿›ç¨‹çš„ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œç„¶å ActivityManagerService é€šè¿‡ä»£ç†å¯¹è±¡é€šçŸ¥åº”ç”¨è¿›ç¨‹åˆ›å»ºå…¥å£ Activity çš„å®ä¾‹ï¼Œå¹¶æ‰§è¡Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚ æ€»ç»“è¿‡ç¨‹å°±æ˜¯ï¼šç”¨æˆ·åœ¨ Launcher ç¨‹åºé‡Œç‚¹å‡»åº”ç”¨å›¾æ ‡æ—¶ï¼Œä¼šé€šçŸ¥ ActivityManagerService å¯åŠ¨åº”ç”¨çš„å…¥å£ Activityï¼Œ ActivityManagerService å‘ç°è¿™ä¸ªåº”ç”¨è¿˜æœªå¯åŠ¨ï¼Œåˆ™ä¼šé€šçŸ¥ Zygoteè¿›ç¨‹å­µåŒ–å‡ºåº”ç”¨è¿›ç¨‹ï¼Œç„¶ååœ¨è¿™ä¸ªåº”ç”¨è¿›ç¨‹é‡Œæ‰§è¡Œ ActivityThread çš„ main() æ–¹æ³•ã€‚åº”ç”¨è¿›ç¨‹æ¥ä¸‹æ¥é€šçŸ¥ActivityManagerService åº”ç”¨è¿›ç¨‹å·²å¯åŠ¨ï¼ŒActivityManagerService ä¿å­˜åº”ç”¨è¿›ç¨‹çš„ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œè¿™æ ·ActivityManagerService å¯ä»¥é€šè¿‡è¿™ä¸ªä»£ç†å¯¹è±¡æ§åˆ¶åº”ç”¨è¿›ç¨‹ï¼Œç„¶å ActivityManagerService é€šçŸ¥åº”ç”¨è¿›ç¨‹åˆ›å»ºå…¥å£ Activity çš„å®ä¾‹ï¼Œå¹¶æ‰§è¡Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¤§æ¦‚ç†è§£ä¸€ä¸‹è¿™å‡ ä¸ªç›¸å…³ç±»çš„å®šä½ ï¼ˆä¸€ï¼‰ActivityManagerServiceï¼šï¼ˆActivityManagerNativeï¼‰æ˜¯æ ¸å¿ƒç®¡ç†ç±»ï¼Œè´Ÿè´£ç»„ä»¶çš„ç®¡ç†ï¼Œåœ¨è¿™é‡Œä¸»è¦ä¸ActivityStackSupervisoré€šä¿¡ã€‚ ï¼ˆäºŒï¼‰ActivityStackSupervisorï¼šç®¡ç†æ•´ä¸ªæ‰‹æœºä»»åŠ¡æ ˆï¼Œå³ç®¡ç†ç€ActivityStackã€‚ ï¼ˆä¸‰ï¼‰ActivityStackï¼šæ˜¯Activityçš„æ ˆï¼Œå³ä»»åŠ¡æ ˆï¼Œä»ä¸­å¯ä»¥è·å–éœ€è¦è¿›è¡Œæ“ä½œçš„ActivityRecordï¼Œå¹¶ä¸”å¯ä»¥å¯¹ä»»åŠ¡çš„è¿›ç¨‹è¿›è¡Œæ“ä½œã€‚ ï¼ˆå››ï¼‰ActivityThreadï¼šæ˜¯å®‰å“javaåº”ç”¨å±‚çš„å…¥å£å‡½æ•°ç±»ï¼Œå®ƒä¼šæ‰§è¡Œå…·ä½“å¯¹Activityçš„æ“ä½œï¼Œå¹¶å°†ç»“æœé€šçŸ¥ç»™ActivityManagerServiceã€‚ å‚è€ƒ Activityå¯åŠ¨æµç¨‹ç®€ç›´ä¸§å¿ƒç—…ç‹‚ï¼ ã€å‡¯å­å“¥å¸¦ä½ å­¦Frameworkã€‘Activityå¯åŠ¨è¿‡ç¨‹å…¨è§£æ Androidæºç è§£æä¹‹ï¼ˆåå››ï¼‰â€“&gt;Activityå¯åŠ¨æµç¨‹ å›¾è§£Activityå¯åŠ¨æµç¨‹ Android å¼€å‘ä¹‹ App å¯åŠ¨æ—¶é—´ç»Ÿè®¡ Androidæ€§èƒ½ä¼˜åŒ–ï¼ˆä¸€ï¼‰ä¹‹å¯åŠ¨åŠ é€Ÿ35% å®˜æ–¹æ–‡æ¡£ - Launch-Time Performance","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Javaã€‘HashMapæºç åˆ†æï¼ˆJDK1.8ï¼‰","slug":"ã€Javaã€‘HashMapæºç åˆ†æï¼ˆJDK1.8ï¼‰","date":"2017-11-25T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/11/25/ã€Javaã€‘HashMapæºç åˆ†æï¼ˆJDK1.8ï¼‰/","link":"","permalink":"http://github.com/2017/11/25/ã€Javaã€‘HashMapæºç åˆ†æï¼ˆJDK1.8ï¼‰/","excerpt":"å‰è¨€Javaä¸ºæ•°æ®ç»“æ„ä¸­çš„æ˜ å°„å®šä¹‰äº†ä¸€ä¸ªæ¥å£java.util.Mapï¼Œæ­¤æ¥å£ä¸»è¦æœ‰å››ä¸ªå¸¸ç”¨çš„å®ç°ç±»ï¼Œåˆ†åˆ«æ˜¯HashMapã€Hashtableã€LinkedHashMapå’ŒTreeMapï¼Œç±»ç»§æ‰¿å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸‹é¢é’ˆå¯¹å„ä¸ªå®ç°ç±»çš„ç‰¹ç‚¹åšä¸€äº›è¯´æ˜ï¼š (1) HashMapï¼šå®ƒæ ¹æ®é”®çš„hashCodeå€¼å­˜å‚¨æ•°æ®ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ç›´æ¥å®šä½åˆ°å®ƒçš„å€¼ï¼Œå› è€Œå…·æœ‰å¾ˆå¿«çš„è®¿é—®é€Ÿåº¦ï¼Œä½†éå†é¡ºåºå´æ˜¯ä¸ç¡®å®šçš„ã€‚ HashMapæœ€å¤šåªå…è®¸ä¸€æ¡è®°å½•çš„é”®ä¸ºnullï¼Œå…è®¸å¤šæ¡è®°å½•çš„å€¼ä¸ºnullã€‚HashMapéçº¿ç¨‹å®‰å…¨ï¼Œå³ä»»ä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™HashMapï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚å¦‚æœéœ€è¦æ»¡è¶³çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥ç”¨ Collectionsçš„synchronizedMapæ–¹æ³•ä½¿HashMapå…·æœ‰çº¿ç¨‹å®‰å…¨çš„èƒ½åŠ›ï¼Œæˆ–è€…ä½¿ç”¨ConcurrentHashMapã€‚ (2) Hashtableï¼šHashtableæ˜¯é—ç•™ç±»ï¼Œå¾ˆå¤šæ˜ å°„çš„å¸¸ç”¨åŠŸèƒ½ä¸HashMapç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å®ƒç»§æ‰¿è‡ªDictionaryç±»ï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä»»ä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å†™Hashtableï¼Œå¹¶å‘æ€§ä¸å¦‚ConcurrentHashMapï¼Œå› ä¸ºConcurrentHashMapå¼•å…¥äº†åˆ†æ®µé”ã€‚Hashtableä¸å»ºè®®åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ï¼Œä¸éœ€è¦çº¿ç¨‹å®‰å…¨çš„åœºåˆå¯ä»¥ç”¨HashMapæ›¿æ¢ï¼Œéœ€è¦çº¿ç¨‹å®‰å…¨çš„åœºåˆå¯ä»¥ç”¨ConcurrentHashMapæ›¿æ¢ã€‚ (3) LinkedHashMapï¼šLinkedHashMapæ˜¯HashMapçš„ä¸€ä¸ªå­ç±»ï¼Œä¿å­˜äº†è®°å½•çš„æ’å…¥é¡ºåºï¼Œåœ¨ç”¨Iteratoréå†LinkedHashMapæ—¶ï¼Œå…ˆå¾—åˆ°çš„è®°å½•è‚¯å®šæ˜¯å…ˆæ’å…¥çš„ï¼Œä¹Ÿå¯ä»¥åœ¨æ„é€ æ—¶å¸¦å‚æ•°ï¼ŒæŒ‰ç…§è®¿é—®æ¬¡åºæ’åºã€‚ (4) TreeMapï¼šTreeMapå®ç°SortedMapæ¥å£ï¼Œèƒ½å¤ŸæŠŠå®ƒä¿å­˜çš„è®°å½•æ ¹æ®é”®æ’åºï¼Œé»˜è®¤æ˜¯æŒ‰é”®å€¼çš„å‡åºæ’åºï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ’åºçš„æ¯”è¾ƒå™¨ï¼Œå½“ç”¨Iteratoréå†TreeMapæ—¶ï¼Œå¾—åˆ°çš„è®°å½•æ˜¯æ’è¿‡åºçš„ã€‚å¦‚æœä½¿ç”¨æ’åºçš„æ˜ å°„ï¼Œå»ºè®®ä½¿ç”¨TreeMapã€‚åœ¨ä½¿ç”¨TreeMapæ—¶ï¼Œkeyå¿…é¡»å®ç°Comparableæ¥å£æˆ–è€…åœ¨æ„é€ TreeMapä¼ å…¥è‡ªå®šä¹‰çš„Comparatorï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡ºjava.lang.ClassCastExceptionç±»å‹çš„å¼‚å¸¸ã€‚ å¯¹äºä¸Šè¿°å››ç§Mapç±»å‹çš„ç±»ï¼Œè¦æ±‚æ˜ å°„ä¸­çš„keyæ˜¯ä¸å¯å˜å¯¹è±¡ã€‚ä¸å¯å˜å¯¹è±¡æ˜¯è¯¥å¯¹è±¡åœ¨åˆ›å»ºåå®ƒçš„å“ˆå¸Œå€¼ä¸ä¼šè¢«æ”¹å˜ã€‚å¦‚æœå¯¹è±¡çš„å“ˆå¸Œå€¼å‘ç”Ÿå˜åŒ–ï¼ŒMapå¯¹è±¡å¾ˆå¯èƒ½å°±å®šä½ä¸åˆ°æ˜ å°„çš„ä½ç½®äº†ã€‚ é€šè¿‡ä¸Šé¢çš„æ¯”è¾ƒï¼Œæˆ‘ä»¬çŸ¥é“äº†HashMapæ˜¯Javaçš„Mapå®¶æ—ä¸­ä¸€ä¸ªæ™®é€šæˆå‘˜ï¼Œé‰´äºå®ƒå¯ä»¥æ»¡è¶³å¤§å¤šæ•°åœºæ™¯çš„ä½¿ç”¨æ¡ä»¶ï¼Œæ‰€ä»¥æ˜¯ä½¿ç”¨é¢‘åº¦æœ€é«˜çš„ä¸€ä¸ªã€‚ä¸‹æ–‡æˆ‘ä»¬ä¸»è¦ç»“åˆæºç ï¼Œä»å­˜å‚¨ç»“æ„ã€å¸¸ç”¨æ–¹æ³•åˆ†æã€æ‰©å®¹ä»¥åŠå®‰å…¨æ€§ç­‰æ–¹é¢æ·±å…¥è®²è§£HashMapçš„å·¥ä½œåŸç†ã€‚","text":"å‰è¨€Javaä¸ºæ•°æ®ç»“æ„ä¸­çš„æ˜ å°„å®šä¹‰äº†ä¸€ä¸ªæ¥å£java.util.Mapï¼Œæ­¤æ¥å£ä¸»è¦æœ‰å››ä¸ªå¸¸ç”¨çš„å®ç°ç±»ï¼Œåˆ†åˆ«æ˜¯HashMapã€Hashtableã€LinkedHashMapå’ŒTreeMapï¼Œç±»ç»§æ‰¿å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸‹é¢é’ˆå¯¹å„ä¸ªå®ç°ç±»çš„ç‰¹ç‚¹åšä¸€äº›è¯´æ˜ï¼š (1) HashMapï¼šå®ƒæ ¹æ®é”®çš„hashCodeå€¼å­˜å‚¨æ•°æ®ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ç›´æ¥å®šä½åˆ°å®ƒçš„å€¼ï¼Œå› è€Œå…·æœ‰å¾ˆå¿«çš„è®¿é—®é€Ÿåº¦ï¼Œä½†éå†é¡ºåºå´æ˜¯ä¸ç¡®å®šçš„ã€‚ HashMapæœ€å¤šåªå…è®¸ä¸€æ¡è®°å½•çš„é”®ä¸ºnullï¼Œå…è®¸å¤šæ¡è®°å½•çš„å€¼ä¸ºnullã€‚HashMapéçº¿ç¨‹å®‰å…¨ï¼Œå³ä»»ä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™HashMapï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚å¦‚æœéœ€è¦æ»¡è¶³çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥ç”¨ Collectionsçš„synchronizedMapæ–¹æ³•ä½¿HashMapå…·æœ‰çº¿ç¨‹å®‰å…¨çš„èƒ½åŠ›ï¼Œæˆ–è€…ä½¿ç”¨ConcurrentHashMapã€‚ (2) Hashtableï¼šHashtableæ˜¯é—ç•™ç±»ï¼Œå¾ˆå¤šæ˜ å°„çš„å¸¸ç”¨åŠŸèƒ½ä¸HashMapç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å®ƒç»§æ‰¿è‡ªDictionaryç±»ï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä»»ä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å†™Hashtableï¼Œå¹¶å‘æ€§ä¸å¦‚ConcurrentHashMapï¼Œå› ä¸ºConcurrentHashMapå¼•å…¥äº†åˆ†æ®µé”ã€‚Hashtableä¸å»ºè®®åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ï¼Œä¸éœ€è¦çº¿ç¨‹å®‰å…¨çš„åœºåˆå¯ä»¥ç”¨HashMapæ›¿æ¢ï¼Œéœ€è¦çº¿ç¨‹å®‰å…¨çš„åœºåˆå¯ä»¥ç”¨ConcurrentHashMapæ›¿æ¢ã€‚ (3) LinkedHashMapï¼šLinkedHashMapæ˜¯HashMapçš„ä¸€ä¸ªå­ç±»ï¼Œä¿å­˜äº†è®°å½•çš„æ’å…¥é¡ºåºï¼Œåœ¨ç”¨Iteratoréå†LinkedHashMapæ—¶ï¼Œå…ˆå¾—åˆ°çš„è®°å½•è‚¯å®šæ˜¯å…ˆæ’å…¥çš„ï¼Œä¹Ÿå¯ä»¥åœ¨æ„é€ æ—¶å¸¦å‚æ•°ï¼ŒæŒ‰ç…§è®¿é—®æ¬¡åºæ’åºã€‚ (4) TreeMapï¼šTreeMapå®ç°SortedMapæ¥å£ï¼Œèƒ½å¤ŸæŠŠå®ƒä¿å­˜çš„è®°å½•æ ¹æ®é”®æ’åºï¼Œé»˜è®¤æ˜¯æŒ‰é”®å€¼çš„å‡åºæ’åºï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ’åºçš„æ¯”è¾ƒå™¨ï¼Œå½“ç”¨Iteratoréå†TreeMapæ—¶ï¼Œå¾—åˆ°çš„è®°å½•æ˜¯æ’è¿‡åºçš„ã€‚å¦‚æœä½¿ç”¨æ’åºçš„æ˜ å°„ï¼Œå»ºè®®ä½¿ç”¨TreeMapã€‚åœ¨ä½¿ç”¨TreeMapæ—¶ï¼Œkeyå¿…é¡»å®ç°Comparableæ¥å£æˆ–è€…åœ¨æ„é€ TreeMapä¼ å…¥è‡ªå®šä¹‰çš„Comparatorï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡ºjava.lang.ClassCastExceptionç±»å‹çš„å¼‚å¸¸ã€‚ å¯¹äºä¸Šè¿°å››ç§Mapç±»å‹çš„ç±»ï¼Œè¦æ±‚æ˜ å°„ä¸­çš„keyæ˜¯ä¸å¯å˜å¯¹è±¡ã€‚ä¸å¯å˜å¯¹è±¡æ˜¯è¯¥å¯¹è±¡åœ¨åˆ›å»ºåå®ƒçš„å“ˆå¸Œå€¼ä¸ä¼šè¢«æ”¹å˜ã€‚å¦‚æœå¯¹è±¡çš„å“ˆå¸Œå€¼å‘ç”Ÿå˜åŒ–ï¼ŒMapå¯¹è±¡å¾ˆå¯èƒ½å°±å®šä½ä¸åˆ°æ˜ å°„çš„ä½ç½®äº†ã€‚ é€šè¿‡ä¸Šé¢çš„æ¯”è¾ƒï¼Œæˆ‘ä»¬çŸ¥é“äº†HashMapæ˜¯Javaçš„Mapå®¶æ—ä¸­ä¸€ä¸ªæ™®é€šæˆå‘˜ï¼Œé‰´äºå®ƒå¯ä»¥æ»¡è¶³å¤§å¤šæ•°åœºæ™¯çš„ä½¿ç”¨æ¡ä»¶ï¼Œæ‰€ä»¥æ˜¯ä½¿ç”¨é¢‘åº¦æœ€é«˜çš„ä¸€ä¸ªã€‚ä¸‹æ–‡æˆ‘ä»¬ä¸»è¦ç»“åˆæºç ï¼Œä»å­˜å‚¨ç»“æ„ã€å¸¸ç”¨æ–¹æ³•åˆ†æã€æ‰©å®¹ä»¥åŠå®‰å…¨æ€§ç­‰æ–¹é¢æ·±å…¥è®²è§£HashMapçš„å·¥ä½œåŸç†ã€‚ æºç åˆ†æHashMapæ˜¯JavaåŸºæœ¬åŠŸï¼ŒJDK1.8åˆå¯¹HashMapè¿›è¡Œäº†ä¼˜åŒ–ã€‚ å­˜å‚¨ç»“æ„Nodeç±»JDK 1.8 ä»¥å‰ HashMap çš„å®ç°æ˜¯ æ•°ç»„+é“¾è¡¨ï¼Œå³ä½¿å“ˆå¸Œå‡½æ•°å–å¾—å†å¥½ï¼Œä¹Ÿå¾ˆéš¾è¾¾åˆ°å…ƒç´ ç™¾åˆ†ç™¾å‡åŒ€åˆ†å¸ƒã€‚å½“ HashMap ä¸­æœ‰å¤§é‡çš„å…ƒç´ éƒ½å­˜æ”¾åˆ°åŒä¸€ä¸ªæ¡¶ä¸­æ—¶ï¼Œè¿™ä¸ªæ¡¶ä¸‹æœ‰ä¸€æ¡é•¿é•¿çš„é“¾è¡¨ï¼Œè¿™ä¸ªæ—¶å€™ HashMap å°±ç›¸å½“äºä¸€ä¸ªå•é“¾è¡¨ï¼Œå‡å¦‚å•é“¾è¡¨æœ‰ n ä¸ªå…ƒç´ ï¼Œéå†çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(n)ï¼Œå®Œå…¨å¤±å»äº†å®ƒçš„ä¼˜åŠ¿ã€‚ é’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒJDK 1.8 ä¸­å¼•å…¥äº† çº¢é»‘æ ‘ï¼ˆæŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ä¸º O(logn)ï¼‰æ¥ä¼˜åŒ–è¿™ä¸ªé—®é¢˜ã€‚ ä»æºç å¯çŸ¥ï¼ŒHashMapç±»ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å­—æ®µï¼Œå°±æ˜¯ Node[] tableï¼Œå³å“ˆå¸Œæ¡¶æ•°ç»„ï¼Œæ˜æ˜¾å®ƒæ˜¯ä¸€ä¸ªNodeçš„æ•°ç»„ã€‚æˆ‘ä»¬æ¥çœ‹Node[JDK1.8]æ˜¯ä½•ç‰©ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; &#123; final int hash; //ç”¨æ¥å®šä½æ•°ç»„ç´¢å¼•ä½ç½® final K key; V value; Node&lt;K,V&gt; next; //é“¾è¡¨çš„ä¸‹ä¸€ä¸ªnode Node(int hash, K key, V value, Node&lt;K,V&gt; next) &#123; this.hash = hash; this.key = key; this.value = value; this.next = next; &#125; public final K getKey() &#123; return key; &#125; public final V getValue() &#123; return value; &#125; public final String toString() &#123; return key + \"=\" + value; &#125; public final int hashCode() &#123; return Objects.hashCode(key) ^ Objects.hashCode(value); &#125; public final V setValue(V newValue) &#123; V oldValue = value; value = newValue; return oldValue; &#125; public final boolean equals(Object o) &#123; if (o == this) return true; if (o instanceof Map.Entry) &#123; Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o; if (Objects.equals(key, e.getKey()) &amp;&amp; Objects.equals(value, e.getValue())) return true; &#125; return false; &#125;&#125; Nodeæ˜¯HashMapçš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®ç°äº†Map.Entryæ¥å£ï¼Œæœ¬è´¨æ˜¯å°±æ˜¯ä¸€ä¸ªæ˜ å°„(é”®å€¼å¯¹)ã€‚ä¸Šå›¾ä¸­çš„æ¯ä¸ªé»‘è‰²åœ†ç‚¹å°±æ˜¯ä¸€ä¸ªNodeå¯¹è±¡ã€‚ çº¢é»‘æ ‘TreeNodeç»“æ„ï¼š 123456789101112static final class TreeNode&lt;K,V&gt; extends LinkedHashMap.Entry&lt;K,V&gt; &#123; TreeNode&lt;K,V&gt; parent; // red-black tree links TreeNode&lt;K,V&gt; left; TreeNode&lt;K,V&gt; right; TreeNode&lt;K,V&gt; prev; // needed to unlink next upon deletion boolean red; TreeNode(int hash, K key, V val, Node&lt;K,V&gt; next) &#123; super(hash, key, val, next); &#125; //...çœç•¥å…¶ä»–ä»£ç ...&#125; HashMapå°±æ˜¯è¿™æ ·ä¸€ä¸ªEntryï¼ˆåŒ…æ‹¬Nodeå’ŒTreeNodeï¼‰æ•°ç»„ï¼ŒNodeå¯¹è±¡ä¸­åŒ…å«é”®ã€å€¼å’Œhashå€¼ï¼ŒnextæŒ‡å‘ä¸‹ä¸€ä¸ªEntryï¼Œç”¨æ¥å¤„ç†å“ˆå¸Œå†²çªã€‚TreeNodeå¯¹è±¡åŒ…å«æŒ‡å‘çˆ¶èŠ‚ç‚¹ã€å­èŠ‚ç‚¹å’Œå‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆç§»é™¤å¯¹è±¡æ—¶ä½¿ç”¨ï¼‰çš„æŒ‡é’ˆï¼Œä»¥åŠè¡¨ç¤ºçº¢é»‘èŠ‚ç‚¹é¢œè‰²çš„booleanæ ‡è¯†ã€‚ å¸¸é‡å®šä¹‰1234567891011121314151617181920212223242526272829303132333435363738394041/** * The default initial capacity - MUST be a power of two. */static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16/** * The maximum capacity, used if a higher value is implicitly specified * by either of the constructors with arguments. * MUST be a power of two &lt;= 1&lt;&lt;30. */static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;/** * The load factor used when none specified in constructor. */static final float DEFAULT_LOAD_FACTOR = 0.75f;/** * The bin count threshold for using a tree rather than list for a * bin. Bins are converted to trees when adding an element to a * bin with at least this many nodes. The value must be greater * than 2 and should be at least 8 to mesh with assumptions in * tree removal about conversion back to plain bins upon * shrinkage. */static final int TREEIFY_THRESHOLD = 8;/** * The bin count threshold for untreeifying a (split) bin during a * resize operation. Should be less than TREEIFY_THRESHOLD, and at * most 6 to mesh with shrinkage detection under removal. */static final int UNTREEIFY_THRESHOLD = 6;/** * The smallest table capacity for which bins may be treeified. * (Otherwise the table is resized if too many nodes in a bin.) * Should be at least 4 * TREEIFY_THRESHOLD to avoid conflicts * between resizing and treeification thresholds. */static final int MIN_TREEIFY_CAPACITY = 64; é»˜è®¤å®¹é‡ - DEFAULT_INITIAL_CAPACITY ï¼šé»˜è®¤åˆå§‹åŒ–çš„å®¹é‡ä¸º16ï¼Œå¿…é¡»æ˜¯2çš„å¹‚ã€‚ æœ€å¤§å®¹é‡ - MAXIMUM_CAPACITYï¼šæœ€å¤§å®¹é‡æ˜¯2^30 è£…è½½å› å­ - DEFAULT_LOAD_FACTORï¼šé»˜è®¤çš„è£…è½½å› å­æ˜¯0.75ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ é“¾è¡¨è½¬æ¢æˆæ ‘çš„é˜ˆå€¼ - TREEIFY_THRESHOLDï¼šä¸€ä¸ªæ¡¶ä¸­Entryï¼ˆæˆ–ç§°ä¸ºNodeï¼‰çš„å­˜å‚¨æ–¹å¼ç”±é“¾è¡¨è½¬æ¢æˆæ ‘çš„é˜ˆå€¼ã€‚å³å½“æ¡¶ä¸­Entryçš„æ•°é‡è¶…è¿‡æ­¤å€¼æ—¶ä½¿ç”¨çº¢é»‘æ ‘æ¥ä»£æ›¿é“¾è¡¨ã€‚é»˜è®¤å€¼æ˜¯8 æ ‘è½¬è¿˜åŸæˆé“¾è¡¨çš„é˜ˆå€¼ - UNTREEIFY_THRESHOLDï¼šå½“æ‰§è¡Œresizeæ“ä½œæ—¶ï¼Œå½“æ¡¶ä¸­Entryçš„æ•°é‡å°‘äºæ­¤å€¼æ—¶ä½¿ç”¨é“¾è¡¨æ¥ä»£æ›¿æ ‘ã€‚é»˜è®¤å€¼æ˜¯6 æœ€å°æ ‘å½¢åŒ–å®¹é‡ - MIN_TREEIFY_CAPACITYï¼šå½“å“ˆå¸Œè¡¨ä¸­çš„å®¹é‡å¤§äºè¿™ä¸ªå€¼æ—¶ï¼Œè¡¨ä¸­çš„æ¡¶æ‰èƒ½è¿›è¡Œæ ‘å½¢åŒ–ã€‚å¦åˆ™æ¡¶å†…å…ƒç´ å¤ªå¤šæ—¶ä¼šæ‰©å®¹ï¼Œè€Œä¸æ˜¯æ ‘å½¢åŒ–ã€‚ä¸ºäº†é¿å…è¿›è¡Œæ‰©å®¹ã€æ ‘å½¢åŒ–é€‰æ‹©çš„å†²çªï¼Œè¿™ä¸ªå€¼ä¸èƒ½å°äº4 * TREEIFY_THRESHOLD å±æ€§1234567891011transient Node&lt;K,V&gt;[] table; // å“ˆå¸Œæ¡¶æ•°ç»„buckettransient Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet; // entryç¼“å­˜Settransient int size; // å…ƒç´ ä¸ªæ•°transient int modCount; // ä¿®æ”¹æ¬¡æ•°int threshold; // é˜ˆå€¼ï¼Œç­‰äºè£…è½½å› å­*å®¹é‡ï¼Œå½“å®é™…å¤§å°è¶…è¿‡é˜ˆå€¼åˆ™è¿›è¡Œæ‰©å®¹final float loadFactor; // è£…è½½å› å­ï¼Œé»˜è®¤å€¼ä¸º0.75 å…¶ä¸­loadFactorè£…è½½å› å­ç”¨æ¥è¡¡é‡HashMapæ»¡çš„ç¨‹åº¦ã€‚loadFactorçš„é»˜è®¤å€¼ä¸º0.75fã€‚è®¡ç®—HashMapçš„å®æ—¶è£…è½½å› å­çš„æ–¹æ³•ä¸ºï¼šsize/capacityï¼Œä¹Ÿå°±æ˜¯HashMapæ‰€æœ‰Entryçš„æ€»æ•°é‡/HashMapä¸­æ¡¶çš„æ•°é‡ã€‚è€Œä¸æ˜¯å ç”¨æ¡¶çš„æ•°é‡å»é™¤ä»¥capacityã€‚ è‹¥åŠ è½½å› å­è¶Šå¤§ï¼Œå¡«æ»¡çš„å…ƒç´ è¶Šå¤šã€‚å¥½å¤„æ˜¯ç©ºé—´åˆ©ç”¨ç‡é«˜äº†ã€‚ä½†æ˜¯å†²çªçš„æœºä¼šåŠ å¤§äº†ã€‚é“¾è¡¨é•¿åº¦ä¼šè¶Šæ¥è¶Šé•¿,æŸ¥æ‰¾æ•ˆç‡é™ä½ã€‚ åä¹‹ï¼ŒåŠ è½½å› å­è¶Šå°ï¼Œå¡«æ»¡çš„å…ƒç´ è¶Šå°‘ã€‚å¥½å¤„æ˜¯å†²çªçš„æœºä¼šå‡å°äº†ï¼Œä½†ç©ºé—´æµªè´¹å¤šäº†ã€‚è¡¨ä¸­çš„æ•°æ®å°†è¿‡äºç¨€ç–ï¼ˆå¾ˆå¤šç©ºé—´è¿˜æ²¡ç”¨ï¼Œå°±å¼€å§‹æ‰©å®¹äº†ï¼‰ å†²çªçš„æœºä¼šè¶Šå¤§ï¼Œåˆ™æŸ¥æ‰¾çš„æˆæœ¬è¶Šé«˜ã€‚å› æ­¤ï¼Œå¿…é¡»åœ¨ â€œå†²çªçš„æœºä¼šâ€ä¸â€ç©ºé—´åˆ©ç”¨ç‡â€ä¹‹é—´å¯»æ‰¾ä¸€ç§å¹³è¡¡ä¸æŠ˜è¡·ã€‚è¿™ç§å¹³è¡¡ä¸æŠ˜è¡·æœ¬è´¨ä¸Šæ˜¯æ•°æ®ç»“æ„ä¸­æœ‰åçš„â€æ—¶é—´-ç©ºé—´â€çŸ›ç›¾çš„å¹³è¡¡ä¸æŠ˜è¡·ã€‚å¦‚æœæœºå™¨å†…å­˜è¶³å¤Ÿï¼Œå¹¶ä¸”æƒ³è¦æé«˜æŸ¥è¯¢é€Ÿåº¦çš„è¯å¯ä»¥å°†åŠ è½½å› å­è®¾ç½®å°ä¸€ç‚¹ï¼›ç›¸åå¦‚æœæœºå™¨å†…å­˜ç´§å¼ ï¼Œå¹¶ä¸”å¯¹æŸ¥è¯¢é€Ÿåº¦æ²¡æœ‰ä»€ä¹ˆè¦æ±‚çš„è¯å¯ä»¥å°†åŠ è½½å› å­è®¾ç½®å¤§ä¸€ç‚¹ã€‚ä¸è¿‡ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¸ç”¨å»è®¾ç½®å®ƒï¼Œè®©å®ƒå–é»˜è®¤å€¼0.75å°±å¥½äº†ã€‚ æ„é€ æ–¹æ³•1234567891011121314151617181920212223242526272829303132333435363738/** * æ ¹æ®åˆå§‹åŒ–å®¹é‡å’Œè´Ÿè½½å› å­æ„å»ºä¸€ä¸ªç©ºçš„HashMap. */public HashMap(int initialCapacity, float loadFactor) &#123; if (initialCapacity &lt; 0) throw new IllegalArgumentException(\"Illegal initial capacity: \" + initialCapacity); if (initialCapacity &gt; MAXIMUM_CAPACITY) initialCapacity = MAXIMUM_CAPACITY; if (loadFactor &lt;= 0 || Float.isNaN(loadFactor)) throw new IllegalArgumentException(\"Illegal load factor: \" + loadFactor); this.loadFactor = loadFactor; //æ³¨æ„æ­¤å¤„çš„tableSizeForæ–¹æ³• this.threshold = tableSizeFor(initialCapacity);&#125;/** * ä½¿ç”¨åˆå§‹åŒ–å®¹é‡å’Œé»˜è®¤åŠ è½½å› å­(0.75). */public HashMap(int initialCapacity) &#123; this(initialCapacity, DEFAULT_LOAD_FACTOR);&#125;/** * ä½¿ç”¨é»˜è®¤åˆå§‹åŒ–å¤§å°(16)å’Œé»˜è®¤åŠ è½½å› å­(0.75). */public HashMap() &#123; this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted&#125;/** * ç”¨å·²æœ‰çš„Mapæ„é€ ä¸€ä¸ªæ–°çš„HashMap. */public HashMap(Map&lt;? extends K, ? extends V&gt; m) &#123; this.loadFactor = DEFAULT_LOAD_FACTOR; putMapEntries(m, false);&#125; é€šè¿‡é‡è½½æ–¹æ³•HashMapä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š1. åˆå§‹åŒ–å®¹é‡ï¼›2. è£…è½½å› å­ã€‚é‚£ä¹ˆå°±ä»‹ç»ä¸‹å‡ ä¸ªåè¯ï¼š capacityï¼šè¡¨ç¤ºçš„æ˜¯hashmapä¸­æ¡¶çš„æ•°é‡ï¼Œåˆå§‹åŒ–å®¹é‡initCapacityä¸º16ï¼Œç¬¬ä¸€æ¬¡æ‰©å®¹ä¼šæ‰©åˆ°64ï¼Œä¹‹åæ¯æ¬¡æ‰©å®¹éƒ½æ˜¯ä¹‹å‰å®¹é‡çš„2å€ï¼Œæ‰€ä»¥å®¹é‡æ¯æ¬¡éƒ½æ˜¯2çš„æ¬¡å¹‚ã€‚ loadFactorï¼šè£…è½½å› å­ï¼Œè¡¡é‡hashmapä¸€ä¸ªæ»¡çš„ç¨‹åº¦ï¼Œåˆå§‹åŒ–ä¸º0.75 thresholdï¼šhashmapæ‰©å®¹çš„ä¸€ä¸ªé˜ˆå€¼æ ‡å‡†ï¼Œæ¯å½“sizeå¤§äºè¿™ä¸ªé˜ˆå€¼æ—¶å°±ä¼šè¿›è¡Œæ‰©å®¹æ“ä½œï¼Œthreesholdç­‰äºcapacity*loadfactor tableSizeFor()æ–¹æ³•è¿™ä¸ªæ–¹æ³•è¢«è°ƒç”¨çš„åœ°æ–¹åœ¨ä¸Šé¢æ„é€ å‡½æ•°ä¸­ï¼Œå½“ä¼ å…¥ä¸€ä¸ªåˆå§‹å®¹é‡æ—¶ï¼Œä¼šè°ƒç”¨this.threshold = tableSizeFor(initialCapacity);è®¡ç®—æ‰©å®¹é˜ˆå€¼ã€‚é‚£å®ƒæ˜¯ç©¶ç«Ÿå¹²äº†ä»€ä¹ˆçš„å‘¢ï¼ŸtableSizeForçš„åŠŸèƒ½ï¼ˆä¸è€ƒè™‘å¤§äºæœ€å¤§å®¹é‡çš„æƒ…å†µï¼‰æ˜¯è¿”å›å¤§äºè¾“å…¥å‚æ•°ä¸”æœ€è¿‘çš„2çš„æ•´æ•°æ¬¡å¹‚çš„æ•°ã€‚æ¯”å¦‚10ï¼Œåˆ™è¿”å›16ã€‚è¯¥ç®—æ³•æºç å¦‚ä¸‹ï¼š 123456789101112/** * Returns a power of two size for the given target capacity. */static final int tableSizeFor(int cap) &#123; int n = cap - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;&#125; æˆ‘ä»¬æ¥åˆ†ææœ‰å…³nä½æ“ä½œéƒ¨åˆ†ï¼šå…ˆæ¥å‡è®¾nçš„äºŒè¿›åˆ¶ä¸º01xxxâ€¦xxxã€‚æ¥ç€ å¯¹nå³ç§»1ä½ï¼š001xx...xxxï¼Œå†ä½æˆ–ï¼š011xx...xxxå¯¹nå³ç§»2ä¸ºï¼š00011...xxxï¼Œå†ä½æˆ–ï¼š01111...xxxæ­¤æ—¶å‰é¢å·²ç»æœ‰å››ä¸ª1äº†ï¼Œå†å³ç§»4ä½ä¸”ä½æˆ–å¯å¾—8ä¸ª1åŒç†ï¼Œæœ‰8ä¸ª1ï¼Œå³ç§»8ä½è‚¯å®šä¼šè®©åå…«ä½ä¹Ÿä¸º1ã€‚ç»¼ä¸Šå¯å¾—ï¼Œè¯¥ç®—æ³•è®©æœ€é«˜ä½çš„1åé¢çš„ä½å…¨å˜ä¸º1ã€‚æœ€åå†è®©ç»“æœn+1ï¼Œå³å¾—åˆ°äº†2çš„æ•´æ•°æ¬¡å¹‚çš„å€¼äº†ã€‚ ç°åœ¨å›æ¥çœ‹çœ‹ç¬¬ä¸€æ¡è¯­å¥ï¼š 1int n = cap - 1; è®©cap-1å†èµ‹å€¼ç»™nçš„ç›®çš„æ˜¯å¦æ‰¾åˆ°çš„ç›®æ ‡å€¼å¤§äºæˆ–ç­‰äºåŸå€¼ã€‚ä¾‹å¦‚äºŒè¿›åˆ¶1000ï¼Œåè¿›åˆ¶æ•°å€¼ä¸º8ã€‚å¦‚æœä¸å¯¹å®ƒå‡1è€Œç›´æ¥æ“ä½œï¼Œå°†å¾—åˆ°ç­”æ¡ˆ10000ï¼Œå³16ã€‚æ˜¾ç„¶ä¸æ˜¯ç»“æœã€‚å‡1åäºŒè¿›åˆ¶ä¸º111ï¼Œå†è¿›è¡Œæ“ä½œåˆ™ä¼šå¾—åˆ°åŸæ¥çš„æ•°å€¼1000ï¼Œå³8ã€‚ ä¸¾ä¸€ä¸ªä¾‹å­è¯´æ˜ä¸‹å§ã€‚æ¯”å¦‚cap=10ï¼Œåˆ™è¿”å›16ã€‚ ç”±æ­¤å¯ä»¥çœ‹åˆ°ï¼Œå½“åœ¨å®ä¾‹åŒ–HashMapå®ä¾‹æ—¶ï¼Œå¦‚æœç»™å®šäº†initialCapacityï¼Œç”±äºHashMapçš„å®¹é‡capacityéƒ½æ˜¯2çš„å¹‚ï¼Œå› æ­¤è¿™ä¸ªæ–¹æ³•ç”¨äºæ‰¾åˆ°å¤§äºç­‰äºinitialCapacityçš„æœ€å°çš„2çš„å¹‚ï¼ˆinitialCapacityå¦‚æœå°±æ˜¯2çš„å¹‚ï¼Œåˆ™è¿”å›çš„è¿˜æ˜¯è¿™ä¸ªæ•°ï¼‰ã€‚ put()æ–¹æ³•JDK1.8å¯¹å“ˆå¸Œç¢°æ’åçš„æ‹‰é“¾ç®—æ³•è¿›è¡Œäº†ä¼˜åŒ–ï¼Œ å½“é“¾è¡¨ä¸ŠEntryæ•°é‡å¤ªå¤šï¼ˆè¶…è¿‡8ä¸ªï¼‰æ—¶ï¼Œå°†é“¾è¡¨é‡æ„ä¸ºçº¢é»‘æ ‘ã€‚ä¸‹é¢æ˜¯æºç ç›¸å…³çš„æ³¨é‡Šï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071public V put(K key, V value) &#123; return putVal(hash(key), key, value, false, true);&#125;/** * Implements Map.put and related methods * * @param hash hash for key * @param key the key * @param value the value to put * @param onlyIfAbsent if true, don't change existing value * @param evict if false, the table is in creation mode. * @return previous value, or null if none */final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; //æ­¥éª¤â‘ ï¼šå¦‚æœTableä¸ºç©ºï¼Œåˆå§‹åŒ–ä¸€ä¸ªTable if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; //æ­¥éª¤â‘¡ï¼šå¦‚æœè¯¥bucketä½ç½®æ²¡å€¼ï¼Œåˆ™ç›´æ¥å­˜å‚¨åˆ°è¯¥bucketä½ç½® if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); else &#123; Node&lt;K,V&gt; e; K k; //æ­¥éª¤â‘¢ï¼šå¦‚æœèŠ‚ç‚¹keyå­˜åœ¨ï¼Œç›´æ¥è¦†ç›–value if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; //æ­¥éª¤â‘£ï¼šå¦‚æœè¯¥bucketä½ç½®æ•°æ®æ˜¯TreeNodeç±»å‹ï¼Œåˆ™å°†æ–°æ•°æ®æ·»åŠ åˆ°çº¢é»‘æ ‘ä¸­ã€‚ else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else &#123; //æ­¥éª¤â‘¤ï¼šå¦‚æœè¯¥é“¾ä¸ºé“¾è¡¨ for (int binCount = 0; ; ++binCount) &#123; //æ·»åŠ åˆ°é“¾è¡¨å°¾éƒ¨ if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); //å¦‚æœé“¾è¡¨ä¸ªæ•°è¾¾åˆ°8ä¸ªæ—¶ï¼Œå°†é“¾è¡¨ä¿®æ”¹ä¸ºçº¢é»‘æ ‘ç»“æ„ break; &#125; // keyå·²ç»å­˜åœ¨ç›´æ¥è¦†ç›–value if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; //æ›´æ–°é”®å€¼ï¼Œå¹¶è¿”å›æ—§å€¼ if (e != null) &#123; // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; &#125; &#125; ++modCount; //æ­¥éª¤â‘¥ï¼šå­˜å‚¨çš„æ•°ç›®è¶…è¿‡æœ€å¤§å®¹é‡é˜ˆå€¼ï¼Œå°±æ‰©å®¹ if (++size &gt; threshold) resize(); afterNodeInsertion(evict); return null;&#125; HashMapçš„putæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹å¯ä»¥é€šè¿‡ä¸‹å›¾æ¥ç†è§£ã€‚ å›¾ä¸­çš„æ­¥éª¤æ€»ç»“å¦‚ä¸‹ï¼š â‘ . åˆ¤æ–­é”®å€¼å¯¹æ•°ç»„table[i]æ˜¯å¦ä¸ºç©ºæˆ–ä¸ºnullï¼Œå¦åˆ™æ‰§è¡Œresize()è¿›è¡Œæ‰©å®¹ï¼› â‘¡. æ ¹æ®é”®å€¼keyè®¡ç®—hashå€¼å¾—åˆ°æ’å…¥çš„æ•°ç»„ç´¢å¼•iï¼Œå¦‚æœtable[i]==nullï¼Œç›´æ¥æ–°å»ºèŠ‚ç‚¹æ·»åŠ ï¼Œè½¬å‘â‘¥ï¼Œå¦‚æœtable[i]ä¸ä¸ºç©ºï¼Œè½¬å‘â‘¢ï¼› â‘¢. åˆ¤æ–­table[i]çš„é¦–ä¸ªå…ƒç´ æ˜¯å¦å’Œkeyä¸€æ ·ï¼Œå¦‚æœç›¸åŒç›´æ¥è¦†ç›–valueï¼Œå¦åˆ™è½¬å‘â‘£ï¼Œè¿™é‡Œçš„ç›¸åŒæŒ‡çš„æ˜¯hashCodeä»¥åŠequalsï¼› â‘£. åˆ¤æ–­table[i] æ˜¯å¦ä¸ºtreeNodeï¼Œå³table[i] æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥é”®å€¼å¯¹ï¼Œå¦åˆ™è½¬å‘â‘¤ï¼› â‘¤. éå†table[i]ï¼Œåˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº8ï¼Œå¤§äº8çš„è¯æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¦åˆ™è¿›è¡Œé“¾è¡¨çš„æ’å…¥æ“ä½œï¼›éå†è¿‡ç¨‹ä¸­è‹¥å‘ç°keyå·²ç»å­˜åœ¨ç›´æ¥è¦†ç›–valueå³å¯ï¼› â‘¥. æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡sizeæ˜¯å¦è¶…å¤šäº†æœ€å¤§å®¹é‡thresholdï¼Œå¦‚æœè¶…è¿‡ï¼Œè¿›è¡Œæ‰©å®¹ã€‚ get()æ–¹æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243public V get(Object key) &#123; Node&lt;K,V&gt; e; return (e = getNode(hash(key), key)) == null ? null : e.value;&#125;/** * Implements Map.get and related methods * * @param hash hash for key * @param key the key * @return the node, or null if none */final Node&lt;K,V&gt; getNode(int hash, Object key) &#123; Node&lt;K,V&gt;[] tab; //Tableæ¡¶ Node&lt;K,V&gt; first, e; int n; K k; //tableæ•°ç»„ä¸ä¸ºç©ºä¸”lengthå¤§äº0ï¼Œå¹¶ä¸”keyçš„hashå¯¹åº”çš„æ¡¶ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ä¸ºç©ºæ—¶ï¼Œæ‰å»get if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (first = tab[(n - 1) &amp; hash]) != null) &#123; //é¦–å…ˆåˆ¤æ–­æ˜¯ä¸æ˜¯keyçš„hashå¯¹åº”çš„æ¡¶ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´  if (first.hash == hash &amp;&amp; // always check first node ((k = first.key) == key || (key != null &amp;&amp; key.equals(k)))) return first; if ((e = first.next) != null) &#123; //å¦‚æœè¯¥æ¡¶çš„å­˜å‚¨ç»“æ„æ˜¯çº¢é»‘æ ‘ï¼Œä»æ ‘ä¸­æŸ¥æ‰¾å¹¶è¿”å› if (first instanceof TreeNode) return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key); //å¦åˆ™ï¼Œéå†é“¾è¡¨å¹¶è¿”å› do &#123; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) return e; &#125; while ((e = e.next) != null); &#125; &#125; return null;&#125; get()æ–¹æ³•å°±ç›¸å¯¹ç®€å•äº†ï¼Œé€šè¿‡hashå®šä½æ¡¶ï¼Œç„¶åæ ¹æ®è¯¥æ¡¶çš„å­˜å‚¨ç»“æ„å†³å®šæ˜¯éå†çº¢é»‘æ ‘è¿˜æ˜¯éå†é“¾è¡¨ã€‚ hash()æ–¹æ³•123456789101112131415//java 8ä¸­çš„æ•£åˆ—å€¼ä¼˜åŒ–å‡½æ•° static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);&#125;//java 7ä¸­çš„æ•£åˆ—å‡½æ•°static int hash(int h) &#123; // This function ensures that hashCodes that differ only by // constant multiples at each bit position have a bounded // number of collisions (approximately 8 at default load factor). h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12); return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4);&#125; è¿™æ®µä»£ç å«â€œæ‰°åŠ¨å‡½æ•°â€ã€‚å¤§å®¶éƒ½çŸ¥é“ä¸Šé¢ä»£ç é‡Œçš„key.hashCode()å‡½æ•°è°ƒç”¨çš„æ˜¯keyé”®å€¼ç±»å‹è‡ªå¸¦çš„å“ˆå¸Œå‡½æ•°ï¼Œè¿”å›intå‹æ•£åˆ—å€¼ã€‚ ç†è®ºä¸Šæ•£åˆ—å€¼æ˜¯ä¸€ä¸ªintå‹ï¼Œå¦‚æœç›´æ¥æ‹¿æ•£åˆ—å€¼ä½œä¸ºä¸‹æ ‡è®¿é—®HashMapä¸»æ•°ç»„çš„è¯ï¼Œè€ƒè™‘åˆ°2è¿›åˆ¶32ä½å¸¦ç¬¦å·çš„intè¡¨å€¼èŒƒå›´ä»-2147483648åˆ°2147483648ã€‚å‰ååŠ èµ·æ¥å¤§æ¦‚40äº¿çš„æ˜ å°„ç©ºé—´ã€‚åªè¦å“ˆå¸Œå‡½æ•°æ˜ å°„å¾—æ¯”è¾ƒå‡åŒ€æ¾æ•£ï¼Œä¸€èˆ¬åº”ç”¨æ˜¯å¾ˆéš¾å‡ºç°ç¢°æ’çš„ã€‚ä½†é—®é¢˜æ˜¯ä¸€ä¸ª40äº¿é•¿åº¦çš„æ•°ç»„ï¼Œå†…å­˜æ˜¯æ”¾ä¸ä¸‹çš„ã€‚æ‰€ä»¥è¿™ä¸ªæ•£åˆ—å€¼æ˜¯ä¸èƒ½ç›´æ¥æ‹¿æ¥ç”¨çš„ã€‚ç”¨ä¹‹å‰è¿˜è¦å…ˆåšå¯¹æ•°ç»„çš„é•¿åº¦å–æ¨¡è¿ç®—ï¼Œå¾—åˆ°çš„ä½™æ•°æ‰èƒ½ç”¨æ¥è®¿é—®æ•°ç»„ä¸‹æ ‡ã€‚JDK1.8æºç ä¸­æ¨¡è¿ç®—æ˜¯è¿™ä¹ˆå®Œæˆçš„ï¼ši = (length - 1) &amp; hashï¼Œè€Œåœ¨JDK1.7ä¸­æ˜¯åœ¨indexFor( )å‡½æ•°é‡Œå®Œæˆçš„ã€‚ 12345bucketIndex = indexFor(hash, table.length);static int indexFor(int h, int length) &#123; return h &amp; (length-1);&#125; indexFor()çš„ä»£ç ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠæ•£åˆ—å€¼å’Œæ•°ç»„é•¿åº¦åšä¸€ä¸ªâ€œä¸â€æ“ä½œï¼Œå°±å®šä½å‡ºäº†Keyå¯¹åº”çš„æ¡¶ï¼Œè¿™ä¸ªæ–¹æ³•éå¸¸å·§å¦™ï¼Œå®ƒé€šè¿‡h &amp; (table.length -1)æ¥å¾—åˆ°è¯¥å¯¹è±¡çš„ä¿å­˜ä½ï¼Œè€ŒHashMapåº•å±‚æ•°ç»„çš„é•¿åº¦æ€»æ˜¯2çš„næ¬¡æ–¹ï¼Œè¿™æ˜¯HashMapåœ¨é€Ÿåº¦ä¸Šçš„ä¼˜åŒ–ã€‚å½“lengthæ€»æ˜¯2çš„næ¬¡æ–¹æ—¶ï¼Œh&amp; (length-1)è¿ç®—ç­‰ä»·äºå¯¹lengthå–æ¨¡ï¼Œä¹Ÿå°±æ˜¯h%lengthï¼Œä½†æ˜¯ä½è¿ç®—&amp;æ¯”å–æ¨¡è¿ç®—%å…·æœ‰æ›´é«˜çš„æ•ˆç‡ã€‚ è¿™ä¹Ÿæ­£å¥½è§£é‡Šäº†ä¸ºä»€ä¹ˆHashMapçš„æ•°ç»„é•¿åº¦è¦å–2çš„æ•´æ¬¡å¹‚ã€‚å› ä¸ºè¿™æ ·ï¼ˆæ•°ç»„é•¿åº¦-1ï¼‰æ­£å¥½ç›¸å½“äºä¸€ä¸ªâ€œä½ä½æ©ç â€ã€‚â€œä¸â€æ“ä½œçš„ç»“æœå°±æ˜¯æ•£åˆ—å€¼çš„é«˜ä½å…¨éƒ¨å½’é›¶ï¼Œåªä¿ç•™ä½ä½å€¼ï¼Œç”¨æ¥åšæ•°ç»„ä¸‹æ ‡è®¿é—®ã€‚ä»¥åˆå§‹é•¿åº¦16ä¸ºä¾‹ï¼Œ16-1=15ã€‚2è¿›åˆ¶è¡¨ç¤ºæ˜¯00000000 00000000 00001111ã€‚å’ŒæŸæ•£åˆ—å€¼åšâ€œä¸â€æ“ä½œå¦‚ä¸‹ï¼Œç»“æœå°±æ˜¯æˆªå–äº†æœ€ä½çš„å››ä½å€¼ã€‚ 1234 10100101 11000100 00100101&amp; 00000000 00000000 00001111---------------------------------- 00000000 00000000 00000101 //é«˜ä½å…¨éƒ¨å½’é›¶ï¼Œåªä¿ç•™æœ«å››ä½ ä½†è¿™æ—¶å€™é—®é¢˜å°±æ¥äº†ï¼Œè¿™æ ·å°±ç®—æˆ‘çš„æ•£åˆ—å€¼åˆ†å¸ƒå†æ¾æ•£ï¼Œè¦æ˜¯åªå–æœ€åå‡ ä½çš„è¯ï¼Œç¢°æ’ä¹Ÿä¼šå¾ˆä¸¥é‡ã€‚æ›´è¦å‘½çš„æ˜¯å¦‚æœæ•£åˆ—æœ¬èº«åšå¾—ä¸å¥½ï¼Œåˆ†å¸ƒä¸Šæˆç­‰å·®æ•°åˆ—çš„æ¼æ´ï¼Œæ°å¥½ä½¿æœ€åå‡ ä¸ªä½ä½å‘ˆç°è§„å¾‹æ€§é‡å¤ï¼Œå°±æ— æ¯”è›‹ç–¼ã€‚ è¿™æ—¶å€™â€œæ‰°åŠ¨å‡½æ•°â€çš„ä»·å€¼å°±ä½“ç°å‡ºæ¥äº†ï¼Œè¯´åˆ°è¿™é‡Œå¤§å®¶åº”è¯¥çŒœå‡ºæ¥äº†ã€‚çœ‹ä¸‹é¢è¿™ä¸ªå›¾ï¼Œ å³ä½ç§»16ä½ï¼Œæ­£å¥½æ˜¯32bitçš„ä¸€åŠï¼Œè‡ªå·±çš„é«˜åŠåŒºå’Œä½åŠåŒºåšå¼‚æˆ–ï¼Œå°±æ˜¯ä¸ºäº†æ··åˆåŸå§‹å“ˆå¸Œç çš„é«˜ä½å’Œä½ä½ï¼Œä»¥æ­¤æ¥åŠ å¤§ä½ä½çš„éšæœºæ€§ã€‚è€Œä¸”æ··åˆåçš„ä½ä½æºæ‚äº†é«˜ä½çš„éƒ¨åˆ†ç‰¹å¾ï¼Œè¿™æ ·é«˜ä½çš„ä¿¡æ¯ä¹Ÿè¢«å˜ç›¸ä¿ç•™ä¸‹æ¥ã€‚ åœ¨JDK1.8çš„å®ç°ä¸­ï¼Œä¼˜åŒ–äº†é«˜ä½è¿ç®—çš„ç®—æ³•ï¼Œé€šè¿‡hashCode()çš„é«˜16ä½å¼‚æˆ–ä½16ä½å®ç°çš„ï¼š(h = k.hashCode()) ^ (h &gt;&gt;&gt; 16)ï¼Œä¸»è¦æ˜¯ä»é€Ÿåº¦ã€åŠŸæ•ˆã€è´¨é‡æ¥è€ƒè™‘çš„ï¼Œè¿™ä¹ˆåšå¯ä»¥åœ¨æ•°ç»„tableçš„lengthæ¯”è¾ƒå°çš„æ—¶å€™ï¼Œä¹Ÿèƒ½ä¿è¯è€ƒè™‘åˆ°é«˜ä½Bitéƒ½å‚ä¸åˆ°Hashçš„è®¡ç®—ä¸­ï¼ŒåŒæ—¶ä¸ä¼šæœ‰å¤ªå¤§çš„å¼€é”€ã€‚ resize()æ‰©å®¹æ–¹æ³•æ‰©å®¹(resize)å°±æ˜¯é‡æ–°è®¡ç®—å®¹é‡ï¼Œå‘HashMapå¯¹è±¡é‡Œä¸åœçš„æ·»åŠ å…ƒç´ ï¼Œè€ŒHashMapå¯¹è±¡å†…éƒ¨çš„æ•°ç»„æ— æ³•è£…è½½æ›´å¤šçš„å…ƒç´ æ—¶ï¼Œå¯¹è±¡å°±éœ€è¦æ‰©å¤§æ•°ç»„çš„é•¿åº¦ï¼Œä»¥ä¾¿èƒ½è£…å…¥æ›´å¤šçš„å…ƒç´ ã€‚å½“ç„¶Javaé‡Œçš„æ•°ç»„æ˜¯æ— æ³•è‡ªåŠ¨æ‰©å®¹çš„ï¼Œæ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªæ–°çš„æ•°ç»„ä»£æ›¿å·²æœ‰çš„å®¹é‡å°çš„æ•°ç»„ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980final Node&lt;K,V&gt;[] resize() &#123; Node&lt;K,V&gt;[] oldTab = table; int oldCap = (oldTab == null) ? 0 : oldTab.length; int oldThr = threshold; int newCap, newThr = 0; if (oldCap &gt; 0) &#123; // è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§ if (oldCap &gt;= MAXIMUM_CAPACITY) &#123; threshold = Integer.MAX_VALUE; return oldTab; &#125; // æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€ else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) newThr = oldThr &lt;&lt; 1; // double threshold &#125; else if (oldThr &gt; 0) // initial capacity was placed in threshold newCap = oldThr; else &#123; // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); &#125; // è®¾ç½®æ–°çš„resizeä¸Šé™ if (newThr == 0) &#123; float ft = (float)newCap * loadFactor; newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); &#125; threshold = newThr; @SuppressWarnings(&#123;\"rawtypes\"ï¼Œ\"unchecked\"&#125;) Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap]; table = newTab; if (oldTab != null) &#123; // æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­ for (int j = 0; j &lt; oldCap; ++j) &#123; Node&lt;K,V&gt; e; if ((e = oldTab[j]) != null) &#123; oldTab[j] = null; if (e.next == null) //å¦‚æœè¯¥æ¡¶åªæœ‰ä¸€ä¸ªæ•°æ®ï¼Œåˆ™æ•£åˆ—åˆ°å½“å‰ä½ç½®æˆ–è€…ï¼ˆåŸä½ç½®+oldCapï¼‰ä½ç½® newTab[e.hash &amp; (newCap - 1)] = e; else if (e instanceof TreeNode) //çº¢é»‘æ ‘é‡æ„ ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap); else &#123; // é“¾è¡¨ä¼˜åŒ–é‡hashçš„ä»£ç å— Node&lt;K,V&gt; loHead = null, loTail = null; Node&lt;K,V&gt; hiHead = null, hiTail = null; Node&lt;K,V&gt; next; do &#123; next = e.next; // åŸç´¢å¼• if ((e.hash &amp; oldCap) == 0) &#123; if (loTail == null) loHead = e; else loTail.next = e; loTail = e; &#125; else &#123; // åŸç´¢å¼•+oldCap if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; &#125; &#125; while ((e = next) != null); // åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ if (loTail != null) &#123; loTail.next = null; newTab[j] = loHead; &#125; // åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ if (hiTail != null) &#123; hiTail.next = null; newTab[j + oldCap] = hiHead; &#125; &#125; &#125; &#125; &#125; return newTab;&#125; ä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸‹æ‰©å®¹è¿‡ç¨‹ã€‚å‡è®¾äº†æˆ‘ä»¬çš„hashç®—æ³•å°±æ˜¯ç®€å•çš„ç”¨key mod ä¸€ä¸‹è¡¨çš„å¤§å°ï¼ˆä¹Ÿå°±æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ã€‚å…¶ä¸­çš„å“ˆå¸Œæ¡¶æ•°ç»„tableçš„size=2ï¼Œ æ‰€ä»¥key = 3ã€7ã€5ï¼Œputé¡ºåºä¾æ¬¡ä¸º 5ã€7ã€3ã€‚åœ¨mod 2ä»¥åéƒ½å†²çªåœ¨table[1]è¿™é‡Œäº†ã€‚è¿™é‡Œå‡è®¾è´Ÿè½½å› å­ loadFactor=1ï¼Œå³å½“Entryçš„å®é™…æ•°é‡size å¤§äºæ¡¶tableçš„å®é™…æ•°é‡æ—¶è¿›è¡Œæ‰©å®¹ã€‚æ¥ä¸‹æ¥çš„ä¸‰ä¸ªæ­¥éª¤æ˜¯å“ˆå¸Œæ¡¶æ•°ç»„ resizeæˆ4ï¼Œç„¶åæ‰€æœ‰çš„Nodeé‡æ–°rehashçš„è¿‡ç¨‹ã€‚ åœ¨JDK1.8ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯2æ¬¡å¹‚çš„æ‰©å±•(æŒ‡é•¿åº¦æ‰©ä¸ºåŸæ¥2å€)ï¼Œæ‰€ä»¥ï¼Œå…ƒç´ çš„ä½ç½®è¦ä¹ˆæ˜¯åœ¨åŸä½ç½®ï¼Œè¦ä¹ˆæ˜¯åœ¨åŸä½ç½®å†ç§»åŠ¨2æ¬¡å¹‚çš„ä½ç½®ã€‚çœ‹ä¸‹å›¾å¯ä»¥æ˜ç™½è¿™å¥è¯çš„æ„æ€ï¼Œnä¸ºtableçš„é•¿åº¦ï¼Œå›¾ï¼ˆaï¼‰è¡¨ç¤ºæ‰©å®¹å‰çš„key1å’Œkey2ä¸¤ç§keyç¡®å®šç´¢å¼•ä½ç½®çš„ç¤ºä¾‹ï¼Œå›¾ï¼ˆbï¼‰è¡¨ç¤ºæ‰©å®¹åkey1å’Œkey2ä¸¤ç§keyç¡®å®šç´¢å¼•ä½ç½®çš„ç¤ºä¾‹ï¼Œå…¶ä¸­hash1æ˜¯key1å¯¹åº”çš„å“ˆå¸Œä¸é«˜ä½è¿ç®—ç»“æœã€‚ å…ƒç´ åœ¨é‡æ–°è®¡ç®—hashä¹‹åï¼Œå› ä¸ºnå˜ä¸º2å€ï¼Œé‚£ä¹ˆn-1çš„maskèŒƒå›´åœ¨é«˜ä½å¤š1bit(çº¢è‰²)ï¼Œå› æ­¤æ–°çš„indexå°±ä¼šå‘ç”Ÿè¿™æ ·çš„å˜åŒ–ï¼š å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ‰©å……HashMapçš„æ—¶å€™ï¼Œä¸éœ€è¦åƒJDK1.7çš„å®ç°é‚£æ ·é‡æ–°è®¡ç®—hashï¼Œåªéœ€è¦çœ‹çœ‹åŸæ¥çš„hashå€¼æ–°å¢çš„é‚£ä¸ªbitæ˜¯1è¿˜æ˜¯0å°±å¥½äº†ï¼Œæ˜¯0çš„è¯ç´¢å¼•æ²¡å˜ï¼Œæ˜¯1çš„è¯ç´¢å¼•å˜æˆâ€œåŸç´¢å¼•+oldCapâ€ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹å›¾ä¸º16æ‰©å……ä¸º32çš„resizeç¤ºæ„å›¾ï¼š è¿™ä¸ªè®¾è®¡ç¡®å®éå¸¸çš„å·§å¦™ï¼Œæ—¢çœå»äº†é‡æ–°è®¡ç®—hashå€¼çš„æ—¶é—´ï¼Œè€Œä¸”åŒæ—¶ï¼Œç”±äºæ–°å¢çš„1bitæ˜¯0è¿˜æ˜¯1å¯ä»¥è®¤ä¸ºæ˜¯éšæœºçš„ï¼Œå› æ­¤resizeçš„è¿‡ç¨‹ï¼Œå‡åŒ€çš„æŠŠä¹‹å‰çš„å†²çªçš„èŠ‚ç‚¹åˆ†æ•£åˆ°æ–°çš„bucketäº†ã€‚è¿™ä¸€å—å°±æ˜¯JDK1.8æ–°å¢çš„ä¼˜åŒ–ç‚¹ã€‚æœ‰ä¸€ç‚¹æ³¨æ„åŒºåˆ«ï¼ŒJDK1.7ä¸­rehashçš„æ—¶å€™ï¼Œæ—§é“¾è¡¨è¿ç§»æ–°é“¾è¡¨çš„æ—¶å€™ï¼Œå¦‚æœåœ¨æ–°è¡¨çš„æ•°ç»„ç´¢å¼•ä½ç½®ç›¸åŒï¼Œåˆ™é“¾è¡¨å…ƒç´ ä¼šå€’ç½®ï¼Œä½†æ˜¯ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒJDK1.8ä¸ä¼šå€’ç½®ã€‚ä¸‹é¢æ˜¯JDK1.7çš„æ‰©å®¹æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536/** * JDK 1.7ä¸­çš„resize()æ–¹æ³• */void resize(int newCapacity) &#123; //ä¼ å…¥æ–°çš„å®¹é‡ Entry[] oldTable = table; //å¼•ç”¨æ‰©å®¹å‰çš„Entryæ•°ç»„ int oldCapacity = oldTable.length; if (oldCapacity == MAXIMUM_CAPACITY) &#123; //æ‰©å®¹å‰çš„æ•°ç»„å¤§å°å¦‚æœå·²ç»è¾¾åˆ°æœ€å¤§(2^30)äº† threshold = Integer.MAX_VALUE; //ä¿®æ”¹é˜ˆå€¼ä¸ºintçš„æœ€å¤§å€¼(2^31-1)ï¼Œè¿™æ ·ä»¥åå°±ä¸ä¼šæ‰©å®¹äº† return; &#125; Entry[] newTable = new Entry[newCapacity]; //åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„Entryæ•°ç»„ transfer(newTable); //ï¼ï¼å°†æ•°æ®è½¬ç§»åˆ°æ–°çš„Entryæ•°ç»„é‡Œ table = newTable; //HashMapçš„tableå±æ€§å¼•ç”¨æ–°çš„Entryæ•°ç»„ threshold = (int)(newCapacity * loadFactor);//ä¿®æ”¹é˜ˆå€¼&#125;//transfer()æ–¹æ³•å°†åŸæœ‰Entryæ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°çš„Entryæ•°ç»„é‡Œã€‚void transfer(Entry[] newTable) &#123; Entry[] src = table; //srcå¼•ç”¨äº†æ—§çš„Entryæ•°ç»„ int newCapacity = newTable.length; for (int j = 0; j &lt; src.length; j++) &#123; //éå†æ—§çš„Entryæ•°ç»„ Entry&lt;K,V&gt; e = src[j]; //å–å¾—æ—§Entryæ•°ç»„çš„æ¯ä¸ªå…ƒç´  if (e != null) &#123; src[j] = null;//é‡Šæ”¾æ—§Entryæ•°ç»„çš„å¯¹è±¡å¼•ç”¨ï¼ˆforå¾ªç¯åï¼Œæ—§çš„Entryæ•°ç»„ä¸å†å¼•ç”¨ä»»ä½•å¯¹è±¡ï¼‰ do &#123; Entry&lt;K,V&gt; next = e.next; int i = indexFor(e.hash, newCapacity); //ï¼ï¼é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½® e.next = newTable[i]; //æ ‡è®°[1] newTable[i] = e; //å°†å…ƒç´ æ”¾åœ¨æ•°ç»„ä¸Š e = next; //è®¿é—®ä¸‹ä¸€ä¸ªEntryé“¾ä¸Šçš„å…ƒç´  &#125; while (e != null); &#125; &#125;&#125; è¿™é‡Œå°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå®¹é‡æ›´å¤§çš„æ•°ç»„æ¥ä»£æ›¿å·²æœ‰çš„å®¹é‡å°çš„æ•°ç»„ï¼Œtransfer()æ–¹æ³•å°†åŸæœ‰Entryæ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°çš„Entryæ•°ç»„é‡Œã€‚newTable[i]çš„å¼•ç”¨èµ‹ç»™äº†e.nextï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨äº†å•é“¾è¡¨çš„å¤´æ’å…¥æ–¹å¼ï¼ŒåŒä¸€ä½ç½®ä¸Šæ–°å…ƒç´ æ€»ä¼šè¢«æ”¾åœ¨é“¾è¡¨çš„å¤´éƒ¨ä½ç½®ï¼›è¿™æ ·å…ˆæ”¾åœ¨ä¸€ä¸ªç´¢å¼•ä¸Šçš„å…ƒç´ ç»ˆä¼šè¢«æ”¾åˆ°Entryé“¾çš„å°¾éƒ¨(å¦‚æœå‘ç”Ÿäº†hashå†²çªçš„è¯ï¼‰ï¼Œè¿™ä¸€ç‚¹å’ŒJdk1.8æœ‰åŒºåˆ«ï¼Œä¸‹æ–‡è¯¦è§£ã€‚åœ¨æ—§æ•°ç»„ä¸­åŒä¸€æ¡Entryé“¾ä¸Šçš„å…ƒç´ ï¼Œé€šè¿‡é‡æ–°è®¡ç®—ç´¢å¼•ä½ç½®åï¼Œæœ‰å¯èƒ½è¢«æ”¾åˆ°äº†æ–°æ•°ç»„çš„ä¸åŒä½ç½®ä¸Šã€‚ æ ‘å½¢åŒ–æ–¹æ³•treeifyBin()åœ¨Java 8 ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ¡¶ä¸­çš„é“¾è¡¨å…ƒç´ ä¸ªæ•°è¶…è¿‡ TREEIFY_THRESHOLDï¼ˆé»˜è®¤æ˜¯ 8 ï¼‰ï¼Œå°±ä½¿ç”¨çº¢é»‘æ ‘æ¥æ›¿æ¢é“¾è¡¨ï¼Œä»è€Œæé«˜é€Ÿåº¦ã€‚è¿™ä¸ªæ›¿æ¢çš„æ–¹æ³•å« treeifyBin() å³æ ‘å½¢åŒ–ã€‚ 12345678910111213141516171819202122232425262728293031//å°†æ¡¶å†…æ‰€æœ‰çš„ é“¾è¡¨èŠ‚ç‚¹ æ›¿æ¢æˆ çº¢é»‘æ ‘èŠ‚ç‚¹final void treeifyBin(Node[] tab, int hash) &#123; int n, index; Node e; //å¦‚æœå½“å‰å“ˆå¸Œè¡¨ä¸ºç©ºï¼Œæˆ–è€…å“ˆå¸Œè¡¨ä¸­Entryå…ƒç´ æ€»æ•°é‡å°äºè¿›è¡Œæ ‘å½¢åŒ–çš„é˜ˆå€¼(é»˜è®¤ä¸º 64)ï¼Œå°±å»æ–°å»º/æ‰©å®¹ if (tab == null || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY) resize(); else if ((e = tab[index = (n - 1) &amp; hash]) != null) &#123; //å¦‚æœå“ˆå¸Œè¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡äº†æ ‘å½¢åŒ–é˜ˆå€¼ï¼Œè¿›è¡Œæ ‘å½¢åŒ– // e æ˜¯å“ˆå¸Œè¡¨ä¸­æŒ‡å®šä½ç½®æ¡¶é‡Œçš„é“¾è¡¨èŠ‚ç‚¹ï¼Œä»ç¬¬ä¸€ä¸ªå¼€å§‹ TreeNode hd = null, tl = null; //çº¢é»‘æ ‘çš„å¤´ã€å°¾èŠ‚ç‚¹ do &#123; //æ–°å»ºä¸€ä¸ªæ ‘å½¢èŠ‚ç‚¹ï¼Œå†…å®¹å’Œå½“å‰é“¾è¡¨èŠ‚ç‚¹ e ä¸€è‡´ TreeNode p = replacementTreeNode(e, null); if (tl == null) //ç¡®å®šæ ‘å¤´èŠ‚ç‚¹ hd = p; else &#123; p.prev = tl; tl.next = p; &#125; tl = p; &#125; while ((e = e.next) != null); //è®©æ¡¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡å‘æ–°å»ºçš„çº¢é»‘æ ‘å¤´ç»“ç‚¹ï¼Œä»¥åè¿™ä¸ªæ¡¶é‡Œçš„å…ƒç´ å°±æ˜¯çº¢é»‘æ ‘è€Œä¸æ˜¯é“¾è¡¨äº† if ((tab[index] = hd) != null) hd.treeify(tab); &#125;&#125;TreeNode replacementTreeNode(Node p, Node next) &#123; return new TreeNode&lt;&gt;(p.hash, p.key, p.value, next);&#125; ä¸Šè¿°æ“ä½œåšäº†è¿™äº›äº‹: æ ¹æ®å“ˆå¸Œè¡¨ä¸­å…ƒç´ ä¸ªæ•°ç¡®å®šæ˜¯æ‰©å®¹è¿˜æ˜¯æ ‘å½¢åŒ– å¦‚æœæ˜¯æ ‘å½¢åŒ– éå†æ¡¶ä¸­çš„å…ƒç´ ï¼Œåˆ›å»ºç›¸åŒä¸ªæ•°çš„æ ‘å½¢èŠ‚ç‚¹ï¼Œå¤åˆ¶å†…å®¹ï¼Œå»ºç«‹èµ·è”ç³» ç„¶åè®©æ¡¶ç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡å‘æ–°å»ºçš„æ ‘å¤´ç»“ç‚¹ï¼Œæ›¿æ¢æ¡¶çš„é“¾è¡¨å†…å®¹ä¸ºæ ‘å½¢å†…å®¹ ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œä¹‹å‰çš„æ“ä½œå¹¶æ²¡æœ‰è®¾ç½®çº¢é»‘æ ‘çš„é¢œè‰²å€¼ï¼Œç°åœ¨å¾—åˆ°çš„åªèƒ½ç®—æ˜¯ä¸ªäºŒå‰æ ‘ã€‚åœ¨ æœ€åè°ƒç”¨æ ‘å½¢rootèŠ‚ç‚¹ hd.treeify(tab)æ–¹æ³•è¿›è¡Œå¡‘é€ çº¢é»‘æ ‘ï¼Œæ¥çœ‹çœ‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546final void treeify(Node&lt;K,V&gt;[] tab) &#123; TreeNode&lt;K,V&gt; root = null; for (TreeNode&lt;K,V&gt; x = this, next; x != null; x = next) &#123; next = (TreeNode&lt;K,V&gt;)x.next; x.left = x.right = null; if (root == null) &#123; //ç¬¬ä¸€æ¬¡è¿›å…¥å¾ªç¯ï¼Œç¡®å®šrootæ ¹ç»“ç‚¹ï¼Œä¸ºé»‘è‰² x.parent = null; x.red = false; root = x; &#125; else &#123; //éç¬¬ä¸€æ¬¡è¿›å…¥å¾ªç¯ï¼ŒxæŒ‡å‘æ ‘ä¸­çš„æŸä¸ªèŠ‚ç‚¹ K k = x.key; int h = x.hash; Class&lt;?&gt; kc = null; //ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œéå†æ‰€æœ‰èŠ‚ç‚¹è·Ÿå½“å‰èŠ‚ç‚¹ x æ¯”è¾ƒï¼Œè°ƒæ•´ä½ç½® for (TreeNode&lt;K,V&gt; p = root;;) &#123; int dir, ph; K pk = p.key; if ((ph = p.hash) &gt; h) //å½“æ¯”è¾ƒèŠ‚ç‚¹pçš„å“ˆå¸Œå€¼æ¯” x å¤§æ—¶ï¼Œ dirä¸º-1 dir = -1; else if (ph &lt; h) //å“ˆå¸Œå€¼æ¯” x å°æ—¶ï¼Œdirä¸º1 dir = 1; else if ((kc == null &amp;&amp; (kc = comparableClassFor(k)) == null) || (dir = compareComparables(kc, k, pk)) == 0) dir = tieBreakOrder(k, pk); //æŠŠå½“å‰èŠ‚ç‚¹på˜æˆ x çš„çˆ¶äº² TreeNode&lt;K,V&gt; xp = p; //å¦‚æœå½“å‰æ¯”è¾ƒèŠ‚ç‚¹pçš„å“ˆå¸Œå€¼æ¯” x å¤§ï¼Œx å°±æ˜¯å·¦å­©å­ï¼Œå¦åˆ™ x æ˜¯å³å­©å­ if ((p = (dir &lt;= 0) ? p.left : p.right) == null) &#123; x.parent = xp; if (dir &lt;= 0) xp.left = x; else xp.right = x; //å¹³è¡¡æ“ä½œ root = balanceInsertion(root, x); break; &#125; &#125; &#125; &#125; moveRootToFront(tab, root);&#125; å¯ä»¥çœ‹åˆ°ï¼Œå°†äºŒå‰æ ‘å˜ä¸ºçº¢é»‘æ ‘æ—¶ï¼Œéœ€è¦ä¿è¯æœ‰åºã€‚è¿™é‡Œæœ‰ä¸ªåŒé‡å¾ªç¯ï¼Œæ‹¿æ ‘ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å’Œå½“å‰èŠ‚ç‚¹çš„å“ˆå¸Œå€¼è¿›è¡Œå¯¹æ¯”(å¦‚æœå“ˆå¸Œå€¼ç›¸ç­‰ï¼Œå°±å¯¹æ¯”é”®ï¼Œè¿™é‡Œä¸ç”¨å®Œå…¨æœ‰åºï¼‰ï¼Œç„¶åæ ¹æ®æ¯”è¾ƒç»“æœç¡®å®šåœ¨æ ‘ä¸­çš„ä½ç½®ã€‚ remove()æ–¹æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public V remove(Object key) &#123; Node&lt;K,V&gt; e; return (e = removeNode(hash(key), key, null, false, true)) == null ? null : e.value;&#125;final Node&lt;K,V&gt; removeNode(int hash, Object key, Object value, boolean matchValue, boolean movable) &#123; Node&lt;K,V&gt;[] tab; //æ‰€æœ‰çš„æ¡¶ Node&lt;K,V&gt; p; //å¯¹åº”æ¡¶çš„ç¬¬ä¸€ä¸ªå…ƒç´  int n, index; //æ¡¶æ•°é‡ï¼Œå¯¹åº”æ¡¶çš„æ¬¡åº if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (p = tab[index = (n - 1) &amp; hash]) != null) &#123; Node&lt;K,V&gt; node = null, e; K k; V v; //è¦åˆ é™¤çš„å…ƒç´ å¦‚æœåˆšå¥½åŒ¹é…è¯¥æ¡¶ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´  if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) node = p; //å¦‚æœä¸æ˜¯æ¡¶ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¾€ä¸‹éå† else if ((e = p.next) != null) &#123; if (p instanceof TreeNode) node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key); else &#123; do &#123; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) &#123; node = e; break; &#125; p = e; &#125; while ((e = e.next) != null); &#125; &#125; //æ‰¾åˆ°è¦åˆ é™¤çš„å…ƒç´ ä¹‹åï¼Œåˆ é™¤ if (node != null &amp;&amp; (!matchValue || (v = node.value) == value || (value != null &amp;&amp; value.equals(v)))) &#123; if (node instanceof TreeNode) //çº¢é»‘æ ‘ä¸­åˆ é™¤ ((TreeNode&lt;K,V&gt;)node).removeTreeNode(this, tab, movable); else if (node == p) //æ˜¯è¯¥æ¡¶ä¸­é“¾è¡¨é¦–èŠ‚ç‚¹åˆ é™¤ tab[index] = node.next; else p.next = node.next; ++modCount; --size; afterNodeRemoval(node); return node; &#125; &#125; return null;&#125; remove()æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œè¿™é‡Œå°±ä¸å±•å¼€è®²äº†ã€‚clear()æ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011//æ¸…ç©ºæ‰€æœ‰å…ƒç´ public void clear() &#123; Node&lt;K,V&gt;[] tab; modCount++; if ((tab = table) != null &amp;&amp; size &gt; 0) &#123; size = 0; //ä»…æ¸…ç©ºæ¡¶æ•°ç»„çš„å¼•ç”¨ for (int i = 0; i &lt; tab.length; ++i) tab[i] = null; // æŠŠå“ˆå¸Œæ•°ç»„ä¸­æ‰€æœ‰ä½ç½®éƒ½èµ‹ä¸ºnull &#125;&#125; çº¿ç¨‹å®‰å…¨æ€§ä¸€ç›´ä»¥æ¥åªæ˜¯çŸ¥é“HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯åˆ°åº•HashMapä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ï¼Œå¤šçº¿ç¨‹å¹¶å‘çš„æ—¶å€™åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¯èƒ½å‡ºç°é—®é¢˜ï¼Ÿ javadocä¸­å…³äºhashmapçš„ä¸€æ®µæè¿°å¦‚ä¸‹ï¼š æ­¤å®ç°ä¸æ˜¯åŒæ­¥çš„ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªå“ˆå¸Œæ˜ å°„ï¼Œè€Œå…¶ä¸­è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ä»ç»“æ„ä¸Šä¿®æ”¹äº†è¯¥æ˜ å°„ï¼Œåˆ™å®ƒå¿…é¡» ä¿æŒå¤–éƒ¨åŒæ­¥ã€‚ï¼ˆç»“æ„ä¸Šçš„ä¿®æ”¹æ˜¯æŒ‡æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ˜ å°„å…³ç³»çš„ä»»ä½•æ“ä½œï¼›ä»…æ”¹å˜ä¸å®ä¾‹å·²ç»åŒ…å«çš„é”®å…³è”çš„å€¼ä¸æ˜¯ç»“æ„ä¸Šçš„ä¿®æ”¹ã€‚ï¼‰è¿™ä¸€èˆ¬é€šè¿‡å¯¹è‡ªç„¶å°è£…è¯¥æ˜ å°„çš„å¯¹è±¡è¿›è¡ŒåŒæ­¥æ“ä½œæ¥å®Œæˆã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å¯¹è±¡ï¼Œåˆ™åº”è¯¥ä½¿ç”¨ Collections.synchronizedMap() æ–¹æ³•æ¥â€œåŒ…è£…â€è¯¥æ˜ å°„ã€‚æœ€å¥½åœ¨åˆ›å»ºæ—¶å®Œæˆè¿™ä¸€æ“ä½œï¼Œä»¥é˜²æ­¢å¯¹æ˜ å°„è¿›è¡Œæ„å¤–çš„éåŒæ­¥è®¿é—®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1Map m = Collections.synchronizedMap(new HashMap(...)); å¤šçº¿ç¨‹putåå¯èƒ½å¯¼è‡´getæ­»å¾ªç¯ é—®é¢˜åŸå› å°±æ˜¯HashMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œå¤šä¸ªçº¿ç¨‹putçš„æ—¶å€™é€ æˆäº†æŸä¸ªkeyå€¼Entry key Listçš„æ­»å¾ªç¯ï¼Œé—®é¢˜å°±è¿™ä¹ˆäº§ç”Ÿäº†ã€‚å‚è€ƒï¼šHashMapå¤šçº¿ç¨‹å¹¶å‘é—®é¢˜åˆ†æ å¤šçº¿ç¨‹putçš„æ—¶å€™å¯èƒ½å¯¼è‡´å…ƒç´ ä¸¢å¤± å¦‚æœä¸¤ä¸ªçº¿ç¨‹éƒ½put()æ—¶ï¼Œä½¿ç”¨p.next = newNode(hash, key, value, null);åŒæ—¶å–å¾—äº†pï¼Œåˆ™ä»–ä»¬ä¸‹ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯newNodeï¼Œç„¶åèµ‹å€¼ç»™tableå…ƒç´ çš„æ—¶å€™æœ‰ä¸€ä¸ªæˆåŠŸæœ‰ä¸€ä¸ªä¸¢å¤±ã€‚ æ³¨æ„ï¼šä¸åˆç†ä½¿ç”¨HashMapå¯¼è‡´å‡ºç°çš„æ˜¯æ­»å¾ªç¯è€Œä¸æ˜¯æ­»é”ã€‚ å°ç»“åˆ°è¿™é‡Œï¼Œä½ èƒ½å›ç­”å‡ºå¦‚ä¸‹é—®é¢˜å—ï¼Ÿ 1ã€å“ˆå¸ŒåŸºæœ¬åŸç†ï¼Ÿï¼ˆç­”ï¼šæ•£åˆ—è¡¨ã€hashç¢°æ’ã€é“¾è¡¨ã€çº¢é»‘æ ‘ï¼‰2ã€hashmapæŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ï¼Œ å½±å“å› ç´ å’ŒåŸç†ï¼Ÿ ï¼ˆç­”ï¼šæœ€å¥½Oï¼ˆ1ï¼‰ï¼Œæœ€å·®Oï¼ˆnï¼‰ï¼Œ å¦‚æœæ˜¯çº¢é»‘Oï¼ˆlognï¼‰ï¼‰3ã€resizeå¦‚ä½•å®ç°çš„ï¼Œ è®°ä½å·²ç»æ²¡æœ‰rehashäº†ï¼ï¼ï¼ï¼ˆç­”ï¼šæ‹‰é“¾entryæ ¹æ®é«˜ä½bitæ•£åˆ—åˆ°å½“å‰ä½ç½®iå’Œsize+iä½ç½®ï¼‰4ã€ä¸ºä»€ä¹ˆè·å–ä¸‹æ ‡æ—¶ç”¨æŒ‰ä½ä¸&amp;ï¼Œè€Œä¸æ˜¯å–æ¨¡%ï¼Ÿ ï¼ˆç­”ï¼šä¸åªæ˜¯&amp;é€Ÿåº¦æ›´å¿«å“¦ï¼Œ æˆ‘è§‰å¾—ä½ èƒ½ç­”ä¸Šæ¥ä¾¿çœŸæ­£ç†è§£hashmapäº†ï¼‰ è¯´æ˜(1) æ‰©å®¹æ˜¯ä¸€ä¸ªç‰¹åˆ«è€—æ€§èƒ½çš„æ“ä½œï¼Œæ‰€ä»¥å½“ç¨‹åºå‘˜åœ¨ä½¿ç”¨HashMapçš„æ—¶å€™ï¼Œä¼°ç®—mapçš„å¤§å°ï¼Œåˆå§‹åŒ–çš„æ—¶å€™ç»™ä¸€ä¸ªå¤§è‡´çš„æ•°å€¼ï¼Œé¿å…mapè¿›è¡Œé¢‘ç¹çš„æ‰©å®¹ã€‚(2) è´Ÿè½½å› å­æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä¹Ÿå¯ä»¥å¤§äº1ï¼Œä½†æ˜¯å»ºè®®ä¸è¦è½»æ˜“ä¿®æ”¹ï¼Œé™¤éæƒ…å†µéå¸¸ç‰¹æ®Šã€‚(3) HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸è¦åœ¨å¹¶å‘çš„ç¯å¢ƒä¸­åŒæ—¶æ“ä½œHashMapï¼Œå»ºè®®ä½¿ç”¨ConcurrentHashMapã€‚(4) JDK1.8å¼•å…¥çº¢é»‘æ ‘å¤§ç¨‹åº¦ä¼˜åŒ–äº†HashMapçš„æ€§èƒ½ã€‚(5) JDK1.7æ˜¯æ–°æ’å…¥çš„èŠ‚ç‚¹æ”¾åœ¨é“¾è¡¨çš„å¤´éƒ¨ï¼Œä½†æ˜¯JDK1.8æ˜¯æ–°æ’å…¥çš„èŠ‚ç‚¹æ”¾åˆ°å°¾éƒ¨ å½“æˆ‘ä»¬åœ¨HashMapä¸­å­˜å‚¨æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ç±»çš„æ—¶å€™ï¼Œé»˜è®¤çš„equalså‡½æ•°çš„è¡Œä¸ºå¯èƒ½ä¸èƒ½ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ï¼Œæ‰€ä»¥éœ€è¦é‡å†™ã€‚æ­¤æ—¶ï¼š 1ã€å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸åŒï¼ˆå³ç”¨equalsæ¯”è¾ƒè¿”å›trueï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„hashCodeå€¼ä¸€å®šè¦ç›¸åŒï¼›2ã€å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„hashCodeç›¸åŒï¼Œå®ƒä»¬å¹¶ä¸ä¸€å®šç›¸åŒ(å³ç”¨equalsæ¯”è¾ƒè¿”å›false) å‚è€ƒèµ„æ–™ é¢è¯•æ—§æ•Œä¹‹ HashMap : JDK 1.8 åå®ƒé€šè¿‡ä»€ä¹ˆæå‡æ€§èƒ½ HashMapä¸­capacityã€loadFactorã€thresholdã€sizeç­‰æ¦‚å¿µçš„è§£é‡Š Javaæºç åˆ†æä¹‹HashMap(JDK1.8) HashMapæºç åˆ†æï¼ˆJDK1.8ï¼‰- ä½ è¯¥çŸ¥é“çš„éƒ½åœ¨è¿™é‡Œäº† Javaé›†åˆï¼šHashMapæºç å‰–æ Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap - ç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿ JDKæºç ä¸­HashMapçš„hashæ–¹æ³•åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ - çŸ¥ä¹ HashMapæºç ä¹‹hash()å‡½æ•°åˆ†æï¼ˆJDK 1.8ï¼‰","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€Androidã€‘æºç åˆ†æ - Viewäº‹ä»¶åˆ†å‘æœºåˆ¶","slug":"ã€Androidã€‘æºç åˆ†æ - Viewäº‹ä»¶åˆ†å‘æœºåˆ¶","date":"2017-11-18T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/11/18/ã€Androidã€‘æºç åˆ†æ - Viewäº‹ä»¶åˆ†å‘æœºåˆ¶/","link":"","permalink":"http://github.com/2017/11/18/ã€Androidã€‘æºç åˆ†æ - Viewäº‹ä»¶åˆ†å‘æœºåˆ¶/","excerpt":"äº‹ä»¶åˆ†å‘å¯¹è±¡ï¼ˆ1ï¼‰æ‰€æœ‰ Touch äº‹ä»¶éƒ½è¢«å°è£…æˆäº† MotionEvent å¯¹è±¡ï¼ŒåŒ…æ‹¬ Touch çš„ä½ç½®ã€æ—¶é—´ã€å†å²è®°å½•ä»¥åŠç¬¬å‡ ä¸ªæ‰‹æŒ‡(å¤šæŒ‡è§¦æ‘¸)ç­‰ã€‚ ï¼ˆ2ï¼‰äº‹ä»¶ç±»å‹åˆ†ä¸º ACTION_DOWNï¼Œ ACTION_UPï¼ŒACTION_MOVEï¼ŒACTION_POINTER_DOWNï¼ŒACTION_POINTER_UPï¼Œ ACTION_CANCELï¼Œæ¯ä¸ªäº‹ä»¶éƒ½æ˜¯ä»¥ ACTION_DOWN å¼€å§‹ ACTION_UP ç»“æŸã€‚ ä¸»è¦å‘ç”Ÿçš„Touchäº‹ä»¶æœ‰å¦‚ä¸‹å››ç§ï¼š MotionEvent.ACTION_DOWNï¼šæŒ‰ä¸‹Viewï¼ˆæ‰€æœ‰äº‹ä»¶çš„å¼€å§‹ï¼‰ MotionEvent.ACTION_MOVEï¼šæ»‘åŠ¨View MotionEvent.ACTION_CANCELï¼šéäººä¸ºåŸå› ç»“æŸæœ¬æ¬¡äº‹ä»¶ MotionEvent.ACTION_UPï¼šæŠ¬èµ·Viewï¼ˆä¸DOWNå¯¹åº”ï¼‰ äº‹ä»¶åˆ—ï¼šä»æ‰‹æŒ‡æ¥è§¦å±å¹•è‡³æ‰‹æŒ‡ç¦»å¼€å±å¹•ï¼Œè¿™ä¸ªè¿‡ç¨‹äº§ç”Ÿçš„ä¸€ç³»åˆ—äº‹ä»¶ä»»ä½•äº‹ä»¶åˆ—éƒ½æ˜¯ä»¥DOWNäº‹ä»¶å¼€å§‹ï¼ŒUPäº‹ä»¶ç»“æŸï¼Œä¸­é—´æœ‰æ— æ•°çš„MOVEäº‹ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š å³å½“ä¸€ä¸ªç‚¹å‡»äº‹ä»¶å‘ç”Ÿåï¼Œç³»ç»Ÿéœ€è¦å°†è¿™ä¸ªäº‹ä»¶ä¼ é€’ç»™ä¸€ä¸ªå…·ä½“çš„Viewå»å¤„ç†ã€‚è¿™ä¸ªäº‹ä»¶ä¼ é€’çš„è¿‡ç¨‹å°±æ˜¯åˆ†å‘è¿‡ç¨‹ã€‚ ï¼ˆ3ï¼‰å¯¹äº‹ä»¶çš„å¤„ç†åŒ…æ‹¬ä¸‰ç±»ï¼Œåˆ†åˆ«ï¼š ä¼ é€’â€”â€”dispatchTouchEvent()å‡½æ•°ï¼› æ‹¦æˆªâ€”â€”onInterceptTouchEvent()å‡½æ•° æ¶ˆè´¹â€”â€”onTouchEvent()å‡½æ•°å’Œ OnTouchListener","text":"äº‹ä»¶åˆ†å‘å¯¹è±¡ï¼ˆ1ï¼‰æ‰€æœ‰ Touch äº‹ä»¶éƒ½è¢«å°è£…æˆäº† MotionEvent å¯¹è±¡ï¼ŒåŒ…æ‹¬ Touch çš„ä½ç½®ã€æ—¶é—´ã€å†å²è®°å½•ä»¥åŠç¬¬å‡ ä¸ªæ‰‹æŒ‡(å¤šæŒ‡è§¦æ‘¸)ç­‰ã€‚ ï¼ˆ2ï¼‰äº‹ä»¶ç±»å‹åˆ†ä¸º ACTION_DOWNï¼Œ ACTION_UPï¼ŒACTION_MOVEï¼ŒACTION_POINTER_DOWNï¼ŒACTION_POINTER_UPï¼Œ ACTION_CANCELï¼Œæ¯ä¸ªäº‹ä»¶éƒ½æ˜¯ä»¥ ACTION_DOWN å¼€å§‹ ACTION_UP ç»“æŸã€‚ ä¸»è¦å‘ç”Ÿçš„Touchäº‹ä»¶æœ‰å¦‚ä¸‹å››ç§ï¼š MotionEvent.ACTION_DOWNï¼šæŒ‰ä¸‹Viewï¼ˆæ‰€æœ‰äº‹ä»¶çš„å¼€å§‹ï¼‰ MotionEvent.ACTION_MOVEï¼šæ»‘åŠ¨View MotionEvent.ACTION_CANCELï¼šéäººä¸ºåŸå› ç»“æŸæœ¬æ¬¡äº‹ä»¶ MotionEvent.ACTION_UPï¼šæŠ¬èµ·Viewï¼ˆä¸DOWNå¯¹åº”ï¼‰ äº‹ä»¶åˆ—ï¼šä»æ‰‹æŒ‡æ¥è§¦å±å¹•è‡³æ‰‹æŒ‡ç¦»å¼€å±å¹•ï¼Œè¿™ä¸ªè¿‡ç¨‹äº§ç”Ÿçš„ä¸€ç³»åˆ—äº‹ä»¶ä»»ä½•äº‹ä»¶åˆ—éƒ½æ˜¯ä»¥DOWNäº‹ä»¶å¼€å§‹ï¼ŒUPäº‹ä»¶ç»“æŸï¼Œä¸­é—´æœ‰æ— æ•°çš„MOVEäº‹ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š å³å½“ä¸€ä¸ªç‚¹å‡»äº‹ä»¶å‘ç”Ÿåï¼Œç³»ç»Ÿéœ€è¦å°†è¿™ä¸ªäº‹ä»¶ä¼ é€’ç»™ä¸€ä¸ªå…·ä½“çš„Viewå»å¤„ç†ã€‚è¿™ä¸ªäº‹ä»¶ä¼ é€’çš„è¿‡ç¨‹å°±æ˜¯åˆ†å‘è¿‡ç¨‹ã€‚ ï¼ˆ3ï¼‰å¯¹äº‹ä»¶çš„å¤„ç†åŒ…æ‹¬ä¸‰ç±»ï¼Œåˆ†åˆ«ï¼š ä¼ é€’â€”â€”dispatchTouchEvent()å‡½æ•°ï¼› æ‹¦æˆªâ€”â€”onInterceptTouchEvent()å‡½æ•° æ¶ˆè´¹â€”â€”onTouchEvent()å‡½æ•°å’Œ OnTouchListener æºç è·Ÿè¸ªè§¦æ‘¸äº‹ä»¶å‘ç”Ÿåï¼Œåœ¨Activityå†…æœ€å…ˆæ¥æ”¶åˆ°äº‹ä»¶çš„æ˜¯Activityè‡ªèº«çš„dispatchTouchEvenæ¥ç€Windowä¼ é€’ç»™æœ€é¡¶ç«¯çš„Viewï¼Œä¹Ÿå°±æ˜¯DecorViewã€‚æ¥ä¸‹æ¥æ‰æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„è§¦æ‘¸äº‹ä»¶æµç¨‹ï¼šé¦–å…ˆæ˜¯æœ€é¡¶ç«¯çš„ViewGroup(è¿™è¾¹ä¾¿æ˜¯DecorView)çš„dispatchTouchEventæ¥æ”¶åˆ°äº‹ä»¶ã€‚å¹¶é€šè¿‡onInterceptTouchEventåˆ¤æ–­æ˜¯å¦éœ€è¦æ‹¦æˆªã€‚å¦‚æœæ‹¦æˆªåˆ™åˆ†é…åˆ°ViewGroupè‡ªèº«çš„onTouchEventï¼Œå¦‚æœä¸æ‹¦æˆªåˆ™æŸ¥æ‰¾ä½äºç‚¹å‡»åŒºåŸŸçš„å­View(å½“äº‹ä»¶æ˜¯ACTION_DOWNçš„æ—¶å€™ï¼Œä¼šåšä¸€æ¬¡æŸ¥æ‰¾å¹¶æ ¹æ®æŸ¥æ‰¾åˆ°çš„å­Viewè®¾å®šä¸€ä¸ªTouchTargetï¼Œæœ‰äº†TouchTargetä»¥åï¼Œåç»­çš„å¯¹åº”idçš„äº‹ä»¶å¦‚æœä¸è¢«æ‹¦æˆªéƒ½ä¼šåˆ†å‘ç»™è¿™ä¸€ä¸ªTouchTarget)ã€‚æŸ¥æ‰¾åˆ°å­Viewä»¥ååˆ™è°ƒç”¨dispatchTransformedTouchEventæŠŠMotionEventçš„åæ ‡è½¬æ¢åˆ°å­Viewçš„åæ ‡ç©ºé—´ï¼Œè¿™ä¸ä»…ä»…æ˜¯xï¼Œyçš„åç§»ï¼Œè¿˜åŒ…æ‹¬æ ¹æ®å­Viewè‡ªèº«çŸ©é˜µçš„é€†çŸ©é˜µå¯¹åæ ‡è¿›è¡Œå˜æ¢(è¿™å°±æ˜¯ä½¿ç”¨setTranslationX,setScaleXç­‰æ–¹æ³•è°ƒç”¨åï¼Œå­Viewçš„ç‚¹å‡»åŒºåŸŸè¿˜èƒ½ä¿æŒå’Œè‡ªèº«ç»˜åˆ¶å†…å®¹ä¸€è‡´çš„åŸå› ã€‚ä½¿ç”¨Animationåšå˜æ¢ç‚¹å‡»åŒºåŸŸä¸åŒæ­¥æ˜¯å› ä¸ºAnimationä½¿ç”¨çš„æ˜¯Canvasçš„çŸ©é˜µè€Œä¸æ˜¯Viewè‡ªèº«çš„çŸ©é˜µæ¥åšå˜æ¢)ã€‚ äº‹ä»¶åˆ†å‘çš„æºå¤´è§¦æ‘¸äº‹ä»¶å‘ç”Ÿåï¼Œåœ¨Activityå†…æœ€å…ˆæ¥æ”¶åˆ°äº‹ä»¶çš„æ˜¯Activityè‡ªèº«çš„dispatchTouchEvent()ï¼Œç„¶åActivityä¼ é€’ç»™Activityçš„Windowï¼š 123456789public boolean dispatchTouchEvent(MotionEvent ev) &#123; if (ev.getAction() == MotionEvent.ACTION_DOWN) &#123; onUserInteraction(); &#125; if (getWindow().superDispatchTouchEvent(ev)) &#123; return true; &#125; return onTouchEvent(ev);&#125; å…¶ä¸­çš„è¿™ä¸ªgetWindow()å¾—åˆ°çš„å°±æ˜¯Activityçš„mWindowå¯¹è±¡ï¼Œå®ƒæ˜¯åœ¨attach()æ–¹æ³•ä¸­åˆå§‹åŒ–çš„ï¼š 12345678910111213141516171819202122final void attach(Context context, ActivityThread aThread, Instrumentation instr, IBinder token, int ident, Application application, Intent intent, ActivityInfo info, CharSequence title, Activity parent, String id, NonConfigurationInstances lastNonConfigurationInstances, Configuration config, IVoiceInteractor voiceInteractor) &#123; //åˆ›å»ºä¸€ä¸ªWindowå¯¹è±¡ mWindow = PolicyManager.makeNewWindow(this); mWindow.setCallback(this); mWindow.setOnWindowDismissedCallback(this); mWindow.getLayoutInflater().setPrivateFactory(this); mWindow.setWindowManager( (WindowManager)context.getSystemService(Context.WINDOW_SERVICE), mToken, mComponent.flattenToString(), (info.flags &amp; ActivityInfo.FLAG_HARDWARE_ACCELERATED) != 0); mWindowManager = mWindow.getWindowManager(); //...çœç•¥å…¶ä»–ä»£ç ...&#125; è°ƒç”¨äº†PolicyManagerçš„makeNewWindow()æ–¹æ³•åˆ›å»ºçš„Windowå¯¹è±¡ã€‚æˆ‘ä»¬è·Ÿè¿›å»PolicyManagerè¿™ä¸ªç±»ï¼ˆè¿™ä¸ªç±»åœ¨Android 6.0ä¹‹åæºç ä¸­åˆ é™¤äº†ï¼Œä¸‹é¢æ˜¯æˆ‘æ‰¾çš„5.1çš„æºç ï¼‰ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243public final class PolicyManager &#123; private static final String POLICY_IMPL_CLASS_NAME = \"com.android.internal.policy.impl.Policy\"; private static final IPolicy sPolicy; static &#123; // Pull in the actual implementation of the policy at run-time try &#123; Class policyClass = Class.forName(POLICY_IMPL_CLASS_NAME); sPolicy = (IPolicy)policyClass.newInstance(); &#125; catch (ClassNotFoundException ex) &#123; throw new RuntimeException( POLICY_IMPL_CLASS_NAME + \" could not be loaded\", ex); &#125; catch (InstantiationException ex) &#123; throw new RuntimeException( POLICY_IMPL_CLASS_NAME + \" could not be instantiated\", ex); &#125; catch (IllegalAccessException ex) &#123; throw new RuntimeException( POLICY_IMPL_CLASS_NAME + \" could not be instantiated\", ex); &#125; &#125; // Cannot instantiate this class private PolicyManager() &#123;&#125; // The static methods to spawn new policy-specific objects public static Window makeNewWindow(Context context) &#123; return sPolicy.makeNewWindow(context); &#125; public static LayoutInflater makeNewLayoutInflater(Context context) &#123; return sPolicy.makeNewLayoutInflater(context); &#125; public static WindowManagerPolicy makeNewWindowManager() &#123; return sPolicy.makeNewWindowManager(); &#125; public static FallbackEventHandler makeNewFallbackEventHandler(Context context) &#123; return sPolicy.makeNewFallbackEventHandler(context); &#125;&#125; å¯ä»¥çœ‹åˆ°å®é™…ä¸Šè°ƒç”¨äº†Policyç±»çš„makeNewWindow()æ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041public class Policy implements IPolicy &#123; private static final String TAG = \"PhonePolicy\"; private static final String[] preload_classes = &#123; \"com.android.internal.policy.impl.PhoneLayoutInflater\", \"com.android.internal.policy.impl.PhoneWindow\", \"com.android.internal.policy.impl.PhoneWindow$1\", \"com.android.internal.policy.impl.PhoneWindow$DialogMenuCallback\", \"com.android.internal.policy.impl.PhoneWindow$DecorView\", \"com.android.internal.policy.impl.PhoneWindow$PanelFeatureState\", \"com.android.internal.policy.impl.PhoneWindow$PanelFeatureState$SavedState\", &#125;; static &#123; // For performance reasons, preload some policy specific classes when // the policy gets loaded. for (String s : preload_classes) &#123; try &#123; Class.forName(s); &#125; catch (ClassNotFoundException ex) &#123; Log.e(TAG, \"Could not preload class for phone policy: \" + s); &#125; &#125; &#125; public Window makeNewWindow(Context context) &#123; return new PhoneWindow(context); &#125; public LayoutInflater makeNewLayoutInflater(Context context) &#123; return new PhoneLayoutInflater(context); &#125; public WindowManagerPolicy makeNewWindowManager() &#123; return new PhoneWindowManager(); &#125; public FallbackEventHandler makeNewFallbackEventHandler(Context context) &#123; return new PhoneFallbackEventHandler(context); &#125;&#125; åŸæ¥æ˜¯ä¸€ä¸ªPhoneWindowå¯¹è±¡ï¼Œæˆ‘ä»¬èµ¶ç´§çœ‹çœ‹å®ƒçš„superDispatchTouchEventæ–¹æ³•ï¼ŒåŸæ¥æ˜¯ç»§ç»­è°ƒç”¨äº†DecorViewçš„superDispatchTouchEvent()æ–¹æ³•ï¼š 12345678// This is the top-level view of the window, containing the window decor.private DecorView mDecor;@Overridepublic boolean superDispatchTouchEvent(MotionEvent event) &#123; return mDecor.superDispatchTouchEvent(event);&#125; è¿™ä¸ªDecorViewæ˜¯PhoneWindowçš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®ƒç»§æ‰¿äº†FrameLayoutï¼š 12345678private final class DecorView extends FrameLayout implements RootViewSurfaceTaker &#123; public boolean superDispatchTouchEvent(MotionEvent event) &#123; return super.dispatchTouchEvent(event); &#125; //...çœç•¥å…¶ä»–ä»£ç ... &#125; è€ŒFrameLayoutæœ¬èº«æ²¡æœ‰å®ç°dispatchTouchEvent()è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒç»§æ‰¿äº†ViewGroupï¼š 1public class FrameLayout extends ViewGroup &#123;...&#125; ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ViewGroupçš„dispatchTouchEvent()æ–¹æ³•æºç ã€‚ ViewGroupå¼€å§‹åˆ†å‘123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179public boolean dispatchTouchEvent(MotionEvent ev) &#123; ... boolean handled = false; if (onFilterTouchEventForSecurity(ev)) &#123; final int action = ev.getAction(); final int actionMasked = action &amp; MotionEvent.ACTION_MASK; if (actionMasked == MotionEvent.ACTION_DOWN) &#123; // è§¦æ‘¸äº‹ä»¶æµå¼€å§‹ï¼Œé‡ç½®è§¦æ‘¸ç›¸å…³çš„çŠ¶æ€ cancelAndClearTouchTargets(ev); resetTouchState(); &#125; // å…³é”®ç‚¹1ï¼š æ£€æµ‹å½“å‰æ˜¯å¦éœ€è¦æ‹¦æˆªäº‹ä»¶ final boolean intercepted; if (actionMasked == MotionEvent.ACTION_DOWN || mFirstTouchTarget != null) &#123; // å¤„ç†è°ƒç”¨requestDisallowInterceptTouchEvent()æ¥å†³å®šæ˜¯å¦å…è®¸ViewGroupæ‹¦æˆªäº‹ä»¶ final boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0; if (!disallowIntercept) &#123; intercepted = onInterceptTouchEvent(ev); ev.setAction(action); &#125; else &#123; intercepted = false; &#125; &#125; else &#123; // å½“å‰æ²¡æœ‰TouchTargetä¹Ÿä¸æ˜¯äº‹ä»¶æµçš„èµ·å§‹çš„è¯ï¼Œåˆ™ç›´æ¥é»˜è®¤æ‹¦æˆªï¼Œä¸é€šè¿‡onInterceptTouchEventåˆ¤æ–­ã€‚ intercepted = true; &#125; final boolean canceled = resetCancelNextUpFlag(this) || actionMasked == MotionEvent.ACTION_CANCEL; // æ£€æµ‹æ˜¯å¦éœ€è¦æŠŠå¤šç‚¹è§¦æ‘¸äº‹ä»¶åˆ†é…ç»™ä¸åŒçš„å­View final boolean split = (mGroupFlags &amp; FLAG_SPLIT_MOTION_EVENTS) != 0; // å½“å‰äº‹ä»¶æµå¯¹åº”çš„TouchTargetå¯¹è±¡ TouchTarget newTouchTarget = null; boolean alreadyDispatchedToNewTouchTarget = false; if (!canceled &amp;&amp; !intercepted) &#123; View childWithAccessibilityFocus = ev.isTargetAccessibilityFocus() ? findChildWithAccessibilityFocus() : null; if (actionMasked == MotionEvent.ACTION_DOWN || (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_DOWN) || actionMasked == MotionEvent.ACTION_HOVER_MOVE) &#123; final int actionIndex = ev.getActionIndex(); // always 0 for down final int idBitsToAssign = split ? 1 &lt;&lt; ev.getPointerId(actionIndex) : TouchTarget.ALL_POINTER_IDS; // å½“å‰äº‹ä»¶æ˜¯äº‹ä»¶æµçš„åˆå§‹äº‹ä»¶(åŒ…æ‹¬å¤šç‚¹è§¦æ‘¸æ—¶ç¬¬äºŒã€ç¬¬ä¸‰ç‚¹ç¯çš„DOWNäº‹ä»¶)ï¼Œæ¸…é™¤ä¹‹å‰ç›¸åº”çš„TouchTargetçš„çŠ¶æ€ removePointersFromTouchTargets(idBitsToAssign); final int childrenCount = mChildrenCount; if (newTouchTarget == null &amp;&amp; childrenCount != 0) &#123; final float x = ev.getX(actionIndex); final float y = ev.getY(actionIndex); final ArrayList&lt;View&gt; preorderedList = buildTouchDispatchChildList(); final boolean customOrder = preorderedList == null &amp;&amp; isChildrenDrawingOrderEnabled(); final View[] children = mChildren; //é€šè¿‡forå¾ªç¯ï¼Œéå†äº†å½“å‰ViewGroupä¸‹çš„æ‰€æœ‰å­View for (int i = childrenCount - 1; i &gt;= 0; i--) &#123; final int childIndex = getAndVerifyPreorderedIndex( childrenCount, i, customOrder); final View child = getAndVerifyPreorderedView( preorderedList, children, childIndex); // å…³é”®ç‚¹2ï¼š åˆ¤æ–­å½“å‰éå†åˆ°çš„å­Viewèƒ½å¦æ¥å—äº‹ä»¶ï¼Œå¦‚æœä¸èƒ½åˆ™ç›´æ¥continueè¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯ if (!canViewReceivePointerEvents(child) || !isTransformedTouchPointInView(x, y, child, null)) &#123; ev.setTargetAccessibilityFocus(false); continue; &#125; // å½“å‰å­Viewèƒ½æ¥æ”¶äº‹ä»¶ï¼Œä¸ºå­Viewåˆ›å»ºTouchTarget newTouchTarget = getTouchTarget(child); if (newTouchTarget != null) &#123; newTouchTarget.pointerIdBits |= idBitsToAssign; break; &#125; resetCancelNextUpFlag(child); // è°ƒç”¨dispatchTransformedTouchEventæŠŠäº‹ä»¶åˆ†é…ç»™å­View if (dispatchTransformedTouchEvent(ev, false, child, idBitsToAssign)) &#123; mLastTouchDownTime = ev.getDownTime(); if (preorderedList != null) &#123; for (int j = 0; j &lt; childrenCount; j++) &#123; if (children[childIndex] == mChildren[j]) &#123; mLastTouchDownIndex = j; break; &#125; &#125; &#125; else &#123; mLastTouchDownIndex = childIndex; &#125; mLastTouchDownX = ev.getX(); mLastTouchDownY = ev.getY(); // æŠŠTouchTargetæ·»åŠ åˆ°TouchTargetåˆ—è¡¨çš„ç¬¬ä¸€ä½ newTouchTarget = addTouchTarget(child, idBitsToAssign); alreadyDispatchedToNewTouchTarget = true; break; &#125; ev.setTargetAccessibilityFocus(false); &#125; if (preorderedList != null) preorderedList.clear(); &#125; if (newTouchTarget == null &amp;&amp; mFirstTouchTarget != null) &#123; newTouchTarget = mFirstTouchTarget; while (newTouchTarget.next != null) &#123; newTouchTarget = newTouchTarget.next; &#125; newTouchTarget.pointerIdBits |= idBitsToAssign; &#125; &#125; &#125; if (mFirstTouchTarget == null) &#123; // ç›®å‰æ²¡æœ‰ä»»ä½•TouchTargetï¼Œæ‰€ä»¥ç›´æ¥ä¼ nullç»™dispatchTransformedTouchEvent handled = dispatchTransformedTouchEvent(ev, canceled, null, TouchTarget.ALL_POINTER_IDS); &#125; else &#123; // æŠŠäº‹ä»¶æ ¹æ®pointer idåˆ†å‘ç»™TouchTargetåˆ—è¡¨å†…çš„æ‰€æœ‰TouchTargetï¼Œç”¨æ¥å¤„ç†å¤šç‚¹è§¦æ‘¸çš„æƒ…å†µ TouchTarget predecessor = null; TouchTarget target = mFirstTouchTarget; // éå†TouchTargetåˆ—è¡¨ while (target != null) &#123; final TouchTarget next = target.next; if (alreadyDispatchedToNewTouchTarget &amp;&amp; target == newTouchTarget) &#123; handled = true; &#125; else &#123; final boolean cancelChild = resetCancelNextUpFlag(target.child) || intercepted; // æ ¹æ®TouchTargetçš„pointerIdBitsæ¥æ‰§è¡ŒdispatchTransformedTouchEvent if (dispatchTransformedTouchEvent(ev, cancelChild, target.child, target.pointerIdBits)) &#123; handled = true; &#125; if (cancelChild) &#123; if (predecessor == null) &#123; mFirstTouchTarget = next; &#125; else &#123; predecessor.next = next; &#125; target.recycle(); target = next; continue; &#125; &#125; predecessor = target; target = next; &#125; &#125; // å¤„ç†CANCELå’ŒUPäº‹ä»¶çš„æƒ…å†µ if (canceled || actionMasked == MotionEvent.ACTION_UP || actionMasked == MotionEvent.ACTION_HOVER_MOVE) &#123; resetTouchState(); &#125; else if (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_UP) &#123; final int actionIndex = ev.getActionIndex(); final int idBitsToRemove = 1 &lt;&lt; ev.getPointerId(actionIndex); removePointersFromTouchTargets(idBitsToRemove); &#125; &#125; if (!handled &amp;&amp; mInputEventConsistencyVerifier != null) &#123; mInputEventConsistencyVerifier.onUnhandledEvent(ev, 1); &#125; return handled;&#125; ä¸Šé¢çš„ä»£ç æ¯”è¾ƒé•¿ï¼Œå…ˆä¸ç”¨ç»†çœ‹ã€‚ä¸‹é¢ä¸€å¼ å›¾æ¥ç®€åŒ–å¯¹ç…§ç€ç†è§£ä¸€ä¸‹ï¼š å…³é”®ç‚¹1ï¼šåªæœ‰ACTION_DOWNäº‹ä»¶æˆ–è€…mFirstTouchTargetä¸ºç©ºæ—¶ï¼Œå¹¶ä¸”æ²¡æœ‰è°ƒç”¨è¿‡requestDisallowInterceptTouchEvent()å»é˜»æ­¢è¯¥ViewGroupæ‹¦æˆªäº‹ä»¶çš„è¯ï¼Œæ‰å¯èƒ½æ‰§è¡Œæ‹¦æˆªæ–¹æ³•onInterceptTouchEvent() å…³é”®ç‚¹2ï¼šåˆ¤æ–­å½“å‰éå†åˆ°çš„å­Viewèƒ½å¦æ¥å—äº‹ä»¶ä¸»è¦ç”±ä¸¤ç‚¹æ¥è¡¡é‡ï¼šå­å…ƒç´ æ˜¯å¦åœ¨æ’­åŠ¨ç”»ï¼ˆcanViewReceivePointerEventsï¼ˆï¼‰æ–¹æ³•ï¼‰ï¼›ç‚¹å‡»äº‹ä»¶åæ ‡æ˜¯å¦è½åœ¨å­å…ƒç´ åŒºåŸŸå†…ï¼ˆï¼‰ã€‚ 12345//å­å…ƒç´ æ˜¯å¦åœ¨æ’­åŠ¨ç”»private static boolean canViewReceivePointerEvents(View child) &#123; return (child.mViewFlags &amp; VISIBILITY_MASK) == VISIBLE || child.getAnimation() != null;&#125; 123456789101112131415161718192021//ç‚¹å‡»äº‹ä»¶åæ ‡æ˜¯å¦è½åœ¨å­å…ƒç´ åŒºåŸŸå†…protected boolean isTransformedTouchPointInView(float x, float y, View child, PointF outLocalPoint) &#123; float localX = x + mScrollX - child.mLeft; float localY = y + mScrollY - child.mTop; if (! child.hasIdentityMatrix() &amp;&amp; mAttachInfo != null) &#123; final float[] localXY = mAttachInfo.mTmpTransformLocation; localXY[0] = localX; localXY[1] = localY; child.getInverseMatrix().mapPoints(localXY); localX = localXY[0]; localY = localXY[1]; &#125; //æ£€æµ‹åæ ‡æ˜¯å¦åœ¨childåŒºåŸŸå†… final boolean isInView = child.pointInView(localX, localY); if (isInView &amp;&amp; outLocalPoint != null) &#123; outLocalPoint.set(localX, localY); &#125; return isInView;&#125; å½“å­Viewæ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ä¹‹åï¼ŒViewGroupå°±ä¼šè°ƒç”¨dispatchTransformedMotionEvent()æ–¹æ³•å»äº¤ç»™å­å…ƒç´ å¤„ç†ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970private boolean dispatchTransformedTouchEvent(MotionEvent event, boolean cancel, View child, int desiredPointerIdBits) &#123; final boolean handled; final int oldAction = event.getAction(); // å¤„ç†CANCELçš„æƒ…å†µï¼Œç›´æ¥æŠŠMotionEventçš„åŸå§‹æ•°æ®åˆ†å‘ç»™å­Viewæˆ–è€…è‡ªèº«çš„onTouchEvent // (è¿™è¾¹è°ƒç”¨View.dispatchTouchEventï¼Œè€ŒView.dispatchTouchEventä¼šå†è°ƒç”¨onTouchEventæ–¹æ³•ï¼ŒæŠŠMotionEventä¼ å…¥) if (cancel || oldAction == MotionEvent.ACTION_CANCEL) &#123; event.setAction(MotionEvent.ACTION_CANCEL); if (child == null) &#123; handled = super.dispatchTouchEvent(event); &#125; else &#123; handled = child.dispatchTouchEvent(event); &#125; event.setAction(oldAction); return handled; &#125; // å¯¹MotionEventè‡ªèº«çš„pointer idå’Œå½“å‰æˆ‘ä»¬éœ€è¦å¤„ç†çš„pointer idåšæŒ‰ä½ä¸ï¼Œå¾—åˆ°å…±æœ‰çš„pointer id final int oldPointerIdBits = event.getPointerIdBits(); final int newPointerIdBits = oldPointerIdBits &amp; desiredPointerIdBits; // æ²¡æœ‰pointer idéœ€è¦å¤„ç†ï¼Œç›´æ¥è¿”å› if (newPointerIdBits == 0) &#123; return false; &#125; final MotionEvent transformedEvent; if (newPointerIdBits == oldPointerIdBits) &#123; if (child == null || child.hasIdentityMatrix()) &#123; if (child == null) &#123; // å…³é”®ç‚¹1ï¼š å­Viewä¸ºç©ºï¼Œç›´æ¥äº¤è¿˜ç»™è‡ªèº«çš„onTouchEventå¤„ç† handled = super.dispatchTouchEvent(event); &#125; else &#123; final float offsetX = mScrollX - child.mLeft; final float offsetY = mScrollY - child.mTop; event.offsetLocation(offsetX, offsetY); // å…³é”®ç‚¹2ï¼šäº¤ç»™å­viewçš„dispatchTouchEvent()æ–¹æ³•å»å¤„ç† handled = child.dispatchTouchEvent(event); event.offsetLocation(-offsetX, -offsetY); &#125; return handled; &#125; transformedEvent = MotionEvent.obtain(event); &#125; else &#123; // MotionEventè‡ªèº«çš„pointer idå’Œå½“å‰éœ€è¦å¤„ç†çš„pointer idä¸åŒï¼ŒæŠŠä¸éœ€è¦å¤„ç†çš„pointer idç›¸å…³çš„ä¿¡æ¯å‰”é™¤æ‰ã€‚ transformedEvent = event.split(newPointerIdBits); &#125; if (child == null) &#123; // å­Viewä¸ºç©ºï¼Œç›´æ¥äº¤è¿˜ç»™è‡ªèº«çš„onTouchEventå¤„ç† handled = super.dispatchTouchEvent(transformedEvent); &#125; else &#123; // æ ¹æ®å½“å‰çš„scrollXã€scrollYå’Œå­Viewçš„leftã€topå¯¹MotionEventçš„è§¦æ‘¸åæ ‡xã€yè¿›è¡Œåç§» final float offsetX = mScrollX - child.mLeft; final float offsetY = mScrollY - child.mTop; transformedEvent.offsetLocation(offsetX, offsetY); if (! child.hasIdentityMatrix()) &#123; // è·å–å­Viewè‡ªèº«çŸ©é˜µçš„é€†çŸ©é˜µï¼Œå¹¶å¯¹MotionEventçš„åæ ‡ç›¸å…³ä¿¡æ¯è¿›è¡ŒçŸ©é˜µå˜æ¢ transformedEvent.transform(child.getInverseMatrix()); &#125; // æŠŠç»è¿‡åç§»ä»¥åŠçŸ©é˜µå˜æ¢çš„äº‹ä»¶ä¼ é€’ç»™å­Viewå¤„ç† handled = child.dispatchTouchEvent(transformedEvent); &#125; transformedEvent.recycle(); return handled;&#125; å­Viewæ¶ˆè´¹äº‹ä»¶ç„¶åæˆ‘ä»¬çœ‹çœ‹Viewçš„dispatchTouchEvent()æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243public boolean dispatchTouchEvent(MotionEvent event) &#123; boolean result = false; if (mInputEventConsistencyVerifier != null) &#123; mInputEventConsistencyVerifier.onTouchEvent(event, 0); &#125; final int actionMasked = event.getActionMasked(); if (actionMasked == MotionEvent.ACTION_DOWN) &#123; // Defensive cleanup for new gesture stopNestedScroll(); &#125; if (onFilterTouchEventForSecurity(event)) &#123; // å¦‚æœå­˜åœ¨mOnTouchListenerï¼Œç›´æ¥äº¤ç»™å®ƒæ¶ˆè´¹Touchäº‹ä»¶ ListenerInfo li = mListenerInfo; if (li != null &amp;&amp; li.mOnTouchListener != null &amp;&amp; (mViewFlags &amp; ENABLED_MASK) == ENABLED &amp;&amp; li.mOnTouchListener.onTouch(this, event)) &#123; result = true; &#125; // äº¤ç»™onTouchEvent()æ–¹æ³•æ¶ˆè´¹Touchäº‹ä»¶ if (!result &amp;&amp; onTouchEvent(event)) &#123; result = true; &#125; &#125; if (!result &amp;&amp; mInputEventConsistencyVerifier != null) &#123; mInputEventConsistencyVerifier.onUnhandledEvent(event, 0); &#125; // Clean up after nested scrolls if this is the end of a gesture; // also cancel it if we tried an ACTION_DOWN but we didn't want the rest // of the gesture. if (actionMasked == MotionEvent.ACTION_UP || actionMasked == MotionEvent.ACTION_CANCEL || (actionMasked == MotionEvent.ACTION_DOWN &amp;&amp; !result)) &#123; stopNestedScroll(); &#125; return result;&#125; æ³¨æ„è¿™é‡ŒViewçš„mOnTouchListener.onTouch(this, event)å’ŒonTouchEvent(event)éƒ½æ˜¯æ”¾åœ¨ifåˆ¤æ–­æ¡ä»¶é‡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–ä»¬çš„è¿”å›å€¼ä¼šå½±å“äº‹ä»¶æ˜¯å¦ç»§ç»­å¾€ä¸‹ä¼ é€’ã€‚å¦‚æœmOnTouchListener.onTouch(this, event)è¿”å›trueçš„è¯ï¼Œå°±ä¸ä¼šå†æ‰§è¡Œæ­¤å­Viewçš„onTouchEvent(event)æ–¹æ³•äº†ã€‚ æœ€åæˆ‘ä»¬å†çœ‹ä¸‹Viewçš„onTouchEvent()æ–¹æ³•æ˜¯å¦‚ä½•æ¶ˆè´¹äº‹ä»¶çš„å‘¢ï¼Ÿ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132public boolean onTouchEvent(MotionEvent event) &#123; final float x = event.getX(); final float y = event.getY(); final int viewFlags = mViewFlags; if ((viewFlags &amp; ENABLED_MASK) == DISABLED) &#123; if (event.getAction() == MotionEvent.ACTION_UP &amp;&amp; (mPrivateFlags &amp; PFLAG_PRESSED) != 0) &#123; setPressed(false); &#125; // A disabled view that is clickable still consumes the touch // events, it just doesn't respond to them. return (((viewFlags &amp; CLICKABLE) == CLICKABLE || (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE)); &#125; if (mTouchDelegate != null) &#123; if (mTouchDelegate.onTouchEvent(event)) &#123; return true; &#125; &#125; if (((viewFlags &amp; CLICKABLE) == CLICKABLE || (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE)) &#123; switch (event.getAction()) &#123; case MotionEvent.ACTION_UP: boolean prepressed = (mPrivateFlags &amp; PFLAG_PREPRESSED) != 0; if ((mPrivateFlags &amp; PFLAG_PRESSED) != 0 || prepressed) &#123; // take focus if we don't have it already and we should in // touch mode. boolean focusTaken = false; if (isFocusable() &amp;&amp; isFocusableInTouchMode() &amp;&amp; !isFocused()) &#123; focusTaken = requestFocus(); &#125; if (prepressed) &#123; // The button is being released before we actually // showed it as pressed. Make it show the pressed // state now (before scheduling the click) to ensure // the user sees it. setPressed(true, x, y); &#125; if (!mHasPerformedLongPress) &#123; // This is a tap, so remove the longpress check removeLongPressCallback(); // Only perform take click actions if we were in the pressed state if (!focusTaken) &#123; // Use a Runnable and post this rather than calling // performClick directly. This lets other visual state // of the view update before click actions start. if (mPerformClick == null) &#123; mPerformClick = new PerformClick(); &#125; if (!post(mPerformClick)) &#123; //å…³é”®ç‚¹ performClick(); &#125; &#125; &#125; if (mUnsetPressedState == null) &#123; mUnsetPressedState = new UnsetPressedState(); &#125; if (prepressed) &#123; postDelayed(mUnsetPressedState, ViewConfiguration.getPressedStateDuration()); &#125; else if (!post(mUnsetPressedState)) &#123; // If the post failed, unpress right now mUnsetPressedState.run(); &#125; removeTapCallback(); &#125; break; case MotionEvent.ACTION_DOWN: mHasPerformedLongPress = false; if (performButtonActionOnTouchDown(event)) &#123; break; &#125; // Walk up the hierarchy to determine if we're inside a scrolling container. boolean isInScrollingContainer = isInScrollingContainer(); // For views inside a scrolling container, delay the pressed feedback for // a short period in case this is a scroll. if (isInScrollingContainer) &#123; mPrivateFlags |= PFLAG_PREPRESSED; if (mPendingCheckForTap == null) &#123; mPendingCheckForTap = new CheckForTap(); &#125; mPendingCheckForTap.x = event.getX(); mPendingCheckForTap.y = event.getY(); postDelayed(mPendingCheckForTap, ViewConfiguration.getTapTimeout()); &#125; else &#123; // Not inside a scrolling container, so show the feedback right away setPressed(true, x, y); checkForLongClick(0); &#125; break; case MotionEvent.ACTION_CANCEL: setPressed(false); removeTapCallback(); removeLongPressCallback(); break; case MotionEvent.ACTION_MOVE: drawableHotspotChanged(x, y); // Be lenient about moving outside of buttons if (!pointInView(x, y, mTouchSlop)) &#123; // Outside button removeTapCallback(); if ((mPrivateFlags &amp; PFLAG_PRESSED) != 0) &#123; // Remove any future long press/tap checks removeLongPressCallback(); setPressed(false); &#125; &#125; break; &#125; return true; &#125; return false;&#125; æˆ‘ä»¬è¿™é‡Œåªæ³¨æ„ä¸€ä¸‹åœ¨è¿™ä¸ªViewæ¥æ”¶åˆ°ACTION_UPäº‹ä»¶ä¹‹åï¼Œä¼šè°ƒç”¨åˆ°performClick()æ–¹æ³•ï¼š 123456789101112131415public boolean performClick() &#123; final boolean result; final ListenerInfo li = mListenerInfo; if (li != null &amp;&amp; li.mOnClickListener != null) &#123; playSoundEffect(SoundEffectConstants.CLICK); //é€šçŸ¥å›è°ƒmOnClickListenerçš„onClickæ–¹æ³• li.mOnClickListener.onClick(this); result = true; &#125; else &#123; result = false; &#125; sendAccessibilityEvent(AccessibilityEvent.TYPE_VIEW_CLICKED); return result;&#125; è¿™é‡Œèƒ½è¯´æ˜Viewçš„OnClickListenerçš„onClick()äº‹ä»¶çš„æ‰§è¡Œæ—¶æœºæ˜¯åœ¨æ•´ä¸ªTouchEventäº‹ä»¶åˆ—çš„æœ€åæ‰ä¼šæ‰§è¡Œã€‚ Touchæ¡ˆä¾‹åˆ†æ é—®é¢˜ï¼šå½“ViewGroupçš„onInterceptTouchEvent()å‡½æ•°åˆ†åˆ«è¿”å›trueå’Œfalseæ—¶ï¼Œè¿™ä¸ªViewGroupå’ŒView1åˆ†åˆ«èƒ½æ¥æ”¶åˆ°DOWNã€MOVEã€UPä¸­çš„ä»€ä¹ˆäº‹ä»¶ï¼Ÿ ViewGroupçš„onInterceptTouchEvent()æ–¹æ³• ViewGroup View1 return true ä»…èƒ½æ¥æ”¶åˆ°DOWNäº‹ä»¶ ä»€ä¹ˆéƒ½æ¥æ”¶ä¸åˆ° return false ä¸‰ç§éƒ½èƒ½æ¥æ”¶åˆ° ä¸‰ç§éƒ½èƒ½æ¥æ”¶åˆ° å¦ä¸€ä¸ªæ¡ˆä¾‹å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šAndroid ç¼–ç¨‹ä¸‹ Touch äº‹ä»¶çš„åˆ†å‘å’Œæ¶ˆè´¹æœºåˆ¶ æ€»ç»“ ï¼ˆ1ï¼‰Touchäº‹ä»¶åˆ†å‘ä¸­åªæœ‰ä¸¤ä¸ªä¸»è§’:ViewGroupå’ŒViewã€‚ViewGroupåŒ…å«onInterceptTouchEventã€dispatchTouchEventã€onTouchEventä¸‰ä¸ªç›¸å…³äº‹ä»¶ã€‚ViewåŒ…å«dispatchTouchEventã€onTouchEventä¸¤ä¸ªç›¸å…³äº‹ä»¶ã€‚å…¶ä¸­ViewGroupåˆç»§æ‰¿äºViewã€‚ ï¼ˆ2ï¼‰äº‹ä»¶ä» Activity.dispatchTouchEvent()å¼€å§‹ä¼ é€’ï¼Œåªè¦æ²¡æœ‰è¢«åœæ­¢æˆ–æ‹¦æˆªï¼Œä»æœ€ä¸Šå±‚çš„ ViewGroupå¼€å§‹ä¸€ç›´å¾€ä¸‹(å­View)ä¼ é€’ã€‚å­Viewå¯ä»¥é€šè¿‡ onTouchEvent()å¯¹äº‹ä»¶è¿›è¡Œå¤„ç†ã€‚ ï¼ˆ3ï¼‰äº‹ä»¶ç”±ViewGroupä¼ é€’ç»™å­ Viewï¼ŒViewGroup å¯ä»¥é€šè¿‡ onInterceptTouchEvent()å¯¹äº‹ä»¶åšæ‹¦æˆªï¼Œåœæ­¢å…¶å¾€ä¸‹ä¼ é€’ã€‚ ï¼ˆ4ï¼‰å¦‚æœäº‹ä»¶ä»ä¸Šå¾€ä¸‹ä¼ é€’è¿‡ç¨‹ä¸­ä¸€ç›´æ²¡æœ‰è¢«åœæ­¢ï¼Œä¸”æœ€åº•å±‚å­ View æ²¡æœ‰æ¶ˆè´¹äº‹ä»¶ï¼Œäº‹ä»¶ä¼šåå‘å¾€ä¸Šä¼ é€’ï¼Œè¿™æ—¶çˆ¶ View(ViewGroup)å¯ä»¥è¿›è¡Œæ¶ˆè´¹ï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰è¢«æ¶ˆè´¹çš„è¯ï¼Œæœ€åä¼šåˆ° Activity çš„ onTouchEvent()å‡½æ•°ã€‚ ï¼ˆ5ï¼‰ å¦‚æœ View æ²¡æœ‰å¯¹ ACTION_DOWN è¿›è¡Œæ¶ˆè´¹ï¼Œä¹‹åçš„å…¶ä»–äº‹ä»¶ä¸ä¼šä¼ é€’è¿‡æ¥ã€‚ ï¼ˆ6ï¼‰OnTouchListener ä¼˜å…ˆäº onTouchEvent()å¯¹äº‹ä»¶è¿›è¡Œæ¶ˆè´¹ã€‚ ï¼ˆ7ï¼‰å½“Acitivtyæ¥æ”¶åˆ°Touchäº‹ä»¶æ—¶ï¼Œå°†éå†å­Viewè¿›è¡ŒDownäº‹ä»¶çš„åˆ†å‘ã€‚ViewGroupçš„éå†å¯ä»¥çœ‹æˆæ˜¯é€’å½’çš„ã€‚åˆ†å‘çš„ç›®çš„æ˜¯ä¸ºäº†æ‰¾åˆ°ç¬¬ä¸€ä¸ªçœŸæ­£è¦å¤„ç†æœ¬æ¬¡å®Œæ•´è§¦æ‘¸äº‹ä»¶çš„Viewï¼Œè¿™ä¸ªViewä¼šåœ¨onTouchuEventç»“æœè¿”å›trueã€‚ ï¼ˆ8ï¼‰å½“æŸä¸ªå­Viewè¿”å›trueæ—¶ï¼Œä¼šä¸­æ­¢Downäº‹ä»¶çš„åˆ†å‘ï¼ŒåŒæ—¶åœ¨ViewGroupä¸­è®°å½•è¯¥å­Viewã€‚æ¥ä¸‹å»çš„Moveå’ŒUpäº‹ä»¶å°†ç”±è¯¥å­Viewç›´æ¥è¿›è¡Œå¤„ç†ã€‚ç”±äºå­Viewæ˜¯ä¿å­˜åœ¨ViewGroupä¸­çš„ï¼Œå¤šå±‚ViewGroupçš„èŠ‚ç‚¹ç»“æ„æ—¶ï¼Œä¸Šçº§ViewGroupä¿å­˜çš„ä¼šæ˜¯çœŸå®å¤„ç†äº‹ä»¶çš„Viewæ‰€åœ¨çš„ViewGroupå¯¹è±¡:å¦‚ViewGroup0-ViewGroup1-TextViewçš„ç»“æ„ä¸­ï¼ŒTextViewè¿”å›äº†trueï¼Œå®ƒå°†è¢«ä¿å­˜åœ¨ViewGroup1ä¸­ï¼Œè€ŒViewGroup1ä¹Ÿä¼šè¿”å›trueï¼Œè¢«ä¿å­˜åœ¨ViewGroup0ä¸­ã€‚å½“Moveå’ŒUPäº‹ä»¶æ¥æ—¶ï¼Œä¼šå…ˆä»ViewGroup0ä¼ é€’è‡³ViewGroup1ï¼Œå†ç”±ViewGroup1ä¼ é€’è‡³TextViewã€‚ ï¼ˆ9ï¼‰å½“ViewGroupä¸­æ‰€æœ‰å­Viewéƒ½ä¸æ•è·Downäº‹ä»¶æ—¶ï¼Œå°†è§¦å‘ViewGroupè‡ªèº«çš„onTouchäº‹ä»¶ã€‚è§¦å‘çš„æ–¹å¼æ˜¯è°ƒç”¨super.dispatchTouchEventå‡½æ•°ï¼Œå³çˆ¶ç±»Viewçš„dispatchTouchEventæ–¹æ³•ã€‚åœ¨æ‰€æœ‰å­Viewéƒ½ä¸å¤„ç†çš„æƒ…å†µä¸‹ï¼Œè§¦å‘Acitivityçš„onTouchEventæ–¹æ³•ã€‚ ï¼ˆ10ï¼‰ViewGroupé»˜è®¤ä¸æ‹¦æˆªä»»ä½•äº‹ä»¶ã€‚æºç ä¸­çš„ViewGroupçš„onInterceptTouchEvent()æ–¹æ³•é»˜è®¤è¿”å›falseã€‚ ï¼ˆ11ï¼‰Viewæ²¡æœ‰onInterceptTouchEvent()æ–¹æ³•ã€‚ä¸€æ—¦ç‚¹å‡»äº‹ä»¶ä¼ é€’ç»™å®ƒï¼Œå°±ä¼šè°ƒç”¨å®ƒçš„onTouchEventæ–¹æ³• ï¼ˆ12ï¼‰æˆ‘ä»¬å¯ä»¥å‘ç°ViewGroupæ²¡æœ‰onTouchEventäº‹ä»¶ï¼Œè¯´æ˜ä»–çš„å¤„ç†é€»è¾‘å’ŒViewæ˜¯ä¸€æ ·çš„ã€‚ ï¼ˆ13ï¼‰å­viewå¦‚æœæ¶ˆè€—äº†äº‹ä»¶ï¼Œé‚£ä¹ˆViewGroupå°±ä¸ä¼šåœ¨æ¥å—åˆ°äº‹ä»¶äº†ã€‚ å‚è€ƒèµ„æ–™ Android:30åˆ†é’Ÿå¼„æ˜ç™½Touchäº‹ä»¶åˆ†å‘æœºåˆ¶ å…¬å…±æŠ€æœ¯ç‚¹ä¹‹ View äº‹ä»¶ä¼ é€’ Androidäº‹ä»¶åˆ†å‘å®Œå…¨è§£æä¹‹ä¸ºä»€ä¹ˆæ˜¯å¥¹ Android ViewGroup/View äº‹ä»¶åˆ†å‘æœºåˆ¶è¯¦è§£ Androidäº‹ä»¶åˆ†å‘æœºåˆ¶è¯¦è§£ï¼šå²ä¸Šæœ€å…¨é¢ã€æœ€æ˜“æ‡‚ Android ç¼–ç¨‹ä¸‹ Touch äº‹ä»¶çš„åˆ†å‘å’Œæ¶ˆè´¹æœºåˆ¶ ViewGroup æºç è§£æ ViewGroupæºç è§£è¯»","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Javaã€‘ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼çš„å®ç°","slug":"ã€Javaã€‘ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼çš„å®ç°","date":"2017-11-10T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/11/10/ã€Javaã€‘ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼çš„å®ç°/","link":"","permalink":"http://github.com/2017/11/10/ã€Javaã€‘ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼çš„å®ç°/","excerpt":"å‰è¨€ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜æ˜¯çº¿ç¨‹æ¨¡å‹ä¸­çš„ç»å…¸é—®é¢˜ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åœ¨åŒä¸€æ—¶é—´æ®µå†…å…±ç”¨åŒä¸€å­˜å‚¨ç©ºé—´ï¼Œç”Ÿäº§è€…å‘ç©ºé—´é‡Œç”Ÿäº§æ•°æ®ï¼Œè€Œæ¶ˆè´¹è€…å–èµ°æ•°æ®ã€‚ é˜»å¡é˜Ÿåˆ—å°±ç›¸å½“äºä¸€ä¸ªç¼“å†²åŒºï¼Œå¹³è¡¡äº†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å¤„ç†èƒ½åŠ›ã€‚è¿™ä¸ªé˜»å¡é˜Ÿåˆ—å°±æ˜¯ç”¨æ¥ç»™ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…è§£è€¦çš„ã€‚ wait/notifyæ–¹æ³•é¦–å…ˆï¼Œæˆ‘ä»¬ææ¸…æ¥šThread.sleep()æ–¹æ³•å’ŒObject.wait()ã€Object.notify()æ–¹æ³•çš„åŒºåˆ«ã€‚æ ¹æ®è¿™ç¯‡æ–‡ç« java sleepå’Œwaitçš„åŒºåˆ«çš„ç–‘æƒ‘? sleep()æ˜¯Threadç±»çš„æ–¹æ³•ï¼›è€Œwait()ï¼Œnotify()ï¼ŒnotifyAll()æ˜¯Objectç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼›å°½ç®¡è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šå½±å“çº¿ç¨‹çš„æ‰§è¡Œè¡Œä¸ºï¼Œä½†æ˜¯æœ¬è´¨ä¸Šæ˜¯æœ‰åŒºåˆ«çš„ã€‚ Thread.sleep()ä¸ä¼šå¯¼è‡´é”è¡Œä¸ºçš„æ”¹å˜ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ˜¯æ‹¥æœ‰é”çš„ï¼Œé‚£ä¹ˆThread.sleep()ä¸ä¼šè®©çº¿ç¨‹é‡Šæ”¾é”ã€‚å¦‚æœèƒ½å¤Ÿå¸®åŠ©ä½ è®°å¿†çš„è¯ï¼Œå¯ä»¥ç®€å•è®¤ä¸ºå’Œé”ç›¸å…³çš„æ–¹æ³•éƒ½å®šä¹‰åœ¨Objectç±»ä¸­ï¼Œå› æ­¤è°ƒç”¨Thread.sleep()æ˜¯ä¸ä¼šå½±å“é”çš„ç›¸å…³è¡Œä¸ºã€‚ Thread.sleepå’ŒObject.waitéƒ½ä¼šæš‚åœå½“å‰çš„çº¿ç¨‹ï¼Œå¯¹äºCPUèµ„æºæ¥è¯´ï¼Œä¸ç®¡æ˜¯å“ªç§æ–¹å¼æš‚åœçš„çº¿ç¨‹ï¼Œéƒ½è¡¨ç¤ºå®ƒæš‚æ—¶ä¸å†éœ€è¦CPUçš„æ‰§è¡Œæ—¶é—´ã€‚OSä¼šå°†æ‰§è¡Œæ—¶é—´åˆ†é…ç»™å…¶å®ƒçº¿ç¨‹ã€‚åŒºåˆ«æ˜¯è°ƒç”¨waitåï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹æ‰§è¡Œnotify/notifyAllæ‰èƒ½å¤Ÿé‡æ–°è·å¾—CPUæ‰§è¡Œæ—¶é—´ã€‚","text":"å‰è¨€ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜æ˜¯çº¿ç¨‹æ¨¡å‹ä¸­çš„ç»å…¸é—®é¢˜ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åœ¨åŒä¸€æ—¶é—´æ®µå†…å…±ç”¨åŒä¸€å­˜å‚¨ç©ºé—´ï¼Œç”Ÿäº§è€…å‘ç©ºé—´é‡Œç”Ÿäº§æ•°æ®ï¼Œè€Œæ¶ˆè´¹è€…å–èµ°æ•°æ®ã€‚ é˜»å¡é˜Ÿåˆ—å°±ç›¸å½“äºä¸€ä¸ªç¼“å†²åŒºï¼Œå¹³è¡¡äº†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å¤„ç†èƒ½åŠ›ã€‚è¿™ä¸ªé˜»å¡é˜Ÿåˆ—å°±æ˜¯ç”¨æ¥ç»™ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…è§£è€¦çš„ã€‚ wait/notifyæ–¹æ³•é¦–å…ˆï¼Œæˆ‘ä»¬ææ¸…æ¥šThread.sleep()æ–¹æ³•å’ŒObject.wait()ã€Object.notify()æ–¹æ³•çš„åŒºåˆ«ã€‚æ ¹æ®è¿™ç¯‡æ–‡ç« java sleepå’Œwaitçš„åŒºåˆ«çš„ç–‘æƒ‘? sleep()æ˜¯Threadç±»çš„æ–¹æ³•ï¼›è€Œwait()ï¼Œnotify()ï¼ŒnotifyAll()æ˜¯Objectç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼›å°½ç®¡è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šå½±å“çº¿ç¨‹çš„æ‰§è¡Œè¡Œä¸ºï¼Œä½†æ˜¯æœ¬è´¨ä¸Šæ˜¯æœ‰åŒºåˆ«çš„ã€‚ Thread.sleep()ä¸ä¼šå¯¼è‡´é”è¡Œä¸ºçš„æ”¹å˜ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ˜¯æ‹¥æœ‰é”çš„ï¼Œé‚£ä¹ˆThread.sleep()ä¸ä¼šè®©çº¿ç¨‹é‡Šæ”¾é”ã€‚å¦‚æœèƒ½å¤Ÿå¸®åŠ©ä½ è®°å¿†çš„è¯ï¼Œå¯ä»¥ç®€å•è®¤ä¸ºå’Œé”ç›¸å…³çš„æ–¹æ³•éƒ½å®šä¹‰åœ¨Objectç±»ä¸­ï¼Œå› æ­¤è°ƒç”¨Thread.sleep()æ˜¯ä¸ä¼šå½±å“é”çš„ç›¸å…³è¡Œä¸ºã€‚ Thread.sleepå’ŒObject.waitéƒ½ä¼šæš‚åœå½“å‰çš„çº¿ç¨‹ï¼Œå¯¹äºCPUèµ„æºæ¥è¯´ï¼Œä¸ç®¡æ˜¯å“ªç§æ–¹å¼æš‚åœçš„çº¿ç¨‹ï¼Œéƒ½è¡¨ç¤ºå®ƒæš‚æ—¶ä¸å†éœ€è¦CPUçš„æ‰§è¡Œæ—¶é—´ã€‚OSä¼šå°†æ‰§è¡Œæ—¶é—´åˆ†é…ç»™å…¶å®ƒçº¿ç¨‹ã€‚åŒºåˆ«æ˜¯è°ƒç”¨waitåï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹æ‰§è¡Œnotify/notifyAllæ‰èƒ½å¤Ÿé‡æ–°è·å¾—CPUæ‰§è¡Œæ—¶é—´ã€‚ çº¿ç¨‹çŠ¶æ€å›¾ï¼š Thread.sleep()è®©çº¿ç¨‹ä» ã€runningã€‘ -&gt; ã€é˜»å¡æ€ã€‘ æ—¶é—´ç»“æŸ/interrupt -&gt; ã€runnableã€‘ Object.wait()è®©çº¿ç¨‹ä» ã€runningã€‘ -&gt; ã€ç­‰å¾…é˜Ÿåˆ—ã€‘notify -&gt; ã€é”æ± ã€‘ -&gt; ã€runnableã€‘ å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜æ˜¯ç ”ç©¶å¤šçº¿ç¨‹ç¨‹åºæ—¶ç»•ä¸å¼€çš„ç»å…¸é—®é¢˜ä¹‹ä¸€ï¼Œå®ƒæè¿°æ˜¯æœ‰ä¸€å—ç¼“å†²åŒºä½œä¸ºä»“åº“ï¼Œç”Ÿäº§è€…å¯ä»¥å°†äº§å“æ”¾å…¥ä»“åº“ï¼Œæ¶ˆè´¹è€…åˆ™å¯ä»¥ä»ä»“åº“ä¸­å–èµ°äº§å“ã€‚åœ¨Javaä¸­ä¸€å…±æœ‰å››ç§æ–¹æ³•æ”¯æŒåŒæ­¥ï¼Œå…¶ä¸­å‰ä¸‰ä¸ªæ˜¯åŒæ­¥æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯ç®¡é“æ–¹æ³•ã€‚ ï¼ˆ1ï¼‰Objectçš„wait() / notify()æ–¹æ³•ï¼ˆ2ï¼‰Lockå’ŒConditionçš„await() / signal()æ–¹æ³•ï¼ˆ3ï¼‰BlockingQueueé˜»å¡é˜Ÿåˆ—æ–¹æ³•ï¼ˆ4ï¼‰PipedInputStream / PipedOutputStream æœ¬æ–‡åªä»‹ç»æœ€å¸¸ç”¨çš„å‰ä¸‰ç§ï¼Œç¬¬å››ç§æš‚ä¸åšè®¨è®ºã€‚æºä»£ç åœ¨è¿™é‡Œï¼šJavaå®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ 1. ä½¿ç”¨Objectçš„wait() / notify()æ–¹æ³•wait()/ nofity()æ–¹æ³•æ˜¯åŸºç±»Objectçš„ä¸¤ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ„å‘³ç€æ‰€æœ‰Javaç±»éƒ½ä¼šæ‹¥æœ‰è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸ºä»»ä½•å¯¹è±¡å®ç°åŒæ­¥æœºåˆ¶ã€‚ wait()ï¼šå½“ç¼“å†²åŒºå·²æ»¡/ç©ºæ—¶ï¼Œç”Ÿäº§è€…/æ¶ˆè´¹è€…çº¿ç¨‹åœæ­¢è‡ªå·±çš„æ‰§è¡Œï¼Œæ”¾å¼ƒé”ï¼Œä½¿è‡ªå·±å¤„äºç­‰å¾…çŠ¶æ€ï¼Œè®©å…¶ä»–çº¿ç¨‹æ‰§è¡Œã€‚ notify()ï¼šå½“ç”Ÿäº§è€…/æ¶ˆè´¹è€…å‘ç¼“å†²åŒºæ”¾å…¥/å–å‡ºä¸€ä¸ªäº§å“æ—¶ï¼Œå‘å…¶ä»–ç­‰å¾…çš„çº¿ç¨‹å‘å‡ºå¯æ‰§è¡Œçš„é€šçŸ¥ï¼ŒåŒæ—¶æ”¾å¼ƒé”ï¼Œä½¿è‡ªå·±å¤„äºç­‰å¾…çŠ¶æ€ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106/** * ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼šä½¿ç”¨Object.wait() / notify()æ–¹æ³•å®ç° */public class ProducerConsumer &#123; private static final int CAPACITY = 5; public static void main(String args[])&#123; Queue&lt;Integer&gt; queue = new LinkedList&lt;Integer&gt;(); Thread producer1 = new Producer(\"P-1\", queue, CAPACITY); Thread producer2 = new Producer(\"P-2\", queue, CAPACITY); Thread consumer1 = new Consumer(\"C1\", queue, CAPACITY); Thread consumer2 = new Consumer(\"C2\", queue, CAPACITY); Thread consumer3 = new Consumer(\"C3\", queue, CAPACITY); producer1.start(); producer2.start(); consumer1.start(); consumer2.start(); consumer3.start(); &#125; /** * ç”Ÿäº§è€… */ public static class Producer extends Thread&#123; private Queue&lt;Integer&gt; queue; String name; int maxSize; int i = 0; public Producer(String name, Queue&lt;Integer&gt; queue, int maxSize)&#123; super(name); this.name = name; this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run()&#123; while(true)&#123; synchronized(queue)&#123; while(queue.size() == maxSize)&#123; try &#123; System.out .println(\"Queue is full, Producer[\" + name + \"] thread waiting for \" + \"consumer to take something from queue.\"); queue.wait(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; System.out.println(\"[\" + name + \"] Producing value : +\" + i); queue.offer(i++); queue.notifyAll(); try &#123; Thread.sleep(new Random().nextInt(1000)); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125; &#125; /** * æ¶ˆè´¹è€… */ public static class Consumer extends Thread&#123; private Queue&lt;Integer&gt; queue; String name; int maxSize; public Consumer(String name, Queue&lt;Integer&gt; queue, int maxSize)&#123; super(name); this.name = name; this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run()&#123; while(true)&#123; synchronized(queue)&#123; while(queue.isEmpty())&#123; try &#123; System.out.println(\"Queue is empty, Consumer[\" + name + \"] thread is waiting for Producer\"); queue.wait(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; int x = queue.poll(); System.out.println(\"[\" + name + \"] Consuming value : \" + x); queue.notifyAll(); try &#123; Thread.sleep(new Random().nextInt(1000)); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125; &#125;&#125; æ³¨æ„è¦ç‚¹åˆ¤æ–­Queueå¤§å°ä¸º0æˆ–è€…å¤§äºç­‰äºqueueSizeæ—¶é¡»ä½¿ç”¨ while (condition) {}ï¼Œä¸èƒ½ä½¿ç”¨ if(condition) {}ã€‚å…¶ä¸­ while(condition)å¾ªç¯ï¼Œå®ƒåˆè¢«å«åšâ€œè‡ªæ—‹é”â€ã€‚è‡ªæ—‹é”ä»¥åŠwait()å’Œnotify()æ–¹æ³•åœ¨çº¿ç¨‹é€šä¿¡è¿™ç¯‡æ–‡ç« ä¸­æœ‰æ›´åŠ è¯¦ç»†çš„ä»‹ç»ã€‚ä¸ºé˜²æ­¢è¯¥çº¿ç¨‹æ²¡æœ‰æ”¶åˆ°notify()è°ƒç”¨ä¹Ÿä»wait()ä¸­è¿”å›ï¼ˆä¹Ÿç§°ä½œè™šå‡å”¤é†’ï¼‰ï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šé‡æ–°å»æ£€æŸ¥conditionæ¡ä»¶ä»¥å†³å®šå½“å‰æ˜¯å¦å¯ä»¥å®‰å…¨åœ°ç»§ç»­æ‰§è¡Œè¿˜æ˜¯éœ€è¦é‡æ–°ä¿æŒç­‰å¾…ï¼Œè€Œä¸æ˜¯è®¤ä¸ºçº¿ç¨‹è¢«å”¤é†’äº†å°±å¯ä»¥å®‰å…¨åœ°ç»§ç»­æ‰§è¡Œäº†ã€‚ è¾“å‡ºæ—¥å¿—å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374[P-1] Producing value : +0[P-1] Producing value : +1[P-1] Producing value : +2[P-1] Producing value : +3[P-1] Producing value : +4Queue is full, Producer[P-1] thread waiting for consumer to take something from queue.[C3] Consuming value : 0[C3] Consuming value : 1[C3] Consuming value : 2[C3] Consuming value : 3[C3] Consuming value : 4Queue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-2] Producing value : +0[C1] Consuming value : 0Queue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for Producer[P-1] Producing value : +5[P-1] Producing value : +6[P-1] Producing value : +7[P-1] Producing value : +8[P-1] Producing value : +9Queue is full, Producer[P-1] thread waiting for consumer to take something from queue.[C3] Consuming value : 5[C3] Consuming value : 6[C3] Consuming value : 7[C3] Consuming value : 8[C3] Consuming value : 9Queue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-2] Producing value : +1[C1] Consuming value : 1Queue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for Producer[P-1] Producing value : +10[P-1] Producing value : +11[P-1] Producing value : +12[P-1] Producing value : +13[P-1] Producing value : +14Queue is full, Producer[P-1] thread waiting for consumer to take something from queue.[C3] Consuming value : 10[C3] Consuming value : 11[C3] Consuming value : 12[C3] Consuming value : 13[C3] Consuming value : 14Queue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-2] Producing value : +2[P-2] Producing value : +3[P-2] Producing value : +4[P-2] Producing value : +5[P-2] Producing value : +6Queue is full, Producer[P-2] thread waiting for consumer to take something from queue.[C1] Consuming value : 2[C1] Consuming value : 3[C1] Consuming value : 4[C1] Consuming value : 5[C1] Consuming value : 6Queue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for Producer[P-1] Producing value : +15[C3] Consuming value : 15Queue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-2] Producing value : +7[P-2] Producing value : +8[P-2] Producing value : +9 2. ä½¿ç”¨Lockå’ŒConditionçš„await() / signal()æ–¹æ³•åœ¨JDK5.0ä¹‹åï¼ŒJavaæä¾›äº†æ›´åŠ å¥å£®çš„çº¿ç¨‹å¤„ç†æœºåˆ¶ï¼ŒåŒ…æ‹¬åŒæ­¥ã€é”å®šã€çº¿ç¨‹æ± ç­‰ï¼Œå®ƒä»¬å¯ä»¥å®ç°æ›´ç»†ç²’åº¦çš„çº¿ç¨‹æ§åˆ¶ã€‚Conditionæ¥å£çš„await()å’Œsignal()å°±æ˜¯å…¶ä¸­ç”¨æ¥åšåŒæ­¥çš„ä¸¤ç§æ–¹æ³•ï¼Œå®ƒä»¬çš„åŠŸèƒ½åŸºæœ¬ä¸Šå’ŒObjectçš„wait()/ nofity()ç›¸åŒï¼Œå®Œå…¨å¯ä»¥å–ä»£å®ƒä»¬ï¼Œä½†æ˜¯å®ƒä»¬å’Œæ–°å¼•å…¥çš„é”å®šæœºåˆ¶Lockç›´æ¥æŒ‚é’©ï¼Œå…·æœ‰æ›´å¤§çš„çµæ´»æ€§ã€‚é€šè¿‡åœ¨Lockå¯¹è±¡ä¸Šè°ƒç”¨newCondition()æ–¹æ³•ï¼Œå°†æ¡ä»¶å˜é‡å’Œä¸€ä¸ªé”å¯¹è±¡è¿›è¡Œç»‘å®šï¼Œè¿›è€Œæ§åˆ¶å¹¶å‘ç¨‹åºè®¿é—®ç«äº‰èµ„æºçš„å®‰å…¨ã€‚ä¸‹é¢æ¥çœ‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128/** * ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼šä½¿ç”¨Lockå’ŒConditionå®ç° * &#123;@link java.util.concurrent.locks.Lock&#125; * &#123;@link java.util.concurrent.locks.Condition&#125; */public class ProducerConsumerByLock &#123; private static final int CAPACITY = 5; private static final Lock lock = new ReentrantLock(); private static final Condition fullCondition = lock.newCondition(); //é˜Ÿåˆ—æ»¡çš„æ¡ä»¶ private static final Condition emptyCondition = lock.newCondition(); //é˜Ÿåˆ—ç©ºçš„æ¡ä»¶ public static void main(String args[])&#123; Queue&lt;Integer&gt; queue = new LinkedList&lt;Integer&gt;(); Thread producer1 = new Producer(\"P-1\", queue, CAPACITY); Thread producer2 = new Producer(\"P-2\", queue, CAPACITY); Thread consumer1 = new Consumer(\"C1\", queue, CAPACITY); Thread consumer2 = new Consumer(\"C2\", queue, CAPACITY); Thread consumer3 = new Consumer(\"C3\", queue, CAPACITY); producer1.start(); producer2.start(); consumer1.start(); consumer2.start(); consumer3.start(); &#125; /** * ç”Ÿäº§è€… */ public static class Producer extends Thread&#123; private Queue&lt;Integer&gt; queue; String name; int maxSize; int i = 0; public Producer(String name, Queue&lt;Integer&gt; queue, int maxSize)&#123; super(name); this.name = name; this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run()&#123; while(true)&#123; //è·å¾—é” lock.lock(); while(queue.size() == maxSize)&#123; try &#123; System.out .println(\"Queue is full, Producer[\" + name + \"] thread waiting for \" + \"consumer to take something from queue.\"); //æ¡ä»¶ä¸æ»¡è¶³ï¼Œç”Ÿäº§é˜»å¡ fullCondition.await(); &#125; catch (InterruptedException ex) &#123; ex.printStackTrace(); &#125; &#125; System.out.println(\"[\" + name + \"] Producing value : +\" + i); queue.offer(i++); //å”¤é†’å…¶ä»–æ‰€æœ‰ç”Ÿäº§è€…ã€æ¶ˆè´¹è€… fullCondition.signalAll(); emptyCondition.signalAll(); //é‡Šæ”¾é” lock.unlock(); try &#123; Thread.sleep(new Random().nextInt(1000)); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125; /** * æ¶ˆè´¹è€… */ public static class Consumer extends Thread&#123; private Queue&lt;Integer&gt; queue; String name; int maxSize; public Consumer(String name, Queue&lt;Integer&gt; queue, int maxSize)&#123; super(name); this.name = name; this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run()&#123; while(true)&#123; //è·å¾—é” lock.lock(); while(queue.isEmpty())&#123; try &#123; System.out.println(\"Queue is empty, Consumer[\" + name + \"] thread is waiting for Producer\"); //æ¡ä»¶ä¸æ»¡è¶³ï¼Œæ¶ˆè´¹é˜»å¡ emptyCondition.await(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; int x = queue.poll(); System.out.println(\"[\" + name + \"] Consuming value : \" + x); //å”¤é†’å…¶ä»–æ‰€æœ‰ç”Ÿäº§è€…ã€æ¶ˆè´¹è€… fullCondition.signalAll(); emptyCondition.signalAll(); //é‡Šæ”¾é” lock.unlock(); try &#123; Thread.sleep(new Random().nextInt(1000)); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125;&#125; è¾“å…¥æ—¥å¿—å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104[P-1] Producing value : +0[C1] Consuming value : 0Queue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for Producer[P-2] Producing value : +0[C3] Consuming value : 0Queue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-2] Producing value : +1[C2] Consuming value : 1Queue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for Producer[P-1] Producing value : +1[C1] Consuming value : 1Queue is empty, Consumer[C3] thread is waiting for Producer[P-1] Producing value : +2[C3] Consuming value : 2Queue is empty, Consumer[C2] thread is waiting for Producer[P-2] Producing value : +2[C2] Consuming value : 2Queue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for Producer[P-1] Producing value : +3[C1] Consuming value : 3Queue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for Producer[P-2] Producing value : +3[C2] Consuming value : 3Queue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for Producer[P-1] Producing value : +4[C1] Consuming value : 4Queue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-2] Producing value : +4[C3] Consuming value : 4Queue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-2] Producing value : +5[C2] Consuming value : 5Queue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C2] thread is waiting for Producer[P-1] Producing value : +5[C1] Consuming value : 5Queue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for Producer[P-2] Producing value : +6[C2] Consuming value : 6Queue is empty, Consumer[C3] thread is waiting for Producer[P-1] Producing value : +6[C3] Consuming value : 6Queue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-2] Producing value : +7[C3] Consuming value : 7Queue is empty, Consumer[C1] thread is waiting for Producer[P-1] Producing value : +7[C1] Consuming value : 7Queue is empty, Consumer[C2] thread is waiting for Producer[P-2] Producing value : +8[C2] Consuming value : 8[P-1] Producing value : +8[C1] Consuming value : 8[P-2] Producing value : +9[C3] Consuming value : 9[P-2] Producing value : +10[C2] Consuming value : 10[P-1] Producing value : +9[P-1] Producing value : +10[C1] Consuming value : 9[P-2] Producing value : +11[C3] Consuming value : 10[C2] Consuming value : 11[P-2] Producing value : +12[C1] Consuming value : 12[P-1] Producing value : +11[C3] Consuming value : 11[P-2] Producing value : +13[C2] Consuming value : 13Queue is empty, Consumer[C2] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for Producer[P-1] Producing value : +12[C2] Consuming value : 12Queue is empty, Consumer[C3] thread is waiting for Producer[P-1] Producing value : +13[C3] Consuming value : 13Queue is empty, Consumer[C1] thread is waiting for ProducerQueue is empty, Consumer[C3] thread is waiting for Producer[P-2] Producing value : +14[C1] Consuming value : 14Queue is empty, Consumer[C3] thread is waiting for ProducerQueue is empty, Consumer[C1] thread is waiting for Producer[P-1] Producing value : +14[C3] Consuming value : 14Queue is empty, Consumer[C1] thread is waiting for Producer[P-1] Producing value : +15[C1] Consuming value : 15[P-2] Producing value : +15[P-1] Producing value : +16[C3] Consuming value : 15[P-2] Producing value : +16 3. ä½¿ç”¨BlockingQueueé˜»å¡é˜Ÿåˆ—æ–¹æ³•JDK 1.5 ä»¥åæ–°å¢çš„ java.util.concurrentåŒ…æ–°å¢äº† BlockingQueue æ¥å£ã€‚å¹¶æä¾›äº†å¦‚ä¸‹å‡ ç§é˜»å¡é˜Ÿåˆ—å®ç°ï¼š java.util.concurrent.ArrayBlockingQueue java.util.concurrent.LinkedBlockingQueue java.util.concurrent.SynchronousQueue java.util.concurrent.PriorityBlockingQueue å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ä½¿ç”¨ ArrayBlockingQueueæˆ–è€… LinkedBlockingQueueå³å¯ã€‚ æˆ‘ä»¬è¿™é‡Œä½¿ç”¨LinkedBlockingQueueï¼Œå®ƒæ˜¯ä¸€ä¸ªå·²ç»åœ¨å†…éƒ¨å®ç°äº†åŒæ­¥çš„é˜Ÿåˆ—ï¼Œå®ç°æ–¹å¼é‡‡ç”¨çš„æ˜¯æˆ‘ä»¬ç¬¬2ç§await()/ signal()æ–¹æ³•ã€‚å®ƒå¯ä»¥åœ¨ç”Ÿæˆå¯¹è±¡æ—¶æŒ‡å®šå®¹é‡å¤§å°ã€‚å®ƒç”¨äºé˜»å¡æ“ä½œçš„æ˜¯put()å’Œtake()æ–¹æ³•ã€‚ put()æ–¹æ³•ï¼šç±»ä¼¼äºæˆ‘ä»¬ä¸Šé¢çš„ç”Ÿäº§è€…çº¿ç¨‹ï¼Œå®¹é‡è¾¾åˆ°æœ€å¤§æ—¶ï¼Œè‡ªåŠ¨é˜»å¡ã€‚ take()æ–¹æ³•ï¼šç±»ä¼¼äºæˆ‘ä»¬ä¸Šé¢çš„æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå®¹é‡ä¸º0æ—¶ï¼Œè‡ªåŠ¨é˜»å¡ã€‚ æˆ‘ä»¬å¯ä»¥è·Ÿè¿›æºç çœ‹ä¸€ä¸‹LinkedBlockingQueueç±»çš„put()æ–¹æ³•å®ç°ï¼š 123456789101112131415161718192021222324252627/** Main lock guarding all access */final ReentrantLock lock = new ReentrantLock();/** Condition for waiting takes */private final Condition notEmpty = lock.newCondition();/** Condition for waiting puts */private final Condition notFull = lock.newCondition();public void put(E e) throws InterruptedException &#123; putLast(e);&#125;public void putLast(E e) throws InterruptedException &#123; if (e == null) throw new NullPointerException(); Node&lt;E&gt; node = new Node&lt;E&gt;(e); final ReentrantLock lock = this.lock; lock.lock(); try &#123; while (!linkLast(node)) notFull.await(); &#125; finally &#123; lock.unlock(); &#125;&#125; çœ‹åˆ°è¿™é‡Œè¯å®äº†å®ƒçš„å®ç°æ–¹å¼é‡‡ç”¨çš„æ˜¯æˆ‘ä»¬ç¬¬2ç§await()/ signal()æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬å°±ä½¿ç”¨å®ƒå®ç°å§ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687/** * ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼šä½¿ç”¨&#123;@link java.util.concurrent.BlockingQueue&#125;å®ç° */public class ProducerConsumerByBQ&#123; private static final int CAPACITY = 5; public static void main(String args[])&#123; LinkedBlockingDeque&lt;Integer&gt; blockingQueue = new LinkedBlockingDeque&lt;Integer&gt;(CAPACITY); Thread producer1 = new Producer(\"P-1\", blockingQueue, CAPACITY); Thread producer2 = new Producer(\"P-2\", blockingQueue, CAPACITY); Thread consumer1 = new Consumer(\"C1\", blockingQueue, CAPACITY); Thread consumer2 = new Consumer(\"C2\", blockingQueue, CAPACITY); Thread consumer3 = new Consumer(\"C3\", blockingQueue, CAPACITY); producer1.start(); producer2.start(); consumer1.start(); consumer2.start(); consumer3.start(); &#125; /** * ç”Ÿäº§è€… */ public static class Producer extends Thread&#123; private LinkedBlockingDeque&lt;Integer&gt; blockingQueue; String name; int maxSize; int i = 0; public Producer(String name, LinkedBlockingDeque&lt;Integer&gt; queue, int maxSize)&#123; super(name); this.name = name; this.blockingQueue = queue; this.maxSize = maxSize; &#125; @Override public void run()&#123; while(true)&#123; try &#123; blockingQueue.put(i); System.out.println(\"[\" + name + \"] Producing value : +\" + i); i++; //æš‚åœæœ€å¤š1ç§’ Thread.sleep(new Random().nextInt(1000)); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125; /** * æ¶ˆè´¹è€… */ public static class Consumer extends Thread&#123; private LinkedBlockingDeque&lt;Integer&gt; blockingQueue; String name; int maxSize; public Consumer(String name, LinkedBlockingDeque&lt;Integer&gt; queue, int maxSize)&#123; super(name); this.name = name; this.blockingQueue = queue; this.maxSize = maxSize; &#125; @Override public void run()&#123; while(true)&#123; try &#123; int x = blockingQueue.take(); System.out.println(\"[\" + name + \"] Consuming : \" + x); //æš‚åœæœ€å¤š1ç§’ Thread.sleep(new Random().nextInt(1000)); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125;&#125; è¾“å‡ºæ—¥å¿—å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566[P-2] Producing value : +0[P-1] Producing value : +0[C1] Consuming : 0[C3] Consuming : 0[P-2] Producing value : +1[C2] Consuming : 1[P-2] Producing value : +2[C1] Consuming : 2[P-1] Producing value : +1[C2] Consuming : 1[P-1] Producing value : +2[C3] Consuming : 2[P-1] Producing value : +3[C2] Consuming : 3[P-2] Producing value : +3[C1] Consuming : 3[P-1] Producing value : +4[C2] Consuming : 4[P-2] Producing value : +4[C3] Consuming : 4[P-2] Producing value : +5[C1] Consuming : 5[P-1] Producing value : +5[C2] Consuming : 5[P-1] Producing value : +6[C1] Consuming : 6[P-2] Producing value : +6[C2] Consuming : 6[P-2] Producing value : +7[C2] Consuming : 7[P-1] Producing value : +7[C1] Consuming : 7[P-2] Producing value : +8[C3] Consuming : 8[P-2] Producing value : +9[C2] Consuming : 9[P-1] Producing value : +8[C2] Consuming : 8[P-2] Producing value : +10[C1] Consuming : 10[P-1] Producing value : +9[C3] Consuming : 9[P-1] Producing value : +10[C2] Consuming : 10[P-2] Producing value : +11[C1] Consuming : 11[C3] Consuming : 12[P-2] Producing value : +12[P-2] Producing value : +13[C2] Consuming : 13[P-1] Producing value : +11[C3] Consuming : 11[P-1] Producing value : +12[C3] Consuming : 12[P-2] Producing value : +14[C1] Consuming : 14[P-1] Producing value : +13[C2] Consuming : 13[P-2] Producing value : +15[C3] Consuming : 15[P-2] Producing value : +16[C1] Consuming : 16[P-1] Producing value : +14[C3] Consuming : 14[P-2] Producing value : +17[C2] Consuming : 17 å‚è€ƒèµ„æ–™ Producer-Consumer solution using threads in Java ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ - ç»´åŸºç™¾ç§‘ ç”Ÿäº§è€…/æ¶ˆè´¹è€…é—®é¢˜çš„å¤šç§Javaå®ç°æ–¹å¼ å¦‚ä½•åœ¨ Java ä¸­æ­£ç¡®ä½¿ç”¨ wait, notify å’Œ notifyAll â€“ ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ä¸ºä¾‹ JAVAå¤šçº¿ç¨‹ä¹‹wait/notify java sleepå’Œwaitçš„åŒºåˆ«çš„ç–‘æƒ‘?","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€Androidã€‘Dialogå¼‚å¸¸CalledFromWrongThreadExceptionæ·±å…¥åˆ†æ","slug":"ã€Androidã€‘Dialogå¼‚å¸¸CalledFromWrongThreadExceptionæ·±å…¥åˆ†æ","date":"2017-10-26T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/10/26/ã€Androidã€‘Dialogå¼‚å¸¸CalledFromWrongThreadExceptionæ·±å…¥åˆ†æ/","link":"","permalink":"http://github.com/2017/10/26/ã€Androidã€‘Dialogå¼‚å¸¸CalledFromWrongThreadExceptionæ·±å…¥åˆ†æ/","excerpt":"é—®é¢˜åœ¨ä½¿ç”¨Dialogæ—¶ï¼Œå› ä¸ºçº¿ç¨‹é—®é¢˜ï¼Œåœ¨è°ƒç”¨dismissæ–¹æ³•æ—¶å‡ºç°äº†CalledFromWrongThreadExceptionçš„Crashï¼Œå¦‚ä¸‹ï¼š 1android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views. æŠ›å‡ºå¼‚å¸¸ä¸ºCalledFromWrongThreadExceptionï¼Œå¾ˆæ˜æ˜¾ç¬¬ä¸€ååº”å°±æ˜¯å‡ºç°äº†éuiçº¿ç¨‹è¿›è¡Œäº†uiæ“ä½œé€ æˆäº†æ­¤å¼‚å¸¸ã€‚é€šè¿‡åˆ†æå·¥ç¨‹ä»£ç ï¼Œå‘ç°æœ¬è´¨ä¸Šæ˜¯å› ä¸ºåœ¨éuiçº¿ç¨‹ä¸­åˆ›å»ºäº†Dialogï¼Œè€Œåœ¨ä¸»çº¿ç¨‹ï¼ˆå³uiçº¿ç¨‹ï¼‰ä¸­è°ƒç”¨äº†show()ä»¥åŠdismiss()æ–¹æ³•ï¼Œæˆ‘æŠŠé—®é¢˜æ¨¡å‹å†™æˆæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859public class MainActivity extends BaseActivity &#123; private static final String TAG = \"MainActivity test\"; private ProgressDialog dialog; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); EventBus.getDefault().register(this); new Thread(new Runnable() &#123; @Override public void run() &#123; Looper.prepare(); //å­çº¿ç¨‹ä¸­åˆ›å»ºDialog dialog = new ProgressDialog(MainActivity.this); dialog.setCanceledOnTouchOutside(true); dialog.setOnCancelListener(new DialogInterface.OnCancelListener() &#123; @Override public void onCancel(DialogInterface dialog) &#123; Log.d(TAG, \"Dialog onCancel thread: \" + getThreadInfo()); &#125; &#125;); dialog.setOnDismissListener(new DialogInterface.OnDismissListener() &#123; @Override public void onDismiss(DialogInterface dialog) &#123; Log.d(TAG, \"Dialog onDismiss thread: \" + getThreadInfo()); &#125; &#125;); dialog.setMessage(\"æ­£åœ¨åŠ è½½...\"); Log.d(TAG, \"Dialog create thread: \" + getThreadInfo()); Looper.loop(); &#125; &#125;).start(); Button btn = (Button) findViewById(R.id.btn_helloworld); btn.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; //UIä¸»çº¿ç¨‹ä¸­showï¼Œç„¶åç‚¹å‡»ç©ºç™½åŒºåŸŸdismiss dialog.show(); Log.d(TAG, \"Dialog show thread: \" + getThreadInfo()); &#125; &#125;); &#125; /** * è¾“å‡ºçº¿ç¨‹ä¿¡æ¯ */ private String getThreadInfo()&#123; return \"[\" + Thread.currentThread().getId() + \"]\" + ((Looper.myLooper() == Looper.getMainLooper())? \" is UI-Thread\" : \"\"); &#125;&#125; å°±æ˜¯Activityæ‰“å¼€çš„æ—¶å€™ï¼Œä½¿ç”¨workå­çº¿ç¨‹åˆ›å»ºäº†ä¸€ä¸ªDialogï¼Œç„¶åæ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œæ˜¾ç¤ºDialogã€‚å†ç‚¹å‡»ç©ºç™½å¤„ï¼Œdialogæœ¬åº”è¯¥dismissçš„ï¼Œä½†æ˜¯ç›´æ¥crashäº†ã€‚æŠ›å‡ºäº†CalledFromWrongThreadExceptionçš„å¼‚å¸¸ã€‚ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘é¡ºä¾¿è¾“å‡ºäº†Dialogæ¯ä¸ªæ“ä½œçš„çº¿ç¨‹IDï¼ŒåŒæ—¶ä¼šåˆ¤å®šæ˜¯ä¸æ˜¯uiä¸»çº¿ç¨‹ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹logï¼š 10-26 16:11:07.836 7405-7652/com.cuc.myandroidtest D/MainActivity test: Dialog create thread: [3953]10-26 16:11:27.763 7405-7405/com.cuc.myandroidtest D/MainActivity test: Dialog show thread: [1] is UI-Thread10-26 16:11:35.642 7405-7652/com.cuc.myandroidtest D/MainActivity test: Dialog onCancel thread: [3953] â€”â€”â€“ beginning of crash å¯ä»¥çœ‹åˆ°ï¼Œä»¥ä¸Šå‡ºç°çš„é—®é¢˜ä¸­æ‰§è¡ŒDialogæ“ä½œçš„çº¿ç¨‹ä¿¡æ¯å¦‚ä¸‹ï¼š åˆ›å»ºDialogï¼šworkå­çº¿ç¨‹ show()ï¼šuiä¸»çº¿ç¨‹ cancel()ï¼šworkå­çº¿ç¨‹ dismiss()ï¼šå› ä¸ºcrashæ²¡æœ‰æ‰§è¡Œåˆ°ï¼ŒæœªçŸ¥ å¦‚æœè¯´åªæœ‰åˆ›å»ºè¿™ä¸ªæ§ä»¶çš„çº¿ç¨‹æ‰èƒ½å»æ›´æ–°è¯¥æ§ä»¶çš„å†…å®¹ã€‚é‚£ä¹ˆåœ¨è°ƒç”¨showæ–¹æ³•çš„æ—¶å€™ä¸ºä»€ä¹ˆä¸ä¼šcrashï¼Œç„¶ådismissçš„æ—¶å€™æ‰ä¼šå´©æºƒï¼Ÿ å¦å¤–ï¼Œåˆ°åº•æ˜¯ä¸æ˜¯æ‰€æœ‰çš„æ“ä½œéƒ½å¿…é¡»æ”¾åˆ°uiçº¿ç¨‹ä¸­æ‰§è¡Œæ‰å¯¹ï¼Ÿå¸¦ç€ç–‘é—®æˆ‘ä»¬æ·±å…¥Dialogæºç ä¸€çœ‹ç©¶ç«Ÿã€‚","text":"é—®é¢˜åœ¨ä½¿ç”¨Dialogæ—¶ï¼Œå› ä¸ºçº¿ç¨‹é—®é¢˜ï¼Œåœ¨è°ƒç”¨dismissæ–¹æ³•æ—¶å‡ºç°äº†CalledFromWrongThreadExceptionçš„Crashï¼Œå¦‚ä¸‹ï¼š 1android.view.ViewRootImpl$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views. æŠ›å‡ºå¼‚å¸¸ä¸ºCalledFromWrongThreadExceptionï¼Œå¾ˆæ˜æ˜¾ç¬¬ä¸€ååº”å°±æ˜¯å‡ºç°äº†éuiçº¿ç¨‹è¿›è¡Œäº†uiæ“ä½œé€ æˆäº†æ­¤å¼‚å¸¸ã€‚é€šè¿‡åˆ†æå·¥ç¨‹ä»£ç ï¼Œå‘ç°æœ¬è´¨ä¸Šæ˜¯å› ä¸ºåœ¨éuiçº¿ç¨‹ä¸­åˆ›å»ºäº†Dialogï¼Œè€Œåœ¨ä¸»çº¿ç¨‹ï¼ˆå³uiçº¿ç¨‹ï¼‰ä¸­è°ƒç”¨äº†show()ä»¥åŠdismiss()æ–¹æ³•ï¼Œæˆ‘æŠŠé—®é¢˜æ¨¡å‹å†™æˆæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859public class MainActivity extends BaseActivity &#123; private static final String TAG = \"MainActivity test\"; private ProgressDialog dialog; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); EventBus.getDefault().register(this); new Thread(new Runnable() &#123; @Override public void run() &#123; Looper.prepare(); //å­çº¿ç¨‹ä¸­åˆ›å»ºDialog dialog = new ProgressDialog(MainActivity.this); dialog.setCanceledOnTouchOutside(true); dialog.setOnCancelListener(new DialogInterface.OnCancelListener() &#123; @Override public void onCancel(DialogInterface dialog) &#123; Log.d(TAG, \"Dialog onCancel thread: \" + getThreadInfo()); &#125; &#125;); dialog.setOnDismissListener(new DialogInterface.OnDismissListener() &#123; @Override public void onDismiss(DialogInterface dialog) &#123; Log.d(TAG, \"Dialog onDismiss thread: \" + getThreadInfo()); &#125; &#125;); dialog.setMessage(\"æ­£åœ¨åŠ è½½...\"); Log.d(TAG, \"Dialog create thread: \" + getThreadInfo()); Looper.loop(); &#125; &#125;).start(); Button btn = (Button) findViewById(R.id.btn_helloworld); btn.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; //UIä¸»çº¿ç¨‹ä¸­showï¼Œç„¶åç‚¹å‡»ç©ºç™½åŒºåŸŸdismiss dialog.show(); Log.d(TAG, \"Dialog show thread: \" + getThreadInfo()); &#125; &#125;); &#125; /** * è¾“å‡ºçº¿ç¨‹ä¿¡æ¯ */ private String getThreadInfo()&#123; return \"[\" + Thread.currentThread().getId() + \"]\" + ((Looper.myLooper() == Looper.getMainLooper())? \" is UI-Thread\" : \"\"); &#125;&#125; å°±æ˜¯Activityæ‰“å¼€çš„æ—¶å€™ï¼Œä½¿ç”¨workå­çº¿ç¨‹åˆ›å»ºäº†ä¸€ä¸ªDialogï¼Œç„¶åæ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ï¼Œæ˜¾ç¤ºDialogã€‚å†ç‚¹å‡»ç©ºç™½å¤„ï¼Œdialogæœ¬åº”è¯¥dismissçš„ï¼Œä½†æ˜¯ç›´æ¥crashäº†ã€‚æŠ›å‡ºäº†CalledFromWrongThreadExceptionçš„å¼‚å¸¸ã€‚ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘é¡ºä¾¿è¾“å‡ºäº†Dialogæ¯ä¸ªæ“ä½œçš„çº¿ç¨‹IDï¼ŒåŒæ—¶ä¼šåˆ¤å®šæ˜¯ä¸æ˜¯uiä¸»çº¿ç¨‹ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹logï¼š 10-26 16:11:07.836 7405-7652/com.cuc.myandroidtest D/MainActivity test: Dialog create thread: [3953]10-26 16:11:27.763 7405-7405/com.cuc.myandroidtest D/MainActivity test: Dialog show thread: [1] is UI-Thread10-26 16:11:35.642 7405-7652/com.cuc.myandroidtest D/MainActivity test: Dialog onCancel thread: [3953] â€”â€”â€“ beginning of crash å¯ä»¥çœ‹åˆ°ï¼Œä»¥ä¸Šå‡ºç°çš„é—®é¢˜ä¸­æ‰§è¡ŒDialogæ“ä½œçš„çº¿ç¨‹ä¿¡æ¯å¦‚ä¸‹ï¼š åˆ›å»ºDialogï¼šworkå­çº¿ç¨‹ show()ï¼šuiä¸»çº¿ç¨‹ cancel()ï¼šworkå­çº¿ç¨‹ dismiss()ï¼šå› ä¸ºcrashæ²¡æœ‰æ‰§è¡Œåˆ°ï¼ŒæœªçŸ¥ å¦‚æœè¯´åªæœ‰åˆ›å»ºè¿™ä¸ªæ§ä»¶çš„çº¿ç¨‹æ‰èƒ½å»æ›´æ–°è¯¥æ§ä»¶çš„å†…å®¹ã€‚é‚£ä¹ˆåœ¨è°ƒç”¨showæ–¹æ³•çš„æ—¶å€™ä¸ºä»€ä¹ˆä¸ä¼šcrashï¼Œç„¶ådismissçš„æ—¶å€™æ‰ä¼šå´©æºƒï¼Ÿ å¦å¤–ï¼Œåˆ°åº•æ˜¯ä¸æ˜¯æ‰€æœ‰çš„æ“ä½œéƒ½å¿…é¡»æ”¾åˆ°uiçº¿ç¨‹ä¸­æ‰§è¡Œæ‰å¯¹ï¼Ÿå¸¦ç€ç–‘é—®æˆ‘ä»¬æ·±å…¥Dialogæºç ä¸€çœ‹ç©¶ç«Ÿã€‚ æºç åˆ†ææˆ‘ä»¬å…ˆçœ‹Dialogçš„dismissæ–¹æ³•ï¼š 123456789101112131415161718192021/** * Dismiss this dialog, removing it from the screen. This method can be * invoked safely from any thread. Note that you should not override this * method to do cleanup when the dialog is dismissed, instead implement * that in &#123;@link #onStop&#125;. */@Overridepublic void dismiss() &#123; if (Looper.myLooper() == mHandler.getLooper()) &#123; dismissDialog(); &#125; else &#123; mHandler.post(mDismissAction); &#125;&#125;private final Runnable mDismissAction = new Runnable() &#123; public void run() &#123; dismissDialog(); &#125;&#125;; æˆ‘ä»¬å…ˆçœ‹æ³¨é‡Šï¼Œæ„æ€æ˜¯dismiss()è¿™ä¸ªå‡½æ•°å¯ä»¥åœ¨ä»»æ„çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œä¸ç”¨æ‹…å¿ƒçº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ å¾ˆæ˜æ˜¾ï¼Œdialogå¯¹äºuiæ“ä½œåšäº†ç‰¹åˆ«å¤„ç†ã€‚å¦‚æœå½“å‰æ‰§è¡Œdismissæ“ä½œçš„çº¿ç¨‹å’ŒmHandleræ‰€ä¾é™„çš„çº¿ç¨‹ä¸ä¸€è‡´çš„è¯é‚£ä¹ˆå°±ä¼šå°†dismissæ“ä½œä¸¢åˆ°å¯¹åº”çš„mHandlerçš„çº¿ç¨‹é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œã€‚é‚£ä¹ˆè¿™ä¸ªHandleråˆæ˜¯å“ªé‡Œæ¥çš„å‘¢ï¼Ÿ æˆ‘ä»¬å¼€å§‹è°ƒæŸ¥ï¼Œå¯ä»¥çœ‹åˆ°mHandlerå¯¹è±¡æ˜¯Dialogç±»ä¸­ç§æœ‰çš„ï¼Œä¼šåœ¨new Dialogçš„æ—¶å€™è‡ªåŠ¨åˆå§‹åŒ–ï¼š 1234567public class Dialog implements DialogInterface, Window.Callback, KeyEvent.Callback, OnCreateContextMenuListener, Window.OnWindowDismissedCallback &#123; private final Handler mHandler = new Handler(); //...çœç•¥å…¶ä½™ä»£ç ...&#125; å¯ä»¥åˆ†æå¾—å‡ºï¼Œè¯¥mHandlerç›´æ¥å…³è”çš„å°±æ˜¯new Dialogçš„çº¿ç¨‹ã€‚ä¹Ÿå°±èƒ½å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š ç»“è®ºä¸€ï¼šæœ€ç»ˆçœŸæ­£æ‰§è¡ŒdismissDialog()æ–¹æ³•é”€æ¯Dialogçš„çº¿ç¨‹å°±æ˜¯new Dialogçš„çº¿ç¨‹ã€‚ ç„¶åæˆ‘ä»¬è·Ÿè¿›å»dismissDialog()çœ‹çœ‹åˆ°åº•å¦‚ä½•é”€æ¯Dialogçš„ï¼š 123456789101112131415161718192021222324void dismissDialog() &#123; if (mDecor == null || !mShowing) &#123; return; &#125; if (mWindow.isDestroyed()) &#123; Log.e(TAG, \"Tried to dismissDialog() but the Dialog's window was already destroyed!\"); return; &#125; try &#123; mWindowManager.removeViewImmediate(mDecor); &#125; finally &#123; if (mActionMode != null) &#123; mActionMode.finish(); &#125; mDecor = null; mWindow.closeAllPanels(); onStop(); mShowing = false; sendDismissMessage(); &#125;&#125; å¯ä»¥çœ‹å‡ºæœ€ç»ˆè°ƒç”¨äº†mWindowManager.removeViewImmediate(mDecor);æ¥é”€æ¯Dialogï¼Œç»§ç»­è·Ÿè¿›removeViewImmediate()è¿™ä¸ªæ–¹æ³•ã€‚å‘ç°mWindowManagerçš„ç±»WindowManageræ˜¯ä¸ªabstractçš„ç±»ï¼Œæˆ‘ä»¬æ¥æ‰¾æ‰¾æœ¬å°Šã€‚ Dialogä¸­mWindowManagerå¯¹è±¡çš„æ¥å†å‘ç°mWindowManagerè¿™ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–æ˜¯åœ¨Dialogçš„æ„é€ å‡½æ•°ä¸­ï¼š 12345678910111213141516171819202122Dialog(Context context, int theme, boolean createContextThemeWrapper) &#123; if (createContextThemeWrapper) &#123; if (theme == 0) &#123; TypedValue outValue = new TypedValue(); context.getTheme().resolveAttribute(com.android.internal.R.attr.dialogTheme, outValue, true); theme = outValue.resourceId; &#125; mContext = new ContextThemeWrapper(context, theme); &#125; else &#123; mContext = context; &#125; mWindowManager = (WindowManager)context.getSystemService(Context.WINDOW_SERVICE); Window w = PolicyManager.makeNewWindow(mContext); mWindow = w; w.setCallback(this); w.setOnWindowDismissedCallback(this); w.setWindowManager(mWindowManager, null, null); w.setGravity(Gravity.CENTER); mListenersHandler = new ListenersHandler(this);&#125; å®ƒæ˜¯é€šè¿‡context.getSystemService(Context.WINDOW_SERVICE);å¾—åˆ°çš„ï¼Œè¿™é‡Œçš„contextè‚¯å®šå°±æ˜¯Activityäº†ï¼Œæˆ‘ä»¬å»Activityä¸­æ‰¾getSystemService()å‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829303132@Overridepublic Object getSystemService(@ServiceName @NonNull String name) &#123; if (getBaseContext() == null) &#123; throw new IllegalStateException( \"System services not available to Activities before onCreate()\"); &#125; if (WINDOW_SERVICE.equals(name)) &#123; return mWindowManager; &#125; else if (SEARCH_SERVICE.equals(name)) &#123; ensureSearchManager(); return mSearchManager; &#125; return super.getSystemService(name);&#125;final void attach(Context context, ActivityThread aThread, Instrumentation instr, IBinder token, int ident, Application application, Intent intent, ActivityInfo info, CharSequence title, Activity parent, String id, NonConfigurationInstances lastNonConfigurationInstances, Configuration config, IVoiceInteractor voiceInteractor) &#123; mWindow.setWindowManager((WindowManager)context.getSystemService(Context.WINDOW_SERVICE), mToken, mComponent.flattenToString(), (info.flags &amp; ActivityInfo.FLAG_HARDWARE_ACCELERATED) != 0); mWindowManager = mWindow.getWindowManager(); //...çœç•¥å…¶ä»–ä»£ç ...&#125; æˆ‘ä»¬çœ‹åˆ°mWindowManagerè¿™ä¸ªå¯¹è±¡æ˜¯åœ¨Activityè¢«åˆ›å»ºä¹‹åè°ƒç”¨attachå‡½æ•°çš„æ—¶å€™é€šè¿‡mWindow.setWindowManager()åˆå§‹åŒ–çš„ï¼Œè€Œè¿™ä¸ªå‡½æ•°é‡Œå¹²äº†ä»€ä¹ˆå‘¢ï¼Ÿ 1234567891011public void setWindowManager(WindowManager wm, IBinder appToken, String appName, boolean hardwareAccelerated) &#123; mAppToken = appToken; mAppName = appName; mHardwareAccelerated = hardwareAccelerated || SystemProperties.getBoolean(PROPERTY_HARDWARE_UI, false); if (wm == null) &#123; wm = (WindowManager)mContext.getSystemService(Context.WINDOW_SERVICE); &#125; mWindowManager = ((WindowManagerImpl)wm).createLocalWindowManager(this);&#125; å¯ä»¥çœ‹åˆ°mWindowManagerè¿™ä¸ªå¯¹è±¡æœ€ç»ˆæ¥æºäºWindowManagerImplç±»ï¼š 123456789101112131415161718192021222324252627public final class WindowManagerImpl implements WindowManager &#123; private final WindowManagerGlobal mGlobal = WindowManagerGlobal.getInstance(); private final Display mDisplay; private final Window mParentWindow; public WindowManagerImpl createLocalWindowManager(Window parentWindow) &#123; return new WindowManagerImpl(mDisplay, parentWindow); &#125; @Override public void addView(View view, ViewGroup.LayoutParams params) &#123; mGlobal.addView(view, params, mDisplay, mParentWindow); &#125; @Override public void removeView(View view) &#123; mGlobal.removeView(view, false); &#125; @Override public void removeViewImmediate(View view) &#123; mGlobal.removeView(view, true); &#125; //...çœç•¥å…¶ä½™ä»£ç ...&#125; åœ¨å…¶ä¸­æˆ‘ä»¬ç»ˆäºçœ‹åˆ°äº†removeViewImmediate()å‡½æ•°çš„èº«å½±ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰§è¡ŒDialogé”€æ¯çš„å‡½æ•°dismissDialog()ä¸­ï¼Œæœ€ç»ˆè°ƒç”¨äº†mWindowManager.removeViewImmediate(mDecor);æ¥é”€æ¯Dialogã€‚å®é™…ä¸Šè°ƒç”¨çš„å°±æ˜¯WindowManagerImplå®ä¾‹ä¸­çš„removeViewImmediate()æ–¹æ³•ã€‚ è€Œå®ƒåˆè°ƒç”¨çš„æ˜¯WindowManagerGlobalçš„removeView()å‡½æ•°ï¼š 12345678910111213141516171819202122232425262728293031323334353637public void removeView(View view, boolean immediate) &#123; if (view == null) &#123; throw new IllegalArgumentException(\"view must not be null\"); &#125; synchronized (mLock) &#123; int index = findViewLocked(view, true); View curView = mRoots.get(index).getView(); removeViewLocked(index, immediate); if (curView == view) &#123; return; &#125; throw new IllegalStateException(\"Calling with view \" + view + \" but the ViewAncestor is attached to \" + curView); &#125;&#125;private void removeViewLocked(int index, boolean immediate) &#123; ViewRootImpl root = mRoots.get(index); View view = root.getView(); if (view != null) &#123; InputMethodManager imm = InputMethodManager.getInstance(); if (imm != null) &#123; imm.windowDismissed(mViews.get(index).getWindowToken()); &#125; &#125; boolean deferred = root.die(immediate); if (view != null) &#123; view.assignParent(null); if (deferred) &#123; mDyingViews.add(view); &#125; &#125;&#125; æ³¨æ„è¿™å¥boolean deferred = root.die(immediate);ï¼Œå…¶ä¸­rootå¯¹è±¡æ˜¯ä¸ªViewRootImplçš„å®ä¾‹ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒçš„die()æ–¹æ³•ï¼š 123456789101112131415161718boolean die(boolean immediate) &#123; // Make sure we do execute immediately if we are in the middle of a traversal or the damage // done by dispatchDetachedFromWindow will cause havoc on return. if (immediate &amp;&amp; !mIsInTraversal) &#123; doDie(); return false; &#125; //...çœç•¥å…¶ä½™ä»£ç ...&#125;void doDie() &#123; checkThread(); //...çœç•¥å…¶ä½™ä»£ç ...&#125; æœ€ç»ˆï¼Œæ‰§è¡Œåˆ°äº†ViewRootImplç±»çš„doDie()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ç¬¬ä¸€å¥å°±æ˜¯checkThread()ï¼Œæ ¹æ®Android4.4DialogUIçº¿ç¨‹CalledFromWrongThreadExcectionè¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬çŸ¥é“æœ€ç»ˆæŠ›å‡ºå¼‚å¸¸çš„ä½ç½®å°±æ˜¯æ˜¯åœ¨ViewRootImplä»£ç ä¸­çš„checkThreadå‡½æ•°ï¼š 123456void checkThread() &#123; if (mThread != Thread.currentThread()) &#123; throw new CalledFromWrongThreadException( \"Only the original thread that created a view hierarchy can touch its views.\"); &#125;&#125; ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è°ƒç”¨Dialogçš„dismiss()æ–¹æ³•æ—¶ï¼ŒDialogä¼šè‡ªåŠ¨æŠ›åˆ°new Dialogçš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œè€Œè¿™ä¸ªçº¿ç¨‹å°±æ˜¯å½“å‰çš„Thread.currentThread()ã€‚æ¢å¥è¯è¯´ViewRootImplæœ¬èº«çš„mThreadå’Œè¿™ä¸ªnew Dialogçš„çº¿ç¨‹ä¸æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ã€‚ç„¶åæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªViewRootImplæœ¬èº«çš„mThreadçš„æ¥æºåœ¨ä½•å¤„ã€‚ ViewRootImplä¸­mThreadçš„æ¥å†åœ¨ViewRootImplçš„æ„é€ å‡½æ•°ä¸­å‘ç°äº†mThreadèµ‹å€¼çš„åœ°æ–¹ï¼š 12345public ViewRootImpl(Context context, Display display) &#123; mThread = Thread.currentThread(); //...çœç•¥å…¶ä½™ä»£ç ...&#125; é‚£è¿™ä¸ªViewRootImplä»€ä¹ˆæ—¶å€™è°ƒç”¨è¿™ä¸ªæ„é€ å‡½æ•°åˆ›å»ºå®ä¾‹çš„å‘¢ï¼Ÿæˆ‘ä»¬åˆšæ‰åœ¨WindowManagerGlobalçš„removeView()å‡½æ•°ä¸­ï¼Œçœ‹åˆ°äº†rootå¯¹è±¡æ˜¯ä»mRootså¯¹è±¡ä¸­å–å‡ºæ¥çš„ï¼Œè€ŒmRootsæ˜¯ä¸€ä¸ªArrayList&lt;ViewRootImpl&gt;ã€‚ æ‰€ä»¥æˆ‘ä»¬æ¥WindowManagerGlobalä¸­æ‰¾æ‰¾mRoots.add()çš„åœ°æ–¹ï¼Œå‘ç°æ˜¯åœ¨å®ƒçš„addView()å‡½æ•°ä¸­åˆ›å»ºäº†ä¸€ä¸ªViewRootImplå¯¹è±¡å¹¶æ·»åŠ åˆ°äº†mRootsè¿™ä¸ªlistä¸­ï¼š 12345678910111213141516171819202122232425262728public void addView(View view, ViewGroup.LayoutParams params, Display display, Window parentWindow) &#123; //...çœç•¥å…¶ä½™ä»£ç ..... ViewRootImpl root; synchronized (mLock) &#123; //...çœç•¥å…¶ä½™ä»£ç ..... root = new ViewRootImpl(view.getContext(), display); mRoots.add(root); &#125; // do this last because it fires off messages to start doing things try &#123; root.setView(view, wparams, panelParentView); &#125; catch (RuntimeException e) &#123; // BadTokenException or InvalidDisplayException, clean up. synchronized (mLock) &#123; final int index = findViewLocked(view, false); if (index &gt;= 0) &#123; removeViewLocked(index, true); &#125; &#125; throw e; &#125;&#125; è€Œè¿™ä¸ªaddViewæ–¹æ³•ä»€ä¹ˆæ—¶å€™ä¼šè°ƒç”¨å‘¢ï¼Ÿå°±æ˜¯WindowManagerImplã€‚ å°±æ˜¯åˆšæ‰åˆ†æDialogä¸­mWindowManagerå¯¹è±¡çš„æ¥å†æ—¶ï¼ŒçŸ¥é“äº†å®ƒå…¶å®æ˜¯WindowManagerImplç±»çš„ä¸€ä¸ªå®ä¾‹ï¼ŒWindowManagerImplä¼šé€šè¿‡WindowManagerGlobalçš„removeView()æ–¹æ³•å»å®ç°removeViewã€‚åŒç†ï¼Œæ­¤å¤„WindowManagerGlobalçš„addView()æ–¹æ³•ä¹Ÿæ˜¯è¢«WindowManagerImplè°ƒç”¨çš„ã€‚ æˆ‘ä»¬åœ¨Dialogçš„æºç ä¸­æ‰¾ä¸€ä¸‹mWindowManagerå¯¹è±¡è°ƒç”¨addView()æ–¹æ³•çš„åœ°æ–¹ï¼Œå¾ˆè®©äººæƒŠå–œï¼Œå®ƒç«Ÿç„¶åœ¨Dialogçš„show()æ–¹æ³•ä¸­å‡ºç°äº†ï¼š 1234567891011121314public void show() &#123; //...çœç•¥å…¶ä½™ä»£ç ..... onStart(); mDecor = mWindow.getDecorView(); try &#123; mWindowManager.addView(mDecor, l); mShowing = true; sendShowMessage(); &#125; finally &#123; &#125;&#125; ä¹Ÿå°±æ˜¯è¯´ï¼ŒDialogçš„show()æ–¹æ³•ï¼Œä¼šé€šè¿‡mWindowManager.addView(mDecor, l);åˆ›å»ºä¸€ä¸ªViewRootImplçš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šåœ¨åˆ›å»ºçš„æ—¶å€™ä¿å­˜ä¸€ä¸ªå½“å‰çº¿ç¨‹çš„Threadå¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è°ƒç”¨Dialogçš„show()æ–¹æ³•çš„çº¿ç¨‹ã€‚ è€Œåœ¨è°ƒç”¨Dialogçš„dismiss()æ–¹æ³•æ—¶ï¼Œä¼šé¦–å…ˆæŠŠå®ƒæŠ›åˆ°new Dialogçš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæœ€åé€šè¿‡è°ƒç”¨mWindowManager.removeViewImmediate()æ¥é”€æ¯Viewï¼Œæ­¤æ—¶ä¹Ÿå°±è‡ªç„¶è°ƒç”¨åˆ°äº†ViewRootImplå¯¹è±¡çš„doDie()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­ä¼šcheckThread();ï¼Œæ­¤æ—¶ä¼šæ£€æŸ¥å½“å‰çº¿ç¨‹ï¼ˆä¹Ÿå°±æ˜¯è°ƒç”¨new Dialogçš„çº¿ç¨‹ï¼‰æ˜¯ä¸æ˜¯åˆ›å»ºViewRootImplçš„å¯¹è±¡çš„çº¿ç¨‹ï¼ˆä¹Ÿå°±æ˜¯Dialogçš„show()æ–¹æ³•çš„çº¿ç¨‹ï¼‰ã€‚ åˆ°è¿™é‡Œï¼Œæœ¬æ–‡çš„bugæ ¹æºä¹Ÿå°±æ‰¾åˆ°äº†è¯´é€šäº†ã€‚æˆ‘ä»¬å†æ¥ç†Ÿæ‚‰ä¸€ä¸‹è¿™ä¸ªå¼‚å¸¸çš„åœºæ™¯ã€‚ åˆ›å»ºDialogï¼šworkå­çº¿ç¨‹ show()ï¼šuiä¸»çº¿ç¨‹ cancel()ï¼šworkå­çº¿ç¨‹ dismiss()ï¼šå› ä¸ºcrashæ²¡æœ‰æ‰§è¡Œåˆ°ï¼ŒæœªçŸ¥ï¼ˆå…¶å®æ˜¯æŠ›åˆ°äº†workå­çº¿ç¨‹ï¼‰ ç°åœ¨å°±æ˜ç¡®äº†ï¼Œæ‰§è¡Œshow()æ–¹æ³•çš„æ—¶å€™ViewRootImplæ²¡æœ‰checkThread()ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°crashã€‚è€Œåœ¨æ‰§è¡Œdismiss()çš„æ—¶å€™ï¼Œå®ƒé¦–å…ˆè¢«æŠ›åˆ°åˆ›å»ºDialogçš„çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œè€ŒåçœŸæ­£é”€æ¯Viewæ—¶ViewRootImplä¼šcheckThread()ï¼Œä¿è¯addViewçš„çº¿ç¨‹æ‰èƒ½removeViewã€‚è€Œåœ¨æ–‡ç« å¼€å¤´å‡ºé”™çš„ä¾‹å­ä¸­ï¼ŒDialogçš„show()æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œnew Dialog()æ˜¯åœ¨workå­çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æŠ›å‡ºäº†CalledFromWrongThreadExceptionçš„å¼‚å¸¸ã€‚ ç»“è®º Dialogçš„dismiss()ä¼šé¦–å…ˆè¢«æŠ›åˆ°new Dialogçš„çº¿ç¨‹ä¸­æ‰§è¡Œã€‚ åªè¦ä¿è¯åˆ›å»ºDialogå’Œshow()æ–¹æ³•åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæ— è®ºæ˜¯åœ¨æ”¾åˆ°uiçº¿ç¨‹è¿˜æ˜¯workå­çº¿ç¨‹éƒ½å¯ä»¥ã€‚ æ¯”å¦‚ï¼ŒæŠŠæ–‡ç« å¼€å¤´çš„ä¾‹å­ä¸­çš„show()æ–¹æ³•åŒæ ·æ”¾åˆ°workçº¿ç¨‹ä¸­ï¼Œå¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œè¾“å‡ºlogå¦‚ä¸‹ï¼š 10-26 19:23:02.603 27689-27760/com.cuc.myandroidtest D/MainActivity test: Dialog create thread: [4213]10-26 19:23:02.686 27689-27760/com.cuc.myandroidtest D/MainActivity test: Dialog show thread: [4213]10-26 19:23:07.243 27689-27760/com.cuc.myandroidtest D/MainActivity test: Dialog onCancel thread: [4213]10-26 19:23:07.243 27689-27760/com.cuc.myandroidtest D/MainActivity test: Dialog onDismiss thread: [4213] ç‰ˆæœ¬å·®å¼‚æ³¨æ„ï¼Œæœ¬æ–‡çš„è¿™ä¸ªCalledFromWrongThreadExceptionå¼‚å¸¸ï¼Œæ˜¯åœ¨4.4ç‰ˆæœ¬åŠä»¥ä¸Šæ‰ä¼šå‡ºç°çš„ã€‚å…·ä½“åŒºåˆ«å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šAndroid4.4DialogUIçº¿ç¨‹CalledFromWrongThreadExcection 4.2ä¸­Dialogçš„dismissDialogå’Œ4.4ä¸­Dialogçš„dismissDialogåŒºåˆ«å¦‚ä¸‹ï¼š 1234//4.2ä¸­Dialogçš„dismissDialogtry &#123; mWindowManager.removeView(mDecor);&#125; 1234//4.4ä¸­Dialogçš„dismissDialogtry &#123; mWindowManager.removeViewImmediate(mDecor);&#125; å‚è€ƒèµ„æ–™ Android4.4DialogUIçº¿ç¨‹CalledFromWrongThreadExcection Androidå¼‚å¸¸ï¼šandroid.view.ViewRootImpl$CalledFromWrongThreadException: Only the original Activity WMS ViewRootImplä¸‰è€…å…³ç³»ï¼ˆActivityåˆ›å»ºçª—å£ æŒ‰é”®åˆ†å‘ç­‰ï¼‰","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€ç®—æ³•ã€‘å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«é—®é¢˜","slug":"ã€ç®—æ³•ã€‘å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«é—®é¢˜","date":"2017-10-18T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/10/18/ã€ç®—æ³•ã€‘å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«é—®é¢˜/","link":"","permalink":"http://github.com/2017/10/18/ã€ç®—æ³•ã€‘å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«é—®é¢˜/","excerpt":"åœ¨ç½‘ä¸Šçœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼šä¸€æ¬¡è°·æ­Œé¢è¯•è¶£äº‹ã€‚è§‰å¾—å…¶ä¸­çš„ç®—æ³•é¢˜ä»¥åŠä½œè€…çš„è§£å†³æ€è·¯å¾ˆæœ‰è¶£ï¼Œå°±æ‹¿æ¥åˆ†äº«ä¸€ä¸‹å§ã€‚ é—®é¢˜å‡è®¾è¿™æœ‰ä¸€ä¸ªå„ç§å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå‡è®¾è¿™è¿˜æœ‰å¦å¤–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸”è¿™ä¸ªå­—ç¬¦ä¸²é‡Œçš„å­—æ¯æ•°ç›¸å¯¹å°‘ä¸€äº›ã€‚ä»ç®—æ³•æ˜¯è®²ï¼Œä»€ä¹ˆæ–¹æ³•èƒ½æœ€å¿«çš„æŸ¥å‡ºæ‰€æœ‰å°å­—ç¬¦ä¸²é‡Œçš„å­—æ¯åœ¨å¤§å­—ç¬¦ä¸²é‡Œéƒ½æœ‰ï¼Ÿ æ¯”å¦‚ï¼Œå¦‚æœæ˜¯ä¸‹é¢ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼š String 1: ABCDEFGHLMNOPQRSString 2: DCGSRQPO ç­”æ¡ˆæ˜¯trueï¼Œæ‰€æœ‰åœ¨String2é‡Œçš„å­—æ¯String1ä¹Ÿéƒ½æœ‰ã€‚å¦‚æœæ˜¯ä¸‹é¢ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼š String 1: ABCDEFGHLMNOPQRSString 2: DCGSRQPZ ç­”æ¡ˆæ˜¯falseï¼Œå› ä¸ºç¬¬äºŒä¸ªå­—ç¬¦ä¸²é‡Œçš„Zå­—æ¯ä¸åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œã€‚","text":"åœ¨ç½‘ä¸Šçœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼šä¸€æ¬¡è°·æ­Œé¢è¯•è¶£äº‹ã€‚è§‰å¾—å…¶ä¸­çš„ç®—æ³•é¢˜ä»¥åŠä½œè€…çš„è§£å†³æ€è·¯å¾ˆæœ‰è¶£ï¼Œå°±æ‹¿æ¥åˆ†äº«ä¸€ä¸‹å§ã€‚ é—®é¢˜å‡è®¾è¿™æœ‰ä¸€ä¸ªå„ç§å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œå‡è®¾è¿™è¿˜æœ‰å¦å¤–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸”è¿™ä¸ªå­—ç¬¦ä¸²é‡Œçš„å­—æ¯æ•°ç›¸å¯¹å°‘ä¸€äº›ã€‚ä»ç®—æ³•æ˜¯è®²ï¼Œä»€ä¹ˆæ–¹æ³•èƒ½æœ€å¿«çš„æŸ¥å‡ºæ‰€æœ‰å°å­—ç¬¦ä¸²é‡Œçš„å­—æ¯åœ¨å¤§å­—ç¬¦ä¸²é‡Œéƒ½æœ‰ï¼Ÿ æ¯”å¦‚ï¼Œå¦‚æœæ˜¯ä¸‹é¢ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼š String 1: ABCDEFGHLMNOPQRSString 2: DCGSRQPO ç­”æ¡ˆæ˜¯trueï¼Œæ‰€æœ‰åœ¨String2é‡Œçš„å­—æ¯String1ä¹Ÿéƒ½æœ‰ã€‚å¦‚æœæ˜¯ä¸‹é¢ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼š String 1: ABCDEFGHLMNOPQRSString 2: DCGSRQPZ ç­”æ¡ˆæ˜¯falseï¼Œå› ä¸ºç¬¬äºŒä¸ªå­—ç¬¦ä¸²é‡Œçš„Zå­—æ¯ä¸åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œã€‚ è§£å†³æ–¹æ¡ˆ1. è½®è¯¢å¯¹äºè¿™ç§æ“ä½œæœ€ç®€å•æœ€å¹¼ç¨šçš„åšæ³•æ˜¯è½®è¯¢ç¬¬äºŒä¸ªå­—ç¬¦ä¸²é‡Œçš„æ¯ä¸ªå­—æ¯ï¼Œçœ‹å®ƒæ˜¯å¦åŒåœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œã€‚ä»ç®—æ³•ä¸Šè®²ï¼Œè¿™éœ€è¦O(n*m)æ¬¡æ“ä½œï¼Œå…¶ä¸­næ˜¯string1çš„é•¿åº¦ï¼Œmæ˜¯string2çš„é•¿åº¦ã€‚å°±æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œæœ€åçš„æƒ…å†µä¸‹å°†ä¼šæœ‰16*8 = 128æ¬¡æ“ä½œã€‚ 2. æ’åºä¸€ä¸ªç¨å¾®å¥½ä¸€ç‚¹çš„æ–¹æ¡ˆæ˜¯å…ˆå¯¹è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å­—æ¯è¿›è¡Œæ’åºï¼Œç„¶ååŒæ—¶å¯¹ä¸¤ä¸ªå­—ä¸²ä¾æ¬¡è½®è¯¢ã€‚ä¸¤ä¸ªå­—ä¸²çš„æ’åºéœ€è¦O(m log m) + O(n log n)æ¬¡æ“ä½œï¼ˆå¸¸è§„æƒ…å†µä¸‹ï¼‰ï¼Œä¹‹åçš„çº¿æ€§æ‰«æéœ€è¦O(m+n)æ¬¡æ“ä½œã€‚åŒæ ·æ‹¿ä¸Šé¢çš„å­—ä¸²åšä¾‹å­ï¼Œå°†ä¼šéœ€è¦164 + 83 = 88åŠ ä¸Šå¯¹ä¸¤ä¸ªå­—ä¸²çº¿æ€§æ‰«æçš„16 + 8 = 24çš„æ“ä½œã€‚ï¼ˆéšç€å­—ä¸²é•¿åº¦çš„å¢é•¿ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªç®—æ³•çš„æ•ˆæœä¼šè¶Šæ¥è¶Šå¥½ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546/** * æ’åºæ–¹æ¡ˆï¼šå¿«é€Ÿæ’åº */public static boolean isSubsetByQuickSort(String a, String b)&#123; char[] ca = a.toCharArray(); char[] cb = b.toCharArray(); quickSort(ca, 0, ca.length - 1); quickSort(cb, 0, cb.length - 1); //å­—ç¬¦ä¸²String1çš„æ¯”è¾ƒæŒ‡é’ˆ int pos = 0; for(char c : cb)&#123; while(pos &lt; ca.length-1 &amp;&amp; ca[pos] &lt; c)&#123; pos++; &#125; if(c != ca[pos])&#123; System.out.println(\"No exist char: \" + c); return false; &#125; &#125; return true;&#125;public static void quickSort(char[] arr, int low, int high)&#123; if(arr.length &lt;= 0) return; if(low &gt;= high) return; int l = low; int r = high; char pivot = arr[l]; while(l &lt; r)&#123; while(l &lt; r &amp;&amp; arr[r] &gt;= pivot)&#123; r--; &#125; arr[l] = arr[r]; while(l &lt; r &amp;&amp; arr[l] &lt;= pivot)&#123; l++; &#125; arr[r] = arr[l]; &#125; arr[l] = pivot; quickSort(arr, low, l - 1); quickSort(arr, l + 1, high);&#125; ä¸è¿‡ï¼Œå¸¸è§„æ’åºæ¯”å¦‚å¿«æ’å¯ä»¥è¾¾åˆ°O(n log n)çš„æ—¶é—´å¤æ‚åº¦ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥é€‰ç”¨ç”¨ç©ºé—´æ¢æ—¶é—´çš„çš„åŸºæ•°æ’åºã€æ¡¶æ’åºç­‰çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„æ’åºç®—æ³•ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// å­—æ¯ç¼–ç [A - z]:[65 - 122]public static final int LETTER_REGION = 122 - 65 + 1;/** * æ’åºæ–¹æ¡ˆï¼šè®¡æ•°æ’åº */public static boolean isSubsetByCounterSort(String a, String b)&#123; char[] ca = a.toCharArray(); char[] cb = b.toCharArray(); ca = counterSort(ca); cb = counterSort(cb); //å­—ç¬¦ä¸²String1çš„æ¯”è¾ƒæŒ‡é’ˆ int pos = 0; for(char c : cb)&#123; while(pos &lt; ca.length-1 &amp;&amp; ca[pos] &lt; c)&#123; pos++; &#125; if(c != ca[pos])&#123; System.out.println(\"No exist char: \" + c); return false; &#125; &#125; return true;&#125;public static char[] counterSort(char[] arr)&#123; int[] bucket = new int[LETTER_REGION]; for(char c : arr)&#123; int index = c - 'A'; bucket[index]++; &#125; for(int i = 1; i &lt; LETTER_REGION; i++)&#123; bucket[i] += bucket[i - 1]; &#125; char[] res = new char[arr.length]; for(char c : arr)&#123; int index = c - 'A'; res[bucket[index] - 1] = c; bucket[index]--; &#125; return res;&#125; 3. å“ˆå¸Œè¡¨å“ˆå¸Œè¡¨Hashtableæ˜¯ä¸€ä¸ªåªéœ€è¦O(n+m)æ¬¡æ“ä½œçš„ç®—æ³•ã€‚æ–¹æ³•å°±æ˜¯ï¼Œå¯¹ç¬¬ä¸€ä¸ªå­—ä¸²è¿›è¡Œè½®è¯¢ï¼ŒæŠŠå…¶ä¸­çš„æ¯ä¸ªå­—æ¯éƒ½æ”¾å…¥ä¸€ä¸ªHashtableé‡Œï¼ˆæ—¶é—´æˆæœ¬æ˜¯O(n)ï¼Œè¿™é‡Œæ˜¯16æ¬¡æ“ä½œï¼‰ã€‚ç„¶åè½®è¯¢ç¬¬äºŒä¸ªå­—ä¸²ï¼Œåœ¨Hashtableé‡ŒæŸ¥è¯¢æ¯ä¸ªå­—æ¯ï¼Œçœ‹èƒ½å¦æ‰¾åˆ°ã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œè¯´æ˜æ²¡æœ‰åŒ¹é…æˆåŠŸã€‚è¿™å°†æ¶ˆè€—æ‰8æ¬¡æ“ä½œ â€”â€” è¿™æ ·ä¸¤é¡¹æ“ä½œåŠ èµ·æ¥ä¸€å…±åªæœ‰24æ¬¡ã€‚ä¸é”™å§ï¼Œæ¯”å‰é¢ä¸¤ç§æ–¹æ¡ˆéƒ½è¦å¥½ã€‚ 123456789101112131415161718/** * å“ˆå¸Œè¡¨Hashset */public static boolean isSubsetByHashset(String a, String b)&#123; char[] ca = a.toCharArray(); char[] cb = b.toCharArray(); HashSet&lt;Character&gt; set = new HashSet&lt;Character&gt;(); for(char c : ca)&#123; set.add(c); &#125; for(char c : cb)&#123; if(!set.contains(c))&#123; return false; &#125; &#125; return true;&#125; 4ã€Bitmapä½å›¾æ³•è¿™ä¸ªè§£å†³æ–¹æ¡ˆæ€æƒ³å’ŒHashtableä¸€è‡´ï¼Œåªä¸è¿‡ä½¿ç”¨çš„æ˜¯ä½å›¾æ³•æ¥ä¸ºæ¯ä¸€ä¸ªå­—ç¬¦ä¿ç•™ä¸€ä½ã€‚åŒæ ·åªéœ€è¦O(n+m)æ¬¡æ“ä½œã€‚ 12345678910111213141516171819202122232425262728293031323334353637// å­—æ¯ç¼–ç åŒºé—´[A - z]:[65 - 122]public static final int LETTER_REGION = 122 - 65 + 1;/** * æ¯”ç‰¹ä½æ–¹æ¡ˆ */public static boolean isSubsetByBitmap(String a, String b)&#123; char[] ca = a.toCharArray(); char[] cb = b.toCharArray(); byte[] bitmap = new byte[LETTER_REGION / Byte.SIZE]; for(char c : ca)&#123; setBit(bitmap, c - 'A'); &#125; for(char c : cb)&#123; if(getBit(bitmap, c - 'A') == 0)&#123; System.out.println(\"No exist char in Bitmap: \" + c); return false; &#125; &#125; return true;&#125;/** * å†™å…¥æŒ‡å®šä½çš„æ¯”ç‰¹ */public static void setBit(byte bitmap[], int k)&#123; bitmap[k / Byte.SIZE] |= (1 &lt;&lt; (k % Byte.SIZE));&#125;/** * è¯»å–æŒ‡å®šä½çš„æ¯”ç‰¹ */public static int getBit(byte bitmap[], int k)&#123; return (bitmap[k / Byte.SIZE] &amp; (1 &lt;&lt; (k % Byte.SIZE)));&#125; åˆ°æ­¤ä¸ºæ­¢ï¼ŒO(n+m)å‡ ä¹æ˜¯ä½ èƒ½å¾—åˆ°çš„æœ€å¥½çš„ç»“æœäº†ï¼Œå› ä¸ºè‡³å°‘è¦å¯¹æ¯ä¸ªå­—æ¯è‡³å°‘è®¿é—®ä¸€æ¬¡æ‰èƒ½å®Œæˆè¿™é¡¹æ“ä½œï¼Œè€Œä¸Šè¿°è¿™ä¸¤ä¸ªæ–¹æ¡ˆæ˜¯åˆšå¥½æ˜¯å¯¹æ¯ä¸ªå­—æ¯åªè®¿é—®ä¸€æ¬¡ã€‚ä¸‹é¢çœ‹çœ‹æ–‡ç« ä¸­æœ€åçš„è¿™ä¸ªç´ æ•°æ–¹æ¡ˆã€‚ 5. ç´ æ•°å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸€å®šä¸ªæ•°çš„å­—æ¯ç»„æˆå­—ä¸²ã€‚æˆ‘ç»™æ¯ä¸ªå­—æ¯åˆ†é…ä¸€ä¸ªç´ æ•°ï¼Œä»2å¼€å§‹ï¼Œå¾€åç±»æ¨ã€‚è¿™æ ·Aå°†ä¼šæ˜¯2ï¼ŒBå°†ä¼šæ˜¯3ï¼ŒCå°†ä¼šæ˜¯5ï¼Œç­‰ç­‰ã€‚ç°åœ¨æˆ‘éå†ç¬¬ä¸€ä¸ªå­—ä¸²ï¼ŒæŠŠæ¯ä¸ªå­—æ¯ä»£è¡¨çš„ç´ æ•°ç›¸ä¹˜ã€‚æœ€ç»ˆä¼šå¾—åˆ°ä¸€ä¸ªå¾ˆå¤§çš„æ•´æ•°ï¼Œå¯¹å§ï¼Ÿç„¶å â€”â€” è½®è¯¢ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ï¼Œç”¨æ¯ä¸ªå­—æ¯é™¤å®ƒã€‚å¦‚æœé™¤çš„ç»“æœæœ‰ä½™æ•°ï¼Œè¿™è¯´æ˜æœ‰ä¸åŒ¹é…çš„å­—æ¯ã€‚å¦‚æœæ•´ä¸ªè¿‡ç¨‹ä¸­æ²¡æœ‰ä½™æ•°ï¼Œä½ åº”è¯¥çŸ¥é“å®ƒæ˜¯ç¬¬ä¸€ä¸ªå­—ä¸²æ°å¥½çš„å­é›†äº†ã€‚è¿™æ ·ä¸è¡Œå—ï¼Ÿ 12345678910111213141516171819202122232425262728293031323334public static int primes[] = &#123; 2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103, 107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211, 223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331, 337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449, 457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587, 593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709, 719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853, 857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991&#125;;// å­—æ¯ç¼–ç åŒºé—´[A - z]:[65 - 122]public static final int LETTER_REGION = 122 - 65 + 1;/** * ç´ æ•°æ–¹æ¡ˆ */public static boolean isSubsetByPrimeNumber(String a, String b)&#123; char[] ca = a.toCharArray(); char[] cb = b.toCharArray(); // é˜²æ­¢ä¹˜ç§¯intæº¢å‡ºï¼Œä½¿ç”¨BigIntegerå­˜å‚¨ä¹˜ç§¯ç»“æœ BigInteger p = BigInteger.ONE; for(char c : ca)&#123; p = p.multiply(BigInteger.valueOf(primes[c - 'A'])); &#125; System.out.println(\"ä¹˜ç§¯ç»“æœp = \" + p.toString()); for(char c : cb)&#123; if(!p.remainder(BigInteger.valueOf(primes[c - 'A'])).equals(BigInteger.ZERO))&#123; System.out.println(\"No exist char: \" + c); return false; &#125; &#125; return true;&#125; æµ‹è¯•ä»£ç 12345678910111213141516171819202122232425public class CharacterSubset &#123; /** * å‡è®¾ä½ æœ‰ä¸€ä¸ªä¸€å®šé•¿åº¦çš„ç”±å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ã€‚ä½ è¿˜æœ‰å¦å¤–ä¸€ä¸ªï¼ŒçŸ­äº›ã€‚ä½ å¦‚ä½•æ‰èƒ½çŸ¥é“æ‰€æœ‰çš„åœ¨è¾ƒçŸ­çš„å­—ç¬¦ä¸²é‡Œçš„å­—æ¯åœ¨é•¿å­—ç¬¦ä¸²é‡Œä¹Ÿæœ‰ï¼Ÿ */ public static void main(String args[])&#123; String a1 = \"ABCDEFGHLMNOPQRS\"; String b1 = \"DCGSRQPOM\"; String a2 = \"ABCDEFGHLMNOPQRS\"; String b2 = \"DCGSRQPOZ\"; System.out.println(\"\\na1 and b1: \" + isSubsetByQuickSort(a1, b1)); System.out.println(\"\\na2 and b2: \" + isSubsetByQuickSort(a2, b2)); System.out.println(\"\\na1 and b1: \" + isSubsetByCounterSort(a1, b1)); System.out.println(\"\\na2 and b2: \" + isSubsetByCounterSort(a2, b2)); System.out.println(\"\\na1 and b1: \" + isSubsetByHashset(a1, b1)); System.out.println(\"\\na2 and b2: \" + isSubsetByHashset(a2, b2)); System.out.println(\"\\na1 and b1: \" + isSubsetByPrimeNumber(a1, b1)); System.out.println(\"\\na2 and b2: \" + isSubsetByPrimeNumber(a2, b2)); System.out.println(\"\\na1 and b1: \" + isSubsetByBitmap(a1, b1)); System.out.println(\"\\na2 and b2: \" + isSubsetByBitmap(a2, b2)); &#125;&#125; æ€»ç»“å°±å¦‚æ–‡ç« ä¸­æ‰€è¯´ï¼Œç´ æ•°æ–¹æ¡ˆåœ¨ç®—æ³•ä¸Šå¹¶ä¸èƒ½è¯´å°±æ¯”å“ˆå¸Œè¡¨å¥½ã€‚è€Œä¸”åœ¨å®é™…æ“ä½œä¸­ï¼Œä½ å¾ˆå¯èƒ½ä»ä¼šä½¿ç”¨å“ˆå¸Œè¡¨çš„æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒæ›´é€šç”¨ï¼Œæ— éœ€è·Ÿéº»çƒ¦çš„å¤§å‹æ•°å­—æ‰“äº¤é“ã€‚ä½†ä»â€å·§å¦™æ°´å¹³â€œä¸Šè®²ï¼ŒGuyæä¾›çš„ç´ æ•°æ–¹æ¡ˆæ˜¯ä¸€ç§æ›´ã€æ›´ã€æ›´æœ‰è¶£çš„æ–¹æ¡ˆã€‚ å‚è€ƒèµ„æ–™ ä¸€æ¬¡è°·æ­Œé¢è¯•è¶£äº‹ ç¨‹åºå‘˜ç¼–ç¨‹è‰ºæœ¯ï¼šç¬¬äºŒç« ã€å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«é—®é¢˜","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Androidã€‘æºç åˆ†æ - AsyncTaskå¼‚æ­¥ä»»åŠ¡æœºåˆ¶","slug":"ã€Androidã€‘æºç åˆ†æ - AsyncTaskå¼‚æ­¥ä»»åŠ¡æœºåˆ¶","date":"2017-10-09T12:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/10/09/ã€Androidã€‘æºç åˆ†æ - AsyncTaskå¼‚æ­¥ä»»åŠ¡æœºåˆ¶/","link":"","permalink":"http://github.com/2017/10/09/ã€Androidã€‘æºç åˆ†æ - AsyncTaskå¼‚æ­¥ä»»åŠ¡æœºåˆ¶/","excerpt":"å‰è¨€æåˆ°Androidçš„å¤šçº¿ç¨‹æœºåˆ¶ï¼Œå¸¸ç”¨çš„æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š AsyncTask: å°è£…äº†çº¿ç¨‹æ± å’ŒHandlerï¼Œä¸º UI çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹ä¹‹é—´è¿›è¡Œå¿«é€Ÿåˆ‡æ¢æä¾›ä¸€ç§ä¾¿æ·æœºåˆ¶ã€‚é€‚ç”¨äºå½“ä¸‹ç«‹å³éœ€è¦å¯åŠ¨ï¼Œä½†æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸçŸ­æš‚çš„ä½¿ç”¨åœºæ™¯ã€‚ HandlerThread: ä¸€ä¸ªå·²ç»æ‹¥æœ‰äº†Looperçš„çº¿ç¨‹ç±»ï¼Œå†…éƒ¨å¯ä»¥ç›´æ¥ä½¿ç”¨Handlerã€‚ä¸ºæŸäº›å›è°ƒæ–¹æ³•æˆ–è€…ç­‰å¾…æŸäº›ä»»åŠ¡çš„æ‰§è¡Œè®¾ç½®ä¸€ä¸ªä¸“å±çš„çº¿ç¨‹ï¼Œå¹¶æä¾›çº¿ç¨‹ä»»åŠ¡çš„è°ƒåº¦æœºåˆ¶ã€‚ ThreadPool: æŠŠä»»åŠ¡åˆ†è§£æˆä¸åŒçš„å•å…ƒï¼Œåˆ†å‘åˆ°å„ä¸ªä¸åŒçš„çº¿ç¨‹ä¸Šï¼Œè¿›è¡ŒåŒæ—¶å¹¶å‘å¤„ç†ã€‚ IntentService: é€‚åˆäºæ‰§è¡Œç”± UI è§¦å‘çš„åå° Service ä»»åŠ¡ï¼Œå¹¶å¯ä»¥æŠŠåå°ä»»åŠ¡æ‰§è¡Œçš„æƒ…å†µé€šè¿‡ä¸€å®šçš„æœºåˆ¶åé¦ˆç»™ UIã€‚ å°½ç®¡Androidå·²ç»è®¾è®¡äº†åŸºæœ¬çš„Handlerå¼‚æ­¥æ¶ˆæ¯æœºåˆ¶æä¾›ç»™æˆ‘ä»¬è¿›è¡Œçº¿ç¨‹é—´é€šä¿¡ï¼Œä¸è¿‡å¯¹äºé¢‘ç¹å¾—UIæ›´æ–°æ“ä½œHandlerç”¨èµ·æ¥ç¡®å®æœ‰ç‚¹ç»†ç¢ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿æˆ‘ä»¬åœ¨å­çº¿ç¨‹ä¸­æ›´æ–°UIå…ƒç´ ï¼ŒAndroidä»1.5ç‰ˆæœ¬å°±å¼•å…¥äº†ä¸€ä¸ªAsyncTaskç±»ï¼Œä½¿ç”¨å®ƒæˆ‘ä»¬å¯ä»¥éå¸¸çµæ´»æ–¹ä¾¿åœ°ä»å­çº¿ç¨‹åˆ‡æ¢åˆ°UIçº¿ç¨‹ã€‚ æˆ‘ä»¬å°±ä»AsyncTaskçš„åŸºæœ¬ç”¨æ³•å¼€å§‹ï¼Œä¸€èµ·åˆ†æä¸‹AsyncTaskæºç ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®ç°çš„ã€‚ ä½¿ç”¨AsyncTaskç”±äºAsyncTaskæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨å®ƒï¼Œå°±å¿…é¡»è¦åˆ›å»ºä¸€ä¸ªå­ç±»å»ç»§æ‰¿å®ƒã€‚åœ¨ç»§æ‰¿æ—¶æˆ‘ä»¬å¯ä»¥ä¸ºAsyncTaskç±»æŒ‡å®šä¸‰ä¸ªæ³›å‹å‚æ•°ï¼Œè¿™ä¸‰ä¸ªå‚æ•°çš„ç”¨é€”å¦‚ä¸‹ï¼š Paramsï¼šåœ¨æ‰§è¡ŒAsyncTaskæ—¶éœ€è¦ä¼ å…¥çš„å‚æ•°ï¼Œå¯ç”¨äºåœ¨åå°ä»»åŠ¡ä¸­ä½¿ç”¨ã€‚ Progressï¼šåå°ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œå¦‚æœéœ€è¦åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºå½“å‰çš„è¿›åº¦ï¼Œåˆ™ä½¿ç”¨è¿™é‡ŒæŒ‡å®šçš„æ³›å‹ä½œä¸ºè¿›åº¦å•ä½ã€‚ Resultï¼šå½“ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå¦‚æœéœ€è¦å¯¹ç»“æœè¿›è¡Œè¿”å›ï¼Œåˆ™ä½¿ç”¨è¿™é‡ŒæŒ‡å®šçš„æ³›å‹ä½œä¸ºè¿”å›å€¼ç±»å‹ã€‚ ä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰AsyncTaskå°±å¯ä»¥å†™æˆå¦‚ä¸‹æ–¹å¼ï¼š 1private class MyTask extends AsyncTask&lt;Void, Void, Void&gt; &#123; ... &#125;","text":"å‰è¨€æåˆ°Androidçš„å¤šçº¿ç¨‹æœºåˆ¶ï¼Œå¸¸ç”¨çš„æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š AsyncTask: å°è£…äº†çº¿ç¨‹æ± å’ŒHandlerï¼Œä¸º UI çº¿ç¨‹ä¸å·¥ä½œçº¿ç¨‹ä¹‹é—´è¿›è¡Œå¿«é€Ÿåˆ‡æ¢æä¾›ä¸€ç§ä¾¿æ·æœºåˆ¶ã€‚é€‚ç”¨äºå½“ä¸‹ç«‹å³éœ€è¦å¯åŠ¨ï¼Œä½†æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ç”Ÿå‘½å‘¨æœŸçŸ­æš‚çš„ä½¿ç”¨åœºæ™¯ã€‚ HandlerThread: ä¸€ä¸ªå·²ç»æ‹¥æœ‰äº†Looperçš„çº¿ç¨‹ç±»ï¼Œå†…éƒ¨å¯ä»¥ç›´æ¥ä½¿ç”¨Handlerã€‚ä¸ºæŸäº›å›è°ƒæ–¹æ³•æˆ–è€…ç­‰å¾…æŸäº›ä»»åŠ¡çš„æ‰§è¡Œè®¾ç½®ä¸€ä¸ªä¸“å±çš„çº¿ç¨‹ï¼Œå¹¶æä¾›çº¿ç¨‹ä»»åŠ¡çš„è°ƒåº¦æœºåˆ¶ã€‚ ThreadPool: æŠŠä»»åŠ¡åˆ†è§£æˆä¸åŒçš„å•å…ƒï¼Œåˆ†å‘åˆ°å„ä¸ªä¸åŒçš„çº¿ç¨‹ä¸Šï¼Œè¿›è¡ŒåŒæ—¶å¹¶å‘å¤„ç†ã€‚ IntentService: é€‚åˆäºæ‰§è¡Œç”± UI è§¦å‘çš„åå° Service ä»»åŠ¡ï¼Œå¹¶å¯ä»¥æŠŠåå°ä»»åŠ¡æ‰§è¡Œçš„æƒ…å†µé€šè¿‡ä¸€å®šçš„æœºåˆ¶åé¦ˆç»™ UIã€‚ å°½ç®¡Androidå·²ç»è®¾è®¡äº†åŸºæœ¬çš„Handlerå¼‚æ­¥æ¶ˆæ¯æœºåˆ¶æä¾›ç»™æˆ‘ä»¬è¿›è¡Œçº¿ç¨‹é—´é€šä¿¡ï¼Œä¸è¿‡å¯¹äºé¢‘ç¹å¾—UIæ›´æ–°æ“ä½œHandlerç”¨èµ·æ¥ç¡®å®æœ‰ç‚¹ç»†ç¢ï¼Œä¸ºäº†æ›´åŠ æ–¹ä¾¿æˆ‘ä»¬åœ¨å­çº¿ç¨‹ä¸­æ›´æ–°UIå…ƒç´ ï¼ŒAndroidä»1.5ç‰ˆæœ¬å°±å¼•å…¥äº†ä¸€ä¸ªAsyncTaskç±»ï¼Œä½¿ç”¨å®ƒæˆ‘ä»¬å¯ä»¥éå¸¸çµæ´»æ–¹ä¾¿åœ°ä»å­çº¿ç¨‹åˆ‡æ¢åˆ°UIçº¿ç¨‹ã€‚ æˆ‘ä»¬å°±ä»AsyncTaskçš„åŸºæœ¬ç”¨æ³•å¼€å§‹ï¼Œä¸€èµ·åˆ†æä¸‹AsyncTaskæºç ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®ç°çš„ã€‚ ä½¿ç”¨AsyncTaskç”±äºAsyncTaskæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨å®ƒï¼Œå°±å¿…é¡»è¦åˆ›å»ºä¸€ä¸ªå­ç±»å»ç»§æ‰¿å®ƒã€‚åœ¨ç»§æ‰¿æ—¶æˆ‘ä»¬å¯ä»¥ä¸ºAsyncTaskç±»æŒ‡å®šä¸‰ä¸ªæ³›å‹å‚æ•°ï¼Œè¿™ä¸‰ä¸ªå‚æ•°çš„ç”¨é€”å¦‚ä¸‹ï¼š Paramsï¼šåœ¨æ‰§è¡ŒAsyncTaskæ—¶éœ€è¦ä¼ å…¥çš„å‚æ•°ï¼Œå¯ç”¨äºåœ¨åå°ä»»åŠ¡ä¸­ä½¿ç”¨ã€‚ Progressï¼šåå°ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œå¦‚æœéœ€è¦åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºå½“å‰çš„è¿›åº¦ï¼Œåˆ™ä½¿ç”¨è¿™é‡ŒæŒ‡å®šçš„æ³›å‹ä½œä¸ºè¿›åº¦å•ä½ã€‚ Resultï¼šå½“ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå¦‚æœéœ€è¦å¯¹ç»“æœè¿›è¡Œè¿”å›ï¼Œåˆ™ä½¿ç”¨è¿™é‡ŒæŒ‡å®šçš„æ³›å‹ä½œä¸ºè¿”å›å€¼ç±»å‹ã€‚ ä¸€ä¸ªæœ€ç®€å•çš„è‡ªå®šä¹‰AsyncTaskå°±å¯ä»¥å†™æˆå¦‚ä¸‹æ–¹å¼ï¼š 1private class MyTask extends AsyncTask&lt;Void, Void, Void&gt; &#123; ... &#125; ç„¶åæˆ‘ä»¬è¿˜éœ€è¦å»é‡å†™AsyncTaskä¸­çš„å‡ ä¸ªæ–¹æ³•æ‰èƒ½å®Œæˆå¯¹ä»»åŠ¡çš„å®šåˆ¶ã€‚ç»å¸¸éœ€è¦å»é‡å†™çš„æ–¹æ³•æœ‰ä»¥ä¸‹å››ä¸ªï¼š onPreExecute()ï¼šä¸€èˆ¬ä¼šåœ¨UI Threadä¸­æ‰§è¡Œã€‚ç”¨äºè¿›è¡Œä¸€äº›ç•Œé¢ä¸Šçš„åˆå§‹åŒ–æ“ä½œï¼Œæ¯”å¦‚æ˜¾ç¤ºä¸€ä¸ªè¿›åº¦æ¡å¯¹è¯æ¡†ç­‰ã€‚ doInBackground(Paramsâ€¦)ï¼šè¿™ä¸ªæ–¹æ³•ä¸­çš„æ‰€æœ‰ä»£ç éƒ½ä¼šåœ¨å­çº¿ç¨‹Worker Threadä¸­è¿è¡Œï¼Œæˆ‘ä»¬åº”è¯¥åœ¨è¿™é‡Œå»å¤„ç†æ‰€æœ‰çš„è€—æ—¶ä»»åŠ¡ã€‚ä»»åŠ¡ä¸€æ—¦å®Œæˆå°±å¯ä»¥é€šè¿‡returnè¯­å¥æ¥å°†ä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿›è¡Œè¿”å›ï¼Œå¦‚æœAsyncTaskçš„ç¬¬ä¸‰ä¸ªæ³›å‹å‚æ•°æŒ‡å®šçš„æ˜¯Voidï¼Œå°±å¯ä»¥ä¸è¿”å›ä»»åŠ¡æ‰§è¡Œç»“æœã€‚æ³¨æ„ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­æ˜¯ä¸å¯ä»¥è¿›è¡ŒUIæ“ä½œçš„ï¼Œå¦‚æœéœ€è¦æ›´æ–°UIå…ƒç´ ï¼Œæ¯”å¦‚è¯´åé¦ˆå½“å‰ä»»åŠ¡çš„æ‰§è¡Œè¿›åº¦ï¼Œå¯ä»¥è°ƒç”¨publishProgress(Progress...)æ–¹æ³•æ¥å®Œæˆã€‚ onProgressUpdate(Progressâ€¦)ï¼šåœ¨UI Threadä¸­æ‰§è¡Œã€‚å½“åœ¨åå°ä»»åŠ¡ä¸­è°ƒç”¨äº†publishProgress(Progress...)æ–¹æ³•åï¼Œè¿™ä¸ªæ–¹æ³•éšåå°±ä¼šè¢«è°ƒç”¨ï¼Œæ–¹æ³•ä¸­æºå¸¦çš„å‚æ•°å°±æ˜¯åœ¨åå°ä»»åŠ¡ä¸­ä¼ é€’è¿‡æ¥çš„ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥å¯¹UIè¿›è¡Œæ“ä½œï¼Œåˆ©ç”¨å‚æ•°ä¸­çš„æ•°å€¼å°±å¯ä»¥å¯¹ç•Œé¢å…ƒç´ è¿›è¡Œç›¸åº”çš„æ›´æ–°ã€‚ onPostExecute(Result)ï¼šåœ¨UI Threadä¸­æ‰§è¡Œã€‚å½“åå°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•å¹¶é€šè¿‡returnè¯­å¥è¿›è¡Œè¿”å›æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•å°±å¾ˆå¿«ä¼šè¢«è°ƒç”¨ã€‚è¿”å›çš„æ•°æ®ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°æ­¤æ–¹æ³•ä¸­ï¼Œå¯ä»¥åˆ©ç”¨è¿”å›çš„æ•°æ®æ¥è¿›è¡Œä¸€äº›UIæ“ä½œï¼Œæ¯”å¦‚å¼¹å‡ºToastæé†’ä»»åŠ¡æ‰§è¡Œçš„ç»“æœï¼Œä»¥åŠå…³é—­æ‰è¿›åº¦æ¡å¯¹è¯æ¡†ç­‰ã€‚ ç‰¹åˆ«è¯´æ˜ï¼onPreExecuteå¹¶ä¸ä¿è¯ä¸€å®šåœ¨UIçº¿ç¨‹ä¸­æ‰§è¡Œï¼æˆ‘ä»¬ç¨åæºç åˆ†ææ—¶è¯´æ˜ ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„è‡ªå®šä¹‰AsyncTaskå°±å¯ä»¥å†™æˆå¦‚ä¸‹æ–¹å¼ï¼š 123456789101112131415161718192021222324252627282930private class DownloadFilesTask extends AsyncTask&lt;URL, Integer, Long&gt; &#123; @Override protected void onPreExecute() &#123; progressDialog.show(); &#125; @Override protected Long doInBackground(URL... urls) &#123; int count = urls.length; long totalSize = 0; for (int i = 0; i &lt; count; i++) &#123; totalSize += Downloader.downloadFile(urls[i]); //æ›´æ–°è¿›åº¦ publishProgress((int) ((i / (float) count) * 100)); // Escape early if cancel() is called if (isCancelled()) break; &#125; return totalSize; &#125; @Override protected void onProgressUpdate(Integer... progress) &#123; progressDialog.setMessage(\"å½“å‰ä¸‹è½½è¿›åº¦ï¼š\" + progress[0] + \"%\"); &#125; @Override protected void onPostExecute(Long result) &#123; showDialog(\"ä¸‹è½½å·²å®Œæˆï¼Downloaded \" + result + \" bytes\"); &#125;&#125; ç„¶åï¼Œè°ƒç”¨execute()æ‰§è¡Œä»»åŠ¡å°±å¯ä»¥äº†ï¼š 1new DownloadFilesTask().execute(url1, url2, url3); ä»¥ä¸Šå°±æ˜¯AsyncTaskçš„åŸºæœ¬ç”¨æ³•ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å»è€ƒè™‘ä»€ä¹ˆå¼‚æ­¥æ¶ˆæ¯å¤„ç†æœºåˆ¶ï¼Œä¹Ÿä¸éœ€è¦ä¸“é—¨ä½¿ç”¨ä¸€ä¸ªHandleræ¥å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ï¼Œåªéœ€è¦è°ƒç”¨ä¸€ä¸‹publishProgress()æ–¹æ³•å°±å¯ä»¥è½»æ¾åœ°ä»å­çº¿ç¨‹åˆ‡æ¢åˆ°UIçº¿ç¨‹äº†ã€‚ AsyncTaskæºç é¦–å…ˆæé†’ä¸€ä¸‹å¤§å®¶ï¼Œè¯¥ç‰ˆæœ¬åˆ†æçš„ä»£ç æ˜¯Android API 21ï¼ˆå¯¹åº”çš„Android 5.0ï¼‰çš„æºç ï¼Œç”±äºAsyncTaskåœ¨ä¹‹å‰å‡ ä¸ªç‰ˆæœ¬æ”¹åŠ¨æ¯”è¾ƒå¤§ï¼Œä¸è¿‡ä¸å½±å“æˆ‘ä»¬åˆ†æåŸç†ï¼Œæ‰€ä»¥æœ€åæˆ‘å°½é‡ä»‹ç»ä¸€ä¸‹åŒºåˆ«ã€‚ AsyncTaskçš„æºç é“¾æ¥ï¼šhttps://github.com/android/platform_frameworks_base/blob/master/core/java/android/os/AsyncTask.java å¯ä»¥çœ‹åˆ°AsyncTaskå¼€å¤´å®šä¹‰äº†ä¸€äº›å­—æ®µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223242526272829private static final String LOG_TAG = \"AsyncTask\";//CPU_COUNTä¸ºæ‰‹æœºä¸­çš„CPUæ ¸æ•°private static final int CPU_COUNT = Runtime.getRuntime().availableProcessors();//çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°private static final int CORE_POOL_SIZE = CPU_COUNT + 1;//çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°private static final int MAXIMUM_POOL_SIZE = CPU_COUNT * 2 + 1;//åŒä¸€æ—¶åˆ»åªå…è®¸1ä¸ªçº¿ç¨‹æ‰§è¡Œprivate static final int KEEP_ALIVE = 1;//sThreadFactoryç”¨äºåœ¨åé¢åˆ›å»ºçº¿ç¨‹æ± private static final ThreadFactory sThreadFactory = new ThreadFactory() &#123; private final AtomicInteger mCount = new AtomicInteger(1); //é‡å†™newThreadæ–¹æ³•: ä¸ºäº†å°†æ–°å¢çº¿ç¨‹çš„åå­—ä»¥\"AsyncTask #\"æ ‡è¯† public Thread newThread(Runnable r) &#123; return new Thread(r, \"AsyncTask #\" + mCount.getAndIncrement()); &#125;&#125;;//å®ä¾‹åŒ–é˜»å¡å¼é˜Ÿåˆ—BlockingQueueï¼Œé˜Ÿåˆ—ä¸­å­˜æ”¾Runnableï¼Œå®¹é‡ä¸º128private static final BlockingQueue&lt;Runnable&gt; sPoolWorkQueue = new LinkedBlockingQueue&lt;Runnable&gt;(128);//æ ¹æ®ä¸Šé¢å®šä¹‰çš„å‚æ•°å®ä¾‹åŒ–çº¿ç¨‹æ± public static final Executor THREAD_POOL_EXECUTOR = new ThreadPoolExecutor(CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE, TimeUnit.SECONDS, sPoolWorkQueue, sThreadFactory); é€šè¿‡ä»¥ä¸Šä»£ç å’Œæ³¨é‡Šæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒAsyncTaskåˆå§‹åŒ–äº†ä¸€äº›å‚æ•°ï¼Œå¹¶ç”¨è¿™äº›å‚æ•°å®ä¾‹åŒ–äº†ä¸€ä¸ªçº¿ç¨‹æ± THREAD_POOL_EXECUTORï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¯¥çº¿ç¨‹æ± è¢«å®šä¹‰ä¸ºpublic static finalï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡ºAsyncTaskå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªé™æ€çš„çº¿ç¨‹æ± ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒAsyncTaskçš„å®é™…å·¥ä½œå°±æ˜¯é€šè¿‡è¯¥THREAD_POOL_EXECUTORå®Œæˆçš„ã€‚ æ„é€ å‡½æ•°æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹AsyncTaskçš„æ„é€ å‡½æ•°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940public abstract class AsyncTask&lt;Params, Progress, Result&gt; &#123; private final WorkerRunnable&lt;Params, Result&gt; mWorker; private final FutureTask&lt;Result&gt; mFuture; /** * Creates a new asynchronous task. This constructor must be invoked on the UI thread. */ public AsyncTask() &#123; //å®ä¾‹åŒ–mWorkerï¼Œå®ç°äº†Callableæ¥å£çš„callæ–¹æ³• mWorker = new WorkerRunnable&lt;Params, Result&gt;() &#123; public Result call() throws Exception &#123; mTaskInvoked.set(true); Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND); //åœ¨çº¿ç¨‹æ± çš„å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡ŒdoInBackgroundæ–¹æ³•ï¼Œæ‰§è¡Œå®Œçš„ç»“æœä¼ é€’ç»™postResultæ–¹æ³• return postResult(doInBackground(mParams)); &#125; &#125;; //ç”¨mWorkerå®ä¾‹åŒ–mFuture mFuture = new FutureTask&lt;Result&gt;(mWorker) &#123; @Override protected void done() &#123; try &#123; postResultIfNotInvoked(get()); &#125; catch (InterruptedException e) &#123; android.util.Log.w(LOG_TAG, e); &#125; catch (ExecutionException e) &#123; throw new RuntimeException(\"An error occured while executing doInBackground()\", e.getCause()); &#125; catch (CancellationException e) &#123; postResultIfNotInvoked(null); &#125; &#125; &#125;; &#125; ...çœç•¥å…¶ä»–ä»£ç ...&#125; é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°AsyncTaskæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚åœ¨æ„é€ å‡½æ•°ä¸Šæœ‰ä¸€å¥æ³¨é‡Šè¯´ï¼šAsyncTaskçš„æ„é€ å‡½æ•°éœ€è¦åœ¨UIçº¿ç¨‹ä¸Šè°ƒç”¨ï¼Œè¨€å¤–ä¹‹æ„ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¿…é¡»åœ¨ä¸»çº¿ç¨‹ä¸­newåˆ›å»ºAsyncTaskå¯¹è±¡ã€‚ ç„¶åæ„é€ å‡½æ•°ä¸­å®é™…ä¸Šå¹¶æ²¡æœ‰ä»»ä½•å…·ä½“çš„é€»è¾‘ä¼šå¾—åˆ°æ‰§è¡Œï¼Œåªæ˜¯åˆå§‹åŒ–äº†ä¸¤ä¸ªå˜é‡ï¼ŒmWorkerå’ŒmFutureï¼Œå¹¶åœ¨åˆå§‹åŒ–mFutureçš„æ—¶å€™å°†mWorkerä½œä¸ºå‚æ•°ä¼ å…¥ã€‚mWorkeræ˜¯ä¸€ä¸ªCallableå¯¹è±¡ï¼ŒmFutureæ˜¯ä¸€ä¸ªFutureTaskå¯¹è±¡ï¼Œè¿™ä¸¤ä¸ªå˜é‡ä¼šæš‚æ—¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç¨åæ‰ä¼šç”¨åˆ°å®ƒä»¬ã€‚ mWorkeræ˜¯WorkerRunnableç±»å‹çš„å¯¹è±¡ï¼ŒWorkerRunnableæ˜¯AsyncTaskä¸­çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 123private static abstract class WorkerRunnable&lt;Params, Result&gt; implements Callable&lt;Result&gt; &#123; Params[] mParams;&#125; mWorker ï¼šä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒmWorkerå…¶å®æ˜¯ä¸€ä¸ªCallableç±»å‹çš„å¯¹è±¡ã€‚å®ä¾‹åŒ–mWorkerï¼Œå®ç°äº†Callableæ¥å£çš„callæ–¹æ³•ã€‚callæ–¹æ³•æ˜¯åœ¨çº¿ç¨‹æ± çš„æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œè€Œä¸æ˜¯è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸­ã€‚åœ¨çº¿ç¨‹æ± çš„å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡ŒdoInBackgroundæ–¹æ³•ï¼Œæ‰§è¡Œå®é™…çš„ä»»åŠ¡ï¼Œå¹¶è¿”å›ç»“æœã€‚å½“doInBackgroundæ‰§è¡Œå®Œæ¯•åï¼Œå°†æ‰§è¡Œå®Œçš„ç»“æœä¼ é€’ç»™postResultæ–¹æ³•ã€‚postResultæ–¹æ³•æˆ‘ä»¬åé¢ä¼šå†è®²è§£ã€‚ mFuture ï¼šmFutureæ˜¯ä¸€ä¸ªFutureTaskç±»å‹çš„å¯¹è±¡ï¼Œç”¨mWorkerä½œä¸ºå‚æ•°å®ä¾‹åŒ–äº†mFutureã€‚åœ¨è¿™é‡Œï¼Œå…¶å®ç°äº†FutureTaskçš„doneæ–¹æ³•ï¼Œæˆ‘ä»¬ä¹‹å‰æåˆ°ï¼Œå½“FutureTaskçš„ä»»åŠ¡æ‰§è¡Œå®Œæˆæˆ–ä»»åŠ¡å–æ¶ˆçš„æ—¶å€™ä¼šæ‰§è¡ŒFutureTaskçš„doneæ–¹æ³•ã€‚doneæ–¹æ³•é‡Œé¢çš„é€»è¾‘æˆ‘ä»¬ç¨åå†è®²ã€‚ è¿™é‡Œå…ˆè¯¦ç»†è¯´ä¸€ä¸‹FutureTaskï¼šç”±äºAsyncTaskèƒ½å¤Ÿå–æ¶ˆä»»åŠ¡ï¼Œæ‰€ä»¥AsyncTaskä½¿ç”¨äº†FutureTaskä»¥åŠä¸å…¶ç›¸å…³çš„Callableï¼Œæ­¤å¤„å¯¹äºŒè€…ç®€å•è¿›è¡Œä¸€ä¸‹ä»‹ç»ã€‚FutureTaskã€Callableåœ¨Javaçš„å¹¶å‘ç¼–ç¨‹ä¸­æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œå¯ä»¥ç”¨æ¥è·å–ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åçš„è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥å–æ¶ˆçº¿ç¨‹æ± ä¸­çš„æŸä¸ªä»»åŠ¡ã€‚Callableæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶å†…éƒ¨å®šä¹‰äº†callæ–¹æ³•ï¼Œåœ¨callæ–¹æ³•å†…éœ€è¦ç¼–å†™ä»£ç æ‰§è¡Œå…·ä½“çš„ä»»åŠ¡ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸ŠCallableæ¥å£ä¸Runnableæ¥å£å¾ˆç±»ä¼¼ï¼Œä¸è¿‡ä¸åŒçš„æ˜¯Runnableçš„runæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼ŒCallableçš„callæ–¹æ³•å¯ä»¥æŒ‡å®šè¿”å›å€¼ã€‚FutureTaskç±»åŒæ—¶å®ç°äº†Callableæ¥å£å’ŒRunnableæ¥å£ï¼ŒFutureTaskçš„æ„é€ å‡½æ•°ä¸­éœ€è¦ä¼ å…¥ä¸€ä¸ªCallableå¯¹è±¡ä»¥å¯¹å…¶è¿›è¡Œå®ä¾‹åŒ–ã€‚Executorçš„executeæ–¹æ³•æ¥æ”¶ä¸€ä¸ªRunnableå¯¹è±¡ï¼Œç”±äºFutureTaskå®ç°äº†Runnableæ¥å£ï¼Œæ‰€ä»¥å¯ä»¥æŠŠä¸€ä¸ªFutureTaskå¯¹è±¡ä¼ é€’ç»™Executorçš„executeæ–¹æ³•å»æ‰§è¡Œã€‚å½“ä»»åŠ¡æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™ä¼šæ‰§è¡ŒFutureTaskçš„doneæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å†™ä¸€äº›é€»è¾‘å¤„ç†ã€‚åœ¨ä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥éšæ—¶è°ƒç”¨FutureTaskçš„cancelæ–¹æ³•å–æ¶ˆæ‰§è¡Œä»»åŠ¡ï¼Œä»»åŠ¡å–æ¶ˆåä¹Ÿä¼šæ‰§è¡ŒFutureTaskçš„doneæ–¹æ³•ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡FutureTaskçš„getæ–¹æ³•é˜»å¡å¼åœ°ç­‰å¾…ä»»åŠ¡çš„è¿”å›å€¼ï¼ˆå³Callableçš„callæ–¹æ³•çš„è¿”å›å€¼ï¼‰ï¼Œå¦‚æœä»»åŠ¡æ‰§è¡Œå®Œäº†å°±ç«‹å³è¿”å›æ‰§è¡Œçš„ç»“æœï¼Œå¦åˆ™å°±é˜»å¡å¼ç­‰å¾…callæ–¹æ³•çš„å®Œæˆã€‚ æ„é€ å‡½æ•°æˆ‘ä»¬å…ˆåˆ†æåˆ°è¿™é‡Œï¼Œå…³äºmWorkerè¿™ä¸ªå¯¹è±¡é‡Œè°ƒç”¨doInBackground()å‡½æ•°çš„æµç¨‹æˆ‘ä»¬ç¨åè®²åˆ°ç„¶åæŠŠå®ƒä»¬ä¸²èµ·æ¥ã€‚ execute()æ–¹æ³•å¦‚æœæˆ‘ä»¬æƒ³è¦å¯åŠ¨æŸä¸€ä¸ªä»»åŠ¡ï¼Œå°±éœ€è¦è°ƒç”¨è¯¥ä»»åŠ¡çš„execute()æ–¹æ³•ï¼Œå› æ­¤ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹å®ƒçš„æºç ï¼š 12345678910111213141516171819202122232425262728293031323334public final AsyncTask&lt;Params, Progress, Result&gt; execute(Params... params) &#123; return executeOnExecutor(sDefaultExecutor, params);&#125;public final AsyncTask&lt;Params, Progress, Result&gt; executeOnExecutor(Executor exec, Params... params) &#123; if (mStatus != Status.PENDING) &#123; switch (mStatus) &#123; case RUNNING: //å¦‚æœå½“å‰AsyncTaskå·²ç»å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œé‚£ä¹ˆå°±æŠ›å‡ºå¼‚å¸¸ï¼Œä¸å†æ‰§è¡Œæ–°çš„ä»»åŠ¡ throw new IllegalStateException(\"Cannot execute task:\" + \" the task is already running.\"); case FINISHED: //å¦‚æœå½“å‰AsyncTaskå·²ç»æŠŠä¹‹å‰çš„ä»»åŠ¡è¿è¡Œå®Œæˆï¼Œé‚£ä¹ˆä¹ŸæŠ›å‡ºå¼‚å¸¸ï¼Œä¸å†æ‰§è¡Œæ–°çš„ä»»åŠ¡ throw new IllegalStateException(\"Cannot execute task:\" + \" the task has already been executed \" + \"(a task can be executed only once)\"); &#125; &#125; mStatus = Status.RUNNING; onPreExecute(); mWorker.mParams = params; //Executorçš„executeæ–¹æ³•æ¥æ”¶Runnableå‚æ•°ï¼Œç”±äºmFutureæ˜¯FutureTaskçš„å®ä¾‹ï¼Œ //ä¸”FutureTaskåŒæ—¶å®ç°äº†Callableå’ŒRunnableæ¥å£ï¼Œæ‰€ä»¥æ­¤å¤„å¯ä»¥è®©execæ‰§è¡ŒmFuture exec.execute(mFuture); return this;&#125;public static final Executor SERIAL_EXECUTOR = new SerialExecutor();private static volatile Executor sDefaultExecutor = SERIAL_EXECUTOR; å¯ä»¥çœ‹åˆ°execute()æ–¹æ³•è°ƒç”¨äº†executeOnExecutor()æ–¹æ³•ã€‚ åœ¨executeOnExecutor()æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ç»ˆäºçœ‹åˆ°å®ƒè°ƒç”¨äº†onPreExecute()æ–¹æ³•ï¼Œå› æ­¤è¯æ˜äº†onPreExecute()æ–¹æ³•ä¼šç¬¬ä¸€ä¸ªå¾—åˆ°æ‰§è¡Œã€‚ ä¸‹é¢å¯¹ä»¥ä¸Šä»£ç è¿›è¡Œä¸€ä¸‹è¯´æ˜ï¼š ä¸€ä¸ªAsyncTaskå®ä¾‹æ‰§è¡Œæ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼Œå½“ç¬¬äºŒæ¬¡æ‰§è¡Œä»»åŠ¡æ—¶å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚executeOnExecutoræ–¹æ³•ä¸€å¼€å§‹å°±æ£€æŸ¥AsyncTaskçš„çŠ¶æ€æ˜¯ä¸æ˜¯PENDINGï¼Œåªæœ‰PENDINGçŠ¶æ€æ‰å¾€ä¸‹æ‰§è¡Œï¼Œå¦‚æœæ˜¯å…¶ä»–çŠ¶æ€è¡¨æ˜ç°åœ¨æ­£åœ¨æ‰§è¡Œå¦ä¸€ä¸ªå·²æœ‰çš„ä»»åŠ¡æˆ–è€…å·²ç»æ‰§è¡Œå®Œæˆäº†ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ç§æƒ…å†µä¸‹éƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ å¦‚æœå¼€å§‹æ˜¯PENDINGçŠ¶æ€ï¼Œé‚£ä¹ˆå°±è¯´æ˜è¯¥AsyncTaskè¿˜æ²¡æ‰§è¡Œè¿‡ä»»ä½•ä»»åŠ¡ï¼Œä»£ç å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œç„¶åå°†çŠ¶æ€è®¾ç½®ä¸ºRUNNINGï¼Œè¡¨ç¤ºå¼€å§‹æ‰§è¡Œä»»åŠ¡ã€‚ åœ¨çœŸæ­£æ‰§è¡Œä»»åŠ¡å‰ï¼Œå…ˆè°ƒç”¨onPreExecuteæ–¹æ³•ã€‚ç”±äºexecuteOnExecutoræ–¹æ³•åº”è¯¥è¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸Šï¼Œæ‰€ä»¥æ­¤å¤„çš„onPreExecuteæ–¹æ³•ä¹Ÿä¼šè¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸Šï¼Œå¯ä»¥åœ¨è¯¥æ–¹æ³•ä¸­åšä¸€äº›UIä¸Šçš„å¤„ç†æ“ä½œã€‚ Executorçš„executeæ–¹æ³•æ¥æ”¶Runnableå‚æ•°ï¼Œç”±äºmFutureæ˜¯FutureTaskçš„å®ä¾‹ï¼Œä¸”FutureTaskåŒæ—¶å®ç°äº†Callableå’ŒRunnableæ¥å£ï¼Œæ‰€ä»¥æ­¤å¤„å¯ä»¥è®©execé€šè¿‡executeæ–¹æ³•åœ¨æ‰§è¡ŒmFutureã€‚åœ¨æ‰§è¡Œäº†exec.execute(mFuture)ä¹‹åï¼Œåé¢ä¼šåœ¨execçš„å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡ŒmWorkerçš„callæ–¹æ³•ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨ä»‹ç»mWorkerçš„å®ä¾‹åŒ–çš„æ—¶å€™ä¹Ÿä»‹ç»äº†callæ–¹æ³•å†…éƒ¨çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä¼šé¦–å…ˆåœ¨å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡ŒdoInBackgroundæ–¹æ³•ï¼Œå¹¶è¿”å›ç»“æœï¼Œç„¶åå°†ç»“æœä¼ é€’ç»™postResultæ–¹æ³•ã€‚ æœ€åè°ƒç”¨exec.execute(mFuture);å»æ‰§è¡ŒçœŸæ­£çš„ä»»åŠ¡ï¼Œæ­¤å¤„execå¯¹è±¡å°±æ˜¯sDefaultExecutorï¼Œå¯ä»¥çœ‹åˆ°å…¶å®æ˜¯ä¸ªSerialExecutorå¯¹è±¡ï¼Œæºç å¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910111213141516171819202122232425262728293031323334private static class SerialExecutor implements Executor &#123; //mTasksæ˜¯ä¸€ä¸ªç»´æŠ¤Runnableçš„åŒç«¯é˜Ÿåˆ—ï¼ŒArrayDequeæ²¡æœ‰å®¹é‡é™åˆ¶ï¼Œå…¶å®¹é‡å¯è‡ªå¢é•¿ final ArrayDeque&lt;Runnable&gt; mTasks = new ArrayDeque&lt;Runnable&gt;(); Runnable mActive; public synchronized void execute(final Runnable r) &#123; //executeæ–¹æ³•ä¼šä¼ å…¥ä¸€ä¸ªRunnableç±»å‹çš„å˜é‡r //ç„¶åæˆ‘ä»¬ä¼šå®ä¾‹åŒ–ä¸€ä¸ªRunnableç±»å‹çš„åŒ¿åå†…éƒ¨ç±»ä»¥å¯¹rè¿›è¡Œå°è£…ï¼Œ //é€šè¿‡é˜Ÿåˆ—çš„offeræ–¹æ³•å°†å°è£…åçš„Runnableæ·»åŠ åˆ°é˜Ÿå°¾ mTasks.offer(new Runnable() &#123; public void run() &#123; try &#123; //æ­¤å¤„rçš„runæ–¹æ³•æ˜¯åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œçš„ r.run(); &#125; finally &#123; //å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œé€šè¿‡è°ƒç”¨scheduleNextæ–¹æ³•æ‰§è¡Œä¸‹ä¸€ä¸ªRunnableä»»åŠ¡ scheduleNext(); &#125; &#125; &#125;); //åªæœ‰å½“å‰æ²¡æœ‰æ‰§è¡Œä»»ä½•ä»»åŠ¡æ—¶ï¼Œæ‰ä¼šç«‹å³æ‰§è¡ŒscheduleNextæ–¹æ³• if (mActive == null) &#123; scheduleNext(); &#125; &#125; protected synchronized void scheduleNext() &#123; //é€šè¿‡mTasksçš„pollæ–¹æ³•è¿›è¡Œå‡ºé˜Ÿæ“ä½œï¼Œåˆ é™¤å¹¶è¿”å›é˜Ÿå¤´çš„Runnableï¼Œ //å°†è¿”å›çš„Runnableèµ‹å€¼ç»™mActiveï¼Œå¹¶å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™THREAD_POOL_EXECUTORçš„executeæ–¹æ³•è¿›è¡Œæ‰§è¡Œ if ((mActive = mTasks.poll()) != null) &#123; THREAD_POOL_EXECUTOR.execute(mActive); &#125; &#125;&#125; SerialExecutorå®ç°äº†Executoræ¥å£ä¸­çš„executeæ–¹æ³•ï¼Œè¯¥ç±»ç”¨äºä¸²è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œå³ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯å¹¶è¡Œæ‰§è¡Œä»»åŠ¡ã€‚ é€šè¿‡ä»¥ä¸Šä»£ç å’Œæ³¨é‡Šæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š SerialExecutorå®ç°äº†Executoræ¥å£ä¸­çš„executeæ–¹æ³•ï¼Œè¯¥ç±»ç”¨äºä¸²è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œå³ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯å¹¶è¡Œæ‰§è¡Œä»»åŠ¡ã€‚ SerialExecutorå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªå­˜æ”¾Runnableçš„åŒç«¯é˜Ÿåˆ—mTasksã€‚å½“æ‰§è¡ŒSerialExecutorçš„executeæ–¹æ³•æ—¶ï¼Œä¼šä¼ å…¥ä¸€ä¸ªRunnableå˜é‡rï¼Œä½†æ˜¯mTaskså¹¶ä¸ç›´æ¥å­˜å‚¨rï¼Œè€Œæ˜¯åˆæ–°newäº†ä¸€ä¸ªåŒ¿åRunnableå¯¹è±¡ï¼Œå…¶å†…éƒ¨ä¼šè°ƒç”¨rï¼Œè¿™æ ·å°±å¯¹rè¿›è¡Œäº†å°è£…ï¼Œå°†è¯¥å°è£…åçš„Runnableå¯¹è±¡é€šè¿‡é˜Ÿåˆ—çš„offeræ–¹æ³•å…¥é˜Ÿï¼Œæ·»åŠ åˆ°mTasksçš„é˜Ÿå°¾ã€‚ SerialExecutorå†…éƒ¨é€šè¿‡mActiveå­˜å‚¨ç€å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡Runnableã€‚å½“æ‰§è¡ŒSerialExecutorçš„executeæ–¹æ³•æ—¶ï¼Œé¦–å…ˆä¼šå‘mTasksçš„é˜Ÿå°¾æ·»åŠ è¿›ä¸€ä¸ªRunnableã€‚ç„¶ååˆ¤æ–­å¦‚æœmActiveä¸ºnullï¼Œå³å½“å‰æ²¡æœ‰ä»»åŠ¡Runnableæ­£åœ¨è¿è¡Œï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡ŒscheduleNext()æ–¹æ³•ã€‚å½“æ‰§è¡ŒscheduleNextæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šé¦–å…ˆä»mTasksä¸­é€šè¿‡pollæ–¹æ³•å‡ºé˜Ÿï¼Œåˆ é™¤å¹¶è¿”å›é˜Ÿå¤´çš„Runnableï¼Œå°†è¿”å›çš„Runnableèµ‹å€¼ç»™mActiveï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå°±è®©å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™THREAD_POOL_EXECUTORçš„executeæ–¹æ³•è¿›è¡Œæ‰§è¡Œã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºSerialExecutorå®é™…ä¸Šæ˜¯é€šè¿‡ä¹‹å‰å®šä¹‰çš„çº¿ç¨‹æ± THREAD_POOL_EXECUTORè¿›è¡Œå®é™…çš„å¤„ç†çš„ã€‚ å½“å°†mTasksä¸­çš„Runnableä½œä¸ºå‚æ•°ä¼ é€’ç»™THREAD_POOL_EXECUTORæ‰§è¡Œexecuteæ–¹æ³•æ—¶ï¼Œä¼šåœ¨çº¿ç¨‹æ± çš„å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡ŒåŒ¿åå†…éƒ¨ç±»Runnableä¸­çš„try-finallyä»£ç æ®µï¼Œå³å…ˆåœ¨å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡Œr.run()æ–¹æ³•å»æ‰§è¡Œä»»åŠ¡ï¼Œæ— è®ºä»»åŠ¡ræ­£å¸¸å®Œæˆè¿˜æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œéƒ½ä¼šåœ¨finallyä¸­æ‰§è¡ŒscheduleNextæ–¹æ³•ï¼Œç”¨äºæ‰§è¡ŒmTasksä¸­çš„ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚ä»è€Œåœ¨æ­¤å¤„æˆ‘ä»¬å¯ä»¥çœ‹å‡ºSerialExecutoræ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªæ‰§è¡Œä»»åŠ¡ï¼Œæ˜¯ä¸²è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯å¹¶è¡Œæ‰§è¡Œã€‚ æˆ‘ä»¬çœ‹SerialExecutoræœ€ç»ˆæ‰§è¡Œçš„æ˜¯r.run()ï¼Œé‚£è¿™é‡Œçš„ræ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå°±æ˜¯executeæ–¹æ³•ä¸­çš„exec.execute(mFuture)ä¸­çš„å‚æ•°mFutureã€‚ä¹Ÿå°±æ˜¯æœ€ç»ˆæ‰§è¡Œäº†mFutureè¿™ä¸ªFutureTaskå¯¹è±¡çš„run()æ–¹æ³•ï¼Œæˆ‘ä»¬è¿›å…¥çœ‹çœ‹FutureTaskç±»ä¸­çš„run()æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243//FutureTaskçš„æ„é€ å‡½æ•°public FutureTask(Callable&lt;V&gt; callable) &#123; if (callable == null) throw new NullPointerException(); //æ­¤å¤„çš„callableå°±æ˜¯æ¥æ”¶çš„mWorkerå¯¹è±¡ this.callable = callable; this.state = NEW;&#125;public void run() &#123; if (state != NEW || !UNSAFE.compareAndSwapObject(this, runnerOffset, null, Thread.currentThread())) return; try &#123; Callable&lt;V&gt; c = callable; if (c != null &amp;&amp; state == NEW) &#123; V result; boolean ran; try &#123; //æ ¸å¿ƒæ˜¯è°ƒç”¨äº†callableï¼ˆä¹Ÿå°±æ˜¯mWorkerï¼‰çš„callæ–¹æ³• result = c.call(); ran = true; &#125; catch (Throwable ex) &#123; result = null; ran = false; setException(ex); &#125; if (ran) set(result); &#125; &#125; finally &#123; // runner must be non-null until state is settled to // prevent concurrent calls to run() runner = null; // state must be re-read after nulling runner to prevent // leaked interrupts int s = state; if (s &gt;= INTERRUPTING) handlePossibleCancellationInterrupt(s); &#125;&#125; å¯ä»¥çœ‹åˆ°æ ¸å¿ƒä»£ç æ˜¯è°ƒç”¨äº†callableå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯mWorkerï¼‰çš„callæ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬å›å¤´çœ‹çœ‹æ„é€ å‡½æ•°ä¸­çš„mWorkerå¯¹è±¡ã€‚ æ‰§è¡Œä»»åŠ¡ - è°ƒç”¨doInBackground()æˆ‘ä»¬å‰é¢çŸ¥é“ï¼ŒExecutorçš„executeæ–¹æ³•æ¥æ”¶Runnableå‚æ•°ï¼Œç”±äºmFutureæ˜¯FutureTaskçš„å®ä¾‹ï¼Œä¸”FutureTaskåŒæ—¶å®ç°äº†Callableå’ŒRunnableæ¥å£ï¼Œæ‰€ä»¥æ­¤å¤„å¯ä»¥è®©execé€šè¿‡executeæ–¹æ³•åœ¨æ‰§è¡ŒmFutureã€‚åœ¨æ‰§è¡Œäº†exec.execute(mFuture)ä¹‹åï¼Œåé¢ä¼šåœ¨execçš„å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡ŒmWorkerçš„callæ–¹æ³•ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨æ„é€ å‡½æ•°ä¸­ä»‹ç»mWorkerçš„å®ä¾‹åŒ–çš„æ—¶å€™ä¹Ÿä»‹ç»äº†callæ–¹æ³•å†…éƒ¨çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä¼šé¦–å…ˆåœ¨å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡ŒdoInBackgroundæ–¹æ³•ï¼Œå¹¶è¿”å›ç»“æœï¼Œç„¶åå°†ç»“æœä¼ é€’ç»™postResultæ–¹æ³•ã€‚ æˆ‘ä»¬å›è¿‡å¤´çœ‹çœ‹æ„é€ å‡½æ•°ä¸­mWorkerè¿™ä¸ªä»»åŠ¡å¯¹è±¡ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­çš„mWorkerå®šä¹‰å¦‚ä¸‹ï¼š 123456789mWorker = new WorkerRunnable&lt;Params, Result&gt;() &#123; public Result call() throws Exception &#123; mTaskInvoked.set(true); Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND); //noinspection unchecked return postResult(doInBackground(mParams)); &#125;&#125;; æˆ‘ä»¬çœ‹æœ€åè¿™å¥postResult(doInBackground(mParams));ï¼Œå®ƒä¼šè°ƒç”¨æˆ‘ä»¬çš„doInBackground()å‡½æ•°æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶æŠŠç»“æœå‘é€ç»™postResult()æ–¹æ³•ï¼Œæˆ‘ä»¬è·Ÿè¿›å»çœ‹ï¼š 123456789private Result postResult(Result result) &#123; @SuppressWarnings(\"unchecked\") Message message = sHandler.obtainMessage(MESSAGE_POST_RESULT, new AsyncTaskResult&lt;Result&gt;(this, result)); message.sendToTarget(); return result;&#125;private static final InternalHandler sHandler = new InternalHandler(); å®ƒä½¿ç”¨sHandlerå¯¹è±¡å‘å‡ºäº†ä¸€æ¡æ¶ˆæ¯ï¼ŒInternalHandleråˆ›å»ºä¸€ä¸ªMessage Codeä¸ºMESSAGE_POST_RESULTçš„Messageï¼Œæ­¤å¤„è¿˜å°†doInBackgroundè¿”å›çš„resulté€šè¿‡new AsyncTaskResult&lt;Result&gt;(this, result)å°è£…æˆäº†AsyncTaskResultï¼Œå°†å…¶ä½œä¸ºmessageçš„objå±æ€§ã€‚ AsyncTaskResultæ˜¯AsyncTaskçš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå…¶ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011private static class AsyncTaskResult&lt;Data&gt; &#123; //mTaskè¡¨ç¤ºå½“å‰AsyncTaskResultæ˜¯å“ªä¸ªAsyncTaskçš„ç»“æœ final AsyncTask mTask; //mDataè¡¨ç¤ºå…¶å­˜å‚¨çš„æ•°æ® final Data[] mData; AsyncTaskResult(AsyncTask task, Data... data) &#123; mTask = task; mData = data; &#125;&#125; åœ¨æ„å»ºäº†messageå¯¹è±¡åï¼Œé€šè¿‡message.sendToTarget()å°†è¯¥messageå‘é€ç»™sHandlerï¼Œä¹‹åsHandlerçš„handleMessageæ–¹æ³•ä¼šæ¥æ”¶å¹¶å¤„ç†è¯¥messageï¼Œè¿™ä¸ªsHandlerå¯¹è±¡æ˜¯InternalHandlerç±»çš„ä¸€ä¸ªå®ä¾‹ï¼ŒInternalHandlerçš„æºç å¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910111213141516private static class InternalHandler extends Handler &#123; @SuppressWarnings(&#123;\"unchecked\", \"RawUseOfParameterizedType\"&#125;) @Override public void handleMessage(Message msg) &#123; AsyncTaskResult result = (AsyncTaskResult) msg.obj; switch (msg.what) &#123; case MESSAGE_POST_RESULT: // There is only one result result.mTask.finish(result.mData[0]); break; case MESSAGE_POST_PROGRESS: result.mTask.onProgressUpdate(result.mData); break; &#125; &#125;&#125; msg.objæ˜¯AsyncTaskResultç±»å‹ï¼Œresult.mTaskè¡¨ç¤ºå½“å‰AsyncTaskResultæ‰€ç»‘å®šçš„AsyncTaskã€‚result.mData[0]è¡¨ç¤ºçš„æ˜¯doInBackgroundæ‰€è¿”å›çš„å¤„ç†ç»“æœã€‚å°†è¯¥ç»“æœä¼ é€’ç»™AsyncTaskçš„finishæ–¹æ³•ï¼Œfinishä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011private void finish(Result result) &#123; if (isCancelled()) &#123; //å¦‚æœä»»åŠ¡è¢«å–æ¶ˆäº†ï¼Œé‚£ä¹ˆæ‰§è¡ŒonCancelledæ–¹æ³• onCancelled(result); &#125; else &#123; //å°†ç»“æœå‘ä¼ é€’ç»™onPostExecuteæ–¹æ³• onPostExecute(result); &#125; //æœ€åå°†AsyncTaskçš„çŠ¶æ€è®¾ç½®ä¸ºå®ŒæˆçŠ¶æ€ mStatus = Status.FINISHED;&#125; finishæ–¹æ³•å†…éƒ¨ä¼šé¦–å…ˆåˆ¤æ–­AsyncTaskæ˜¯å¦è¢«å–æ¶ˆäº†ï¼Œå¦‚æœè¢«å–æ¶ˆäº†æ‰§è¡ŒonCancelled(result)ï¼Œå¦åˆ™æ‰§è¡ŒonPostExecute(result)æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯InternalHandleræ˜¯æŒ‡å‘ä¸»çº¿ç¨‹çš„ï¼Œæ‰€ä»¥å…¶handleMessageæ–¹æ³•æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œä»è€Œæ­¤å¤„çš„finishæ–¹æ³•ä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œè¿›è€ŒonPostExecuteä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨doInBackgroundæ–¹æ³•ä¸­æ˜¯åœ¨å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡Œæ¯”è¾ƒè€—æ—¶çš„æ“ä½œï¼Œè¿™ä¸ªæ“ä½œæ—¶é—´å¯èƒ½æ¯”è¾ƒé•¿ï¼Œè€Œæˆ‘ä»¬çš„ä»»åŠ¡æœ‰å¯èƒ½åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼Œæ¯å½“æˆ‘å®Œæˆå…¶ä¸­çš„ä¸€éƒ¨åˆ†ä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨doInBackgroundä¸­å¤šæ¬¡è°ƒç”¨AsyncTaskçš„publishProgressæ–¹æ³•ï¼Œå°†é˜¶æ®µæ€§æ•°æ®å‘å¸ƒå‡ºå»ã€‚ publishProgressæ–¹æ³•ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 123456protected final void publishProgress(Progress... values) &#123; if (!isCancelled()) &#123; sHandler.obtainMessage(MESSAGE_POST_PROGRESS, new AsyncTaskResult&lt;Progress&gt;(this, values)).sendToTarget(); &#125;&#125; å¯ä»¥çœ‹åˆ°æœ€åå‘é€äº†ä¸€æ¡MESSAGE_POST_PROGRESSçš„Messageç»™sHandlerï¼Œåˆ°sHandlerçš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°å®ƒè°ƒç”¨äº†onProgressUpdate()è¿™ä¸ªæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä½¿ç”¨ç¤ºä¾‹å½“ä¸­çš„è¿›åº¦æ¡æ›´æ–°å‡½æ•°ã€‚ æœ€åï¼ŒAsyncTaskæ— è®ºä»»åŠ¡å®Œæˆè¿˜æ˜¯å–æ¶ˆä»»åŠ¡ï¼ŒFutureTaskéƒ½ä¼šæ‰§è¡Œdoneæ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920mFuture = new FutureTask&lt;Result&gt;(mWorker) &#123; @Override protected void done() &#123; //ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æˆ–å–æ¶ˆä»»åŠ¡éƒ½ä¼šæ‰§è¡Œdoneæ–¹æ³• try &#123; //ä»»åŠ¡æ­£å¸¸æ‰§è¡Œå®Œæˆ postResultIfNotInvoked(get()); &#125; catch (InterruptedException e) &#123; //ä»»åŠ¡å‡ºç°ä¸­æ–­å¼‚å¸¸ android.util.Log.w(LOG_TAG, e); &#125; catch (ExecutionException e) &#123; //ä»»åŠ¡æ‰§è¡Œå‡ºç°å¼‚å¸¸ throw new RuntimeException(\"An error occurred while executing doInBackground()\", e.getCause()); &#125; catch (CancellationException e) &#123; //ä»»åŠ¡å–æ¶ˆ postResultIfNotInvoked(null); &#125; &#125;&#125;; æ— è®ºä»»åŠ¡æ­£å¸¸æ‰§è¡Œå®Œæˆè¿˜æ˜¯ä»»åŠ¡å–æ¶ˆï¼Œéƒ½ä¼šæ‰§è¡ŒpostResultIfNotInvokedæ–¹æ³•ã€‚postResultIfNotInvokedä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567private void postResultIfNotInvoked(Result result) &#123; final boolean wasTaskInvoked = mTaskInvoked.get(); if (!wasTaskInvoked) &#123; //åªæœ‰mWorkerçš„callæ²¡æœ‰è¢«è°ƒç”¨æ‰ä¼šæ‰§è¡ŒpostResultæ–¹æ³• postResult(result); &#125;&#125; å¦‚æœAsyncTaskæ­£å¸¸æ‰§è¡Œå®Œæˆçš„æ—¶å€™ï¼Œcallæ–¹æ³•éƒ½æ‰§è¡Œå®Œäº†ï¼ŒmTaskInvokedè®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”åœ¨callæ–¹æ³•ä¸­æœ€åæ‰§è¡Œäº†postResultæ–¹æ³•ï¼Œç„¶åè¿›å…¥mFutureçš„doneæ–¹æ³•ï¼Œç„¶åè¿›å…¥postResultIfNotInvokedæ–¹æ³•ï¼Œç”±äºmTaskInvokedå·²ç»æ‰§è¡Œï¼Œæ‰€ä»¥ä¸ä¼šæ‰§è¡Œå†æ‰§è¡ŒpostResultæ–¹æ³•ã€‚ å¦‚æœåœ¨è°ƒç”¨äº†AsyncTaskçš„executeæ–¹æ³•åç«‹é©¬å°±æ‰§è¡Œäº†AsyncTaskçš„cancelæ–¹æ³•ï¼ˆå®é™…æ‰§è¡ŒmFutureçš„cancelæ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆä¼šæ‰§è¡Œdoneæ–¹æ³•ï¼Œä¸”æ•è·åˆ°CancellationExceptionå¼‚å¸¸ï¼Œä»è€Œæ‰§è¡Œè¯­å¥postResultIfNotInvoked(null)ï¼Œç”±äºæ­¤æ—¶è¿˜æ²¡æœ‰æ¥å¾—åŠæ‰§è¡ŒmWorkerçš„callæ–¹æ³•ï¼Œæ‰€ä»¥mTaskInvokedè¿˜æœªfalseï¼Œè¿™æ ·å°±å¯ä»¥æŠŠnullä¼ é€’ç»™postResultæ–¹æ³•ã€‚ åˆ°è¿™é‡Œï¼ŒAsyncTaskä¸­çš„ç»†èŠ‚åŸºæœ¬ä¸Šå°±åˆ†æå®Œäº†ã€‚ æ³¨æ„äº‹é¡¹åœ¨Googleå®˜æ–¹æ–‡æ¡£é‡Œæœ‰è¿™ä¹ˆä¸€æ®µï¼š Threading rules There are a few threading rules that must be followed for this class to work properly: The AsyncTask class must be loaded on the UI thread. This is done automatically as of JELLY_BEAN. The task instance must be created on the UI thread. execute(Params...) must be invoked on the UI thread. Do not call onPreExecute(), onPostExecute(Result), doInBackground(Params...), onProgressUpdate(Progress...) manually. The task can be executed only once (an exception will be thrown if a second execution is attempted. ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼š AsyncTaskå¿…é¡»åœ¨UIä¸»çº¿ç¨‹ä¸­åˆ›å»ºï¼ˆnewï¼‰ï¼› execute(Params...)å‡½æ•°å¿…é¡»åœ¨UIçº¿ç¨‹ä¸­è°ƒç”¨ï¼› ä¸è¦æ‰‹åŠ¨è°ƒç”¨ onPreExecute(), onPostExecute(Result), doInBackground(Params...), onProgressUpdate(Progress...) è¿™äº›æ–¹æ³•ã€‚ æ¯ä¸ªAsyncTaskä»»åŠ¡åªèƒ½è¢«æ‰§è¡Œä¸€æ¬¡ï¼› å¤§å®¶æ³¨æ„åˆ°äº†å—ï¼ŒAsyncTaskå¿…é¡»åœ¨UIä¸»çº¿ç¨‹ä¸­åˆ›å»ºï¼ˆnewï¼‰ï¼Œexecute(Params...)å‡½æ•°å¿…é¡»åœ¨UIçº¿ç¨‹ä¸­è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¦æ±‚Googleå¹¶æ²¡æœ‰åœ¨frameworkå±‚å®ç°å¼ºåˆ¶çº¦æŸï¼Œè€Œæ˜¯ç»™äº†å£å¤´ä¸Šçš„ä¸€ç§ç¼–ç çº¦å®šï¼ˆç»“åˆæºç æˆ‘ä»¬ä¹Ÿèƒ½çœ‹åˆ°æºç ä¸­ä¹Ÿæ²¡æœ‰è¿™æ ·çš„æœºåˆ¶ä¿è¯ï¼‰ã€‚è¿™ä¹Ÿå°±å¯èƒ½ä¼šå¼•å‘æˆ‘ä»¬å¼€å¤´é‚£ä¸ªé—®é¢˜ï¼š onPreExecuteå¹¶ä¸ä¿è¯ä¸€å®šåœ¨UIçº¿ç¨‹ä¸­æ‰§è¡Œï¼è€Œæ˜¯ç”±execute(Params...)å‡½æ•°åœ¨å“ªä¸ªçº¿ç¨‹ä¸­è°ƒç”¨å†³å®šçš„ï¼ æ¯”å¦‚stackoverflowä¸Šçš„è¿™ä¸ªé—®é¢˜ï¼šAndroid: AsyncTask onPreExecute() method is NOT executed in UI thread - stackoverflowã€‚å°±æ˜¯åœ¨å­çº¿ç¨‹ä¸­è°ƒç”¨äº†execute(Params...)å‡½æ•°ã€‚æ‰€ä»¥ä¸ºäº†é¿å…è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€å®šè¦éµå®ˆä¸Šé¢é‚£å‡ æ¡å®˜æ–¹çº¦å®šã€‚ ä¸€äº›ç‰ˆæœ¬å˜åŒ–åœ¨Android 3.0ä¹‹å‰æ˜¯å¹¶æ²¡æœ‰SerialExecutorè¿™ä¸ªç±»çš„ï¼Œé‚£ä¸ªæ—¶å€™æ˜¯ç›´æ¥åœ¨AsyncTaskä¸­æ„å»ºäº†ä¸€ä¸ªsExecutorå¸¸é‡ï¼Œå¹¶å¯¹çº¿ç¨‹æ± æ€»å¤§å°ï¼ŒåŒä¸€æ—¶åˆ»èƒ½å¤Ÿè¿è¡Œçš„çº¿ç¨‹æ•°åšäº†è§„å®šï¼Œæ¯”å¦‚Android Froyo 2.2.3ç‰ˆæœ¬çš„æºç å¦‚ä¸‹æ‰€ç¤ºï¼š 123456789101112131415161718192021222324252627282930313233343536public abstract class AsyncTask&lt;Params, Progress, Result&gt; &#123; private static final String LOG_TAG = \"AsyncTask\"; //çº¿ç¨‹æ± å¤§å° private static final int CORE_POOL_SIZE = 5; private static final int MAXIMUM_POOL_SIZE = 128; private static final int KEEP_ALIVE = 10; private static final BlockingQueue&lt;Runnable&gt; sWorkQueue = new LinkedBlockingQueue&lt;Runnable&gt;(10); private static final ThreadFactory sThreadFactory = new ThreadFactory() &#123; private final AtomicInteger mCount = new AtomicInteger(1); public Thread newThread(Runnable r) &#123; return new Thread(r, \"AsyncTask #\" + mCount.getAndIncrement()); &#125; &#125;; private static final ThreadPoolExecutor sExecutor = new ThreadPoolExecutor(CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE, TimeUnit.SECONDS, sWorkQueue, sThreadFactory); private static final int MESSAGE_POST_RESULT = 0x1; private static final int MESSAGE_POST_PROGRESS = 0x2; private static final int MESSAGE_POST_CANCEL = 0x3; private static final InternalHandler sHandler = new InternalHandler(); private final WorkerRunnable&lt;Params, Result&gt; mWorker; private final FutureTask&lt;Result&gt; mFuture; private volatile Status mStatus = Status.PENDING; ...çœç•¥å…¶ä»–ä»£ç ...&#125; å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œè§„å®šåŒä¸€æ—¶åˆ»èƒ½å¤Ÿè¿è¡Œçš„çº¿ç¨‹æ•°ä¸º5ä¸ªï¼Œçº¿ç¨‹æ± æ€»å¤§å°ä¸º128ã€‚ä¹Ÿå°±æ˜¯è¯´å½“æˆ‘ä»¬å¯åŠ¨äº†10ä¸ªä»»åŠ¡æ—¶ï¼Œåªæœ‰5ä¸ªä»»åŠ¡èƒ½å¤Ÿç«‹åˆ»æ‰§è¡Œï¼Œå¦å¤–çš„5ä¸ªä»»åŠ¡åˆ™éœ€è¦ç­‰å¾…ï¼Œå½“æœ‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œç¬¬6ä¸ªä»»åŠ¡æ‰ä¼šå¯åŠ¨ï¼Œä»¥æ­¤ç±»æ¨ã€‚è€Œçº¿ç¨‹æ± ä¸­æœ€å¤§èƒ½å­˜æ”¾çš„çº¿ç¨‹æ•°æ˜¯128ä¸ªï¼Œå½“æˆ‘ä»¬å°è¯•å»æ·»åŠ ç¬¬129ä¸ªä»»åŠ¡æ—¶ï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚ è€Œåˆ°äº†Android Gingerbread 2.3.6ç‰ˆæœ¬ï¼ŒæŠŠåŒä¸€æ—¶åˆ»çš„5ä¸ªå¹¶å‘çº¿ç¨‹æ”¹æˆäº†åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„ä¸²è¡Œæ‰§è¡Œï¼Œä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435public abstract class AsyncTask&lt;Params, Progress, Result&gt; &#123; private static final String LOG_TAG = \"AsyncTask\"; private static final int CORE_POOL_SIZE = 5; private static final int MAXIMUM_POOL_SIZE = 128; //æ³¨æ„è¿™é‡Œ private static final int KEEP_ALIVE = 1; private static final BlockingQueue&lt;Runnable&gt; sWorkQueue = new LinkedBlockingQueue&lt;Runnable&gt;(10); private static final ThreadFactory sThreadFactory = new ThreadFactory() &#123; private final AtomicInteger mCount = new AtomicInteger(1); public Thread newThread(Runnable r) &#123; return new Thread(r, \"AsyncTask #\" + mCount.getAndIncrement()); &#125; &#125;; private static final ThreadPoolExecutor sExecutor = new ThreadPoolExecutor(CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE, TimeUnit.SECONDS, sWorkQueue, sThreadFactory); private static final int MESSAGE_POST_RESULT = 0x1; private static final int MESSAGE_POST_PROGRESS = 0x2; private static final int MESSAGE_POST_CANCEL = 0x3; private static final InternalHandler sHandler = new InternalHandler(); private final WorkerRunnable&lt;Params, Result&gt; mWorker; private final FutureTask&lt;Result&gt; mFuture; private volatile Status mStatus = Status.PENDING; ...çœç•¥å…¶ä»–ä»£ç ...&#125; æ€»ç»“ AsyncTaskçš„åº•å±‚å…¶å®æ˜¯å¯¹Threadã€Handlerã€Messageçš„å°è£…ï¼Œæ™ºèƒ½çš„åº”ç”¨äº†Handlerã€‚ å› ä¸ºAsyncTaské‡Œé¢çš„å†…éƒ¨handlerå’ŒExecutoréƒ½æ˜¯é™æ€å˜é‡ï¼Œæ‰€ä»¥ä»–ä»¬æ§åˆ¶ç€æ‰€æœ‰çš„å­ç±»ã€‚ å¦‚æœä¸æƒ³ä½¿ç”¨é»˜è®¤çš„çº¿ç¨‹æ± ï¼Œå¯ä»¥ä½¿ç”¨executeOnExecutor()å‡½æ•°è‡ªç”±åœ°è¿›è¡Œé…ç½®è€Œä¸æ˜¯execute()ã€‚å› ä¸ºç”¨ç³»ç»Ÿé»˜è®¤çš„çº¿ç¨‹æ± å› ä¸ºä¸²è¡Œæ‰§è¡Œå¯èƒ½éœ€è¦ç­‰å¾…ï¼ˆSerialExecutorï¼‰ã€‚è‡ªå·±ä½¿ç”¨è‡ªå®šä¹‰çº¿ç¨‹æ± æ–¹å¼å¦‚ä¸‹ï¼š 123Executor exec = new ThreadPoolExecutor(15, 200, 10, TimeUnit.SECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()); new DownloadTask().executeOnExecutor(exec); AsyncTaské€‚åˆå¤„ç†çŸ­æ—¶é—´çš„æ“ä½œã€‚é•¿æ—¶é—´çš„æ“ä½œï¼Œæ¯”å¦‚ä¸‹è½½ä¸€ä¸ªå¾ˆå¤§çš„è§†é¢‘ï¼Œè¿™å°±éœ€è¦ä½ ä½¿ç”¨è‡ªå·±çš„çº¿ç¨‹æ¥ä¸‹è½½ï¼Œä¸ç®¡æ˜¯æ–­ç‚¹ä¸‹è½½è¿˜æ˜¯å…¶å®ƒçš„ã€‚ä»googleå®˜æ–¹æ–‡æ¡£ä½ ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼ŒAsyncTasks should ideally be used for short operations (a few seconds at the most.) ä¸è¦éšæ„ä½¿ç”¨AsyncTask,é™¤éä½ å¿…é¡»è¦ä¸UIçº¿ç¨‹äº¤äº’ã€‚é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨Threadå³å¯ï¼Œè¦æ³¨æ„éœ€è¦å°†çº¿ç¨‹ä¼˜å…ˆçº§è°ƒä½ã€‚ Android3.0ä¹‹å‰ï¼Œå¼‚æ­¥ä»»åŠ¡æ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œå³å‡ ä¸ªä»»åŠ¡åŒæ—¶åˆ‡æ¢æ‰§è¡Œï¼Œ3.0ä¹‹åï¼Œå¼‚æ­¥ä»»åŠ¡æ”¹æˆäº†é¡ºåºæ‰§è¡Œï¼Œå³ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¦ä¸€ä¸ªä¸ªæ‰§è¡Œï¼ˆå¹¶éæŒ‰é¡ºåºï¼‰ï¼Œä¸€ä¸ªæ‰§è¡Œä¸å®Œï¼Œä¸èƒ½æ‰§è¡Œå¦ä¸€ä¸ªï¼Œå³é¡ºåºæ‰§è¡Œï¼Œä»–æ˜¯é»˜è®¤çš„æ‰§è¡Œæ–¹å¼execue()æ–¹æ³•ï¼Œå…¶é»˜è®¤æ‰§è¡Œçš„æ–¹æ³•æ˜¯ï¼šexecuteOnExecutor(AsyncTask.SERIAL_EXECUTOR)ï¼Œå¦‚æœè¦å¹¶å‘æ‰§è¡Œï¼Œéœ€è¦æ‰§è¡ŒAsyncTask.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR)ï¼Œä¸”ä¸ºäº†é˜²æ­¢ç³»ç»Ÿçš„ä»»åŠ¡ç¹é‡ï¼Œåªåœ¨çº¿ç¨‹æ± ä¸­ç»´æŠ¤äº†5ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯ï¼Œæ¯æ¬¡æœ€å¤šè·‘5ä¸ªä»»åŠ¡ï¼ˆç±»ä¼¼äºè¿…é›·ä¸‹è½½ï¼‰ã€‚å¦‚æœéœ€è¦å¹¶å‘æ›´å¤šçš„ä»»åŠ¡ï¼Œéœ€è¦è‡ªå®šä¹‰çº¿ç¨‹æ± äº†ã€‚æ‰€ä»¥å¼‚æ­¥ä»»åŠ¡åªé€‚åˆå¤„ç†ä¸€äº›è½»é‡çº§çš„å¹¶éšæ—¶ä¿®æ”¹UIçš„å¼‚æ­¥çº¿ç¨‹ï¼Œå¦‚æœé‡åˆ°ç¹é‡çš„ä»»åŠ¡ï¼Œæœ€å¥½è‡ªå·±æ–°å»ºä¸€ä¸ªThreadå¹¶ç”¨handlerå’Œlooperæœºåˆ¶å¤„ç†ã€‚ å‚è€ƒèµ„æ–™ Android AsyncTaskå®Œå…¨è§£æï¼Œå¸¦ä½ ä»æºç çš„è§’åº¦å½»åº•ç†è§£ æºç è§£æAndroidä¸­AsyncTaskçš„å·¥ä½œåŸç† - å­™ç¾¤ Androidæ€§èƒ½ä¼˜åŒ–å…¸èŒƒä¹‹å¤šçº¿ç¨‹ç¯‡ - è…¾è®¯Bugly Android: AsyncTask onPreExecute() method is NOT executed in UI thread - stackoverflow AsyncTask - Google Android Developers","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"http://github.com/tags/æºç åˆ†æ/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘æºç åˆ†æ - IntentServiceæœºåˆ¶","slug":"ã€Androidã€‘æºç åˆ†æ - IntentServiceæœºåˆ¶","date":"2017-10-05T08:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/10/05/ã€Androidã€‘æºç åˆ†æ - IntentServiceæœºåˆ¶/","link":"","permalink":"http://github.com/2017/10/05/ã€Androidã€‘æºç åˆ†æ - IntentServiceæœºåˆ¶/","excerpt":"å‰è¨€æåˆ°Androidçš„å¤šçº¿ç¨‹æœºåˆ¶ï¼Œé™¤äº†æˆ‘ä»¬å¸¸ç”¨çš„Threadæ¥å®ç°å¼‚æ­¥ä»»åŠ¡ä¹‹å¤–ï¼Œè¿˜æœ‰ AsyncTaskï¼šå°è£…äº†çº¿ç¨‹æ± å’ŒHandlerï¼Œä¸»è¦ä¸ºäº†å­çº¿ç¨‹æ›´æ–°UIï¼› HandlerThreadï¼šä¸€ä¸ªå·²ç»æ‹¥æœ‰äº†Looperçš„çº¿ç¨‹ç±»ï¼Œå†…éƒ¨å¯ä»¥ç›´æ¥ä½¿ç”¨Handlerï¼› IntentServiceï¼šä¸€ä¸ªå†…éƒ¨é‡‡ç”¨HandlerThreadæ¥æ‰§è¡Œä»»åŠ¡çš„ServiceæœåŠ¡ï¼Œä»»åŠ¡æ‰§è¡Œå®Œæ¯•åä¼šè‡ªåŠ¨é€€å‡ºï¼› ä»Šå¤©æˆ‘ä»¬æ¥æ ¹æ®å¹³æ—¶çš„ä½¿ç”¨æ–¹å¼æ¥åˆ†æä¸€ä¸‹ç¬¬ä¸‰ä¸ªIntentSeviceåˆ°åº•æ˜¯ä»€ä¹ˆæ€ä¹ˆå®ç°çš„ï¼Ÿ IntentServiceçš„ä½¿ç”¨IntentServiceç»§æ‰¿äº†Serviceå¹¶ä¸”å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå› æ­¤ä½¿ç”¨å®ƒå¿…é¡»åˆ›å»ºå®ƒçš„å­ç±»æ‰èƒ½ä½¿ç”¨ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªMyIntentServiceï¼Œæ¥å¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243public class MyIntentService extends IntentService &#123; private static final String TAG = \"MyIntentService\"; private boolean isRunning = true; private int count = 0; public MyIntentService() &#123; super(\"MyIntentService\"); &#125; @Override public void onCreate() &#123; super.onCreate(); &#125; @Override protected void onHandleIntent(Intent intent) &#123; try &#123; //æŸ¥çœ‹çº¿ç¨‹id Log.i(TAG, intent.getStringExtra(\"params\") + \", çº¿ç¨‹id:\" + Thread.currentThread().getId()); Thread.sleep(1000); //ä»0-100æ¸å¢ isRunning = true; count = 0; while (isRunning) &#123; count++; Log.i(TAG, \"MyIntentService çº¿ç¨‹è¿è¡Œä¸­...\" + count); if (count &gt;= 100) &#123; isRunning = false; &#125; Thread.sleep(50); &#125; &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; @Override public void onDestroy() &#123; super.onDestroy(); &#125;&#125;","text":"å‰è¨€æåˆ°Androidçš„å¤šçº¿ç¨‹æœºåˆ¶ï¼Œé™¤äº†æˆ‘ä»¬å¸¸ç”¨çš„Threadæ¥å®ç°å¼‚æ­¥ä»»åŠ¡ä¹‹å¤–ï¼Œè¿˜æœ‰ AsyncTaskï¼šå°è£…äº†çº¿ç¨‹æ± å’ŒHandlerï¼Œä¸»è¦ä¸ºäº†å­çº¿ç¨‹æ›´æ–°UIï¼› HandlerThreadï¼šä¸€ä¸ªå·²ç»æ‹¥æœ‰äº†Looperçš„çº¿ç¨‹ç±»ï¼Œå†…éƒ¨å¯ä»¥ç›´æ¥ä½¿ç”¨Handlerï¼› IntentServiceï¼šä¸€ä¸ªå†…éƒ¨é‡‡ç”¨HandlerThreadæ¥æ‰§è¡Œä»»åŠ¡çš„ServiceæœåŠ¡ï¼Œä»»åŠ¡æ‰§è¡Œå®Œæ¯•åä¼šè‡ªåŠ¨é€€å‡ºï¼› ä»Šå¤©æˆ‘ä»¬æ¥æ ¹æ®å¹³æ—¶çš„ä½¿ç”¨æ–¹å¼æ¥åˆ†æä¸€ä¸‹ç¬¬ä¸‰ä¸ªIntentSeviceåˆ°åº•æ˜¯ä»€ä¹ˆæ€ä¹ˆå®ç°çš„ï¼Ÿ IntentServiceçš„ä½¿ç”¨IntentServiceç»§æ‰¿äº†Serviceå¹¶ä¸”å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå› æ­¤ä½¿ç”¨å®ƒå¿…é¡»åˆ›å»ºå®ƒçš„å­ç±»æ‰èƒ½ä½¿ç”¨ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªMyIntentServiceï¼Œæ¥å¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243public class MyIntentService extends IntentService &#123; private static final String TAG = \"MyIntentService\"; private boolean isRunning = true; private int count = 0; public MyIntentService() &#123; super(\"MyIntentService\"); &#125; @Override public void onCreate() &#123; super.onCreate(); &#125; @Override protected void onHandleIntent(Intent intent) &#123; try &#123; //æŸ¥çœ‹çº¿ç¨‹id Log.i(TAG, intent.getStringExtra(\"params\") + \", çº¿ç¨‹id:\" + Thread.currentThread().getId()); Thread.sleep(1000); //ä»0-100æ¸å¢ isRunning = true; count = 0; while (isRunning) &#123; count++; Log.i(TAG, \"MyIntentService çº¿ç¨‹è¿è¡Œä¸­...\" + count); if (count &gt;= 100) &#123; isRunning = false; &#125; Thread.sleep(50); &#125; &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; @Override public void onDestroy() &#123; super.onDestroy(); &#125;&#125; ç„¶åå¯åŠ¨æœåŠ¡ä¹‹å‰åˆ«å¿˜äº†åœ¨manifestæ–‡ä»¶ä¸­æ³¨å†Œè¿™ä¸ªServiceï¼š 12// åœ¨ Manifest ä¸­æ³¨å†ŒæœåŠ¡&lt;service android:name=\".service.MyIntentService\"/&gt; æœ€åæ˜¯å¯åŠ¨æœåŠ¡ï¼Œå°±å’Œæ™®é€šServiceä¸€æ ·å¯åŠ¨ï¼š1234// åƒå¯åŠ¨ Service é‚£æ ·å¯åŠ¨ IntentServiceIntent intent= new Intent(getActivity(), MyIntentService.class);intent.putExtra(\"params\", \"testString...\");getActivity().startService(intent); åˆ°æ­¤ï¼Œé€šè¿‡IntentServiceæ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡å·²ç»å¼€å§‹æ‰§è¡Œäº†ï¼Œå½“æ‰§è¡Œå®Œæ¯•ä¹‹åå®ƒä¼šè‡ªåŠ¨åœæ­¢è€Œä¸ç”¨æˆ‘ä»¬æ‰‹åŠ¨æ“ä½œã€‚ å½“è¿™ä¸ªMyIntentServiceå¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬çœ‹åˆ°å®ƒæ¥æ”¶åˆ°äº†æ¶ˆæ¯å¹¶æ‰“å°å‡ºäº†ä¼ é€’è¿‡å»çš„intentå‚æ•°ï¼ŒåŒæ—¶æ˜¾ç¤ºonHandlerIntentæ–¹æ³•æ‰§è¡Œçš„çº¿ç¨‹IDå¹¶éä¸»çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæœçœŸå¼€äº†ä¸€ä¸ªé¢å¤–çš„çº¿ç¨‹ï¼Œä»€ä¹ˆæ—¶å€™å¼€å¯çš„å‘¢ï¼Ÿæˆ‘ä»¬è¿›å…¥IntentServiceæºç çœ‹çœ‹ã€‚ IntentServiceæºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475//IntentServiceç»§æ‰¿äº†Serviceå¹¶ä¸”å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå› æ­¤ä½¿ç”¨å®ƒå¿…é¡»åˆ›å»ºå®ƒçš„å­ç±»æ‰èƒ½ä½¿ç”¨ã€‚public abstract class IntentService extends Service &#123; private volatile Looper mServiceLooper; private volatile ServiceHandler mServiceHandler; private String mName; private boolean mRedelivery; private final class ServiceHandler extends Handler &#123; public ServiceHandler(Looper looper) &#123; super(looper); &#125; @Override public void handleMessage(Message msg) &#123; // onHandleIntent æ–¹æ³•åœ¨å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæ‰§è¡Œå®Œè°ƒç”¨ stopSelf() ç»“æŸæœåŠ¡ã€‚ onHandleIntent((Intent)msg.obj); stopSelf(msg.arg1); &#125; &#125; public IntentService(String name) &#123; super(); mName = name; &#125; public void setIntentRedelivery(boolean enabled) &#123; mRedelivery = enabled; &#125; @Override public void onCreate() &#123; // TODO: It would be nice to have an option to hold a partial wakelock // during processing, and to have a static startService(Context, Intent) // method that would launch the service &amp; hand off a wakelock. super.onCreate(); HandlerThread thread = new HandlerThread(\"IntentService[\" + mName + \"]\"); thread.start(); mServiceLooper = thread.getLooper(); mServiceHandler = new ServiceHandler(mServiceLooper); &#125; @Override public void onStart(@Nullable Intent intent, int startId) &#123; Message msg = mServiceHandler.obtainMessage(); msg.arg1 = startId; msg.obj = intent; mServiceHandler.sendMessage(msg); &#125; @Override public int onStartCommand(@Nullable Intent intent, int flags, int startId) &#123; onStart(intent, startId); return mRedelivery ? START_REDELIVER_INTENT : START_NOT_STICKY; &#125; @Override public void onDestroy() &#123; mServiceLooper.quit(); &#125; @Override @Nullable public IBinder onBind(Intent intent) &#123; return null; &#125; @WorkerThread protected abstract void onHandleIntent(@Nullable Intent intent);&#125; ä»£ç è¿˜æ˜¯ç›¸å½“çš„ç®€æ´çš„ï¼Œé¦–å…ˆé€šè¿‡å®šä¹‰æˆ‘ä»¬å¯ä»¥çŸ¥é“IntentServiceæ˜¯ä¸€ä¸ªServiceï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç»§æ‰¿IntentServiceçš„æ—¶å€™éœ€è¦å®ç°å…¶æŠ½è±¡æ–¹æ³•ï¼šonHandlerIntentã€‚ 1. å¯åŠ¨ IntentService ä¸ºä»€ä¹ˆä¸éœ€è¦æ–°å»ºçº¿ç¨‹ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„onCreate()å‡½æ•°ï¼š 123456789101112131415private volatile ServiceHandler mServiceHandler;@Overridepublic void onCreate() &#123; super.onCreate(); // HandlerThread ç»§æ‰¿è‡ª Threadï¼Œå†…éƒ¨å°è£…äº† Looperï¼Œåœ¨è¿™é‡Œæ–°å»ºçº¿ç¨‹å¹¶å¯åŠ¨ï¼Œæ‰€ä»¥å¯åŠ¨ IntentService ä¸éœ€è¦æ–°å»ºçº¿ç¨‹ã€‚ HandlerThread thread = new HandlerThread(\"IntentService[\" + mName + \"]\"); thread.start(); // è·å¾—å·¥ä½œçº¿ç¨‹çš„ Looperï¼Œå¹¶ç»´æŠ¤è‡ªå·±çš„æ¶ˆæ¯é˜Ÿåˆ—MessageQueue mServiceLooper = thread.getLooper(); // mServiceHandler æ˜¯å±äºè¿™ä¸ªå·¥ä½œçº¿ç¨‹çš„ mServiceHandler = new ServiceHandler(mServiceLooper);&#125; æˆ‘ä»¬å¯ä»¥å‘ç°å…¶å†…éƒ¨å®šä¹‰ä¸€ä¸ªHandlerThreadï¼ˆæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå«æœ‰æ¶ˆæ¯é˜Ÿåˆ—çš„çº¿ç¨‹ï¼‰ã€‚ç„¶åç”¨æˆå‘˜å˜é‡ç»´æŠ¤å…¶Looperå’ŒHandlerï¼Œç”±äºå…¶Handlerï¼ˆä¹Ÿå°±æ˜¯mServiceHandlerå¯¹è±¡ï¼‰å…³è”ç€è¿™ä¸ªHandlerThreadçš„Looperå¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¸ªServiceHandlerçš„handleMessageæ–¹æ³•åœ¨HandlerThreadçº¿ç¨‹ä¸­æ‰§è¡Œã€‚ ç„¶åæˆ‘ä»¬å‘ç°å…¶onStartCommandæ–¹æ³•å°±æ˜¯è°ƒç”¨çš„å…¶onStartæ–¹æ³•ï¼Œå…·ä½“çœ‹ä¸€ä¸‹å…¶onStartæ–¹æ³•ï¼š 1234567@Overridepublic void onStart(@Nullable Intent intent, int startId) &#123; Message msg = mServiceHandler.obtainMessage(); msg.arg1 = startId; msg.obj = intent; mServiceHandler.sendMessage(msg);&#125; å¾ˆç®€å•å°±æ˜¯å°†startIdå’Œå¯åŠ¨æ—¶æ¥å—åˆ°çš„intentå¯¹è±¡ä¼ é€’åˆ°ServiceHandlerçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­å¤„ç†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…·ä½“çœ‹ä¸€ä¸‹ServiceHandlerçš„å¤„ç†é€»è¾‘ï¼š 123456789101112private final class ServiceHandler extends Handler &#123; public ServiceHandler(Looper looper) &#123; super(looper); &#125; @Override public void handleMessage(Message msg) &#123; // onHandleIntent æ–¹æ³•åœ¨å·¥ä½œçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæ‰§è¡Œå®Œè°ƒç”¨ stopSelf() ç»“æŸæœåŠ¡ã€‚ onHandleIntent((Intent)msg.obj); stopSelf(msg.arg1); &#125;&#125; å¯ä»¥çœ‹åˆ°èµ·handleMessageæ–¹æ³•å†…éƒ¨æ‰§è¡Œäº†ä¸¤ä¸ªé€»è¾‘ï¼š ä¸€ä¸ªæ˜¯è°ƒç”¨äº†å…¶onHandlerIntent()æŠ½è±¡æ–¹æ³•ï¼Œåœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚ äºŒæ˜¯è°ƒç”¨äº†stopSelf()æ–¹æ³•ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯stopSelfæ–¹æ³•ä¼ é€’äº†msg.arg1å‚æ•°ï¼Œä»åˆšåˆšçš„onStartæ–¹æ³•æˆ‘ä»¬å¯ä»¥çŸ¥é“æˆ‘ä»¬ä¼ é€’äº†startIdï¼Œè¿™æ˜¯ç”±äºserviceå¯ä»¥å¯åŠ¨å¤šæ¬¡ï¼Œå¯ä»¥ä¼ é€’Næ¬¡æ¶ˆæ¯ï¼Œå½“IntentServiceçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­å«æœ‰æ¶ˆæ¯æ—¶è°ƒç”¨stopSelf(startId)å¹¶ä¸ä¼šç«‹å³stopè‡ªå·±ï¼Œåªæœ‰å½“æ¶ˆæ¯é˜Ÿåˆ—ä¸­æœ€åä¸€ä¸ªæ¶ˆæ¯è¢«æ‰§è¡Œå®Œæˆæ—¶æ‰ä¼šçœŸæ­£çš„stopè‡ªèº«ã€‚ 2. ä¸ºä»€ä¹ˆä¸å»ºè®®é€šè¿‡ bindService() å¯åŠ¨ IntentServiceï¼Ÿæˆ‘ä»¬çœ‹IntentServiceçš„onBind()æ–¹æ³•ï¼š 1234@Overridepublic IBinder onBind(Intent intent) &#123; return null;&#125; IntentService æºç ä¸­çš„ onBind() é»˜è®¤è¿”å› nullï¼Œä¸é€‚åˆ bindService() å¯åŠ¨æœåŠ¡ï¼Œå¦‚æœä½ æ‰§æ„è¦ bindService() æ¥å¯åŠ¨ IntentServiceï¼Œå¯èƒ½å› ä¸ºä½ æƒ³é€šè¿‡ Binder æˆ– Messenger ä½¿å¾— IntentService å’Œ Activity å¯ä»¥é€šä¿¡ï¼Œè¿™æ · onHandleIntent() å°±ä¸ä¼šè¢«å›è°ƒï¼Œç›¸å½“äºåœ¨ä½ ä½¿ç”¨ Service è€Œä¸æ˜¯ IntentServiceã€‚ æ€»ç»“IntentService æ˜¯ç»§æ‰¿è‡ª Service å¹¶å¤„ç†å¼‚æ­¥è¯·æ±‚çš„ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œåœ¨ IntentService å†…æœ‰ä¸€ä¸ªå·¥ä½œçº¿ç¨‹æ¥å¤„ç†è€—æ—¶æ“ä½œï¼Œå½“ä»»åŠ¡æ‰§è¡Œå®Œåï¼ŒIntentService ä¼šè‡ªåŠ¨åœæ­¢ï¼Œä¸éœ€è¦æˆ‘ä»¬å»æ‰‹åŠ¨ç»“æŸã€‚å¦‚æœå¯åŠ¨ IntentService å¤šæ¬¡ï¼Œé‚£ä¹ˆæ¯ä¸€ä¸ªè€—æ—¶æ“ä½œä¼šä»¥å·¥ä½œé˜Ÿåˆ—çš„æ–¹å¼åœ¨ IntentService çš„ onHandleIntent å›è°ƒæ–¹æ³•ä¸­æ‰§è¡Œï¼Œä¾æ¬¡å»æ‰§è¡Œï¼Œæ‰§è¡Œå®Œè‡ªåŠ¨ç»“æŸã€‚ IntentServiceæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š 1ï¼‰. å®ƒåˆ›å»ºäº†ä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œçº¿ç¨‹æ¥å¤„ç†æ‰€æœ‰çš„é€šè¿‡onStartCommand()ä¼ é€’ç»™æœåŠ¡çš„intentsã€‚2ï¼‰. åˆ›å»ºäº†ä¸€ä¸ªå·¥ä½œé˜Ÿåˆ—ï¼Œæ¥é€ä¸ªå‘é€intentç»™onHandleIntent()ã€‚3ï¼‰. ä¸éœ€è¦ä¸»åŠ¨è°ƒç”¨stopSelft()æ¥ç»“æŸæœåŠ¡ã€‚å› ä¸ºï¼Œåœ¨æ‰€æœ‰çš„intentè¢«å¤„ç†å®Œåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å…³é—­æœåŠ¡ã€‚4ï¼‰. é»˜è®¤å®ç°çš„onBind()è¿”å›null5ï¼‰. é»˜è®¤å®ç°çš„onStartCommand()çš„ç›®çš„æ˜¯å°†intentæ’å…¥åˆ°å·¥ä½œé˜Ÿåˆ—ä¸­ ç»§æ‰¿IntentServiceçš„ç±»è‡³å°‘è¦å®ç°ä¸¤ä¸ªå‡½æ•°ï¼šæ„é€ å‡½æ•°å’ŒonHandleIntent()å‡½æ•°ã€‚è¦è¦†ç›–IntentServiceçš„å…¶å®ƒå‡½æ•°æ—¶ï¼Œæ³¨æ„è¦é€šè¿‡superè°ƒç”¨çˆ¶ç±»çš„å¯¹åº”çš„å‡½æ•°ã€‚ å‚è€ƒèµ„æ–™ Androidæºç è§£æä¹‹ï¼ˆäº”ï¼‰â€“&gt;IntentService IntentService ç¤ºä¾‹ä¸è¯¦è§£","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"http://github.com/tags/æºç åˆ†æ/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘EventBus 3.0 æºç åˆ†æ","slug":"ã€Androidã€‘EventBus 3.0æºç åˆ†æ","date":"2017-09-30T14:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/09/30/ã€Androidã€‘EventBus 3.0æºç åˆ†æ/","link":"","permalink":"http://github.com/2017/09/30/ã€Androidã€‘EventBus 3.0æºç åˆ†æ/","excerpt":"æ¦‚è¿°EventBusæ˜¯Androidä¸­ä¸€ä¸ªåŸºäºè§‚å¯Ÿè€…æ¨¡å¼çš„äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¡†æ¶ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡æå°‘çš„ä»£ç å»å®ç°å¤šä¸ªæ¨¡å—ä¹‹é—´çš„é€šä¿¡ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ›¿ä»£Intentï¼ŒHandlerï¼ŒBroadCast åœ¨ Fragmentï¼ŒActivityï¼ŒServiceï¼Œçº¿ç¨‹Threadä¹‹é—´ä¼ é€’æ¶ˆæ¯ã€‚ä¼˜ç‚¹æ˜¯å¼€é”€å°ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šé™ä½å®ƒä»¬ä¹‹é—´çš„è€¦åˆã€‚ ç±»ä¼¼çš„åº“è¿˜æœ‰Otto ï¼Œä»Šå¤©å°±å¸¦å¤§å®¶ä¸€èµ·ç ”è¯» EventBus çš„æºç ã€‚ è¿™æ˜¯EventBusæºç ä¸­çš„ä»‹ç»ï¼š 12345678910/** * EventBus is a central publish/subscribe event system for Android. Events are posted (&#123;@link #post(Object)&#125;) to the * bus, which delivers it to subscribers that have a matching handler method for the event type. To receive events, * subscribers must register themselves to the bus using &#123;@link #register(Object)&#125;. Once registered, subscribers * receive events until &#123;@link #unregister(Object)&#125; is called. Event handling methods must be annotated by * &#123;@link Subscribe&#125;, must be public, return nothing (void), and have exactly one parameter * (the event). * * @author Markus Junginger, greenrobot */ EventBus æ˜¯Androidä¸Šçš„ä»¥å‘å¸ƒ\\è®¢é˜…äº‹ä»¶ä¸ºæ ¸å¿ƒçš„åº“ã€‚äº‹ä»¶ (event) é€šè¿‡ post() å‘é€åˆ°æ€»çº¿ï¼Œç„¶åå†åˆ†å‘åˆ°åŒ¹é…äº‹ä»¶ç±»å‹çš„è®¢é˜…è€… (subscribers) ã€‚è®¢é˜…è€…åªæœ‰åœ¨æ€»çº¿ä¸­æ³¨å†Œ (register) äº†æ‰èƒ½æ”¶åˆ°äº‹ä»¶ï¼Œæ³¨é”€ (unrigister) ä¹‹åå°±æ”¶ä¸åˆ°ä»»ä½•äº‹ä»¶äº†ã€‚äº‹ä»¶æ–¹æ³•å¿…é¡»å¸¦æœ‰ Subscribe çš„æ³¨è§£ï¼Œå¿…é¡»æ˜¯ public ï¼Œæ²¡æœ‰è¿”å›ç±»å‹ void å¹¶ä¸”åªèƒ½æœ‰ä¸€ä¸ªå‚æ•°ã€‚ EventBus3 ä¸ä¹‹å‰çš„ç›¸æ¯”ï¼Œå…¶ä¸»è¦å·®åˆ«åœ¨äºè®¢é˜…æ–¹æ³•å¯ä»¥ä¸å†ä»¥onEvent å¼€å¤´äº†ï¼Œæ”¹ä¸ºç”¨æ³¨è§£ã€‚","text":"æ¦‚è¿°EventBusæ˜¯Androidä¸­ä¸€ä¸ªåŸºäºè§‚å¯Ÿè€…æ¨¡å¼çš„äº‹ä»¶å‘å¸ƒ/è®¢é˜…æ¡†æ¶ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡æå°‘çš„ä»£ç å»å®ç°å¤šä¸ªæ¨¡å—ä¹‹é—´çš„é€šä¿¡ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ›¿ä»£Intentï¼ŒHandlerï¼ŒBroadCast åœ¨ Fragmentï¼ŒActivityï¼ŒServiceï¼Œçº¿ç¨‹Threadä¹‹é—´ä¼ é€’æ¶ˆæ¯ã€‚ä¼˜ç‚¹æ˜¯å¼€é”€å°ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šé™ä½å®ƒä»¬ä¹‹é—´çš„è€¦åˆã€‚ ç±»ä¼¼çš„åº“è¿˜æœ‰Otto ï¼Œä»Šå¤©å°±å¸¦å¤§å®¶ä¸€èµ·ç ”è¯» EventBus çš„æºç ã€‚ è¿™æ˜¯EventBusæºç ä¸­çš„ä»‹ç»ï¼š 12345678910/** * EventBus is a central publish/subscribe event system for Android. Events are posted (&#123;@link #post(Object)&#125;) to the * bus, which delivers it to subscribers that have a matching handler method for the event type. To receive events, * subscribers must register themselves to the bus using &#123;@link #register(Object)&#125;. Once registered, subscribers * receive events until &#123;@link #unregister(Object)&#125; is called. Event handling methods must be annotated by * &#123;@link Subscribe&#125;, must be public, return nothing (void), and have exactly one parameter * (the event). * * @author Markus Junginger, greenrobot */ EventBus æ˜¯Androidä¸Šçš„ä»¥å‘å¸ƒ\\è®¢é˜…äº‹ä»¶ä¸ºæ ¸å¿ƒçš„åº“ã€‚äº‹ä»¶ (event) é€šè¿‡ post() å‘é€åˆ°æ€»çº¿ï¼Œç„¶åå†åˆ†å‘åˆ°åŒ¹é…äº‹ä»¶ç±»å‹çš„è®¢é˜…è€… (subscribers) ã€‚è®¢é˜…è€…åªæœ‰åœ¨æ€»çº¿ä¸­æ³¨å†Œ (register) äº†æ‰èƒ½æ”¶åˆ°äº‹ä»¶ï¼Œæ³¨é”€ (unrigister) ä¹‹åå°±æ”¶ä¸åˆ°ä»»ä½•äº‹ä»¶äº†ã€‚äº‹ä»¶æ–¹æ³•å¿…é¡»å¸¦æœ‰ Subscribe çš„æ³¨è§£ï¼Œå¿…é¡»æ˜¯ public ï¼Œæ²¡æœ‰è¿”å›ç±»å‹ void å¹¶ä¸”åªèƒ½æœ‰ä¸€ä¸ªå‚æ•°ã€‚ EventBus3 ä¸ä¹‹å‰çš„ç›¸æ¯”ï¼Œå…¶ä¸»è¦å·®åˆ«åœ¨äºè®¢é˜…æ–¹æ³•å¯ä»¥ä¸å†ä»¥onEvent å¼€å¤´äº†ï¼Œæ”¹ä¸ºç”¨æ³¨è§£ã€‚ ä¸€ã€ä½¿ç”¨EventBus åœ¨Gradleä¸­æ·»åŠ ä¾èµ– 1compile 'org.greenrobot:eventbus:3.0.0' 1.1 åˆå§‹åŒ–EventBusé»˜è®¤æœ‰ä¸€ä¸ªå•ä¾‹ï¼Œå¯ä»¥é€šè¿‡getDefault()è·å–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡EventBus.builder()æ„é€ è‡ªå®šä¹‰çš„EventBusï¼Œæ¯”å¦‚è¦åº”ç”¨æˆ‘ä»¬ç”Ÿæˆå¥½çš„ç´¢å¼•æ—¶ï¼š 1EventBus mEventBus = EventBus.builder().addIndex(new MyEventBusIndex()).build(); å¦‚æœæƒ³æŠŠè‡ªå®šä¹‰çš„è®¾ç½®åº”ç”¨åˆ°EventBusé»˜è®¤çš„å•ä¾‹ä¸­ï¼Œåˆ™å¯ä»¥ç”¨installDefaultEventBus()æ–¹æ³•ï¼š 1EventBus.builder().addIndex(new MyEventBusIndex()).installDefaultEventBus(); 1.2 å®šä¹‰äº‹ä»¶æ‰€æœ‰èƒ½è¢«å®ä¾‹åŒ–ä¸ºObjectçš„å®ä¾‹éƒ½å¯ä»¥ä½œä¸ºäº‹ä»¶ï¼š 1234567public class MessageEvent &#123; public final String message; public MessageEvent(String message) &#123; this.message = message; &#125;&#125; åœ¨æœ€æ–°ç‰ˆçš„eventbus 3ä¸­å¦‚æœç”¨åˆ°äº†ç´¢å¼•åŠ é€Ÿï¼Œäº‹ä»¶ç±»çš„ä¿®é¥°ç¬¦å¿…é¡»ä¸ºpublicï¼Œä¸ç„¶ç¼–è¯‘æ—¶ä¼šæŠ¥é”™ï¼šSubscriber method must be publicã€‚ 1.3 ç›‘å¬äº‹ä»¶è®¢é˜…è€…éœ€è¦åœ¨æ€»çº¿ä¸Šæ³¨å†Œå’Œæ³¨é”€è‡ªå·±ã€‚åªæœ‰å½“è®¢é˜…è€…æ³¨å†Œäº†æ‰èƒ½æ¥æ”¶åˆ°äº‹ä»¶ã€‚åœ¨Androidä¸­ï¼Œé€šå¸¸ä¸ Activity å’Œ Fragment çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šåœ¨ä¸€èµ·ã€‚ ä¹‹å‰2.xç‰ˆæœ¬ä¸­æœ‰å››ç§æ³¨å†Œæ–¹æ³•ï¼ŒåŒºåˆ†äº†æ™®é€šæ³¨å†Œå’Œç²˜æ€§äº‹ä»¶æ³¨å†Œï¼Œå¹¶ä¸”åœ¨æ³¨å†Œæ—¶å¯ä»¥é€‰æ‹©æ¥æ”¶äº‹ä»¶çš„ä¼˜å…ˆçº§ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä¸å¯¹2.xç‰ˆæœ¬åšè¿‡å¤šçš„ç ”ç©¶äº†ã€‚ç”±äº3.0ç‰ˆæœ¬å°†ç²˜æ€§äº‹ä»¶ä»¥åŠè®¢é˜…äº‹ä»¶çš„ä¼˜å…ˆçº§æ¢æˆäº†æ³¨è§£çš„å®ç°æ–¹å¼ï¼Œæ‰€ä»¥3.0ç‰ˆæœ¬ä¸­çš„æ³¨å†Œå°±å˜å¾—ç®€å•ï¼Œåªæœ‰ä¸€ä¸ªregister()æ–¹æ³•å³å¯ã€‚ 12345678//3.0ç‰ˆæœ¬çš„æ³¨å†ŒEventBus.getDefault().register(this); //2.xç‰ˆæœ¬çš„å››ç§æ³¨å†Œæ–¹æ³•EventBus.getDefault().register(this);EventBus.getDefault().register(this, 100);EventBus.getDefault().registerSticky(this);EventBus.getDefault().registerSticky(this, 100); å½“æˆ‘ä»¬ä¸åœ¨éœ€è¦æ¥æ”¶äº‹ä»¶çš„æ—¶å€™éœ€è¦è§£é™¤æ³¨å†Œunregisterï¼Œ2.xå’Œ3.0çš„è§£é™¤æ³¨å†Œä¹Ÿæ˜¯ç›¸åŒçš„ã€‚ä»£ç å¦‚ä¸‹: 12//å–æ¶ˆæ³¨å†ŒEventBus.getDefault().unregister(this); æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åçš„å¤„ç†æ–¹å¼ï¼Œåœ¨2.xç‰ˆæœ¬ä¸­ï¼Œæ³¨å†Œè¿™äº›æ¶ˆæ¯çš„ç›‘å¬éœ€è¦åŒºåˆ†æ˜¯å¦ç›‘å¬é»æ€§ï¼ˆstickyï¼‰äº‹ä»¶ï¼Œç›‘å¬EventBusäº‹ä»¶çš„æ¨¡å—éœ€è¦å®ç°ä»¥onEventå¼€å¤´çš„æ–¹æ³•ã€‚å¦‚ä»Š3.0æ”¹ä¸ºåœ¨æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£çš„å½¢å¼ï¼š 12345678910111213//3.0ç‰ˆæœ¬@Subscribe(threadMode = ThreadMode.POSTING, priority = 0, sticky = true)public void handleEvent(DriverEvent event) &#123; Log.d(TAG, event.info);&#125;//2.xç‰ˆæœ¬public void onEvent(String str) &#123;&#125;public void onEventMainThread(String str) &#123;&#125;public void onEventBackgroundThread(String str) &#123;&#125; åœ¨2.xç‰ˆæœ¬ä¸­åªæœ‰é€šè¿‡onEventå¼€å¤´çš„æ–¹æ³•ä¼šè¢«æ³¨å†Œï¼Œè€Œä¸”å“åº”äº‹ä»¶æ–¹æ³•è§¦å‘çš„çº¿ç¨‹é€šè¿‡onEventMainThreadæˆ–onEventBackgroundThreadè¿™äº›æ–¹æ³•ååŒºåˆ†ï¼Œè€Œåœ¨3.0ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡@Subscribeæ³¨è§£ï¼Œæ¥ç¡®å®šè¿è¡Œçš„çº¿ç¨‹threadModeï¼Œæ˜¯å¦æ¥å—ç²˜æ€§äº‹ä»¶stickyä»¥åŠäº‹ä»¶ä¼˜å…ˆçº§priorityï¼Œè€Œä¸”æ–¹æ³•åä¸åœ¨éœ€è¦onEventå¼€å¤´ï¼Œæ‰€ä»¥åˆç®€æ´çµæ´»äº†ä¸å°‘ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ³¨è§£@Subscribeæœ‰ä¸‰ä¸ªå‚æ•°ï¼ŒthreadModeä¸ºå›è°ƒæ‰€åœ¨çš„çº¿ç¨‹ï¼Œpriorityä¸ºä¼˜å…ˆçº§ï¼Œstickyä¸ºæ˜¯å¦æ¥æ”¶é»æ€§äº‹ä»¶ã€‚è°ƒåº¦å•ä½ä»ç±»ç»†åŒ–åˆ°äº†æ–¹æ³•ï¼Œå¯¹æ–¹æ³•çš„å‘½åä¹Ÿæ²¡æœ‰äº†è¦æ±‚ï¼Œæ–¹ä¾¿æ··æ·†ä»£ç ã€‚ä½†æ³¨å†Œäº†ç›‘å¬çš„æ¨¡å—å¿…é¡»æœ‰ä¸€ä¸ªæ ‡æ³¨äº†Subscribeæ³¨è§£æ–¹æ³•ï¼Œä¸ç„¶åœ¨registeræ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼š 1Subscriber class XXX and its super classes have no public methods with the @Subscribe annotation 1.4 å‘é€äº‹ä»¶å¯ä»¥ä»ä»£ç çš„ä»»ä½•åœ°æ–¹è°ƒç”¨postæˆ–è€…postStickyå‘é€äº‹ä»¶ï¼Œæ­¤æ—¶æ³¨å†Œäº†çš„ä¸”åŒ¹é…äº‹ä»¶çš„è®¢é˜…è€…èƒ½å¤Ÿæ¥æ”¶åˆ°äº‹ä»¶ã€‚ 1EventBus.getDefault().post(new MessageEvent(\"Hello everyone!\")); åœ¨å®é™…é¡¹ç›®çš„ä½¿ç”¨ä¸­ï¼Œregisterå’Œunregisteré€šå¸¸ä¸Activityå’ŒFragmentçš„ç”Ÿå‘½å‘¨æœŸç›¸å…³ï¼ŒThreadMode.MainThreadå¯ä»¥å¾ˆå¥½åœ°è§£å†³Androidçš„ç•Œé¢åˆ·æ–°å¿…é¡»åœ¨UIçº¿ç¨‹çš„é—®é¢˜ï¼Œä¸éœ€è¦å†å›è°ƒåç”¨Handlerä¸­è½¬ï¼ˆEventBusä¸­å·²ç»è‡ªåŠ¨ç”¨Handleråšäº†å¤„ç†ï¼‰ï¼Œé»æ€§äº‹ä»¶å¯ä»¥å¾ˆå¥½åœ°è§£å†³postä¸registeråŒæ—¶æ‰§è¡Œæ—¶çš„å¼‚æ­¥é—®é¢˜ï¼ˆè¿™ä¸ªåœ¨åŸç†ä¸­ä¼šè¯´åˆ°ï¼‰ï¼Œäº‹ä»¶çš„ä¼ é€’ä¹Ÿæ²¡æœ‰åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„æ€§èƒ½æ¶ˆè€—ï¼Œè¶³ä»¥æ»¡è¶³æˆ‘ä»¬å¤§éƒ¨åˆ†æƒ…å†µä¸‹çš„æ¨¡å—é—´é€šä¿¡éœ€æ±‚ã€‚ äºŒã€EventBusæºç è·Ÿè¸ªæˆ‘ä»¬é€šè¿‡EventBusçš„ä½¿ç”¨æµç¨‹æ¥è·Ÿè¸ªåˆ†æå®ƒçš„è°ƒç”¨æµç¨‹ï¼Œé€šè¿‡æˆ‘ä»¬ç†Ÿæ‚‰çš„ä½¿ç”¨æ–¹æ³•æ¥æ·±å…¥åˆ°EventBusçš„å®ç°å†…éƒ¨å¹¶ç†è§£å®ƒçš„å®ç°åŸç†ã€‚ 2.1 åˆ›å»ºEventBuså¯¹è±¡å…ˆçœ‹çœ‹ getDefault() : 12345678910111213static volatile EventBus defaultInstance;/** Convenience singleton for apps using a process-wide EventBus instance. */public static EventBus getDefault() &#123; if (defaultInstance == null) &#123; synchronized (EventBus.class) &#123; if (defaultInstance == null) &#123; defaultInstance = new EventBus(); &#125; &#125; &#125; return defaultInstance;&#125; è¿™é‡Œå°±æ˜¯è®¾è®¡æ¨¡å¼é‡Œæˆ‘ä»¬å¸¸ç”¨çš„å•ä¾‹æ¨¡å¼ï¼Œç”¨åˆ°äº†double checkã€‚ä¿è¯äº†getDefault()å¾—åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹ã€‚å¦‚æœä¸å­˜åœ¨å®ä¾‹ï¼Œå°±è°ƒç”¨äº†EventBusçš„æ„é€ æ–¹æ³•: 123456789101112131415161718192021222324252627282930313233343536373839404142/** * æ„é€ å‡½æ•°å¯ä»¥åˆ›å»ºå¤šä¸ªä¸åŒçš„EventBusï¼Œä¸åŒçš„å®ä¾‹ä¹‹é—´å¯ä»¥ç›¸äº’éš”ç¦»ï¼Œå¦‚æœåªæƒ³ä½¿ç”¨åŒä¸€ä¸ªæ€»çº¿ï¼Œå°±ç›´æ¥ä½¿ç”¨getDefault()æ–¹æ³•è·å–å•ä¾‹ * * Creates a new EventBus instance; each instance is a separate scope in which events are delivered. To use a * central bus, consider &#123;@link #getDefault()&#125;. */public EventBus() &#123; this(DEFAULT_BUILDER);&#125;EventBus(EventBusBuilder builder) &#123; //key:è®¢é˜…çš„äº‹ä»¶,value:è®¢é˜…è¿™ä¸ªäº‹ä»¶çš„æ‰€æœ‰è®¢é˜…è€…é›†åˆ //private final Map&lt;Class&lt;?&gt;, CopyOnWriteArrayList&lt;Subscription&gt;&gt; subscriptionsByEventType; subscriptionsByEventType = new HashMap&lt;&gt;(); //key:è®¢é˜…è€…å¯¹è±¡,value:è¿™ä¸ªè®¢é˜…è€…è®¢é˜…çš„äº‹ä»¶é›†åˆ //private final Map&lt;Object, List&lt;Class&lt;?&gt;&gt;&gt; typesBySubscriber; typesBySubscriber = new HashMap&lt;&gt;(); //ç²˜æ€§äº‹ä»¶ key:ç²˜æ€§äº‹ä»¶çš„classå¯¹è±¡, value:äº‹ä»¶å¯¹è±¡ //private final Map&lt;Class&lt;?&gt;, Object&gt; stickyEvents; stickyEvents = new ConcurrentHashMap&lt;&gt;(); //äº‹ä»¶ä¸»çº¿ç¨‹å¤„ç† mainThreadPoster = new HandlerPoster(this, Looper.getMainLooper(), 10); //äº‹ä»¶ Background å¤„ç† backgroundPoster = new BackgroundPoster(this); //äº‹ä»¶å¼‚æ­¥çº¿ç¨‹å¤„ç† asyncPoster = new AsyncPoster(this); indexCount = builder.subscriberInfoIndexes != null ? builder.subscriberInfoIndexes.size() : 0; //è®¢é˜…è€…å“åº”å‡½æ•°ä¿¡æ¯å­˜å‚¨å’ŒæŸ¥æ‰¾ç±» subscriberMethodFinder = new SubscriberMethodFinder(builder.subscriberInfoIndexes, builder.strictMethodVerification, builder.ignoreGeneratedIndex); logSubscriberExceptions = builder.logSubscriberExceptions; logNoSubscriberMessages = builder.logNoSubscriberMessages; sendSubscriberExceptionEvent = builder.sendSubscriberExceptionEvent; sendNoSubscriberEvent = builder.sendNoSubscriberEvent; throwSubscriberException = builder.throwSubscriberException; //æ˜¯å¦æ”¯æŒäº‹ä»¶ç»§æ‰¿ eventInheritance = builder.eventInheritance; executorService = builder.executorService;&#125; ä»€ä¹ˆï¼Œæ—¢ç„¶æ˜¯å•ä¾‹æ¨¡å¼æ„é€ å‡½æ•°è¿˜æ˜¯ public ï¼Ÿæ²¡é”™ï¼Œè¿™æ ·çš„è®¾è®¡æ˜¯å› ä¸ºä¸ä»…ä»…å¯ä»¥åªæœ‰ä¸€æ¡æ€»çº¿ï¼Œè¿˜å¯ä»¥æœ‰å…¶ä»–çš„çº¿ (bus) ï¼Œè®¢é˜…è€…å¯ä»¥æ³¨å†Œåˆ°ä¸åŒçš„çº¿ä¸Šçš„ EventBusï¼Œé€šè¿‡ä¸åŒçš„ EventBus å®ä¾‹æ¥å‘é€æ•°æ®ï¼Œä¸åŒçš„ EventBus æ˜¯ç›¸äº’éš”ç¦»å¼€çš„ï¼Œè®¢é˜…è€…éƒ½åªä¼šæ”¶åˆ°æ³¨å†Œåˆ°è¯¥çº¿ä¸Šäº‹ä»¶ã€‚ ç„¶åæˆ‘ä»¬è¯´ä¸€ä¸‹æ„é€ å‡½æ•°é‡Œè¿™ä¸‰ä¸ª HasMapã€‚ subscriptionsByEventType æ˜¯ä»¥ event ä¸º keyï¼Œsubscriberåˆ—è¡¨ ä¸º valueï¼Œå½“å‘é€ event çš„æ—¶å€™ï¼Œéƒ½æ˜¯å»è¿™é‡Œæ‰¾å¯¹åº”çš„è®¢é˜…è€…ã€‚ typesBySubscriber æ˜¯ä»¥ subscriber ä¸º keyï¼Œeventåˆ—è¡¨ä¸º valueï¼Œå½“ register() å’Œ unregister() çš„æ—¶å€™éƒ½æ˜¯æ“ä½œè¿™ä¸ªmapï¼ŒåŒæ—¶å¯¹ subscriptionsByEventType è¿›è¡Œå¯¹ç”¨æ“ä½œã€‚ stickyEvents ç»´æŠ¤çš„æ˜¯ç²˜æ€§äº‹ä»¶ï¼Œç²˜æ€§äº‹ä»¶ä¹Ÿå°±æ˜¯å½“ event å‘é€å‡ºå»ä¹‹åå†æ³¨å†Œç²˜æ€§äº‹ä»¶çš„è¯ï¼Œè¯¥ç²˜æ€§äº‹ä»¶ä¹Ÿèƒ½æ”¶åˆ°ä¹‹å‰å‘é€å‡ºå»çš„ eventã€‚ åŒæ—¶æ„é€ å‡½æ•°ä¸­è¿˜åˆ›å»ºäº† 3 ä¸ª poster ï¼šHandlerPoster ï¼ŒBackgroundPosterå’ŒAsyncPosterï¼Œè¿™ 3 ä¸ª poster è´Ÿè´£çº¿ç¨‹é—´è°ƒåº¦ï¼Œç¨åçš„äº‹ä»¶åˆ†å‘æ¨¡å—æˆ‘ä»¬ä¼šè¯¦ç»†è®²åˆ°ã€‚æˆ‘ä»¬æ¥ç€çœ‹è¿™ä¸ªæ„é€ å‡½æ•°ä¸­ï¼Œæœ€ç»ˆè¿ç”¨åˆ°äº†builderè®¾è®¡æ¨¡å¼ï¼Œé‚£ä¹ˆæ¥çœ‹çœ‹è¿™ä¸ª EventBusBuilder ä¸­æœ‰å“ªäº›å‚æ•°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647public class EventBusBuilder &#123; //çº¿ç¨‹æ±  private final static ExecutorService DEFAULT_EXECUTOR_SERVICE = Executors.newCachedThreadPool(); //å½“è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°å¼‚å¸¸æ—¶æ˜¯å¦æ‰“å°å¼‚å¸¸ä¿¡æ¯ boolean logSubscriberExceptions = true; //å½“æ²¡æœ‰è®¢é˜…è€…è®¢é˜…è¯¥äº‹ä»¶æ—¶æ˜¯å¦æ‰“å°æ—¥å¿— boolean logNoSubscriberMessages = true; //å½“è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°å¼‚å¸¸æ—¶æ˜¯å¦å‘é€ SubscriberExceptionEvent äº‹ä»¶ boolean sendSubscriberExceptionEvent = true; //å½“æ²¡æœ‰äº‹ä»¶å¤„ç†å‡½æ•°å¯¹äº‹ä»¶å¤„ç†æ—¶æ˜¯å¦å‘é€ NoSubscriberEvent äº‹ä»¶ boolean sendNoSubscriberEvent = true; //æ˜¯å¦è¦æŠ›å‡ºå¼‚å¸¸ï¼Œå»ºè®®debugå¼€å¯ boolean throwSubscriberException; //ä¸eventæœ‰ç»§æ‰¿å…³ç³»çš„ç±»æ˜¯å¦éœ€è¦å‘é€ boolean eventInheritance = true; //æ˜¯å¦å¿½ç•¥ç”Ÿæˆçš„ç´¢å¼•(SubscriberInfoIndex) boolean ignoreGeneratedIndex; //æ˜¯å¦ä¸¥æ ¼çš„æ–¹æ³•åæ ¡éªŒ boolean strictMethodVerification; //çº¿ç¨‹æ± ï¼Œasync å’Œ background çš„äº‹ä»¶ä¼šç”¨åˆ° ExecutorService executorService = DEFAULT_EXECUTOR_SERVICE; //å½“æ³¨å†Œçš„æ—¶å€™ä¼šè¿›è¡Œæ–¹æ³•åçš„æ ¡éªŒ(EventBus3ä¹‹å‰æ–¹æ³•åå¿…é¡»ä»¥onEventå¼€å¤´)ï¼Œè€Œè¿™ä¸ªåˆ—è¡¨æ˜¯ä¸å‚åŠ æ ¡éªŒçš„ç±»çš„åˆ—è¡¨(EventBus3ä¹‹åå°±æ²¡ç”¨è¿™ä¸ªå‚æ•°äº†) List&lt;Class&lt;?&gt;&gt; skipMethodVerificationForClasses; //ç»´æŠ¤ç€ç”±EventBusç”Ÿæˆçš„ç´¢å¼•(SubscriberInfoIndex) List&lt;SubscriberInfoIndex&gt; subscriberInfoIndexes; EventBusBuilder() &#123; &#125; //èµ‹å€¼buidler(å¯ç”¨æˆ·è‡ªå®šä¹‰çš„)ç»™å•ä¾‹çš„EventBusï¼Œå¦‚æœå•ä¾‹çš„EventBusä¸ä¸ºnulläº†ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ public EventBus installDefaultEventBus() &#123; synchronized (EventBus.class) &#123; if (EventBus.defaultInstance != null) &#123; throw new EventBusException(\"Default instance already exists.\" + \" It may be only set once before it's used the first time to ensure consistent behavior.\"); &#125; EventBus.defaultInstance = build(); return EventBus.defaultInstance; &#125; &#125; public EventBus build() &#123; return new EventBus(this); &#125; //...çœç•¥å…¶ä»–ä»£ç ...&#125; å¯ä»¥çœ‹å‡ºæ˜¯é€šè¿‡åˆå§‹åŒ–äº†ä¸€ä¸ªEventBusBuilder()å¯¹è±¡æ¥åˆ†åˆ«åˆå§‹åŒ–EventBusçš„ä¸€äº›é…ç½®ï¼Œæ³¨é‡Šé‡Œæˆ‘æ ‡æ³¨äº†å¤§éƒ¨åˆ†æ¯”è¾ƒé‡è¦çš„å¯¹è±¡ï¼Œè¿™é‡Œæ²¡å¿…è¦è®°ä½ï¼Œçœ‹ä¸‹é¢çš„æ–‡ç« æ—¶å¦‚æœå¯¹æŸä¸ªå¯¹è±¡ä¸äº†è§£ï¼Œå¯ä»¥å†å›æ¥çœ‹çœ‹ã€‚ 2.2 æ³¨å†Œä¸è®¢é˜…RegisterEventBus 3.0çš„æ³¨å†Œå…¥å£åªæä¾›ä¸€ä¸ªregister()æ–¹æ³•äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹register()æ–¹æ³•åšäº†ä»€ä¹ˆï¼š 12345678910111213public void register(Object subscriber) &#123; //é¦–å…ˆè·å¾—è®¢é˜…è€…çš„classå¯¹è±¡ Class&lt;?&gt; subscriberClass = subscriber.getClass(); //é€šè¿‡subscriberMethodFinderæ¥æ‰¾åˆ°è®¢é˜…è€…è®¢é˜…äº†å“ªäº›äº‹ä»¶.è¿”å›ä¸€ä¸ªSubscriberMethodå¯¹è±¡çš„List List&lt;SubscriberMethod&gt; subscriberMethods = subscriberMethodFinder.findSubscriberMethods(subscriberClass); synchronized (this) &#123; for (SubscriberMethod subscriberMethod : subscriberMethods) &#123; //è®¢é˜… subscribe(subscriber, subscriberMethod); &#125; &#125;&#125; å¯ä»¥çœ‹åˆ°register()æ–¹æ³•å¾ˆç®€æ´ï¼Œä»£ç é‡Œçš„æ³¨é‡Šä¹Ÿå¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºé€šè¿‡subscriberMethodFinder.findSubscriberMethods(subscriberClass)æ–¹æ³•å°±èƒ½è¿”å›ä¸€ä¸ªSubscriberMethodçš„å¯¹è±¡ï¼Œè€ŒSubscriberMethodé‡ŒåŒ…å«äº†æ‰€æœ‰æˆ‘ä»¬éœ€è¦çš„æ¥ä¸‹æ¥æ‰§è¡Œsubscribe()çš„ä¿¡æ¯ã€‚ é‚£ SubscriberMethodé‡ŒåŒ…å«äº†ä»€ä¹ˆå‘¢ï¼Ÿä¸‹é¢æ˜¯å®ƒçš„å˜é‡å’Œæ„é€ å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°é‡Œé¢åŒ…æ‹¬è®¢é˜…ç±»é‡Œçš„å…·ä½“æ‰§è¡Œæ–¹æ³•Methodå¯¹è±¡ï¼Œéœ€è¦åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡ŒThreadModeï¼Œäº‹ä»¶ç±»å‹eventTypeï¼Œä¼˜å…ˆçº§priorityï¼Œä»¥åŠæ˜¯å¦æ¥æ”¶ç²˜æ€§stickyäº‹ä»¶ã€‚ 12345678910111213141516171819public class SubscriberMethod &#123; final Method method; //å…·ä½“çš„æ‰§è¡Œæ–¹æ³• final ThreadMode threadMode; //æ‰§è¡Œçº¿ç¨‹ final Class&lt;?&gt; eventType; //äº‹ä»¶ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œæ–¹æ³•æ¥å—çš„å‚æ•°ç±»å‹ final int priority; //ä¼˜å…ˆçº§ final boolean sticky; //æ˜¯å¦ç²˜æ€§ï¼Œä¹‹åä¼šè®²åˆ° /** Used for efficient comparison */ String methodString; public SubscriberMethod(Method method, Class&lt;?&gt; eventType, ThreadMode threadMode, int priority, boolean sticky) &#123; this.method = method; this.threadMode = threadMode; this.eventType = eventType; this.priority = priority; this.sticky = sticky; &#125; //...çœç•¥å…¶ä»–ä»£ç ...&#125; ç„¶åæˆ‘ä»¬å»çœ‹çœ‹SubscriberMethodFinderç±»çš„findSubscriberMethods()æ˜¯æ€ä¹ˆæ‰¾åˆ°è®¢é˜…æ–¹æ³•çš„ï¼Œæœ€åæˆ‘ä»¬å†å»å…³æ³¨subscribe()ã€‚ SubscriberMethodFinderçš„å®ç° ä»å­—é¢ç†è§£ï¼Œè¿™ä¸ªç±»å°±æ˜¯è®¢é˜…è€…æ–¹æ³•å‘ç°è€…ã€‚ä¸€å¥è¯æ¥æè¿°SubscriberMethodFinderç±»å°±æ˜¯ç”¨æ¥æŸ¥æ‰¾å’Œç¼“å­˜è®¢é˜…è€…å“åº”å‡½æ•°çš„ä¿¡æ¯çš„ç±»ã€‚æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“æ€ä¹ˆèƒ½è·å¾—è®¢é˜…è€…å“åº”å‡½æ•°çš„ç›¸å…³ä¿¡æ¯ã€‚åœ¨3.0ç‰ˆæœ¬ä¸­ï¼ŒEventBusæä¾›äº†ä¸€ä¸ªEventBusAnnotationProcessoræ³¨è§£å¤„ç†å™¨æ¥åœ¨ç¼–è¯‘æœŸé€šè¿‡è¯»å–@Subscribe()æ³¨è§£å¹¶è§£æï¼Œå¤„ç†å…¶ä¸­æ‰€åŒ…å«çš„ä¿¡æ¯ï¼Œç„¶åç”Ÿæˆjavaç±»æ¥ä¿å­˜æ‰€æœ‰è®¢é˜…è€…å…³äºè®¢é˜…çš„ä¿¡æ¯ï¼Œè¿™æ ·å°±æ¯”åœ¨è¿è¡Œæ—¶ä½¿ç”¨åå°„æ¥è·å¾—è¿™äº›è®¢é˜…è€…çš„ä¿¡æ¯é€Ÿåº¦è¦å¿«ã€‚æˆ‘ä»¬å¯ä»¥å‚è€ƒEventBusé¡¹ç›®é‡Œçš„EventBusPerformanceè¿™ä¸ªä¾‹å­ï¼Œç¼–è¯‘åæˆ‘ä»¬å¯ä»¥åœ¨buildæ–‡ä»¶å¤¹é‡Œæ‰¾åˆ°è¿™ä¸ªç±»ï¼ŒMyEventBusIndex ç±»ï¼Œå½“ç„¶ç±»åæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ã€‚æˆ‘ä»¬å¤§è‡´çœ‹ä¸€ä¸‹ç”Ÿæˆçš„MyEventBusIndexç±»æ˜¯ä»€ä¹ˆæ ·çš„: 123456789101112131415161718192021222324252627282930313233/** * This class is generated by EventBus, do not edit. */public class MyEventBusIndex implements SubscriberInfoIndex &#123; private static final Map&lt;Class&lt;?&gt;, SubscriberInfo&gt; SUBSCRIBER_INDEX; static &#123; SUBSCRIBER_INDEX = new HashMap&lt;Class&lt;?&gt;, SubscriberInfo&gt;(); putIndex(new SimpleSubscriberInfo(org.greenrobot.eventbusperf.testsubject.PerfTestEventBus.SubscriberClassEventBusAsync.class, true, new SubscriberMethodInfo[]&#123; new SubscriberMethodInfo(\"onEventAsync\", TestEvent.class, ThreadMode.ASYNC), &#125;)); putIndex(new SimpleSubscriberInfo(TestRunnerActivity.class, true, new SubscriberMethodInfo[]&#123; new SubscriberMethodInfo(\"onEventMainThread\", TestFinishedEvent.class, ThreadMode.MAIN), &#125;)); &#125; private static void putIndex(SubscriberInfo info) &#123; SUBSCRIBER_INDEX.put(info.getSubscriberClass(), info); &#125; @Override public SubscriberInfo getSubscriberInfo(Class&lt;?&gt; subscriberClass) &#123; SubscriberInfo info = SUBSCRIBER_INDEX.get(subscriberClass); if (info != null) &#123; return info; &#125; else &#123; return null; &#125; &#125;&#125; å¯ä»¥çœ‹å‡ºæ˜¯ä½¿ç”¨ä¸€ä¸ªé™æ€HashMapå³ï¼šSUBSCRIBER_INDEXæ¥ä¿å­˜è®¢é˜…ç±»çš„ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬äº†è®¢é˜…ç±»çš„classå¯¹è±¡ï¼Œæ˜¯å¦éœ€è¦æ£€æŸ¥çˆ¶ç±»ï¼Œä»¥åŠè®¢é˜…æ–¹æ³•çš„ä¿¡æ¯SubscriberMethodInfoçš„æ•°ç»„ï¼ŒSubscriberMethodInfoä¸­åˆä¿å­˜äº†ï¼Œè®¢é˜…æ–¹æ³•çš„æ–¹æ³•åï¼Œè®¢é˜…çš„äº‹ä»¶ç±»å‹ï¼Œè§¦å‘çº¿ç¨‹ï¼Œæ˜¯å¦æ¥æ”¶stickyäº‹ä»¶ä»¥åŠä¼˜å…ˆçº§priorityã€‚è¿™å…¶ä¸­å°±ä¿å­˜äº†register()çš„æ‰€æœ‰éœ€è¦çš„ä¿¡æ¯ï¼Œå¦‚æœå†é…ç½®EventBusçš„æ—¶å€™é€šè¿‡EventBusBuilderé…ç½®ï¼ševentBus = EventBus.builder().addIndex(new MyEventBusIndex()).build();æ¥å°†ç¼–è¯‘ç”Ÿæˆçš„MyEventBusIndexé…ç½®è¿›å»ï¼Œè¿™æ ·å°±èƒ½åœ¨SubscriberMethodFinderç±»ä¸­ç›´æ¥æŸ¥æ‰¾å‡ºè®¢é˜…ç±»çš„ä¿¡æ¯ï¼Œå°±ä¸éœ€è¦å†åˆ©ç”¨æ³¨è§£åˆ¤æ–­äº†ï¼Œå½“ç„¶è¿™ç§æ–¹æ³•æ˜¯ä½œä¸ºEventBusçš„å¯é€‰é…ç½®ï¼ŒSubscriberMethodFinderåŒæ ·æä¾›äº†é€šè¿‡æ³¨è§£æ¥è·å¾—è®¢é˜…ç±»ä¿¡æ¯çš„æ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹findSubscriberMethods()åˆ°åº•æ˜¯å¦‚ä½•å®ç°çš„ï¼š 123456789101112131415161718192021222324List&lt;SubscriberMethod&gt; findSubscriberMethods(Class&lt;?&gt; subscriberClass) &#123; //å…ˆä»METHOD_CACHEå–çœ‹æ˜¯å¦æœ‰ç¼“å­˜, key:ä¿å­˜è®¢é˜…ç±»çš„ç±»å,value:ä¿å­˜ç±»ä¸­è®¢é˜…çš„æ–¹æ³•æ•°æ®, List&lt;SubscriberMethod&gt; subscriberMethods = METHOD_CACHE.get(subscriberClass); if (subscriberMethods != null) &#123; return subscriberMethods; &#125; //æ˜¯å¦å¿½ç•¥æ³¨è§£å™¨ç”Ÿæˆçš„MyEventBusIndexç±» if (ignoreGeneratedIndex) &#123; //åˆ©ç”¨åå°„æ¥è¯»å–è®¢é˜…ç±»ä¸­çš„è®¢é˜…æ–¹æ³•ä¿¡æ¯ subscriberMethods = findUsingReflection(subscriberClass); &#125; else &#123; //ä»æ³¨è§£å™¨ç”Ÿæˆçš„MyEventBusIndexç±»ä¸­è·å¾—è®¢é˜…ç±»çš„è®¢é˜…æ–¹æ³•ä¿¡æ¯ subscriberMethods = findUsingInfo(subscriberClass); &#125; if (subscriberMethods.isEmpty()) &#123; throw new EventBusException(\"Subscriber \" + subscriberClass + \" and its super classes have no public methods with the @Subscribe annotation\"); &#125; else &#123; //ä¿å­˜è¿›METHOD_CACHEç¼“å­˜ METHOD_CACHE.put(subscriberClass, subscriberMethods); return subscriberMethods; &#125;&#125; æˆ‘ä»¬çœ‹çœ‹åˆ©ç”¨åå°„æ¥è¯»å–è®¢é˜…ç±»ä¸­çš„è®¢é˜…æ–¹æ³•ä¿¡æ¯çš„å‡½æ•°ï¼šfindUsingReflection() 12345678910111213private List&lt;SubscriberMethod&gt; findUsingReflection(Class&lt;?&gt; subscriberClass) &#123; //FindState ç”¨æ¥åšè®¢é˜…æ–¹æ³•çš„æ ¡éªŒå’Œä¿å­˜ FindState findState = prepareFindState(); findState.initForSubscriber(subscriberClass); while (findState.clazz != null) &#123; //é€šè¿‡åå°„æ¥è·å¾—è®¢é˜…æ–¹æ³•ä¿¡æ¯ findUsingReflectionInSingleClass(findState); //æŸ¥æ‰¾çˆ¶ç±»çš„è®¢é˜…æ–¹æ³• findState.moveToSuperclass(); &#125; //è·å–findStateä¸­çš„SubscriberMethod(ä¹Ÿå°±æ˜¯è®¢é˜…æ–¹æ³•List)å¹¶è¿”å› return getMethodsAndRelease(findState);&#125; ä»¥åŠä»æ³¨è§£å™¨ç”Ÿæˆçš„MyEventBusIndexç±»ä¸­è·å¾—è®¢é˜…ç±»çš„è®¢é˜…æ–¹æ³•ä¿¡æ¯ï¼š findUsingInfo()ï¼š1234567891011121314151617181920212223private List&lt;SubscriberMethod&gt; findUsingInfo(Class&lt;?&gt; subscriberClass) &#123; FindState findState = prepareFindState(); findState.initForSubscriber(subscriberClass); while (findState.clazz != null) &#123; //å¾—åˆ°è®¢é˜…è€…ä¿¡æ¯ findState.subscriberInfo = getSubscriberInfo(findState); if (findState.subscriberInfo != null) &#123; //éå†è®¢é˜…è€…æ–¹æ³• SubscriberMethod[] array = findState.subscriberInfo.getSubscriberMethods(); for (SubscriberMethod subscriberMethod : array) &#123; if (findState.checkAdd(subscriberMethod.method, subscriberMethod.eventType)) &#123; findState.subscriberMethods.add(subscriberMethod); &#125; &#125; &#125; else &#123; //å¦‚æœæ²¡æœ‰è®¢é˜…è€…ä¿¡æ¯å°±ä½¿ç”¨åå°„æŸ¥æ‰¾è®¢é˜…æ–¹æ³• findUsingReflectionInSingleClass(findState); &#125; //è·³è½¬åˆ°çˆ¶ç±»ä¸­ç»§ç»­æŸ¥æ‰¾ findState.moveToSuperclass(); &#125; return getMethodsAndRelease(findState);&#125; è¿›å…¥åˆ°getSubscriberInfo() æ–¹æ³•ä¸­æˆ‘ä»¬çœ‹åˆ°äº†ä»è‡ªå®šä¹‰ç´¢å¼•Indexè·å–è®¢é˜…æ–¹æ³•ä¿¡æ¯çš„æ“ä½œï¼š 12345678910111213141516171819private SubscriberInfo getSubscriberInfo(FindState findState) &#123; //åˆ¤æ–­FindStateå¯¹è±¡ä¸­æ˜¯å¦æœ‰ç¼“å­˜çš„è®¢é˜…æ–¹æ³• if (findState.subscriberInfo != null &amp;&amp; findState.subscriberInfo.getSuperSubscriberInfo() != null) &#123; SubscriberInfo superclassInfo = findState.subscriberInfo.getSuperSubscriberInfo(); if (findState.clazz == superclassInfo.getSubscriberClass()) &#123; return superclassInfo; &#125; &#125; //ä»æ³¨è§£å™¨ç”Ÿæˆçš„MyEventBusIndexç±»ä¸­è·å¾—è®¢é˜…ç±»çš„è®¢é˜…æ–¹æ³•ä¿¡æ¯ if (subscriberInfoIndexes != null) &#123; for (SubscriberInfoIndex index : subscriberInfoIndexes) &#123; SubscriberInfo info = index.getSubscriberInfo(findState.clazz); if (info != null) &#123; return info; &#125; &#125; &#125; return null;&#125; ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä½œè€…ä½¿ç”¨äº†FindStateç±»æ¥åšè®¢é˜…æ–¹æ³•çš„æ ¡éªŒå’Œä¿å­˜ï¼Œå¹¶é€šè¿‡FIND_STATE_POOLé™æ€æ•°ç»„æ¥ä¿å­˜FindStateå¯¹è±¡ï¼Œå¯ä»¥ä½¿FindStateå¤ç”¨ï¼Œé¿å…é‡å¤åˆ›å»ºè¿‡å¤šçš„å¯¹è±¡ã€‚æœ€ç»ˆæ˜¯é€šè¿‡findUsingReflectionInSingleClass()æ¥å…·ä½“è·å¾—ç›¸å…³è®¢é˜…æ–¹æ³•çš„ä¿¡æ¯çš„ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950//åœ¨è¾ƒæ–°çš„ç±»æ–‡ä»¶ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šæ·»åŠ æ–¹æ³•ã€‚é‚£äº›è¢«ç§°ä¸ºBRIDGEæˆ–SYNTHETICæ–¹æ³•ã€‚EventBuså¿…é¡»å¿½ç•¥ä¸¤è€…ã€‚æœ‰ä¿®é¥°ç¬¦æ²¡æœ‰å…¬å¼€ï¼Œä½†åœ¨Javaç±»æ–‡ä»¶ä¸­æœ‰æ ¼å¼å®šä¹‰private static final int BRIDGE = 0x40;private static final int SYNTHETIC = 0x1000;//éœ€è¦å¿½ç•¥çš„ä¿®é¥°ç¬¦private static final int MODIFIERS_IGNORE = Modifier.ABSTRACT | Modifier.STATIC | BRIDGE | SYNTHETIC;private void findUsingReflectionInSingleClass(FindState findState) &#123; Method[] methods; //é€šè¿‡åå°„å¾—åˆ°æ–¹æ³•æ•°ç»„ try &#123; // This is faster than getMethods, especially when subscribers are fat classes like Activities methods = findState.clazz.getDeclaredMethods(); &#125; catch (Throwable th) &#123; // Workaround for java.lang.NoClassDefFoundError, see https://github.com/greenrobot/EventBus/issues/149 methods = findState.clazz.getMethods(); findState.skipSuperClasses = true; &#125; //éå†Method for (Method method : methods) &#123; int modifiers = method.getModifiers(); //å¿…é¡»æ˜¯publicçš„æ–¹æ³• if ((modifiers &amp; Modifier.PUBLIC) != 0 &amp;&amp; (modifiers &amp; MODIFIERS_IGNORE) == 0) &#123; Class&lt;?&gt;[] parameterTypes = method.getParameterTypes(); //ä¿è¯å¿…é¡»åªæœ‰ä¸€ä¸ªäº‹ä»¶å‚æ•° if (parameterTypes.length == 1) &#123; //å¾—åˆ°æ³¨è§£ Subscribe subscribeAnnotation = method.getAnnotation(Subscribe.class); if (subscribeAnnotation != null) &#123; Class&lt;?&gt; eventType = parameterTypes[0]; //æ ¡éªŒæ˜¯å¦æ·»åŠ è¯¥æ–¹æ³• if (findState.checkAdd(method, eventType)) &#123; ThreadMode threadMode = subscribeAnnotation.threadMode(); //å®ä¾‹åŒ–SubscriberMethodå¯¹è±¡å¹¶æ·»åŠ  findState.subscriberMethods.add(new SubscriberMethod(method, eventType, threadMode, subscribeAnnotation.priority(), subscribeAnnotation.sticky())); &#125; &#125; &#125; else if (strictMethodVerification &amp;&amp; method.isAnnotationPresent(Subscribe.class)) &#123; String methodName = method.getDeclaringClass().getName() + \".\" + method.getName(); throw new EventBusException(\"@Subscribe method \" + methodName + \"must have exactly 1 parameter but has \" + parameterTypes.length); &#125; &#125; else if (strictMethodVerification &amp;&amp; method.isAnnotationPresent(Subscribe.class)) &#123; String methodName = method.getDeclaringClass().getName() + \".\" + method.getName(); throw new EventBusException(methodName + \" is a illegal @Subscribe method: must be public, non-static, and non-abstract\"); &#125; &#125;&#125; å…³äº BRIDGE å’Œ SYNTHETIC ï¼Œæ³¨é‡Šå†™é“ï¼š In newer class files, compilers may add methods. Those are called bridge or synthetic methods. EventBus must ignore both. There modifiers are not public but defined in the Java class file format: http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.6-200-A.1 åœ¨è¾ƒæ–°çš„ç±»æ–‡ä»¶ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šæ·»åŠ æ–¹æ³•ã€‚é‚£äº›è¢«ç§°ä¸º BRIDGE æˆ– SYNTHETIC æ–¹æ³•ï¼ŒEventBus å¿…é¡»å¿½ç•¥ä¸¤è€…ã€‚æœ‰ä¿®é¥°ç¬¦æ²¡æœ‰å…¬å¼€ï¼Œä½†åœ¨ Java ç±»æ–‡ä»¶ä¸­æœ‰æ ¼å¼å®šä¹‰ã€‚ è¯¥findUsingReflectionInSingleClassæ–¹æ³•æµç¨‹æ˜¯ï¼š æ‹¿åˆ°å½“å‰ class çš„æ‰€æœ‰æ–¹æ³•ï¼› è¿‡æ»¤æ‰ä¸æ˜¯ public å’Œæ˜¯ abstractã€staticã€bridgeã€synthetic çš„æ–¹æ³•ï¼› è¿‡æ»¤å‡ºæ–¹æ³•å‚æ•°åªæœ‰ä¸€ä¸ªçš„æ–¹æ³•ï¼› è¿‡æ»¤å‡ºè¢«Subscribeæ³¨è§£ä¿®é¥°çš„æ–¹æ³•ï¼› å°† method æ–¹æ³•å’Œ event äº‹ä»¶æ·»åŠ åˆ° findState ä¸­ï¼› å°† EventBus å…³å¿ƒçš„ method æ–¹æ³•ã€event äº‹ä»¶ã€threadModeã€priorityã€sticky å°è£…æˆ SubscriberMethod å¯¹è±¡æ·»åŠ åˆ° findState.subscriberMethods åˆ—è¡¨ä¸­ï¼› è¿™é‡Œèµ°å®Œï¼Œæˆ‘ä»¬è®¢é˜…ç±»çš„æ‰€æœ‰SubscriberMethodéƒ½å·²ç»è¢«ä¿å­˜äº†ï¼Œæœ€åå†é€šè¿‡getMethodsAndRelease()è¿”å›List&lt;SubscriberMethod&gt;ã€‚è‡³æ­¤ï¼Œæ‰€æœ‰å…³äºå¦‚ä½•è·å¾—è®¢é˜…ç±»çš„è®¢é˜…æ–¹æ³•ä¿¡æ¯å³ï¼šSubscriberMethodå¯¹è±¡å°±å·²ç»å®Œå…¨åˆ†æå®Œäº†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹subscribe()æ˜¯å¦‚ä½•å®ç°çš„ã€‚ subscribe()æ–¹æ³•çš„å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354//å¿…é¡»åœ¨åŒæ­¥ä»£ç å—é‡Œè°ƒç”¨private void subscribe(Object subscriber, SubscriberMethod subscriberMethod) &#123; //è·å–è®¢é˜…çš„äº‹ä»¶ç±»å‹ Class&lt;?&gt; eventType = subscriberMethod.eventType; //åˆ›å»ºSubscriptionå¯¹è±¡ Subscription newSubscription = new Subscription(subscriber, subscriberMethod); //ä»subscriptionsByEventTypeé‡Œæ£€æŸ¥æ˜¯å¦å·²ç»æ·»åŠ è¿‡è¯¥Subscription,å¦‚æœæ·»åŠ è¿‡å°±æŠ›å‡ºå¼‚å¸¸,ä¹Ÿå°±æ˜¯æ¯ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå‡½æ•°å“åº”åŒä¸€ç§äº‹ä»¶ç±»å‹ CopyOnWriteArrayList&lt;Subscription&gt; subscriptions = subscriptionsByEventType.get(eventType); if (subscriptions == null) &#123; subscriptions = new CopyOnWriteArrayList&lt;&gt;(); subscriptionsByEventType.put(eventType, subscriptions); &#125; else &#123; if (subscriptions.contains(newSubscription)) &#123; throw new EventBusException(\"Subscriber \" + subscriber.getClass() + \" already registered to event \" + eventType); &#125; &#125; //æ ¹æ®ä¼˜å…ˆçº§priorityæ¥æ·»åŠ Subscriptionå¯¹è±¡ int size = subscriptions.size(); for (int i = 0; i &lt;= size; i++) &#123; if (i == size || subscriberMethod.priority &gt; subscriptions.get(i).subscriberMethod.priority) &#123; subscriptions.add(i, newSubscription); break; &#125; &#125; //å°†è®¢é˜…è€…å¯¹è±¡ä»¥åŠè®¢é˜…çš„äº‹ä»¶ä¿å­˜åˆ°typesBySubscriberé‡Œ. List&lt;Class&lt;?&gt;&gt; subscribedEvents = typesBySubscriber.get(subscriber); if (subscribedEvents == null) &#123; subscribedEvents = new ArrayList&lt;&gt;(); typesBySubscriber.put(subscriber, subscribedEvents); &#125; subscribedEvents.add(eventType); //å¦‚æœæ¥æ”¶stickyäº‹ä»¶,ç«‹å³åˆ†å‘stickyäº‹ä»¶ if (subscriberMethod.sticky) &#123; //eventInheritance è¡¨ç¤ºæ˜¯å¦åˆ†å‘è®¢é˜…äº†å“åº”äº‹ä»¶ç±»çˆ¶ç±»äº‹ä»¶çš„æ–¹æ³• if (eventInheritance) &#123; // Existing sticky events of all subclasses of eventType have to be considered. // Note: Iterating over all events may be inefficient with lots of sticky events, // thus data structure should be changed to allow a more efficient lookup // (e.g. an additional map storing sub classes of super classes: Class -&gt; List&lt;Class&gt;). Set&lt;Map.Entry&lt;Class&lt;?&gt;, Object&gt;&gt; entries = stickyEvents.entrySet(); for (Map.Entry&lt;Class&lt;?&gt;, Object&gt; entry : entries) &#123; Class&lt;?&gt; candidateEventType = entry.getKey(); if (eventType.isAssignableFrom(candidateEventType)) &#123; Object stickyEvent = entry.getValue(); checkPostStickyEventToSubscription(newSubscription, stickyEvent); &#125; &#125; &#125; else &#123; Object stickyEvent = stickyEvents.get(eventType); checkPostStickyEventToSubscription(newSubscription, stickyEvent); &#125; &#125;&#125; ä»¥ä¸Šå°±æ˜¯æ‰€æœ‰æ³¨å†Œè¿‡ç¨‹ï¼Œç°åœ¨å†æ¥çœ‹è¿™å¼ å›¾å°±ä¼šç‰¹åˆ«æ¸…æ™°EventBusçš„register()è¿‡ç¨‹äº†: åˆ°è¿™é‡Œï¼Œè®¢é˜…æµç¨‹å°±èµ°å®Œäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨çœ‹äº‹ä»¶åˆ†å‘çš„æµç¨‹ã€‚ 2.3 å‘é€äº‹ä»¶Postæˆ‘ä»¬çŸ¥é“å‘é€äº‹ä»¶æ˜¯é€šè¿‡post() æ–¹æ³•è¿›è¡Œå¹¿æ’­çš„ï¼Œæ¯”å¦‚ç¬¬ä¸€èŠ‚æˆ‘ä»¬ä¾‹å­ä¸­æåˆ°çš„EventBus.getDefault().post(new MessageEvent(&quot;Hello everyone!&quot;)); æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥è¿™ä¸ªpost()æ–¹æ³•ä¸€çª¥ç©¶ç«Ÿï¼š 1234567891011121314151617181920212223242526public void post(Object event) &#123; //å¾—åˆ°å½“å‰çº¿ç¨‹çš„PostingçŠ¶æ€. PostingThreadState postingState = currentPostingThreadState.get(); //è·å–å½“å‰çº¿ç¨‹çš„äº‹ä»¶é˜Ÿåˆ— List&lt;Object&gt; eventQueue = postingState.eventQueue; eventQueue.add(event); if (!postingState.isPosting) &#123; // è®°å½•å½“å‰å‘é€çº¿ç¨‹æ˜¯å¦ä¸ºä¸»çº¿ç¨‹ postingState.isMainThread = Looper.getMainLooper() == Looper.myLooper(); postingState.isPosting = true; if (postingState.canceled) &#123; throw new EventBusException(\"Internal error. Abort state was not reset\"); &#125; try &#123; //å¤„ç†é˜Ÿåˆ—ï¼Œä¸€ç›´å‘é€å®Œæ‰€æœ‰äº‹ä»¶ while (!eventQueue.isEmpty()) &#123; //å‘é€å•ä¸ªäº‹ä»¶ postSingleEvent(eventQueue.remove(0), postingState); &#125; &#125; finally &#123; postingState.isPosting = false; postingState.isMainThread = false; &#125; &#125;&#125; é¦–å…ˆæ˜¯é€šè¿‡currentPostingThreadState.get()æ–¹æ³•æ¥å¾—åˆ°å½“å‰çº¿ç¨‹PostingThreadStateçš„å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆæ˜¯è¯´å½“å‰çº¿ç¨‹ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹currentPostingThreadStateçš„å®ç°ï¼š 123456private final ThreadLocal&lt;PostingThreadState&gt; currentPostingThreadState = new ThreadLocal&lt;PostingThreadState&gt;() &#123; @Override protected PostingThreadState initialValue() &#123; return new PostingThreadState(); &#125;&#125;; å…¶å®ç°æ˜¯è¿”å›ä¸€ä¸ª PostingThreadState å¯¹è±¡ï¼Œè€Œ PostingThreadState ç±»çš„ç»“æ„å¦‚ä¸‹ï¼Œå°è£…çš„æ˜¯å½“å‰çº¿ç¨‹çš„ post ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº‹ä»¶é˜Ÿåˆ—ã€æ˜¯å¦æ­£åœ¨åˆ†å‘ä¸­ã€æ˜¯å¦åœ¨ä¸»çº¿ç¨‹ã€è®¢é˜…è€…ä¿¡æ¯ã€äº‹ä»¶å®ä¾‹ã€æ˜¯å¦å–æ¶ˆã€‚ 123456789/** For ThreadLocal, much faster to set (and get multiple values). */final static class PostingThreadState &#123; final List&lt;Object&gt; eventQueue = new ArrayList&lt;Object&gt;(); boolean isPosting; boolean isMainThread; Subscription subscription; Object event; boolean canceled;&#125; ç»¼ä¸Šï¼ŒcurrentPostingThreadStateçš„å®ç°æ˜¯ä¸€ä¸ªåŒ…å«äº†PostingThreadStateçš„ThreadLocalå¯¹è±¡ï¼Œå…³äºThreadLocalå¼ æ¶›çš„è¿™ç¯‡æ–‡ç« è§£é‡Šçš„å¾ˆå¥½ï¼šThreadLocal æ˜¯ä¸€ä¸ªçº¿ç¨‹å†…éƒ¨çš„æ•°æ®å­˜å‚¨ç±»ï¼Œé€šè¿‡å®ƒå¯ä»¥åœ¨æŒ‡å®šçš„çº¿ç¨‹ä¸­å­˜å‚¨æ•°æ®ï¼Œè€Œè¿™æ®µæ•°æ®æ˜¯ä¸ä¼šä¸å…¶ä»–çº¿ç¨‹å…±äº«çš„ã€‚ å…¶å†…éƒ¨åŸç†æ˜¯é€šè¿‡ç”Ÿæˆä¸€ä¸ªå®ƒåŒ…è£¹çš„æ³›å‹å¯¹è±¡çš„æ•°ç»„ï¼Œåœ¨ä¸åŒçš„çº¿ç¨‹ä¼šæœ‰ä¸åŒçš„æ•°ç»„ç´¢å¼•å€¼ï¼Œé€šè¿‡è¿™æ ·å°±å¯ä»¥åšåˆ°æ¯ä¸ªçº¿ç¨‹é€šè¿‡get() æ–¹æ³•è·å–çš„æ—¶å€™ï¼Œå–åˆ°çš„åªèƒ½æ˜¯è‡ªå·±çº¿ç¨‹æ‰€å¯¹åº”çš„æ•°æ®ã€‚ æ‰€ä»¥è¿™é‡Œå–åˆ°çš„å°±æ˜¯æ¯ä¸ªçº¿ç¨‹çš„PostingThreadStateçŠ¶æ€.æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹postSingleEvent()ï¼š 123456789101112131415161718192021222324252627282930private void postSingleEvent(Object event, PostingThreadState postingState) throws Error &#123; Class&lt;?&gt; eventClass = event.getClass(); boolean subscriptionFound = false; //æ˜¯å¦è§¦å‘è®¢é˜…äº†è¯¥äº‹ä»¶(eventClass)çš„çˆ¶ç±»,ä»¥åŠæ¥å£çš„ç±»çš„å“åº”æ–¹æ³• if (eventInheritance) &#123; //æŸ¥æ‰¾eventClassç±»æ‰€æœ‰çš„çˆ¶ç±»ä»¥åŠæ¥å£ List&lt;Class&lt;?&gt;&gt; eventTypes = lookupAllEventTypes(eventClass); int countTypes = eventTypes.size(); //å¾ªç¯postSingleEventForEventType for (int h = 0; h &lt; countTypes; h++) &#123; Class&lt;?&gt; clazz = eventTypes.get(h); //åªè¦å³è¾¹æœ‰ä¸€ä¸ªä¸ºtrue,subscriptionFoundå°±ä¸ºtrue subscriptionFound |= postSingleEventForEventType(event, postingState, clazz); &#125; &#125; else &#123; //postå•ä¸ª subscriptionFound = postSingleEventForEventType(event, postingState, eventClass); &#125; //å¦‚æœæ²¡å‘ç° if (!subscriptionFound) &#123; if (logNoSubscriberMessages) &#123; Log.d(TAG, \"No subscribers registered for event \" + eventClass); &#125; if (sendNoSubscriberEvent &amp;&amp; eventClass != NoSubscriberEvent.class &amp;&amp; eventClass != SubscriberExceptionEvent.class) &#123; //å‘é€ä¸€ä¸ªNoSubscriberEventäº‹ä»¶,å¦‚æœæˆ‘ä»¬éœ€è¦å¤„ç†è¿™ç§çŠ¶æ€,æ¥æ”¶è¿™ä¸ªäº‹ä»¶å°±å¯ä»¥äº† post(new NoSubscriberEvent(this, event)); &#125; &#125;&#125; lookupAllEventTypes() å°±æ˜¯æŸ¥æ‰¾è¯¥äº‹ä»¶çš„æ‰€æœ‰çˆ¶ç±»ï¼Œè¿”å›æ‰€æœ‰çš„è¯¥äº‹ä»¶çš„çˆ¶ç±»çš„ class ã€‚å®ƒé€šè¿‡å¾ªç¯å’Œé€’å½’ä¸€èµ·ç”¨ï¼Œå°†ä¸€ä¸ªç±»çš„çˆ¶ç±»ï¼ˆæ¥å£ï¼‰å…¨éƒ¨æ·»åŠ åˆ°å…¨å±€é™æ€å˜é‡ eventTypes é›†åˆä¸­ã€‚è·Ÿç€ä¸Šé¢çš„ä»£ç çš„æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šçš„å‘ç°æ˜¯åœ¨postSingleEventForEventType()æ–¹æ³•é‡Œå»è¿›è¡Œäº‹ä»¶çš„åˆ†å‘ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657private boolean postSingleEventForEventType(Object event, PostingThreadState postingState, Class&lt;?&gt; eventClass) &#123; CopyOnWriteArrayList&lt;Subscription&gt; subscriptions; //è·å–è®¢é˜…äº†è¿™ä¸ªäº‹ä»¶çš„Subscriptionåˆ—è¡¨. synchronized (this) &#123; subscriptions = subscriptionsByEventType.get(eventClass); &#125; if (subscriptions != null &amp;&amp; !subscriptions.isEmpty()) &#123; for (Subscription subscription : subscriptions) &#123; postingState.event = event; postingState.subscription = subscription; //æ˜¯å¦è¢«ä¸­æ–­ boolean aborted = false; try &#123; //åˆ†å‘ç»™è®¢é˜…è€… postToSubscription(subscription, event, postingState.isMainThread); aborted = postingState.canceled; &#125; finally &#123; postingState.event = null; postingState.subscription = null; postingState.canceled = false; &#125; if (aborted) &#123; break; &#125; &#125; return true; &#125; return false;&#125;private void postToSubscription(Subscription subscription, Object event, boolean isMainThread) &#123; //æ ¹æ®æ¥æ”¶è¯¥äº‹ä»¶çš„è®¢é˜…æ–¹æ³•çº¦å®šçš„ThreadModeå†³å®šåˆ†é…åˆ°å“ªä¸ªçº¿ç¨‹æ‰§è¡Œ switch (subscription.subscriberMethod.threadMode) &#123; case POSTING: invokeSubscriber(subscription, event); break; case MAIN: if (isMainThread) &#123; invokeSubscriber(subscription, event); &#125; else &#123; mainThreadPoster.enqueue(subscription, event); &#125; break; case BACKGROUND: if (isMainThread) &#123; backgroundPoster.enqueue(subscription, event); &#125; else &#123; invokeSubscriber(subscription, event); &#125; break; case ASYNC: asyncPoster.enqueue(subscription, event); break; default: throw new IllegalStateException(\"Unknown thread mode: \" + subscription.subscriberMethod.threadMode); &#125;&#125; æ€»ç»“ä¸Šé¢çš„ä»£ç å°±æ˜¯,é¦–å…ˆä»subscriptionsByEventTypeé‡Œè·å¾—æ‰€æœ‰è®¢é˜…äº†è¿™ä¸ªäº‹ä»¶çš„Subscriptionåˆ—è¡¨ï¼Œç„¶ååœ¨é€šè¿‡postToSubscription()æ–¹æ³•æ¥åˆ†å‘äº‹ä»¶ï¼Œåœ¨postToSubscription()é€šè¿‡ä¸åŒçš„threadModeåœ¨ä¸åŒçš„çº¿ç¨‹é‡Œinvoke()è®¢é˜…è€…çš„æ–¹æ³•,ThreadModeå…±æœ‰å››ç±»ï¼š PostThreadï¼šé»˜è®¤çš„ ThreadModeï¼Œè¡¨ç¤ºåœ¨æ‰§è¡Œ Post æ“ä½œçš„çº¿ç¨‹ç›´æ¥è°ƒç”¨è®¢é˜…è€…çš„äº‹ä»¶å“åº”æ–¹æ³•ï¼Œä¸è®ºè¯¥çº¿ç¨‹æ˜¯å¦ä¸ºä¸»çº¿ç¨‹ï¼ˆUI çº¿ç¨‹ï¼‰ã€‚å½“è¯¥çº¿ç¨‹ä¸ºä¸»çº¿ç¨‹æ—¶ï¼Œå“åº”æ–¹æ³•ä¸­ä¸èƒ½æœ‰è€—æ—¶æ“ä½œï¼Œå¦åˆ™æœ‰å¡ä¸»çº¿ç¨‹çš„é£é™©ã€‚é€‚ç”¨åœºæ™¯ï¼šå¯¹äºæ˜¯å¦åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œæ— è¦æ±‚ï¼Œä½†è‹¥ Post çº¿ç¨‹ä¸ºä¸»çº¿ç¨‹ï¼Œä¸èƒ½è€—æ—¶çš„æ“ä½œï¼› MainThreadï¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œå“åº”æ–¹æ³•ã€‚å¦‚æœå‘å¸ƒçº¿ç¨‹å°±æ˜¯ä¸»çº¿ç¨‹ï¼Œåˆ™ç›´æ¥è°ƒç”¨è®¢é˜…è€…çš„äº‹ä»¶å“åº”æ–¹æ³•ï¼Œå¦åˆ™é€šè¿‡ä¸»çº¿ç¨‹çš„ Handler å‘é€æ¶ˆæ¯åœ¨ä¸»çº¿ç¨‹ä¸­å¤„ç†â€”â€”è°ƒç”¨è®¢é˜…è€…çš„äº‹ä»¶å“åº”å‡½æ•°ã€‚æ˜¾ç„¶ï¼ŒMainThreadç±»çš„æ–¹æ³•ä¹Ÿä¸èƒ½æœ‰è€—æ—¶æ“ä½œï¼Œä»¥é¿å…å¡ä¸»çº¿ç¨‹ã€‚é€‚ç”¨åœºæ™¯ï¼šå¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„æ“ä½œï¼› BackgroundThreadï¼šåœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œå“åº”æ–¹æ³•ã€‚å¦‚æœå‘å¸ƒçº¿ç¨‹ä¸æ˜¯ä¸»çº¿ç¨‹ï¼Œåˆ™ç›´æ¥è°ƒç”¨è®¢é˜…è€…çš„äº‹ä»¶å“åº”å‡½æ•°ï¼Œå¦åˆ™å¯åŠ¨å”¯ä¸€çš„åå°çº¿ç¨‹å»å¤„ç†ã€‚ç”±äºåå°çº¿ç¨‹æ˜¯å”¯ä¸€çš„ï¼Œå½“äº‹ä»¶è¶…è¿‡ä¸€ä¸ªçš„æ—¶å€™ï¼Œå®ƒä»¬ä¼šè¢«æ”¾åœ¨é˜Ÿåˆ—ä¸­ä¾æ¬¡æ‰§è¡Œï¼Œå› æ­¤è¯¥ç±»å“åº”æ–¹æ³•è™½ç„¶æ²¡æœ‰PostThreadç±»å’ŒMainThreadç±»æ–¹æ³•å¯¹æ€§èƒ½æ•æ„Ÿï¼Œä½†æœ€å¥½ä¸è¦æœ‰é‡åº¦è€—æ—¶çš„æ“ä½œæˆ–å¤ªé¢‘ç¹çš„è½»åº¦è€—æ—¶æ“ä½œï¼Œä»¥é€ æˆå…¶ä»–æ“ä½œç­‰å¾…ã€‚é€‚ç”¨åœºæ™¯ï¼šæ“ä½œè½»å¾®è€—æ—¶ä¸”ä¸ä¼šè¿‡äºé¢‘ç¹ï¼Œå³ä¸€èˆ¬çš„è€—æ—¶æ“ä½œéƒ½å¯ä»¥æ”¾åœ¨è¿™é‡Œï¼› Asyncï¼šä¸è®ºå‘å¸ƒçº¿ç¨‹æ˜¯å¦ä¸ºä¸»çº¿ç¨‹ï¼Œéƒ½ä½¿ç”¨ä¸€ä¸ªç©ºé—²çº¿ç¨‹æ¥å¤„ç†ã€‚å’ŒBackgroundThreadä¸åŒçš„æ˜¯ï¼ŒAsyncç±»çš„æ‰€æœ‰çº¿ç¨‹æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå› æ­¤ä¸ä¼šå‡ºç°å¡çº¿ç¨‹çš„é—®é¢˜ã€‚é€‚ç”¨åœºæ™¯ï¼šé•¿è€—æ—¶æ“ä½œï¼Œä¾‹å¦‚ç½‘ç»œè®¿é—®ã€‚ è¿™é‡Œæˆ‘ä»¬å…ˆçœ‹çœ‹invokeSubscriber(subscription, event);æ˜¯å¦‚ä½•å®ç°çš„ï¼š 123456789void invokeSubscriber(Subscription subscription, Object event) &#123; try &#123; subscription.subscriberMethod.method.invoke(subscription.subscriber, event); &#125; catch (InvocationTargetException e) &#123; handleSubscriberException(subscription, event, e.getCause()); &#125; catch (IllegalAccessException e) &#123; throw new IllegalStateException(\"Unexpected exception\", e); &#125;&#125; å®é™…ä¸Šå°±æ˜¯é€šè¿‡åå°„è°ƒç”¨äº†è®¢é˜…è€…çš„è®¢é˜…å‡½æ•°å¹¶æŠŠeventå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ç„¶åæˆ‘ä»¬å°±åˆé‡åˆ°äº†åœ¨EventBusæ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çš„3ä¸ªPosterï¼šHandlerPosterï¼ˆä¹Ÿå°±æ˜¯ä»£ç ä¸­çš„mainThreadPosterå¯¹è±¡ï¼‰ ï¼ŒBackgroundPosterå’ŒAsyncPosterï¼Œè¿™ 3 ä¸ª poster è´Ÿè´£çº¿ç¨‹é—´è°ƒåº¦ã€‚æˆ‘ä»¬åˆ†åˆ«æ¥çœ‹çœ‹ï¼š # HandlerPoster 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970final class HandlerPoster extends Handler &#123; //é˜Ÿåˆ—ï¼Œå³å°†æ‰§è¡Œçš„Post private final PendingPostQueue queue; //ä¸€ä¸ªPostæœ€å¤§çš„åœ¨HandleMessageä¸­çš„æ—¶é—´ private final int maxMillisInsideHandleMessage; private final EventBus eventBus; //handleræ˜¯å¦è¿è¡Œèµ·æ¥äº† private boolean handlerActive; //EventBusçš„æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–äº†mainThreadPoster = new HandlerPoster(this, Looper.getMainLooper(), 10); //æ³¨æ„æ­¤å¤„çš„Looper.getMainLooper()ä¾¿æŒ‡å®šäº†ä¸»çº¿ç¨‹çš„Looper HandlerPoster(EventBus eventBus, Looper looper, int maxMillisInsideHandleMessage) &#123; super(looper); this.eventBus = eventBus; this.maxMillisInsideHandleMessage = maxMillisInsideHandleMessage; queue = new PendingPostQueue(); &#125; void enqueue(Subscription subscription, Object event) &#123; //PendingPostç»´æŠ¤äº†ä¸€ä¸ªå¯ä»¥å¤ç”¨PendingPostå¯¹è±¡çš„å¤ç”¨æ±  PendingPost pendingPost = PendingPost.obtainPendingPost(subscription, event); synchronized (this) &#123; //åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ queue.enqueue(pendingPost); //å¦‚æœhandleMessageæ²¡æœ‰è¿è¡Œèµ·æ¥ if (!handlerActive) &#123; handlerActive = true; //å‘é€ä¸€ä¸ªç©ºæ¶ˆæ¯ï¼Œè®©handleMessageè¿è¡Œèµ·æ¥ if (!sendMessage(obtainMessage())) &#123; throw new EventBusException(\"Could not send handler message\"); &#125; &#125; &#125; &#125; @Override public void handleMessage(Message msg) &#123; boolean rescheduled = false; try &#123; long started = SystemClock.uptimeMillis(); while (true) &#123; //ä»é˜Ÿåˆ—ä¸­å–å‡ºPendingPost PendingPost pendingPost = queue.poll(); if (pendingPost == null) &#123; synchronized (this) &#123; // Check again, this time in synchronized pendingPost = queue.poll(); if (pendingPost == null) &#123; handlerActive = false; return; &#125; &#125; &#125; //è°ƒç”¨eventBusçš„æ–¹æ³•ï¼Œåˆ†å‘æ¶ˆæ¯ eventBus.invokeSubscriber(pendingPost); long timeInMethod = SystemClock.uptimeMillis() - started; //å¦‚æœå†ä¸€å®šæ—¶é—´å†…éƒ½è¿˜æ²¡æœ‰å°†é˜Ÿåˆ—æ’ç©ºï¼Œåˆ™é€€å‡º if (timeInMethod &gt;= maxMillisInsideHandleMessage) &#123; if (!sendMessage(obtainMessage())) &#123; throw new EventBusException(\"Could not send handler message\"); &#125; rescheduled = true; return; &#125; &#125; &#125; finally &#123; handlerActive = rescheduled; &#125; &#125;&#125; æˆ‘ä»¬æœ‰å¿…è¦å›çœ‹EventBusçš„æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–äº†mainThreadPoster = new HandlerPoster(this, Looper.getMainLooper(), 10);çš„ä»£ç ã€‚æ³¨æ„è¿™è¡Œä»£ç ä¸­ä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°Looper.getMainLooper()ä¾¿æŒ‡å®šäº†ä¸»çº¿ç¨‹çš„Looperï¼Œä¿è¯äº†è¿™ä¸ªHandlerPosterçš„è¿è¡Œåœ¨ä¸»çº¿ç¨‹ã€‚ ç„¶åPendingPost çš„æ•°æ®ç»“æ„æ˜¯è¿™æ ·çš„ï¼š 12345final class PendingPost &#123; Object event;//äº‹ä»¶ Subscription subscription;//è®¢é˜… PendingPost next;//ä¸é˜Ÿåˆ—çš„æ•°æ®ç»“æ„æœ‰å…³ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹&#125; å…¶ä¸­ PendingPost ç»´æŠ¤ç€ä¸€ä¸ªå¯ä»¥å¤ç”¨PendingPostå¯¹è±¡çš„å¤ç”¨æ± ï¼Œé€šè¿‡ obtainPendingPost(Subscription, Object) æ–¹æ³•å¤ç”¨ï¼Œé€šè¿‡ releasePendingPost(PendingPost ) æ–¹æ³•å›æ”¶ã€‚ handleMessage() ä¸­æœ‰ä¸€ä¸ªæ­»å¾ªç¯ï¼Œè¿™ä¸ªæ­»å¾ªç¯ä¸åœçš„ä»é˜Ÿåˆ—ä¸­æ‹¿æ•°æ®ï¼Œç„¶åé€šè¿‡ EventBus.invokeSubscriber() åˆ†å‘å‡ºå»ã€‚æ¯åˆ†å‘å®Œä¸€æ¬¡æ¯”å¯¹ä¸€ä¸‹æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡äº† maxMillisInsideHandleMessage ï¼Œé‚£ä¹ˆå‘é€ç©º messageå†æ¬¡è¿›å…¥åˆ° handlerMessage ä¸­ä¸”é€€å‡ºæœ¬æ¬¡å¾ªç¯ã€‚ # BackgroundPoster 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859/** * Posts events in background. * @author Markus */ //æˆ‘ä»¬æ³¨æ„åˆ°å®ƒå®ç°äº†Runableæ¥å£final class BackgroundPoster implements Runnable &#123; private final PendingPostQueue queue; private final EventBus eventBus; private volatile boolean executorRunning; BackgroundPoster(EventBus eventBus) &#123; this.eventBus = eventBus; queue = new PendingPostQueue(); &#125; public void enqueue(Subscription subscription, Object event) &#123; PendingPost pendingPost = PendingPost.obtainPendingPost(subscription, event); synchronized (this) &#123; //åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ queue.enqueue(pendingPost); if (!executorRunning) &#123; executorRunning = true; //æŠŠè‡ªå·±è¿™ä¸ªRunableæŠ›å…¥çº¿ç¨‹æ± å¼€å§‹è¿è¡Œ eventBus.getExecutorService().execute(this); &#125; &#125; &#125; @Override public void run() &#123; try &#123; try &#123; while (true) &#123; //ä»é˜Ÿåˆ—ä¸­å–å‡ºPendingPostï¼Œæ­¤å¤„çš„1000è¡¨ç¤ºå¦‚æœé˜Ÿåˆ—ä¸ºç©ºå°±æš‚åœ1000æ¯«ç§’å†å– PendingPost pendingPost = queue.poll(1000); if (pendingPost == null) &#123; synchronized (this) &#123; // Check again, this time in synchronized pendingPost = queue.poll(); if (pendingPost == null) &#123; executorRunning = false; return; &#125; &#125; &#125; //è°ƒç”¨eventBusçš„æ–¹æ³•ï¼Œåˆ†å‘æ¶ˆæ¯ eventBus.invokeSubscriber(pendingPost); &#125; &#125; catch (InterruptedException e) &#123; Log.w(\"Event\", Thread.currentThread().getName() + \" was interruppted\", e); &#125; &#125; finally &#123; executorRunning = false; &#125; &#125;&#125; åŒç† BackgroundPoster ï¼Œåªä¸è¿‡ HandlerPoster æ˜¯åœ¨ handlerMessage ä¸­è¿›è¡Œåˆ†å‘æ“ä½œï¼Œè€Œ BackgroundPoster æ˜¯åœ¨ Runnable çš„ run æ–¹æ³•ä¸­å°†æ‰€æœ‰é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å–å‡ºè¿›è¡Œåˆ†å‘ï¼Œç›´åˆ°å–å®Œä¸ºæ­¢ã€‚ # AsyncPoster 12345678910111213141516171819202122232425262728293031/** * Posts events in background. * @author Markus */ //å®ƒä¹Ÿå®ç°Runableæ¥å£class AsyncPoster implements Runnable &#123; private final PendingPostQueue queue; private final EventBus eventBus; AsyncPoster(EventBus eventBus) &#123; this.eventBus = eventBus; queue = new PendingPostQueue(); &#125; public void enqueue(Subscription subscription, Object event) &#123; PendingPost pendingPost = PendingPost.obtainPendingPost(subscription, event); queue.enqueue(pendingPost); eventBus.getExecutorService().execute(this); &#125; @Override public void run() &#123; PendingPost pendingPost = queue.poll(); if(pendingPost == null) &#123; throw new IllegalStateException(\"No pending post available\"); &#125; eventBus.invokeSubscriber(pendingPost); &#125;&#125; è€Œ AsyncPoster è™½ç„¶ä¹Ÿæ˜¯åœ¨ Runnable çš„ run æ–¹æ³•ä¸­å–å‡ºé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œä½†æ˜¯åªå–ä¸€ä¸ªã€‚ä¸è®ºå‘å¸ƒçº¿ç¨‹æ˜¯å¦ä¸ºä¸»çº¿ç¨‹ï¼Œéƒ½ä½¿ç”¨ä¸€ä¸ªç©ºé—²çº¿ç¨‹æ¥å¤„ç†ã€‚å’ŒBackgroundThreadä¸åŒçš„æ˜¯ï¼ŒAsyncç±»çš„æ‰€æœ‰çº¿ç¨‹æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå› æ­¤ä¸ä¼šå‡ºç°å¡çº¿ç¨‹çš„é—®é¢˜ã€‚é€‚ç”¨åœºæ™¯ï¼šé•¿è€—æ—¶æ“ä½œï¼Œä¾‹å¦‚ç½‘ç»œè®¿é—®ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œä¸åŒçš„Posterä¼šåœ¨postäº‹ä»¶æ—¶ï¼Œè°ƒåº¦ç›¸åº”çš„äº‹ä»¶é˜Ÿåˆ—PendingPostQueueï¼Œè®©æ¯ä¸ªè®¢é˜…è€…çš„å›è°ƒæ–¹æ³•æ”¶åˆ°ç›¸åº”çš„äº‹ä»¶ï¼Œå¹¶åœ¨å…¶æ³¨å†Œçš„Threadä¸­è¿è¡Œã€‚è€Œè¿™ä¸ªäº‹ä»¶é˜Ÿåˆ—æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œç”±ä¸€ä¸ªä¸ªPendingPostç»„æˆï¼Œå…¶ä¸­åŒ…å«äº†äº‹ä»¶ï¼Œäº‹ä»¶è®¢é˜…è€…ï¼Œå›è°ƒæ–¹æ³•è¿™ä¸‰ä¸ªæ ¸å¿ƒå‚æ•°ï¼Œä»¥åŠéœ€è¦æ‰§è¡Œçš„ä¸‹ä¸€ä¸ªPendingPostã€‚è‡³æ­¤post()æµç¨‹å°±ç»“æŸäº†ï¼Œæ•´ä½“æµç¨‹å›¾å¦‚ä¸‹ï¼š 2.4 è§£é™¤æ³¨å†ŒUnregisterçœ‹å®Œäº†ä¸Šé¢çš„åˆ†æï¼Œè§£é™¤æ³¨å†Œå°±ç›¸å¯¹å®¹æ˜“äº†ï¼Œè§£é™¤æ³¨å†Œåªè¦è°ƒç”¨unregister()æ–¹æ³•å³å¯ã€‚å®ç°å¦‚ä¸‹ï¼š 1234567891011121314public synchronized void unregister(Object subscriber) &#123; //é€šè¿‡typesBySubscriberæ¥å–å‡ºè¿™ä¸ªsubscriberè®¢é˜…è€…è®¢é˜…çš„äº‹ä»¶ç±»å‹, List&lt;Class&lt;?&gt;&gt; subscribedTypes = typesBySubscriber.get(subscriber); if (subscribedTypes != null) &#123; //åˆ†åˆ«è§£é™¤æ¯ä¸ªè®¢é˜…äº†çš„äº‹ä»¶ç±»å‹ for (Class&lt;?&gt; eventType : subscribedTypes) &#123; unsubscribeByEventType(subscriber, eventType); &#125; //ä»typesBySubscriberç§»é™¤subscriber typesBySubscriber.remove(subscriber); &#125; else &#123; Log.w(TAG, \"Subscriber to unregister was not registered before: \" + subscriber.getClass()); &#125;&#125; ç„¶åæ¥ç€çœ‹unsubscribeByEventType()æ–¹æ³•çš„å®ç°ï¼š 1234567891011121314151617private void unsubscribeByEventType(Object subscriber, Class&lt;?&gt; eventType) &#123; //subscriptionsByEventTypeé‡Œæ‹¿å‡ºè¿™ä¸ªäº‹ä»¶ç±»å‹çš„è®¢é˜…è€…åˆ—è¡¨. List&lt;Subscription&gt; subscriptions = subscriptionsByEventType.get(eventType); if (subscriptions != null) &#123; int size = subscriptions.size(); //å–æ¶ˆè®¢é˜… for (int i = 0; i &lt; size; i++) &#123; Subscription subscription = subscriptions.get(i); if (subscription.subscriber == subscriber) &#123; subscription.active = false; subscriptions.remove(i); i--; size--; &#125; &#125; &#125;&#125; æœ€ç»ˆåˆ†åˆ«ä»typesBySubscriberå’Œsubscriptionsé‡Œåˆ†åˆ«ç§»é™¤è®¢é˜…è€…ä»¥åŠç›¸å…³ä¿¡æ¯å³å¯ã€‚ 2.5 æ³¨è§£Subscribeæœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹EventBusä¸­çš„è¿™ä¸ªSubscribeæ³¨è§£å®šä¹‰ï¼š 12345678910111213141516171819@Documented@Retention(RetentionPolicy.RUNTIME) //è¿è¡Œæ—¶æ³¨è§£@Target(&#123;ElementType.METHOD&#125;) //ç”¨æ¥ä¿®é¥°æ–¹æ³•public @interface Subscribe &#123; ThreadMode threadMode() default ThreadMode.POSTING; /** * If true, delivers the most recent sticky event (posted with * &#123;@link EventBus#postSticky(Object)&#125;) to this subscriber (if event available). */ boolean sticky() default false; /** Subscriber priority to influence the order of event delivery. * Within the same delivery thread (&#123;@link ThreadMode&#125;), higher priority subscribers will receive events before * others with a lower priority. The default priority is 0. Note: the priority does *NOT* affect the order of * delivery among subscribers with different &#123;@link ThreadMode&#125;s! */ int priority() default 0;&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°EventBusä½¿ç”¨çš„è¿™ä¸ªæ³¨è§£Subscribeæ˜¯è¿è¡Œæ—¶æ³¨è§£ï¼ˆRetentionPolicy.RUNTIMEï¼‰ï¼Œä¸ºä»€ä¹ˆéœ€è¦å®šä¹‰æˆè¿è¡Œæ—¶è€Œä¸æ˜¯ç¼–è¯‘æ—¶æ³¨è§£å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä¸‰ç§ä¸åŒæ—¶æœºçš„æ³¨è§£ï¼š 12345678/**1.SOURCE:åœ¨æºæ–‡ä»¶ä¸­æœ‰æ•ˆï¼ˆå³æºæ–‡ä»¶ä¿ç•™ï¼‰2.CLASS:åœ¨classæ–‡ä»¶ä¸­æœ‰æ•ˆï¼ˆå³classä¿ç•™ï¼‰3.RUNTIME:åœ¨è¿è¡Œæ—¶æœ‰æ•ˆï¼ˆå³è¿è¡Œæ—¶ä¿ç•™ï¼‰*/@Retention(RetentionPolicy.RUNTIME)@Retention(RetentionPolicy.SOURCE)@Retention(RetentionPolicy.CLASS) @Retentionå®šä¹‰äº†è¯¥Annotationè¢«ä¿ç•™çš„æ—¶é—´é•¿çŸ­ï¼šæŸäº›Annotationä»…å‡ºç°åœ¨æºä»£ç ä¸­ï¼Œè€Œè¢«ç¼–è¯‘å™¨ä¸¢å¼ƒï¼›è€Œå¦ä¸€äº›å´è¢«ç¼–è¯‘åœ¨classæ–‡ä»¶ä¸­ï¼›ç¼–è¯‘åœ¨classæ–‡ä»¶ä¸­çš„Annotationå¯èƒ½ä¼šè¢«è™šæ‹Ÿæœºå¿½ç•¥ï¼Œè€Œå¦ä¸€äº›åœ¨classè¢«è£…è½½æ—¶å°†è¢«è¯»å–ï¼ˆè¯·æ³¨æ„å¹¶ä¸å½±å“classçš„æ‰§è¡Œï¼Œå› ä¸ºAnnotationä¸classåœ¨ä½¿ç”¨ä¸Šæ˜¯è¢«åˆ†ç¦»çš„ï¼‰ã€‚ å› ä¸ºEventBusçš„register()æ–¹æ³•ä¸­éœ€è¦é€šè¿‡åå°„è·å¾—æ³¨å†Œç±»ä¸­é€šè¿‡æ³¨è§£å£°æ˜çš„è®¢é˜…æ–¹æ³•ï¼Œä¹Ÿå°±æ„å‘³ç€å¿…é¡»åœ¨è¿è¡Œæ—¶ä¿ç•™æ³¨è§£ä¿¡æ¯ï¼Œä»¥ä¾¿èƒ½å¤Ÿåå°„å¾—åˆ°è¿™äº›æ–¹æ³•ã€‚æ‰€ä»¥è¿™ä¸ªSubcribeæ³¨è§£å¿…é¡»æ˜¯è¿è¡Œæ—¶æ³¨è§£ã€‚å¤§å®¶æœ‰ç–‘æƒ‘çš„å¯ä»¥è‡ªå·±å†™ä¸ªDemoå°è¯•ä¸€ä¸‹ä½¿ç”¨åå°„å¾—åˆ°æŸä¸ªç±»ä¸­æ–¹æ³•çš„ç¼–è¯‘æ—¶æ³¨è§£ä¿¡æ¯ï¼Œä¸€å®šä¼šæŠ›å‡ºNullPointerExceptionå¼‚å¸¸ã€‚ ä¸‰ã€EventBusåŸç†åˆ†æåœ¨å¹³æ—¶ä½¿ç”¨ä¸­æˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒEventBusä¸­å¯¹äº‹ä»¶çš„åˆ†å‘æœºåˆ¶ï¼Œä½†è¦æˆä¸ºèƒ½å¤Ÿå¿«é€Ÿæ’æŸ¥é—®é¢˜çš„è€å¸æœºï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—ç†Ÿæ‚‰å®ƒçš„å·¥ä½œåŸç†ï¼Œä¸‹é¢æˆ‘ä»¬å°±é€è¿‡UMLå›¾æ¥å­¦ä¹ ä¸€ä¸‹ã€‚ 3.1 æ ¸å¿ƒæ¶æ„EventBusçš„æ ¸å¿ƒå·¥ä½œæœºåˆ¶é€è¿‡ä½œè€…Blogä¸­çš„è¿™å¼ å›¾å°±èƒ½å¾ˆå¥½åœ°ç†è§£ï¼š è®¢é˜…è€…æ¨¡å—éœ€è¦é€šè¿‡EventBusè®¢é˜…ç›¸å…³çš„äº‹ä»¶ï¼Œå¹¶å‡†å¤‡å¥½å¤„ç†äº‹ä»¶çš„å›è°ƒæ–¹æ³•ï¼Œè€Œäº‹ä»¶å‘å¸ƒè€…åˆ™åœ¨é€‚å½“çš„æ—¶æœºæŠŠäº‹ä»¶postå‡ºå»ï¼ŒEventBuså°±èƒ½å¸®æˆ‘ä»¬æå®šä¸€åˆ‡ã€‚åœ¨æ¶æ„æ–¹é¢ï¼ŒEventBus 3.0ä¸ä¹‹å‰ç¨è€ç‰ˆæœ¬æœ‰ä¸åŒï¼Œæˆ‘ä»¬ç›´æ¥çœ‹æ¶æ„å›¾ï¼š ä¸ºäº†æ–¹ä¾¿ç†è§£æˆ–è€…å¯¹æ¯”ï¼Œé¡ºä¾¿ä¹Ÿæ”¾ä¸€å¼ 2.xè€ç‰ˆæœ¬çš„ç»“æ„å›¾å§ï¼š è™½ç„¶æ›´æ–°äº†3.0ï¼Œä½†æ˜¯æ•´ä½“ä¸Šçš„è®¾è®¡è¿˜æ˜¯å¯ä»¥ç”¨ä¸Šé¢çš„ç±»å›¾æ¥åˆ†æï¼Œä»ç±»å›¾ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤§éƒ¨åˆ†ç±»éƒ½æ˜¯ä¾èµ–äºEventBusçš„ï¼Œä¸Šéƒ¨åˆ†ä¸»è¦æ˜¯è®¢é˜…è€…ç›¸å…³ä¿¡æ¯ï¼Œä¸­é—´æ˜¯ EventBus ç±»ï¼Œä¸‹é¢æ˜¯å‘å¸ƒè€…å‘å¸ƒäº‹ä»¶åçš„è°ƒç”¨ã€‚ æ ¹æ®UMLå›¾ï¼Œæˆ‘ä»¬å…ˆçœ‹æ ¸å¿ƒç±»EventBusï¼Œå…¶ä¸­subscriptionByEventTypeæ˜¯ä»¥äº‹ä»¶çš„ç±»ä¸ºkeyï¼Œè®¢é˜…è€…çš„å›è°ƒæ–¹æ³•ä¸ºvalueçš„æ˜ å°„å…³ç³»è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´EventBusåœ¨æ”¶åˆ°ä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œå°±å¯ä»¥æ ¹æ®è¿™ä¸ªäº‹ä»¶çš„ç±»å‹ï¼Œåœ¨subscriptionByEventTypeä¸­æ‰¾åˆ°æ‰€æœ‰ç›‘å¬äº†è¯¥äº‹ä»¶çš„è®¢é˜…è€…åŠå¤„ç†äº‹ä»¶çš„å›è°ƒæ–¹æ³•ã€‚è€ŒtypesBySubscriberåˆ™æ˜¯æ¯ä¸ªè®¢é˜…è€…æ‰€ç›‘å¬çš„äº‹ä»¶ç±»å‹è¡¨ï¼Œåœ¨å–æ¶ˆæ³¨å†Œæ—¶å¯ä»¥é€šè¿‡è¯¥è¡¨ä¸­ä¿å­˜çš„ä¿¡æ¯ï¼Œå¿«é€Ÿåˆ é™¤subscriptionByEventTypeä¸­è®¢é˜…è€…çš„æ³¨å†Œä¿¡æ¯ï¼Œé¿å…éå†æŸ¥æ‰¾ã€‚æ³¨å†Œäº‹ä»¶ã€å‘é€äº‹ä»¶å’Œæ³¨é”€éƒ½æ˜¯å›´ç»•ç€è¿™ä¸¤ä¸ªæ ¸å¿ƒæ•°æ®ç»“æ„æ¥å±•å¼€ã€‚ä¸Šé¢çš„Subscriptionå¯ä»¥ç†è§£ä¸ºæ¯ä¸ªè®¢é˜…è€…ä¸å›è°ƒæ–¹æ³•çš„å…³ç³»ï¼Œåœ¨å…¶ä»–æ¨¡å—å‘é€äº‹ä»¶æ—¶ï¼Œå°±ä¼šé€šè¿‡è¿™ä¸ªå…³ç³»ï¼Œè®©è®¢é˜…è€…æ‰§è¡Œå›è°ƒæ–¹æ³•ã€‚ å›è°ƒæ–¹æ³•åœ¨è¿™é‡Œè¢«å°è£…æˆäº†SubscriptionMethodï¼Œé‡Œé¢ä¿å­˜äº†åœ¨éœ€è¦åå°„invokeæ–¹æ³•æ—¶çš„å„ç§å‚æ•°ï¼ŒåŒ…æ‹¬ä¼˜å…ˆçº§ï¼Œæ˜¯å¦æ¥æ”¶é»æ€§äº‹ä»¶å’Œæ‰€åœ¨çº¿ç¨‹ç­‰ä¿¡æ¯ã€‚è€Œè¦ç”Ÿæˆè¿™äº›å°è£…å¥½çš„æ–¹æ³•ï¼Œåˆ™éœ€è¦SubscriberMethodFinderï¼Œå®ƒå¯ä»¥åœ¨regsteræ—¶å¾—åˆ°è®¢é˜…è€…çš„æ‰€æœ‰å›è°ƒæ–¹æ³•ï¼Œå¹¶å°è£…è¿”å›ç»™EventBusã€‚è€Œå³è¾¹çš„åŠ é€Ÿå™¨æ¨¡å—ï¼Œå°±æ˜¯ä¸ºäº†æé«˜SubscriberMethodFinderçš„æ•ˆç‡ï¼Œè¿™é‡Œå°±ä¸å†å•°å—¦ã€‚ è‡³æ­¤EventBus 3.0çš„æ¶æ„å°±åˆ†æå®Œäº†ï¼Œä¸ä¹‹å‰EventBusè€ç‰ˆæœ¬æœ€æ˜æ˜¾çš„åŒºåˆ«åœ¨äºï¼šåˆ†å‘äº‹ä»¶çš„è°ƒåº¦å•ä½ä»è®¢é˜…è€…ï¼Œç»†åŒ–æˆäº†è®¢é˜…è€…çš„å›è°ƒæ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªå›è°ƒæ–¹æ³•éƒ½æœ‰è‡ªå·±çš„ä¼˜å…ˆçº§ï¼Œæ‰§è¡Œçº¿ç¨‹å’Œæ˜¯å¦æ¥æ”¶é»æ€§äº‹ä»¶ï¼Œæé«˜äº†äº‹ä»¶åˆ†å‘çš„çµæ´»ç¨‹åº¦ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åœ¨çœ‹æ ¸å¿ƒåŠŸèƒ½çš„å®ç°æ—¶æ›´èƒ½ä½“ç°è¿™ä¸€ç‚¹ã€‚ 3.2 registerç®€å•æ¥è¯´å°±æ˜¯ï¼šæ ¹æ®è®¢é˜…è€…çš„ç±»æ¥æ‰¾å›è°ƒæ–¹æ³•ï¼ŒæŠŠè®¢é˜…è€…å’Œå›è°ƒæ–¹æ³•å°è£…æˆå…³ç³»ï¼Œå¹¶ä¿å­˜åˆ°ç›¸åº”çš„æ•°æ®ç»“æ„ä¸­ï¼Œä¸ºéšåçš„äº‹ä»¶åˆ†å‘åšå¥½å‡†å¤‡ï¼Œæœ€åå¤„ç†é»æ€§äº‹ä»¶ã€‚ æ ¹æ®è®¢é˜…è€…æ¥æ‰¾åˆ°è®¢é˜…æ–¹æ³•å’Œäº‹ä»¶ï¼Œå°è£…æˆ SubscriberMehod å¾ªç¯æ¯ä¸ª SubscriberMethod é€šè¿‡äº‹ä»¶å¾—åˆ°è¯¥äº‹ä»¶çš„æ‰€æœ‰è®¢é˜…è€…åˆ—è¡¨ï¼Œå†æ ¹æ®ä¼˜å…ˆçº§æ’å…¥åˆ° subscriptionsByEventType çš„æ‰€æœ‰è®¢é˜…è€…åˆ—è¡¨ä¸­ é€šè¿‡è®¢é˜…è€…å¾—åˆ°è¯¥è®¢é˜…è€…çš„æ‰€æœ‰äº‹ä»¶åˆ—è¡¨ï¼Œå†å°†äº‹ä»¶æ·»åŠ åˆ° typeBySubscriber çš„æ‰€ä»¥äº‹ä»¶åˆ—è¡¨ä¸­ æ˜¯å¦æ˜¯ç²˜æ€§äº‹ä»¶ æ˜¯çš„è¯è¿›è¡Œåˆ†å‘ï¼Œpostæ­¤äº‹ä»¶ç»™å½“å‰è®¢é˜…è€…ï¼Œä¸æ˜¯çš„è¯ä¸ç®¡ ç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œè·³åˆ° 2 3.3 postæ€»çš„æ¥è¯´å°±æ˜¯åˆ†æäº‹ä»¶ï¼Œå¾—åˆ°æ‰€æœ‰ç›‘å¬è¯¥äº‹ä»¶çš„è®¢é˜…è€…çš„å›è°ƒæ–¹æ³•ï¼Œå¹¶åˆ©ç”¨åå°„æ¥invokeæ–¹æ³•ï¼Œå®ç°å›è°ƒã€‚ ä» currentPostingThreadState ä¸­å¾—åˆ°å½“å‰çº¿ç¨‹çš„ PostThreadState ä¿¡æ¯ å°†æ­¤äº‹ä»¶æ·»åŠ åˆ° PostPostThreadState çš„äº‹ä»¶é˜Ÿåˆ—ä¸­ åˆ¤æ–­æ˜¯å¦å†åˆ†å‘ ä¸æ˜¯çš„è¯ï¼Œå¾ªç¯é˜Ÿåˆ—ï¼Œæ˜¯çš„è¯è·³ 7 åˆ¤æ–­æ˜¯ä¸ªéœ€è¦ç»§æ‰¿å…³ç³» æ˜¯çš„è¯ï¼Œå¾ªç¯å¾—åˆ°çˆ¶ç±»ï¼Œä¸æ˜¯çš„è¯è·³ 7 æŸ¥æ‰¾è¯¥äº‹ä»¶çš„è®¢é˜…è€…ï¼Œå¾ªç¯è®¢é˜…è€… æ ¹æ® ThreadMoth å‘é€äº‹ä»¶ ç»“æŸæœ¬æ¬¡å¾ªç¯è®¢é˜…è€…ï¼Œè·³ 7 ç»“æŸæœ¬æ¬¡å¾ªç¯é˜Ÿåˆ—ï¼Œè·³ 4 åœ¨æºä»£ç ä¸­ä¸ºäº†ä¿è¯postæ‰§è¡Œä¸ä¼šå‡ºç°æ­»é”ï¼Œç­‰å¾…å’Œå¯¹åŒä¸€è®¢é˜…è€…å‘é€ç›¸åŒçš„äº‹ä»¶ï¼Œå¢åŠ äº†å¾ˆå¤šçº¿ç¨‹ä¿æŠ¤é”å’Œæ ‡å¿—ä½ï¼Œå€¼å¾—æˆ‘ä»¬æ¯ä¸ªå¼€å‘è€…å­¦ä¹ ã€‚ 3.4 unregisteræ³¨é”€å°±æ¯”è¾ƒç®€å•äº†ï¼ŒæŠŠåœ¨æ³¨å†Œæ—¶å¾€ä¸¤ä¸ªæ•°æ®ç»“æ„ä¸­æ·»åŠ çš„è®¢é˜…è€…ä¿¡æ¯åˆ é™¤å³å¯ï¼š è‡³æ­¤å¤§å®¶å¯¹EventBusçš„è¿è¡ŒåŸç†åº”è¯¥æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œè™½ç„¶çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªå¤æ‚è€—æ—¶çš„è‡ªåŠ¨æœºï¼Œä½†å¤§éƒ¨åˆ†æ—¶å€™äº‹ä»¶éƒ½æ˜¯ä¸€ç¬é—´å°±èƒ½åˆ†å‘åˆ°ä½çš„ï¼Œè€Œå¤§å®¶å…³å¿ƒçš„æ€§èƒ½é—®é¢˜åè€Œæ˜¯å‘ç”Ÿåœ¨æ³¨å†ŒEventBusçš„æ—¶å€™ï¼Œå› ä¸ºéœ€è¦éå†ç›‘å¬è€…çš„æ‰€æœ‰æ–¹æ³•å»æ‰¾åˆ°å›è°ƒçš„æ–¹æ³•ã€‚ä½œè€…ä¹Ÿæåˆ°è¿è¡Œæ—¶æ³¨è§£çš„æ€§èƒ½åœ¨Androidä¸Šå¹¶ä¸ç†æƒ³ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…æ‰ä¼šä»¥ç´¢å¼•çš„æ–¹å¼å»ç”Ÿæˆå›è°ƒæ–¹æ³•è¡¨ï¼Œä¹Ÿå°±æ˜¯åœ¨EventBus 3.0ä¸­å¼•å…¥äº†EventBusAnnotationProcessorï¼ˆæ³¨è§£åˆ†æç”Ÿæˆç´¢å¼•ï¼‰æŠ€æœ¯ï¼Œå¤§å¤§æé«˜äº†EventBusçš„è¿è¡Œæ•ˆç‡ã€‚å…³äºç´¢å¼•æŠ€æœ¯çš„æºç åˆ†æï¼Œå¤§å®¶å¯ä»¥å‚è€ƒè…¾è®¯Buglyçš„è¿™è¾¹æ–‡ç« ï¼šè€å¸æœºæ•™ä½  â€œé£™â€ EventBus 3 ã€‚ å››ã€ç¼ºç‚¹ä¸é—®é¢˜ä¸€ç›´ä»¥æ¥ï¼ŒEventBusè¢«å¤§å®¶åæ§½çš„ä¸€å¤§é—®é¢˜å°±æ˜¯ä»£ç æ··æ·†é—®é¢˜ã€‚ 4.1 æ··æ·†é—®é¢˜æ··æ·†ä½œä¸ºç‰ˆæœ¬å‘å¸ƒå¿…å¤‡çš„æµç¨‹ï¼Œç»å¸¸ä¼šé—¹å‡ºå¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼Œä¸”ä¸æ–¹ä¾¿å®šä½ï¼Œå°¤å…¶æ˜¯EventBusè¿™ç§ä¾èµ–åå°„æŠ€æœ¯çš„åº“ã€‚é€šå¸¸æƒ…å†µä¸‹éƒ½ä¼šæŠŠç›¸å…³çš„ç±»å’Œå›è°ƒæ–¹æ³•éƒ½keepä½ï¼Œä½†è¿™æ ·å…¶å®ä¼šç•™ä¸‹è¢«äººåç¼–è¯‘åç ´è§£çš„åé¡¾ä¹‹å¿§ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æ˜¯keepæœ€å°‘çš„ä»£ç ã€‚ é¦–å…ˆï¼Œå› ä¸ºEventBus 3å¼ƒç”¨äº†åå°„çš„æ–¹å¼å»å¯»æ‰¾å›è°ƒæ–¹æ³•ï¼Œæ”¹ç”¨æ³¨è§£çš„æ–¹å¼ã€‚ä½œè€…çš„æ„æ€æ˜¯åœ¨æ··æ·†æ—¶å°±ä¸ç”¨å†keepä½ç›¸åº”çš„ç±»å’Œæ–¹æ³•ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨è¿è¡Œæ—¶ï¼Œå´ä¼šæŠ¥java.lang.NoSuchFieldError: No static field POSTINGã€‚ç½‘ä¸Šç»™å‡ºçš„è§£å†³åŠæ³•æ˜¯keepä½æ‰€æœ‰eventbusç›¸å…³çš„ä»£ç ï¼š 1-keep class de.greenrobot.** &#123;*;&#125; å…¶å®æˆ‘ä»¬ä»”ç»†åˆ†æï¼Œå¯ä»¥çœ‹åˆ°æ˜¯å› ä¸ºåœ¨SubscriberMethodFinderçš„findUsingReflectionæ–¹æ³•ä¸­ï¼Œåœ¨è°ƒç”¨Method.getAnnotation()æ—¶è·å–ThreadModeè¿™ä¸ªenumå¤±è´¥äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦keepä½è¿™ä¸ªenumå°±å¯ä»¥äº†ï¼ˆå¦‚ä¸‹ï¼‰ã€‚ 1-keep public enum org.greenrobot.eventbus.ThreadMode &#123; public static *; &#125; è¿™æ ·å°±èƒ½æ­£å¸¸ç¼–è¯‘é€šè¿‡äº†ï¼Œä½†å¦‚æœä½¿ç”¨äº†ç´¢å¼•åŠ é€Ÿï¼Œæ˜¯ä¸ä¼šæœ‰ä¸Šé¢è¿™ä¸ªé—®é¢˜çš„ã€‚å› ä¸ºåœ¨æ‰¾æ–¹æ³•æ—¶ï¼Œè°ƒç”¨çš„ä¸æ˜¯findUsingReflectionï¼Œè€Œæ˜¯findUsingInfoã€‚ä½†æ˜¯ä½¿ç”¨äº†ç´¢å¼•åŠ é€Ÿåï¼Œç¼–è¯‘åå´ä¼šæŠ¥æ–°çš„é”™è¯¯ï¼šCould not find subscriber method in XXX Class. Maybe a missing ProGuard rule? è¿™å°±å¾ˆå¥½ç†è§£äº†ï¼Œå› ä¸ºç”Ÿæˆç´¢å¼•GeneratedSubscriberIndexæ˜¯åœ¨ä»£ç æ··æ·†ä¹‹å‰è¿›è¡Œçš„ï¼Œæ··æ·†ä¹‹åç±»åå’Œæ–¹æ³•åéƒ½ä¸ä¸€æ ·äº†ï¼ˆä¸Šé¢è¿™ä¸ªé”™è¯¯æ˜¯æ–¹æ³•æ— æ³•æ‰¾åˆ°ï¼‰ï¼Œå¾—keepä½æ‰€æœ‰è¢«Subscribeæ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ï¼š 123-keepclassmembers class * &#123; @de.greenrobot.event.Subscribe &lt;methods&gt;;&#125; æ‰€ä»¥åˆå€’é€€å›äº†EventBus2.4æ—¶ä¸èƒ½æ··æ·†onEventå¼€å¤´çš„æ–¹æ³•ä¸€æ ·çš„å¤„å¢ƒäº†ã€‚æ‰€ä»¥è¿™é‡Œå°±å¾—æƒè¡¡ä¸€ä¸‹åˆ©å¼Šï¼šä½¿ç”¨äº†æ³¨è§£ä¸ç”¨ç´¢å¼•åŠ é€Ÿï¼Œåˆ™åªéœ€è¦keepä½EventBusç›¸å…³çš„ä»£ç ï¼Œç°æœ‰çš„ä»£ç å¯ä»¥æ­£å¸¸çš„è¿›è¡Œæ··æ·†ã€‚è€Œä½¿ç”¨äº†ç´¢å¼•åŠ é€Ÿçš„è¯ï¼Œåˆ™éœ€è¦keepä½ç›¸å…³çš„æ–¹æ³•å’Œç±»ã€‚ 4.2 è·¨è¿›ç¨‹é—®é¢˜ç›®å‰EventBusåªæ”¯æŒè·¨çº¿ç¨‹ï¼Œè€Œä¸æ”¯æŒè·¨è¿›ç¨‹ã€‚å¦‚æœä¸€ä¸ªappçš„serviceèµ·åˆ°äº†å¦ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œé‚£ä¹ˆæ³¨å†Œç›‘å¬çš„æ¨¡å—åˆ™ä¼šæ”¶ä¸åˆ°å¦ä¸€ä¸ªè¿›ç¨‹çš„EventBuså‘å‡ºçš„äº‹ä»¶ã€‚è¿™é‡Œå¯ä»¥è€ƒè™‘åˆ©ç”¨IPCåšæ˜ å°„è¡¨ï¼Œå¹¶åœ¨ä¸¤ä¸ªè¿›ç¨‹ä¸­å„ç»´æŠ¤ä¸€ä¸ªEventBusï¼Œä¸è¿‡è¿™æ ·å°±è¦è‡ªå·±å»ç»´æŠ¤registerå’Œunregisterçš„å…³ç³»ï¼Œæ¯”è¾ƒç¹çï¼Œè€Œä¸”è¿™ç§æƒ…å†µä¸‹é€šå¸¸ç”¨å¹¿æ’­ä¼šæ›´åŠ æ–¹ä¾¿ï¼Œå¤§å®¶å¯ä»¥æ€è€ƒä¸€ä¸‹æœ‰æ²¡æœ‰æ›´ä¼˜çš„è§£å†³æ–¹æ¡ˆã€‚ 4.3 äº‹ä»¶ç¯è·¯é—®é¢˜åœ¨ä½¿ç”¨EventBusæ—¶ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šæŠŠä¸¤ä¸ªæ¨¡å—ç›¸äº’ç›‘å¬ï¼Œæ¥è¾¾åˆ°ä¸€ä¸ªç›¸äº’å›è°ƒé€šä¿¡çš„ç›®çš„ã€‚ä½†è¿™æ ·ä¸€æ—¦å‡ºç°æ­»å¾ªç¯ï¼Œè€Œä¸”å¦‚æœæ²¡æœ‰ç›¸åº”çš„æ—¥å¿—ä¿¡æ¯ï¼Œå¾ˆéš¾å®šä½é—®é¢˜ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨EventBusçš„æ¨¡å—ï¼Œå¦‚æœåœ¨å›è°ƒä¸Šæœ‰ç¯è·¯ï¼Œè€Œä¸”å›è°ƒæ–¹æ³•å¤æ‚åˆ°äº†ä¸€å®šç¨‹åº¦çš„è¯ï¼Œå°±è¦è€ƒè™‘æŠŠæ¥æ”¶äº‹ä»¶ä¸“é—¨å°è£…æˆä¸€ä¸ªå­æ¨¡å—ï¼ŒåŒæ—¶è€ƒè™‘é¿å…å‡ºç°äº‹ä»¶ç¯è·¯ã€‚ äº”ã€æ€»ç»“EventBusä¸è®ºä»ä½¿ç”¨æ–¹å¼å’Œå®ç°æ–¹å¼ä¸Šéƒ½æ˜¯éå¸¸å€¼å¾—æˆ‘ä»¬å­¦ä¹ çš„å¼€æºé¡¹ç›®ï¼Œå¯ä»¥è¯´æ˜¯ç›®å‰æ¶ˆæ¯é€šçŸ¥é‡Œæœ€å¥½ç”¨çš„é¡¹ç›®ã€‚ä½†æ˜¯ä¸šå†…å¯¹EventBusçš„ä¸»è¦äº‰è®ºç‚¹æ˜¯åœ¨äºEventBusä½¿ç”¨åå°„ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼Œå®é™…ä¸Šåœ¨EventBusé‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸ä»…å¯ä»¥ä½¿ç”¨æ³¨è§£å¤„ç†å™¨é¢„å¤„ç†è·å–è®¢é˜…ä¿¡æ¯ï¼ŒEventBusä¹Ÿä¼šå°†è®¢é˜…è€…çš„æ–¹æ³•ç¼“å­˜åˆ°METHOD_CACHEé‡Œé¿å…é‡å¤æŸ¥æ‰¾ï¼Œæ‰€ä»¥åªæœ‰åœ¨æœ€åinvoke()æ–¹æ³•çš„æ—¶å€™ä¼šæ¯”ç›´æ¥è°ƒç”¨å¤šå‡ºä¸€äº›æ€§èƒ½æŸè€—ã€‚ è€Œä¸”ç›¸æ¯”æ—§ç‰ˆçš„2.xï¼Œç°åœ¨æ–°ç‰ˆçš„EventBus 3.0ï¼Œè®¢é˜…è€…å·²ç»æ²¡æœ‰å›ºå®šçš„å¤„ç†äº‹ä»¶çš„æ–¹æ³•äº†ï¼ŒonEventã€onEventMainThreadã€onEventBackgroundThreadã€onEventAsyncéƒ½æ²¡æœ‰äº†ï¼Œç°åœ¨æ”¯æŒå¤„ç†äº‹ä»¶çš„æ–¹æ³•åè‡ªå®šä¹‰ï¼Œä½†å¿…é¡»publicï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œç„¶åä½¿ç”¨æ³¨è§£@Subscribeæ¥æ ‡è®°è¯¥æ–¹æ³•ä¸ºå¤„ç†äº‹ä»¶çš„æ–¹æ³•ï¼ŒThreadModeå’Œpriorityä¹Ÿé€šè¿‡è¯¥æ³¨è§£æ¥å®šä¹‰ã€‚åœ¨subscriberMethodFinderä¸­ï¼Œé€šè¿‡åå°„çš„æ–¹å¼å¯»æ‰¾äº‹ä»¶æ–¹æ³•ã€‚ä½¿ç”¨æ³¨è§£ï¼Œç”¨èµ·æ¥æ‰æ›´çˆ½ã€‚ å½“ç„¶ï¼ŒEventBuså¹¶ä¸æ˜¯é‡æ„ä»£ç çš„å”¯ä¸€ä¹‹é€‰ã€‚ä½œä¸ºè§‚å¯Ÿè€…æ¨¡å¼çš„â€œåŒé—¨å¸ˆå…„å¼Ÿâ€â€”â€”RxJavaï¼Œä½œä¸ºåŠŸèƒ½æ›´ä¸ºå¼ºå¤§çš„å“åº”å¼ç¼–ç¨‹æ¡†æ¶ï¼Œå¯ä»¥è½»æ¾å®ç°EventBusçš„äº‹ä»¶æ€»çº¿åŠŸèƒ½ï¼ˆRxBusï¼‰ã€‚ä½†æ¯•ç«Ÿå¤§å‹é¡¹ç›®è¦æ¥å…¥RxJavaçš„æˆæœ¬é«˜ï¼Œå¤æ‚çš„æ“ä½œç¬¦éœ€è¦å¼€å‘è€…æŠ•å…¥æ›´å¤šçš„æ—¶é—´å»å­¦ä¹ ã€‚æ‰€ä»¥æƒ³åœ¨æˆç†Ÿçš„é¡¹ç›®ä¸­å¿«é€Ÿåœ°é‡æ„ã€è§£è€¦æ¨¡å—ï¼ŒEventBusä¾æ—§æ˜¯æˆ‘ä»¬çš„ä¸äºŒä¹‹é€‰ã€‚ å‚è€ƒèµ„æ–™ Markus Junginger - EventBus 3 beta announced at droidcon è€å¸æœºæ•™ä½  â€œé£™â€ EventBus 3 - è…¾è®¯Bugly EventBusæºç ç ”è¯»(ä¸Š)ï¼Œ(ä¸­)ï¼Œ(ä¸‹) - kymjså¼ æ¶› EventBus3.0æºç è§£æ - yydcdut EventBus 3.0 æºä»£ç åˆ†æ - Skykai EventBus æºç è§£æ - codeKK","categories":[{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"http://github.com/categories/æºç åˆ†æ/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"http://github.com/tags/æºç åˆ†æ/"}],"keywords":[{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"http://github.com/categories/æºç åˆ†æ/"}]},{"title":"ã€Javaã€‘try-catch-finallyè¯­å¥ä¸­returnçš„æ‰§è¡Œé¡ºåºæ€è€ƒ","slug":"ã€Javaã€‘try-catch-finallyè¯­å¥ä¸­returnçš„æ‰§è¡Œé¡ºåºæ€è€ƒ","date":"2017-09-20T14:30:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/09/20/ã€Javaã€‘try-catch-finallyè¯­å¥ä¸­returnçš„æ‰§è¡Œé¡ºåºæ€è€ƒ/","link":"","permalink":"http://github.com/2017/09/20/ã€Javaã€‘try-catch-finallyè¯­å¥ä¸­returnçš„æ‰§è¡Œé¡ºåºæ€è€ƒ/","excerpt":"å®éªŒå¯¹äºtry-catch-finallyè¯­å¥ä¸­returnçš„æ‰§è¡Œé¡ºåºï¼Œæˆ‘ä»¬éƒ½æœ‰çŸ¥é“ï¼Œfinallyå—ä¸­çš„å†…å®¹ä¼šå…ˆäºtryä¸­çš„returnè¯­å¥æ‰§è¡Œï¼Œå¦‚æœfinallè¯­å¥å—ä¸­ä¹Ÿæœ‰returnè¯­å¥çš„è¯ï¼Œé‚£ä¹ˆç›´æ¥ä»finallyä¸­è¿”å›äº†ï¼Œè¿™ä¹Ÿæ˜¯ä¸å»ºè®®åœ¨finallyä¸­returnçš„åŸå› ã€‚ ä¸‹é¢é€šè¿‡å®éªŒæ¥çœ‹è¿™å‡ ç§æƒ…å†µçš„æ‰§è¡Œé¡ºåºåˆ°åº•æ˜¯ä»€ä¹ˆã€‚ 1ã€tryä¸­æœ‰returnï¼Œfinallyä¸­æ²¡æœ‰12345678910111213141516171819public class TryCatchTest &#123; public static void main(String[] args) &#123; System.out.println(\"test()å‡½æ•°è¿”å›ï¼š\" + test()); &#125; private static int test()&#123; int i = 0; try &#123; System.out.println(\"Try block executing: \" + ++i); return i; &#125;catch (Exception e)&#123; System.out.println(\"Catch Error executing: \" + ++i); return -1; &#125;finally &#123; System.out.println(\"finally executing: \" + ++i); &#125; &#125;&#125;","text":"å®éªŒå¯¹äºtry-catch-finallyè¯­å¥ä¸­returnçš„æ‰§è¡Œé¡ºåºï¼Œæˆ‘ä»¬éƒ½æœ‰çŸ¥é“ï¼Œfinallyå—ä¸­çš„å†…å®¹ä¼šå…ˆäºtryä¸­çš„returnè¯­å¥æ‰§è¡Œï¼Œå¦‚æœfinallè¯­å¥å—ä¸­ä¹Ÿæœ‰returnè¯­å¥çš„è¯ï¼Œé‚£ä¹ˆç›´æ¥ä»finallyä¸­è¿”å›äº†ï¼Œè¿™ä¹Ÿæ˜¯ä¸å»ºè®®åœ¨finallyä¸­returnçš„åŸå› ã€‚ ä¸‹é¢é€šè¿‡å®éªŒæ¥çœ‹è¿™å‡ ç§æƒ…å†µçš„æ‰§è¡Œé¡ºåºåˆ°åº•æ˜¯ä»€ä¹ˆã€‚ 1ã€tryä¸­æœ‰returnï¼Œfinallyä¸­æ²¡æœ‰12345678910111213141516171819public class TryCatchTest &#123; public static void main(String[] args) &#123; System.out.println(\"test()å‡½æ•°è¿”å›ï¼š\" + test()); &#125; private static int test()&#123; int i = 0; try &#123; System.out.println(\"Try block executing: \" + ++i); return i; &#125;catch (Exception e)&#123; System.out.println(\"Catch Error executing: \" + ++i); return -1; &#125;finally &#123; System.out.println(\"finally executing: \" + ++i); &#125; &#125;&#125; ç»“æœå¦‚ä¸‹ï¼š Try block executing: 1finally executing: 2test()å‡½æ•°è¿”å›ï¼š1 returnçš„æ˜¯å¯¹è±¡æ—¶ï¼Œçœ‹çœ‹åœ¨finallyä¸­æ”¹å˜å¯¹è±¡å±æ€§ï¼Œä¼šä¸ä¼šå½±å“tryä¸­çš„returnç»“æœã€‚ 1234567891011121314151617181920212223public class TryCatchTest &#123; public int vaule = 0; public static void main(String[] args) &#123; System.out.println(\"test()å‡½æ•°è¿”å›ï¼š\" + test().vaule); &#125; private static TryCatchTest test()&#123; TryCatchTest t = new TryCatchTest(); try &#123; t.vaule = 1; System.out.println(\"Try block executing: \" + t.vaule); return t; &#125;catch (Exception e)&#123; t.vaule = -1; System.out.println(\"Catch Error executing: \" + t.vaule); return t; &#125;finally &#123; t.vaule = 3; System.out.println(\"finally executing: \" + t.vaule); &#125; &#125;&#125; Try block executing: 1finally executing: 3test()å‡½æ•°è¿”å›ï¼š3 2ã€tryå’Œfinallyä¸­å‡æœ‰return12345678910111213private static int test()&#123; int i = 0; try &#123; System.out.println(\"Try block executing: \" + ++i); return i; &#125;catch (Exception e)&#123; System.out.println(\"Catch Error executing: \" + ++i); return -1; &#125;finally &#123; System.out.println(\"finally executing: \" + ++i); return i; &#125;&#125; ç»“æœå¦‚ä¸‹ï¼š Try block executing: 1finally executing: 2test()å‡½æ•°è¿”å›ï¼š2 3ã€catchå’Œfinallyä¸­å‡æœ‰return12345678910111213private static int test()&#123; int i = 0; try &#123; System.out.println(\"Try block executing: \" + ++i); throw new Exception(); &#125;catch (Exception e)&#123; System.out.println(\"Catch Error executing: \" + ++i); return -1; &#125;finally &#123; System.out.println(\"finally executing: \" + ++i); return i; &#125;&#125; è¾“å‡ºç»“æœï¼š Try block executing: 1Catch Error executing: 2finally executing: 3test()å‡½æ•°è¿”å›ï¼š3 æ€»ç»“1ã€ä¸ç®¡æœ‰æ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œfinallyå—ä¸­ä»£ç éƒ½ä¼šæ‰§è¡Œï¼›2ã€å½“tryå’Œcatchä¸­æœ‰returnæ—¶ï¼Œfinallyä»ç„¶ä¼šæ‰§è¡Œï¼›3ã€finallyæ˜¯åœ¨returnåé¢çš„è¡¨è¾¾å¼è¿ç®—ä¹‹åæ‰§è¡Œçš„ï¼› å¯¹äºå«æœ‰returnè¯­å¥çš„æƒ…å†µï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°æ€»ç»“å¦‚ä¸‹ï¼š tryè¯­å¥åœ¨è¿”å›å‰ï¼Œå°†å…¶ä»–æ‰€æœ‰çš„æ“ä½œæ‰§è¡Œå®Œï¼Œä¿ç•™å¥½è¦è¿”å›çš„å€¼ï¼Œè€Œåè½¬å…¥æ‰§è¡Œfinallyä¸­çš„è¯­å¥ï¼Œè€Œååˆ†ä¸ºä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š æƒ…å†µä¸€ï¼šå¦‚æœfinallyä¸­æœ‰returnè¯­å¥ï¼Œåˆ™ä¼šå°†tryä¸­çš„returnè¯­å¥â€œè¦†ç›–â€æ‰ï¼Œç›´æ¥æ‰§è¡Œfinallyä¸­çš„returnè¯­å¥ï¼Œå¾—åˆ°è¿”å›å€¼ï¼Œè¿™æ ·ä¾¿æ— æ³•å¾—åˆ°tryä¹‹å‰ä¿ç•™å¥½çš„è¿”å›å€¼ã€‚ æƒ…å†µäºŒï¼šå¦‚æœfinallyä¸­æ²¡æœ‰returnè¯­å¥ï¼Œä¹Ÿæ²¡æœ‰æ”¹å˜è¦è¿”å›å€¼ï¼Œåˆ™æ‰§è¡Œå®Œfinallyä¸­çš„è¯­å¥åï¼Œä¼šæ¥ç€æ‰§è¡Œtryä¸­çš„returnè¯­å¥ï¼Œè¿”å›ä¹‹å‰ä¿ç•™çš„å€¼ã€‚ æƒ…å†µä¸‰ï¼šå¦‚æœfinallyä¸­æ²¡æœ‰returnè¯­å¥ï¼Œä½†æ˜¯æ”¹å˜äº†è¦è¿”å›çš„å€¼ï¼Œè¿™é‡Œæœ‰ç‚¹ç±»ä¼¼ä¸å¼•ç”¨ä¼ é€’å’Œå€¼ä¼ é€’çš„åŒºåˆ«ï¼Œåˆ†ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š 1ï¼‰å¦‚æœreturnçš„æ•°æ®æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æˆ–æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œåˆ™åœ¨finallyä¸­å¯¹è¯¥åŸºæœ¬æ•°æ®çš„æ”¹å˜ä¸èµ·ä½œç”¨ï¼Œtryä¸­çš„returnè¯­å¥ä¾ç„¶ä¼šè¿”å›è¿›å…¥finallyå—ä¹‹å‰ä¿ç•™çš„å€¼ã€‚ 2ï¼‰å¦‚æœreturnçš„æ•°æ®æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œè€Œåœ¨finallyä¸­å¯¹è¯¥å¼•ç”¨æ•°æ®ç±»å‹çš„å±æ€§å€¼çš„æ”¹å˜èµ·ä½œç”¨ï¼Œtryä¸­çš„returnè¯­å¥è¿”å›çš„å°±æ˜¯åœ¨finallyä¸­æ”¹å˜åçš„è¯¥å±æ€§çš„å€¼ã€‚ å‚è€ƒèµ„æ–™ æœ‰returnçš„æƒ…å†µä¸‹try catch finallyçš„æ‰§è¡Œé¡ºåºï¼ˆæœ€æœ‰è¯´æœåŠ›çš„æ€»ç»“ï¼‰ Javaä¸­try catch finallyè¯­å¥ä¸­å«æœ‰returnè¯­å¥çš„æ‰§è¡Œæƒ…å†µï¼ˆæ€»ç»“ç‰ˆï¼‰","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢","slug":"ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢","date":"2017-09-08T04:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/09/08/ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢/","link":"","permalink":"http://github.com/2017/09/08/ã€ç®—æ³•ã€‘ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢/","excerpt":"æœ¬æ–‡æ¥è‡ªï¼š ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ â€” miskcoo æ¦‚è¿°è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•ï¼Œæˆ–è€…è®¡ç®—ä¸¤ä¸ªå¤§æ•´æ•°çš„ä¹˜æ³•æ˜¯åœ¨è®¡ç®—æœºä¸­å¾ˆå¸¸è§çš„è¿ç®—ï¼Œå¦‚æœç”¨æ™®é€šçš„æ–¹æ³•è¿›è¡Œï¼Œå¤æ‚åº¦å°†ä¼šæ˜¯$ \\mathcal O(n^2) â€‹$çš„ï¼Œè¿˜æœ‰ä¸€ç§åˆ†æ²»ä¹˜æ³•ï¼Œå¯ä»¥åšåˆ° $\\mathcal O(n^{\\log_23}) â€‹$æ—¶é—´è®¡ç®—ï¼ˆå¯ä»¥çœ‹Karatsuba ä¹˜æ³•ï¼‰ã€‚ä¸‹é¢ä»è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•å‡ºå‘ï¼Œä»‹ç»å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFast Fourier Transform, FFTï¼‰å¦‚ä½•åœ¨ $\\mathcal O(n\\log n) â€‹$çš„æ—¶é—´å†…è®¡ç®—å‡ºä¸¤ä¸ªå¤šé¡¹å¼çš„ä¹˜ç§¯ã€‚ å‡†å¤‡çŸ¥è¯†è¿™é‡Œä»‹ç»ä¸€äº›åé¢å¯èƒ½ä¼šç”¨åˆ°çš„çŸ¥è¯†ï¼ˆä¸»è¦æ˜¯å…³äºå¤šé¡¹å¼ã€å·ç§¯ä»¥åŠå¤æ•°çš„ï¼‰ï¼Œå¦‚æœä½ å·²ç»çŸ¥é“è§‰å¾—å®ƒå¤ªæ°´äº†æˆ–è€…æƒ³ç”¨åˆ°çš„æ—¶å€™å†çœ‹å°±è·³è¿‡å§ã€‚ å¤šé¡¹å¼ç®€å•æ¥è¯´ï¼Œå½¢å¦‚ $ a_0+a_1X+a_2X^2+\\cdots+a_nX^n $ çš„ä»£æ•°è¡¨è¾¾å¼å«åšå¤šé¡¹å¼ï¼Œå¯ä»¥è®°ä½œ$P(X)=a_0+a_1X+a_2X^2+\\cdots+a_nX^n$ï¼Œ$a_0, a_1, \\cdots, a_n $å«åšå¤šé¡¹å¼çš„ç³»æ•°ï¼Œ$X $æ˜¯ä¸€ä¸ªä¸å®šå…ƒï¼Œä¸è¡¨ç¤ºä»»ä½•å€¼ï¼Œä¸å®šå…ƒåœ¨å¤šé¡¹å¼ä¸­æœ€å¤§é¡¹çš„æ¬¡æ•°ç§°ä½œå¤šé¡¹å¼çš„æ¬¡æ•° å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•åƒåˆšåˆšæˆ‘ä»¬æåˆ°çš„é‚£äº›å¤šé¡¹å¼ï¼Œéƒ½æ˜¯ä»¥ç³»æ•°å½¢å¼è¡¨ç¤ºçš„ï¼Œä¹Ÿå°±æ˜¯å°† n æ¬¡å¤šé¡¹å¼$ A(x) $çš„ç³»æ•° $a_0, a_1, \\cdots, a_n $çœ‹ä½œ $n+1 $ç»´å‘é‡$ \\vec a=(a_0,a_1,\\cdots,a_n)$ï¼Œå…¶ç³»æ•°è¡¨ç¤ºï¼ˆcoefficient representationï¼‰å°±æ˜¯å‘é‡$ \\vec a$ ã€‚","text":"æœ¬æ–‡æ¥è‡ªï¼š ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ â€” miskcoo æ¦‚è¿°è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•ï¼Œæˆ–è€…è®¡ç®—ä¸¤ä¸ªå¤§æ•´æ•°çš„ä¹˜æ³•æ˜¯åœ¨è®¡ç®—æœºä¸­å¾ˆå¸¸è§çš„è¿ç®—ï¼Œå¦‚æœç”¨æ™®é€šçš„æ–¹æ³•è¿›è¡Œï¼Œå¤æ‚åº¦å°†ä¼šæ˜¯$ \\mathcal O(n^2) â€‹$çš„ï¼Œè¿˜æœ‰ä¸€ç§åˆ†æ²»ä¹˜æ³•ï¼Œå¯ä»¥åšåˆ° $\\mathcal O(n^{\\log_23}) â€‹$æ—¶é—´è®¡ç®—ï¼ˆå¯ä»¥çœ‹Karatsuba ä¹˜æ³•ï¼‰ã€‚ä¸‹é¢ä»è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•å‡ºå‘ï¼Œä»‹ç»å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆFast Fourier Transform, FFTï¼‰å¦‚ä½•åœ¨ $\\mathcal O(n\\log n) â€‹$çš„æ—¶é—´å†…è®¡ç®—å‡ºä¸¤ä¸ªå¤šé¡¹å¼çš„ä¹˜ç§¯ã€‚ å‡†å¤‡çŸ¥è¯†è¿™é‡Œä»‹ç»ä¸€äº›åé¢å¯èƒ½ä¼šç”¨åˆ°çš„çŸ¥è¯†ï¼ˆä¸»è¦æ˜¯å…³äºå¤šé¡¹å¼ã€å·ç§¯ä»¥åŠå¤æ•°çš„ï¼‰ï¼Œå¦‚æœä½ å·²ç»çŸ¥é“è§‰å¾—å®ƒå¤ªæ°´äº†æˆ–è€…æƒ³ç”¨åˆ°çš„æ—¶å€™å†çœ‹å°±è·³è¿‡å§ã€‚ å¤šé¡¹å¼ç®€å•æ¥è¯´ï¼Œå½¢å¦‚ $ a_0+a_1X+a_2X^2+\\cdots+a_nX^n $ çš„ä»£æ•°è¡¨è¾¾å¼å«åšå¤šé¡¹å¼ï¼Œå¯ä»¥è®°ä½œ$P(X)=a_0+a_1X+a_2X^2+\\cdots+a_nX^n$ï¼Œ$a_0, a_1, \\cdots, a_n $å«åšå¤šé¡¹å¼çš„ç³»æ•°ï¼Œ$X $æ˜¯ä¸€ä¸ªä¸å®šå…ƒï¼Œä¸è¡¨ç¤ºä»»ä½•å€¼ï¼Œä¸å®šå…ƒåœ¨å¤šé¡¹å¼ä¸­æœ€å¤§é¡¹çš„æ¬¡æ•°ç§°ä½œå¤šé¡¹å¼çš„æ¬¡æ•° å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºæ³•åƒåˆšåˆšæˆ‘ä»¬æåˆ°çš„é‚£äº›å¤šé¡¹å¼ï¼Œéƒ½æ˜¯ä»¥ç³»æ•°å½¢å¼è¡¨ç¤ºçš„ï¼Œä¹Ÿå°±æ˜¯å°† n æ¬¡å¤šé¡¹å¼$ A(x) $çš„ç³»æ•° $a_0, a_1, \\cdots, a_n $çœ‹ä½œ $n+1 $ç»´å‘é‡$ \\vec a=(a_0,a_1,\\cdots,a_n)$ï¼Œå…¶ç³»æ•°è¡¨ç¤ºï¼ˆcoefficient representationï¼‰å°±æ˜¯å‘é‡$ \\vec a$ ã€‚ å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºæ³•å¦‚æœé€‰å–$ n+1 $ä¸ªä¸åŒçš„æ•° $x_0, x_1, \\cdots, x_n $å¯¹å¤šé¡¹å¼è¿›è¡Œæ±‚å€¼ï¼Œå¾—åˆ°$ A(x_0), A(x_1), \\cdots, A(x_n)$ï¼Œé‚£ä¹ˆå°±ç§°$ {\\left(x_i, A(x_i)\\right) : 0 \\leq i \\leq n, i \\in \\mathbb Z} $ä¸ºå¤šé¡¹å¼$ A(x)$ çš„ç‚¹å€¼è¡¨ç¤ºï¼ˆpoint-value representationï¼‰ å¤šé¡¹å¼$ A(x) $çš„ç‚¹å€¼è¡¨ç¤ºä¸æ­¢ä¸€ç§ï¼Œä½ åªè¦é€‰å–ä¸åŒçš„æ•°å°±å¯ä»¥å¾—åˆ°ä¸åŒçš„ç‚¹å€¼è¡¨ç¤ºï¼Œä½†æ˜¯ä»»ä½•ä¸€ç§ç‚¹å€¼è¡¨ç¤ºéƒ½èƒ½å”¯ä¸€ç¡®å®šä¸€ä¸ªå¤šé¡¹å¼ï¼Œä¸ºäº†ä»ç‚¹å€¼è¡¨ç¤ºè½¬æ¢æˆç³»æ•°è¡¨ç¤ºï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æ’å€¼çš„æ–¹æ³• å¤æ•°åé¢æåˆ°çš„$ i$ï¼Œé™¤éä½œä¸º$ \\sum $æ±‚å’Œçš„å˜é‡ï¼Œå…¶ä½™çš„éƒ½è¡¨ç¤ºè™šæ•°å•ä½ $\\sqrt{-1}$ å•ä½æ ¹$n $æ¬¡å•ä½æ ¹æ˜¯æŒ‡èƒ½å¤Ÿæ»¡è¶³æ–¹ç¨‹$ z^n=1 $çš„å¤æ•°ï¼Œè¿™äº›å¤æ•°ä¸€å…±æœ‰$ n $ä¸ªå®ƒä»¬éƒ½åˆ†å¸ƒåœ¨å¤å¹³é¢çš„å•ä½åœ†ä¸Šï¼Œå¹¶ä¸”æ„æˆä¸€ä¸ªæ­£ $n $è¾¹å½¢ï¼Œå®ƒä»¬æŠŠå•ä½åœ†ç­‰åˆ†æˆ$ n $ä¸ªéƒ¨åˆ† æ ¹æ®å¤æ•°ä¹˜æ³•ç›¸å½“äºæ¨¡é•¿ç›¸ä¹˜ï¼Œå¹…è§’ç›¸åŠ å°±å¯ä»¥çŸ¥é“ï¼Œ$n $æ¬¡å•ä½æ ¹çš„æ¨¡é•¿ä¸€å®šæ˜¯$ 1$ï¼Œå¹…è§’çš„$ n $å€æ˜¯$ 0$è¿™æ ·ï¼Œ$n$ æ¬¡å•ä½æ ¹ä¹Ÿå°±æ˜¯ $$ e^{\\frac{2\\pi ki}{n}}, k = 0, 1, 2, \\cdots, n - 1 $$å†æ ¹æ®æ¬§æ‹‰å…¬å¼ $$ e^{\\theta i}=\\cos\\theta + i\\sin\\theta $$å°±å¯ä»¥çŸ¥é“ n æ¬¡å•ä½æ ¹çš„ç®—æœ¯è¡¨ç¤º å¦‚æœè®°$ \\omega_n=e^{\\frac{2\\pi i}{n}}$ï¼Œé‚£ä¹ˆ$ n $æ¬¡å•ä½æ ¹å°±æ˜¯ $\\omega_n^0, \\omega_n^1, \\cdots, \\omega_n^{n-1}$ å¤šé¡¹å¼çš„ä¹˜æ³•ç»™å®šä¸¤ä¸ªå¤šé¡¹å¼$ A(x), B(x)$ $$ A(x) = \\sum_{i=0}^na_ix^i = a_nx^n+a_{n-1}x^{n-1}+\\cdots+a_1x+a_0 \\\\ B(x) = \\sum_{i=0}^nb_ix^i = b_nx^n+b_{n-1}x^{n-1}+\\cdots+b_1x+b_0 $$ å°†è¿™ä¸¤ä¸ªå¤šé¡¹å¼ç›¸ä¹˜å¾—åˆ°$ C(x) = \\sum_{i=0}^{2n}c_ix^i$ï¼Œåœ¨è¿™é‡Œ $$ c_i=\\sum_{j+k=i,0\\leq j,k\\leq n}a_jb_kx^i $$ å¦‚æœä¸€ä¸ªä¸ªå»ç®—$ c_i $çš„è¯ï¼Œè¦èŠ±è´¹$ \\mathcal O(n^2) $çš„æ—¶é—´æ‰å¯ä»¥å®Œæˆï¼Œä½†æ˜¯ï¼Œè¿™æ˜¯åœ¨ç³»æ•°è¡¨ç¤ºä¸‹è®¡ç®—çš„ï¼Œå¦‚æœè½¬æ¢æˆç‚¹å€¼è¡¨ç¤ºï¼ŒçŸ¥é“äº†$ A(x), B(x) $çš„ç‚¹å€¼è¡¨ç¤ºåï¼Œç”±äºåªæœ‰$ n+1$ ä¸ªç‚¹ï¼Œå°±å¯ä»¥ç›´æ¥å°†å…¶ç›¸ä¹˜ï¼Œåœ¨ $\\mathcal O(n) $çš„æ—¶é—´å†…å¾—åˆ°$ C(x)$ çš„ç‚¹å€¼è¡¨ç¤º å¦‚æœèƒ½å¤Ÿæ‰¾åˆ°ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•å¸®åŠ©æˆ‘ä»¬åœ¨å¤šé¡¹å¼çš„ç‚¹å€¼è¡¨ç¤ºå’Œç³»æ•°è¡¨ç¤ºä¹‹é—´è½¬æ¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¿«é€Ÿåœ°è®¡ç®—å¤šé¡¹å¼çš„ä¹˜æ³•äº†ï¼Œå¿«é€Ÿå‚…é‡Œå¶å˜æ¢å°±å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ å¿«é€Ÿå‚…é‡Œå¶å˜æ¢å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ä½ å¯ä»¥è®¤ä¸ºæœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼ŒDFT å’Œ IDFTï¼Œåˆ†åˆ«å¯ä»¥åœ¨$ \\mathcal O(n\\log n) $çš„æ—¶é—´å†…å°†å¤šé¡¹å¼çš„ç³»æ•°è¡¨ç¤ºè½¬åŒ–æˆç‚¹å€¼è¡¨ç¤ºï¼Œå¹¶ä¸”è½¬å›æ¥ï¼Œå°±åƒä¸‹é¢è¿™å¼ å›¾æ‰€ç¤ºï¼š Cooley-Tukeyç®—æ³•FFT æœ€å¸¸è§çš„ç®—æ³•æ˜¯ Cooley-Tukey ç®—æ³•ï¼Œå®ƒçš„åŸºæœ¬æ€è·¯åœ¨ 1965 å¹´ç”± J. W. Cooley å’Œ J. W. Tukey æå‡ºçš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºåˆ†æ²»ç­–ç•¥çš„ç®—æ³• å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ª$ n-1 $æ¬¡å¤šé¡¹å¼$ A(x)=\\sum_{i=0}^{n-1}a_ix^i$ï¼ˆä¸ºäº†æ–¹ä¾¿ï¼Œå‡è®¾$ n=2^m, m\\in \\mathbb Z$ï¼Œå¦‚æœä¸è¶³å¯ä»¥åœ¨é«˜æ¬¡é¡¹ç³»æ•°è¡¥æˆ 0ï¼‰ å°†$ n $ä¸ª$ n $æ¬¡å•ä½æ ¹$ \\omega_n^0, \\omega_n^1, \\cdots, \\omega_n^{n-1}$ å¸¦å…¥$ A(x) $å°†å…¶è½¬æ¢æˆç‚¹å€¼è¡¨è¾¾ $$ A(\\omega_n^k) = \\sum_{i=0}^{n-1}a_i\\omega^{ki} , k = 0, 1, \\cdots, n - 1 $$ ç‚¹å€¼å‘é‡ $ \\vec y=(A(\\omega_n^0), A(\\omega_n^1), \\cdots, A(\\omega_n^{n-1})) $ ç§°ä½œç³»æ•°å‘é‡$ \\vec a=(a_0, a_1, \\cdots, a_{n-1}) $çš„ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDiscrete Fourier Transform, DFTï¼‰ï¼Œä¹Ÿè®°ä½œ$ \\vec y=DFT_n(\\vec a) $ åˆ°æ­¤ä¸ºæ­¢ï¼Œç›´æ¥è®¡ç®—$ DFT_n(\\vec a) $è¿˜æ˜¯éœ€è¦$ \\mathcal O(n^2) $çš„æ—¶é—´ï¼ŒCooley-Tukey ç®—æ³•æ¥ä¸‹æ¥åšçš„äº‹æƒ…æ˜¯å°†æ¯ä¸€é¡¹æŒ‰ç…§æŒ‡æ•°å¥‡å¶åˆ†ç±» $$ \\begin{eqnarray*} A(\\omega_n^k) &=& \\sum_{i=0}^{n-1}a_i\\omega_n^{ki} \\\\ &=& \\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_n^{2ki}+\\omega_n^k\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_n^{2ki} \\\\ \\end{eqnarray*} $$ ä½†æ˜¯ï¼Œå¦‚æœç›´æ¥è¿™æ ·é€’å½’ä¸‹å»ï¼Œä½ éœ€è¦å¸¦å…¥çš„å€¼è¿˜æ˜¯æœ‰$ n $ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç°åœ¨åªæ˜¯å°†ç³»æ•°å‡åŠï¼Œè€Œæ²¡æœ‰å°†éœ€è¦å¸¦å…¥çš„å€¼å‡åŠï¼Œä¸Šé¢çš„$ k $è¿˜æ˜¯$ 0, 1, \\cdots, n - 1$ï¼Œè¿™æ ·çš„è¯å¤æ‚åº¦è¿˜æ˜¯$ \\mathcal O(n^2)$ ä½†æ˜¯ä½ ä¼šæ³¨æ„åˆ°ï¼Œæ ¹æ®å‡†å¤‡çŸ¥è¯†ä¸­$ \\omega_n^2=\\left(e^{\\frac{2\\pi i}{n}}\\right)^2=e^{\\frac{2\\pi i}{n/2}}=\\omega_{\\frac{n}{2}}$ ï¼Œå¹¶ä¸”$ \\frac{n}{2} $æ¬¡å•ä½æ ¹åªæœ‰$ \\frac{n}{2} $ä¸ªï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦å¸¦å…¥çš„å€¼å†å¹³æ–¹ä»¥åä¼¼ä¹å˜å°‘äº†ä¸€åŠï¼Ÿä»”ç»†æƒ³æƒ³å°±ä¼šå‘ç°ï¼Œæ—¢ç„¶å•ä½æ ¹æŠŠå•ä½åœ†ç­‰åˆ†ï¼Œé‚£ä¹ˆè‚¯å®šä¼šå¯¹ç§°ï¼Œä¹Ÿå°±æ˜¯æœ‰ä¸€ä¸ªæ­£çš„ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªè´Ÿçš„ï¼Œå¹³æ–¹åè¿™ä¸¤ä¸ªå½“ç„¶å°±ç›¸åŒäº†ã€‚ä¸¥æ ¼ä¸€ç‚¹çš„è¯æ˜å°±æ˜¯ $$ \\omega_n^{\\frac{n}{2}+k} = \\omega_n^{\\frac{n}{2}}\\cdot \\omega_n^k = -\\omega_n^k $$ è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äº$ k &lt; \\frac{n}{2}$ çš„æ—¶å€™ $$ A(\\omega_n^k) = \\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_{\\frac{n}{2}}^{ki}+\\omega_n^{k}\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_{\\frac{n}{2}}^{ki} $$ å¹¶ä¸” $$ \\begin{eqnarray*} A(\\omega_n^{k+\\frac{n}{2}}) &=& \\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_{\\frac{n}{2}}^{ki}+\\omega_n^{k+\\frac{n}{2}}\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_{\\frac{n}{2}}^{ki} \\\\ &=&\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_{\\frac{n}{2}}^{ki}-\\omega_n^k\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_{\\frac{n}{2}}^{ki} \\end{eqnarray*} $$ è¿™æ ·æˆ‘ä»¬å°±å°†éœ€è¦å¸¦å…¥çš„å€¼ä¹Ÿå‡å°‘æˆäº† $ 1, \\omega_{\\frac{n}{2}}, \\omega_{\\frac{n}{2}}^2, \\cdots, \\omega_{\\frac{n}{2}}^{\\frac{n}{2}-1} $ï¼Œé—®é¢˜å˜æˆäº†ä¸¤ä¸ªè§„æ¨¡å‡åŠçš„å­é—®é¢˜ï¼Œåªè¦é€’å½’ä¸‹å»è®¡ç®—å°±å¯ä»¥äº†ï¼Œè‡³äºå¤æ‚åº¦ $$ T(n) = 2T(\\frac{n}{2})+\\mathcal O(n) = \\mathcal O(n\\log n) $$ å‚…é‡Œå¶é€†å˜æ¢ï¼ˆIDFTï¼‰åˆšåˆšè®¡ç®—çš„æ˜¯$ \\vec y = DFT_n(\\vec a)$ï¼Œå¯ä»¥å°†å¤šé¡¹å¼è½¬åŒ–æˆç‚¹å€¼è¡¨ç¤ºï¼Œç°åœ¨ä¸ºäº†å°†ç‚¹å€¼è¡¨ç¤ºè½¬åŒ–æˆç³»æ•°è¡¨ç¤ºï¼Œéœ€è¦è®¡ç®— IDFTï¼ˆInverse Discrete Fourier Transformï¼‰ï¼Œå®ƒæ˜¯ DFT çš„é€† è¿™ä¸ªé—®é¢˜å®é™…ä¸Šç›¸å½“äºæ˜¯ä¸€ä¸ªè§£çº¿æ€§æ–¹ç¨‹ç»„çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ç»™å‡ºäº†$ n $ä¸ªçº¿æ€§æ–¹ç¨‹ $$ \\begin{equation*} \\left\\{ \\begin{array}{ccccccccc} a_0(\\omega_n^0)^{0}&+&\\cdots&+&a_{n-2}(\\omega_n^0)^{n-2}&+&+a_{n-1}(\\omega_n^0)^{n-1}&=&A(\\omega_n^0) \\\\ a_0(\\omega_n^1)^{0}&+&\\cdots&+&a_{n-2}(\\omega_n^1)^{n-2}&+&+a_{n-1}(\\omega_n^1)^{n-1}&=&A(\\omega_n^1) \\\\ \\vdots & & \\vdots & &\\vdots& & \\vdots & & \\vdots\\\\ a_0(\\omega_n^{n-1})^{0}&+&\\cdots&+&a_{n-2}(\\omega_n^{n-1})^{n-2}&+&+a_{n-1}(\\omega_n^{n-1})^{n-1}&=&A(\\omega_n^{n-1}) \\end{array} \\right. \\end{equation*} $$ å†™æˆçŸ©é˜µæ–¹ç¨‹çš„å½¢å¼å°±æ˜¯ $$ \\begin{equation} \\label{IDFT-equation} \\begin{bmatrix} (\\omega_n^0)^0 & (\\omega_n^0)^1 & \\cdots & (\\omega_n^0)^{n-1} \\\\ (\\omega_n^1)^0 & (\\omega_n^1)^1 & \\cdots & (\\omega_n^1)^{n-1} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ (\\omega_n^{n-1})^0 & (\\omega_n^{n-1})^1 & \\cdots & (\\omega_n^{n-1})^{n-1} \\end{bmatrix} \\begin{bmatrix} a_0 \\\\ a_1 \\\\ \\vdots \\\\ a_{n-1} \\end{bmatrix} = \\begin{bmatrix} A(\\omega_n^0) \\\\ A(\\omega_n^1) \\\\ \\vdots \\\\ A(\\omega_n^{n-1}) \\end{bmatrix} \\end{equation} $$ è®°ä¸Šé¢çš„ç³»æ•°çŸ©é˜µä¸º$ \\mathbf V$ ç°åœ¨è€ƒè™‘ä¸‹é¢è¿™ä¸ªçŸ©é˜µ$ d_{ij}=\\omega_n^{-ij}$ $$ \\begin{equation*} \\mathbf D = \\begin{bmatrix} (\\omega_n^{-0})^0 & (\\omega_n^{-0})^1 & \\cdots & (\\omega_n^{-0})^{n-1} \\\\ (\\omega_n^{-1})^0 & (\\omega_n^{-1})^1 & \\cdots & (\\omega_n^{-1})^{n-1} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ (\\omega_n^{-(n-1)})^0 & (\\omega_n^{-(n-1)})^1 & \\cdots & (\\omega_n^{-(n-1)})^{n-1} \\end{bmatrix} \\end{equation*} $$ è®¾å®ƒä»¬ç›¸ä¹˜åçš„ç»“æœæ˜¯$ \\mathbf E=\\mathbf D \\cdot \\mathbf V$ $$ \\begin{eqnarray*} e_{ij} &=& \\sum_{k=0}^{n-1} d_{ik} v_{kj} \\\\ &=& \\sum_{k=0}^{n-1} \\omega_n^{-ik}\\omega_n^{kj} \\\\ &=& \\sum_{k=0}^{n-1} \\omega_n^{k(j-i)} \\end{eqnarray*} $$ å½“$ i=j $æ—¶ï¼Œ$e_{ij}=n$ å½“$ i\\neq j $æ—¶ï¼Œ $$ \\begin{eqnarray*} e_{ij} &=& \\sum_{k=0}^{n-1} (\\omega_n^{j-i})^k \\\\ &=& \\frac{1-(\\omega_n^{j-i})^n}{1-\\omega_n^{j-i}}\\\\ &=& 0 \\end{eqnarray*} $$ å› æ­¤å¯ä»¥çŸ¥é“$ \\mathbf I_n=\\frac{1}{n}\\mathbf E$ï¼Œæ‰€ä»¥$ \\frac{1}{n}\\mathbf D = \\mathbf V^{-1}$ å°†$ \\frac{1}{n}\\mathbf D $åœ¨$ \\ref{IDFT-equation} $ å·¦ä¹˜å°±ä¼šå¾—åˆ° $$ \\begin{equation*} \\begin{bmatrix} a_0 \\\\ a_1 \\\\ \\vdots \\\\ a_{n-1} \\end{bmatrix} = \\frac{1}{n} \\begin{bmatrix} (\\omega_n^{-0})^0 & (\\omega_n^{-0})^1 & \\cdots & (\\omega_n^{-0})^{n-1} \\\\ (\\omega_n^{-1})^0 & (\\omega_n^{-1})^1 & \\cdots & (\\omega_n^{-1})^{n-1} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ (\\omega_n^{-(n-1)})^0 & (\\omega_n^{-(n-1)})^1 & \\cdots & (\\omega_n^{-(n-1)})^{n-1} \\end{bmatrix} \\begin{bmatrix} A(\\omega_n^0) \\\\ A(\\omega_n^1) \\\\ \\vdots \\\\ A(\\omega_n^{n-1}) \\end{bmatrix} \\end{equation*} $$ è¿™æ ·ï¼ŒIDFT å°±ç›¸å½“äºæŠŠ DFT è¿‡ç¨‹ä¸­çš„$ \\omega_n^i $æ¢æˆ$ \\omega_n^{-i}$ï¼Œç„¶ååšä¸€æ¬¡ DFTï¼Œä¹‹åç»“æœé™¤ä»¥$ n$ å°±å¯ä»¥äº†ã€‚ ç®—æ³•å®ç°é€’å½’å®ç°æ ¹æ®å‰é¢çš„è¯´æ˜ï¼Œé€’å½’å®ç°çš„ FFT åº”è¯¥ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ï¼Œä¸‹é¢å°±ç›´æ¥ç»™å‡º C++ ä»£ç äº†ï¼ˆä¸»æ„ nè¦è¡¥é½åˆ° $2^m$ï¼‰ 123456789101112131415void fft(int n, complex&lt;double&gt;* buffer, int offset, int step, complex&lt;double&gt;* epsilon) &#123; if(n == 1) return; int m = n &gt;&gt; 1; fft(m, buffer, offset, step &lt;&lt; 1, epsilon); fft(m, buffer, offset + step, step &lt;&lt; 1, epsilon); for(int k = 0; k != m; ++k) &#123; int pos = 2 * step * k; temp[k] = buffer[pos + offset] + epsilon[k * step] * buffer[pos + offset + step]; temp[k + m] = buffer[pos + offset] - epsilon[k * step] * buffer[pos + offset + step]; &#125; for(int i = 0; i != n; ++i) buffer[i * step + offset] = temp[i];&#125; è¿™é‡Œçš„ epsilonæ˜¯äº‹å…ˆæ‰“å¥½äº†çš„$ \\omega_n $çš„è¡¨ 12345678void init_epsilon(int n)&#123; double pi = acos(-1); for(int i = 0; i != n; ++i) &#123; epsilon[i] = complex&lt;double&gt;(cos(2.0 * pi * i / n), sin(2.0 * pi * i / n)); arti_epsilon[i] = conj(epsilon[i]); &#125;&#125; è¿­ä»£å®ç°å‡è®¾ç°åœ¨æœ‰$ 16 $ä¸ªæ•°è¦è¿›è¡Œ$DFT $æ¥çœ‹çœ‹é€’å½’çš„è¿‡ç¨‹ åœ¨ Step1 -&gt; Step2 çš„è¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§å¥‡å¶åˆ†ç±»ï¼ŒäºŒè¿›åˆ¶ä½ä¸­æœ€åä¸€ä½ç›¸åŒçš„è¢«åˆ†åˆ°åŒä¸€ç»„ åœ¨ Step2 -&gt; Step3 çš„è¿‡ç¨‹ä¸­ï¼Œä»ç„¶æŒ‰ç…§å¥‡å¶ï¼Œåªä¸è¿‡ä¸æ˜¯æŒ‰ç…§æ•°å­—çš„å¥‡å¶æ€§ï¼Œè€Œæ˜¯ä¸‹æ ‡çš„å¥‡å¶æ€§ï¼ŒäºŒè¿›åˆ¶ä½ä¸­æœ€åä¸¤ä½ç›¸åŒçš„æ‰è¢«åˆ†åˆ°åŒä¸€ç»„ åœ¨ Step3 -&gt; Step4 çš„è¿‡ç¨‹ä¸­ï¼ŒäºŒè¿›åˆ¶ä½ä¸­æœ€åä¸‰ä½ç›¸åŒçš„æ•°å­—è¢«åˆ†åœ¨åŒä¸€ç»„ ç°åœ¨å°†æ•´ä¸ªäºŒè¿›åˆ¶ä½åè½¬ï¼Œä¾‹å¦‚ 0010 å°±å˜æˆ 0100ï¼Œè¿™æ—¶å€™æ¯æ¬¡åœ¨åŒä¸€ç»„çš„æ•°å­—ï¼Œåè½¬åçš„äºŒè¿›åˆ¶ä½å‰å‡ ä½éƒ½æ˜¯ç›¸åŒçš„ï¼Œè¿™ä¼¼ä¹ååˆ†ç±»ä¼¼åŠ æ³•ï¼Œç›¸é‚»ä¸¤ç»„äºŒè¿›åˆ¶ä½åè½¬ä¹‹åæ•°å­—ä¼šæ˜¯è¿ç»­çš„ä¸€æ®µåŒºé—´ã€‚ä¾‹å¦‚åœ¨ Step3 ä¸­ï¼Œ1ã€5ã€9ã€13 è¿™ä¸€ç»„ï¼Œåè½¬äºŒè¿›åˆ¶åæ˜¯ 1(1000)ã€5(1010)ã€9(1001)ã€13(1011)ï¼Œåˆ†ç»„åæ˜¯ 1(1000)ã€9(1001) å’Œ 5(1010)ã€13(1011) å‡è®¾reverse(i)æ˜¯å°†äºŒè¿›åˆ¶ä½åè½¬çš„æ“ä½œï¼ŒDFT æœ€åä¸€æ­¥çš„æ•°ç»„æ˜¯ Bï¼ŒåŸæ¥çš„æ•°ç»„æ˜¯ Aï¼Œé‚£ä¹ˆ A å’Œ B ä¹‹é—´æœ‰è¿™æ ·çš„å…³ç³»B[reverse(i)]=A[i]ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ B[i + 1]=A[reverse(reverse(i)+ 1)]ï¼ŒB ä¸­ç¬¬ i é¡¹çš„ä¸‹ä¸€é¡¹å°±æ˜¯å°† i åè½¬ååŠ  1 å†åè½¬å›æ¥ A ä¸­çš„é‚£ä¸€é¡¹ï¼Œæ‰€ä»¥ç°åœ¨è¦æ¨¡æ‹Ÿçš„å°±æ˜¯ä»é«˜ä½å¼€å§‹çš„äºŒè¿›åˆ¶åŠ æ³• è€ƒè™‘æ­£å‘äºŒè¿›åˆ¶åŠ æ³•çš„è¿‡ç¨‹ï¼Œç›¸å½“äºä»æœ€ä½ä½å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª 0ï¼Œç„¶åæŠŠè¿™ä¸ª 0 æ”¹æˆ 1ï¼Œä¹‹å‰çš„ 1 å…¨éƒ¨å˜æˆ 0ã€‚é‚£ä¹ˆåå‘äºŒè¿›åˆ¶åŠ æ³•å°±æ˜¯ä»æœ€é«˜ä½å¼€å§‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ª 0ï¼Œç„¶åæŠŠè¿™ä¸ª 0 æ”¹æˆ 1ï¼Œå‰é¢çš„ 1 å…¨éƒ¨æ”¹æˆ 0ï¼Œæ‰€ä»¥å°±æ˜¯è¿™æ · 1234int reverse_add(int x) &#123; for(int l = 1 &lt;&lt; bit_length; (x ^= l) &lt; l; l &gt;&gt;= 1); return x;&#125; ä¸ºäº†ä»åŸæ¥çš„ A æ•°ç»„ï¼Œå¾—åˆ°æœ€åä¸€æ­¥æ‰€éœ€è¦çš„ B æ•°ç»„ï¼Œåªè¦ç»´æŠ¤ä¸¤ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯å½“å‰ä¸‹æ ‡ iï¼Œä¸€ä¸ªæ˜¯åå‘åŠ çš„ä¸‹æ ‡ jï¼Œè¡¨ç¤º B[i] åº”è¯¥æ”¾ A[j] æ”¾çš„ä¸œè¥¿ï¼Œå¦‚æœ i &gt; jï¼Œåªè¦å°† i å’Œ j å­˜çš„ä¸œè¥¿äº¤æ¢ï¼Œè¿™æ ·æœ€åå°±å¯ä»¥å¾—åˆ°æ‰€éœ€è¦çš„ B æ•°ç»„ 12345678/* è¿™æ—¶å€™ n å·²ç»è¡¥é½åˆ° 2 çš„å¹‚æ¬¡ */void bit_reverse(int n, complex_t *x) &#123; for(int i = 0, j = 0; i != n; ++i) &#123; if(i &gt; j) swap(x[i], x[j]); for(int l = n &gt;&gt; 1; (j ^= l) &lt; l; l &gt;&gt;= 1); &#125;&#125; ç°åœ¨å·²ç»æŠŠè¦å˜æ¢çš„å…ƒç´ æ’åœ¨ç›¸é‚»ä½ç½®äº†ï¼Œæ‰€ä»¥ä»ä¸‹å¾€ä¸Š $2 $å¼€å§‹åˆ° $2^m $æ¥è¿›è¡Œè®¡ç®—ï¼Œæ¯æ¬¡æšä¸¾ä¸€å—å¾€ä¸Šè¿­ä»£å³å¯ï¼ 12345678910111213141516void transform(int n, complex_t *x, complex_t *w) &#123; bit_reverse(n, x); for(int i = 2; i &lt;= n; i &lt;&lt;= 1) &#123; int m = i &gt;&gt; 1; for(int j = 0; j &lt; n; j += i) &#123; for(int k = 0; k != m; ++k) &#123; complex_t z = x[j + m + k] * w[n / i * k]; x[j + m + k] = x[j + k] - z; x[j + k] += z; &#125; &#125; &#125;&#125; å¿«é€Ÿæ•°è®ºå˜æ¢ç”±äº FFT æ¶‰åŠåˆ°å¤æ•°è¿ç®—ï¼Œéš¾å…æœ‰ç²¾åº¦é—®é¢˜ï¼Œåœ¨è®¡ç®—ä¸€äº›åªè¦æ±‚æ•´æ•°çš„å·ç§¯æˆ–é«˜ç²¾åº¦ä¹˜æ³•çš„æ—¶å€™å°±æœ‰å¯èƒ½ç”±äºç²¾åº¦å‡ºç°é”™è¯¯ï¼Œè¿™ä¾¿è®©æˆ‘ä»¬è€ƒè™‘æ˜¯å¦æœ‰åœ¨æ¨¡æ„ä¹‰ä¸‹çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯å¿«é€Ÿæ•°è®ºå˜æ¢ï¼ˆFast Number-Theoretic Transformï¼ŒFNTï¼‰ é¦–å…ˆæ¥çœ‹ FFT ä¸­èƒ½åœ¨$ \\mathcal O(n\\log n) $æ—¶é—´å†…å˜æ¢ç”¨åˆ°äº†å•ä½æ ¹ $\\omega $çš„ä»€ä¹ˆæ€§è´¨ $\\omega_n^n=1$ $\\omega_n^0, \\omega_n^1, \\cdots, \\omega_n^{n-1} $æ˜¯äº’ä¸ç›¸åŒçš„ï¼Œè¿™æ ·å¸¦å…¥è®¡ç®—å‡ºæ¥çš„ç‚¹å€¼æ‰å¯ä»¥ç”¨æ¥è¿˜åŸå‡ºç³»æ•° $ \\omega_n^2=\\omega_{\\frac{n}{2}}, \\omega_n^{\\frac{n}{2}+k}=-\\omega_n^k $ ï¼Œè¿™ä½¿å¾—åœ¨æŒ‰ç…§æŒ‡æ•°å¥‡å¶åˆ†ç±»ä¹‹åèƒ½å¤ŸæŠŠå¸¦å…¥çš„å€¼ä¹Ÿå‡åŠä½¿å¾—é—®é¢˜è§„æ¨¡èƒ½å¤Ÿå‡åŠ $$ \\sum_{k=0}^{n-1} (\\omega_n^{j-i})^k = \\begin{eqnarray*} \\left\\{ \\begin{aligned}0, ~~~&i \\neq j\\\\ n, ~~~&i = j \\end{aligned} \\right. \\end{eqnarray*} $$ â€‹ è¿™ç‚¹ä¿è¯äº†èƒ½å¤Ÿä½¿ç”¨ç›¸åŒçš„æ–¹æ³•è¿›è¡Œé€†å˜æ¢å¾—åˆ°ç³»æ•°è¡¨ç¤º åŸæ ¹ç°åœ¨æˆ‘ä»¬è¦åœ¨æ•°è®ºä¸­å¯»æ‰¾æ»¡è¶³è¿™ä¸‰ä¸ªæ€§è´¨çš„æ•°ï¼Œé¦–å…ˆæ¥ä»‹ç»åŸæ ¹çš„æ¦‚å¿µï¼Œæ ¹æ®è´¹é©¬å®šç†æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€ä¸ªç´ æ•°$ p$ï¼Œæœ‰ä¸‹é¢è¿™æ ·çš„å…³ç³» $$ a^{p-1} \\equiv 1 \\pmod p $$ è¿™ä¸€ç‚¹å’Œå•ä½æ ¹ $\\omega$ ååˆ†ç›¸ä¼¼ï¼Œ$p$ çš„åŸæ ¹ $g $å®šä¹‰ä¸ºä½¿å¾— $g^0, g^1, \\cdots, g^{p-2} \\pmod p $äº’ä¸ç›¸åŒçš„æ•° å¦‚æœæˆ‘ä»¬å–ç´ æ•°$ p = k\\cdot 2^n + 1$ï¼Œå¹¶ä¸”æ‰¾åˆ°å®ƒçš„åŸæ ¹$ g$ï¼Œç„¶åæˆ‘ä»¬ä»¤$ g_n\\equiv g^k\\pmod p$ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿å¾—$ g_n^0, g_n^1, \\cdots, g_n^{n-1} \\pmod p $äº’ä¸ç›¸åŒï¼Œå¹¶ä¸”$ g_n^n\\equiv 1\\pmod p$ï¼Œè¿™ä¾¿æ»¡è¶³äº†æ€§è´¨ä¸€å’Œæ€§è´¨äºŒ ç”±äº$ p $æ˜¯ç´ æ•°ï¼Œå¹¶ä¸”$ g_n^n \\equiv 1 \\mod p$ï¼Œè¿™æ · $g_n^\\frac{n}{2} \\bmod p $å¿…ç„¶æ˜¯$ -1 $æˆ– $1$ï¼Œå†æ ¹æ®$ g^k $äº’ä¸ç›¸åŒè¿™ä¸ªç‰¹ç‚¹ï¼Œæ‰€ä»¥$ g_n^\\frac{n}{2} \\equiv -1 \\pmod p$ï¼Œæ»¡è¶³æ€§è´¨ä¸‰ å¯¹äºæ€§è´¨å››ï¼Œå’Œå‰é¢ä¸€æ ·ä¹Ÿå¯ä»¥éªŒè¯æ˜¯æ»¡è¶³çš„ï¼Œå› æ­¤å† FNT ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŸæ ¹æ›¿ä»£å•ä½æ ¹ï¼Œè¿™é‡Œå·²ç»æœ‰äº†ä¸€äº›æ•°$ p $åŠå…¶åŸæ ¹ï¼Œå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚ æ¨¡æ•°ä»»æ„çš„è§£å†³æ–¹æ¡ˆå‰é¢è¯´äº†ï¼Œè¦è¿›è¡Œå¿«é€Ÿæ•°è®ºå˜æ¢éœ€è¦æ¨¡æ•°æ˜¯ $a\\cdot 2^k + 1 $å½¢å¼çš„ç´ æ•°ï¼Œä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¦æ±‚çš„æ¨¡æ•°å¯èƒ½ä¸æ˜¯è¿™æ ·çš„å½¢å¼ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªåˆæ•°ï¼ å‡è®¾ç°åœ¨éœ€è¦æ¨¡ $m$ï¼Œå¹¶ä¸”è¿›è¡Œå˜æ¢çš„é•¿åº¦æ˜¯$ n$ é‚£ä¹ˆè¿™æ ·ä»»ä½•å¤šé¡¹å¼ç³»æ•°çš„èŒƒå›´æ˜¯$ [0, m)$ï¼Œä¸¤ä¸ªç›¸ä¹˜ï¼Œä¸ä¼šè¶…è¿‡$ (m - 1)^2$ï¼Œä¸€å…± $n $é¡¹ç›¸åŠ ï¼Œä¸ä¼šè¶…è¿‡ $n(m-1)^2$ è¿™æ ·çš„è¯ï¼Œé€‰å–$ k $ä¸ªæœ‰ä¸Šé¢å½¢å¼çš„ç´ æ•°$ p_1, p_2, \\cdots, p_k$ï¼Œè¦æ±‚æ»¡è¶³ $$ \\prod_{i=1}^k p_k > n(m-1)^2 $$ ç„¶ååˆ†åˆ«åœ¨$ \\bmod k $çš„å‰©ä½™ç³»ä¸‹åšå˜æ¢ï¼Œæœ€åä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†åˆå¹¶ï¼ˆå½“ç„¶è¿™æ—¶å€™æˆ–è®¸æ˜¯éœ€è¦é«˜ç²¾åº¦æˆ–è€…__int128 çš„ï¼‰ ä»£ç å®ç°FNT çš„ä»£ç å®ç°å’Œ FFT æ˜¯ä¸€æ ·çš„ï¼Œåªè¦æŠŠå¤æ•°è¿ç®—æ¢æˆåœ¨ $\\bmod p$ å‰©ä½™ç³»ä¸‹çš„è¿ç®—å³å¯ åº”ç”¨å¿«é€Ÿå·ç§¯ç°æœ‰ä¸¤ä¸ªå®šä¹‰åœ¨$ \\mathbb N $ä¸Šçš„å‡½æ•°$ f(n), g(n)$ï¼Œå®šä¹‰$ f $å’Œ $g $çš„å·ç§¯ï¼ˆconvolutionï¼‰ä¸º $f \\otimes g$ $$ (f \\otimes g)(n) = \\sum_{i=0}^n f(i)g(n-i) $$ å°±åƒä¸Šé¢çš„å›¾ä¸€æ ·ï¼Œæ³¨æ„åˆ°å·ç§¯çš„å½¢å¼å’Œå¤šé¡¹å¼ä¹˜æ³•çš„å½¢å¼æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå¤šé¡¹å¼$ A(x), B(x)$ï¼Œä»¤$ C(x) = A(x)B(x)$ï¼Œé‚£ä¹ˆä¼šæœ‰$ c_i=(a \\otimes b)(i)$ï¼Œå› æ­¤å¯ä»¥ç”¨ FFT æ¥è®¡ç®—å·ç§¯ å¯¹äºè¦è®¡ç®—æŸäº›å½¢å¦‚ $h(k) = \\sum_{i=0}^n f(i)g(i+k) $ çš„é—®é¢˜ï¼Œå¯ä»¥ä»¤$ fâ€™(x) = f(n-x)$ï¼Œè¿™æ ·é—®é¢˜å°±å˜æˆè®¡ç®—$ \\sum_{i=0}^n fâ€™(n-i)g(i+k)$ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå·ç§¯çš„å½¢å¼ ä¾‹1ï¼š[ZJOI2014]åŠ›é¢˜ç›®ç»™å‡º$ n $ä¸ªæ•°$ q_1, q_2, \\cdots, q_n$ï¼Œè¦æ±‚è®¡ç®— $$ F_i = \\sum_{j=1}^{i-1}\\frac{q_iq_j}{(j-i)^i}-\\sum_{j=i+1}^{n}\\frac{q_iq_j}{(j-i)^i} $$ è§‚å¯Ÿä¸€ä¸‹ï¼Œå‡è®¾æœ‰å››ä¸ªæ•°$ q_1, q_2, q_3, q_4$ï¼Œé‚£ä¹ˆ $$ \\begin{eqnarray*} \\frac{F_1}{q_1} &=& -\\frac{q_2}{1^2}-\\frac{q_3}{2^2}-\\frac{q_4}{3^2} \\\\ \\frac{F_2}{q_2} &=& +\\frac{q_1}{1^2}-\\frac{q_3}{1^2}-\\frac{q_4}{2^2} \\\\ \\frac{F_3}{q_3} &=& +\\frac{q_1}{2^2}+\\frac{q_2}{1^2}-\\frac{q_4}{1^2} \\\\ \\frac{F_4}{q_4} &=& +\\frac{q_1}{3^2}+\\frac{q_2}{2^2}+\\frac{q_3}{1^2} \\\\ \\end{eqnarray*} $$ åˆçœ‹ä¹‹ä¸‹ä¼¼ä¹æ²¡ä»€ä¹ˆè§„å¾‹ï¼Œä½†æ˜¯è¿™ä¹‹ä¸­å‡ºç°çš„å‡ ä¸ªæ•°åˆ—å‡ºæ¥ q_1 q_2 q_3 q_4 0 0 0 $-\\frac{1}{3^2}$ $-\\frac{1}{2^2}$ $-\\frac{1}{1^2}$ $0$ $\\frac{1}{1^2}$ $\\frac{1}{2^2}$ $\\frac{1}{3^2}$ åˆ—å‡ºæ¥ä¹‹åä½ çœ‹çœ‹æ¯ä¸ª $\\frac{F_i}{q_i} $çš„è®¡ç®—ï¼Œå°±ä¼šå‘ç°åˆšå¥½æ˜¯åƒä¸Šé¢é‚£å¼ å›¾ä¸€æ ·çš„é¡ºåºç›¸ä¹˜å†ç›¸åŠ ï¼Œæ˜¯ä¸ªå·ç§¯çš„å½¢å¼ï¼å› æ­¤æœ€ååªéœ€è¦ç”¨ FFT ä¼˜åŒ–è®¡ç®—å·ç§¯ï¼Œå°±å¯ä»¥è§£å†³æ­¤é—®é¢˜ï¼Œä¸è¿‡è¦æ³¨æ„ç²¾åº¦é—®é¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879#include &lt;cstdio&gt;#include &lt;complex&gt;#include &lt;cmath&gt;#include &lt;algorithm&gt;const int MaxL = 18, MaxN = 1 &lt;&lt; MaxL;typedef std::complex&lt;double&gt; complex_t;complex_t f[MaxN], g[MaxN];complex_t eps[MaxN], inv_eps[MaxN];void init_eps(int p)&#123; double pi = acos(-1); double angle = 2.0 * pi / p; for(int i = 0; i != p; ++i) eps[i] = complex_t(cos(2.0 * pi * i / p), sin(2.0 * pi * i / p)); for(int i = 0; i != p; ++i) inv_eps[i] = conj(eps[i]);&#125;void transform(int n, complex_t *x, complex_t *w)&#123; for(int i = 0, j = 0; i != n; ++i) &#123; if(i &gt; j) std::swap(x[i], x[j]); for(int l = n &gt;&gt; 1; (j ^= l) &lt; l; l &gt;&gt;= 1); &#125; for(int i = 2; i &lt;= n; i &lt;&lt;= 1) &#123; int m = i &gt;&gt; 1; for(int j = 0; j &lt; n; j += i) &#123; for(int k = 0; k != m; ++k) &#123; complex_t z = x[j + m + k] * w[n / i * k]; x[j + m + k] = x[j + k] - z; x[j + k] += z; &#125; &#125; &#125;&#125;int main()&#123; int n; std::scanf(\"%d\", &amp;n); int l = 0, p = 1; while(p &lt; n) ++l, p &lt;&lt;= 1; ++l, p &lt;&lt;= 1; for(int i = 0; i != p; ++i) f[i] = g[i] = 0.0; for(int i = 0; i != n; ++i) &#123; double x; std::scanf(\"%lf\", &amp;x); f[i] = x; &#125; for(int i = 0; i + 1 &lt; n; ++i) &#123; g[i] = 1.0 / ((n - i - 1.0) * (n - i - 1.0)); g[2 * n - i - 2] = -g[i]; &#125; init_eps(p); std::reverse(g, g + p); transform(p, f, eps); transform(p, g, eps); for(int i = 0; i != p; ++i) f[i] *= g[i]; transform(p, f, inv_eps); for(int i = p - n; i != p; ++i) std::printf(\"%.3lf\\n\", f[i].real() / p); return 0;&#125; ç”Ÿæˆå‡½æ•°è¿ç®—å¯¹äºä¸€äº›éœ€è¦ç”¨åˆ°ç”Ÿæˆå‡½æ•°çš„è®¡æ•°é—®é¢˜ï¼Œåœ¨åˆ—å‡ºç”Ÿæˆå‡½æ•°ä¹‹åæœ‰å¯èƒ½éœ€è¦å°†å…¶å¹³æ–¹ã€æ±‚å¯¹æ•°ã€æ±‚é€†å…ƒæˆ–è€…å¼€æ–¹ï¼Œè¿™æ—¶ä¾¿å¯ä»¥ç”¨ FFT æ¥åŠ é€Ÿè®¡ç®— ä¾‹2ï¼š[BZOJ3771]Tripleè¿™ä¸ªé—®é¢˜å°±æ˜¯ç”¨ FFT åŠ é€Ÿå¤šé¡¹å¼ä¹˜æ³•çš„è¿‡ç¨‹ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸Šé¢è¿™ç¯‡é¢˜è§£ å¤šé¡¹å¼æ±‚é€†ã€é™¤æ³•ã€å–æ¨¡å…³äºå¤šé¡¹å¼çš„æ±‚é€†å…ƒï¼Œå¯ä»¥çœ‹è¿™é‡Œ å…³äºå¤šé¡¹å¼çš„é™¤æ³•å’Œæ±‚æ¨¡ï¼Œå¯ä»¥çœ‹è¿™é‡Œ å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼å…³äºå¤šé¡¹å¼çš„å¤šç‚¹æ±‚å€¼å’Œå¿«é€Ÿæ’å€¼ï¼Œå¯ä»¥çœ‹è¿™é‡Œ Related Posts: FFTç”¨åˆ°çš„å„ç§ç´ æ•° å¤šé¡¹å¼æ±‚é€†å…ƒ å¤šé¡¹å¼çš„å¤šç‚¹æ±‚å€¼ä¸å¿«é€Ÿæ’å€¼ ç‰›é¡¿è¿­ä»£æ³•åœ¨å¤šé¡¹å¼è¿ç®—çš„åº”ç”¨ ç‰¹æ®Šå¤šé¡¹å¼åœ¨æ•´ç‚¹ä¸Šçš„çº¿æ€§æ’å€¼æ–¹æ³• Karatsuba ä¹˜æ³•","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€ç®—æ³•ã€‘å¤§æ•°ä¹˜æ³•é—®é¢˜åŠå…¶é«˜æ•ˆç®—æ³•","slug":"ã€ç®—æ³•ã€‘å¤§æ•°ç›¸ä¹˜é—®é¢˜åŠå…¶é«˜æ•ˆç®—æ³•","date":"2017-08-22T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/08/22/ã€ç®—æ³•ã€‘å¤§æ•°ç›¸ä¹˜é—®é¢˜åŠå…¶é«˜æ•ˆç®—æ³•/","link":"","permalink":"http://github.com/2017/08/22/ã€ç®—æ³•ã€‘å¤§æ•°ç›¸ä¹˜é—®é¢˜åŠå…¶é«˜æ•ˆç®—æ³•/","excerpt":"é¢˜ç›®ç¼–å†™ä¸¤ä¸ªä»»æ„ä½æ•°çš„å¤§æ•°ç›¸ä¹˜çš„ç¨‹åºï¼Œç»™å‡ºè®¡ç®—ç»“æœã€‚æ¯”å¦‚ï¼š é¢˜ç›®æè¿°ï¼š è¾“å‡ºä¸¤ä¸ªä¸è¶…è¿‡100ä½çš„å¤§æ•´æ•°çš„ä¹˜ç§¯ã€‚è¾“å…¥ï¼š è¾“å…¥ä¸¤ä¸ªå¤§æ•´æ•°ï¼Œå¦‚1234567 å’Œ 123è¾“å‡ºï¼š è¾“å‡ºä¹˜ç§¯ï¼Œå¦‚ï¼š151851741 æˆ–è€… 1æ±‚ 1234567891011121314151617181920 * 2019181716151413121110987654321 çš„ä¹˜ç§¯ç»“æœ åˆ†ææ‰€è°“å¤§æ•°ç›¸ä¹˜ï¼ˆMultiplication algorithmï¼‰ï¼Œå°±æ˜¯æŒ‡æ•°å­—æ¯”è¾ƒå¤§ï¼Œç›¸ä¹˜çš„ç»“æœè¶…å‡ºäº†åŸºæœ¬ç±»å‹çš„è¡¨ç¤ºèŒƒå›´ï¼Œæ‰€ä»¥è¿™æ ·çš„æ•°ä¸èƒ½å¤Ÿç›´æ¥åšä¹˜æ³•è¿ç®—ã€‚ å‚è€ƒäº†å¾ˆå¤šèµ„æ–™ï¼ŒåŒ…æ‹¬ç»´åŸºç™¾ç§‘è¯æ¡Multiplication algorithmï¼Œæ‰çŸ¥é“ç›®å‰å¤§æ•°ä¹˜æ³•ç®—æ³•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ€è·¯ï¼š æ¨¡æ‹Ÿå°å­¦ä¹˜æ³•ï¼šæœ€ç®€å•çš„ä¹˜æ³•ç«–å¼æ‰‹ç®—çš„ç´¯åŠ å‹ï¼› åˆ†æ²»ä¹˜æ³•ï¼šæœ€ç®€å•çš„æ˜¯Karatsubaä¹˜æ³•ï¼Œä¸€èˆ¬åŒ–ä»¥åæœ‰Toom-Cookä¹˜æ³•ï¼› å¿«é€Ÿå‚…é‡Œå¶å˜æ¢FFTï¼šï¼ˆä¸ºäº†é¿å…ç²¾åº¦é—®é¢˜ï¼Œå¯ä»¥æ”¹ç”¨å¿«é€Ÿæ•°è®ºå˜æ¢FNTTï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦O(N lgN lglgN)ã€‚å…·ä½“å¯å‚ç…§SchÃ¶nhageâ€“Strassen algorithmï¼› ä¸­å›½å‰©ä½™å®šç†ï¼šæŠŠæ¯ä¸ªæ•°åˆ†è§£åˆ°ä¸€äº›äº’ç´ çš„æ¨¡ä¸Šï¼Œç„¶åæ¯ä¸ªåŒä½™æ–¹ç¨‹å¯¹åº”ä¹˜èµ·æ¥å°±è¡Œï¼› Furerâ€™s algorithmï¼šåœ¨æ¸è¿›æ„ä¹‰ä¸ŠFNTTè¿˜å¿«çš„ç®—æ³•ã€‚ä¸è¿‡å¥½åƒä¸å¤ªå®ç”¨ï¼Œæœ¬æ–‡å°±ä¸ä½œä»‹ç»äº†ã€‚å¤§å®¶å¯ä»¥å‚è€ƒç»´åŸºç™¾ç§‘FÃ¼rerâ€™s algorithm","text":"é¢˜ç›®ç¼–å†™ä¸¤ä¸ªä»»æ„ä½æ•°çš„å¤§æ•°ç›¸ä¹˜çš„ç¨‹åºï¼Œç»™å‡ºè®¡ç®—ç»“æœã€‚æ¯”å¦‚ï¼š é¢˜ç›®æè¿°ï¼š è¾“å‡ºä¸¤ä¸ªä¸è¶…è¿‡100ä½çš„å¤§æ•´æ•°çš„ä¹˜ç§¯ã€‚è¾“å…¥ï¼š è¾“å…¥ä¸¤ä¸ªå¤§æ•´æ•°ï¼Œå¦‚1234567 å’Œ 123è¾“å‡ºï¼š è¾“å‡ºä¹˜ç§¯ï¼Œå¦‚ï¼š151851741 æˆ–è€… 1æ±‚ 1234567891011121314151617181920 * 2019181716151413121110987654321 çš„ä¹˜ç§¯ç»“æœ åˆ†ææ‰€è°“å¤§æ•°ç›¸ä¹˜ï¼ˆMultiplication algorithmï¼‰ï¼Œå°±æ˜¯æŒ‡æ•°å­—æ¯”è¾ƒå¤§ï¼Œç›¸ä¹˜çš„ç»“æœè¶…å‡ºäº†åŸºæœ¬ç±»å‹çš„è¡¨ç¤ºèŒƒå›´ï¼Œæ‰€ä»¥è¿™æ ·çš„æ•°ä¸èƒ½å¤Ÿç›´æ¥åšä¹˜æ³•è¿ç®—ã€‚ å‚è€ƒäº†å¾ˆå¤šèµ„æ–™ï¼ŒåŒ…æ‹¬ç»´åŸºç™¾ç§‘è¯æ¡Multiplication algorithmï¼Œæ‰çŸ¥é“ç›®å‰å¤§æ•°ä¹˜æ³•ç®—æ³•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ€è·¯ï¼š æ¨¡æ‹Ÿå°å­¦ä¹˜æ³•ï¼šæœ€ç®€å•çš„ä¹˜æ³•ç«–å¼æ‰‹ç®—çš„ç´¯åŠ å‹ï¼› åˆ†æ²»ä¹˜æ³•ï¼šæœ€ç®€å•çš„æ˜¯Karatsubaä¹˜æ³•ï¼Œä¸€èˆ¬åŒ–ä»¥åæœ‰Toom-Cookä¹˜æ³•ï¼› å¿«é€Ÿå‚…é‡Œå¶å˜æ¢FFTï¼šï¼ˆä¸ºäº†é¿å…ç²¾åº¦é—®é¢˜ï¼Œå¯ä»¥æ”¹ç”¨å¿«é€Ÿæ•°è®ºå˜æ¢FNTTï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦O(N lgN lglgN)ã€‚å…·ä½“å¯å‚ç…§SchÃ¶nhageâ€“Strassen algorithmï¼› ä¸­å›½å‰©ä½™å®šç†ï¼šæŠŠæ¯ä¸ªæ•°åˆ†è§£åˆ°ä¸€äº›äº’ç´ çš„æ¨¡ä¸Šï¼Œç„¶åæ¯ä¸ªåŒä½™æ–¹ç¨‹å¯¹åº”ä¹˜èµ·æ¥å°±è¡Œï¼› Furerâ€™s algorithmï¼šåœ¨æ¸è¿›æ„ä¹‰ä¸ŠFNTTè¿˜å¿«çš„ç®—æ³•ã€‚ä¸è¿‡å¥½åƒä¸å¤ªå®ç”¨ï¼Œæœ¬æ–‡å°±ä¸ä½œä»‹ç»äº†ã€‚å¤§å®¶å¯ä»¥å‚è€ƒç»´åŸºç™¾ç§‘FÃ¼rerâ€™s algorithm è§£æ³•æˆ‘ä»¬åˆ†åˆ«å®ç°ä¸€ä¸‹ä»¥ä¸Šç®—æ³•ï¼Œæ—¢ç„¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ä¹˜æ³•åšè¿ç®—ï¼Œæœ€ç®€å•æœ€å®¹æ˜“æƒ³åˆ°çš„åŠæ³•å°±æ˜¯æ¨¡æ‹Ÿä¹˜æ³•è¿ç®—ã€‚ 1ã€æ¨¡æ‹Ÿä¹˜æ³•æ‰‹ç®—ç´¯åŠ 12345678 7 8 9 6 5 2Ã— 3 2 1 1----------------- 7 8 9 6 5 2 &lt;---- ç¬¬1è¶Ÿ 7 8 9 6 5 2 &lt;---- ç¬¬2è¶Ÿ .......... &lt;---- ç¬¬nè¶Ÿ ----------------- ? ? ? ? ? ? ? ? &lt;---- æœ€åçš„å€¼ç”¨å¦ä¸€ä¸ªæ•°ç»„è¡¨ç¤º å¦‚ä¸Šæ‰€ç¤ºï¼Œä¹˜æ³•è¿ç®—å¯ä»¥åˆ†æ‹†ä¸ºä¸¤æ­¥ï¼š ç¬¬ä¸€æ­¥ï¼Œæ˜¯å°†ä¹˜æ•°ä¸è¢«ä¹˜æ•°é€ä½ç›¸ä¹˜ï¼› ç¬¬äºŒæ­¥ï¼Œå°†é€ä½ç›¸ä¹˜å¾—åˆ°çš„ç»“æœï¼Œå¯¹åº”ç›¸åŠ èµ·æ¥ã€‚ è¿™æœ‰ç‚¹ç±»ä¼¼å°å­¦æ•°å­¦ä¸­ï¼Œè®¡ç®—ä¹˜æ³•æ—¶é€šå¸¸é‡‡ç”¨çš„â€œç«–å¼è¿ç®—â€ã€‚ç”¨Javaç®€å•å®ç°äº†è¿™ä¸ªç®—æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/** * å¤§æ•°ç›¸ä¹˜ - æ¨¡æ‹Ÿä¹˜æ³•æ‰‹ç®—ç´¯åŠ  */public static Integer[] bigNumberMultiply(int[] arr1ï¼Œ int[] arr2)&#123; ArrayList&lt;Integer&gt; result = new ArrayList&lt;&gt;(); //ä¸­é—´æ±‚å’Œçš„ç»“æœ //arr2 é€ä½ä¸arr1ç›¸ä¹˜ for(int i = arr2.length - 1; i &gt;= 0; i--)&#123; int carry = 0; ArrayList&lt;Integer&gt; singleList = new ArrayList&lt;&gt;(); //arr2 é€ä½å•æ¬¡ä¹˜æ³•çš„ç»“æœ for(int j = arr1.length - 1; j &gt;= 0; j--)&#123; int r = arr2[i] * arr1[j] + carry; int digit = r % 10; carry = r / 10; singleList.add(digit); &#125; if(carry != 0)&#123; singleList.add(carry); &#125; int resultCarry = 0, count = 0; int k = 0; int l = 0; int offset = arr2.length - 1 - i; //åŠ æ³•çš„åç§»ä½ ArrayList&lt;Integer&gt; middleResult = new ArrayList&lt;&gt;(); //arr2æ¯ä½ä¹˜æ³•çš„ç»“æœä¸ä¸Šä¸€è½®çš„æ±‚å’Œç»“æœç›¸åŠ ï¼Œä»å³å‘å·¦åšåŠ æ³•å¹¶è¿›ä½ while (k &lt; singleList.size() || l &lt; result.size()) &#123; int kv = 0, lv = 0; if (k &lt; singleList.size() &amp;&amp; count &gt;= offset) &#123; kv = singleList.get(k++); &#125; if (l &lt; result.size()) &#123; lv = result.get(l++); &#125; int sum = resultCarry + kv + lv; middleResult.add(sum % 10); //ç›¸åŠ ç»“æœä»å³å‘å·¦ï¼ˆé«˜ä½åˆ°ä½ä½ï¼‰æš‚æ—¶å­˜å‚¨ï¼Œæœ€åéœ€è¦é€†å‘è¾“å‡º resultCarry = sum / 10; count++; &#125; if(resultCarry != 0)&#123; middleResult.add(resultCarry); &#125; result.clear(); result = middleResult; &#125; Collections.reverse(result); //é€†å‘è¾“å‡ºç»“æœ return result.toArray(new Integer[result.size()]);&#125; çœ‹äº†ä»¥ä¸Šçš„ä»£ç ï¼Œæ„Ÿè§‰æ€è·¯è™½ç„¶å¾ˆç®€å•ï¼Œä½†æ˜¯å®ç°èµ·æ¥å´å¾ˆéº»çƒ¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰æ²¡æœ‰åˆ«çš„æ–¹æ³•æ¥å®ç°è¿™ä¸ªç¨‹åºå‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œæ¥ä¸‹æ¥æˆ‘æ¥ä»‹ç»ç¬¬äºŒç§æ–¹æ³•ã€‚ 2ã€æ¨¡æ‹Ÿä¹˜æ³•ç´¯åŠ  - æ”¹è¿›ç®€å•æ¥è¯´ï¼Œæ–¹æ³•äºŒå°±æ˜¯å…ˆä¸ç®—ä»»ä½•çš„è¿›ä½ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå°†æ¯ä¸€ä½ç›¸ä¹˜ï¼Œç›¸åŠ çš„ç»“æœä¿å­˜åˆ°åŒä¸€ä¸ªä½ç½®ï¼Œåˆ°æœ€åæ‰è®¡ç®—è¿›ä½ã€‚ ä¾‹å¦‚ï¼šè®¡ç®—98Ã—21,æ­¥éª¤å¦‚ä¸‹ 1234567 9 8Ã— 2 1------------- (9)(8) &lt;---- ç¬¬1è¶Ÿ: 98Ã—1çš„æ¯ä¸€ä½ç»“æœ (18)(16) &lt;---- ç¬¬2è¶Ÿ: 98Ã—2çš„æ¯ä¸€ä½ç»“æœ ------------- (18)(25)(8) &lt;---- è¿™é‡Œå°±æ˜¯ç›¸å¯¹ä½çš„å’Œï¼Œè¿˜æ²¡æœ‰ç´¯åŠ è¿›ä½ è¿™é‡Œå”¯ä¸€è¦æ³¨æ„çš„ä¾¿æ˜¯è¿›ä½é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä¸è€ƒè™‘è¿›ä½ï¼Œå½“æ‰€æœ‰ä½å¯¹åº”ç›¸åŠ ï¼Œäº§ç”Ÿç»“æœä¹‹åï¼Œå†è€ƒè™‘ã€‚ä»å³å‘å·¦ä¾æ¬¡ç´¯åŠ ï¼Œå¦‚æœè¯¥ä½çš„æ•°å­—å¤§äº10ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”¨å–ä½™è¿ç®—ï¼Œåœ¨è¯¥ä½ä¸Šåªä¿ç•™å–ä½™åçš„ä¸ªä½æ•°ï¼Œè€Œå°†åä½æ•°è¿›ä½ï¼ˆé€šè¿‡æ¨¡è¿ç®—å¾—åˆ°ï¼‰ç´¯åŠ åˆ°é«˜ä½ä¾¿å¯ï¼Œå¾ªç¯ç›´åˆ°ç´¯åŠ å®Œæ¯•ã€‚ æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223/** * å¤§æ•°ç›¸ä¹˜æ–¹æ³•äºŒ */public static int[] bigNumberMultiply2(int[] num1, int[] num2)&#123; // åˆ†é…ä¸€ä¸ªç©ºé—´ï¼Œç”¨æ¥å­˜å‚¨è¿ç®—çš„ç»“æœï¼Œnum1é•¿çš„æ•° * num2é•¿çš„æ•°ï¼Œç»“æœä¸ä¼šè¶…è¿‡num1+num2é•¿ int[] result = new int[num1.length + num2.length]; // å…ˆä¸è€ƒè™‘è¿›ä½é—®é¢˜ï¼Œæ ¹æ®ç«–å¼çš„ä¹˜æ³•è¿ç®—ï¼Œnum1çš„ç¬¬iä½ä¸num2çš„ç¬¬jä½ç›¸ä¹˜ï¼Œç»“æœåº”è¯¥å­˜æ”¾åœ¨ç»“æœçš„ç¬¬i+jä½ä¸Š for (int i = 0; i &lt; num1.length; i++)&#123; for (int j = 0; j &lt; num2.length; j++)&#123; result[i + j + 1] += num1[i] * num2[j]; // (å› ä¸ºè¿›ä½çš„é—®é¢˜ï¼Œæœ€ç»ˆæ”¾ç½®åˆ°ç¬¬i+j+1ä½) &#125; &#125; //å•ç‹¬å¤„ç†è¿›ä½ for(int k = result.length-1; k &gt; 0; k--)&#123; if(result[k] &gt; 10)&#123; result[k - 1] += result[k] / 10; result[k] %= 10; &#125; &#125; return result;&#125; ï¼ï¼æ³¨æ„ï¼šè¿™é‡Œçš„è¿›ä½æœ‰ä¸ªå¤§å‘ï¼Œå› ä¸ºresult[]æ•°ç»„æ˜¯ä»å·¦åˆ°å³è®°å½•ç›¸å¯¹ä½çš„å’Œï¼ˆè¿˜æ²¡æœ‰è¿›ä½ï¼‰ï¼Œè€Œæœ€åçš„è¿›ä½æ˜¯ä»å³å‘å·¦ç´¯åŠ è¿›ä½ï¼Œè¿™æ ·çš„è¯ï¼Œå¦‚æœæœ€é«˜ä½ï¼Œä¹Ÿå°±æ˜¯æœ€å·¦ä¾§é‚£ä¸€ä½çš„ç´¯åŠ ç»“æœéœ€è¦è¿›ä½çš„è¯ï¼Œresult[]æ•°ç»„å°±æ²¡æœ‰ç©ºé—´å­˜æ”¾äº†ã€‚ è€Œæ­£å¥½result[]æ•°ç»„çš„æœ€åä¸€ä½ç©ºç½®ï¼Œä¸å¯èƒ½è¢«å ç”¨ï¼Œæˆ‘ä»¬å°±å“åº”åœ°æŠŠnum1çš„ç¬¬iä½ä¸num2çš„ç¬¬jä½ç›¸ä¹˜ï¼Œç»“æœåº”è¯¥å­˜æ”¾åœ¨ç»“æœçš„ç¬¬i+jä½ä¸Šçš„è¿™ä¸ªç»“æœå¾€åé¡ºç§»ä¸€ä½ï¼ˆæ”¾åˆ°ç¬¬i+j+1ä½ï¼‰ï¼Œæœ€åä»å³å‘å·¦ç´¯åŠ æ—¶å°±å¤šäº†ä¸€ä¸ªç©ºé—´ã€‚ 3ã€åˆ†æ²» - Karatsubaç®—æ³•ä»¥ä¸Šä¸¤ç§æ¨¡æ‹Ÿä¹˜æ³•çš„æ‰‹ç®—ç´¯åŠ å‹ç®—æ³•ï¼Œä»–ä»¬éƒ½æ˜¯æ¨¡æ‹Ÿæ™®é€šä¹˜æ³•çš„è®¡ç®—æ–¹å¼ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(n^2)ï¼Œè€Œè¿™ä¸ªKaratsubaç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä»…æœ‰ $O(n^{\\log _{2}3})$ ã€‚ä¸‹é¢ï¼Œæˆ‘å°±æ¥ä»‹ç»ä¸€ä¸‹è¿™ä¸ªç®—æ³•ã€‚ Karatsubaäº1960å¹´å‘æ˜åœ¨ $O(n^{\\log _{2}3})$ æ­¥éª¤å†…å°†ä¸¤ä¸ªnä½æ•°ç›¸ä¹˜çš„Karatsubaç®—æ³•ã€‚å®ƒåè¯äº†å®‰å¾·é›·Â·æŸ¯å°”è«å“¥æ´›å¤«äº1956å¹´è®¤ä¸ºè¿™ä¸ªä¹˜æ³•éœ€è¦ $ \\Omega (n^{2})$ æ­¥éª¤çš„çŒœæƒ³ã€‚ é¦–å…ˆæ¥çœ‹çœ‹è¿™ä¸ªç®—æ³•æ˜¯æ€ä¹ˆè¿›è¡Œè®¡ç®—çš„ï¼Œè§ä¸‹å›¾ï¼š å›¾ä¸­æ˜¾ç¤ºäº†è®¡ç®—5678 * 1234çš„è¿‡ç¨‹ï¼Œé¦–å…ˆæ˜¯æ‹†åˆ†æˆabcdå››ä¸ªéƒ¨åˆ†ï¼Œç„¶ååˆ†åˆ«è®¡ç®—ac, bd, (a+b)*(c+d)ï¼Œæœ€åå†ç”¨ç¬¬ä¸‰ä¸ªç®—å¼çš„ç»“æœå‡å»å‰é¢ä¸¤ä¸ªï¼ˆå…¶å®å¾—åˆ°çš„å°±æ˜¯bc+adï¼Œä½†æ˜¯å‡å°‘äº†ä¹˜æ³•æ­¥éª¤ï¼‰ï¼Œç„¶åï¼Œè®¡ç®—å¼1åé¢åŠ 4ä¸ª0ï¼Œè®¡ç®—å¼2åé¢ä¸åŠ ï¼Œè®¡ç®—å¼3åé¢åŠ 2ä¸ª0ï¼Œå†æŠŠè¿™ä¸‰è€…ç›¸åŠ ï¼Œå°±æ˜¯æ­£ç¡®ç»“æœã€‚ æ¥ä¸‹æ¥ï¼Œå°±æ¥è¯æ˜ä¸€ä¸‹è¿™ä¸ªç®—æ³•çš„æ­£ç¡®æ€§ã€‚è¿™æ˜¯ä¸€å¹…æ¥è‡ªKaratsuba Multiplication Algorithm â€“ Python Codeçš„å›¾ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ï¼š æˆ‘ä»¬å‡è®¾è¦ç›¸ä¹˜çš„ä¸¤ä¸ªæ•°æ˜¯x * yã€‚æˆ‘ä»¬å¯ä»¥æŠŠxï¼Œyå†™æˆï¼š $$ x = a * 10^{n/2} + b $$ $$ y = c * 10^{n/2} + d $$ è¿™é‡Œçš„næ˜¯æ•°å­—çš„ä½æ•°ã€‚å¦‚æœæ˜¯å¶æ•°ï¼Œåˆ™aå’Œbéƒ½æ˜¯n/2ä½çš„ã€‚å¦‚æœnæ˜¯å¥‡æ•°ï¼Œåˆ™ä½ å¯ä»¥è®©aæ˜¯n/2+1ä½ï¼Œbæ˜¯n/2ä½ã€‚ï¼ˆä¾‹å¦‚a = 12ï¼Œb = 34ï¼›a = 123ï¼Œb = 45ï¼‰ï¼Œé‚£ä¹ˆx*yå°±å¯ä»¥æ¢ç®—ä¸ºï¼š $$ \\begin{eqnarray*} &&x * y\\\\ &=&(a * 10^{n/2}+b) * (c * 10^{n/2}+d)\\\\ &=&ac * 10^n + (ad + bc) * 10^{n/2} + bd\\\\ &=&ac * 10^n + [(a+b)*(c+d)-ac-bd] * 10^{n/2} + bd \\end{eqnarray*} $$ æ³¨æ„æœ€åä¸€æ­¥ï¼Œè¿™ä¸ªå¼å­å€’æ•°ç¬¬äºŒæ­¥ä¸­çš„(ad + bc)ï¼Œæ²¡å¿…è¦å¦å¤–è¿›è¡Œä¸¤æ¬¡ä¹˜æ³•ï¼Œå¯ä»¥ä½¿ç”¨((a+b)*(c+d) - ac - bd)æ¥é‡å¤åˆ©ç”¨å‰é¢çš„ä¸¤æ¬¡ä¹˜ç§¯ç»“æœacå’Œbdã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å‘ç°æœ€ç»ˆåªéœ€è¦è®¡ç®—ä¸‰æ¬¡ä¹˜æ³• a*cï¼Œ b*dï¼Œ (a+b)*(c+d) ä»¥åŠå…­æ¬¡åŠ æ³•ã€‚å› æ­¤è¿™æ ·å¤æ‚åº¦å°±å˜ä¸º $$ T(n) = 3T(\\frac{n}{2}) + 6n = O(n^{\\log_23}) $$ å¯¹æ¯”ä¹‹å‰çš„è®¡ç®—è¿‡ç¨‹ï¼Œç»“æœå·²ç»å‘¼ä¹‹æ¬²å‡ºäº†ã€‚è¿™é‡Œå”¯ä¸€éœ€è¦æ³¨æ„çš„ä¸¤ç‚¹å°±æ˜¯ï¼š (a*d + b*c)çš„è®¡ç®—ä¸ºäº†é˜²æ­¢ä¸¤æ¬¡ä¹˜æ³•ï¼Œåº”è¯¥ä½¿ç”¨ä¹‹å‰çš„è®¡ç®—ä¹Ÿå°±æ˜¯ç¬¬ä¸€å¹…å›¾ç¬¬å››æ­¥çš„â‘¢-â‘¡-â‘  è¿™äº›ä¹˜æ³•åœ¨ç®—æ³•é‡Œåº”è¯¥æ˜¯é€’å½’å®ç°çš„ï¼Œæ•°å­—å¾ˆå¤§æ—¶ï¼Œå…ˆæ‹†åˆ†ï¼Œç„¶åæ‹†åˆ†å‡ºæ¥çš„æ•°å­—è¿˜æ˜¯å¾ˆå¤§çš„è¯ï¼Œå°±ç»§ç»­æ‹†åˆ†ï¼Œç›´åˆ°a * bå·²ç»æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å°é—®é¢˜ä¸ºä¹‹ã€‚è¿™ä¹Ÿæ˜¯åˆ†æ²»çš„æ€æƒ³ã€‚ æˆ‘ä»¬ä¸¾ä¾‹æ¥å°è¯•ä¸€ä¸‹è¿™ç§ç®—æ³•ï¼Œæ¯”å¦‚è®¡ç®—12345 * 6789ï¼Œæˆ‘ä»¬è®©a = 12ï¼Œb = 345ã€‚åŒæ—¶c = 6ï¼Œd = 789ã€‚ä¹Ÿå°±æ˜¯ï¼š $$ 12345 = 12 Â· 1000 + 345\\\\ 6789 = 6 Â· 1000 + 789 $$ é‚£ä¹ˆa*cï¼Œb*dçš„ç»“æœå¦‚ä¸‹ï¼š $$ \\begin{align*} z_2 &= a*c = 12 Ã— 6 = 72\\\\ z_0 &= b*d = 345 Ã— 789 = 272205 \\\\ z_1 &= ((a+b)*(c+d) - a*c - b*d)\\\\ &= (12 + 345) Ã— (6 + 789) âˆ’ z_2 âˆ’ z_0 = 283815 âˆ’ 72 âˆ’ 272205 = 11538 \\end{align*} $$ æœ€ç»ˆç»“æœå°±æ˜¯ï¼š $$ \\begin{align*} & result = z_2 Â· 10^{2*3} + z_1 Â· 10^3 + z_0 \\\\ & result = 72 Â· 10^6 + 11538 Â· 10^3 + 272205 = 83810205. \\\\ \\end{align*} $$ ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨åˆ†æ²»çš„æ–¹å¼è®¡ç®—ä¹˜æ³•çš„åŸç†ã€‚ä¸Šé¢è¿™ä¸ªç®—æ³•ï¼Œç”± Anatolii Alexeevitch Karatsuba äº1960å¹´æå‡ºå¹¶äº1962å¹´å‘è¡¨ï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°ä¸º Karatsuba ä¹˜æ³•ã€‚ æ ¹æ®ä¸Šé¢çš„æ€è·¯ï¼Œå®ç°çš„Karatsubaä¹˜æ³•ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425/** * Karatsubaä¹˜æ³• */public static long karatsuba(long num1, long num2)&#123; //é€’å½’ç»ˆæ­¢æ¡ä»¶ if(num1 &lt; 10 || num2 &lt; 10) return num1 * num2; // è®¡ç®—æ‹†åˆ†é•¿åº¦ int size1 = String.valueOf(num1).length(); int size2 = String.valueOf(num2).length(); int halfN = Math.max(size1, size2) / 2; /* æ‹†åˆ†ä¸ºa, b, c, d */ long a = Long.valueOf(String.valueOf(num1).substring(0, size1 - halfN)); long b = Long.valueOf(String.valueOf(num1).substring(size1 - halfN)); long c = Long.valueOf(String.valueOf(num2).substring(0, size2 - halfN)); long d = Long.valueOf(String.valueOf(num2).substring(size2 - halfN)); // è®¡ç®—z2, z0, z1, æ­¤å¤„çš„ä¹˜æ³•ä½¿ç”¨é€’å½’ long z2 = karatsuba(a, c); long z0 = karatsuba(b, d); long z1 = karatsuba((a + b), (c + d)) - z0 - z2; return (long)(z2 * Math.pow(10, (2*halfN)) + z1 * Math.pow(10, halfN) + z0);&#125; æ€»ç»“ï¼š Karatsuba ç®—æ³•æ˜¯æ¯”è¾ƒç®€å•çš„é€’å½’ä¹˜æ³•ï¼ŒæŠŠè¾“å…¥æ‹†åˆ†æˆ 2 éƒ¨åˆ†ï¼Œä¸è¿‡å¯¹äºæ›´å¤§çš„æ•°ï¼Œå¯ä»¥æŠŠè¾“å…¥æ‹†åˆ†æˆ 3 éƒ¨åˆ†ç”šè‡³ 4 éƒ¨åˆ†ã€‚æ‹†åˆ†ä¸º 3 éƒ¨åˆ†æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„Toom-Cook 3-way ä¹˜æ³•ï¼Œå¤æ‚åº¦é™ä½åˆ° O(n^1.465)ã€‚æ‹†åˆ†ä¸º 4 éƒ¨åˆ†æ—¶ï¼Œä½¿ç”¨Toom-Cook 4-way ä¹˜æ³•ï¼Œå¤æ‚åº¦è¿›ä¸€æ­¥ä¸‹é™åˆ° O(n^1.404)ã€‚å¯¹äºæ›´å¤§çš„æ•°å­—ï¼Œå¯ä»¥æ‹†æˆ 100 æ®µï¼Œä½¿ç”¨å¿«é€Ÿå‚…é‡Œå¶å˜æ¢FFTï¼Œå¤æ‚åº¦æ¥è¿‘çº¿æ€§ï¼Œå¤§çº¦æ˜¯ O(n^1.149)ã€‚å¯ä»¥çœ‹å‡ºï¼Œåˆ†å‰²è¶Šå¤§ï¼Œæ—¶é—´å¤æ‚åº¦å°±è¶Šä½ï¼Œä½†æ˜¯æ‰€è¦è®¡ç®—çš„ä¸­é—´é¡¹ä»¥åŠåˆå¹¶æœ€ç»ˆç»“æœçš„è¿‡ç¨‹å°±ä¼šè¶Šå¤æ‚ï¼Œå¼€é”€ä¼šå¢åŠ ï¼Œå› æ­¤åˆ†å‰²ç‚¹ä¸Šå‡ï¼Œå¯¹äºå…¬é’¥åŠ å¯†ï¼Œæš‚æ—¶ç”¨ä¸åˆ°å¤ªå¤§çš„æ•´æ•°ï¼Œæ‰€ä»¥ä½¿ç”¨ Karatsuba å°±åˆé€‚äº†ï¼Œä¸ç”¨å†å»å¼„æ›´å¤æ‚çš„é€’å½’ä¹˜æ³•ã€‚ æµ‹è¯•ç¨‹åº123456789101112131415161718192021222324252627282930313233public class LeetcodeTest &#123; public static void main(String[] args) &#123;// String a = \"1234567891011121314151617181920\";// String b = \"2019181716151413121110987654321\";// String a = \"999999999999\";// String b = \"999999999999\";// String a = \"24566\";// String b = \"452053\"; String a = \"98\"; String b = \"21\"; char[] charArr1 = a.trim().toCharArray(); char[] charArr2 = b.trim().toCharArray(); // å­—ç¬¦æ•°ç»„è½¬æ¢ä¸ºint[]æ•°ç»„ int[] arr1 = new int[charArr1.length]; int[] arr2 = new int[charArr2.length]; for(int i = 0; i &lt; charArr1.length; i++)&#123; arr1[i] = charArr1[i] - '0'; &#125; for(int i = 0; i &lt; charArr2.length; i++)&#123; arr2[i] = charArr2[i] - '0'; &#125; // å¼€å§‹è®¡ç®— int[] result = LeetcodeTest.bigNumberMultiply2(arr1, arr2); System.out.println(a + \" * \" + b + \" = \" + Arrays.toString(result).replace(\", \", \"\")); &#125;&#125; æœ€åï¼Œæ˜¯æµ‹è¯•ç”¨ä¾‹è¾“å‡ºç»“æœï¼š 12345671234567891011121314151617181920 * 2019181716151413121110987654321 = [02492816912877266687794240983772975935013386905490061131076320]999999999999 * 999999999999 = [999999999998000000000001]24566 * 452053 = [11105133998]98 * 21 = [2058] Javaä¸­BigIntegerçš„ä¹˜æ³•å®ç°ç›®å‰æœ€è‘—åçš„é«˜ç²¾åº¦æ•´æ•°è¿ç®—åº“æ˜¯GNUçš„GMPï¼ŒGMPæ˜¯The GNU MP Bignum Libraryï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„æ•°å­¦è¿ç®—åº“ï¼Œå®ƒå¯ä»¥ç”¨äºä»»æ„ç²¾åº¦çš„æ•°å­¦è¿ç®—ï¼ŒåŒ…æ‹¬æœ‰ç¬¦å·æ•´æ•°ã€æœ‰ç†æ•°å’Œæµ®ç‚¹æ•°ã€‚å®ƒæœ¬èº«å¹¶æ²¡æœ‰ç²¾åº¦é™åˆ¶ï¼Œåªå–å†³äºæœºå™¨çš„ç¡¬ä»¶æƒ…å†µã€‚è®¸å¤šè‘—åçš„è®¡ç®—æœºä»£æ•°ç³»ç»Ÿå¦‚Axiom, Maple, Mathematica, Maximaç­‰çš„åº•å±‚é«˜ç²¾åº¦æ•´æ•°è¿ç®—éƒ½æ˜¯åŸºäºGMPå®ç°çš„ã€‚ è®¾n ä¸ºä¹˜æ•°çš„ä½æ•°, å°±ç›®å‰å·²çŸ¥çš„æƒ…å†µè€Œè¨€, ä¸åŒä¹˜æ³•ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å¯ä»¥ä»å¹³å‡¡çš„$O(n^2)$(æ™®é€šä¹˜æ³•), $O(n^{log_2 3})$(Karatsuba ä¹˜æ³•)ï¼Œ $O(n^{log_3 5})$ (Toom-3 ä¹˜æ³•)ï¼Œ$O(n {\\log^* n})$ (å¤æ•°åŸŸä¸Šçš„FFT)ï¼Œå…¶ä¸­ $$ log^* n = log n(log log n)(log log log n) Â·Â·Â· , $$ å’Œ$O(n(log n)(log log n))$(æœ‰é™åŸŸä¸Šçš„FFT), å…¶ä¸­â€œæœ‰é™åŸŸä¸Šçš„FFTâ€çš„æ—¶é—´å¤æ‚åº¦å·²ç»ç›¸å½“æ¥è¿‘çº¿æ€§äº†ã€‚ ä½†æ˜¯è¿™äº›ä¹˜æ³•ç®—æ³•ä¸­å¤æ‚åº¦è¾ƒä½çš„ç®—æ³•å¾€å¾€æœ‰è¾ƒå¤§çš„å¸¸æ•°å› å­, å› æ­¤å¦‚æœä¹˜æ•°çš„ä½æ•°è¾ƒå°‘,æ™®é€šä¹˜æ³•åè€Œæ˜¯æœ€å¿«çš„, æ‰€ä»¥å®ç”¨ä¸­å¸¸å¸¸å°†è¿™äº›ä¸åŒçš„ä¹˜æ³•ç®—æ³•ç»“åˆèµ·æ¥ä½¿ç”¨, æ¯æ¬¡åšä¹˜æ³•æ—¶éƒ½æ ¹æ®ç›¸ä¹˜ä¸¤æ•°çš„å¤§å°åŠ¨æ€åœ°é€‰æ‹©å…·ä½“é‡‡ç”¨å“ªä¸€ç§ç®—æ³•, è€Œæ¯ç§ç®—æ³•çš„æœ€ä½³é€‚ç”¨èŒƒå›´å¾€å¾€ä¾èµ–äºå…·ä½“å®ç°å’Œç¡¬ä»¶ç¯å¢ƒ, å› æ­¤ä¸€èˆ¬ç›´æ¥é€šè¿‡å®éªŒæ¥ç¡®å®šã€‚ Javaä¸­çš„å®ç° åœ¨ Java 7 é‡Œé¢ï¼Œå°±æ˜¯ç”¨äºŒé‡å¾ªç¯ç›´æ¥ä¹˜çš„ã€‚æºä»£ç ï¼š[BigInteger - Java7] ï¼ˆè§1165è¡Œï¼‰ åœ¨ Java 8 é‡Œé¢ï¼Œæ ¹æ®ä¸¤ä¸ªå› æ•°çš„å¤§å°ï¼Œæœ‰ä¸‰ç§ä¹˜æ³•ã€‚æºä»£ç ï¼š[BigInteger - Java8] ï¼ˆè§1464è¡Œï¼‰ï¼š å½“ä¸¤ä¸ªå› æ•°å‡å°äº $2^{32\\times 80}$ æ—¶ï¼Œç”¨äºŒé‡å¾ªç¯ç›´æ¥ç›¸ä¹˜ï¼Œå¤æ‚åº¦ä¸º$O(n^2) $ï¼Œnä¸ºå› æ•°ä½æ•°ï¼ˆä¸‹åŒï¼‰ï¼› å¦åˆ™ï¼Œå½“ä¸¤ä¸ªå› æ•°å‡å°äº$2^{32\\times 240} $æ—¶ï¼Œé‡‡ç”¨ Karatsuba algorithmï¼Œå…¶å¤æ‚åº¦ä¸º$O(n^{\\log_2 3}) \\approx O(n^{1.585})$ï¼› å¦åˆ™ï¼Œé‡‡ç”¨ Toom-Cook multiplicationï¼Œå…¶å¤æ‚åº¦ä¸º$O(n^{\\log_3 5}) \\approx O(n^{1.465})$ã€‚ å…¶ä¸­ï¼ŒJava8ä¸­çš„æºä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940private static final int MULTIPLY_SQUARE_THRESHOLD = 20;private static final int KARATSUBA_THRESHOLD = 80;private static final int TOOM_COOK_THRESHOLD = 240;public BigInteger multiply(BigInteger val) &#123; if (val.signum == 0 || signum == 0) return ZERO; int xlen = mag.length; if (val == this &amp;&amp; xlen &gt; MULTIPLY_SQUARE_THRESHOLD) &#123; return square(); &#125; int ylen = val.mag.length; if ((xlen &lt; KARATSUBA_THRESHOLD) || (ylen &lt; KARATSUBA_THRESHOLD)) &#123; int resultSign = signum == val.signum ? 1 : -1; if (val.mag.length == 1) &#123; return multiplyByInt(mag,val.mag[0], resultSign); &#125; if (mag.length == 1) &#123; return multiplyByInt(val.mag,mag[0], resultSign); &#125; int[] result = multiplyToLen(mag, xlen, val.mag, ylen, null); result = trustedStripLeadingZeroInts(result); return new BigInteger(result, resultSign); &#125; else &#123; if ((xlen &lt; TOOM_COOK_THRESHOLD) &amp;&amp; (ylen &lt; TOOM_COOK_THRESHOLD)) &#123; // é‡‡ç”¨ Karatsuba algorithm ç®—æ³• return multiplyKaratsuba(this, val); &#125; else &#123; // é‡‡ç”¨ Toom-Cook multiplication 3è·¯ä¹˜æ³• return multiplyToomCook3(this, val); &#125; &#125;&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒJava8ä¾æ®ä¸¤ä¸ªå› æ•°çš„é‡çº§åˆ†åˆ«ä½¿ç”¨Karatsuba algorithm å’Œ Toom-Cook multiplication ç®—æ³•è®¡ç®—å¤§æ•°ä¹˜ç§¯ã€‚ Karatsuba algorithm1234567891011121314151617181920212223242526272829303132/** * Java8ä¸­çš„ Karatsuba algorithm ç®—æ³• */private static BigInteger multiplyKaratsuba(BigInteger x, BigInteger y) &#123; int xlen = x.mag.length; int ylen = y.mag.length; // The number of ints in each half of the number. int half = (Math.max(xlen, ylen)+1) / 2; // xl and yl are the lower halves of x and y respectively, // xh and yh are the upper halves. BigInteger xl = x.getLower(half); BigInteger xh = x.getUpper(half); BigInteger yl = y.getLower(half); BigInteger yh = y.getUpper(half); BigInteger p1 = xh.multiply(yh); // p1 = xh*yh BigInteger p2 = xl.multiply(yl); // p2 = xl*yl // p3=(xh+xl)*(yh+yl) BigInteger p3 = xh.add(xl).multiply(yh.add(yl)); // result = p1 * 2^(32*2*half) + (p3 - p1 - p2) * 2^(32*half) + p2 BigInteger result = p1.shiftLeft(32*half).add(p3.subtract(p1).subtract(p2)).shiftLeft(32*half).add(p2); if (x.signum != y.signum) &#123; return result.negate(); &#125; else &#123; return result; &#125;&#125; Toom-Cook multiplication123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263/** * Java8ä¸­çš„ Toom-Cook multiplication 3è·¯ä¹˜æ³• */private static BigInteger multiplyToomCook3(BigInteger a, BigInteger b) &#123; int alen = a.mag.length; int blen = b.mag.length; int largest = Math.max(alen, blen); // k is the size (in ints) of the lower-order slices. int k = (largest+2)/3; // Equal to ceil(largest/3) // r is the size (in ints) of the highest-order slice. int r = largest - 2*k; // Obtain slices of the numbers. a2 and b2 are the most significant // bits of the numbers a and b, and a0 and b0 the least significant. BigInteger a0, a1, a2, b0, b1, b2; a2 = a.getToomSlice(k, r, 0, largest); a1 = a.getToomSlice(k, r, 1, largest); a0 = a.getToomSlice(k, r, 2, largest); b2 = b.getToomSlice(k, r, 0, largest); b1 = b.getToomSlice(k, r, 1, largest); b0 = b.getToomSlice(k, r, 2, largest); BigInteger v0, v1, v2, vm1, vinf, t1, t2, tm1, da1, db1; v0 = a0.multiply(b0); da1 = a2.add(a0); db1 = b2.add(b0); vm1 = da1.subtract(a1).multiply(db1.subtract(b1)); da1 = da1.add(a1); db1 = db1.add(b1); v1 = da1.multiply(db1); v2 = da1.add(a2).shiftLeft(1).subtract(a0).multiply( db1.add(b2).shiftLeft(1).subtract(b0)); vinf = a2.multiply(b2); // The algorithm requires two divisions by 2 and one by 3. // All divisions are known to be exact, that is, they do not produce // remainders, and all results are positive. The divisions by 2 are // implemented as right shifts which are relatively efficient, leaving // only an exact division by 3, which is done by a specialized // linear-time algorithm. t2 = v2.subtract(vm1).exactDivideBy3(); tm1 = v1.subtract(vm1).shiftRight(1); t1 = v1.subtract(v0); t2 = t2.subtract(t1).shiftRight(1); t1 = t1.subtract(tm1).subtract(vinf); t2 = t2.subtract(vinf.shiftLeft(1)); tm1 = tm1.subtract(t2); // Number of bits to shift left. int ss = k*32; BigInteger result = vinf.shiftLeft(ss).add(t2).shiftLeft(ss).add(t1).shiftLeft(ss).add(tm1).shiftLeft(ss).add(v0); if (a.signum != b.signum) &#123; return result.negate(); &#125; else &#123; return result; &#125;&#125; å‚è€ƒèµ„æ–™ åä¸ºOJæœºè¯•é¢˜ç›®ï¼šä¸¤ä¸ªå¤§æ•´æ•°ç›¸ä¹˜(çº¯Cè¯­è¨€å®ç°ä¸¤ä¸ªå¤§æ•´æ•°ç›¸ä¹˜ï¼Œä¸¤ç§æ–¹æ³•å®ç°å¤§æ•°ç›¸ä¹˜) javaçš„BigIntegerçš„ä¹˜æ³•è¿ç®—æ˜¯ç”¨ä»€ä¹ˆç®—æ³•å®ç°çš„ï¼Ÿ å¤§æ•°ä¹˜æ³•ï¼Œåœ¨ç®—æ³•ä¸Šï¼Œä¸»è¦æœ‰å‡ ç§æ€è·¯ï¼Ÿ ç®—æ³•ç†è§£ â€” å¤§æ•°ç›¸ä¹˜é—®é¢˜ KaraTsubaä¹˜æ³• â€” é«˜æ•ˆçš„å¤§æ•°ä¹˜æ³• å¤§æ•°ç›¸ä¹˜(fromæ»´ç­”æ»´ç­”ç™¾åº¦ç©ºé—´) å¤§æ•´æ•°è¿ç®— ç»´åŸºç™¾ç§‘ï¼šMultiplication algorithm Karatsuba Multiplication Algorithm â€“ Python Code Toom-Cook 3-Way Multiplication - GMP Documentations æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸ä¸­å›½å‰©ä½™å®šç†","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€ç®—æ³•ã€‘åè½¬å­—ç¬¦ä¸²","slug":"ã€ç®—æ³•ã€‘åè½¬å­—ç¬¦ä¸²","date":"2017-08-05T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/08/05/ã€ç®—æ³•ã€‘åè½¬å­—ç¬¦ä¸²/","link":"","permalink":"http://github.com/2017/08/05/ã€ç®—æ³•ã€‘åè½¬å­—ç¬¦ä¸²/","excerpt":"å‰è¨€ç ”ç©¶ç®—æ³•èƒ½æé«˜æˆ‘ä»¬çš„ç¼–ç¨‹åŠŸåº•ï¼Œæ›´å¥½åœ°ç¼–å†™å‡ºé«˜æ•ˆç¨³å¥çš„ä»£ç ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬ç ”ç©¶çš„æ˜¯ â€”â€” åè½¬å­—ç¬¦ä¸²ã€‚ 123//è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¾“å‡ºå®ƒçš„å€’åºå­—ç¬¦ä¸²input: Hellooutput: olleH è§£æ³•åè½¬å­—ç¬¦ä¸²ï¼Œç¡®å®æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä½†æ˜¯æˆ‘æ— æ„é—´æœç´¢äº†ä¸€ä¸‹ï¼Œæ‰å‘ç°è¿™ä¹ˆä¸€ä¸ªçœ‹ä¼¼ç®€å•çš„åè½¬ç®—æ³•å®ç°èµ·æ¥çœŸå¯è°“èŠ±æ ·ç¹å¤šã€‚è¿™é‡Œæˆ‘ä»¬å°½å¯èƒ½åˆ†åˆ«æ€»ç»“ä»‹ç»ä¸€ä¸‹ã€‚ 1ã€ä½¿ç”¨å­—ç¬¦æ•°ç»„å€’åºè¾“å‡ºæœ€å¸¸è§„çš„è§£æ³•ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“æƒ³åˆ°çš„ä¸€ç§æ–¹æ³•å°±æ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„å€’åºè¾“å‡ºã€‚ å…·ä½“æ€è·¯æ˜¯ï¼šå€’åºéå†å­—ç¬¦ä¸²å­—ç¬¦å¾ªç¯ç»™charæ•°ç»„èµ‹å€¼ 123456789public static String strReverseWithArray(String string) &#123; if (string == null || string.length() == 0) return string; char[] array = new char[string.length()]; for(int i = 0; i &lt; string.length(); i++)&#123; array[i] = string.charAt(string.length() - i - 1); &#125; return new String(array);&#125;","text":"å‰è¨€ç ”ç©¶ç®—æ³•èƒ½æé«˜æˆ‘ä»¬çš„ç¼–ç¨‹åŠŸåº•ï¼Œæ›´å¥½åœ°ç¼–å†™å‡ºé«˜æ•ˆç¨³å¥çš„ä»£ç ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬ç ”ç©¶çš„æ˜¯ â€”â€” åè½¬å­—ç¬¦ä¸²ã€‚ 123//è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¾“å‡ºå®ƒçš„å€’åºå­—ç¬¦ä¸²input: Hellooutput: olleH è§£æ³•åè½¬å­—ç¬¦ä¸²ï¼Œç¡®å®æ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä½†æ˜¯æˆ‘æ— æ„é—´æœç´¢äº†ä¸€ä¸‹ï¼Œæ‰å‘ç°è¿™ä¹ˆä¸€ä¸ªçœ‹ä¼¼ç®€å•çš„åè½¬ç®—æ³•å®ç°èµ·æ¥çœŸå¯è°“èŠ±æ ·ç¹å¤šã€‚è¿™é‡Œæˆ‘ä»¬å°½å¯èƒ½åˆ†åˆ«æ€»ç»“ä»‹ç»ä¸€ä¸‹ã€‚ 1ã€ä½¿ç”¨å­—ç¬¦æ•°ç»„å€’åºè¾“å‡ºæœ€å¸¸è§„çš„è§£æ³•ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“æƒ³åˆ°çš„ä¸€ç§æ–¹æ³•å°±æ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„å€’åºè¾“å‡ºã€‚ å…·ä½“æ€è·¯æ˜¯ï¼šå€’åºéå†å­—ç¬¦ä¸²å­—ç¬¦å¾ªç¯ç»™charæ•°ç»„èµ‹å€¼ 123456789public static String strReverseWithArray(String string) &#123; if (string == null || string.length() == 0) return string; char[] array = new char[string.length()]; for(int i = 0; i &lt; string.length(); i++)&#123; array[i] = string.charAt(string.length() - i - 1); &#125; return new String(array);&#125; ä¼˜åŒ–ï¼š åˆ†æä¸Šé¢è¿™ç§è§£æ³•ï¼Œå¾ªç¯éå†æ—¶ï¼Œæˆ‘ä»¬å…¶å®ä¸éœ€è¦å¾ªç¯è¿™ä¹ˆå¤šæ¬¡ã€‚æ¯æ¬¡å¾ªç¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥ç›´æ¥ç»™å‰ã€åä½ç½®ï¼ˆç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªï¼Œç¬¬äºŒä¸ªå’Œå€’æ•°ç¬¬äºŒä¸ªï¼‰äº¤æ¢ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸å¿…å¯¹è¿™ä¸ªå­—ç¬¦æ•°ç»„è¿›è¡Œå®Œå…¨éå†ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¼šåªéå†ä¸€åŠåŒæ—¶äº¤æ¢ä¸­è½´å‰åä¸¤ä¸ªå…ƒç´ å°±å¯ä»¥äº†ã€‚ 123456789101112131415public static String strReverseWithArray(String string) &#123; if (string == null || string.length() == 0) return string; char[] array = string.toCharArray(); //æ³¨æ„è¿™é‡Œä¸­é—´çš„ä½ç½®è®¡ç®— for(int i = 0; i &lt; Math.ceil(string.length() / 2.0f); i++)&#123; int j = string.length() - i - 1; if(i != j)&#123; //äº¤æ¢å…ƒç´  char temp = array[i]; array[i] = array[j]; array[j] = temp; &#125; &#125; return new String(array);&#125; 2ã€ä½¿ç”¨StringBuilderStringBuilderå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ›å»ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ä½¿ç”¨StringBuilderæ›¿ä»£å­—ç¬¦æ•°ç»„å­˜å‚¨ï¼Œå…·ä½“æ€è·¯æ˜¯: é€†åºéå†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œå¹¶å°†å®ƒä¾æ¬¡æ·»åŠ åˆ°StringBuilderä¸­ 123456789public static String strReverseWithStringBuilder(String string) &#123; if (string == null || string.length() == 0) return string; StringBuilder sb = new StringBuilder(); for(int i = string.length() - 1; i &gt;= 0; i--)&#123; sb.append(string.charAt(i)); &#125; return sb.toString();&#125; ä»¥ä¸Šè¿™å‡ ç§æ–¹æ³•æŒ‰ç®—æ³•è§’åº¦æ¥è¯´ï¼Œå…¶å®å¯ä»¥å½’ç»“ä¸ºä¸€ç±»ã€‚ç„¶è€Œä¸‹é¢çš„å‡ ç§ç®—æ³•å°±å®Œå…¨ä¸æ˜¯åŒä¸€ç±»å‹çš„äº†ã€‚æ¯”å¦‚ä½¿ç”¨æ ˆã€ä½¿ç”¨å¼‚æˆ–è¿ç®—ã€‚ 3ã€ä½¿ç”¨StringBuilder.reverse()æ–¹æ³•1new StringBuilder(hi).reverse().toString() StringBuilderä¸­æä¾›äº†reverse()æ–¹æ³•æ¥å®ç°å­—ç¬¦ä¸²åè½¬ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨ 12345public static String strReverseWithRecursive(String string) &#123; if (string == null || string.length() == 0) return string; return new StringBuilder(string).reverse().toString();&#125; Or, for versions earlier than JDK 1.5, use java.util.StringBuffer instead of StringBuilder â€” they have the same API. Thanks commentators for pointing out that StringBuilder is preferred nowadays. å¯¹äºJDK 1.5ä¹‹å‰çš„ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨StringBufferæ›¿ä»£StringBuilderï¼Œè¿™ä¸¤ä¸ªçš„APIéƒ½ä¸€æ ·ã€‚ 4ã€ä½¿ç”¨æ ˆæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ ˆæœ‰â€œåè¿›å…ˆå‡º(LIFO)â€çš„ç‰¹ç‚¹ã€‚è¿™ä¸€ç‰¹ç‚¹åˆšå¥½ç”¨äºåè½¬å­—ç¬¦ä¸²ã€‚å…·ä½“æ€è·¯æ˜¯: å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºcharæ•°ç»„ å°†charæ•°ç»„ä¸­çš„å­—ç¬¦ä¾æ¬¡å‹å…¥æ ˆä¸­ å°†æ ˆä¸­çš„å­—ç¬¦ä¾æ¬¡å¼¹å‡ºèµ‹å€¼ç»™charæ•°ç»„ 12345678910111213public static String strReverseWithStack(String string) &#123; if (string == null || string.length() == 0) return string; char[] array = string.toCharArray(); Stack&lt;Character&gt; stack = new Stack&lt;Character&gt;(); for(Character c : array)&#123; stack.push(c); //å‹æ ˆ &#125; for(int i = 0; i &lt; string.length(); i++)&#123; array[i] = stack.pop(); &#125; return new String(array); //å‡ºæ ˆ&#125; ä¸¤æ¬¡å¾ªç¯å’Œæ ˆçš„å¼€é”€æ— ç–‘ä½¿è¿™ç§æ–¹æ³•æˆä¸ºç›®å‰ä¸ºæ­¢å¼€é”€æœ€å¤§çš„æ–¹æ³•ã€‚ä½†ä½¿ç”¨æ ˆè¿™ä¸ªæ•°æ®ç»“æ„çš„æƒ³æ³•è¿˜æ˜¯éå¸¸æœ‰ä»·å€¼çš„ã€‚ 5ã€ä½¿ç”¨å¼‚æˆ–è¿ç®—è®¡ç®—æœºçš„æ•°æ®æµæœ¬è´¨ä¸Šéƒ½æ˜¯0ï¼Œ1äºŒè¿›åˆ¶æ•°æ®ã€‚å­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸€æ ·ã€‚è€ŒäºŒè¿›åˆ¶æ•°æ®çš„å¤„ç†å¾€å¾€æ˜¯é€šè¿‡ä½è¿ç®—æ¥å®ç°çš„ã€‚ä½æ“ä½œæœ‰ï¼šä¸ï¼Œæˆ–ï¼Œéï¼Œå¼‚æˆ–ã€‚ å¯¹ä½è¿ç®—æœ‰è¿‡äº†è§£çš„åº”è¯¥çŸ¥é“ï¼Œä½¿ç”¨å¼‚æˆ–æ“ä½œèƒ½å®ç°äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼è€Œä¸å¼•å…¥ç¬¬ä¸‰ä¸ªå˜é‡ã€‚ å®ç°åŸç†: é¦–å…ˆä»‹ç»å¼‚æˆ–æ“ä½œ 1234567å¼‚æˆ–æ“ä½œ: å½“ä¸¤ä¸¤æ•°å€¼ç›¸åŒä¸ºå¦ï¼Œè€Œæ•°å€¼ä¸åŒä¸ºçœŸã€‚å†™ä½œA^BA B A^B0 0 00 1 11 0 10 1 0 ä½¿ç”¨å¼‚æˆ–æ“ä½œäº¤æ¢æ•°å€¼ 12345678910111213141516ä¸¤ä¸ªæ•°å¼‚æˆ–çš„ç»“æœå†ä¸å…¶ä¸­ä¸€ä¸ªæ•°å¼‚æˆ–çš„ç»“æœæ˜¯å¦å¤–ä¸€ä¸ªæ•°è¿™æ¶‰åŠåˆ°äº†ç¦»æ•£æ•°å­¦ä¸­çš„å¼‚æˆ–çš„æ€§è´¨:1.äº¤æ¢å¾‹:A^B=B^A2.ç»“åˆå¾‹: A^(B^C)=(A^B)^C3.æ’ç­‰å¾‹:X^0=04.å½’é›¶å¾‹:X^X=05.è‡ªåï¼šA^B^B = A^0=Aæ ¹æ®ä»¥ä¸Šæ€§è´¨:A=A^BB=A^BA=A^Bé€šè¿‡ä»¥ä¸Šä¸‰æ­¥ï¼Œèƒ½å®ç°åœ¨ç¨‹åºä¸­äº¤æ¢ä¸¤ä¸ªå˜é‡çš„æ•°å€¼çš„ç›®æ ‡ã€‚ ä½¿ç”¨å¼‚æˆ–æ“ä½œäº¤æ¢å­—ç¬¦å€¼ 123456789101112131415161718192021before:\"Hello\"after: \"olleH\"index: 0 1 2 3 4char : H e l l oASCII: 72 101 108 108 111ä»¥ç¬¬0ä¸ªå­—ç¬¦å’Œç¬¬4ä¸ªå­—ç¬¦äº¤æ¢ä¸ºä¾‹:äº¤æ¢å‰:array[0]=1001000array[4]=1101111äº¤æ¢:array[0]=array[0]^array[4]=0100111array[4]=array[4]^array[0]=1001000array[0]=array[0]^array[4]=1101111äº¤æ¢å:array[0]=1101111---&gt;111--&gt;oarray[4]=1001000---&gt;72---&gt;H ä½¿ç”¨è¿™ç§äº¤æ¢æ–¹æ³•ï¼Œæ¯æ¬¡å¾ªç¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥ç»™ä¸­è½´å‰ã€åä½ç½®å…ƒç´ ï¼ˆç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªï¼Œç¬¬äºŒä¸ªå’Œå€’æ•°ç¬¬äºŒä¸ªï¼‰äº¤æ¢ã€‚è¿™æ ·æˆ‘ä»¬ä¹Ÿåªéå†ä¸€åŠå°±å¯ä»¥äº†ã€‚ 123456789101112public static String strReverseWithArray(String string) &#123; if (string == null || string.length() == 0) return string; char[] array = string.toCharArray(); for(int i = 0, j = string.length() - 1; i &lt; j; i++, j--)&#123; //å¼‚æˆ–è¿ç®—äº¤æ¢å…ƒç´  array[i] ^= array[j]; array[j] ^= array[i]; array[i] ^= array[j]; &#125; return new String(array);&#125; 6ã€ä½¿ç”¨é€’å½’å½“æˆ‘ä»¬åè½¬å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè„‘æµ·é‡Œæƒ³çš„å°±æ˜¯ä»é¦–å°¾ä¸¤ç«¯ä¾æ¬¡äº¤æ¢ç›´åˆ°åˆ°è¾¾ä¸­é—´ä½ç½®ã€‚å½“æˆ‘ä»¬åœ¨åè½¬æŸä¸ªå­—ç¬¦æ—¶ï¼Œå‰©ä¸‹çš„å­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸€ä¸ªåè½¬å­—ç¬¦ä¸²çš„è¿‡ç¨‹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½ç”¨é€’å½’çš„æ–¹æ³•æ¥å®ç°åè½¬å­—ç¬¦ä¸²çš„ç›®çš„ã€‚ å…·ä½“æ€è·¯æ˜¯: æ‰¾å‡ºé€’å½’ç»“æŸçš„ä¸´ç•Œæ¡ä»¶ å¯¹é’ˆå¯¹äºä¸´ç•Œæ¡ä»¶çš„ä¸åŒçš„å€¼åšå‡ºä¸åŒçš„å¤„ç† ç¼–ç å®ç°ï¼š 12345678910public static String strReverseWithRecursive(String string) &#123; if (string == null || string.length() == 0) return string; if(string.length() == 1)&#123; return string; &#125;else&#123; //å½“å‰strçš„åè½¬ = å°†ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹åçš„subStringåè½¬ + ç¬¬ä¸€ä¸ªå…ƒç´  return strReverseWithRecursive(string.substring(1)) + string.charAt(0); &#125;&#125; å¼•ç”³é—®é¢˜åè½¬ä¸€ä¸ªå­—ç¬¦ä¸²æœ‰è¿™ä¹ˆå¤šæ–¹æ³•ï¼Œé‚£ä¹ˆå¦‚ä½•æŠŠä¸€ä¸ªå­—ç¬¦ä¸²åè½¬ï¼Œè€Œå•è¯ä¸ç¿»è½¬å‘¢ï¼Ÿ é¢˜ç›®ï¼šå†™ä¸€ä¸ªå‡½æ•°ï¼Œå°†å­—ç¬¦ä¸²åè½¬ï¼Œåè½¬æ–¹å¼å¦‚ä¸‹ï¼š 123//è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¾“å‡ºå®ƒçš„å€’åºå­—ç¬¦ä¸²ï¼Œå•è¯ä¸ç¿»è½¬input: \"I am a student\"output: \"student a am I\" è§£å†³æˆ‘ä»¬å¯ä»¥ä»¿ç…§ä¸Šé¢çš„å­—ç¬¦ä¸²å®Œå…¨åè½¬æ–¹æ³•ã€‚ æ¯”å¦‚ä½¿ç”¨æ ˆï¼Œå¯ä»¥æŠŠå•è¯å…¥æ ˆï¼Œè€Œä¸æ˜¯å­—ç¬¦ï¼Œç„¶åå‡ºæ ˆï¼Œå°±æ˜¯æƒ³è¦çš„æ•ˆæœäº†ã€‚æˆ–è€…ä¹Ÿä½¿ç”¨StringBuilderå€’åºå­˜å‚¨ï¼Œå¦‚ä¸‹ï¼š 123456789public static String reverse(String word)&#123; String[] arr = word.split(\"\\\\W+\"); StringBuffer sb = new StringBuffer(); int len = arr.length; for(int i = len-1; i &gt;= 0; i--)&#123; sb.append(arr[i]).append(\" \"); &#125; return sb.toString();&#125; è¿˜æœ‰ä¸€ç§æ€è·¯æ˜¯ï¼šå…ˆæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å®Œå…¨åè½¬ï¼Œå†å°†å­—ç¬¦ä¸²åˆ†å‰²ä¸ºå•è¯ï¼Œæ¯ä¸ªå•è¯å†å•ç‹¬åè½¬å›æ¥ã€‚è¿™ç§åŠæ³•ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚ å‚è€ƒèµ„æ–™ æ·±å…¥æµ…å‡ºç»å…¸é¢è¯•é¢˜ä¹‹â€”â€”åè½¬å­—ç¬¦ä¸² å­—ç¬¦ä¸²åè½¬çš„9ç§æ–¹æ³•","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Androidã€‘æºç åˆ†æ - Handleræ¶ˆæ¯æœºåˆ¶å†æ¢³ç†","slug":"ã€Androidã€‘æºç åˆ†æ - Handleræ¶ˆæ¯æœºåˆ¶å†æ¢³ç†","date":"2017-08-03T08:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/08/03/ã€Androidã€‘æºç åˆ†æ - Handleræ¶ˆæ¯æœºåˆ¶å†æ¢³ç†/","link":"","permalink":"http://github.com/2017/08/03/ã€Androidã€‘æºç åˆ†æ - Handleræ¶ˆæ¯æœºåˆ¶å†æ¢³ç†/","excerpt":"å‰è¨€å¤šçº¿ç¨‹çš„æ¶ˆæ¯ä¼ é€’å¤„ç†ï¼Œä»åˆå­¦Androidæ—¶çš„Handlerï¼Œæ‡µæ‡µæ‡‚æ‡‚åœ°ç…§çŒ«ç”»è™ï¼Œåˆ°åæ¥ä¸€å¤´é›¾æ°´çš„ç–‘æƒ‘å®ƒä¸ºä»€ä¹ˆè¿™ä¹ˆå¤æ‚ï¼Œå†åˆ°ç†Ÿæ‚‰ä¹‹åçš„å¹ä¸ºè§‚æ­¢ï¼Œä¸€æ­¥æ­¥åœ°éƒ½æ˜¯è‡ªå·±è¸©è¿‡çš„è¶³è¿¹ï¼Œéƒ½æ˜¯æˆé•¿å•Šå“ˆå“ˆå“ˆã€‚è™½ç„¶ç¦»å‡ºç¥å…¥åŒ–çš„å¢ƒç•Œè¿˜è¿œåä¸‡å…«åƒé‡Œå‘¢ï¼Œä½†Androidä¸­çš„Handlerå¤šçº¿ç¨‹æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼Œçš„ç¡®æ˜¯ç ”å‘æŠ€æœ¯å­¦ä¹ ä¸­ä¸å¯å¤šå¾—çš„ä¸€ä¸ªå®è—ã€‚æœ¬æ¥æˆ‘ä»¥ä¸ºè‡ªå·±ä¹‹å‰çš„å­¦ä¹ ä»¥åŠæ¯”è¾ƒäº†è§£ Handlerï¼Œåœ¨å°è±¡ä¸­ Android æ¶ˆæ¯æœºåˆ¶æ— éå°±æ˜¯ï¼š Handler ç»™ MessageQueue æ·»åŠ æ¶ˆæ¯ ç„¶å Looper æ— é™å¾ªç¯è¯»å–æ¶ˆæ¯ å†è°ƒç”¨ Handler å¤„ç†æ¶ˆæ¯ ä½†æ˜¯åªçŸ¥é“æ•´ä½“æµç¨‹ï¼Œç»†èŠ‚è¿˜ä¸æ˜¯ç‰¹åˆ«é€å½»ã€‚æœ€è¿‘ä¸ç”šå¿™ç¢Œï¼Œå›å¤´çœ‹åˆ°è¿™å—åˆæœ‰äº›è®¸æ”¶è·ï¼Œæˆ‘ä»¬æ¥è®°å½•ä¸€ä¸‹å§ã€‚ åœ¨æ•´ä¸ªAndroidçš„æºç ä¸–ç•Œé‡Œï¼Œæœ‰ä¸¤å¤§åˆ©å‰‘ï¼Œå…¶ä¸€æ˜¯Binder IPCæœºåˆ¶ï¼Œå¦ä¸€ä¸ªä¾¿æ˜¯æ¶ˆæ¯æœºåˆ¶ã€‚Androidæœ‰å¤§é‡çš„æ¶ˆæ¯é©±åŠ¨æ–¹å¼æ¥è¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚Androidçš„å››å‰‘å®¢Activity, Service, Broadcast, ContentProviderçš„å¯åŠ¨è¿‡ç¨‹çš„äº¤äº’ï¼Œéƒ½ç¦»ä¸å¼€æ¶ˆæ¯æœºåˆ¶ï¼ŒAndroidæŸç§æ„ä¹‰ä¸Šä¹Ÿå¯ä»¥è¯´æˆæ˜¯ä¸€ä¸ªä»¥æ¶ˆæ¯é©±åŠ¨çš„ç³»ç»Ÿã€‚è€ŒAndroid æ¶ˆæ¯æœºåˆ¶ä¸»è¦æ¶‰åŠ 4 ä¸ªç±»ï¼š Handler Message MessageQueue Looper æˆ‘ä»¬ä¾æ¬¡ç»“åˆæºç åˆ†æä¸€ä¸‹ã€‚","text":"å‰è¨€å¤šçº¿ç¨‹çš„æ¶ˆæ¯ä¼ é€’å¤„ç†ï¼Œä»åˆå­¦Androidæ—¶çš„Handlerï¼Œæ‡µæ‡µæ‡‚æ‡‚åœ°ç…§çŒ«ç”»è™ï¼Œåˆ°åæ¥ä¸€å¤´é›¾æ°´çš„ç–‘æƒ‘å®ƒä¸ºä»€ä¹ˆè¿™ä¹ˆå¤æ‚ï¼Œå†åˆ°ç†Ÿæ‚‰ä¹‹åçš„å¹ä¸ºè§‚æ­¢ï¼Œä¸€æ­¥æ­¥åœ°éƒ½æ˜¯è‡ªå·±è¸©è¿‡çš„è¶³è¿¹ï¼Œéƒ½æ˜¯æˆé•¿å•Šå“ˆå“ˆå“ˆã€‚è™½ç„¶ç¦»å‡ºç¥å…¥åŒ–çš„å¢ƒç•Œè¿˜è¿œåä¸‡å…«åƒé‡Œå‘¢ï¼Œä½†Androidä¸­çš„Handlerå¤šçº¿ç¨‹æ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼Œçš„ç¡®æ˜¯ç ”å‘æŠ€æœ¯å­¦ä¹ ä¸­ä¸å¯å¤šå¾—çš„ä¸€ä¸ªå®è—ã€‚æœ¬æ¥æˆ‘ä»¥ä¸ºè‡ªå·±ä¹‹å‰çš„å­¦ä¹ ä»¥åŠæ¯”è¾ƒäº†è§£ Handlerï¼Œåœ¨å°è±¡ä¸­ Android æ¶ˆæ¯æœºåˆ¶æ— éå°±æ˜¯ï¼š Handler ç»™ MessageQueue æ·»åŠ æ¶ˆæ¯ ç„¶å Looper æ— é™å¾ªç¯è¯»å–æ¶ˆæ¯ å†è°ƒç”¨ Handler å¤„ç†æ¶ˆæ¯ ä½†æ˜¯åªçŸ¥é“æ•´ä½“æµç¨‹ï¼Œç»†èŠ‚è¿˜ä¸æ˜¯ç‰¹åˆ«é€å½»ã€‚æœ€è¿‘ä¸ç”šå¿™ç¢Œï¼Œå›å¤´çœ‹åˆ°è¿™å—åˆæœ‰äº›è®¸æ”¶è·ï¼Œæˆ‘ä»¬æ¥è®°å½•ä¸€ä¸‹å§ã€‚ åœ¨æ•´ä¸ªAndroidçš„æºç ä¸–ç•Œé‡Œï¼Œæœ‰ä¸¤å¤§åˆ©å‰‘ï¼Œå…¶ä¸€æ˜¯Binder IPCæœºåˆ¶ï¼Œå¦ä¸€ä¸ªä¾¿æ˜¯æ¶ˆæ¯æœºåˆ¶ã€‚Androidæœ‰å¤§é‡çš„æ¶ˆæ¯é©±åŠ¨æ–¹å¼æ¥è¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚Androidçš„å››å‰‘å®¢Activity, Service, Broadcast, ContentProviderçš„å¯åŠ¨è¿‡ç¨‹çš„äº¤äº’ï¼Œéƒ½ç¦»ä¸å¼€æ¶ˆæ¯æœºåˆ¶ï¼ŒAndroidæŸç§æ„ä¹‰ä¸Šä¹Ÿå¯ä»¥è¯´æˆæ˜¯ä¸€ä¸ªä»¥æ¶ˆæ¯é©±åŠ¨çš„ç³»ç»Ÿã€‚è€ŒAndroid æ¶ˆæ¯æœºåˆ¶ä¸»è¦æ¶‰åŠ 4 ä¸ªç±»ï¼š Handler Message MessageQueue Looper æˆ‘ä»¬ä¾æ¬¡ç»“åˆæºç åˆ†æä¸€ä¸‹ã€‚ åˆå­¦Handleræ¯ä¸ªåˆå­¦Androidå¼€å‘çš„éƒ½ç»•ä¸å¼€Handlerè¿™ä¸ªâ€œåâ€ï¼Œä¸ºä»€ä¹ˆè¯´æ˜¯ä¸ªåå‘¢ï¼Œé¦–å…ˆè¿™æ˜¯Androidæ¶æ„çš„ç²¾é«“ä¹‹ä¸€ï¼Œå…¶æ¬¡å¤§éƒ¨åˆ†äººéƒ½æ˜¯çŸ¥å…¶ç„¶å´ä¸çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚æ‰€ä»¥å†³å®šå†å»ç¿»ç¿»æºä»£ç æ¢³ç†ä¸€ä¸‹Handlerçš„å®ç°æœºåˆ¶ã€‚ å¼‚æ­¥æ›´æ–°UIæˆ‘ä»¬éƒ½çŸ¥é“Androidä¸­ä¸»çº¿ç¨‹å°±æ˜¯UIçº¿ç¨‹ã€‚åœ¨ä¸»çº¿ç¨‹ä¸èƒ½åšè€—æ—¶æ“ä½œï¼Œè€Œå­çº¿ç¨‹ä¸èƒ½æ›´æ–°UIã€‚ä¸»çº¿ç¨‹å¦‚æœè€—æ—¶æ“ä½œå¤ªä¹…ï¼ˆè¶…è¿‡5ç§’ï¼‰ä¼šå¼•èµ·ANRã€‚å­çº¿ç¨‹æ›´æ–°UIï¼Œä¼šå¯¼è‡´çº¿ç¨‹ä¸å®‰å…¨ï¼Œç•Œé¢çš„åˆ·æ–°ä¸èƒ½åŒæ­¥ï¼Œå¯èƒ½ä¸èµ·ä½œç”¨ç”šè‡³æ˜¯å´©æºƒã€‚è¯¦ç»†çš„åˆ†æå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« Androidå­çº¿ç¨‹çœŸçš„ä¸èƒ½æ›´æ–°UIä¹ˆï¼Ÿ ä¸Šé¢è¿™ä¸ªè§„å®šåº”è¯¥æ˜¯åˆå­¦å¿…çŸ¥çš„ï¼Œé‚£è¦æ€ä¹ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Œè¿™æ—¶å€™Handlerå°±å‡ºç°åœ¨æˆ‘ä»¬é¢å‰äº†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨AsyncTaskæˆ–è€…IntentServiceè¿›è¡Œå¼‚æ­¥çš„æ“ä½œã€‚è¿™ä¸¤è€…åˆæ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿå…¶å®ï¼Œåœ¨AsyncTaskå’ŒIntentServiceçš„å†…éƒ¨äº¦ä½¿ç”¨äº†Handlerå®ç°å…¶ä¸»è¦åŠŸèƒ½ã€‚æŠ›å¼€è¿™ä¸¤è€…ä¸è°ˆï¼Œå½“æˆ‘ä»¬æ‰“å¼€Androidæºç çš„æ—¶å€™ä¹Ÿéšå¤„å¯è§Handlerçš„èº«å½±ã€‚æ‰€ä»¥ï¼ŒHandleræ˜¯Androidå¼‚æ­¥æ“ä½œçš„æ ¸å¿ƒå’Œç²¾é«“ï¼Œå®ƒåœ¨ä¼—å¤šé¢†åŸŸå‘æŒ¥ç€æå…¶é‡è¦ç”šè‡³æ˜¯ä¸å¯æ›¿ä»£çš„ä½œç”¨ã€‚æˆ‘ä»¬å…ˆæ¥ä¸€æ®µç»å…¸å¸¸ç”¨ä»£ç ï¼ˆè¿™é‡Œå¿½ç•¥å†…å­˜æ³„éœ²é—®é¢˜ï¼Œæˆ‘ä»¬åé¢å†è¯´ï¼‰ï¼š é¦–å…ˆåœ¨Activityä¸­æ–°å»ºä¸€ä¸ªhandler: 1234567891011private Handler mHandler = new Handler() &#123; @Override public void handleMessage(Message msg) &#123; super.handleMessage(msg); switch (msg.what) &#123; case 0: mTestTV.setText(\"This is handleMessage\"); //æ›´æ–°UI break; &#125; &#125;&#125;; ç„¶ååœ¨å­çº¿ç¨‹é‡Œå‘é€æ¶ˆæ¯ï¼š 1234567891011new Thread(new Runnable() &#123; @Override public void run() &#123; try &#123; Thread.sleep(1000); //åœ¨å­çº¿ç¨‹æœ‰ä¸€æ®µè€—æ—¶æ“ä½œ,æ¯”å¦‚è¯·æ±‚ç½‘ç»œ mHandler.sendEmptyMessage(0); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125;).start(); æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå­çº¿ç¨‹æ‹¿ç€ä¸»çº¿ç¨‹çš„mHandlerå¯¹è±¡è°ƒç”¨äº†å®ƒçš„sendEmptyMessage(0)æ–¹æ³•å‘é€äº†ä¸€ä¸ªç©ºMessageã€‚ç„¶åä¸»çº¿ç¨‹å°±æ›´æ–°äº†mTestTVè¿™ä¸ªTextViewçš„å†…å®¹ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å°±æ ¹æ®è¿™æ®µä»£ç é€æ­¥è·Ÿè¸ªåˆ†æä¸€ä¸‹Handleræºç ï¼Œæ¢³ç†ä¸€ä¸‹Androidçš„è¿™ä¸ªæ¶ˆæ¯æœºåˆ¶ã€‚ Handleræºç è·Ÿè¸ªæ ¹æ®ä¸Šé¢çš„Handlerä½¿ç”¨ä¾‹å­ï¼Œæˆ‘ä»¬ä»Handlerçš„sendEmptyMessage()æ–¹æ³•è¿™é‡Œå¼€å§‹ï¼Œç¿»çœ‹Handlerçš„æºç ï¼š 123456789101112131415161718public final boolean sendEmptyMessage(int what)&#123; return sendEmptyMessageDelayed(what, 0);&#125;public final boolean sendEmptyMessageDelayed(int what, long delayMillis) &#123; Message msg = Message.obtain(); msg.what = what; return sendMessageDelayed(msg, delayMillis);&#125;public final boolean sendMessageDelayed(Message msg, long delayMillis)&#123; if (delayMillis &lt; 0) &#123; delayMillis = 0; &#125; return sendMessageAtTime(msg, SystemClock.uptimeMillis() + delayMillis);&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ€åè°ƒç”¨äº†sendMessageAtTime()æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥ç€çœ‹è¿™ä¸ªæ–¹æ³•ï¼š 1234567891011public boolean sendMessageAtTime(Message msg, long uptimeMillis) &#123; MessageQueue queue = mQueue; //æ‹¿åˆ°MessageQueueé˜Ÿåˆ—å¯¹è±¡ if (queue == null) &#123; RuntimeException e = new RuntimeException( this + \" sendMessageAtTime() called with no mQueue\"); Log.w(\"Looper\", e.getMessage(), e); return false; &#125; //æŠŠmsgå¯¹è±¡å…¥é˜Ÿ return enqueueMessage(queue, msg, uptimeMillis);&#125; ä¹Ÿå°±æ˜¯è¯´ï¼Œç›®å‰æˆ‘ä»¬çœ‹åˆ°çš„Handlerçš„sendEmptyMessage()æ–¹æ³•è°ƒç”¨é€»è¾‘å¦‚ä¸‹å›¾ï¼š æœ€åè¿™ä¸ªsendMessageAtTime()æ–¹æ³•æˆ‘ä»¬çœ‹åˆ°ä¸¤ä¸ªäº®ç‚¹ï¼š ç¬¬ä¸€æ­¥ï¼Œé¦–å…ˆæ‹¿åˆ°æ¶ˆæ¯é˜Ÿåˆ—MessageQueueç±»å‹çš„mQueueå¯¹è±¡ã€‚ ç¬¬äºŒæ­¥ï¼ŒæŠŠæ¶ˆæ¯Messageç±»å‹çš„å®ä¾‹msgå¯¹è±¡å…¥é˜Ÿã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ²¿ç€è¿™ä¸¤ä¸ªé—®é¢˜åˆ†åˆ«å¾€ä¸‹è·Ÿè¸ªã€‚ MessageQueueå¯¹è±¡ä»å“ªé‡Œæ¥æˆ‘ä»¬å…ˆæ¥çœ‹mQueueè¿™ä¸ªMessageQueueå¯¹è±¡å“ªæ¥çš„å‘¢ï¼Ÿæˆ‘ä»¬æ‰¾åˆ°äº†èµ‹å€¼çš„åœ°æ–¹ï¼ŒåŸæ¥åœ¨Handlerçš„æ„é€ å‡½æ•°é‡Œï¼š 12345678910111213141516171819public Handler(Callback callback, boolean async) &#123; if (FIND_POTENTIAL_LEAKS) &#123; final Class&lt;? extends Handler&gt; klass = getClass(); if ((klass.isAnonymousClass() || klass.isMemberClass() || klass.isLocalClass()) &amp;&amp; (klass.getModifiers() &amp; Modifier.STATIC) == 0) &#123; Log.w(TAG, \"The following Handler class should be static or leaks might occur: \" + klass.getCanonicalName()); &#125; &#125; mLooper = Looper.myLooper(); //ä½¿ç”¨Looper.myLooper()å–åˆ°äº†mLooperå¯¹è±¡ if (mLooper == null) &#123; throw new RuntimeException( \"Can't create handler inside thread that has not called Looper.prepare()\"); &#125; mQueue = mLooper.mQueue; //åŸæ¥æ¶ˆæ¯é˜Ÿåˆ—æ¥è‡ªmLooperå¯¹è±¡é‡Œçš„mQueue mCallback = callback; mAsynchronous = async;&#125; åŸæ¥mQueueè¿™ä¸ªå¯¹è±¡æ˜¯ä»Looperè¿™ä¸ªå¯¹è±¡ä¸­è·å–çš„ï¼ŒåŒæ—¶æˆ‘ä»¬çœ‹åˆ°æ˜¯é€šè¿‡Looper.myLooper()è·å–åˆ°Looperå¯¹è±¡çš„ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªLooperæ‹¥æœ‰ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—MessageQueueå¯¹è±¡ã€‚æˆ‘ä»¬åœ¨Looperçš„æ„é€ å‡½æ•°é‡Œçœ‹åˆ°æ˜¯å®ƒnewäº†ä¸€ä¸ªMessageQueueï¼š 123456final MessageQueue mQueue;private Looper(boolean quitAllowed) &#123; mQueue = new MessageQueue(quitAllowed); //åˆå§‹åŒ–MessageQueueå¯¹è±¡ mThread = Thread.currentThread();&#125; æˆ‘ä»¬ç´§æ¥ç€å†è¿›å…¥Looperç±»ä¸­çš„myLooper()æ–¹æ³•çœ‹çœ‹å¦‚ä½•å¾—åˆ°Looperå®ä¾‹å¯¹è±¡çš„ï¼š 12345678910/** * Return the Looper object associated with the current thread. Returns * null if the calling thread is not associated with a Looper. */public static Looper myLooper() &#123; return sThreadLocal.get();&#125;// sThreadLocal.get() will return null unless you've called prepare().static final ThreadLocal&lt;Looper&gt; sThreadLocal = new ThreadLocal&lt;Looper&gt;(); åŸæ¥è¿™ä¸ªlooperå¯¹è±¡æ˜¯ä»ä¸€ä¸ªThreadLocalçº¿ç¨‹æœ¬åœ°å­˜å‚¨TLSå¯¹è±¡ä¸­å–åˆ°çš„ï¼Œè€Œä¸”è¿™ä¸ªå®ä¾‹å£°æ˜ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€è¡Œæ³¨é‡Šï¼šå¦‚æœä¸æå‰è°ƒç”¨prepare()æ–¹æ³•çš„è¯sThreadLocal.get()å¯èƒ½è¿”å›nullã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªprepare()æ–¹æ³•åˆ°åº•å¹²äº†ä»€ä¹ˆï¼š 12345678private static void prepare(boolean quitAllowed) &#123; //æ¯ä¸ªçº¿ç¨‹åªå…è®¸æ‰§è¡Œä¸€æ¬¡è¯¥æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œæ—¶çº¿ç¨‹çš„TLSå·²æœ‰æ•°æ®ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ if (sThreadLocal.get() != null) &#123; throw new RuntimeException(\"Only one Looper may be created per thread\"); &#125; //åˆ›å»ºLooperå¯¹è±¡ï¼Œå¹¶ä¿å­˜åˆ°å½“å‰çº¿ç¨‹çš„TLSåŒºåŸŸ sThreadLocal.set(new Looper(quitAllowed)); &#125; åŸæ¥æ˜¯ç»™ThreadLocalçº¿ç¨‹æœ¬åœ°å­˜å‚¨TLSå¯¹è±¡setäº†ä¸€ä¸ªæ–°çš„Looperå¯¹è±¡ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯newäº†ä¸€ä¸ªLooperå¯¹è±¡ç„¶åä¿å­˜åœ¨äº†çº¿ç¨‹æœ¬åœ°å­˜å‚¨åŒºé‡Œäº†ã€‚è€Œè¿™ä¸ªThreadLocalçº¿ç¨‹æœ¬åœ°å­˜å‚¨å¯¹è±¡å°±æ˜¯æ¯ä¸ªçº¿ç¨‹ä¸“æœ‰çš„å˜é‡ï¼Œå¯ä»¥ç†è§£æˆçº¿ç¨‹çš„è‡ªæœ‰å˜é‡ä¿å­˜åŒºã€‚æˆ‘ä»¬è¿™é‡Œä¸ä½œæ·±å…¥ä»‹ç»ï¼Œåªç”¨ç†è§£æ¯ä¸ªçº¿ç¨‹å¯ä»¥é€šè¿‡Looper.prepare()æ–¹æ³•newä¸€ä¸ªLooperå¯¹è±¡ä¿å­˜èµ·æ¥ï¼Œç„¶åå°±å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªLooperäº†ã€‚è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨éUIçº¿ç¨‹ä¸­ä½¿ç”¨Handlerä¹‹å‰å¿…é¡»é¦–å…ˆè°ƒç”¨Looper.prepare()æ–¹æ³•çš„æ ¹æœ¬åŸå› ã€‚ æ’æ’­ï¼šThreadLocalç±»å®ç°ä¸€ä¸ªçº¿ç¨‹æœ¬åœ°çš„å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å±€éƒ¨å˜é‡ã€‚æ‰€æœ‰çº¿ç¨‹éƒ½å…±äº«ä¸€ä¸ªThreadLocalå¯¹è±¡ï¼Œä½†æ˜¯æ¯ä¸ªçº¿ç¨‹åœ¨è®¿é—®è¿™äº›å˜é‡çš„æ—¶å€™èƒ½å¾—åˆ°ä¸åŒçš„å€¼ï¼Œæ¯ä¸ªçº¿ç¨‹å¯ä»¥æ›´æ”¹è¿™äº›å˜é‡å¹¶ä¸”ä¸ä¼šå½±å“å…¶ä»–çš„çº¿ç¨‹ï¼Œå¹¶ä¸”æ”¯æŒnullå€¼ã€‚è¯¦ç»†ä»‹ç»å¯ä»¥çœ‹çœ‹è¿™é‡Œï¼šAndroidçº¿ç¨‹ç®¡ç†ä¹‹ThreadLocalç†è§£åŠåº”ç”¨åœºæ™¯ æ¯”å¦‚æˆ‘ä»¬åœ¨Activityçš„onCreate()æ–¹æ³•ä¸­å†™ä¸€æ®µè¿™æ ·çš„ä»£ç ï¼š 12345678910111213@Overrideprotected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Handler h1 = new Handler(); new Thread(new Runnable() &#123; @Override public void run() &#123; Handler h2 = new Handler(); //ç›´æ¥åœ¨å­çº¿ç¨‹ä¸­newä¸€ä¸ªHandler &#125; &#125;).start();&#125; è¿è¡Œä¹‹åh1æ­£å¸¸åˆ›å»ºï¼Œä½†æ˜¯åˆ›å»ºh2çš„æ—¶å€™crashäº†ï¼š â€”â€”â€” beginning of crashE/AndroidRuntime: FATAL EXCEPTION: Thread-263Process: com.example.stone.sfsandroidclient, PID: 32286java.lang.RuntimeException: Canâ€™t create handler inside thread that has not called Looper.prepare() at android.os.Handler.(Handler.java:200) at android.os.Handler.(Handler.java:114) at com.example.stone.sfsandroidclient.MainActivity$1.run(MainActivity.java:71) at java.lang.Thread.run(Thread.java:818) å¾ˆæ˜æ˜¾ï¼Œå‡ºé”™æ—¥å¿—æç¤ºä¸èƒ½åœ¨ä¸€ä¸ªæ²¡æœ‰è°ƒç”¨è¿‡Looper.prepare()çš„Threadé‡Œè¾¹new Handler()ã€‚ çœ‹åˆ°äº†è¿™é‡Œæœ‰ä¸€ä¸ªç–‘æƒ‘ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬åœ¨æ–‡ç« å¼€å¤´çš„ç¤ºä¾‹ä»£ç ä¸­æ–°å»ºmHandlerçš„æ—¶å€™å¹¶æ²¡æœ‰è°ƒç”¨Looper.prepare()æ–¹æ³•ï¼Œé‚£Looperçš„åˆ›å»ºä»¥åŠæ–¹æ³•è°ƒç”¨åœ¨å“ªé‡Œå‘¢ï¼Ÿå…¶å®è¿™äº›ä¸œè¥¿Androidæœ¬èº«å·²ç»å¸®æˆ‘ä»¬åšäº†ï¼Œåœ¨ç¨‹åºå…¥å£ActivityThreadçš„mainæ–¹æ³•é‡Œé¢æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ï¼š 1234567 public static void main(String[] args) &#123; ... Looper.prepareMainLooper(); //è¿™é‡Œç­‰åŒäºLooper.prepare() ... Looper.loop(); ...&#125; Messageå¯¹è±¡å¦‚ä½•å…¥é˜Ÿæˆ‘ä»¬æ˜ç™½äº†MessageQueueæ¶ˆæ¯é˜Ÿåˆ—å¯¹è±¡æ˜¯æ¥è‡ªäºThreadLocalçº¿ç¨‹æœ¬åœ°å­˜å‚¨åŒºå­˜å‚¨çš„é‚£ä¸ªå”¯ä¸€çš„Looperå¯¹è±¡ã€‚æˆ‘ä»¬æ¥ç€çœ‹Handleråœ¨å‘é€æ¶ˆæ¯çš„æœ€åè°ƒç”¨çš„enqueueMessage()æ–¹æ³•ï¼Œçœ‹åå­—åº”è¯¥æ˜¯æŠŠæ¶ˆæ¯åŠ å…¥é˜Ÿåˆ—çš„æ„æ€ï¼Œç‚¹è¿›å»çœ‹ä¸‹ï¼š 1234567private boolean enqueueMessage(MessageQueue queue, Message msg, long uptimeMillis) &#123; msg.target = this; //æ³¨æ„æ­¤å¤„HandleræŠŠè‡ªå·±thisèµ‹å€¼ç»™äº†Messageçš„targetå˜é‡ if (mAsynchronous) &#123; msg.setAsynchronous(true); &#125; return queue.enqueueMessage(msg, uptimeMillis);&#125; æˆ‘ä»¬çœ‹åˆ°msgçš„targetçš„èµ‹å€¼æ˜¯Handlerè‡ªå·±ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªmsgå®ä¾‹å¯¹è±¡ç°åœ¨æŒæœ‰äº†ä¸»çº¿ç¨‹ä¸­mHandlerè¿™ä¸ªå¯¹è±¡ã€‚æ³¨æ„è¿™é‡Œï¼Œæˆ‘ä»¬ç¨åä¼šè®²åˆ°msgæŒæœ‰è¿™ä¸ªmHandlerå¯¹è±¡çš„ç”¨é€”ã€‚æœ€åè°ƒç”¨äº†MessageQueueç±»çš„enqueueMessage()æ–¹æ³•åŠ å…¥åˆ°äº†æ¶ˆæ¯é˜Ÿåˆ—ã€‚ çœ‹æ¥çœŸæ­£çš„å…¥é˜Ÿæ–¹æ³•äº¤ç»™äº†MessageQueueï¼Œè¿™ä¸ªenqueueMessage()æ–¹æ³•è¾ƒé•¿ï¼Œæˆ‘ä»¬ç°åœ¨ç»§ç»­è¿›å…¥çœ‹çœ‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152boolean enqueueMessage(Message msg, long when) &#123; if (msg.target == null) &#123; //è¿™é‡Œè¦æ±‚æ¶ˆæ¯å¿…é¡»è·Ÿ Handler å…³è” throw new IllegalArgumentException(\"Message must have a target.\"); &#125; if (msg.isInUse()) &#123; throw new IllegalStateException(msg + \" This message is already in use.\"); &#125; synchronized (this) &#123; if (mQuitting) &#123; //å¦‚æœæ¶ˆæ¯é˜Ÿåˆ—å·²ç»é€€å‡ºï¼Œè¿˜å…¥é˜Ÿå°±æŠ¥é”™ IllegalStateException e = new IllegalStateException( msg.target + \" sending message to a Handler on a dead thread\"); Log.w(TAG, e.getMessage(), e); msg.recycle(); return false; &#125; msg.markInUse(); //æ¶ˆæ¯å…¥é˜Ÿåå°±æ ‡è®°ä¸º åœ¨è¢«ä½¿ç”¨ msg.when = when; Message p = mMessages; boolean needWake; //æ·»åŠ æ¶ˆæ¯åˆ°é“¾è¡¨ä¸­ if (p == null || when == 0 || when &lt; p.when) &#123; //ä¹‹å‰æ˜¯ç©ºé“¾è¡¨çš„æ—¶å€™è¯»å–æ¶ˆæ¯ä¼šé˜»å¡ï¼Œæ–°æ·»åŠ æ¶ˆæ¯åå”¤é†’ msg.next = p; mMessages = msg; needWake = mBlocked; &#125; else &#123; //æ’å…¥æ¶ˆæ¯åˆ°é˜Ÿåˆ—æ—¶ï¼Œåªæœ‰åœ¨é˜Ÿåˆ—å¤´éƒ¨æœ‰ä¸ªå±éšœå¹¶ä¸”å½“å‰æ¶ˆæ¯æ˜¯å¼‚æ­¥çš„æ—¶æ‰éœ€è¦å”¤é†’é˜Ÿåˆ— needWake = mBlocked &amp;&amp; p.target == null &amp;&amp; msg.isAsynchronous(); Message prev; for (;;) &#123; prev = p; p = p.next; if (p == null || when &lt; p.when) &#123; break; &#125; if (needWake &amp;&amp; p.isAsynchronous()) &#123; needWake = false; &#125; &#125; msg.next = p; // invariant: p == prev.next prev.next = msg; &#125; // We can assume mPtr != 0 because mQuitting is false. if (needWake) &#123; nativeWake(mPtr); &#125; &#125; return true;&#125; å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ— é™å¾ªç¯å°†æ¶ˆæ¯åŠ å…¥åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼ˆé“¾è¡¨çš„å½¢å¼ï¼‰ï¼Œä½†æ˜¯æœ‰æ”¾å°±æœ‰æ‹¿ï¼Œè¿™ä¸ªæ¶ˆæ¯æ€æ ·æŠŠå®ƒå–å‡ºæ¥å‘¢ï¼Ÿ ç¿»çœ‹MessageQueueçš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†next()æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å‡ºé˜Ÿæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä»£ç å¤ªé•¿ï¼Œå¯ä»¥ä¸ç”¨ç»†çœ‹æˆ‘ä»¬çŸ¥é“å®ƒæ˜¯ç”¨æ¥æŠŠæ¶ˆæ¯å–å‡ºæ¥çš„å°±è¡Œäº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899Message next() &#123; //å¦‚æœæ¶ˆæ¯çš„ looper é€€å‡ºï¼Œå°±é€€å‡ºè¿™ä¸ªæ–¹æ³• final long ptr = mPtr; if (ptr == 0) &#123; return null; &#125; int pendingIdleHandlerCount = -1; // -1 only during first iteration int nextPollTimeoutMillis = 0; //ä¹Ÿæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œæœ‰åˆé€‚çš„æ¶ˆæ¯å°±è¿”å›ï¼Œæ²¡æœ‰å°±é˜»å¡ for (;;) &#123; if (nextPollTimeoutMillis != 0) &#123; //å¦‚æœæœ‰éœ€è¦è¿‡æ®µæ—¶é—´å†å¤„ç†çš„æ¶ˆæ¯ï¼Œå…ˆè°ƒç”¨ Binder çš„è¿™ä¸ªæ–¹æ³• Binder.flushPendingCommands(); &#125; nativePollOnce(ptr, nextPollTimeoutMillis); synchronized (this) &#123; //è·å–ä¸‹ä¸€ä¸ªæ¶ˆæ¯ final long now = SystemClock.uptimeMillis(); Message prevMsg = null; Message msg = mMessages; //å½“å‰é“¾è¡¨çš„å¤´ç»“ç‚¹ if (msg != null &amp;&amp; msg.target == null) &#123; //å¦‚æœæ¶ˆæ¯æ²¡æœ‰ targetï¼Œé‚£å®ƒå°±æ˜¯ä¸€ä¸ªå±éšœï¼Œéœ€è¦ä¸€ç›´å¾€åéå†æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¼‚æ­¥çš„æ¶ˆæ¯ do &#123; prevMsg = msg; msg = msg.next; &#125; while (msg != null &amp;&amp; !msg.isAsynchronous()); &#125; if (msg != null) &#123; if (now &lt; msg.when) &#123; //å¦‚æœè¿™ä¸ªæ¶ˆæ¯è¿˜æ²¡åˆ°å¤„ç†æ—¶é—´ï¼Œå°±è®¾ç½®ä¸ªæ—¶é—´è¿‡æ®µæ—¶é—´å†å¤„ç† nextPollTimeoutMillis = (int) Math.min(msg.when - now, Integer.MAX_VALUE); &#125; else &#123; // æ¶ˆæ¯æ˜¯æ­£å¸¸çš„ã€å¯ä»¥ç«‹å³å¤„ç†çš„ mBlocked = false; //å–å‡ºå½“å‰æ¶ˆæ¯ï¼Œé“¾è¡¨å¤´ç»“ç‚¹åç§»ä¸€ä½ if (prevMsg != null) &#123; prevMsg.next = msg.next; &#125; else &#123; mMessages = msg.next; &#125; msg.next = null; if (DEBUG) Log.v(TAG, \"Returning message: \" + msg); msg.markInUse(); //æ ‡è®°è¿™ä¸ªæ¶ˆæ¯åœ¨è¢«ä½¿ç”¨ return msg; &#125; &#125; else &#123; // æ¶ˆæ¯é“¾è¡¨é‡Œæ²¡æœ‰æ¶ˆæ¯äº† nextPollTimeoutMillis = -1; &#125; //å¦‚æœæ”¶åˆ°é€€å‡ºçš„æ¶ˆæ¯ï¼Œå¹¶ä¸”æ‰€æœ‰ç­‰å¾…å¤„ç†çš„æ¶ˆæ¯éƒ½å¤„ç†å®Œæ—¶ï¼Œè°ƒç”¨ Native æ–¹æ³•é”€æ¯é˜Ÿåˆ— if (mQuitting) &#123; dispose(); return null; &#125; //æœ‰æ¶ˆæ¯ç­‰å¾…è¿‡æ®µæ—¶é—´æ‰§è¡Œæ—¶ï¼ŒpendingIdleHandlerCount å¢åŠ  if (pendingIdleHandlerCount &lt; 0 &amp;&amp; (mMessages == null || now &lt; mMessages.when)) &#123; pendingIdleHandlerCount = mIdleHandlers.size(); &#125; if (pendingIdleHandlerCount &lt;= 0) &#123; mBlocked = true; continue; &#125; if (mPendingIdleHandlers == null) &#123; mPendingIdleHandlers = new IdleHandler[Math.max(pendingIdleHandlerCount, 4)]; &#125; mPendingIdleHandlers = mIdleHandlers.toArray(mPendingIdleHandlers); &#125; for (int i = 0; i &lt; pendingIdleHandlerCount; i++) &#123; final IdleHandler idler = mPendingIdleHandlers[i]; mPendingIdleHandlers[i] = null; // release the reference to the handler boolean keep = false; try &#123; keep = idler.queueIdle(); &#125; catch (Throwable t) &#123; Log.wtf(TAG, \"IdleHandler threw exception\", t); &#125; if (!keep) &#123; synchronized (this) &#123; mIdleHandlers.remove(idler); &#125; &#125; &#125; // Reset the idle handler count to 0 so we do not run them again. pendingIdleHandlerCount = 0; // While calling an idle handler, a new message could have been delivered // so go back and look again for a pending message without waiting. nextPollTimeoutMillis = 0; &#125;&#125; å¯ä»¥çœ‹åˆ°ï¼ŒMessageQueue.next() æ–¹æ³•é‡Œæœ‰ä¸€ä¸ªå¾ªç¯ï¼Œåœ¨è¿™ä¸ªå¾ªç¯ä¸­éå†æ¶ˆæ¯é“¾è¡¨ï¼Œæ‰¾åˆ°ä¸‹ä¸€ä¸ªå¯ä»¥å¤„ç†çš„ã€target ä¸ä¸ºç©ºçš„æ¶ˆæ¯å¹¶ä¸”æ‰§è¡Œæ—¶é—´ä¸åœ¨æœªæ¥çš„æ¶ˆæ¯ï¼Œå°±è¿”å›ï¼Œå¦åˆ™å°±ç»§ç»­å¾€åæ‰¾ã€‚ å¦‚æœæœ‰é˜»å¡ï¼ˆæ²¡æœ‰æ¶ˆæ¯äº†æˆ–è€…åªæœ‰ Delay çš„æ¶ˆæ¯ï¼‰ï¼Œä¼šæŠŠ mBlockedè¿™ä¸ªå˜é‡æ ‡è®°ä¸º trueï¼Œåœ¨ä¸‹ä¸€ä¸ª Message è¿›é˜Ÿæ—¶ä¼šåˆ¤æ–­è¿™ä¸ªmessage çš„ä½ç½®ï¼Œå¦‚æœåœ¨é˜Ÿé¦–å°±ä¼šè°ƒç”¨nativeWake() æ–¹æ³•å”¤é†’çº¿ç¨‹ï¼ ä¸è¿‡MessageQueue.next() è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ä»€ä¹ˆåœ°æ–¹è°ƒç”¨çš„å‘¢ï¼Œä¸æ˜¯åœ¨Handlerä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†Looperè¿™ä¸ªå…³é”®äººç‰©ï¼Œä¸“é—¨è´Ÿè´£ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ‹¿æ¶ˆæ¯ã€‚ Looperå¦‚ä½•å¤„ç†Messageæˆ‘ä»¬åˆæ¥åˆ°äº†Looperçš„é˜µåœ°ï¼Œä»–åœ¨è°ƒç”¨MessageQueueçš„next()æ–¹æ³•ï¼Œæ¥ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ‹¿Messageå¯¹è±¡ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233/** * Run the message queue in this thread. Be sure to call * &#123;@link #quit()&#125; to end the loop. */public static void loop() &#123; final Looper me = myLooper(); if (me == null) &#123; //å½“å‰çº¿ç¨‹å¿…é¡»åˆ›å»º Looper æ‰å¯ä»¥æ‰§è¡Œ throw new RuntimeException(\"No Looper; Looper.prepare() wasn't called on this thread.\"); &#125; final MessageQueue queue = me.mQueue; //åº•å±‚å¯¹ IPC æ ‡è¯†çš„å¤„ç†ï¼Œä¸ç”¨å…³å¿ƒ Binder.clearCallingIdentity(); final long ident = Binder.clearCallingIdentity(); for (;;) &#123; //æ— é™å¾ªç¯æ¨¡å¼ Message msg = queue.next(); //ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¯»å–æ¶ˆæ¯ï¼Œå¯èƒ½ä¼šé˜»å¡ if (msg == null) &#123; //å½“æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ²¡æœ‰æ¶ˆæ¯æ—¶å°±ä¼šè¿”å›ï¼Œä¸è¿‡è¿™åªå‘ç”Ÿåœ¨ queue é€€å‡ºçš„æ—¶å€™ return; &#125; //... try &#123; msg.target.dispatchMessage(msg); //è°ƒç”¨æ¶ˆæ¯å…³è”çš„ Handler å¤„ç†æ¶ˆæ¯ &#125; finally &#123; if (traceTag != 0) &#123; Trace.traceEnd(traceTag); &#125; &#125; //... msg.recycleUnchecked(); //æ ‡è®°è¿™ä¸ªæ¶ˆæ¯è¢«å›æ”¶ &#125;&#125; å¯ä»¥çœ‹åˆ°ï¼ŒLooper.loop() ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯è°ƒç”¨æ¶ˆæ¯é˜Ÿåˆ— MessageQueue.next() æ–¹æ³•å–æ¶ˆæ¯ï¼Œå¦‚æœæ²¡æœ‰æ¶ˆæ¯çš„è¯ä¼šé˜»å¡ï¼Œç›´åˆ°æœ‰æ–°çš„æ¶ˆæ¯è¿›å…¥æˆ–è€…æ¶ˆæ¯é˜Ÿåˆ—é€€å‡ºã€‚ä¹Ÿå°±æ˜¯ä¸æ–­é‡å¤ä¸‹é¢çš„æ“ä½œï¼Œç›´åˆ°æ²¡æœ‰æ¶ˆæ¯æ—¶é€€å‡ºå¾ªç¯ è¯»å–MessageQueueçš„ä¸‹ä¸€æ¡Messageï¼› æŠŠMessageåˆ†å‘ç»™ç›¸åº”çš„targetï¼› å†æŠŠåˆ†å‘åçš„Messageå›æ”¶åˆ°æ¶ˆæ¯æ± ï¼Œä»¥ä¾¿é‡å¤åˆ©ç”¨ã€‚ æ‹¿åˆ°æ¶ˆæ¯åè°ƒç”¨msg.targetçš„dispatchMessage(msg)æ–¹æ³•ï¼Œè€Œè¿™ä¸ªmsg.targetæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå°±æ˜¯å‰é¢Handlerå‘é€æ¶ˆæ¯sendMessageAtTime()æ—¶æŠŠè‡ªå·±èµ‹å€¼ç»™msg.targetçš„ä¸»çº¿ç¨‹çš„mHandlerå¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€åè¿˜æ˜¯ Handler è´Ÿè´£å¤„ç†æ¶ˆæ¯ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒLooper å¹¶æ²¡æœ‰æ‰§è¡Œæ¶ˆæ¯ï¼ŒçœŸæ­£æ‰§è¡Œæ¶ˆæ¯çš„è¿˜æ˜¯æ·»åŠ æ¶ˆæ¯åˆ°é˜Ÿåˆ—ä¸­çš„é‚£ä¸ª Handlerã€‚ æ‰€ä»¥æˆ‘ä»¬æ¥çœ‹Handlerä¸­çš„dispatchMessage(msg)æ–¹æ³•ï¼š 12345678910111213141516171819202122/** * Handle system messages here. */public void dispatchMessage(Message msg) &#123; if (msg.callback != null) &#123; handleCallback(msg); &#125; else &#123; if (mCallback != null) &#123; if (mCallback.handleMessage(msg)) &#123; return; &#125; &#125; handleMessage(msg); &#125;&#125;private static void handleCallback(Message message) &#123; message.callback.run();&#125;public void handleMessage(Message msg) &#123;&#125; å¯ä»¥çœ‹åˆ°ï¼ŒHandler åœ¨å¤„ç†æ¶ˆæ¯æ—¶ï¼Œä¼šæœ‰ä¸‰ç§æƒ…å†µï¼š msg.callback ä¸ä¸ºç©º è¿™åœ¨ä½¿ç”¨ Handler.postXXX(Runnable) å‘é€æ¶ˆæ¯çš„æ—¶å€™ä¼šå‘ç”Ÿ è¿™å°±ç›´æ¥è°ƒç”¨ Runnable çš„ run() æ–¹æ³• mCallback ä¸ä¸ºç©º è¿™åœ¨æˆ‘ä»¬ä½¿ç”¨å‰é¢ä»‹ç»çš„ Handler.Callback ä¸ºå‚æ•°æ„é€  Handler æ—¶ä¼šå‘ç”Ÿ é‚£å°±è°ƒç”¨æ„é€ å‡½æ•°é‡Œä¼ å…¥çš„ handleMessage() æ–¹æ³• å¦‚æœè¿”å› trueï¼Œé‚£å°±ä¸å¾€ä¸‹èµ°äº† æœ€åå°±è°ƒç”¨Handler.handleMessage() æ–¹æ³• è¿™æ˜¯ä¸€ä¸ªç©ºå®ç°ï¼Œéœ€è¦æˆ‘ä»¬åœ¨ Handler å­ç±»é‡Œé‡å†™ è€Œæˆ‘ä»¬å¼€å¤´çš„ä¾‹å­ï¼Œä½¿ç”¨çš„å°±æ˜¯ç¬¬3ç§æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥å›é¡¾ä¸€ä¸‹ã€‚ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„ç–‘é—®åŸºæœ¬ä¸Šå°±è§£å†³äº†ï¼Œè™½ç„¶æ²¡æœ‰å†æ·±å…¥åˆ°jniå±‚çœ‹nativeåº•å±‚å®ç°ï¼Œä½†æ˜¯javaå±‚çš„æœºåˆ¶æˆ‘ä»¬å¤§æ¦‚æ˜ç™½äº†ã€‚æœ€åæˆ‘ä»¬å¯¹ä¸Šé¢çš„æºç è·Ÿè¸ªåˆ†æåšä¸€ä¸ªå®è§‚ä¸Šçš„æ€»ç»“ã€‚ æ•´ä½“è¿è¡Œæœºåˆ¶å››å¤§ä¸»è§’ä¸Windowsç³»ç»Ÿä¸€æ ·ï¼ŒAndroidä¹Ÿæ˜¯æ¶ˆæ¯é©±åŠ¨å‹çš„ç³»ç»Ÿã€‚å¼•ç”¨ä¸€ä¸‹æ¶ˆæ¯é©±åŠ¨æœºåˆ¶çš„å››è¦ç´ ï¼š æ¥æ”¶æ¶ˆæ¯çš„â€œæ¶ˆæ¯é˜Ÿåˆ—â€ é˜»å¡å¼åœ°ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†çš„â€œçº¿ç¨‹â€ å¯å‘é€çš„â€œæ¶ˆæ¯çš„æ ¼å¼â€ â€œæ¶ˆæ¯å‘é€å‡½æ•°â€ ä¸ä¹‹å¯¹åº”ï¼ŒAndroidä¸­çš„å®ç°å¯¹åº”äº† æ¥æ”¶æ¶ˆæ¯çš„â€œæ¶ˆæ¯é˜Ÿåˆ—â€ â€”â€”ã€MessageQueueã€‘ é˜»å¡å¼åœ°ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†çš„â€œçº¿ç¨‹â€ â€”â€”ã€Thread+Looperã€‘ å¯å‘é€çš„â€œæ¶ˆæ¯çš„æ ¼å¼â€ â€”â€”ã€Messageã€‘ â€œæ¶ˆæ¯å‘é€å‡½æ•°â€â€”â€”ã€Handlerçš„postå’ŒsendMessageã€‘ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¶ˆæ¯æœºåˆ¶ä¸»è¦åŒ…å«ä»¥ä¸‹å››ä¸ªä¸»è§’ï¼š Messageï¼šæ¶ˆæ¯åˆ†ä¸ºç¡¬ä»¶äº§ç”Ÿçš„æ¶ˆæ¯ï¼ˆå¦‚æŒ‰é’®ã€è§¦æ‘¸ï¼‰å’Œè½¯ä»¶ç”Ÿæˆçš„æ¶ˆæ¯ï¼› MessageQueueï¼šæ¶ˆæ¯é˜Ÿåˆ—çš„ä¸»è¦åŠŸèƒ½å‘æ¶ˆæ¯æ± æŠ•é€’æ¶ˆæ¯ï¼ˆMessageQueue.enqueueMessage()ï¼‰å’Œå–èµ°æ¶ˆæ¯æ± çš„æ¶ˆæ¯ï¼ˆMessageQueue.next()ï¼‰ï¼› Handlerï¼šæ¶ˆæ¯è¾…åŠ©ç±»ï¼Œä¸»è¦åŠŸèƒ½å‘æ¶ˆæ¯æ± å‘é€å„ç§æ¶ˆæ¯äº‹ä»¶ï¼ˆHandler.sendMessage()ï¼‰å’Œå¤„ç†ç›¸åº”æ¶ˆæ¯äº‹ä»¶ï¼ˆHandler.handleMessage()ï¼‰ï¼› Looperï¼šä¸æ–­å¾ªç¯æ‰§è¡Œï¼ˆLooper.loop()ï¼‰ï¼ŒæŒ‰åˆ†å‘æœºåˆ¶å°†æ¶ˆæ¯åˆ†å‘ç»™ç›®æ ‡å¤„ç†è€…ã€‚ ä»–ä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š Threadï¼šä¸€ä¸ªçº¿ç¨‹æœ‰å”¯ä¸€ä¸€ä¸ªå¯¹åº”çš„Looperï¼› Looperï¼šæœ‰ä¸€ä¸ªMessageQueueæ¶ˆæ¯é˜Ÿåˆ—ï¼› MessageQueueï¼šæœ‰ä¸€ç»„å¾…å¤„ç†çš„Messageï¼› Messageä¸­æœ‰ä¸€ä¸ªç”¨äºå¤„ç†æ¶ˆæ¯çš„Handlerï¼› Handlerä¸­æœ‰Looperå’ŒMessageQueueã€‚ æµç¨‹å›¾ ä¸€ä¸ªLooperç±»ä¼¼ä¸€ä¸ªæ¶ˆæ¯æ³µã€‚å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œä¸æ–­åœ°ä»MessageQueueä¸­æå–Messageæˆ–è€…Runnableã€‚è€ŒHandlerå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªLooperçš„æš´éœ²æ¥å£ï¼Œå‘å¤–éƒ¨æš´éœ²ä¸€äº›äº‹ä»¶ï¼Œå¹¶æš´éœ²sendMessage()å’Œpost()å‡½æ•°ã€‚ åœ¨å®‰å“ä¸­ï¼Œé™¤äº†UIçº¿ç¨‹/ä¸»çº¿ç¨‹ä»¥å¤–ï¼Œæ™®é€šçš„çº¿ç¨‹(å…ˆä¸æHandlerThread)æ˜¯ä¸è‡ªå¸¦Looperçš„ã€‚æƒ³è¦é€šè¿‡UIçº¿ç¨‹ä¸å­çº¿ç¨‹é€šä¿¡éœ€è¦åœ¨å­çº¿ç¨‹å†…è‡ªå·±å®ç°ä¸€ä¸ªLooperã€‚å¼€å¯Looperåˆ†ä¸‰æ­¥èµ°ï¼š åˆ¤å®šæ˜¯å¦å·²æœ‰Looperå¹¶Looper.prepare() åšä¸€äº›å‡†å¤‡å·¥ä½œ(å¦‚æš´éœ²handlerç­‰) è°ƒç”¨Looper.loop()ï¼Œçº¿ç¨‹è¿›å…¥é˜»å¡æ€ ç”±äºæ¯ä¸€ä¸ªçº¿ç¨‹å†…æœ€å¤šåªå¯ä»¥æœ‰ä¸€ä¸ªLooperï¼Œæ‰€ä»¥ä¸€å®šè¦åœ¨Looper.prepare()ä¹‹å‰åšå¥½åˆ¤å®šï¼Œå¦åˆ™ä¼šæŠ›å‡ºjava.lang.RuntimeException: Only one Looper may be created per threadã€‚ä¸ºäº†è·å–Looperçš„ä¿¡æ¯å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæ–¹æ³•ï¼š Looper.myLooper() Looper.getMainLooper() Looper.myLooper()è·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„Looperï¼Œå¦‚æœæ²¡æœ‰è¿”å›nullã€‚Looper.getMainLooper()è¿”å›ä¸»çº¿ç¨‹çš„Looper,è¿™æ ·å°±å¯ä»¥æ–¹ä¾¿çš„ä¸ä¸»çº¿ç¨‹é€šä¿¡ã€‚ æ€»ç»“ Looperè°ƒç”¨prepare()è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ›å»ºäº†ä¸€ä¸ªä¸å½“å‰çº¿ç¨‹å¯¹åº”çš„Looperå¯¹è±¡ï¼ˆé€šè¿‡ThreadLocalå®ç°ï¼‰ï¼Œå¹¶ä¸”åˆå§‹åŒ–äº†ä¸€ä¸ªä¸å½“å‰Looperå¯¹åº”çš„MessageQueueå¯¹è±¡ã€‚ Looperè°ƒç”¨é™æ€æ–¹æ³•loop()å¼€å§‹æ¶ˆæ¯å¾ªç¯ï¼Œé€šè¿‡MessageQueue.next()æ–¹æ³•è·å–Messageå¯¹è±¡ã€‚ å½“è·å–åˆ°ä¸€ä¸ªMessageå¯¹è±¡æ—¶ï¼Œè®©Messageçš„å‘é€è€…ï¼ˆtargetï¼‰å»å¤„ç†å®ƒã€‚ Messageå¯¹è±¡åŒ…æ‹¬æ•°æ®ï¼Œå‘é€è€…ï¼ˆHandlerï¼‰ï¼Œå¯æ‰§è¡Œä»£ç æ®µï¼ˆRunnableï¼‰ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆã€‚ Handlerå¯ä»¥åœ¨ä¸€ä¸ªå·²ç»Looper.prepare()çš„çº¿ç¨‹ä¸­åˆå§‹åŒ–ï¼Œå¦‚æœçº¿ç¨‹æ²¡æœ‰åˆå§‹åŒ–Looperï¼Œåˆ›å»ºHandlerå¯¹è±¡ä¼šå¤±è´¥ ä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œæµä¸­å¯ä»¥æ„é€ å¤šä¸ªHandlerå¯¹è±¡ï¼Œå®ƒä»¬éƒ½å¾€åŒä¸€ä¸ªMQä¸­å‘æ¶ˆæ¯ï¼Œæ¶ˆæ¯ä¹Ÿåªä¼šåˆ†å‘ç»™å¯¹åº”çš„Handlerå¤„ç†ã€‚ Handlerå°†æ¶ˆæ¯å‘é€åˆ°MQä¸­ï¼ŒMessageçš„targetåŸŸä¼šå¼•ç”¨è‡ªå·±çš„å‘é€è€…ï¼ŒLooperä»MQä¸­å–å‡ºæ¥åï¼Œå†äº¤ç»™å‘é€è¿™ä¸ªMessageçš„Handlerå»å¤„ç†ã€‚ Messageå¯ä»¥ç›´æ¥æ·»åŠ ä¸€ä¸ªRunnableå¯¹è±¡ï¼Œå½“è¿™æ¡æ¶ˆæ¯è¢«å¤„ç†çš„æ—¶å€™ï¼Œç›´æ¥æ‰§è¡ŒRunnable.run()æ–¹æ³•ã€‚ Handlerçš„å†…å­˜æ³„éœ²é—®é¢˜å†æ¥çœ‹çœ‹æˆ‘ä»¬çš„æ–°å»ºHandlerçš„ä»£ç ï¼š 123456private Handler mHandler = new Handler() &#123; @Override public void handleMessage(Message msg) &#123; ... &#125;&#125;; å½“ä½¿ç”¨å†…éƒ¨ç±»ï¼ˆåŒ…æ‹¬åŒ¿åç±»ï¼‰æ¥åˆ›å»ºHandlerçš„æ—¶å€™ï¼ŒHandlerå¯¹è±¡ä¼šéšå¼åœ°æŒæœ‰Activityçš„å¼•ç”¨ã€‚ è€ŒHandleré€šå¸¸ä¼šä¼´éšç€ä¸€ä¸ªè€—æ—¶çš„åå°çº¿ç¨‹ä¸€èµ·å‡ºç°ï¼Œè¿™ä¸ªåå°çº¿ç¨‹åœ¨ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åå‘é€æ¶ˆæ¯å»æ›´æ–°UIã€‚ç„¶è€Œï¼Œå¦‚æœç”¨æˆ·åœ¨ç½‘ç»œè¯·æ±‚è¿‡ç¨‹ä¸­å…³é—­äº†Activityï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼ŒActivityä¸å†è¢«ä½¿ç”¨ï¼Œå®ƒå°±æœ‰å¯èƒ½åœ¨GCæ£€æŸ¥æ—¶è¢«å›æ”¶æ‰ï¼Œä½†ç”±äºè¿™æ—¶çº¿ç¨‹å°šæœªæ‰§è¡Œå®Œï¼Œè€Œè¯¥çº¿ç¨‹æŒæœ‰Handlerçš„å¼•ç”¨ï¼ˆä¸ç„¶å®ƒæ€ä¹ˆå‘æ¶ˆæ¯ç»™Handlerï¼Ÿï¼‰ï¼Œè¿™ä¸ªHandleråˆæŒæœ‰Activityçš„å¼•ç”¨ï¼Œå°±å¯¼è‡´è¯¥Activityæ— æ³•è¢«å›æ”¶ï¼ˆå³å†…å­˜æ³„éœ²ï¼‰ï¼Œç›´åˆ°ç½‘ç»œè¯·æ±‚ç»“æŸã€‚ å¦å¤–ï¼Œå¦‚æœæ‰§è¡Œäº†Handlerçš„postDelayed()æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨è®¾å®šçš„delayåˆ°è¾¾ä¹‹å‰ï¼Œä¼šæœ‰ä¸€æ¡MessageQueue -&gt; Message -&gt; Handler -&gt; Activityçš„é“¾ï¼Œå¯¼è‡´ä½ çš„Activityè¢«æŒæœ‰å¼•ç”¨è€Œæ— æ³•è¢«å›æ”¶ã€‚ è§£å†³æ–¹æ³•ä¹‹ä¸€ï¼Œä½¿ç”¨å¼±å¼•ç”¨ï¼š 12345678910111213static class MyHandler extends Handler &#123; WeakReference&lt;Activity &gt; mActivityReference; MyHandler(Activity activity) &#123; mActivityReference= new WeakReference&lt;Activity&gt;(activity); &#125; @Override public void handleMessage(Message msg) &#123; final Activity activity = mActivityReference.get(); if (activity != null) &#123; mImageView.setImageBitmap(mBitmap); &#125; &#125;&#125; ä»JDK1.2å¼€å§‹ï¼ŒJavaæŠŠå¯¹è±¡çš„å¼•ç”¨åˆ†ä¸ºå››ç§çº§åˆ«ï¼Œè¿™å››ç§çº§åˆ«ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼šå¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨å’Œè™šå¼•ç”¨ã€‚ å¼ºå¼•ç”¨ï¼šæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„å°±æ˜¯å¼ºå¼•ç”¨ï¼Œåƒåœ¾å›æ”¶å™¨ä¸€èˆ¬éƒ½ä¸ä¼šå¯¹å…¶è¿›è¡Œå›æ”¶æ“ä½œã€‚å½“å†…å­˜ç©ºé—´ä¸è¶³æ—¶Javaè™šæ‹Ÿæœºå®æ„¿æŠ›å‡ºOutOfMemoryErroré”™è¯¯ä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ï¼Œä¹Ÿä¸ä¼šå›æ”¶å…·æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡ã€‚ è½¯å¼•ç”¨(SoftReference)ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰è½¯å¼•ç”¨(SoftReference)ï¼Œåœ¨å†…å­˜ç©ºé—´è¶³å¤Ÿçš„æ—¶å€™GCä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸è¶³äº†GCå°±ä¼šå›æ”¶è¿™äº›å¯¹è±¡çš„å†…å­˜ç©ºé—´ã€‚ å¼±å¼•ç”¨(WeakReference) ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼±å¼•ç”¨(WeakReference)ï¼Œé‚£ä¹ˆå½“GCçº¿ç¨‹æ‰«æçš„è¿‡ç¨‹ä¸­ä¸€æ—¦å‘ç°æŸä¸ªå¯¹è±¡åªå…·æœ‰å¼±å¼•ç”¨è€Œä¸å­˜åœ¨å¼ºå¼•ç”¨æ—¶ä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦GCéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§è¾ƒä½çš„çº¿ç¨‹ï¼Œæ‰€ä»¥ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚ä¸ºäº†é˜²æ­¢å†…å­˜æº¢å‡ºï¼Œåœ¨å¤„ç†ä¸€äº›å ç”¨å†…å­˜å¤§è€Œä¸”ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡æ—¶å€™ï¼Œå¯ä»¥å°½é‡ä½¿ç”¨è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨ã€‚ è™šå¼•ç”¨(PhantomReference) ï¼šè™šå¼•ç”¨(PhantomReference)ä¸å…¶ä»–ä¸‰ç§å¼•ç”¨éƒ½ä¸åŒï¼Œå®ƒå¹¶ä¸ä¼šå†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚æ‰€ä»¥ï¼Œè™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ´»åŠ¨ï¼Œåœ¨ä¸€èˆ¬çš„å¼€å‘ä¸­å¹¶ä¸ä¼šä½¿ç”¨å®ƒã€‚ è¿›ç¨‹ã€çº¿ç¨‹é—´é€šä¿¡æ–¹å¼æ–‡ç« æœ€åï¼Œæˆ‘ä»¬æ¥æ•´ç†ä¸€ä¸‹è¿›ç¨‹ã€çº¿ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œå‚è€ƒçº¿ç¨‹é€šä¿¡ä¸è¿›ç¨‹é€šä¿¡çš„åŒºåˆ«ã€‚çœ‹çœ‹Handleræ¶ˆæ¯ä¼ é€’æœºåˆ¶å±äºå“ªç§ï¼Ÿ ä¸€ã€è¿›ç¨‹é—´çš„é€šä¿¡æ–¹å¼ ç®¡é“( pipe )ï¼šç®¡é“æ˜¯ä¸€ç§åŠåŒå·¥çš„é€šä¿¡æ–¹å¼ï¼Œæ•°æ®åªèƒ½å•å‘æµåŠ¨ï¼Œè€Œä¸”åªèƒ½åœ¨å…·æœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹é—´ä½¿ç”¨ã€‚è¿›ç¨‹çš„äº²ç¼˜å…³ç³»é€šå¸¸æ˜¯æŒ‡çˆ¶å­è¿›ç¨‹å…³ç³»ã€‚ æœ‰åç®¡é“ (namedpipe) ï¼š æœ‰åç®¡é“ä¹Ÿæ˜¯åŠåŒå·¥çš„é€šä¿¡æ–¹å¼ï¼Œä½†æ˜¯å®ƒå…è®¸æ— äº²ç¼˜å…³ç³»è¿›ç¨‹é—´çš„é€šä¿¡ã€‚ ä¿¡å·é‡(semophore ) ï¼š ä¿¡å·é‡æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶å¤šä¸ªè¿›ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚å®ƒå¸¸ä½œä¸ºä¸€ç§é”æœºåˆ¶ï¼Œé˜²æ­¢æŸè¿›ç¨‹æ­£åœ¨è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œå…¶ä»–è¿›ç¨‹ä¹Ÿè®¿é—®è¯¥èµ„æºã€‚å› æ­¤ï¼Œä¸»è¦ä½œä¸ºè¿›ç¨‹é—´ä»¥åŠåŒä¸€è¿›ç¨‹å†…ä¸åŒçº¿ç¨‹ä¹‹é—´çš„åŒæ­¥æ‰‹æ®µã€‚ æ¶ˆæ¯é˜Ÿåˆ—( messagequeue ) ï¼š æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ç”±æ¶ˆæ¯çš„é“¾è¡¨ï¼Œå­˜æ”¾åœ¨å†…æ ¸ä¸­å¹¶ç”±æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦æ ‡è¯†ã€‚æ¶ˆæ¯é˜Ÿåˆ—å…‹æœäº†ä¿¡å·ä¼ é€’ä¿¡æ¯å°‘ã€ç®¡é“åªèƒ½æ‰¿è½½æ— æ ¼å¼å­—èŠ‚æµä»¥åŠç¼“å†²åŒºå¤§å°å—é™ç­‰ç¼ºç‚¹ã€‚ ä¿¡å· (sinal ) ï¼š ä¿¡å·æ˜¯ä¸€ç§æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥æ”¶è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿã€‚ å…±äº«å†…å­˜(shared memory ) ï¼šå…±äº«å†…å­˜å°±æ˜¯æ˜ å°„ä¸€æ®µèƒ½è¢«å…¶ä»–è¿›ç¨‹æ‰€è®¿é—®çš„å†…å­˜ï¼Œè¿™æ®µå…±äº«å†…å­˜ç”±ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºï¼Œä½†å¤šä¸ªè¿›ç¨‹éƒ½å¯ä»¥è®¿é—®ã€‚å…±äº«å†…å­˜æ˜¯æœ€å¿«çš„ IPC æ–¹å¼ï¼Œå®ƒæ˜¯é’ˆå¯¹å…¶ä»–è¿›ç¨‹é—´é€šä¿¡æ–¹å¼è¿è¡Œæ•ˆç‡ä½è€Œä¸“é—¨è®¾è®¡çš„ã€‚å®ƒå¾€å¾€ä¸å…¶ä»–é€šä¿¡æœºåˆ¶ï¼Œå¦‚ä¿¡å·ä¸¤ï¼Œé…åˆä½¿ç”¨ï¼Œæ¥å®ç°è¿›ç¨‹é—´çš„åŒæ­¥å’Œé€šä¿¡ã€‚ å¥—æ¥å­—(socket ) ï¼š å¥—è§£å£ä¹Ÿæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œä¸å…¶ä»–é€šä¿¡æœºåˆ¶ä¸åŒçš„æ˜¯ï¼Œå®ƒå¯ç”¨äºä¸åŒåŠå…¶é—´çš„è¿›ç¨‹é€šä¿¡ã€‚ IPC æ•°æ®æ‹·è´æ¬¡æ•° å…±äº«å†…å­˜ 0 Android Binder 1 Socket/ç®¡é“/æ¶ˆæ¯é˜Ÿåˆ— 2 äºŒã€çº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼ é”æœºåˆ¶ï¼šåŒ…æ‹¬äº’æ–¥é”ã€æ¡ä»¶å˜é‡ã€è¯»å†™é” äº’æ–¥é”æä¾›äº†ä»¥æ’ä»–æ–¹å¼é˜²æ­¢æ•°æ®ç»“æ„è¢«å¹¶å‘ä¿®æ”¹çš„æ–¹æ³•ã€‚ è¯»å†™é”å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å…±äº«æ•°æ®ï¼Œè€Œå¯¹å†™æ“ä½œæ˜¯äº’æ–¥çš„ã€‚ æ¡ä»¶å˜é‡å¯ä»¥ä»¥åŸå­çš„æ–¹å¼é˜»å¡è¿›ç¨‹ï¼Œç›´åˆ°æŸä¸ªç‰¹å®šæ¡ä»¶ä¸ºçœŸä¸ºæ­¢ã€‚å¯¹æ¡ä»¶çš„æµ‹è¯•æ˜¯åœ¨äº’æ–¥é”çš„ä¿æŠ¤ä¸‹è¿›è¡Œçš„ã€‚æ¡ä»¶å˜é‡å§‹ç»ˆä¸äº’æ–¥é”ä¸€èµ·ä½¿ç”¨ã€‚ ä¿¡å·é‡æœºåˆ¶(Semaphore)ï¼šåŒ…æ‹¬æ— åçº¿ç¨‹ä¿¡å·é‡å’Œå‘½åçº¿ç¨‹ä¿¡å·é‡ ä¿¡å·æœºåˆ¶(Signal)ï¼šç±»ä¼¼è¿›ç¨‹é—´çš„ä¿¡å·å¤„ç† çº¿ç¨‹é—´çš„é€šä¿¡ç›®çš„ä¸»è¦æ˜¯ç”¨äºçº¿ç¨‹åŒæ­¥ï¼Œæ‰€ä»¥çº¿ç¨‹æ²¡æœ‰åƒè¿›ç¨‹é€šä¿¡ä¸­çš„ç”¨äºæ•°æ®äº¤æ¢çš„é€šä¿¡æœºåˆ¶ã€‚ å¾ˆæ˜æ˜¾ï¼ŒAndroidçš„Handleræ¶ˆæ¯æœºåˆ¶ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—( MessageQueue )å®ç°çš„çº¿ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚è€ŒBinderæ˜¯Androidå»ºç«‹é¢ä¸€å¥—æ–°çš„IPCæœºåˆ¶æ¥æ»¡è¶³ç³»ç»Ÿå¯¹é€šä¿¡æ–¹å¼ï¼Œä¼ è¾“æ€§èƒ½å’Œå®‰å…¨æ€§çš„è¦æ±‚ã€‚BinderåŸºäºClient-Serveré€šä¿¡æ¨¡å¼ï¼Œä¼ è¾“è¿‡ç¨‹åªéœ€ä¸€æ¬¡æ‹·è´ï¼Œä¸ºå‘é€æ–¹æ·»åŠ UID/PIDèº«ä»½ï¼Œæ—¢æ”¯æŒå®åBinderä¹Ÿæ”¯æŒåŒ¿åBinderï¼Œå®‰å…¨æ€§é«˜ã€‚æ­¤å¤„å°±ä¸å¯¹Binderä½œæ›´å¤šä»‹ç»äº†ã€‚ å‚è€ƒèµ„æ–™ Androidæ¶ˆæ¯æœºåˆ¶1-Handler(Javaå±‚) ä»Handler.post(Runnable r)å†ä¸€æ¬¡æ¢³ç†Androidçš„æ¶ˆæ¯æœºåˆ¶ Android è¿›é˜¶14ï¼šæºç è§£è¯» Android æ¶ˆæ¯æœºåˆ¶ï¼ˆ Message MessageQueue Handler Looperï¼‰ Androidæºç ï¼šHandler, Looperå’ŒMessageQueueå®ç°è§£æ æ·±å…¥æ¢è®¨Androidå¼‚æ­¥ç²¾é«“Handler Androidæ¶ˆæ¯æœºåˆ¶ å“ˆå·¥å¤§é¢è¯•æŒ‡å¯¼ï¼šAndroidä¸­çš„Thread, Looperå’ŒHandleræœºåˆ¶ Android çº¿ç¨‹æœ¬åœ°å˜é‡&lt;ä¸€&gt; ThreadLocalæºç è§£æ Androidçº¿ç¨‹ç®¡ç†ä¹‹ThreadLocalç†è§£åŠåº”ç”¨åœºæ™¯","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"æºç åˆ†æ","slug":"æºç åˆ†æ","permalink":"http://github.com/tags/æºç åˆ†æ/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘Binder - å¦‚ä½•ä½¿ç”¨AIDL","slug":"ã€Androidã€‘Binder - å¦‚ä½•ä½¿ç”¨AIDL","date":"2017-08-02T14:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/08/02/ã€Androidã€‘Binder - å¦‚ä½•ä½¿ç”¨AIDL/","link":"","permalink":"http://github.com/2017/08/02/ã€Androidã€‘Binder - å¦‚ä½•ä½¿ç”¨AIDL/","excerpt":"ä¸€ã€è·¨è¿›ç¨‹é€šä¿¡ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œå°†Serviceä¸Activityå¤„äºä¸åŒçš„è¿›ç¨‹ï¼Œå¯ä»¥åœ¨AndroidManifest.xmlä¸­ï¼ŒæŠŠserviceé…ç½®æˆandroid:process=&quot;:remote&quot; ï¼Œä¹Ÿå¯ä»¥å‘½åæˆå…¶ä»–çš„ã€‚ AIDLï¼ˆ1ï¼‰ IRemoteService.aidlï¼šå®šä¹‰Serverç«¯æä¾›çš„æœåŠ¡æ¥å£ 12345678910111213// IRemoteService.aidlpackage com.cuc.myandroidtest;import com.cuc.myandroidtest.MyData;import com.cuc.myandroidtest.IServiceCallback;interface IRemoteService &#123; int getPid(); //è·å–æœåŠ¡ç«¯è¿›ç¨‹ID MyData getMyData(); //ä»æœåŠ¡ç«¯è·å–æ•°æ® void registerCallback(IServiceCallback callback); //æ³¨å†ŒæœåŠ¡ç«¯å›è°ƒ void unregisterCallback();&#125; ï¼ˆ2ï¼‰ IServiceCallBack.aidlï¼šå®šä¹‰æœåŠ¡ç«¯å›è°ƒæ¥å£ï¼ŒæŠŠServiceçš„ä¸‹è½½è¿›åº¦é€šçŸ¥ç»™å®¢æˆ·ç«¯ClientActivity 1234567// IServiceCallBack.aidlpackage com.cuc.myandroidtest;interface IServiceCallback &#123; void onDownloadProgress(double progress); //æœåŠ¡ç«¯ä¸‹è½½è¿›åº¦é€šçŸ¥ void onDownloadCompleted(); //ä¸‹è½½å®Œæˆé€šçŸ¥&#125; ï¼ˆ3ï¼‰ MyData.aidlï¼šå®šä¹‰ä¼ è¾“çš„Parcelæ•°æ® 1234// MyData.aidlpackage com.cuc.myandroidtest;parcelable MyData;","text":"ä¸€ã€è·¨è¿›ç¨‹é€šä¿¡ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œå°†Serviceä¸Activityå¤„äºä¸åŒçš„è¿›ç¨‹ï¼Œå¯ä»¥åœ¨AndroidManifest.xmlä¸­ï¼ŒæŠŠserviceé…ç½®æˆandroid:process=&quot;:remote&quot; ï¼Œä¹Ÿå¯ä»¥å‘½åæˆå…¶ä»–çš„ã€‚ AIDLï¼ˆ1ï¼‰ IRemoteService.aidlï¼šå®šä¹‰Serverç«¯æä¾›çš„æœåŠ¡æ¥å£ 12345678910111213// IRemoteService.aidlpackage com.cuc.myandroidtest;import com.cuc.myandroidtest.MyData;import com.cuc.myandroidtest.IServiceCallback;interface IRemoteService &#123; int getPid(); //è·å–æœåŠ¡ç«¯è¿›ç¨‹ID MyData getMyData(); //ä»æœåŠ¡ç«¯è·å–æ•°æ® void registerCallback(IServiceCallback callback); //æ³¨å†ŒæœåŠ¡ç«¯å›è°ƒ void unregisterCallback();&#125; ï¼ˆ2ï¼‰ IServiceCallBack.aidlï¼šå®šä¹‰æœåŠ¡ç«¯å›è°ƒæ¥å£ï¼ŒæŠŠServiceçš„ä¸‹è½½è¿›åº¦é€šçŸ¥ç»™å®¢æˆ·ç«¯ClientActivity 1234567// IServiceCallBack.aidlpackage com.cuc.myandroidtest;interface IServiceCallback &#123; void onDownloadProgress(double progress); //æœåŠ¡ç«¯ä¸‹è½½è¿›åº¦é€šçŸ¥ void onDownloadCompleted(); //ä¸‹è½½å®Œæˆé€šçŸ¥&#125; ï¼ˆ3ï¼‰ MyData.aidlï¼šå®šä¹‰ä¼ è¾“çš„Parcelæ•°æ® 1234// MyData.aidlpackage com.cuc.myandroidtest;parcelable MyData; Parcelæ•°æ®123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263public class MyData implements Parcelable&#123; int data1; int data2; String key; public MyData()&#123;&#125; protected MyData(Parcel in) &#123; data1 = in.readInt(); data2 = in.readInt(); key = in.readString(); &#125; public static final Creator&lt;MyData&gt; CREATOR = new Creator&lt;MyData&gt;() &#123; @Override public MyData createFromParcel(Parcel in) &#123; return new MyData(in); &#125; @Override public MyData[] newArray(int size) &#123; return new MyData[size]; &#125; &#125;; @Override public int describeContents() &#123; return 0; &#125; /** å°†æ•°æ®å†™å…¥åˆ°Parcel **/ @Override public void writeToParcel(Parcel dest, int flags) &#123; dest.writeInt(data1); dest.writeInt(data2); dest.writeString(key); &#125; public int getData1() &#123; return data1; &#125; public void setData1(int data1) &#123; this.data1 = data1; &#125; public int getData2() &#123; return data2; &#125; public void setData2(int data2) &#123; this.data2 = data2; &#125; public String getKey() &#123; return key; &#125; public void setKey(String key) &#123; this.key = key; &#125;&#125; Serverç«¯123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110public class RemoteService extends Service &#123; private static final String TAG = \"BinderSimple\"; int mDownloadCount = 0; MyData mMyData; IServiceCallback mCallback; //ç”¨æ¥é€šçŸ¥å®¢æˆ·ç«¯çš„å›è°ƒ ScheduledExecutorService mThreadPool; //ä¸‹è½½çº¿ç¨‹ @Override public void onCreate() &#123; super.onCreate(); Log.i(TAG, \"[RemoteService] onCreate\"); mMyData = new MyData(); mMyData.setData1(10); mMyData.setData2(20); mMyData.setKey(\"åœ¨é‚£é¥è¿œçš„åœ°æ–¹\"); &#125; @Override public IBinder onBind(Intent intent) &#123; Log.i(TAG,\"[RemoteService] onBind\"); //å¼€å§‹ä¸‹è½½ startDownloadThread(); return mBinder; &#125; @Override public boolean onUnbind(Intent intent) &#123; Log.i(TAG, \"[RemoteService] onUnbind\"); try &#123; mBinder.unregisterCallback(); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; return super.onUnbind(intent); &#125; @Override public void onDestroy() &#123; Log.i(TAG, \"[RemoteService] onDestroy\"); super.onDestroy(); &#125; /** * å®ç°æ¥å£IRemoteService.aidlä¸­å®šä¹‰çš„æ–¹æ³• */ private final IRemoteService.Stub mBinder = new IRemoteService.Stub() &#123; @Override public int getPid() throws RemoteException &#123; Log.i(TAG,\"[RemoteService] getPid() = \" + android.os.Process.myPid()); return android.os.Process.myPid(); &#125; @Override public MyData getMyData() throws RemoteException &#123; Log.i(TAG,\"[RemoteService] getMyData() \" + mMyData.toString()); return mMyData; &#125; @Override public void registerCallback(IServiceCallback callback) throws RemoteException &#123; Log.i(TAG,\"[RemoteService] registerCallback() \"); mCallback = callback; &#125; @Override public void unregisterCallback() throws RemoteException &#123; Log.i(TAG,\"[RemoteService] unregisterCallback() \"); mCallback = null; &#125; /**æ­¤å¤„å¯ç”¨äºæƒé™æ‹¦æˆª**/ @Override public boolean onTransact(int code, Parcel data, Parcel reply, int flags) throws RemoteException &#123; return super.onTransact(code, data, reply, flags); &#125; &#125;; /** * æ¨¡æ‹Ÿä¸‹è½½çº¿ç¨‹ */ private void startDownloadThread()&#123; Log.i(TAG,\"[RemoteService] startDownloadThread()\"); //2ç§’åå¼€å§‹ä¸‹è½½ mThreadPool = Executors.newScheduledThreadPool(1); mThreadPool.scheduleAtFixedRate(new Runnable() &#123; @Override public void run() &#123; try &#123; mDownloadCount++; if(mCallback != null)&#123; mCallback.onDownloadProgress((double) mDownloadCount / 100.0); if (mDownloadCount == 100) &#123; mCallback.onDownloadCompleted(); mThreadPool.shutdown(); &#125; &#125; &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, 2000, 50, TimeUnit.MILLISECONDS); &#125;&#125; Clientç«¯123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139public class ClientActivity extends AppCompatActivity &#123; private static final String TAG = \"BinderSimple\"; private IRemoteService mRemoteService; private TextView textView; private boolean mIsBound; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_client); textView = (TextView) findViewById(R.id.tv); Button btn0 = (Button) findViewById(R.id.btn_bind); Button btn1 = (Button) findViewById(R.id.btn_unbind); Button btn2 = (Button) findViewById(R.id.btn_kill); btn0.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; bindMyService(); &#125; &#125;); btn1.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; unBindMyService(); &#125; &#125;); btn2.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; killMyService(); &#125; &#125;); &#125; private ServiceConnection mRemoteConnection = new ServiceConnection() &#123; @Override public void onServiceConnected(ComponentName name, IBinder service) &#123; //æ³¨æ„è¿™é‡Œï¼ŒæŠŠServerè¿”å›çš„Binderå¯¹è±¡è½¬æ¢æˆäº†IRemoteServiceæ¥å£å¯¹è±¡ mRemoteService = IRemoteService.Stub.asInterface(service); try &#123; mRemoteService.registerCallback(mServiceCallbackBinder); MyData myData = mRemoteService.getMyData(); String pidInfo = \" servicePid = \"+ mRemoteService.getPid() + \"\\n myPid = \" + android.os.Process.myPid() + \"\\n data1 = \"+ myData.getData1() + \"\\n data2 = \"+ myData.getData2() + \"\\n key = \"+ myData.getKey(); Log.i(TAG, \"[ClientActivity] onServiceConnected\\n\" + pidInfo); textView.setText(pidInfo); Toast.makeText(ClientActivity.this, \"remoteService è¿æ¥æˆåŠŸ\", Toast.LENGTH_SHORT).show(); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125; @Override public void onServiceDisconnected(ComponentName name) &#123; Log.i(TAG, \"[ClientActivity] onServiceDisconnected\"); mRemoteService = null; Toast.makeText(ClientActivity.this, \"remoteService æ–­å¼€è¿æ¥\", Toast.LENGTH_SHORT).show(); &#125; &#125;; //æœåŠ¡å›è°ƒ private IServiceCallback.Stub mServiceCallbackBinder = new IServiceCallback.Stub()&#123; @Override public void onDownloadProgress(final double progress) throws RemoteException &#123; Handler handler = new Handler(Looper.getMainLooper()); handler.post(new Runnable() &#123; @Override public void run() &#123; textView.setText(\"ä¸‹è½½è¿›åº¦:\" + progress); &#125; &#125;); &#125; @Override public void onDownloadCompleted() throws RemoteException &#123; Log.i(TAG, \"[ClientActivity] mServiceCallbackBinder -&gt; onDownloadCompleted\"); Handler handler = new Handler(Looper.getMainLooper()); handler.post(new Runnable() &#123; @Override public void run() &#123; textView.setText(\"ä¸‹è½½å®Œæˆ\"); &#125; &#125;); &#125; &#125;; /** * ç»‘å®šè¿œç¨‹æœåŠ¡ */ private void bindMyService()&#123; Log.i(TAG, \"[ClientActivity] bindMyService\"); Intent intent = new Intent(ClientActivity.this, RemoteService.class); intent.setAction(IRemoteService.class.getName()); bindService(intent, mRemoteConnection, Context.BIND_AUTO_CREATE); mIsBound = true; textView.setText(\"bind success\"); &#125; /** * è§£é™¤ç»‘å®šè¿œç¨‹æœåŠ¡ */ private void unBindMyService()&#123; if(!mIsBound)&#123; return; &#125; Log.i(TAG, \"[ClientActivity] unBindMyService\"); unbindService(mRemoteConnection); mIsBound = false; textView.setText(\"unbind\"); &#125; /** * æ€æ­»è¿œç¨‹æœåŠ¡ */ private void killMyService()&#123; Log.i(TAG, \"[ClientActivity] killMyService\"); try &#123; android.os.Process.killProcess(mRemoteService.getPid()); textView.setText(\"kill success\"); &#125; catch (RemoteException e) &#123; e.printStackTrace(); Toast.makeText(ClientActivity.this, \"kill failed\", Toast.LENGTH_SHORT).show(); &#125; &#125;&#125; è¿è¡Œè¯¥å·¥ç¨‹ä¼šç”Ÿæˆä¸€ä¸ªapkï¼Œå®‰è£…åˆ°æ‰‹æœºï¼Œæ‰“å¼€apkï¼Œç•Œé¢å¦‚ä¸‹ï¼š ç•Œé¢ä¸Šæœ‰ä¸‰ä¸ªæŒ‰é’®ï¼Œåˆ†åˆ«æ˜¯åŠŸèƒ½åˆ†åˆ«æ˜¯ï¼š bindServiceï¼ˆç»‘å®šServiceï¼‰ unbindServiceï¼ˆè§£é™¤ç»‘å®šServiceï¼‰ killProcessï¼ˆæ€æ­»Serviceè¿›ç¨‹ï¼‰ ä»å·¦å¾€å³ï¼Œä¾æ¬¡ç‚¹å‡»ç•Œé¢ï¼Œå¯å¾—ï¼š äºŒã€åŒä¸€è¿›ç¨‹å¦‚æœActivityå’ŒServiceä½äºåŒä¸€è¿›ç¨‹å†…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹å¼ã€‚ä¸è¿‡è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ä¸‹é¢è¿™ç§ã€‚ AIDLæ–‡ä»¶ã€Parcelæ•°æ®ä¸ä¸Šé¢å‡ä¸€è‡´ï¼Œä¸‹é¢ä»…åˆ—å‡ºä¸åŒçš„Serverç«¯å’ŒClientç«¯çš„å®ç°ã€‚ Serverç«¯1234567891011121314151617181920212223242526272829303132333435363738public class LocalService extends Service &#123; private static final String TAG = \"BinderSimple\"; //å°è£…çš„æœåŠ¡ç«¯åŠŸèƒ½å¯¹è±¡ï¼Œä¾›Clientç«¯bindServiceä¹‹åè°ƒç”¨ private LocalServerFunc mBinder = new LocalServerFunc(); @Override public void onCreate() &#123; super.onCreate(); Log.i(TAG, \"[LocalService] onCreate\"); &#125; @Override public IBinder onBind(Intent intent) &#123; Log.i(TAG,\"[LocalService] onBind\"); //å¼€å¯ä¸‹è½½çº¿ç¨‹ mBinder.startDownloadThread(); return mBinder; &#125; @Override public boolean onUnbind(Intent intent) &#123; Log.i(TAG, \"[LocalService] onUnbind\"); try &#123; mBinder.unregisterCallback(); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; return super.onUnbind(intent); &#125; @Override public void onDestroy() &#123; Log.i(TAG, \"[LocalService] onDestroy\"); super.onDestroy(); &#125;&#125; å› ä¸ºï¼ŒServiceè¢«bindäº†ä¹‹åï¼Œéœ€è¦è¿”å›ä¸€ä¸ªIBinderå¯¹è±¡ã€‚æ‰€ä»¥éœ€è¦ç»§æ‰¿è‡ªBinderå°è£…ä¸€ä¸ªIBinderå¯¹è±¡ä¾›å®¢æˆ·ç«¯è°ƒç”¨ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970public class LocalServerFunc extends Binder implements IRemoteService &#123; private static final String TAG = \"BinderSimple\"; int mDownloadCount = 0; MyData mMyData; IServiceCallback mCallback; ScheduledExecutorService mThreadPool; public LocalServerFunc()&#123; mMyData = new MyData(); mMyData.setData1(66); mMyData.setData2(88); mMyData.setKey(\"å°±åœ¨çœ¼å‰\"); &#125; public void startDownloadThread()&#123; Log.i(TAG,\"[LocalServerFunc] startDownloadThread()\"); mThreadPool = Executors.newScheduledThreadPool(1); mThreadPool.scheduleAtFixedRate(new Runnable() &#123; @Override public void run() &#123; try &#123; mDownloadCount++; if(mCallback != null)&#123; mCallback.onDownloadProgress((double) mDownloadCount / 100.0); if (mDownloadCount == 100) &#123; mCallback.onDownloadCompleted(); mThreadPool.shutdown(); &#125; &#125; &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, 2000, 50, TimeUnit.MILLISECONDS); &#125; @Override public int getPid() throws RemoteException &#123; Log.i(TAG,\"[LocalServerFunc] getPid()\"); return android.os.Process.myPid(); &#125; @Override public MyData getMyData() throws RemoteException &#123; Log.i(TAG,\"[LocalServerFunc] getMyData()\"); return mMyData; &#125; @Override public void registerCallback(IServiceCallback callback) throws RemoteException &#123; Log.i(TAG,\"[LocalServerFunc] registerCallback()\"); mCallback = callback; &#125; @Override public void unregisterCallback() throws RemoteException &#123; Log.i(TAG,\"[LocalServerFunc] unregisterCallback()\"); if(mThreadPool != null)&#123; mThreadPool.shutdown(); &#125; mCallback = null; &#125; @Override public IBinder asBinder() &#123; return null; &#125;&#125; Clientç«¯123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143public class ClientActivity extends AppCompatActivity &#123; private static final String TAG = \"BinderSimple\"; private IRemoteService mLocalService; private TextView textView; private boolean mIsBound; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_client); textView = (TextView) findViewById(R.id.tv); Button btn0 = (Button) findViewById(R.id.btn_bind); Button btn1 = (Button) findViewById(R.id.btn_unbind); Button btn2 = (Button) findViewById(R.id.btn_kill); btn0.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; bindMyService(); &#125; &#125;); btn1.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; unBindMyService(); &#125; &#125;); btn2.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; killMyService(); &#125; &#125;); &#125; private ServiceConnection mServiceConnection = new ServiceConnection() &#123; @Override public void onServiceConnected(ComponentName name, IBinder service) &#123; //æ³¨æ„è¿™ä¸ªBinderå¯¹è±¡è½¬æ¢æˆIRemoteServiceæ¥å£æ–¹å¼çš„ä¸åŒ mLocalService = (IRemoteService) service; try &#123; mLocalService.registerCallback(mLocalServiceCallback); MyData myData = mLocalService.getMyData(); String pidInfo = \" servicePid = \"+ mLocalService.getPid() + \"\\n myPid = \" + android.os.Process.myPid() + \"\\n data1 = \"+ myData.getData1() + \"\\n data2 = \"+ myData.getData2() + \"\\n key = \"+ myData.getKey(); Log.i(TAG, \"[ClientActivity] onServiceConnected\\n\" + pidInfo); textView.setText(pidInfo); Toast.makeText(ClientActivity.this, \"localService è¿æ¥æˆåŠŸ\", Toast.LENGTH_SHORT).show(); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125; @Override public void onServiceDisconnected(ComponentName name) &#123; Log.i(TAG, \"[ClientActivity] onServiceDisconnected\"); mLocalService = null; Toast.makeText(ClientActivity.this, \"localService æ–­å¼€è¿æ¥\", Toast.LENGTH_SHORT).show(); &#125; &#125;; //æœåŠ¡å›è°ƒï¼Œæ³¨æ„è¿™ä¸ªå¯¹è±¡çš„ä¸åŒ private IServiceCallback mLocalServiceCallback = new IServiceCallback() &#123; @Override public void onDownloadProgress(final double progress) throws RemoteException &#123; Handler handler = new Handler(Looper.getMainLooper()); handler.post(new Runnable() &#123; @Override public void run() &#123; textView.setText(\"ä¸‹è½½è¿›åº¦:\" + progress); &#125; &#125;); &#125; @Override public void onDownloadCompleted() throws RemoteException &#123; Log.i(TAG, \"[ClientActivity] mServiceCallback -&gt; onDownloadCompleted\"); Handler handler = new Handler(Looper.getMainLooper()); handler.post(new Runnable() &#123; @Override public void run() &#123; textView.setText(\"ä¸‹è½½å®Œæˆ\"); &#125; &#125;); &#125; @Override public IBinder asBinder() &#123; return null; &#125; &#125;; /** * ç»‘å®šæœåŠ¡ */ private void bindMyService()&#123; Log.i(TAG, \"[ClientActivity] bindMyService\"); Intent intent = new Intent(ClientActivity.this, LocalService.class); intent.setAction(IRemoteService.class.getName()); bindService(intent, mServiceConnection, Context.BIND_AUTO_CREATE); mIsBound = true; textView.setText(\"bind success\"); &#125; /** * è§£é™¤ç»‘å®šæœåŠ¡ */ private void unBindMyService()&#123; if(!mIsBound)&#123; return; &#125; Log.i(TAG, \"[ClientActivity] unBindMyService\"); unbindService(mServiceConnection); mIsBound = false; textView.setText(\"unbind\"); &#125; /** * æ€æ­»æœåŠ¡ */ private void killMyService()&#123; Log.i(TAG, \"[ClientActivity] killMyService\"); try &#123; android.os.Process.killProcess(mLocalService.getPid()); textView.setText(\"kill success\"); &#125; catch (RemoteException e) &#123; e.printStackTrace(); Toast.makeText(ClientActivity.this, \"kill failed\", Toast.LENGTH_SHORT).show(); &#125; &#125;&#125; è¿è¡Œå› ä¸ºè¿™ä¸ªAcitivyå’ŒSeviceä½äºåŒä¸€è¿›ç¨‹ï¼Œæ‰€ä»¥å½“ç‚¹å‡»KILLæŒ‰é’®æ€æ­»Serviceè¿›ç¨‹æ—¶ï¼ŒActivityä¹Ÿä¼šåŒæ—¶è¢«æ€æ‰ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°åŠ¨ç”»æœ€åå°±é€€å‡ºäº†Appã€‚ ä»å·¦å¾€å³ï¼Œä¾æ¬¡ç‚¹å‡»ä¸‰ä¸ªæŒ‰é’®ï¼Œå¯å¾—ï¼š ç®€å•çœ‹AIDLçš„åŸç†IRemoteService.aidlæ–‡ä»¶å’ŒIServiceCallback.aidlæ–‡ä»¶ç”Ÿæˆçš„æ¥å£æ–‡ä»¶åˆ†åˆ«å¦‚ä¸‹ï¼š #IRemoteService.java123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179/* * This file is auto-generated. DO NOT MODIFY. */public interface IRemoteService extends android.os.IInterface &#123; /** * Local-side IPC implementation stub class. */ public static abstract class Stub extends android.os.Binder implements com.cuc.myandroidtest.IRemoteService &#123; private static final java.lang.String DESCRIPTOR = \"com.cuc.myandroidtest.IRemoteService\"; /** * Construct the stub at attach it to the interface. */ public Stub() &#123; this.attachInterface(this, DESCRIPTOR); &#125; /** * Cast an IBinder object into an com.cuc.myandroidtest.IRemoteService interface, * generating a proxy if needed. */ public static com.cuc.myandroidtest.IRemoteService asInterface(android.os.IBinder obj) &#123; if ((obj == null)) &#123; return null; &#125; android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR); if (((iin != null) &amp;&amp; (iin instanceof com.cuc.myandroidtest.IRemoteService))) &#123; return ((com.cuc.myandroidtest.IRemoteService) iin); &#125; return new com.cuc.myandroidtest.IRemoteService.Stub.Proxy(obj); &#125; @Override public android.os.IBinder asBinder() &#123; return this; &#125; @Override public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException &#123; switch (code) &#123; case INTERFACE_TRANSACTION: &#123; reply.writeString(DESCRIPTOR); return true; &#125; case TRANSACTION_getPid: &#123; data.enforceInterface(DESCRIPTOR); int _result = this.getPid(); reply.writeNoException(); reply.writeInt(_result); return true; &#125; case TRANSACTION_getMyData: &#123; data.enforceInterface(DESCRIPTOR); com.cuc.myandroidtest.MyData _result = this.getMyData(); reply.writeNoException(); if ((_result != null)) &#123; reply.writeInt(1); _result.writeToParcel(reply, android.os.Parcelable.PARCELABLE_WRITE_RETURN_VALUE); &#125; else &#123; reply.writeInt(0); &#125; return true; &#125; case TRANSACTION_registerCallback: &#123; data.enforceInterface(DESCRIPTOR); com.cuc.myandroidtest.IServiceCallback _arg0; _arg0 = com.cuc.myandroidtest.IServiceCallback.Stub.asInterface(data.readStrongBinder()); this.registerCallback(_arg0); reply.writeNoException(); return true; &#125; case TRANSACTION_unregisterCallback: &#123; data.enforceInterface(DESCRIPTOR); this.unregisterCallback(); reply.writeNoException(); return true; &#125; &#125; return super.onTransact(code, data, reply, flags); &#125; private static class Proxy implements com.cuc.myandroidtest.IRemoteService &#123; private android.os.IBinder mRemote; Proxy(android.os.IBinder remote) &#123; mRemote = remote; &#125; @Override public android.os.IBinder asBinder() &#123; return mRemote; &#125; public java.lang.String getInterfaceDescriptor() &#123; return DESCRIPTOR; &#125; @Override public int getPid() throws android.os.RemoteException &#123; android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); int _result; try &#123; _data.writeInterfaceToken(DESCRIPTOR); mRemote.transact(Stub.TRANSACTION_getPid, _data, _reply, 0); _reply.readException(); _result = _reply.readInt(); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; return _result; &#125; @Override public com.cuc.myandroidtest.MyData getMyData() throws android.os.RemoteException &#123; android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); com.cuc.myandroidtest.MyData _result; try &#123; _data.writeInterfaceToken(DESCRIPTOR); mRemote.transact(Stub.TRANSACTION_getMyData, _data, _reply, 0); _reply.readException(); if ((0 != _reply.readInt())) &#123; _result = com.cuc.myandroidtest.MyData.CREATOR.createFromParcel(_reply); &#125; else &#123; _result = null; &#125; &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; return _result; &#125; @Override public void registerCallback(com.cuc.myandroidtest.IServiceCallback callback) throws android.os.RemoteException &#123; android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); try &#123; _data.writeInterfaceToken(DESCRIPTOR); _data.writeStrongBinder((((callback != null)) ? (callback.asBinder()) : (null))); mRemote.transact(Stub.TRANSACTION_registerCallback, _data, _reply, 0); _reply.readException(); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; &#125; @Override public void unregisterCallback() throws android.os.RemoteException &#123; android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); try &#123; _data.writeInterfaceToken(DESCRIPTOR); mRemote.transact(Stub.TRANSACTION_unregisterCallback, _data, _reply, 0); _reply.readException(); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; &#125; &#125; static final int TRANSACTION_getPid = (android.os.IBinder.FIRST_CALL_TRANSACTION + 0); static final int TRANSACTION_getMyData = (android.os.IBinder.FIRST_CALL_TRANSACTION + 1); static final int TRANSACTION_registerCallback = (android.os.IBinder.FIRST_CALL_TRANSACTION + 2); static final int TRANSACTION_unregisterCallback = (android.os.IBinder.FIRST_CALL_TRANSACTION + 3); &#125; public int getPid() throws android.os.RemoteException; public com.cuc.myandroidtest.MyData getMyData() throws android.os.RemoteException; public void registerCallback(com.cuc.myandroidtest.IServiceCallback callback) throws android.os.RemoteException; public void unregisterCallback() throws android.os.RemoteException;&#125; #IServiceCallback.java123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118/* * This file is auto-generated. DO NOT MODIFY. */public interface IServiceCallback extends android.os.IInterface &#123; /** * Local-side IPC implementation stub class. */ public static abstract class Stub extends android.os.Binder implements com.cuc.myandroidtest.IServiceCallback &#123; private static final java.lang.String DESCRIPTOR = \"com.cuc.myandroidtest.IServiceCallback\"; /** * Construct the stub at attach it to the interface. */ public Stub() &#123; this.attachInterface(this, DESCRIPTOR); &#125; /** * Cast an IBinder object into an com.cuc.myandroidtest.IServiceCallback interface, * generating a proxy if needed. */ public static com.cuc.myandroidtest.IServiceCallback asInterface(android.os.IBinder obj) &#123; if ((obj == null)) &#123; return null; &#125; android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR); if (((iin != null) &amp;&amp; (iin instanceof com.cuc.myandroidtest.IServiceCallback))) &#123; return ((com.cuc.myandroidtest.IServiceCallback) iin); &#125; return new com.cuc.myandroidtest.IServiceCallback.Stub.Proxy(obj); &#125; @Override public android.os.IBinder asBinder() &#123; return this; &#125; @Override public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException &#123; switch (code) &#123; case INTERFACE_TRANSACTION: &#123; reply.writeString(DESCRIPTOR); return true; &#125; case TRANSACTION_onDownloadProgress: &#123; data.enforceInterface(DESCRIPTOR); double _arg0; _arg0 = data.readDouble(); this.onDownloadProgress(_arg0); reply.writeNoException(); return true; &#125; case TRANSACTION_onDownloadCompleted: &#123; data.enforceInterface(DESCRIPTOR); this.onDownloadCompleted(); reply.writeNoException(); return true; &#125; &#125; return super.onTransact(code, data, reply, flags); &#125; private static class Proxy implements com.cuc.myandroidtest.IServiceCallback &#123; private android.os.IBinder mRemote; Proxy(android.os.IBinder remote) &#123; mRemote = remote; &#125; @Override public android.os.IBinder asBinder() &#123; return mRemote; &#125; public java.lang.String getInterfaceDescriptor() &#123; return DESCRIPTOR; &#125; @Override public void onDownloadProgress(double progress) throws android.os.RemoteException &#123; android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); try &#123; _data.writeInterfaceToken(DESCRIPTOR); _data.writeDouble(progress); mRemote.transact(Stub.TRANSACTION_onDownloadProgress, _data, _reply, 0); _reply.readException(); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; &#125; //ä¸‹è½½è¿›åº¦ @Override public void onDownloadCompleted() throws android.os.RemoteException &#123; android.os.Parcel _data = android.os.Parcel.obtain(); android.os.Parcel _reply = android.os.Parcel.obtain(); try &#123; _data.writeInterfaceToken(DESCRIPTOR); mRemote.transact(Stub.TRANSACTION_onDownloadCompleted, _data, _reply, 0); _reply.readException(); &#125; finally &#123; _reply.recycle(); _data.recycle(); &#125; &#125; &#125; static final int TRANSACTION_onDownloadProgress = (android.os.IBinder.FIRST_CALL_TRANSACTION + 0); static final int TRANSACTION_onDownloadCompleted = (android.os.IBinder.FIRST_CALL_TRANSACTION + 1); &#125; public void onDownloadProgress(double progress) throws android.os.RemoteException; //ä¸‹è½½è¿›åº¦ public void onDownloadCompleted() throws android.os.RemoteException;&#125; å‚è€ƒèµ„æ–™ Android æ¥å£å®šä¹‰è¯­è¨€ (AIDL) - Google Developeræ–‡æ¡£ Binderç³»åˆ—9â€”å¦‚ä½•ä½¿ç”¨AIDL Androidè·¨è¿›ç¨‹bindServiceä¸callback åœ¨Activityå’ŒServiceä¹‹é—´ä½¿ç”¨æœ¬åœ°Binderå’Œå›è°ƒæ¥å£è¿›è¡Œé€šä¿¡","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"è¿é€šå›¾çš„æœ€å¤§ç”Ÿæˆæ ‘çš„æƒå’Œ","slug":"Google ç¬”è¯•é¢˜ - è¿é€šå›¾çš„æœ€å¤§ç”Ÿæˆæ ‘çš„æƒå’Œ","date":"2017-07-31T09:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/07/31/Google ç¬”è¯•é¢˜ - è¿é€šå›¾çš„æœ€å¤§ç”Ÿæˆæ ‘çš„æƒå’Œ/","link":"","permalink":"http://github.com/2017/07/31/Google ç¬”è¯•é¢˜ - è¿é€šå›¾çš„æœ€å¤§ç”Ÿæˆæ ‘çš„æƒå’Œ/","excerpt":"è¿™æ˜¯ä¸€é“Google ç¬”è¯•é¢˜ é¢˜ç›®ä¸€ä¸ªæœ‰nä¸ªç»“ç‚¹çš„è¿é€šå›¾çš„ç”Ÿæˆæ ‘æ˜¯åŸå›¾çš„æœ€å°è¿é€šå­å›¾, ä¸”åŒ…å«åŸå›¾ä¸­æ‰€æœ‰nä¸ªç»“ç‚¹ï¼Œå¹¶ä¸”æœ‰ä¿æŒå›¾è”é€šçš„æœ€å°‘çš„è¾¹ã€‚æœ€å¤§ç”Ÿæˆæ ‘å°±æ˜¯æƒå’Œæœ€å¤§ç”Ÿæˆæ ‘ï¼Œç°åœ¨ç»™å‡ºä¸€ä¸ªæ— å‘å¸¦æƒå›¾çš„é‚»æ¥çŸ©é˜µï¼Œæƒä¸º0è¡¨ç¤ºæ²¡æœ‰è¾¹ã€‚12345&#123;&#123;0, 4, 5, 0, 3&#125;, &#123;4, 0, 4, 2, 3&#125;, &#123;5, 4, 0, 2, 0&#125;, &#123;0, 2, 2, 0, 1&#125;, &#123;3, 3, 0, 1, 0&#125;&#125; æ±‚è¿™ä¸ªå›¾çš„æœ€å¤§ç”Ÿæˆæ ‘çš„æƒå’Œã€‚ Aã€11 Bã€12 Cã€13 Dã€14 Eã€15","text":"è¿™æ˜¯ä¸€é“Google ç¬”è¯•é¢˜ é¢˜ç›®ä¸€ä¸ªæœ‰nä¸ªç»“ç‚¹çš„è¿é€šå›¾çš„ç”Ÿæˆæ ‘æ˜¯åŸå›¾çš„æœ€å°è¿é€šå­å›¾, ä¸”åŒ…å«åŸå›¾ä¸­æ‰€æœ‰nä¸ªç»“ç‚¹ï¼Œå¹¶ä¸”æœ‰ä¿æŒå›¾è”é€šçš„æœ€å°‘çš„è¾¹ã€‚æœ€å¤§ç”Ÿæˆæ ‘å°±æ˜¯æƒå’Œæœ€å¤§ç”Ÿæˆæ ‘ï¼Œç°åœ¨ç»™å‡ºä¸€ä¸ªæ— å‘å¸¦æƒå›¾çš„é‚»æ¥çŸ©é˜µï¼Œæƒä¸º0è¡¨ç¤ºæ²¡æœ‰è¾¹ã€‚12345&#123;&#123;0, 4, 5, 0, 3&#125;, &#123;4, 0, 4, 2, 3&#125;, &#123;5, 4, 0, 2, 0&#125;, &#123;0, 2, 2, 0, 1&#125;, &#123;3, 3, 0, 1, 0&#125;&#125; æ±‚è¿™ä¸ªå›¾çš„æœ€å¤§ç”Ÿæˆæ ‘çš„æƒå’Œã€‚ Aã€11 Bã€12 Cã€13 Dã€14 Eã€15 åˆ†æé¢˜æ„æ˜¯åœ¨è€ƒå¯Ÿæœ€å¤§ç”Ÿæˆæ ‘ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ç»™å‡ºçš„é‚»æ¥çŸ©é˜µä»£è¡¨çš„æ— å‘å¸¦æƒå›¾æ±‚å‡ºæœ€å¤§ç”Ÿæˆæ ‘ï¼Œç„¶åè®¡ç®—æƒå’Œå°±å¾ˆç®€å•æ°´åˆ°æ¸ æˆäº†ã€‚ æœ€å°ç”Ÿæˆæ ‘è¯´åˆ°æœ€å¤§ç”Ÿæˆæ ‘ï¼Œæˆ‘ä»¬å¾—å…ˆå›é¡¾ä¸€ä¸‹æœ€å°ç”Ÿæˆæ ‘ï¼š æœ€å°ç”Ÿæˆæ ‘å…¶å®æ˜¯æœ€å°æƒé‡ç”Ÿæˆæ ‘çš„ç®€ç§°ã€‚ä¸€ä¸ªè¿é€šå›¾å¯èƒ½æœ‰å¤šä¸ªç”Ÿæˆæ ‘ã€‚å½“å›¾ä¸­çš„è¾¹å…·æœ‰æƒå€¼æ—¶ï¼Œæ€»ä¼šæœ‰ä¸€ä¸ªç”Ÿæˆæ ‘çš„è¾¹çš„æƒå€¼ä¹‹å’Œå°äºæˆ–è€…ç­‰äºå…¶å®ƒç”Ÿæˆæ ‘çš„è¾¹çš„æƒå€¼ä¹‹å’Œã€‚ä¹Ÿå°±æ˜¯è¯´æœ€å°ç”Ÿæˆæ ‘å°±æ˜¯è¾¹æƒé‡ä¹‹å’Œæœ€å°çš„ç”Ÿæˆæ ‘ã€‚æ€»ç»“èµ·æ¥å°±æ˜¯ä»¥ä¸‹ï¼š 1ï¼‰å¿…é¡»ä½¿ç”¨ä¸”ä»…ä½¿ç”¨è¯¥ç½‘ç»œä¸­çš„n-1æ¡è¾¹æ¥è¿æ¥ç½‘ç»œä¸­çš„nä¸ªé¡¶ç‚¹ã€‚ 2ï¼‰ä¸èƒ½ä½¿ç”¨äº§ç”Ÿå›è·¯çš„è¾¹ã€‚ 3ï¼‰å„è¾¹ä¸Šçš„æƒå€¼çš„æ€»å’Œè¾¾åˆ°æœ€å°ã€‚ ç®€å•ç‚¹è¯´æœ‰å‡ ä¸ªåŸå¸‚ä½ è¦è®¾è®¡ä¸€ä¸ªè·¯çº¿ï¼Œè¿™ä¸ªè·¯çº¿èƒ½èµ°å®Œæ‰€æœ‰çš„è¿™å‡ ä¸ªåŸå¸‚ï¼Œè€Œä¸”è·¯ç¨‹æœ€çŸ­ï¼Œè¿™ä¸ªè·¯çº¿å°±æ˜¯æœ€å°ç”Ÿæˆæ ‘çš„å«ä¹‰ã€‚ç›¸ååœ°ï¼Œæœ€å¤§ç”Ÿæˆæ ‘å°±æ˜¯è¾¹æƒé‡ä¹‹å’Œæœ€å¤§çš„ç”Ÿæˆæ ‘ã€‚ é‚£ä¹ˆï¼Œå¦‚ä½•ç”Ÿæˆæœ€å°ç”Ÿæˆæ ‘å‘¢ï¼Ÿå¸¸ç”¨çš„ç®—æ³•æœ‰Primç®—æ³•ï¼ˆæ™®é‡Œå§†ç®—æ³•ï¼‰å’ŒKruskalç®—æ³•ï¼ˆå…‹é²æ–¯å…‹å°”ç®—æ³•ï¼‰ã€‚ Primç®—æ³•Primç®—æ³•æ˜¯ç”¨æ¥ä»å¸¦æƒå›¾ä¸­æœç´¢æœ€å°ç”Ÿæˆæ ‘çš„ä¸€ç§ç®—æ³•ã€‚ ä»å•ä¸€é¡¶ç‚¹å¼€å§‹ï¼ŒPrimæ™®é‡Œå§†ç®—æ³•æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤é€æ­¥æ‰©å¤§æ ‘ä¸­æ‰€å«é¡¶ç‚¹çš„æ•°ç›®ï¼Œç›´åˆ°éåŠè¿é€šå›¾çš„æ‰€æœ‰é¡¶ç‚¹ã€‚ è¾“å…¥ï¼šä¸€ä¸ªåŠ æƒè¿é€šå›¾ï¼Œå…¶ä¸­é¡¶ç‚¹é›†åˆä¸º$V$ ï¼Œè¾¹é›†åˆä¸º$E$ï¼› åˆå§‹åŒ–ï¼š$V_{new} = {x}$ ï¼Œå…¶ä¸­xä¸ºé›†åˆVä¸­çš„ä»»ä¸€èŠ‚ç‚¹ï¼ˆèµ·å§‹ç‚¹ï¼‰ï¼Œ $E_{new} = \\{\\}$ ï¼› é‡å¤ä¸‹åˆ—æ“ä½œï¼Œç›´åˆ°$V_{new} = V$ ï¼š a. åœ¨é›†åˆEä¸­é€‰å–æƒå€¼æœ€å°çš„è¾¹ï¼ˆu, vï¼‰ï¼Œå…¶ä¸­uä¸ºé›†åˆ$V_{new}â€‹$ä¸­çš„å…ƒç´ ï¼Œè€Œvåˆ™æ˜¯Vä¸­æ²¡æœ‰åŠ å…¥$V_{new}â€‹$çš„é¡¶ç‚¹ï¼ˆå¦‚b. æœå­˜åœ¨æœ‰å¤šæ¡æ»¡è¶³å‰è¿°æ¡ä»¶å³å…·æœ‰ç›¸åŒæƒå€¼çš„è¾¹ï¼Œåˆ™å¯ä»»æ„é€‰å–å…¶ä¸­ä¹‹ä¸€ï¼‰ï¼›å°†våŠ å…¥é›†åˆ$V_{new}â€‹$ä¸­ï¼Œå°†ï¼ˆu, vï¼‰åŠ å…¥é›†åˆ$E_{new}â€‹$ä¸­ï¼› è¾“å‡ºï¼šä½¿ç”¨é›†åˆ$V_{new}$å’Œ$E_{new}$æ¥æè¿°æ‰€å¾—åˆ°çš„æœ€å°ç”Ÿæˆæ ‘ã€‚ ç®—æ³•ä¼ªä»£ç ï¼š 123456789Prim(G, T) &#123; T = NULL; U = &#123;w&#125;; //æ·»åŠ ä»»ä¸€é¡¶ç‚¹w while((V - U)!=NULL) &#123; è®¾(u, v)æ˜¯u âˆˆ U ä¸ v âˆˆ ï¼ˆV - U),ä¸”æƒå€¼æœ€å°çš„è¾¹ T = T âˆª (u, v); U = U âˆª v ; &#125;&#125; è¯´ç™½äº†ï¼Œå°±æ˜¯å°†èµ·ç‚¹uï¼ˆä»»ä¸€èŠ‚ç‚¹ï¼‰æ”¾å…¥ç©ºé›†åˆSï¼Œåˆ™S = {u}ï¼›å†æ‰¾åˆ°è·ç¦»é›†åˆSæœ€è¿‘çš„ä¸€ç‚¹uï¼ŒåŠ å…¥Sé›†åˆã€‚ç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½åŠ å…¥è¿›æ¥ã€‚ Primç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸ºO(V^2)ï¼Œæ¯”è¾ƒé€‚åˆäºæ±‚ç¨ å¯†å›¾çš„æœ€å°ç”Ÿæˆæ ‘ã€‚ Kruskalç®—æ³•Kruskalç®—æ³•æ˜¯ä¸€ç§æŒ‰æƒå€¼çš„é€’å¢æ¬¡åºé€‰æ‹©åˆé€‚çš„è¾¹æ¥æ„æˆæœ€å°ç”Ÿæˆæ ‘çš„æ–¹æ³•ã€‚ç®—æ³•æè¿°å¦‚ä¸‹ï¼š æ–°å»ºå›¾Gï¼ŒGä¸­æ‹¥æœ‰åŸå›¾ä¸­ç›¸åŒçš„èŠ‚ç‚¹ï¼Œä½†æ²¡æœ‰è¾¹ å°†åŸå›¾ä¸­æ‰€æœ‰çš„è¾¹æŒ‰æƒå€¼ä»å°åˆ°å¤§æ’åº ä»æƒå€¼æœ€å°çš„è¾¹å¼€å§‹ï¼Œå¦‚æœè¿™æ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªèŠ‚ç‚¹äºå›¾Gä¸­ä¸åœ¨åŒä¸€ä¸ªè¿é€šåˆ†é‡ä¸­ï¼Œåˆ™æ·»åŠ è¿™æ¡è¾¹åˆ°å›¾Gä¸­ é‡å¤3ï¼Œç›´è‡³å›¾Gä¸­æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½åœ¨åŒä¸€ä¸ªè¿é€šåˆ†é‡ä¸­ ç®—æ³•ä¼ªä»£ç ï¼š 123456789KRUSKAL-FUNCTION(G, w) F := ç©ºé›†åˆ for each å›¾ G ä¸­çš„é¡¶ç‚¹ v do å°‡ v åŠ å…¥æ£®æ— F æ‰€æœ‰çš„è¾¹(u, v) âˆˆ Eä¾æƒé‡ w é€’å¢æ’åº for each è¾¹(u, v) âˆˆ E do if u å’Œ v ä¸åœ¨åŒä¸€æ£µå­æ ‘ then F := F âˆª &#123;(u, v)&#125; å°‡ u å’Œ v æ‰€åœ¨çš„å­æ ‘åˆå¹¶ å°ç»“Primç®—æ³•ï¼šæ˜¯é’ˆå¯¹é¡¶ç‚¹å±•å¼€çš„ï¼Œé€‚åˆäºè¾¹æ•°è¾ƒå¤šçš„æƒ…å†µã€‚ Kruskalç®—æ³•ï¼šæ˜¯é’ˆå¯¹è¾¹å±•å¼€çš„ï¼Œé€‚åˆäºè¾¹çš„æ•°é‡è¾ƒå°‘çš„æƒ…å†µã€‚ è§£å†³ä½¿ç”¨Krustalç®—æ³•æˆ–è€…Primeç®—æ³•æ„é€ â€œâ€æœ€å¤§ç”Ÿæˆæ ‘â€ï¼š Primeç®—æ³•ï¼šé€‰æ‹©æƒé‡æœ€å¤§çš„è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹åŠ å…¥ç­‰ä»·ç±» Krustalç®—æ³•ï¼šå³æ¯æ¬¡é€‰æ‹©æƒé‡æœ€å¤§çš„è¾¹åŠ å…¥æ£®æ—ï¼› æˆ‘ä»¬çœ‹é‚»æ¥çŸ©é˜µ A B C D E A 0 4 5 0 3 B 4 0 4 2 3 C 5 4 0 2 0 D 0 2 2 0 1 E 3 3 0 1 0 åˆ©ç”¨Krustalç®—æ³•ï¼Œé€‰æ‹©æœ€å¤§çš„è¾¹åŠ å…¥ï¼Œä½†æ˜¯ä¸èƒ½å½¢æˆå›è·¯ï¼Œå›¾ä¸­è¡¨é»‘çš„å°±æ˜¯è¢«é€‰å‡ºçš„ï¼ŒDEè¾¹æ˜¯ä¸èƒ½é€‰çš„ï¼Œå¦åˆ™å°±å½¢æˆé—­è·¯ã€‚æ€»å…±5+4+3+2=14 å‚è€ƒèµ„æ–™ æ•°æ®ç»“æ„æ·±å…¥å‰–æï¼ˆ14ï¼‰â€“æœ€å°è¿é€šå›¾ å›¾çš„å¸¸è§ç®—æ³• æ•°æ®ç»“æ„ä¹‹å›¾çš„å­˜å‚¨æ–¹å¼","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Google","slug":"Google","permalink":"http://github.com/tags/Google/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"å…«å¤§æ’åºç®—æ³•æ€»ç»“ä¸javaå®ç°","slug":"å…«å¤§æ’åºç®—æ³•æ€»ç»“ä¸javaå®ç°","date":"2017-07-18T04:30:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/07/18/å…«å¤§æ’åºç®—æ³•æ€»ç»“ä¸javaå®ç°/","link":"","permalink":"http://github.com/2017/07/18/å…«å¤§æ’åºç®—æ³•æ€»ç»“ä¸javaå®ç°/","excerpt":"æ¦‚è¿°å› ä¸ºå¥å¿˜ï¼ŒåŠ ä¸Šå¯¹å„ç§æ’åºç®—æ³•ç†è§£ä¸æ·±åˆ»ï¼Œè¿‡æ®µæ—¶é—´é¢å¯¹æ’åºå°±è’™äº†ã€‚æ‰€ä»¥å†³å®šå¯¹æˆ‘ä»¬å¸¸è§çš„è¿™å‡ ç§æ’åºç®—æ³•è¿›è¡Œç»Ÿä¸€æ€»ç»“ï¼Œå¼ºè¡Œå­¦ä¹ ã€‚é¦–å…ˆç½—åˆ—ä¸€ä¸‹å¸¸è§çš„åå¤§æ’åºç®—æ³•ï¼š ç›´æ¥æ’å…¥æ’åº å¸Œå°”æ’åº ç®€å•é€‰æ‹©æ’åº å †æ’åº å†’æ³¡æ’åº å¿«é€Ÿæ’åº å½’å¹¶æ’åº åŸºæ•°æ’åº","text":"æ¦‚è¿°å› ä¸ºå¥å¿˜ï¼ŒåŠ ä¸Šå¯¹å„ç§æ’åºç®—æ³•ç†è§£ä¸æ·±åˆ»ï¼Œè¿‡æ®µæ—¶é—´é¢å¯¹æ’åºå°±è’™äº†ã€‚æ‰€ä»¥å†³å®šå¯¹æˆ‘ä»¬å¸¸è§çš„è¿™å‡ ç§æ’åºç®—æ³•è¿›è¡Œç»Ÿä¸€æ€»ç»“ï¼Œå¼ºè¡Œå­¦ä¹ ã€‚é¦–å…ˆç½—åˆ—ä¸€ä¸‹å¸¸è§çš„åå¤§æ’åºç®—æ³•ï¼š ç›´æ¥æ’å…¥æ’åº å¸Œå°”æ’åº ç®€å•é€‰æ‹©æ’åº å †æ’åº å†’æ³¡æ’åº å¿«é€Ÿæ’åº å½’å¹¶æ’åº åŸºæ•°æ’åº æˆ‘ä»¬è®¨è®ºçš„è¿™å…«å¤§æ’åºç®—æ³•çš„å®ç°å¯ä»¥å‚è€ƒæˆ‘çš„Githubï¼šSortAlgorithmsï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬äº†æ’åºæµ‹è¯•æ¨¡å—[Test.java]å’Œæ’åºç®—æ³•å¯¹æ¯”æ¨¡å—[Bench.java]ï¼Œå¤§å®¶å¯ä»¥è¯•è¿è¡Œã€‚ å®ƒä»¬éƒ½å±äºå†…éƒ¨æ’åºï¼Œä¹Ÿå°±æ˜¯åªè€ƒè™‘æ•°æ®é‡è¾ƒå°ä»…éœ€è¦ä½¿ç”¨å†…å­˜çš„æ’åºç®—æ³•ï¼Œä»–ä»¬ä¹‹é—´å…³ç³»å¦‚ä¸‹ï¼š $$ \\begin{cases} å†…éƒ¨æ’åº \\begin{cases} æ’å…¥æ’åº \\begin{cases} ç›´æ¥æ’å…¥æ’åº\\\\ å¸Œå°”æ’åº \\end{cases} \\\\ é€‰æ‹©æ’åº \\begin{cases} ç®€å•é€‰æ‹©æ’åº\\\\ å †æ’åº \\end{cases} \\\\ äº¤æ¢æ’åº \\begin{cases} å†’æ³¡æ’åº\\\\ å¿«é€Ÿæ’åº \\end{cases} \\\\ å½’å¹¶æ’åº\\\\ åŸºæ•°æ’åº \\end{cases} \\\\ å¤–éƒ¨æ’åº \\end{cases} $$ ä¸€ã€ç›´æ¥æ’å…¥æ’åºï¼ˆInsertion Sortï¼‰ æ’å…¥æ’åºçš„è®¾è®¡åˆè¡·æ˜¯å¾€æœ‰åºçš„æ•°ç»„ä¸­å¿«é€Ÿæ’å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚å®ƒçš„ç®—æ³•æ€æƒ³æ˜¯ï¼šæŠŠè¦æ’åºçš„æ•°ç»„åˆ†ä¸ºäº†ä¸¤ä¸ªéƒ¨åˆ†, ä¸€éƒ¨åˆ†æ˜¯æ•°ç»„çš„å…¨éƒ¨å…ƒç´ (é™¤å»å¾…æ’å…¥çš„å…ƒç´ ), å¦ä¸€éƒ¨åˆ†æ˜¯å¾…æ’å…¥çš„å…ƒç´ ; å…ˆå°†ç¬¬ä¸€éƒ¨åˆ†æ’åºå®Œæˆ, ç„¶åå†æ’å…¥è¿™ä¸ªå…ƒç´ . å…¶ä¸­ç¬¬ä¸€éƒ¨åˆ†çš„æ’åºä¹Ÿæ˜¯é€šè¿‡å†æ¬¡æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†æ¥è¿›è¡Œçš„. æ’å…¥æ’åºç”±äºæ“ä½œä¸å°½ç›¸åŒ, å¯åˆ†ä¸º ç›´æ¥æ’å…¥æ’åº , æŠ˜åŠæ’å…¥æ’åº(åˆç§°äºŒåˆ†æ’å…¥æ’åº), é“¾è¡¨æ’å…¥æ’åº , å¸Œå°”æ’åº ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ç›´æ¥æ’å…¥æ’åºã€‚ 1ã€åŸºæœ¬æ€æƒ³ç›´æ¥æ’å…¥æ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå°†æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ä¾æ¬¡è·Ÿå‰é¢å·²ç»æ’å¥½çš„å…ƒç´ ç›¸æ¯”è¾ƒï¼Œå¦‚æœé€‰æ‹©çš„å…ƒç´ æ¯”å·²æ’åºçš„å…ƒç´ å°ï¼Œåˆ™äº¤æ¢ï¼Œç›´åˆ°å…¨éƒ¨å…ƒç´ éƒ½æ¯”è¾ƒè¿‡ä¸ºæ­¢ã€‚ 2ã€ç®—æ³•æè¿°ä¸€èˆ¬æ¥è¯´ï¼Œæ’å…¥æ’åºéƒ½é‡‡ç”¨in-placeåœ¨æ•°ç»„ä¸Šå®ç°ã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š â‘ . ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åºâ‘¡. å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æâ‘¢. å¦‚æœè¯¥å…ƒç´ ï¼ˆå·²æ’åºï¼‰å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½®â‘£. é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½®â‘¤. å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®åâ‘¥. é‡å¤æ­¥éª¤â‘¡~â‘¤ å¦‚æœæ¯”è¾ƒæ“ä½œçš„ä»£ä»·æ¯”äº¤æ¢æ“ä½œå¤§çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨äºŒåˆ†æŸ¥æ‰¾æ³•æ¥å‡å°‘æ¯”è¾ƒæ“ä½œçš„æ•°ç›®ã€‚è¯¥ç®—æ³•å¯ä»¥è®¤ä¸ºæ˜¯æ’å…¥æ’åºçš„ä¸€ä¸ªå˜ç§ï¼Œç§°ä¸ºäºŒåˆ†æŸ¥æ‰¾æ’å…¥æ’åºã€‚ 3ã€ä»£ç å®ç°1234567891011121314151617181920212223/** * æ’å…¥æ’åº * * 1. ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åº * 2. å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æ * 3. å¦‚æœè¯¥å…ƒç´ ï¼ˆå·²æ’åºï¼‰å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½® * 4. é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½® * 5. å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®å * 6. é‡å¤æ­¥éª¤2~5 * @param arr å¾…æ’åºæ•°ç»„ */public static void insertionSort(int[] arr)&#123; for( int i=0; i&lt;arr.length-1; i++ ) &#123; for( int j=i+1; j&gt;0; j-- ) &#123; if( arr[j-1] &lt;= arr[j] ) break; int temp = arr[j]; //äº¤æ¢æ“ä½œ arr[j] = arr[j-1]; arr[j-1] = temp; System.out.println(\"Sorting: \" + Arrays.toString(arr)); &#125; &#125;&#125; ç›´æ¥æ’å…¥æ’åºå¤æ‚åº¦å¦‚ä¸‹ï¼š å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ O(nÂ²) O(nÂ²) O(nÂ²) O(1) Tips: ç”±äºç›´æ¥æ’å…¥æ’åºæ¯æ¬¡åªç§»åŠ¨ä¸€ä¸ªå…ƒç´ çš„ä½ï¼Œ å¹¶ä¸ä¼šæ”¹å˜å€¼ç›¸åŒçš„å…ƒç´ ä¹‹é—´çš„æ’åºï¼Œ å› æ­¤å®ƒæ˜¯ä¸€ç§ç¨³å®šæ’åºã€‚ äºŒã€å¸Œå°”æ’åºï¼ˆShell Sortï¼‰ ç¬¬ä¸€ä¸ªçªç ´O(n^2)çš„æ’åºç®—æ³•ï¼›æ˜¯ç®€å•æ’å…¥æ’åºçš„æ”¹è¿›ç‰ˆï¼›å®ƒä¸æ’å…¥æ’åºçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä¼šä¼˜å…ˆæ¯”è¾ƒè·ç¦»è¾ƒè¿œçš„å…ƒç´ ã€‚ å¸Œå°”æ’åºï¼Œä¹Ÿç§°é€’å‡å¢é‡æ’åºç®—æ³•ï¼Œ1959å¹´Shellå‘æ˜ã€‚æ˜¯æ’å…¥æ’åºçš„ä¸€ç§é«˜é€Ÿè€Œç¨³å®šçš„æ”¹è¿›ç‰ˆæœ¬ã€‚ å¸Œå°”æ’åºæ˜¯å…ˆå°†æ•´ä¸ªå¾…æ’åºçš„è®°å½•åºåˆ—åˆ†å‰²æˆä¸ºè‹¥å¹²å­åºåˆ—åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå¾…æ•´ä¸ªåºåˆ—ä¸­çš„è®°å½•â€œåŸºæœ¬æœ‰åºâ€æ—¶ï¼Œå†å¯¹å…¨ä½“è®°å½•è¿›è¡Œä¾æ¬¡ç›´æ¥æ’å…¥æ’åºã€‚ 1ã€åŸºæœ¬æ€æƒ³ å°†å¾…æ’åºæ•°ç»„æŒ‰ç…§æ­¥é•¿gapè¿›è¡Œåˆ†ç»„ï¼Œç„¶åå°†æ¯ç»„çš„å…ƒç´ åˆ©ç”¨ç›´æ¥æ’å…¥æ’åºçš„æ–¹æ³•è¿›è¡Œæ’åºï¼›æ¯æ¬¡å†å°†gapæŠ˜åŠå‡å°ï¼Œå¾ªç¯ä¸Šè¿°æ“ä½œï¼›å½“gap=1æ—¶ï¼Œåˆ©ç”¨ç›´æ¥æ’å…¥ï¼Œå®Œæˆæ’åºã€‚ å¯ä»¥çœ‹åˆ°æ­¥é•¿çš„é€‰æ‹©æ˜¯å¸Œå°”æ’åºçš„é‡è¦éƒ¨åˆ†ã€‚åªè¦æœ€ç»ˆæ­¥é•¿ä¸º1ä»»ä½•æ­¥é•¿åºåˆ—éƒ½å¯ä»¥å·¥ä½œã€‚ä¸€èˆ¬æ¥è¯´æœ€ç®€å•çš„æ­¥é•¿å–å€¼æ˜¯åˆæ¬¡å–æ•°ç»„é•¿åº¦çš„ä¸€åŠä¸ºå¢é‡ï¼Œä¹‹åæ¯æ¬¡å†å‡åŠï¼Œç›´åˆ°å¢é‡ä¸º1ã€‚æ›´å¥½çš„æ­¥é•¿åºåˆ—å–å€¼å¯ä»¥å‚è€ƒç»´åŸºç™¾ç§‘ã€‚ 2ã€ç®—æ³•æè¿°â‘ . é€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ—t1ï¼Œt2ï¼Œâ€¦ï¼Œtkï¼Œå…¶ä¸­ti&gt;tjï¼Œtk=1ï¼›ï¼ˆä¸€èˆ¬åˆæ¬¡å–æ•°ç»„åŠé•¿ï¼Œä¹‹åæ¯æ¬¡å†å‡åŠï¼Œç›´åˆ°å¢é‡ä¸º1ï¼‰â‘¡. æŒ‰å¢é‡åºåˆ—ä¸ªæ•°kï¼Œå¯¹åºåˆ—è¿›è¡Œk è¶Ÿæ’åºï¼›â‘¢. æ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸ºm çš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ä»…å¢é‡å› å­ä¸º1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚ 3ã€ä»£ç å®ç°ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±çš„å®ç°ï¼Œå¯ä»¥çœ‹åˆ°å®ç°å¾ˆå¹¼ç¨šï¼Œä½†æ˜¯å¥½å¤„æ˜¯ç†è§£èµ·æ¥å¾ˆç®€å•ã€‚å› ä¸ºæ²¡æœ‰ç»è¿‡ä»»ä½•çš„ä¼˜åŒ–ï¼Œæ‰€ä»¥ä¸å»ºè®®å¤§å®¶ç›´æ¥ä½¿ç”¨ã€‚å»ºè®®å¯¹æ¯”ä¸‹æ–¹çš„ç»´åŸºç™¾ç§‘å®˜æ–¹å®ç°ä»£ç ï¼Œç‰¹åˆ«æ˜¯æ­¥é•¿å–å€¼ç­–ç•¥éƒ¨åˆ†ã€‚ 123456789101112131415161718192021222324/** * å¸Œå°”æ’åº * * 1. é€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ—t1ï¼Œt2ï¼Œâ€¦ï¼Œtkï¼Œå…¶ä¸­ti&gt;tjï¼Œtk=1ï¼›ï¼ˆä¸€èˆ¬åˆæ¬¡å–æ•°ç»„åŠé•¿ï¼Œä¹‹åæ¯æ¬¡å†å‡åŠï¼Œç›´åˆ°å¢é‡ä¸º1ï¼‰ * 2. æŒ‰å¢é‡åºåˆ—ä¸ªæ•°kï¼Œå¯¹åºåˆ—è¿›è¡Œk è¶Ÿæ’åºï¼› * 3. æ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸ºm çš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ * ä»…å¢é‡å› å­ä¸º1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚ * @param arr å¾…æ’åºæ•°ç»„ */public static void shellSort(int[] arr)&#123; int gap = arr.length / 2; for (; gap &gt; 0; gap /= 2) &#123; //ä¸æ–­ç¼©å°gapï¼Œç›´åˆ°1ä¸ºæ­¢ for (int j = 0; (j+gap) &lt; arr.length; j++)&#123; //ä½¿ç”¨å½“å‰gapè¿›è¡Œç»„å†…æ’å…¥æ’åº for(int k = 0; (k+gap)&lt; arr.length; k += gap)&#123; if(arr[k] &gt; arr[k+gap]) &#123; int temp = arr[k+gap]; //äº¤æ¢æ“ä½œ arr[k+gap] = arr[k]; arr[k] = temp; System.out.println(\" Sorting: \" + Arrays.toString(arr)); &#125; &#125; &#125; &#125;&#125; æ³¨æ„ï¼š â‘ . ç¬¬ä¸€å±‚forå¾ªç¯è¡¨ç¤ºä¸€å…±æœ‰å¤šå°‘ä¸ªå¢é‡ã€‚å¢é‡çš„åºåˆ—çš„ä¸ªæ•°ï¼Œå°±æ˜¯å¸Œå°”æ’åºçš„è¶Ÿæ•°ã€‚ä¸Šé¢çš„å¢é‡åºåˆ—ä¸ºï¼š arr.length/2, arr.length/2/2, arr.length/2/2/2, .... 2, 1â‘¡. é‡Œå±‚çš„ä¸¤ä¸ªforå¾ªç¯ï¼Œå®é™…ä¸Šå°±æ˜¯ä»¥ä¸€ä¸ªgapæ‹†åˆ†ä¸ºä¸€ç»„çš„ç»„å†…æ’å…¥æ’åºã€‚ ä¸‹é¢æ˜¯ç»´åŸºç™¾ç§‘å®˜æ–¹å®ç°ï¼Œå¤§å®¶æ³¨æ„gapæ­¥é•¿å–å€¼éƒ¨åˆ†ï¼š 1234567891011121314151617181920212223/** * å¸Œå°”æ’åºï¼ˆWikiå®˜æ–¹ç‰ˆï¼‰ * * 1. é€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ—t1ï¼Œt2ï¼Œâ€¦ï¼Œtkï¼Œå…¶ä¸­ti&gt;tjï¼Œtk=1ï¼›ï¼ˆæ³¨æ„æ­¤ç®—æ³•çš„gapå–å€¼ï¼‰ * 2. æŒ‰å¢é‡åºåˆ—ä¸ªæ•°kï¼Œå¯¹åºåˆ—è¿›è¡Œk è¶Ÿæ’åºï¼› * 3. æ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸ºm çš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ * ä»…å¢é‡å› å­ä¸º1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚ * @param arr å¾…æ’åºæ•°ç»„ */public static void shell_sort(int[] arr) &#123; int gap = 1, i, j, len = arr.length; int temp; while (gap &lt; len / 3) gap = gap * 3 + 1; // &lt;O(n^(3/2)) by Knuth,1973&gt;: 1, 4, 13, 40, 121, ... for (; gap &gt; 0; gap /= 3) &#123; for (i = gap; i &lt; len; i++) &#123; temp = arr[i]; for (j = i - gap; j &gt;= 0 &amp;&amp; arr[j] &gt; temp; j -= gap) arr[j + gap] = arr[j]; arr[j + gap] = temp; &#125; &#125;&#125; ä»¥ä¸‹æ˜¯å¸Œå°”æ’åºå¤æ‚åº¦: å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ O(nlog2 n) O(nlog2 n) O(nlog2 n) O(1) ä¸‰ã€é€‰æ‹©æ’åºï¼ˆSelection Sortï¼‰ ä»ç®—æ³•é€»è¾‘ä¸Šçœ‹ï¼Œé€‰æ‹©æ’åºæ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ï¼Œåœ¨ç®€å•é€‰æ‹©æ’åºè¿‡ç¨‹ä¸­ï¼Œæ‰€éœ€ç§»åŠ¨è®°å½•çš„æ¬¡æ•°æ¯”è¾ƒå°‘ã€‚ 1ã€åŸºæœ¬æ€æƒ³é€‰æ‹©æ’åºçš„åŸºæœ¬æ€æƒ³ï¼šæ¯”è¾ƒ + äº¤æ¢ã€‚ åœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æœªæ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ã€‚åœ¨æ‰€æœ‰çš„å®Œå…¨ä¾é äº¤æ¢å»ç§»åŠ¨å…ƒç´ çš„æ’åºæ–¹æ³•ä¸­ï¼Œé€‰æ‹©æ’åºå±äºéå¸¸å¥½çš„ä¸€ç§ã€‚ 2ã€ç®—æ³•æè¿°â‘ . ä»å¾…æ’åºåºåˆ—ä¸­ï¼Œæ‰¾åˆ°å…³é”®å­—æœ€å°çš„å…ƒç´ ï¼›â‘¡. å¦‚æœæœ€å°å…ƒç´ ä¸æ˜¯å¾…æ’åºåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå°†å…¶å’Œç¬¬ä¸€ä¸ªå…ƒç´ äº’æ¢ï¼›â‘¢. ä»ä½™ä¸‹çš„ N - 1 ä¸ªå…ƒç´ ä¸­ï¼Œæ‰¾å‡ºå…³é”®å­—æœ€å°çš„å…ƒç´ ï¼Œé‡å¤â‘ ã€â‘¡æ­¥ï¼Œç›´åˆ°æ’åºç»“æŸã€‚ 3ã€ä»£ç å®ç°é€‰æ‹©æ’åºæ¯”è¾ƒç®€å•ï¼Œä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±çš„å®ç°ï¼Œè·Ÿå®˜æ–¹ç‰ˆå·®ä¸å¤šï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥å‚è€ƒã€‚ 12345678910111213141516171819202122232425/** * é€‰æ‹©æ’åº * * 1. ä»å¾…æ’åºåºåˆ—ä¸­ï¼Œæ‰¾åˆ°å…³é”®å­—æœ€å°çš„å…ƒç´ ï¼› * 2. å¦‚æœæœ€å°å…ƒç´ ä¸æ˜¯å¾…æ’åºåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå°†å…¶å’Œç¬¬ä¸€ä¸ªå…ƒç´ äº’æ¢ï¼› * 3. ä»ä½™ä¸‹çš„ N - 1 ä¸ªå…ƒç´ ä¸­ï¼Œæ‰¾å‡ºå…³é”®å­—æœ€å°çš„å…ƒç´ ï¼Œé‡å¤â‘ ã€â‘¡æ­¥ï¼Œç›´åˆ°æ’åºç»“æŸã€‚ * ä»…å¢é‡å› å­ä¸º1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚ * @param arr å¾…æ’åºæ•°ç»„ */public static void selectionSort(int[] arr)&#123; for(int i = 0; i &lt; arr.length-1; i++)&#123; int min = i; for(int j = i+1; j &lt; arr.length; j++)&#123; //é€‰å‡ºä¹‹åå¾…æ’åºä¸­å€¼æœ€å°çš„ä½ç½® if(arr[j] &lt; arr[min])&#123; min = j; &#125; &#125; if(min != i)&#123; int temp = arr[min]; //äº¤æ¢æ“ä½œ arr[min] = arr[i]; arr[i] = temp; System.out.println(\"Sorting: \" + Arrays.toString(arr)); &#125; &#125;&#125; ä»¥ä¸‹æ˜¯é€‰æ‹©æ’åºå¤æ‚åº¦: å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ O(nÂ²) O(nÂ²) O(nÂ²) O(1) é€‰æ‹©æ’åºçš„ç®€å•å’Œç›´è§‚åå‰¯å…¶å®ï¼Œè¿™ä¹Ÿé€ å°±äº†å®ƒâ€å‡ºäº†åçš„æ…¢æ€§å­â€ï¼Œæ— è®ºæ˜¯å“ªç§æƒ…å†µï¼Œå“ªæ€•åŸæ•°ç»„å·²æ’åºå®Œæˆï¼Œå®ƒä¹Ÿå°†èŠ±è´¹å°†è¿‘nÂ²/2æ¬¡éå†æ¥ç¡®è®¤ä¸€éã€‚å³ä¾¿æ˜¯è¿™æ ·ï¼Œå®ƒçš„æ’åºç»“æœä¹Ÿè¿˜æ˜¯ä¸ç¨³å®šçš„ã€‚ å”¯ä¸€å€¼å¾—é«˜å…´çš„æ˜¯ï¼Œå®ƒå¹¶ä¸è€—è´¹é¢å¤–çš„å†…å­˜ç©ºé—´ã€‚ å››ã€å †æ’åºï¼ˆHeap Sortï¼‰ 1991å¹´çš„è®¡ç®—æœºå…ˆé©±å¥–è·å¾—è€…ã€æ–¯å¦ç¦å¤§å­¦è®¡ç®—æœºç§‘å­¦ç³»æ•™æˆç½—ä¼¯ç‰¹Â·å¼—æ´›ä¼Šå¾·(Robert Wï¼Floyd) å’Œå¨å»‰å§†æ–¯(Jï¼Williams) åœ¨1964å¹´å…±åŒå‘æ˜äº†è‘—åçš„å †æ’åºç®—æ³•(Heap Sort). å †çš„å®šä¹‰å¦‚ä¸‹ï¼š$n$ä¸ªå…ƒç´ çš„åºåˆ— $\\left\\{{k_1,k_2,Â·Â·Â·,k_n}\\right\\}$ å½“ä¸”ä»…å½“æ»¡è¶³ä¸‹å…³ç³»æ—¶ï¼Œç§°ä¹‹ä¸ºå †ã€‚ $$ \\left\\{ \\begin{aligned} k_i & \\leqslant k_{2i} \\\\ k_i & \\leqslant k_{2i+1} \\end{aligned} \\right. \\quad æˆ– \\quad \\left\\{ \\begin{aligned} k_i & \\geqslant k_{2i} \\\\ k_i & \\geqslant k_{2i+1} \\end{aligned} \\right. \\quad (i = 1,2,Â·Â·Â·, \\left \\lfloor { \\frac{n}{2} } \\right \\rfloor ) $$ æŠŠæ­¤åºåˆ—å¯¹åº”çš„äºŒç»´æ•°ç»„çœ‹æˆä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ã€‚é‚£ä¹ˆå †çš„å«ä¹‰å°±æ˜¯ï¼šå®Œå…¨äºŒå‰æ ‘ä¸­ä»»ä½•ä¸€ä¸ªéå¶å­èŠ‚ç‚¹çš„å€¼å‡ä¸å¤§äºï¼ˆæˆ–ä¸å°äºï¼‰å…¶å·¦ï¼Œå³å­©å­èŠ‚ç‚¹çš„å€¼ã€‚ç”±ä¸Šè¿°æ€§è´¨å¯çŸ¥å¤§é¡¶å †çš„å †é¡¶çš„å…³é”®å­—è‚¯å®šæ˜¯æ‰€æœ‰å…³é”®å­—ä¸­æœ€å¤§çš„ï¼Œå°é¡¶å †çš„å †é¡¶çš„å…³é”®å­—æ˜¯æ‰€æœ‰å…³é”®å­—ä¸­æœ€å°çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä½¿ç”¨å¤§é¡¶å †è¿›è¡Œå‡åºæ’åº, ä½¿ç”¨å°é¡¶å †è¿›è¡Œé™åºæ’åºã€‚ 1ã€åŸºæœ¬æ€æƒ³æ­¤å¤„ä»¥å¤§é¡¶å †ä¸ºä¾‹ï¼Œå †æ’åºçš„è¿‡ç¨‹å°±æ˜¯å°†å¾…æ’åºçš„åºåˆ—æ„é€ æˆä¸€ä¸ªå †ï¼Œé€‰å‡ºå †ä¸­æœ€å¤§çš„ç§»èµ°ï¼Œå†æŠŠå‰©ä½™çš„å…ƒç´ è°ƒæ•´æˆå †ï¼Œæ‰¾å‡ºæœ€å¤§çš„å†ç§»èµ°ï¼Œé‡å¤ç›´è‡³æœ‰åºã€‚ 2ã€ç®—æ³•æè¿°â‘ . å…ˆå°†åˆå§‹åºåˆ—$K[1..n]$å»ºæˆä¸€ä¸ªå¤§é¡¶å †, é‚£ä¹ˆæ­¤æ—¶ç¬¬ä¸€ä¸ªå…ƒç´ $K_1$æœ€å¤§, æ­¤å †ä¸ºåˆå§‹çš„æ— åºåŒº.â‘¡. å†å°†å…³é”®å­—æœ€å¤§çš„è®°å½•$K_1$ (å³å †é¡¶, ç¬¬ä¸€ä¸ªå…ƒç´ )å’Œæ— åºåŒºçš„æœ€åä¸€ä¸ªè®°å½• $K_n$ äº¤æ¢, ç”±æ­¤å¾—åˆ°æ–°çš„æ— åºåŒº$K[1..n-1]$å’Œæœ‰åºåŒº$K[n]$, ä¸”æ»¡è¶³$K[1..n-1].keys \\leqslant K[n].key$â‘¢. äº¤æ¢$K_1$ å’Œ $K_n$ å, å †é¡¶å¯èƒ½è¿åå †æ€§è´¨, å› æ­¤éœ€å°†$K[1..n-1]$è°ƒæ•´ä¸ºå †. ç„¶åé‡å¤æ­¥éª¤â‘¡, ç›´åˆ°æ— åºåŒºåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢. åŠ¨å›¾æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š 3ã€ä»£ç å®ç°ä»ç®—æ³•æè¿°æ¥çœ‹ï¼Œå †æ’åºéœ€è¦ä¸¤ä¸ªè¿‡ç¨‹ï¼Œä¸€æ˜¯å»ºç«‹å †ï¼ŒäºŒæ˜¯å †é¡¶ä¸å †çš„æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚æ‰€ä»¥å †æ’åºæœ‰ä¸¤ä¸ªå‡½æ•°ç»„æˆã€‚ä¸€æ˜¯å»ºå †å‡½æ•°ï¼ŒäºŒæ˜¯åå¤è°ƒç”¨å»ºå †å‡½æ•°ä»¥é€‰æ‹©å‡ºå‰©ä½™æœªæ’å…ƒç´ ä¸­æœ€å¤§çš„æ•°æ¥å®ç°æ’åºçš„å‡½æ•°ã€‚ æ€»ç»“èµ·æ¥å°±æ˜¯å®šä¹‰äº†ä»¥ä¸‹å‡ ç§æ“ä½œï¼š æœ€å¤§å †è°ƒæ•´ï¼ˆMax_Heapifyï¼‰ï¼šå°†å †çš„æœ«ç«¯å­èŠ‚ç‚¹ä½œè°ƒæ•´ï¼Œä½¿å¾—å­èŠ‚ç‚¹æ°¸è¿œå°äºçˆ¶èŠ‚ç‚¹ åˆ›å»ºæœ€å¤§å †ï¼ˆBuild_Max_Heapï¼‰ï¼šå°†å †æ‰€æœ‰æ•°æ®é‡æ–°æ’åº å †æ’åºï¼ˆHeapSortï¼‰ï¼šç§»é™¤ä½åœ¨ç¬¬ä¸€ä¸ªæ•°æ®çš„æ ¹èŠ‚ç‚¹ï¼Œå¹¶åšæœ€å¤§å †è°ƒæ•´çš„é€’å½’è¿ç®— å¯¹äºå †èŠ‚ç‚¹çš„è®¿é—®ï¼š çˆ¶èŠ‚ç‚¹içš„å·¦å­èŠ‚ç‚¹åœ¨ä½ç½®ï¼š(2*i+1); çˆ¶èŠ‚ç‚¹içš„å³å­èŠ‚ç‚¹åœ¨ä½ç½®ï¼š(2*i+2); å­èŠ‚ç‚¹içš„çˆ¶èŠ‚ç‚¹åœ¨ä½ç½®ï¼šfloor((i-1)/2); 1234567891011121314151617181920212223242526272829303132333435363738/** * å †æ’åº * * 1. å…ˆå°†åˆå§‹åºåˆ—K[1..n]å»ºæˆä¸€ä¸ªå¤§é¡¶å †, é‚£ä¹ˆæ­¤æ—¶ç¬¬ä¸€ä¸ªå…ƒç´ K1æœ€å¤§, æ­¤å †ä¸ºåˆå§‹çš„æ— åºåŒº. * 2. å†å°†å…³é”®å­—æœ€å¤§çš„è®°å½•K1 (å³å †é¡¶, ç¬¬ä¸€ä¸ªå…ƒç´ )å’Œæ— åºåŒºçš„æœ€åä¸€ä¸ªè®°å½• Kn äº¤æ¢, ç”±æ­¤å¾—åˆ°æ–°çš„æ— åºåŒºK[1..nâˆ’1]å’Œæœ‰åºåŒºK[n], ä¸”æ»¡è¶³K[1..nâˆ’1].keysâ©½K[n].key * 3. äº¤æ¢K1 å’Œ Kn å, å †é¡¶å¯èƒ½è¿åå †æ€§è´¨, å› æ­¤éœ€å°†K[1..nâˆ’1]è°ƒæ•´ä¸ºå †. ç„¶åé‡å¤æ­¥éª¤â‘¡, ç›´åˆ°æ— åºåŒºåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢. * @param arr å¾…æ’åºæ•°ç»„ */public static void heapSort(int[] arr)&#123; for(int i = arr.length; i &gt; 0; i--)&#123; max_heapify(arr, i); int temp = arr[0]; //å †é¡¶å…ƒç´ (ç¬¬ä¸€ä¸ªå…ƒç´ )ä¸Knäº¤æ¢ arr[0] = arr[i-1]; arr[i-1] = temp; &#125;&#125;private static void max_heapify(int[] arr, int limit)&#123; if(arr.length &lt;= 0 || arr.length &lt; limit) return; int parentIdx = limit / 2; for(; parentIdx &gt;= 0; parentIdx--)&#123; if(parentIdx * 2 &gt;= limit)&#123; continue; &#125; int left = parentIdx * 2; //å·¦å­èŠ‚ç‚¹ä½ç½® int right = (left + 1) &gt;= limit ? left : (left + 1); //å³å­èŠ‚ç‚¹ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰å³èŠ‚ç‚¹ï¼Œé»˜è®¤ä¸ºå·¦èŠ‚ç‚¹ä½ç½® int maxChildId = arr[left] &gt;= arr[right] ? left : right; if(arr[maxChildId] &gt; arr[parentIdx])&#123; //äº¤æ¢çˆ¶èŠ‚ç‚¹ä¸å·¦å³å­èŠ‚ç‚¹ä¸­çš„æœ€å¤§å€¼ int temp = arr[parentIdx]; arr[parentIdx] = arr[maxChildId]; arr[maxChildId] = temp; &#125; &#125; System.out.println(\"Max_Heapify: \" + Arrays.toString(arr));&#125; æ³¨: x&gt;&gt;1 æ˜¯ä½è¿ç®—ä¸­çš„å³ç§»è¿ç®—, è¡¨ç¤ºå³ç§»ä¸€ä½, ç­‰åŒäºxé™¤ä»¥2å†å–æ•´, å³ x&gt;&gt;1 == Math.floor(x/2) . ä»¥ä¸Š,â‘ . å»ºç«‹å †çš„è¿‡ç¨‹, ä»length/2 ä¸€ç›´å¤„ç†åˆ°0, æ—¶é—´å¤æ‚åº¦ä¸ºO(n);â‘¡. è°ƒæ•´å †çš„è¿‡ç¨‹æ˜¯æ²¿ç€å †çš„çˆ¶å­èŠ‚ç‚¹è¿›è¡Œè°ƒæ•´, æ‰§è¡Œæ¬¡æ•°ä¸ºå †çš„æ·±åº¦, æ—¶é—´å¤æ‚åº¦ä¸ºO(lgn);â‘¢. å †æ’åºçš„è¿‡ç¨‹ç”±næ¬¡ç¬¬â‘¡æ­¥å®Œæˆ, æ—¶é—´å¤æ‚åº¦ä¸ºO(nlgn). å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ $O(n \\log_{2}n)$ $O(n \\log_{2}n)$ $O(n \\log_{2}n)$ O(1) Tips: ç”±äºå †æ’åºä¸­åˆå§‹åŒ–å †çš„è¿‡ç¨‹æ¯”è¾ƒæ¬¡æ•°è¾ƒå¤š, å› æ­¤å®ƒä¸å¤ªé€‚ç”¨äºå°åºåˆ—. åŒæ—¶ç”±äºå¤šæ¬¡ä»»æ„ä¸‹æ ‡ç›¸äº’äº¤æ¢ä½ç½®, ç›¸åŒå…ƒç´ ä¹‹é—´åŸæœ¬ç›¸å¯¹çš„é¡ºåºè¢«ç ´åäº†, å› æ­¤, å®ƒæ˜¯ä¸ç¨³å®šçš„æ’åº. äº”ã€å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰ æˆ‘æƒ³å¯¹äºå®ƒæ¯ä¸ªå­¦è¿‡Cè¯­è¨€çš„éƒ½ä¼šäº†è§£ï¼Œè¿™å¯èƒ½æ˜¯å¾ˆå¤šäººæ¥è§¦çš„ç¬¬ä¸€ä¸ªæ’åºç®—æ³•ã€‚ 1ã€åŸºæœ¬æ€æƒ³å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰æ˜¯ä¸€ç§ç®€å•çš„æ’åºç®—æ³•ã€‚å®ƒé‡å¤åœ°èµ°è®¿è¿‡è¦æ’åºçš„æ•°åˆ—ï¼Œä¸€æ¬¡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœä»–ä»¬çš„é¡ºåºé”™è¯¯å°±æŠŠä»–ä»¬äº¤æ¢è¿‡æ¥ã€‚èµ°è®¿æ•°åˆ—çš„å·¥ä½œæ˜¯é‡å¤åœ°è¿›è¡Œç›´åˆ°æ²¡æœ‰å†éœ€è¦äº¤æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥æ•°åˆ—å·²ç»æ’åºå®Œæˆã€‚è¿™ä¸ªç®—æ³•çš„åå­—ç”±æ¥æ˜¯å› ä¸ºè¶Šå°çš„å…ƒç´ ä¼šç»ç”±äº¤æ¢æ…¢æ…¢â€œæµ®â€åˆ°æ•°åˆ—çš„é¡¶ç«¯ã€‚ 2ã€ç®—æ³•æè¿°å†’æ³¡æ’åºç®—æ³•çš„è¿ä½œå¦‚ä¸‹ï¼š â‘ . æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚â‘¡. å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚è¿™æ­¥åšå®Œåï¼Œæœ€åçš„å…ƒç´ ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚â‘¢. é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚â‘£. æŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤â‘ ~â‘¢ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚ 3ã€ä»£ç å®ç°å†’æ³¡æ’åºéœ€è¦ä¸¤ä¸ªåµŒå¥—çš„å¾ªç¯. å…¶ä¸­, å¤–å±‚å¾ªç¯ç§»åŠ¨æ¸¸æ ‡; å†…å±‚å¾ªç¯éå†æ¸¸æ ‡åŠä¹‹å(æˆ–ä¹‹å‰)çš„å…ƒç´ , é€šè¿‡ä¸¤ä¸¤äº¤æ¢çš„æ–¹å¼, æ¯æ¬¡åªç¡®ä¿è¯¥å†…å¾ªç¯ç»“æŸä½ç½®æ’åºæ­£ç¡®, ç„¶åå†…å±‚å¾ªç¯å‘¨æœŸç»“æŸ, äº¤ç”±å¤–å±‚å¾ªç¯å¾€å(æˆ–å‰)ç§»åŠ¨æ¸¸æ ‡, éšå³å¼€å§‹ä¸‹ä¸€è½®å†…å±‚å¾ªç¯, ä»¥æ­¤ç±»æ¨, ç›´è‡³å¾ªç¯ç»“æŸ. 123456789101112131415161718192021/** * å†’æ³¡æ’åº * * â‘ . æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚ * â‘¡. å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚è¿™æ­¥åšå®Œåï¼Œæœ€åçš„å…ƒç´ ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚ * â‘¢. é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚ * â‘£. æŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤â‘ ~â‘¢ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚ * @param arr å¾…æ’åºæ•°ç»„ */public static void bubbleSort(int[] arr)&#123; for (int i = arr.length; i &gt; 0; i--) &#123; //å¤–å±‚å¾ªç¯ç§»åŠ¨æ¸¸æ ‡ for(int j = 0; j &lt; i &amp;&amp; (j+1) &lt; i; j++)&#123; //å†…å±‚å¾ªç¯éå†æ¸¸æ ‡åŠä¹‹å(æˆ–ä¹‹å‰)çš„å…ƒç´  if(arr[j] &gt; arr[j+1])&#123; int temp = arr[j]; arr[j] = arr[j+1]; arr[j+1] = temp; System.out.println(\"Sorting: \" + Arrays.toString(arr)); &#125; &#125; &#125;&#125; ä»¥ä¸‹æ˜¯å†’æ³¡æ’åºç®—æ³•å¤æ‚åº¦: å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ O(nÂ²) O(n) O(nÂ²) O(1) å†’æ³¡æ’åºæ˜¯æœ€å®¹æ˜“å®ç°çš„æ’åº, æœ€åçš„æƒ…å†µæ˜¯æ¯æ¬¡éƒ½éœ€è¦äº¤æ¢, å…±éœ€éå†å¹¶äº¤æ¢å°†è¿‘nÂ²/2æ¬¡, æ—¶é—´å¤æ‚åº¦ä¸ºO(nÂ²). æœ€ä½³çš„æƒ…å†µæ˜¯å†…å¾ªç¯éå†ä¸€æ¬¡åå‘ç°æ’åºæ˜¯å¯¹çš„, å› æ­¤é€€å‡ºå¾ªç¯, æ—¶é—´å¤æ‚åº¦ä¸ºO(n). å¹³å‡æ¥è®², æ—¶é—´å¤æ‚åº¦ä¸ºO(nÂ²). ç”±äºå†’æ³¡æ’åºä¸­åªæœ‰ç¼“å­˜çš„tempå˜é‡éœ€è¦å†…å­˜ç©ºé—´, å› æ­¤ç©ºé—´å¤æ‚åº¦ä¸ºå¸¸é‡O(1). Tips: ç”±äºå†’æ³¡æ’åºåªåœ¨ç›¸é‚»å…ƒç´ å¤§å°ä¸ç¬¦åˆè¦æ±‚æ—¶æ‰è°ƒæ¢ä»–ä»¬çš„ä½ç½®, å®ƒå¹¶ä¸æ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåº, å› æ­¤å®ƒæ˜¯ç¨³å®šçš„æ’åºç®—æ³•. å…­ã€å¿«é€Ÿæ’åºï¼ˆQuick Sortï¼‰ å¿«é€Ÿæ’åºï¼ˆQuicksortï¼‰æ˜¯å¯¹å†’æ³¡æ’åºçš„ä¸€ç§æ”¹è¿›ï¼Œå€Ÿç”¨äº†åˆ†æ²»çš„æ€æƒ³ï¼Œç”±C. A. R. Hoareåœ¨1962å¹´æå‡ºã€‚ 1ã€åŸºæœ¬æ€æƒ³å¿«é€Ÿæ’åºçš„åŸºæœ¬æ€æƒ³ï¼šæŒ–å‘å¡«æ•°+åˆ†æ²»æ³•ã€‚ é¦–å…ˆé€‰ä¸€ä¸ªè½´å€¼(pivotï¼Œä¹Ÿæœ‰å«åŸºå‡†çš„)ï¼Œé€šè¿‡ä¸€è¶Ÿæ’åºå°†å¾…æ’è®°å½•åˆ†éš”æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†è®°å½•çš„å…³é”®å­—å‡æ¯”å¦ä¸€éƒ¨åˆ†çš„å…³é”®å­—å°ï¼Œåˆ™å¯åˆ†åˆ«å¯¹è¿™ä¸¤éƒ¨åˆ†è®°å½•ç»§ç»­è¿›è¡Œæ’åºï¼Œä»¥è¾¾åˆ°æ•´ä¸ªåºåˆ—æœ‰åºã€‚ 2ã€ç®—æ³•æè¿°å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»ç­–ç•¥æ¥æŠŠä¸€ä¸ªåºåˆ—ï¼ˆlistï¼‰åˆ†ä¸ºä¸¤ä¸ªå­åºåˆ—ï¼ˆsub-listsï¼‰ã€‚æ­¥éª¤ä¸ºï¼š â‘ . ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸ºâ€åŸºå‡†â€ï¼ˆpivotï¼‰ã€‚â‘¡. é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å°çš„å…ƒç´ æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å¤§çš„å…ƒç´ æ‘†åœ¨åŸºå‡†åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºç»“æŸä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œã€‚â‘¢. é€’å½’åœ°ï¼ˆrecursivelyï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºã€‚ é€’å½’åˆ°æœ€åº•éƒ¨æ—¶ï¼Œæ•°åˆ—çš„å¤§å°æ˜¯é›¶æˆ–ä¸€ï¼Œä¹Ÿå°±æ˜¯å·²ç»æ’åºå¥½äº†ã€‚è¿™ä¸ªç®—æ³•ä¸€å®šä¼šç»“æŸï¼Œå› ä¸ºåœ¨æ¯æ¬¡çš„è¿­ä»£ï¼ˆiterationï¼‰ä¸­ï¼Œå®ƒè‡³å°‘ä¼šæŠŠä¸€ä¸ªå…ƒç´ æ‘†åˆ°å®ƒæœ€åçš„ä½ç½®å»ã€‚ 3ã€ä»£ç å®ç°ç”¨ä¼ªä»£ç æè¿°å¦‚ä¸‹ï¼š â‘ . i = L; j = R; å°†åŸºå‡†æ•°æŒ–å‡ºå½¢æˆç¬¬ä¸€ä¸ªå‘a[i]ã€‚â‘¡ï¼j--ï¼Œç”±åå‘å‰æ‰¾æ¯”å®ƒå°çš„æ•°ï¼Œæ‰¾åˆ°åæŒ–å‡ºæ­¤æ•°å¡«å‰ä¸€ä¸ªå‘a[i]ä¸­ã€‚â‘¢ï¼i++ï¼Œç”±å‰å‘åæ‰¾æ¯”å®ƒå¤§çš„æ•°ï¼Œæ‰¾åˆ°åä¹ŸæŒ–å‡ºæ­¤æ•°å¡«åˆ°å‰ä¸€ä¸ªå‘a[j]ä¸­ã€‚â‘£ï¼å†é‡å¤æ‰§è¡Œâ‘¡ï¼Œâ‘¢äºŒæ­¥ï¼Œç›´åˆ°i==jï¼Œå°†åŸºå‡†æ•°å¡«å…¥a[i]ä¸­ 1234567891011121314151617181920212223242526272829303132/** * å¿«é€Ÿæ’åºï¼ˆé€’å½’ï¼‰ * * â‘ . ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º\"åŸºå‡†\"ï¼ˆpivotï¼‰ã€‚ * â‘¡. é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å°çš„å…ƒç´ æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å¤§çš„å…ƒç´ æ‘†åœ¨åŸºå‡†åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºç»“æŸä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œã€‚ * â‘¢. é€’å½’åœ°ï¼ˆrecursivelyï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºã€‚ * @param arr å¾…æ’åºæ•°ç»„ * @param low å·¦è¾¹ç•Œ * @param high å³è¾¹ç•Œ */public static void quickSort(int[] arr, int low, int high)&#123; if(arr.length &lt;= 0) return; if(low &gt;= high) return; int left = low; int right = high; int temp = arr[left]; //æŒ–å‘1ï¼šä¿å­˜åŸºå‡†çš„å€¼ while (left &lt; right)&#123; while(left &lt; right &amp;&amp; arr[right] &gt;= temp)&#123; //å‘2ï¼šä»åå‘å‰æ‰¾åˆ°æ¯”åŸºå‡†å°çš„å…ƒç´ ï¼Œæ’å…¥åˆ°åŸºå‡†ä½ç½®å‘1ä¸­ right--; &#125; arr[left] = arr[right]; while(left &lt; right &amp;&amp; arr[left] &lt;= temp)&#123; //å‘3ï¼šä»å‰å¾€åæ‰¾åˆ°æ¯”åŸºå‡†å¤§çš„å…ƒç´ ï¼Œæ”¾åˆ°åˆšæ‰æŒ–çš„å‘2ä¸­ left++; &#125; arr[right] = arr[left]; &#125; arr[left] = temp; //åŸºå‡†å€¼å¡«è¡¥åˆ°å‘3ä¸­ï¼Œå‡†å¤‡åˆ†æ²»é€’å½’å¿«æ’ System.out.println(\"Sorting: \" + Arrays.toString(arr)); quickSort(arr, low, left-1); quickSort(arr, left+1, high);&#125; ä¸Šé¢æ˜¯é€’å½’ç‰ˆçš„å¿«é€Ÿæ’åºï¼šé€šè¿‡æŠŠåŸºå‡†tempæ’å…¥åˆ°åˆé€‚çš„ä½ç½®æ¥å®ç°åˆ†æ²»ï¼Œå¹¶é€’å½’åœ°å¯¹åˆ†æ²»åçš„ä¸¤ä¸ªåˆ’åˆ†ç»§ç»­å¿«æ’ã€‚é‚£ä¹ˆéé€’å½’ç‰ˆçš„å¿«æ’å¦‚ä½•å®ç°å‘¢ï¼Ÿ å› ä¸ºé€’å½’çš„æœ¬è´¨æ˜¯æ ˆï¼Œæ‰€ä»¥æˆ‘ä»¬éé€’å½’å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å€ŸåŠ©æ ˆæ¥ä¿å­˜ä¸­é—´å˜é‡å°±å¯ä»¥å®ç°éé€’å½’äº†ã€‚åœ¨è¿™é‡Œä¸­é—´å˜é‡ä¹Ÿå°±æ˜¯é€šè¿‡Pritationå‡½æ•°åˆ’åˆ†åŒºé—´ä¹‹ååˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†çš„é¦–å°¾æŒ‡é’ˆï¼Œåªéœ€è¦ä¿å­˜è¿™ä¸¤éƒ¨åˆ†çš„é¦–å°¾æŒ‡é’ˆå³å¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/** * å¿«é€Ÿæ’åºï¼ˆéé€’å½’ï¼‰ * * â‘ . ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸º\"åŸºå‡†\"ï¼ˆpivotï¼‰ã€‚ * â‘¡. é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å°çš„å…ƒç´ æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å¤§çš„å…ƒç´ æ‘†åœ¨åŸºå‡†åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºç»“æŸä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œã€‚ * â‘¢. æŠŠåˆ†åŒºä¹‹åä¸¤ä¸ªåŒºé—´çš„è¾¹ç•Œï¼ˆlowå’Œhighï¼‰å‹å…¥æ ˆä¿å­˜ï¼Œå¹¶å¾ªç¯â‘ ã€â‘¡æ­¥éª¤ * @param arr å¾…æ’åºæ•°ç»„ */public static void quickSortByStack(int[] arr)&#123; if(arr.length &lt;= 0) return; Stack&lt;Integer&gt; stack = new Stack&lt;Integer&gt;(); //åˆå§‹çŠ¶æ€çš„å·¦å³æŒ‡é’ˆå…¥æ ˆ stack.push(0); stack.push(arr.length - 1); while(!stack.isEmpty())&#123; int high = stack.pop(); //å‡ºæ ˆè¿›è¡Œåˆ’åˆ† int low = stack.pop(); int pivotIdx = partition(arr, low, high); //ä¿å­˜ä¸­é—´å˜é‡ if(pivotIdx &gt; low) &#123; stack.push(low); stack.push(pivotIdx - 1); &#125; if(pivotIdx &lt; high &amp;&amp; pivotIdx &gt;= 0)&#123; stack.push(pivotIdx + 1); stack.push(high); &#125; &#125;&#125;private static int partition(int[] arr, int low, int high)&#123; if(arr.length &lt;= 0) return -1; if(low &gt;= high) return -1; int l = low; int r = high; int pivot = arr[l]; //æŒ–å‘1ï¼šä¿å­˜åŸºå‡†çš„å€¼ while(l &lt; r)&#123; while(l &lt; r &amp;&amp; arr[r] &gt;= pivot)&#123; //å‘2ï¼šä»åå‘å‰æ‰¾åˆ°æ¯”åŸºå‡†å°çš„å…ƒç´ ï¼Œæ’å…¥åˆ°åŸºå‡†ä½ç½®å‘1ä¸­ r--; &#125; arr[l] = arr[r]; while(l &lt; r &amp;&amp; arr[l] &lt;= pivot)&#123; //å‘3ï¼šä»å‰å¾€åæ‰¾åˆ°æ¯”åŸºå‡†å¤§çš„å…ƒç´ ï¼Œæ”¾åˆ°åˆšæ‰æŒ–çš„å‘2ä¸­ l++; &#125; arr[r] = arr[l]; &#125; arr[l] = pivot; //åŸºå‡†å€¼å¡«è¡¥åˆ°å‘3ä¸­ï¼Œå‡†å¤‡åˆ†æ²»é€’å½’å¿«æ’ return l;&#125; å¿«é€Ÿæ’åºæ˜¯é€šå¸¸è¢«è®¤ä¸ºåœ¨åŒæ•°é‡çº§ï¼ˆO(nlog2n)ï¼‰çš„æ’åºæ–¹æ³•ä¸­å¹³å‡æ€§èƒ½æœ€å¥½çš„ã€‚ä½†è‹¥åˆå§‹åºåˆ—æŒ‰å…³é”®ç æœ‰åºæˆ–åŸºæœ¬æœ‰åºæ—¶ï¼Œå¿«æ’åºåè€Œèœ•åŒ–ä¸ºå†’æ³¡æ’åºã€‚ä¸ºæ”¹è¿›ä¹‹ï¼Œé€šå¸¸ä»¥â€œä¸‰è€…å–ä¸­æ³•â€æ¥é€‰å–åŸºå‡†è®°å½•ï¼Œå³å°†æ’åºåŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹ä¸ä¸­ç‚¹ä¸‰ä¸ªè®°å½•å…³é”®ç å±…ä¸­çš„è°ƒæ•´ä¸ºæ”¯ç‚¹è®°å½•ã€‚å¿«é€Ÿæ’åºæ˜¯ä¸€ä¸ªä¸ç¨³å®šçš„æ’åºæ–¹æ³•ã€‚ ä»¥ä¸‹æ˜¯å¿«é€Ÿæ’åºç®—æ³•å¤æ‚åº¦: å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ O(nlogâ‚‚n) O(nlogâ‚‚n) O(nÂ²) O(1)ï¼ˆåŸåœ°åˆ†åŒºé€’å½’ç‰ˆï¼‰ å¿«é€Ÿæ’åºæ’åºæ•ˆç‡éå¸¸é«˜ã€‚ è™½ç„¶å®ƒè¿è¡Œæœ€ç³Ÿç³•æ—¶å°†è¾¾åˆ°O(nÂ²)çš„æ—¶é—´å¤æ‚åº¦, ä½†é€šå¸¸å¹³å‡æ¥çœ‹, å®ƒçš„æ—¶é—´å¤æ‚ä¸ºO(nlogn), æ¯”åŒæ ·ä¸ºO(nlogn)æ—¶é—´å¤æ‚åº¦çš„å½’å¹¶æ’åºè¿˜è¦å¿«. å¿«é€Ÿæ’åºä¼¼ä¹æ›´åçˆ±ä¹±åºçš„æ•°åˆ—, è¶Šæ˜¯ä¹±åºçš„æ•°åˆ—, å®ƒç›¸æ¯”å…¶ä»–æ’åºè€Œè¨€, ç›¸å¯¹æ•ˆç‡æ›´é«˜. Tips: åŒé€‰æ‹©æ’åºç›¸ä¼¼, å¿«é€Ÿæ’åºæ¯æ¬¡äº¤æ¢çš„å…ƒç´ éƒ½æœ‰å¯èƒ½ä¸æ˜¯ç›¸é‚»çš„, å› æ­¤å®ƒæœ‰å¯èƒ½æ‰“ç ´åŸæ¥å€¼ä¸ºç›¸åŒçš„å…ƒç´ ä¹‹é—´çš„é¡ºåº. å› æ­¤, å¿«é€Ÿæ’åºå¹¶ä¸ç¨³å®š. ä¸ƒã€å½’å¹¶æ’åºï¼ˆMerging Sortï¼‰ å½’å¹¶æ’åºæ˜¯å»ºç«‹åœ¨å½’å¹¶æ“ä½œä¸Šçš„ä¸€ç§æœ‰æ•ˆçš„æ’åºç®—æ³•ï¼Œ1945å¹´ç”±çº¦ç¿°Â·å†¯Â·è¯ºä¼Šæ›¼é¦–æ¬¡æå‡ºã€‚è¯¥ç®—æ³•æ˜¯é‡‡ç”¨åˆ†æ²»æ³•ï¼ˆDivide and Conquerï¼‰çš„ä¸€ä¸ªéå¸¸å…¸å‹çš„åº”ç”¨ï¼Œä¸”å„å±‚åˆ†æ²»é€’å½’å¯ä»¥åŒæ—¶è¿›è¡Œã€‚ 1ã€åŸºæœ¬æ€æƒ³å½’å¹¶æ’åºç®—æ³•æ˜¯å°†ä¸¤ä¸ªï¼ˆæˆ–ä¸¤ä¸ªä»¥ä¸Šï¼‰æœ‰åºè¡¨åˆå¹¶æˆä¸€ä¸ªæ–°çš„æœ‰åºè¡¨ï¼Œå³æŠŠå¾…æ’åºåºåˆ—åˆ†ä¸ºè‹¥å¹²ä¸ªå­åºåˆ—ï¼Œæ¯ä¸ªå­åºåˆ—æ˜¯æœ‰åºçš„ã€‚ç„¶åå†æŠŠæœ‰åºå­åºåˆ—åˆå¹¶ä¸ºæ•´ä½“æœ‰åºåºåˆ—ã€‚ 2ã€ç®—æ³•æè¿°å½’å¹¶æ’åºå¯é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°ï¼š è‡ªä¸Šè€Œä¸‹çš„é€’å½’ è‡ªä¸‹è€Œä¸Šçš„è¿­ä»£ ä¸€ã€é€’å½’æ³•ï¼ˆå‡è®¾åºåˆ—å…±æœ‰nä¸ªå…ƒç´ ï¼‰ï¼š â‘ . å°†åºåˆ—æ¯ç›¸é‚»ä¸¤ä¸ªæ•°å­—è¿›è¡Œå½’å¹¶æ“ä½œï¼Œå½¢æˆ floor(n/2)ä¸ªåºåˆ—ï¼Œæ’åºåæ¯ä¸ªåºåˆ—åŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼›â‘¡. å°†ä¸Šè¿°åºåˆ—å†æ¬¡å½’å¹¶ï¼Œå½¢æˆ floor(n/4)ä¸ªåºåˆ—ï¼Œæ¯ä¸ªåºåˆ—åŒ…å«å››ä¸ªå…ƒç´ ï¼›â‘¢. é‡å¤æ­¥éª¤â‘¡ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ æ’åºå®Œæ¯•ã€‚ äºŒã€è¿­ä»£æ³• â‘ . ç”³è¯·ç©ºé—´ï¼Œä½¿å…¶å¤§å°ä¸ºä¸¤ä¸ªå·²ç»æ’åºåºåˆ—ä¹‹å’Œï¼Œè¯¥ç©ºé—´ç”¨æ¥å­˜æ”¾åˆå¹¶åçš„åºåˆ—â‘¡. è®¾å®šä¸¤ä¸ªæŒ‡é’ˆï¼Œæœ€åˆä½ç½®åˆ†åˆ«ä¸ºä¸¤ä¸ªå·²ç»æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®â‘¢. æ¯”è¾ƒä¸¤ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„å…ƒç´ ï¼Œé€‰æ‹©ç›¸å¯¹å°çš„å…ƒç´ æ”¾å…¥åˆ°åˆå¹¶ç©ºé—´ï¼Œå¹¶ç§»åŠ¨æŒ‡é’ˆåˆ°ä¸‹ä¸€ä½ç½®â‘£. é‡å¤æ­¥éª¤â‘¢ç›´åˆ°æŸä¸€æŒ‡é’ˆåˆ°è¾¾åºåˆ—å°¾â‘¤. å°†å¦ä¸€åºåˆ—å‰©ä¸‹çš„æ‰€æœ‰å…ƒç´ ç›´æ¥å¤åˆ¶åˆ°åˆå¹¶åºåˆ—å°¾ 3ã€ä»£ç å®ç°å½’å¹¶æ’åºå…¶å®è¦åšä¸¤ä»¶äº‹ï¼š åˆ†è§£ï¼šå°†åºåˆ—æ¯æ¬¡æŠ˜åŠæ‹†åˆ† åˆå¹¶ï¼šå°†åˆ’åˆ†åçš„åºåˆ—æ®µä¸¤ä¸¤æ’åºåˆå¹¶ å› æ­¤ï¼Œå½’å¹¶æ’åºå®é™…ä¸Šå°±æ˜¯ä¸¤ä¸ªæ“ä½œï¼Œæ‹†åˆ†+åˆå¹¶ å¦‚ä½•åˆå¹¶ï¼Ÿ L[firstâ€¦mid]ä¸ºç¬¬ä¸€æ®µï¼ŒL[mid+1â€¦last]ä¸ºç¬¬äºŒæ®µï¼Œå¹¶ä¸”ä¸¤ç«¯å·²ç»æœ‰åºï¼Œç°åœ¨æˆ‘ä»¬è¦å°†ä¸¤ç«¯åˆæˆè¾¾åˆ°L[firstâ€¦last]å¹¶ä¸”ä¹Ÿæœ‰åºã€‚ é¦–å…ˆä¾æ¬¡ä»ç¬¬ä¸€æ®µä¸ç¬¬äºŒæ®µä¸­å–å‡ºå…ƒç´ æ¯”è¾ƒï¼Œå°†è¾ƒå°çš„å…ƒç´ èµ‹å€¼ç»™temp[]é‡å¤æ‰§è¡Œä¸Šä¸€æ­¥ï¼Œå½“æŸä¸€æ®µèµ‹å€¼ç»“æŸï¼Œåˆ™å°†å¦ä¸€æ®µå‰©ä¸‹çš„å…ƒç´ èµ‹å€¼ç»™temp[]æ­¤æ—¶å°†temp[]ä¸­çš„å…ƒç´ å¤åˆ¶ç»™L[]ï¼Œåˆ™å¾—åˆ°çš„L[firstâ€¦last]æœ‰åº å¦‚ä½•åˆ†è§£ï¼Ÿ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é‡‡ç”¨é€’å½’çš„æ–¹æ³•ï¼Œé¦–å…ˆå°†å¾…æ’åºåˆ—åˆ†æˆA,Bä¸¤ç»„ï¼›ç„¶åé‡å¤å¯¹Aã€Båºåˆ—åˆ†ç»„ï¼›ç›´åˆ°åˆ†ç»„åç»„å†…åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæ­¤æ—¶æˆ‘ä»¬è®¤ä¸ºç»„å†…æ‰€æœ‰å…ƒç´ æœ‰åºï¼Œåˆ™åˆ†ç»„ç»“æŸã€‚ è¿™é‡Œæˆ‘å†™äº†é€’å½’ç®—æ³•å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637/** * å½’å¹¶æ’åºï¼ˆé€’å½’ï¼‰ * * â‘ . å°†åºåˆ—æ¯ç›¸é‚»ä¸¤ä¸ªæ•°å­—è¿›è¡Œå½’å¹¶æ“ä½œï¼Œå½¢æˆ floor(n/2)ä¸ªåºåˆ—ï¼Œæ’åºåæ¯ä¸ªåºåˆ—åŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼› * â‘¡. å°†ä¸Šè¿°åºåˆ—å†æ¬¡å½’å¹¶ï¼Œå½¢æˆ floor(n/4)ä¸ªåºåˆ—ï¼Œæ¯ä¸ªåºåˆ—åŒ…å«å››ä¸ªå…ƒç´ ï¼› * â‘¢. é‡å¤æ­¥éª¤â‘¡ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ æ’åºå®Œæ¯•ã€‚ * @param arr å¾…æ’åºæ•°ç»„ */public static int[] mergingSort(int[] arr)&#123; if(arr.length &lt;= 1) return arr; int num = arr.length &gt;&gt; 1; int[] leftArr = Arrays.copyOfRange(arr, 0, num); int[] rightArr = Arrays.copyOfRange(arr, num, arr.length); System.out.println(\"split two array: \" + Arrays.toString(leftArr) + \" And \" + Arrays.toString(rightArr)); return mergeTwoArray(mergingSort(leftArr), mergingSort(rightArr)); //ä¸æ–­æ‹†åˆ†ä¸ºæœ€å°å•å…ƒï¼Œå†æ’åºåˆå¹¶&#125;private static int[] mergeTwoArray(int[] arr1, int[] arr2)&#123; int i = 0, j = 0, k = 0; int[] result = new int[arr1.length + arr2.length]; //ç”³è¯·é¢å¤–çš„ç©ºé—´å­˜å‚¨åˆå¹¶ä¹‹åçš„æ•°ç»„ while(i &lt; arr1.length &amp;&amp; j &lt; arr2.length)&#123; //é€‰å–ä¸¤ä¸ªåºåˆ—ä¸­çš„è¾ƒå°å€¼æ”¾å…¥æ–°æ•°ç»„ if(arr1[i] &lt;= arr2[j])&#123; result[k++] = arr1[i++]; &#125;else&#123; result[k++] = arr2[j++]; &#125; &#125; while(i &lt; arr1.length)&#123; //åºåˆ—1ä¸­å¤šä½™çš„å…ƒç´ ç§»å…¥æ–°æ•°ç»„ result[k++] = arr1[i++]; &#125; while(j &lt; arr2.length)&#123; //åºåˆ—2ä¸­å¤šä½™çš„å…ƒç´ ç§»å…¥æ–°æ•°ç»„ result[k++] = arr2[j++]; &#125; System.out.println(\"Merging: \" + Arrays.toString(result)); return result;&#125; ç”±ä¸Š, é•¿åº¦ä¸ºnçš„æ•°ç»„, æœ€ç»ˆä¼šè°ƒç”¨mergeSortå‡½æ•°2n-1æ¬¡ã€‚é€šè¿‡è‡ªä¸Šè€Œä¸‹çš„é€’å½’å®ç°çš„å½’å¹¶æ’åº, å°†å­˜åœ¨å †æ ˆæº¢å‡ºçš„é£é™©ã€‚ ä»¥ä¸‹æ˜¯å½’å¹¶æ’åºç®—æ³•å¤æ‚åº¦: å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ O(nlogâ‚‚n) O(nlogâ‚‚n) O(nlogâ‚‚n) O(n) ä»æ•ˆç‡ä¸Šçœ‹ï¼Œå½’å¹¶æ’åºå¯ç®—æ˜¯æ’åºç®—æ³•ä¸­çš„â€ä½¼ä½¼è€…â€. å‡è®¾æ•°ç»„é•¿åº¦ä¸ºnï¼Œé‚£ä¹ˆæ‹†åˆ†æ•°ç»„å…±éœ€lognï¼Œ, åˆæ¯æ­¥éƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„åˆå¹¶å­æ•°ç»„çš„è¿‡ç¨‹ï¼Œ æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œ æ•…å…¶ç»¼åˆæ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)ã€‚å¦ä¸€æ–¹é¢ï¼Œ å½’å¹¶æ’åºå¤šæ¬¡é€’å½’è¿‡ç¨‹ä¸­æ‹†åˆ†çš„å­æ•°ç»„éœ€è¦ä¿å­˜åœ¨å†…å­˜ç©ºé—´ï¼Œ å…¶ç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚ å’Œé€‰æ‹©æ’åºä¸€æ ·ï¼Œå½’å¹¶æ’åºçš„æ€§èƒ½ä¸å—è¾“å…¥æ•°æ®çš„å½±å“ï¼Œä½†è¡¨ç°æ¯”é€‰æ‹©æ’åºå¥½çš„å¤šï¼Œå› ä¸ºå§‹ç»ˆéƒ½æ˜¯O(n log nï¼‰çš„æ—¶é—´å¤æ‚åº¦ã€‚ä»£ä»·æ˜¯éœ€è¦é¢å¤–çš„å†…å­˜ç©ºé—´ã€‚ å…«ã€åŸºæ•°æ’åºï¼ˆRadix Sortï¼‰ åŸºæ•°æ’åºçš„å‘æ˜å¯ä»¥è¿½æº¯åˆ°1887å¹´èµ«å°”æ›¼Â·ä½•ä¹ç¤¼åœ¨æ‰“å­”å¡ç‰‡åˆ¶è¡¨æœºï¼ˆTabulation Machineï¼‰, æ’åºå™¨æ¯æ¬¡åªèƒ½çœ‹åˆ°ä¸€ä¸ªåˆ—ã€‚å®ƒæ˜¯åŸºäºå…ƒç´ å€¼çš„æ¯ä¸ªä½ä¸Šçš„å­—ç¬¦æ¥æ’åºçš„ã€‚ å¯¹äºæ•°å­—è€Œè¨€å°±æ˜¯åˆ†åˆ«åŸºäºä¸ªä½ï¼Œåä½ï¼Œ ç™¾ä½æˆ–åƒä½ç­‰ç­‰æ•°å­—æ¥æ’åºã€‚ åŸºæ•°æ’åºï¼ˆRadix sortï¼‰æ˜¯ä¸€ç§éæ¯”è¾ƒå‹æ•´æ•°æ’åºç®—æ³•ï¼Œå…¶åŸç†æ˜¯å°†æ•´æ•°æŒ‰ä½æ•°åˆ‡å‰²æˆä¸åŒçš„æ•°å­—ï¼Œç„¶åæŒ‰æ¯ä¸ªä½æ•°åˆ†åˆ«æ¯”è¾ƒã€‚ç”±äºæ•´æ•°ä¹Ÿå¯ä»¥è¡¨è¾¾å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚åå­—æˆ–æ—¥æœŸï¼‰å’Œç‰¹å®šæ ¼å¼çš„æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥åŸºæ•°æ’åºä¹Ÿä¸æ˜¯åªèƒ½ä½¿ç”¨äºæ•´æ•°ã€‚ 1ã€åŸºæœ¬æ€æƒ³å®ƒæ˜¯è¿™æ ·å®ç°çš„ï¼šå°†æ‰€æœ‰å¾…æ¯”è¾ƒæ•°å€¼ï¼ˆæ­£æ•´æ•°ï¼‰ç»Ÿä¸€ä¸ºåŒæ ·çš„æ•°ä½é•¿åº¦ï¼Œæ•°ä½è¾ƒçŸ­çš„æ•°å‰é¢è¡¥é›¶ã€‚ç„¶åï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œä¾æ¬¡è¿›è¡Œä¸€æ¬¡æ’åºã€‚è¿™æ ·ä»æœ€ä½ä½æ’åºä¸€ç›´åˆ°æœ€é«˜ä½æ’åºå®Œæˆä»¥åï¼Œæ•°åˆ—å°±å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ã€‚ åŸºæ•°æ’åºæŒ‰ç…§ä¼˜å…ˆä»é«˜ä½æˆ–ä½ä½æ¥æ’åºæœ‰ä¸¤ç§å®ç°æ–¹æ¡ˆï¼š MSDï¼ˆMost significant digitalï¼‰ ä»æœ€å·¦ä¾§é«˜ä½å¼€å§‹è¿›è¡Œæ’åºã€‚å…ˆæŒ‰k1æ’åºåˆ†ç»„, åŒä¸€ç»„ä¸­è®°å½•, å…³é”®ç k1ç›¸ç­‰, å†å¯¹å„ç»„æŒ‰k2æ’åºåˆ†æˆå­ç»„, ä¹‹å, å¯¹åé¢çš„å…³é”®ç ç»§ç»­è¿™æ ·çš„æ’åºåˆ†ç»„, ç›´åˆ°æŒ‰æœ€æ¬¡ä½å…³é”®ç kdå¯¹å„å­ç»„æ’åºå. å†å°†å„ç»„è¿æ¥èµ·æ¥, ä¾¿å¾—åˆ°ä¸€ä¸ªæœ‰åºåºåˆ—ã€‚MSDæ–¹å¼é€‚ç”¨äºä½æ•°å¤šçš„åºåˆ—ã€‚ LSD ï¼ˆLeast significant digitalï¼‰ä»æœ€å³ä¾§ä½ä½å¼€å§‹è¿›è¡Œæ’åºã€‚å…ˆä»kdå¼€å§‹æ’åºï¼Œå†å¯¹kd-1è¿›è¡Œæ’åºï¼Œä¾æ¬¡é‡å¤ï¼Œç›´åˆ°å¯¹k1æ’åºåä¾¿å¾—åˆ°ä¸€ä¸ªæœ‰åºåºåˆ—ã€‚LSDæ–¹å¼é€‚ç”¨äºä½æ•°å°‘çš„åºåˆ—ã€‚ 2ã€ç®—æ³•æè¿°æˆ‘ä»¬ä»¥LSDä¸ºä¾‹ï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œå…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š â‘ . å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°ï¼›â‘¡. arrä¸ºåŸå§‹æ•°ç»„ï¼Œä»æœ€ä½ä½å¼€å§‹å–æ¯ä¸ªä½ç»„æˆradixæ•°ç»„ï¼›â‘¢. å¯¹radixè¿›è¡Œè®¡æ•°æ’åºï¼ˆåˆ©ç”¨è®¡æ•°æ’åºé€‚ç”¨äºå°èŒƒå›´æ•°çš„ç‰¹ç‚¹ï¼‰ï¼› 3ã€ä»£ç å®ç°åŸºæ•°æ’åºï¼šé€šè¿‡åºåˆ—ä¸­å„ä¸ªå…ƒç´ çš„å€¼ï¼Œå¯¹æ’åºçš„Nä¸ªå…ƒç´ è¿›è¡Œè‹¥å¹²è¶Ÿçš„â€œåˆ†é…â€ä¸â€œæ”¶é›†â€æ¥å®ç°æ’åºã€‚ åˆ†é…ï¼šæˆ‘ä»¬å°†L[i]ä¸­çš„å…ƒç´ å–å‡ºï¼Œé¦–å…ˆç¡®å®šå…¶ä¸ªä½ä¸Šçš„æ•°å­—ï¼Œæ ¹æ®è¯¥æ•°å­—åˆ†é…åˆ°ä¸ä¹‹åºå·ç›¸åŒçš„æ¡¶ä¸­ æ”¶é›†ï¼šå½“åºåˆ—ä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½åˆ†é…åˆ°å¯¹åº”çš„æ¡¶ä¸­ï¼Œå†æŒ‰ç…§é¡ºåºä¾æ¬¡å°†æ¡¶ä¸­çš„å…ƒç´ æ”¶é›†å½¢æˆæ–°çš„ä¸€ä¸ªå¾…æ’åºåˆ—L[]ã€‚å¯¹æ–°å½¢æˆçš„åºåˆ—L[]é‡å¤æ‰§è¡Œåˆ†é…å’Œæ”¶é›†å…ƒç´ ä¸­çš„åä½ã€ç™¾ä½â€¦ç›´åˆ°åˆ†é…å®Œè¯¥åºåˆ—ä¸­çš„æœ€é«˜ä½ï¼Œåˆ™æ’åºç»“æŸ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556/** * åŸºæ•°æ’åºï¼ˆLSD ä»ä½ä½å¼€å§‹ï¼‰ * * åŸºæ•°æ’åºé€‚ç”¨äºï¼š * (1)æ•°æ®èŒƒå›´è¾ƒå°ï¼Œå»ºè®®åœ¨å°äº1000 * (2)æ¯ä¸ªæ•°å€¼éƒ½è¦å¤§äºç­‰äº0 * * â‘ . å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°ï¼› * â‘¡. arrä¸ºåŸå§‹æ•°ç»„ï¼Œä»æœ€ä½ä½å¼€å§‹å–æ¯ä¸ªä½ç»„æˆradixæ•°ç»„ï¼› * â‘¢. å¯¹radixè¿›è¡Œè®¡æ•°æ’åºï¼ˆåˆ©ç”¨è®¡æ•°æ’åºé€‚ç”¨äºå°èŒƒå›´æ•°çš„ç‰¹ç‚¹ï¼‰ï¼› * @param arr å¾…æ’åºæ•°ç»„ */public static void radixSort(int[] arr)&#123; if(arr.length &lt;= 1) return; //å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•° int max = 0; for(int i = 0; i &lt; arr.length; i++)&#123; if(max &lt; arr[i])&#123; max = arr[i]; &#125; &#125; int maxDigit = 1; while(max / 10 &gt; 0)&#123; maxDigit++; max = max / 10; &#125; System.out.println(\"maxDigit: \" + maxDigit); //ç”³è¯·ä¸€ä¸ªæ¡¶ç©ºé—´ int[][] buckets = new int[10][arr.length]; int base = 10; //ä»ä½ä½åˆ°é«˜ä½ï¼Œå¯¹æ¯ä¸€ä½éå†ï¼Œå°†æ‰€æœ‰å…ƒç´ åˆ†é…åˆ°æ¡¶ä¸­ for(int i = 0; i &lt; maxDigit; i++)&#123; int[] bktLen = new int[10]; //å­˜å‚¨å„ä¸ªæ¡¶ä¸­å­˜å‚¨å…ƒç´ çš„æ•°é‡ //åˆ†é…ï¼šå°†æ‰€æœ‰å…ƒç´ åˆ†é…åˆ°æ¡¶ä¸­ for(int j = 0; j &lt; arr.length; j++)&#123; int whichBucket = (arr[j] % base) / (base / 10); buckets[whichBucket][bktLen[whichBucket]] = arr[j]; bktLen[whichBucket]++; &#125; //æ”¶é›†ï¼šå°†ä¸åŒæ¡¶é‡Œæ•°æ®æŒ¨ä¸ªæå‡ºæ¥,ä¸ºä¸‹ä¸€è½®é«˜ä½æ’åºåšå‡†å¤‡,ç”±äºé è¿‘æ¡¶åº•çš„å…ƒç´ æ’åé å‰,å› æ­¤ä»æ¡¶åº•å…ˆæ int k = 0; for(int b = 0; b &lt; buckets.length; b++)&#123; for(int p = 0; p &lt; bktLen[b]; p++)&#123; arr[k++] = buckets[b][p]; &#125; &#125; System.out.println(\"Sorting: \" + Arrays.toString(arr)); base *= 10; &#125;&#125; ä»¥ä¸‹æ˜¯åŸºæ•°æ’åºç®—æ³•å¤æ‚åº¦ï¼Œå…¶ä¸­kä¸ºæœ€å¤§æ•°çš„ä½æ•°ï¼š å¹³å‡æ—¶é—´å¤æ‚åº¦ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ ç©ºé—´å¤æ‚åº¦ O(d*(n+r)) O(d*(n+r)) O(d*(n+r)) O(n+r) å…¶ä¸­ï¼Œd ä¸ºä½æ•°ï¼Œr ä¸ºåŸºæ•°ï¼Œn ä¸ºåŸæ•°ç»„ä¸ªæ•°ã€‚åœ¨åŸºæ•°æ’åºä¸­ï¼Œå› ä¸ºæ²¡æœ‰æ¯”è¾ƒæ“ä½œï¼Œæ‰€ä»¥åœ¨å¤æ‚ä¸Šï¼Œæœ€å¥½çš„æƒ…å†µä¸æœ€åçš„æƒ…å†µåœ¨æ—¶é—´ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œå‡ä¸º O(d*(n + r))ã€‚ åŸºæ•°æ’åºæ›´é€‚åˆç”¨äºå¯¹æ—¶é—´, å­—ç¬¦ä¸²ç­‰è¿™äº›æ•´ä½“æƒå€¼æœªçŸ¥çš„æ•°æ®è¿›è¡Œæ’åºã€‚ Tips: åŸºæ•°æ’åºä¸æ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåºï¼Œå› æ­¤å®ƒæ˜¯ç¨³å®šçš„æ’åºç®—æ³•ã€‚ åŸºæ•°æ’åº vs è®¡æ•°æ’åº vs æ¡¶æ’åº è¿™ä¸‰ç§æ’åºç®—æ³•éƒ½åˆ©ç”¨äº†æ¡¶çš„æ¦‚å¿µï¼Œä½†å¯¹æ¡¶çš„ä½¿ç”¨æ–¹æ³•ä¸Šæœ‰æ˜æ˜¾å·®å¼‚ï¼š åŸºæ•°æ’åºï¼šæ ¹æ®é”®å€¼çš„æ¯ä½æ•°å­—æ¥åˆ†é…æ¡¶ è®¡æ•°æ’åºï¼šæ¯ä¸ªæ¡¶åªå­˜å‚¨å•ä¸€é”®å€¼ æ¡¶æ’åºï¼šæ¯ä¸ªæ¡¶å­˜å‚¨ä¸€å®šèŒƒå›´çš„æ•°å€¼ æ€»ç»“ å„ç§æ’åºæ€§èƒ½å¯¹æ¯”å¦‚ä¸‹ï¼Œæœ‰äº›æ’åºæœªè¯¦ç»†ä»‹ç»ï¼Œæš‚ä¸”æ”¾åˆ°è¿™é‡Œã€‚å®ä¾‹æµ‹è¯•ç»“æœå¯ä»¥çœ‹è¿™é‡Œï¼šå…«å¤§æ’åºç®—æ³•è€—æ—¶å¯¹æ¯” ã€‚ æ’åºç±»å‹ å¹³å‡æƒ…å†µ æœ€å¥½æƒ…å†µ æœ€åæƒ…å†µ è¾…åŠ©ç©ºé—´ ç¨³å®šæ€§ å†’æ³¡æ’åº O(nÂ²) O(n) O(nÂ²) O(1) ç¨³å®š é€‰æ‹©æ’åº O(nÂ²) O(nÂ²) O(nÂ²) O(1) ä¸ç¨³å®š ç›´æ¥æ’å…¥æ’åº O(nÂ²) O(n) O(nÂ²) O(1) ç¨³å®š æŠ˜åŠæ’å…¥æ’åº O(nÂ²) O(n) O(nÂ²) O(1) ç¨³å®š å¸Œå°”æ’åº O(n^1.3) O(nlogn) O(nÂ²) O(1) ä¸ç¨³å®š å½’å¹¶æ’åº O(nlogâ‚‚n) O(nlogâ‚‚n) O(nlogâ‚‚n) O(n) ç¨³å®š å¿«é€Ÿæ’åº O(nlogâ‚‚n) O(nlogâ‚‚n) O(nÂ²) O(nlogâ‚‚n) ä¸ç¨³å®š å †æ’åº O(nlogâ‚‚n) O(nlogâ‚‚n) O(nlogâ‚‚n) O(1) ä¸ç¨³å®š è®¡æ•°æ’åº O(n+k) O(n+k) O(n+k) O(k) ç¨³å®š æ¡¶æ’åº O(n+k) O(n+k) O(nÂ²) O(n+k) (ä¸)ç¨³å®š åŸºæ•°æ’åº O(d(n+k)) O(d(n+k)) O(d(n+kd)) O(n+kd) ç¨³å®š ä»æ—¶é—´å¤æ‚åº¦æ¥è¯´ï¼š (1). å¹³æ–¹é˜¶O(nÂ²)æ’åºï¼šå„ç±»ç®€å•æ’åºï¼šç›´æ¥æ’å…¥ã€ç›´æ¥é€‰æ‹©å’Œå†’æ³¡æ’åºï¼› (2). çº¿æ€§å¯¹æ•°é˜¶O(nlogâ‚‚n)æ’åºï¼šå¿«é€Ÿæ’åºã€å †æ’åºå’Œå½’å¹¶æ’åºï¼› (3). O(n1+Â§))æ’åºï¼ŒÂ§æ˜¯ä»‹äº0å’Œ1ä¹‹é—´çš„å¸¸æ•°ï¼šå¸Œå°”æ’åº (4). çº¿æ€§é˜¶O(n)æ’åºï¼šåŸºæ•°æ’åºï¼Œæ­¤å¤–è¿˜æœ‰æ¡¶ã€ç®±æ’åºã€‚ åˆ°æ­¤ï¼Œå¾ˆå¤šäººä¼šæ³¨æ„åˆ°åŸºæ•°æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯æœ€å°çš„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆå´æ²¡æœ‰å¿«æ’ã€å †æ’åºæµè¡Œå‘¢ï¼Ÿæˆ‘ä»¬çœ‹çœ‹ä¸‹å›¾ç®—æ³•å¯¼è®ºçš„ç›¸å…³è¯´æ˜ï¼š åŸºæ•°æ’åºåªé€‚ç”¨äºæœ‰åŸºæ•°çš„æƒ…å†µï¼Œè€ŒåŸºäºæ¯”è¾ƒçš„æ’åºé€‚ç”¨èŒƒå›´å°±å¹¿å¾—å¤šã€‚å¦ä¸€æ–¹é¢æ˜¯å†…å­˜ä¸Šçš„è€ƒè™‘ã€‚ä½œä¸ºä¸€ç§é€šç”¨çš„æ’åºæ–¹æ³•ï¼Œæœ€å¥½ä¸è¦å¸¦æ¥æ„æ–™ä¹‹å¤–çš„å†…å­˜å¼€é”€ï¼Œæ‰€ä»¥å„è¯­è¨€çš„é»˜è®¤å®ç°éƒ½æ²¡æœ‰ç”¨åŸºæ•°æ’åºï¼Œä½†æ˜¯ä¸èƒ½å¦è®¤åŸºæ•°æ’åºåœ¨å„é¢†åŸŸçš„åº”ç”¨ã€‚ æ—¶é—´å¤æ‚åº¦æé™å½“è¢«æ’åºçš„æ•°æœ‰ä¸€äº›æ€§è´¨çš„æ—¶å€™ï¼ˆæ¯”å¦‚æ˜¯æ•´æ•°ï¼Œæ¯”å¦‚æœ‰ä¸€å®šçš„èŒƒå›´ï¼‰ï¼Œæ’åºç®—æ³•çš„å¤æ‚åº¦æ˜¯å¯ä»¥å°äºO(nlgn)çš„ã€‚æ¯”å¦‚ï¼š è®¡æ•°æ’åº å¤æ‚åº¦O( k+n) è¦æ±‚ï¼šè¢«æ’åºçš„æ•°æ˜¯0~kèŒƒå›´å†…çš„æ•´æ•° åŸºæ•°æ’åº å¤æ‚åº¦O( d(k+n) ) è¦æ±‚ï¼šdä½æ•°ï¼Œæ¯ä¸ªæ•°ä½æœ‰kä¸ªå–å€¼ æ¡¶æ’åº å¤æ‚åº¦ O( n ) ï¼ˆå¹³å‡ï¼‰ è¦æ±‚ï¼šè¢«æ’åºæ•°åœ¨æŸä¸ªèŒƒå›´å†…ï¼Œå¹¶ä¸”æœä»å‡åŒ€åˆ†å¸ƒ ä½†æ˜¯ï¼Œå½“è¢«æ’åºçš„æ•°ä¸å…·æœ‰ä»»ä½•æ€§è´¨çš„æ—¶å€™ï¼Œä¸€èˆ¬ä½¿ç”¨åŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•ï¼Œè€ŒåŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦çš„ä¸‹é™å¿…é¡»æ˜¯O( nlgn) ã€‚å‚è€ƒå¾ˆå¤šé«˜æ•ˆæ’åºç®—æ³•çš„ä»£ä»·æ˜¯ nlognï¼Œéš¾é“è¿™æ˜¯æ’åºç®—æ³•çš„æé™äº†å—ï¼Ÿ è¯´æ˜ å½“åŸè¡¨æœ‰åºæˆ–åŸºæœ¬æœ‰åºæ—¶ï¼Œç›´æ¥æ’å…¥æ’åºå’Œå†’æ³¡æ’åºå°†å¤§å¤§å‡å°‘æ¯”è¾ƒæ¬¡æ•°å’Œç§»åŠ¨è®°å½•çš„æ¬¡æ•°ï¼Œæ—¶é—´å¤æ‚åº¦å¯é™è‡³Oï¼ˆnï¼‰ï¼› è€Œå¿«é€Ÿæ’åºåˆ™ç›¸åï¼Œå½“åŸè¡¨åŸºæœ¬æœ‰åºæ—¶ï¼Œå°†èœ•åŒ–ä¸ºå†’æ³¡æ’åºï¼Œæ—¶é—´å¤æ‚åº¦æé«˜ä¸ºOï¼ˆn2ï¼‰ï¼› åŸè¡¨æ˜¯å¦æœ‰åºï¼Œå¯¹ç®€å•é€‰æ‹©æ’åºã€å †æ’åºã€å½’å¹¶æ’åºå’ŒåŸºæ•°æ’åºçš„æ—¶é—´å¤æ‚åº¦å½±å“ä¸å¤§ã€‚ å‚è€ƒèµ„æ–™ æ•°æ®ç»“æ„å¯è§†åŒ–ï¼švisualgoï¼ŒSorting Algorithms Animationsï¼ŒCodePen &amp; sort it out ä¸€ä¸ªæ˜¾ç¤ºæ’åºè¿‡ç¨‹çš„PYTHONè„šæœ¬ æ’åºç®—æ³•æµ‹è¯•ï¼šLab 1: Sorting - å“¥å¾·å ¡å¤§å­¦è¯¾ä»¶ï¼ˆUniversity of Gothenburgï¼‰ Sorting Algorithm Animations - ä¸€ä¸ªæ’åºç®—æ³•æ¯”è¾ƒçš„ç½‘ç«™ Sorting - å¡å†…åŸºæ¢…éš†å¤§å­¦è¯¾ä»¶ æ•°æ®ç»“æ„å¸¸è§çš„å…«å¤§æ’åºç®—æ³•ï¼ˆè¯¦ç»†æ•´ç†ï¼‰ å¿…é¡»çŸ¥é“çš„å…«å¤§ç§æ’åºç®—æ³•ã€javaå®ç°ã€‘ åå¤§ç»å…¸æ’åºç®—æ³• è§†è§‰ç›´è§‚æ„Ÿå— 7 ç§å¸¸ç”¨çš„æ’åºç®—æ³• JSä¸­å¯èƒ½ç”¨å¾—åˆ°çš„å…¨éƒ¨çš„æ’åºç®—æ³• æ€»ç»“5ç§æ¯”è¾ƒé«˜æ•ˆå¸¸ç”¨çš„æ’åºç®—æ³• å¸¸è§æ’åºç®—æ³•C++æ€»ç»“","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€ç®—æ³•ã€‘10äº¿intå‹æ•°ï¼Œç»Ÿè®¡åªå‡ºç°ä¸€æ¬¡çš„æ•°","slug":"ã€ç®—æ³•ã€‘10äº¿intå‹æ•°ï¼Œç»Ÿè®¡åªå‡ºç°ä¸€æ¬¡çš„æ•°","date":"2017-07-13T10:30:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/07/13/ã€ç®—æ³•ã€‘10äº¿intå‹æ•°ï¼Œç»Ÿè®¡åªå‡ºç°ä¸€æ¬¡çš„æ•°/","link":"","permalink":"http://github.com/2017/07/13/ã€ç®—æ³•ã€‘10äº¿intå‹æ•°ï¼Œç»Ÿè®¡åªå‡ºç°ä¸€æ¬¡çš„æ•°/","excerpt":"é¢˜ç›®10äº¿intæ•´å‹æ•°ï¼Œä»¥åŠä¸€å°å¯ç”¨å†…å­˜ä¸º1GBçš„æœºå™¨ï¼Œæ—¶é—´å¤æ‚åº¦è¦æ±‚O(n)ï¼Œç»Ÿè®¡åªå‡ºç°ä¸€æ¬¡çš„æ•°ï¼Ÿ åˆ†æé¦–å…ˆåˆ†æå¤šå¤§çš„å†…å­˜èƒ½å¤Ÿè¡¨ç¤º10äº¿çš„æ•°å‘¢ï¼Ÿä¸€ä¸ªintå‹å 4å­—èŠ‚ï¼Œ10äº¿å°±æ˜¯40äº¿å­—èŠ‚ï¼ˆå¾ˆæ˜æ˜¾å°±æ˜¯4GBï¼‰ï¼Œä¹Ÿå°±æ˜¯å¦‚æœå®Œå…¨è¯»å…¥å†…å­˜éœ€è¦å ç”¨4GBï¼Œè€Œé¢˜ç›®åªç»™1GBå†…å­˜ï¼Œæ˜¾ç„¶ä¸å¯èƒ½å°†æ‰€æœ‰æ•°æ®è¯»å…¥å†…å­˜ã€‚ æˆ‘ä»¬å…ˆä¸è€ƒè™‘æ—¶é—´å¤æ‚åº¦ï¼Œä»…è€ƒè™‘è§£å†³é—®é¢˜ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥çš„æ€è·¯ä¸€èˆ¬æœ‰ä¸¤ç§ã€‚ ä½å›¾æ³•ï¼šç”¨ä¸€ä¸ªbitä½æ¥æ ‡è¯†ä¸€ä¸ªintæ•´æ•°ã€‚ åˆ†æ²»æ³•ï¼šåˆ†æ‰¹å¤„ç†è¿™10äº¿çš„æ•°ã€‚ ä¸€ç§æ˜¯ä½å›¾æ³•ï¼Œå¦‚æœå„ä½è€å¸æœºæœ‰ç»éªŒçš„è¯å¾ˆå¿«ä¼šæƒ³åˆ°intæ•´å‹æ•°æ˜¯4å­—èŠ‚ï¼ˆByteï¼‰ï¼Œä¹Ÿå°±æ˜¯32ä½ï¼ˆbitï¼‰ï¼Œå¦‚æœèƒ½ç”¨ä¸€ä¸ªbitä½æ¥æ ‡è¯†ä¸€ä¸ªintæ•´æ•°é‚£ä¹ˆå­˜å‚¨ç©ºé—´å°†å¤§å¤§å‡å°‘ã€‚å¦ä¸€ç§æ˜¯åˆ†æ²»æ³•ï¼Œå†…å­˜æœ‰é™ï¼Œæˆ‘æƒ³åŠæ³•åˆ†æ‰¹è¯»å–å¤„ç†ã€‚ä¸‹é¢å¤§è‡´åˆ†æä¸€ä¸‹ä¸¤ç§æ€è·¯ã€‚","text":"é¢˜ç›®10äº¿intæ•´å‹æ•°ï¼Œä»¥åŠä¸€å°å¯ç”¨å†…å­˜ä¸º1GBçš„æœºå™¨ï¼Œæ—¶é—´å¤æ‚åº¦è¦æ±‚O(n)ï¼Œç»Ÿè®¡åªå‡ºç°ä¸€æ¬¡çš„æ•°ï¼Ÿ åˆ†æé¦–å…ˆåˆ†æå¤šå¤§çš„å†…å­˜èƒ½å¤Ÿè¡¨ç¤º10äº¿çš„æ•°å‘¢ï¼Ÿä¸€ä¸ªintå‹å 4å­—èŠ‚ï¼Œ10äº¿å°±æ˜¯40äº¿å­—èŠ‚ï¼ˆå¾ˆæ˜æ˜¾å°±æ˜¯4GBï¼‰ï¼Œä¹Ÿå°±æ˜¯å¦‚æœå®Œå…¨è¯»å…¥å†…å­˜éœ€è¦å ç”¨4GBï¼Œè€Œé¢˜ç›®åªç»™1GBå†…å­˜ï¼Œæ˜¾ç„¶ä¸å¯èƒ½å°†æ‰€æœ‰æ•°æ®è¯»å…¥å†…å­˜ã€‚ æˆ‘ä»¬å…ˆä¸è€ƒè™‘æ—¶é—´å¤æ‚åº¦ï¼Œä»…è€ƒè™‘è§£å†³é—®é¢˜ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥çš„æ€è·¯ä¸€èˆ¬æœ‰ä¸¤ç§ã€‚ ä½å›¾æ³•ï¼šç”¨ä¸€ä¸ªbitä½æ¥æ ‡è¯†ä¸€ä¸ªintæ•´æ•°ã€‚ åˆ†æ²»æ³•ï¼šåˆ†æ‰¹å¤„ç†è¿™10äº¿çš„æ•°ã€‚ ä¸€ç§æ˜¯ä½å›¾æ³•ï¼Œå¦‚æœå„ä½è€å¸æœºæœ‰ç»éªŒçš„è¯å¾ˆå¿«ä¼šæƒ³åˆ°intæ•´å‹æ•°æ˜¯4å­—èŠ‚ï¼ˆByteï¼‰ï¼Œä¹Ÿå°±æ˜¯32ä½ï¼ˆbitï¼‰ï¼Œå¦‚æœèƒ½ç”¨ä¸€ä¸ªbitä½æ¥æ ‡è¯†ä¸€ä¸ªintæ•´æ•°é‚£ä¹ˆå­˜å‚¨ç©ºé—´å°†å¤§å¤§å‡å°‘ã€‚å¦ä¸€ç§æ˜¯åˆ†æ²»æ³•ï¼Œå†…å­˜æœ‰é™ï¼Œæˆ‘æƒ³åŠæ³•åˆ†æ‰¹è¯»å–å¤„ç†ã€‚ä¸‹é¢å¤§è‡´åˆ†æä¸€ä¸‹ä¸¤ç§æ€è·¯ã€‚ 1ã€ä½å›¾æ³•ï¼ˆBitmapï¼‰ä½å›¾æ³•æ˜¯åŸºäºintå‹æ•°çš„è¡¨ç¤ºèŒƒå›´è¿™ä¸ªæ¦‚å¿µçš„ï¼Œç”¨ä¸€ä¸ªbitä½æ¥æ ‡è¯†ä¸€ä¸ªintæ•´æ•°ï¼Œè‹¥è¯¥ä½ä¸º1ï¼Œåˆ™è¯´æ˜è¯¥æ•°å‡ºç°ï¼›è‹¥è¯¥ä½ä¸º0ï¼Œåˆ™è¯´æ˜è¯¥æ•°æ²¡æœ‰å‡ºç°ã€‚ä¸€ä¸ªintæ•´å‹æ•°å 4å­—èŠ‚ï¼ˆByteï¼‰ï¼Œä¹Ÿå°±æ˜¯32ä½ï¼ˆbitï¼‰ã€‚é‚£ä¹ˆæŠŠæ‰€æœ‰intæ•´å‹æ•°å­—è¡¨ç¤ºå‡ºæ¥éœ€è¦2^32 bitçš„ç©ºé—´ï¼Œæ¢ç®—æˆå­—èŠ‚å•ä½ä¹Ÿå°±æ˜¯2^32/8 = 2^29 Byteï¼Œå¤§çº¦ç­‰äº512MB 123// æ’æ’­ä¸€ä¸ªå¸¸è¯†2^10 Byte = 1024 Byte = 1KB2^30 Byte = (2^10)^3 Byte = 1024 * 1024 * 1024 Byte = 1GB è¿™ä¸‹å°±å¥½åŠäº†ï¼Œåªéœ€è¦ç”¨512MBçš„å†…å­˜å°±èƒ½å­˜å‚¨æ‰€æœ‰çš„intçš„èŒƒå›´æ•°ã€‚ å…·ä½“æ–¹æ¡ˆé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦ç”³è¯·ä¸€ä¸ªintæ•°ç»„é•¿åº¦ä¸º int tmp[N/32+1]å³å¯å­˜å‚¨å®Œè¿™äº›æ•°æ®ï¼Œå…¶ä¸­Nä»£è¡¨è¦è¿›è¡ŒæŸ¥æ‰¾çš„æ€»æ•°ï¼ˆè¿™é‡Œä¹Ÿå°±æ˜¯2^32ï¼‰ï¼Œtmpä¸­çš„æ¯ä¸ªå…ƒç´ åœ¨å†…å­˜åœ¨å 32ä½å¯ä»¥å¯¹åº”è¡¨ç¤ºåè¿›åˆ¶æ•°0~31,æ‰€ä»¥å¯å¾—åˆ°BitMapè¡¨: tmp[0]:å¯è¡¨ç¤º0~31 tmp[1]:å¯è¡¨ç¤º32~63 tmp[2]å¯è¡¨ç¤º64~95 ~~ å‡è®¾è¿™10äº¿intæ•°æ®ä¸ºï¼š6,3,8,32,36,â€¦â€¦ï¼Œé‚£ä¹ˆå…·ä½“çš„BitMapè¡¨ç¤ºä¸ºï¼š (1). å¦‚ä½•åˆ¤æ–­intæ•°å­—æ”¾åœ¨å“ªä¸€ä¸ªtmpæ•°ç»„ä¸­ï¼šå°†æ•°å­—ç›´æ¥é™¤ä»¥32å–æ•´æ•°éƒ¨åˆ†(x/32)ï¼Œä¾‹å¦‚ï¼šæ•´æ•°8é™¤ä»¥32å–æ•´ç­‰äº0ï¼Œé‚£ä¹ˆ8å°±åœ¨tmp[0]ä¸Šï¼› (2). å¦‚ä½•ç¡®å®šæ•°å­—æ”¾åœ¨32ä¸ªä½ä¸­çš„å“ªä¸ªä½ï¼šå°†æ•°å­—mod32å–æ¨¡(x%32)ã€‚ä¸Šä¾‹ä¸­æˆ‘ä»¬å¦‚ä½•ç¡®å®š8åœ¨tmp[0]ä¸­çš„32ä¸ªä½ä¸­çš„å“ªä¸ªä½ï¼Œè¿™ç§æƒ…å†µç›´æ¥modä¸Š32å°±okï¼Œåˆå¦‚æ•´æ•°8ï¼Œåœ¨tmp[0]ä¸­çš„ç¬¬8 modä¸Š32ç­‰äº8ï¼Œé‚£ä¹ˆæ•´æ•°8å°±åœ¨tmp[0]ä¸­çš„ç¬¬å…«ä¸ªbitä½ï¼ˆä»å³è¾¹æ•°èµ·ï¼‰ã€‚ ç„¶åæˆ‘ä»¬æ€ä¹ˆç»Ÿè®¡åªå‡ºç°ä¸€æ¬¡çš„æ•°å‘¢ï¼Ÿæ¯ä¸€ä¸ªæ•°å‡ºç°çš„æƒ…å†µæˆ‘ä»¬å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š0æ¬¡ã€1æ¬¡ã€å¤§äº1æ¬¡ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦ç”¨2ä¸ªbitä½æ‰èƒ½è¡¨ç¤ºæ¯ä¸ªæ•°çš„å‡ºç°æƒ…å†µã€‚æ­¤æ—¶åˆ™ä¸‰ç§æƒ…å†µåˆ†åˆ«å¯¹åº”çš„bitä½è¡¨ç¤ºæ˜¯ï¼š00ã€01ã€11 æˆ‘ä»¬é¡ºåºæ‰«æè¿™10äº¿çš„æ•°ï¼Œåœ¨å¯¹åº”çš„åŒbitä½ä¸Šæ ‡è®°è¯¥æ•°å‡ºç°çš„æ¬¡æ•°ã€‚æœ€åå–å‡ºæ‰€æœ‰åŒbitä½ä¸º01çš„intå‹æ•°å°±å¯ä»¥äº†ã€‚ Bitmapæ‹“å±•ä½å›¾ï¼ˆBitmapï¼‰ç®—æ³•æ€æƒ³æ¯”è¾ƒç®€å•ï¼Œä½†å…³é”®æ˜¯å¦‚ä½•ç¡®å®šåè¿›åˆ¶çš„æ•°æ˜ å°„åˆ°äºŒè¿›åˆ¶bitä½çš„mapå›¾ã€‚ ä¼˜ç‚¹ï¼š è¿ç®—æ•ˆç‡é«˜ï¼Œä¸è®¸è¿›è¡Œæ¯”è¾ƒå’Œç§»ä½ï¼› å ç”¨å†…å­˜å°‘ï¼Œæ¯”å¦‚N=10000000ï¼›åªéœ€å ç”¨å†…å­˜ä¸ºN/8=1250000Byte=1.25M ç¼ºç‚¹ï¼šæ‰€æœ‰çš„æ•°æ®ä¸èƒ½é‡å¤ã€‚å³ä¸å¯å¯¹é‡å¤çš„æ•°æ®è¿›è¡Œæ’åºå’ŒæŸ¥æ‰¾ã€‚ å»ºç«‹äº†Bit-Mapä¹‹åï¼Œå°±å¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨äº†ã€‚ä¸€èˆ¬æ¥è¯´Bit-Mapå¯ä½œä¸ºæ•°æ®çš„æŸ¥æ‰¾ã€å»é‡ã€æ’åºç­‰æ“ä½œã€‚æ¯”å¦‚ä»¥ä¸‹å‡ ä¸ªä¾‹å­ï¼š 1ã€åœ¨3äº¿ä¸ªæ•´æ•°ä¸­æ‰¾å‡ºé‡å¤çš„æ•´æ•°ä¸ªæ•°ï¼Œé™åˆ¶å†…å­˜ä¸è¶³ä»¥å®¹çº³3äº¿ä¸ªæ•´æ•° å¯¹äºè¿™ç§åœºæ™¯å¯ä»¥é‡‡ç”¨2-BitMapæ¥è§£å†³ï¼Œå³ä¸ºæ¯ä¸ªæ•´æ•°åˆ†é…2bitï¼Œç”¨ä¸åŒçš„0ã€1ç»„åˆæ¥æ ‡è¯†ç‰¹æ®Šæ„æ€ï¼Œå¦‚00è¡¨ç¤ºæ­¤æ•´æ•°æ²¡æœ‰å‡ºç°è¿‡ï¼Œ01è¡¨ç¤ºå‡ºç°ä¸€æ¬¡ï¼Œ11è¡¨ç¤ºå‡ºç°è¿‡å¤šæ¬¡ï¼Œå°±å¯ä»¥æ‰¾å‡ºé‡å¤çš„æ•´æ•°äº†ï¼Œå…¶éœ€è¦çš„å†…å­˜ç©ºé—´æ˜¯æ­£å¸¸BitMapçš„2å€ï¼Œä¸ºï¼š3äº¿*2/8/1024/1024=71.5MBã€‚ å…·ä½“çš„è¿‡ç¨‹å¦‚ä¸‹ï¼šæ‰«æç€3äº¿ä¸ªæ•´æ•°ï¼Œç»„BitMapï¼Œå…ˆæŸ¥çœ‹BitMapä¸­çš„å¯¹åº”ä½ç½®ï¼Œå¦‚æœ00åˆ™å˜æˆ01ï¼Œæ˜¯01åˆ™å˜æˆ11ï¼Œæ˜¯11åˆ™ä¿æŒä¸å˜ï¼Œå½“å°†3äº¿ä¸ªæ•´æ•°æ‰«æå®Œä¹‹åä¹Ÿå°±æ˜¯è¯´æ•´ä¸ªBitMapå·²ç»ç»„è£…å®Œæ¯•ã€‚æœ€åæŸ¥çœ‹BitMapå°†å¯¹åº”ä½ä¸º11çš„æ•´æ•°è¾“å‡ºå³å¯ã€‚ 2ã€å¯¹æ²¡æœ‰é‡å¤å…ƒç´ çš„æ•´æ•°è¿›è¡Œæ’åº å¯¹äºéé‡å¤çš„æ•´æ•°æ’åºBitMapæœ‰ç€å¤©ç„¶çš„ä¼˜åŠ¿ï¼Œå®ƒåªéœ€è¦å°†ç»™å‡ºçš„æ— é‡å¤æ•´æ•°æ‰«æå®Œæ¯•ï¼Œç»„è£…æˆä¸ºBitMapä¹‹åï¼Œé‚£ä¹ˆç›´æ¥éå†ä¸€éBitåŒºåŸŸå°±å¯ä»¥è¾¾åˆ°æ’åºæ•ˆæœäº†ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šå¯¹æ•´æ•°4ã€3ã€1ã€7ã€6è¿›è¡Œæ’åºï¼š ç›´æ¥æŒ‰Bitä½è¾“å‡ºå°±å¯ä»¥å¾—åˆ°æ’åºç»“æœäº†ã€‚ 3ã€å·²çŸ¥æŸä¸ªæ–‡ä»¶å†…åŒ…å«ä¸€äº›ç”µè¯å·ç ï¼Œæ¯ä¸ªå·ç ä¸º8ä½æ•°å­—ï¼Œç»Ÿè®¡ä¸åŒå·ç çš„ä¸ªæ•° 8ä½æœ€å¤š99 999 999ï¼Œå¤§æ¦‚éœ€è¦99mä¸ªbitï¼Œå¤§æ¦‚10å‡ må­—èŠ‚çš„å†…å­˜å³å¯ã€‚å¯ä»¥ç†è§£ä¸ºä»0-99 999 999çš„æ•°å­—ï¼Œæ¯ä¸ªæ•°å­—å¯¹åº”ä¸€ä¸ªBitä½ï¼Œæ‰€ä»¥åªéœ€è¦99Mä¸ªBit==1.2MBytesï¼Œè¿™æ ·ï¼Œå°±ç”¨äº†å°å°çš„1.2Må·¦å³çš„å†…å­˜è¡¨ç¤ºäº†æ‰€æœ‰çš„8ä½æ•°çš„ç”µè¯ã€‚ 4ã€2.5äº¿ä¸ªæ•´æ•°ä¸­æ‰¾å‡ºä¸é‡å¤çš„æ•´æ•°çš„ä¸ªæ•°ï¼Œå†…å­˜ç©ºé—´ä¸è¶³ä»¥å®¹çº³è¿™2.5äº¿ä¸ªæ•´æ•° å°†bit-mapæ‰©å±•ä¸€ä¸‹ï¼Œç”¨2bitè¡¨ç¤ºä¸€ä¸ªæ•°å³å¯ï¼š0è¡¨ç¤ºæœªå‡ºç°ï¼›1è¡¨ç¤ºå‡ºç°ä¸€æ¬¡ï¼›2è¡¨ç¤ºå‡ºç°2æ¬¡åŠä»¥ä¸Šï¼Œå³é‡å¤ï¼Œåœ¨éå†è¿™äº›æ•°çš„æ—¶å€™ï¼Œå¦‚æœå¯¹åº”ä½ç½®çš„å€¼æ˜¯0ï¼Œåˆ™å°†å…¶ç½®ä¸º1ï¼›å¦‚æœæ˜¯1ï¼Œå°†å…¶ç½®ä¸º2ï¼›å¦‚æœæ˜¯2ï¼Œåˆ™ä¿æŒä¸å˜ã€‚æˆ–è€…æˆ‘ä»¬ä¸ç”¨2bitæ¥è¿›è¡Œè¡¨ç¤ºï¼Œæˆ‘ä»¬ç”¨ä¸¤ä¸ªbit-mapå³å¯æ¨¡æ‹Ÿå®ç°è¿™ä¸ª2bit-mapï¼Œéƒ½æ˜¯ä¸€æ ·çš„é“ç†ã€‚ æœ€åæ”¾ä¸€ä¸ªä½¿ç”¨Byte[]æ•°ç»„å­˜å‚¨ã€è¯»å–bitä½çš„ç¤ºä¾‹ä»£ç ï¼Œæ¥è‡ªåˆ©ç”¨ä½æ˜ å°„åŸç†å¯¹å¤§æ•°æ®æ’é‡ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758class BitmapTest &#123; private static final int CAPACITY = 1000000000;//æ•°æ®å®¹é‡ // å®šä¹‰ä¸€ä¸ªbyteæ•°ç»„ç¼“å­˜æ‰€æœ‰çš„æ•°æ® private byte[] dataBytes = new byte[1 &lt;&lt; 29]; public static void main(String[] args) &#123; BitmapTest ms = new BitmapTest(); byte[] bytes = null; Random random = new Random(); for (int i = 0; i &lt; CAPACITY; i++) &#123; int num = random.nextInt(); System.out.println(\"è¯»å–äº†ç¬¬ \" + (i + 1) + \"\\tä¸ªæ•°: \" + num); bytes = ms.splitBigData(num); &#125; System.out.println(\"\"); ms.output(bytes); &#125; /** * è¯»å–æ•°æ®ï¼Œå¹¶å°†å¯¹åº”æ•°æ•°æ®çš„ åˆ°å¯¹åº”çš„bitä¸­ï¼Œå¹¶è¿”å›byteæ•°ç»„ * @param num è¯»å–çš„æ•°æ® * @return byteæ•°ç»„ dataBytes */ private byte[] splitBigData(int num) &#123; long bitIndex = num + (1l &lt;&lt; 31); //è·å–numæ•°æ®å¯¹åº”bitæ•°ç»„ï¼ˆè™šæ‹Ÿï¼‰çš„ç´¢å¼• int index = (int) (bitIndex / 8); //bitæ•°ç»„ï¼ˆè™šæ‹Ÿï¼‰åœ¨byteæ•°ç»„ä¸­çš„ç´¢å¼• int innerIndex = (int) (bitIndex % 8); //bitIndex åœ¨byte[]æ•°ç»„ç´¢å¼•index ä¸­çš„å…·ä½“ä½ç½® System.out.println(\"byte[\" + index + \"] ä¸­çš„ç´¢å¼•ï¼š\" + innerIndex); dataBytes[index] = (byte) (dataBytes[index] | (1 &lt;&lt; innerIndex)); return dataBytes; &#125; /** * è¾“å‡ºæ•°ç»„ä¸­çš„æ•°æ® * @param bytes byteæ•°ç»„ */ private void output(byte[] bytes) &#123; int count = 0; for (int i = 0; i &lt; bytes.length; i++) &#123; for (int j = 0; j &lt; 8; j++) &#123; if (!(((bytes[i]) &amp; (1 &lt;&lt; j)) == 0)) &#123; count++; int number = (int) ((((long) i * 8 + j) - (1l &lt;&lt; 31))); System.out.println(\"å–å‡ºçš„ç¬¬ \" + count + \"\\tä¸ªæ•°: \" + number); &#125; &#125; &#125; &#125;&#125; 2ã€åˆ†æ²»æ³•åˆ†æ²»æ³•ç›®å‰çœ‹åˆ°çš„è§£å†³æ–¹æ¡ˆæœ‰å“ˆå¸Œåˆ†æ¡¶ï¼ˆHash Bucketsï¼‰å’Œå½’å¹¶æ’åºä¸¤ç§æ–¹æ¡ˆã€‚ å“ˆå¸Œåˆ†æ¡¶çš„æ€æƒ³æ˜¯å…ˆéå†ä¸€éï¼ŒæŒ‰ç…§hashåˆ†Næ¡¶ï¼ˆæ¯”å¦‚1000æ¡¶ï¼‰ï¼Œæ˜ å°„åˆ°ä¸åŒçš„æ–‡ä»¶ä¸­ã€‚è¿™æ ·å¹³å‡æ¯ä¸ªæ–‡ä»¶å°±10MBï¼Œç„¶ååˆ†åˆ«å¤„ç†è¿™1000ä¸ªæ–‡ä»¶ï¼Œæ‰¾å‡ºæ²¡æœ‰é‡å¤çš„å³å¯ã€‚ä¸€ä¸ªç›¸åŒçš„æ•°å­—ï¼Œç»å¯¹ä¸ä¼šå¤¸æ–‡ä»¶ï¼Œæœ‰hashåšä¿è¯ã€‚å› ä¸ºç®—æ³•å…·ä½“è¿˜ä¸ç”šäº†è§£ï¼Œè¿™é‡Œå…ˆä¸åšè¯¦ç»†ä»‹ç»ã€‚ å½’å¹¶æ’åºçš„æ€æƒ³å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šé¢è¯•é¢˜ä¹‹10äº¿æ­£æ•´æ•°é—®é¢˜ç»­â€“å…³äºå¤šé€šé“æ’åºçš„é—®é¢˜ å‚è€ƒèµ„æ–™ ç¨‹åºå‘˜ç¼–ç¨‹è‰ºæœ¯ï¼šç¬¬åç« ã€å¦‚ä½•ç»™10^7ä¸ªæ•°æ®é‡çš„ç£ç›˜æ–‡ä»¶æ’åº é¢è¯•é¢˜ä¹‹10äº¿æ­£æ•´æ•°é—®é¢˜ç»­â€“å…³äºå¤šé€šé“æ’åºçš„é—®é¢˜ åˆ©ç”¨ä½æ˜ å°„åŸç†å¯¹å¤§æ•°æ®æ’é‡ åé“æµ·é‡æ•°æ®å¤„ç†é¢è¯•é¢˜ä¸åä¸ªæ–¹æ³•å¤§æ€»ç»“ æµ·é‡æ•°æ®å¤„ç†ä¹‹BitMap","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"é—ä¼ ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µå’ŒJavaå®ç°","slug":"é—ä¼ ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µå’ŒJavaå®ç°","date":"2017-07-11T10:30:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/07/11/é—ä¼ ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µå’ŒJavaå®ç°/","link":"","permalink":"http://github.com/2017/07/11/é—ä¼ ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µå’ŒJavaå®ç°/","excerpt":"åŸºå› é—ä¼ ç®—æ³•æ˜¯ä¸€ç§çµæ„Ÿæºäºè¾¾å°”æ–‡è‡ªç„¶è¿›åŒ–ç†è®ºçš„å¯å‘å¼æœç´¢ç®—æ³•ã€‚è¯¥ç®—æ³•åæ˜ äº†è‡ªç„¶é€‰æ‹©çš„è¿‡ç¨‹ï¼Œå³æœ€é€‚è€…è¢«é€‰å®šç¹æ®–ï¼Œå¹¶äº§ç”Ÿä¸‹ä¸€ä»£ã€‚æœ¬æ–‡ç®€è¦åœ°ä»‹ç»äº†é—ä¼ ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µå’Œå®ç°ï¼Œå¸Œæœ›èƒ½ä¸ºè¯»è€…å±•ç¤ºå¯å‘å¼æœç´¢çš„é­…åŠ›ã€‚","text":"åŸºå› é—ä¼ ç®—æ³•æ˜¯ä¸€ç§çµæ„Ÿæºäºè¾¾å°”æ–‡è‡ªç„¶è¿›åŒ–ç†è®ºçš„å¯å‘å¼æœç´¢ç®—æ³•ã€‚è¯¥ç®—æ³•åæ˜ äº†è‡ªç„¶é€‰æ‹©çš„è¿‡ç¨‹ï¼Œå³æœ€é€‚è€…è¢«é€‰å®šç¹æ®–ï¼Œå¹¶äº§ç”Ÿä¸‹ä¸€ä»£ã€‚æœ¬æ–‡ç®€è¦åœ°ä»‹ç»äº†é—ä¼ ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µå’Œå®ç°ï¼Œå¸Œæœ›èƒ½ä¸ºè¯»è€…å±•ç¤ºå¯å‘å¼æœç´¢çš„é­…åŠ›ã€‚ é—ä¼ ç®—æ³•çš„æ¦‚å¿µè‡ªç„¶é€‰æ‹©çš„è¿‡ç¨‹ä»é€‰æ‹©ç¾¤ä½“ä¸­æœ€é€‚åº”ç¯å¢ƒçš„ä¸ªä½“å¼€å§‹ã€‚åä»£ç»§æ‰¿äº†çˆ¶æ¯çš„ç‰¹æ€§ï¼Œå¹¶ä¸”è¿™äº›ç‰¹æ€§å°†æ·»åŠ åˆ°ä¸‹ä¸€ä»£ä¸­ã€‚å¦‚æœçˆ¶æ¯å…·æœ‰æ›´å¥½çš„é€‚åº”æ€§ï¼Œé‚£ä¹ˆå®ƒä»¬çš„åä»£å°†æ›´æ˜“äºå­˜æ´»ã€‚è¿­ä»£åœ°è¿›è¡Œè¯¥è‡ªç„¶é€‰æ‹©çš„è¿‡ç¨‹ï¼Œæœ€ç»ˆï¼Œæˆ‘ä»¬å°†å¾—åˆ°ç”±æœ€é€‚åº”ç¯å¢ƒçš„ä¸ªä½“ç»„æˆçš„ä¸€ä»£ã€‚ è¿™ä¸€æ¦‚å¿µå¯ä»¥è¢«åº”ç”¨äºæœç´¢é—®é¢˜ä¸­ã€‚æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªé—®é¢˜çš„è¯¸å¤šè§£å†³æ–¹æ¡ˆï¼Œå¹¶ä»ä¸­æœå¯»å‡ºæœ€ä½³æ–¹æ¡ˆã€‚ é—ä¼ ç®—æ³•å«ä»¥ä¸‹äº”æ­¥ï¼š åˆå§‹åŒ– ä¸ªä½“è¯„ä»·ï¼ˆè®¡ç®—é€‚åº”åº¦å‡½æ•°ï¼‰ é€‰æ‹©è¿ç®— äº¤å‰è¿ç®— å˜å¼‚è¿ç®— åˆå§‹åŒ–è¯¥è¿‡ç¨‹ä»ç§ç¾¤çš„ä¸€ç»„ä¸ªä½“å¼€å§‹ï¼Œä¸”æ¯ä¸€ä¸ªä½“éƒ½æ˜¯å¾…è§£å†³é—®é¢˜çš„ä¸€ä¸ªå€™é€‰è§£ã€‚ ä¸ªä½“ä»¥ä¸€ç»„å‚æ•°ï¼ˆå˜é‡ï¼‰ä¸ºç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾è¢«ç§°ä¸ºåŸºå› ï¼Œä¸²è”è¿™äº›åŸºå› å°±å¯ä»¥ç»„æˆæŸ“è‰²ä½“ï¼ˆé—®é¢˜çš„è§£ï¼‰ã€‚ åœ¨é—ä¼ ç®—æ³•ä¸­ï¼Œå•ä¸ªä¸ªä½“çš„åŸºå› ç»„ä»¥å­—ç¬¦ä¸²çš„æ–¹å¼å‘ˆç°ï¼Œé€šå¸¸æˆ‘ä»¬å¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶ï¼ˆ1 å’Œ 0 çš„å­—ç¬¦ä¸²ï¼‰ç¼–ç ï¼Œå³ä¸€ä¸ªäºŒè¿›åˆ¶ä¸²ä»£è¡¨ä¸€æ¡æŸ“è‰²ä½“ä¸²ã€‚å› æ­¤å¯ä»¥è¯´æˆ‘ä»¬å°†åŸºå› ä¸²æˆ–å€™é€‰è§£çš„ç‰¹å¾ç¼–ç åœ¨æŸ“è‰²ä½“ä¸­ã€‚ ä¸ªä½“è¯„ä»·ï¼ˆè®¡ç®—é€‚åº”åº¦å‡½æ•°ï¼‰ä¸ªä½“è¯„ä»·åˆ©ç”¨é€‚åº”åº¦å‡½æ•°è¯„ä¼°äº†è¯¥ä¸ªä½“å¯¹ç¯å¢ƒçš„é€‚åº”åº¦ï¼ˆä¸å…¶å®ƒä¸ªä½“ç«äº‰çš„èƒ½åŠ›ï¼‰ã€‚æ¯ä¸€ä¸ªä½“éƒ½æœ‰é€‚åº”åº¦è¯„åˆ†ï¼Œä¸ªä½“è¢«é€‰ä¸­è¿›è¡Œç¹æ®–çš„å¯èƒ½æ€§å–å†³äºå…¶é€‚åº”åº¦è¯„åˆ†ã€‚é€‚åº”åº¦å‡½æ•°å€¼è¶Šå¤§ï¼Œè§£çš„è´¨é‡å°±è¶Šé«˜ã€‚é€‚åº”åº¦å‡½æ•°æ˜¯é—ä¼ ç®—æ³•è¿›åŒ–çš„é©±åŠ¨åŠ›ï¼Œä¹Ÿæ˜¯è¿›è¡Œè‡ªç„¶é€‰æ‹©çš„å”¯ä¸€æ ‡å‡†ï¼Œå®ƒçš„è®¾è®¡åº”ç»“åˆæ±‚è§£é—®é¢˜æœ¬èº«çš„è¦æ±‚è€Œå®šã€‚ é€‰æ‹©è¿ç®—é€‰æ‹©è¿ç®—çš„ç›®çš„æ˜¯é€‰å‡ºé€‚åº”æ€§æœ€å¥½çš„ä¸ªä½“ï¼Œå¹¶ä½¿å®ƒä»¬å°†åŸºå› ä¼ åˆ°ä¸‹ä¸€ä»£ä¸­ã€‚åŸºäºå…¶é€‚åº”åº¦è¯„åˆ†ï¼Œæˆ‘ä»¬é€‰æ‹©å¤šå¯¹è¾ƒä¼˜ä¸ªä½“ï¼ˆçˆ¶æ¯ï¼‰ã€‚é€‚åº”åº¦é«˜çš„ä¸ªä½“æ›´æ˜“è¢«é€‰ä¸­ç¹æ®–ï¼Œå³å°†è¾ƒä¼˜çˆ¶æ¯çš„åŸºå› ä¼ é€’åˆ°ä¸‹ä¸€ä»£ã€‚ äº¤å‰è¿ç®—äº¤å‰è¿ç®—æ˜¯é—ä¼ ç®—æ³•ä¸­æœ€é‡è¦çš„é˜¶æ®µã€‚å¯¹æ¯ä¸€å¯¹é…å¯¹çš„çˆ¶æ¯ï¼ŒåŸºå› éƒ½å­˜åœ¨éšæœºé€‰ä¸­çš„äº¤å‰ç‚¹ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹å›¾çš„äº¤å‰ç‚¹ä¸º 3ï¼š çˆ¶æ¯é—´åœ¨äº¤å‰ç‚¹ä¹‹å‰äº¤æ¢åŸºå› ï¼Œä»è€Œäº§ç”Ÿäº†åä»£ã€‚ çˆ¶æ¯é—´äº¤æ¢åŸºå› ï¼Œç„¶åäº§ç”Ÿçš„æ–°åä»£è¢«æ·»åŠ åˆ°ç§ç¾¤ä¸­ã€‚ å˜å¼‚è¿ç®—åœ¨æŸäº›å½¢æˆçš„æ–°åä»£ä¸­ï¼Œå®ƒä»¬çš„æŸäº›åŸºå› å¯èƒ½å—åˆ°ä½æ¦‚ç‡å˜å¼‚å› å­çš„ä½œç”¨ã€‚è¿™æ„å‘³ç€äºŒè¿›åˆ¶ä½ä¸²ä¸­çš„æŸäº›ä½å¯èƒ½ä¼šç¿»è½¬ã€‚ å˜å¼‚è¿ç®—å¯ç”¨äºä¿æŒç§ç¾¤å†…çš„å¤šæ ·æ€§ï¼Œå¹¶é˜²æ­¢è¿‡æ—©æ”¶æ•›ã€‚ ç»ˆæ­¢åœ¨ç¾¤ä½“æ”¶æ•›çš„æƒ…å†µä¸‹ï¼ˆç¾¤ä½“å†…ä¸äº§ç”Ÿä¸å‰ä¸€ä»£å·®å¼‚è¾ƒå¤§çš„åä»£ï¼‰è¯¥ç®—æ³•ç»ˆæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´é—ä¼ ç®—æ³•æä¾›äº†ä¸€ç»„é—®é¢˜çš„è§£ã€‚ æ¡ˆä¾‹å®ç°ç§ç¾¤çš„è§„æ¨¡æ’å®šã€‚æ–°ä¸€ä»£å½¢æˆæ—¶ï¼Œé€‚åº”åº¦æœ€å·®çš„ä¸ªä½“å‡‹äº¡ï¼Œä¸ºåä»£ç•™å‡ºç©ºé—´ã€‚è¿™äº›é˜¶æ®µçš„åºåˆ—è¢«ä¸æ–­é‡å¤ï¼Œä»¥äº§ç”Ÿä¼˜äºå…ˆå‰çš„æ–°ä¸€ä»£ã€‚ è¿™ä¸€è¿­ä»£è¿‡ç¨‹çš„ä¼ªä»£ç ï¼š 12345678910STARTGenerate the initial populationCompute fitnessREPEAT Selection Crossover Mutation Compute fitnessUNTIL population has convergedSTOP Java ä¸­çš„å®ä¾‹å®ç°ä»¥ä¸‹å±•ç¤ºçš„æ˜¯é—ä¼ ç®—æ³•åœ¨ Java ä¸­çš„ç¤ºä¾‹å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥éšæ„è°ƒè¯•å’Œä¿®æ”¹è¿™äº›ä»£ç ã€‚ç»™å®šä¸€ç»„äº”ä¸ªåŸºå› ï¼Œæ¯ä¸€ä¸ªåŸºå› å¯ä»¥ä¿å­˜ä¸€ä¸ªäºŒè¿›åˆ¶å€¼ 0 æˆ– 1ã€‚è¿™é‡Œçš„é€‚åº”åº¦æ˜¯åŸºå› ç»„ä¸­ 1 çš„æ•°é‡ã€‚å¦‚æœåŸºå› ç»„å†…å…±æœ‰äº”ä¸ª 1ï¼Œåˆ™è¯¥ä¸ªä½“é€‚åº”åº¦è¾¾åˆ°æœ€å¤§å€¼ã€‚å¦‚æœåŸºå› ç»„å†…æ²¡æœ‰ 1ï¼Œé‚£ä¹ˆä¸ªä½“çš„é€‚åº”åº¦è¾¾åˆ°æœ€å°å€¼ã€‚è¯¥é—ä¼ ç®—æ³•å¸Œæœ›æœ€å¤§åŒ–é€‚åº”åº¦ï¼Œå¹¶æä¾›é€‚åº”åº¦è¾¾åˆ°æœ€å¤§çš„ä¸ªä½“æ‰€ç»„æˆçš„ç¾¤ä½“ã€‚æ³¨æ„ï¼šæœ¬ä¾‹ä¸­ï¼Œåœ¨äº¤å‰è¿ç®—ä¸çªå˜è¿ç®—ä¹‹åï¼Œé€‚åº”åº¦æœ€ä½çš„ä¸ªä½“è¢«æ–°çš„ï¼Œé€‚åº”åº¦æœ€é«˜çš„åä»£æ‰€æ›¿ä»£ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233import java.util.Random;/** * * @author Vijini *///Main classpublic class SimpleDemoGA &#123; Population population = new Population(); Individual fittest; Individual secondFittest; int generationCount = 0; public static void main(String[] args) &#123; Random rn = new Random(); SimpleDemoGA demo = new SimpleDemoGA(); //Initialize population demo.population.initializePopulation(10); //Calculate fitness of each individual demo.population.calculateFitness(); System.out.println(\"Generation: \" + demo.generationCount + \" Fittest: \" + demo.population.fittest); //While population gets an individual with maximum fitness while (demo.population.fittest &lt; 5) &#123; ++demo.generationCount; //Do selection demo.selection(); //Do crossover demo.crossover(); //Do mutation under a random probability if (rn.nextInt()%7 &lt; 5) &#123; demo.mutation(); &#125; //Add fittest offspring to population demo.addFittestOffspring(); //Calculate new fitness value demo.population.calculateFitness(); System.out.println(\"Generation: \" + demo.generationCount + \" Fittest: \" + demo.population.fittest); &#125; System.out.println(\"\\nSolution found in generation \" + demo.generationCount); System.out.println(\"Fitness: \"+demo.population.getFittest().fitness); System.out.print(\"Genes: \"); for (int i = 0; i &lt; 5; i++) &#123; System.out.print(demo.population.getFittest().genes[i]); &#125; System.out.println(\"\"); &#125; //Selection void selection() &#123; //Select the most fittest individual fittest = population.getFittest(); //Select the second most fittest individual secondFittest = population.getSecondFittest(); &#125; //Crossover void crossover() &#123; Random rn = new Random(); //Select a random crossover point int crossOverPoint = rn.nextInt(population.individuals[0].geneLength); //Swap values among parents for (int i = 0; i &lt; crossOverPoint; i++) &#123; int temp = fittest.genes[i]; fittest.genes[i] = secondFittest.genes[i]; secondFittest.genes[i] = temp; &#125; &#125; //Mutation void mutation() &#123; Random rn = new Random(); //Select a random mutation point int mutationPoint = rn.nextInt(population.individuals[0].geneLength); //Flip values at the mutation point if (fittest.genes[mutationPoint] == 0) &#123; fittest.genes[mutationPoint] = 1; &#125; else &#123; fittest.genes[mutationPoint] = 0; &#125; mutationPoint = rn.nextInt(population.individuals[0].geneLength); if (secondFittest.genes[mutationPoint] == 0) &#123; secondFittest.genes[mutationPoint] = 1; &#125; else &#123; secondFittest.genes[mutationPoint] = 0; &#125; &#125; //Get fittest offspring Individual getFittestOffspring() &#123; if (fittest.fitness &gt; secondFittest.fitness) &#123; return fittest; &#125; return secondFittest; &#125; //Replace least fittest individual from most fittest offspring void addFittestOffspring() &#123; //Update fitness values of offspring fittest.calcFitness(); secondFittest.calcFitness(); //Get index of least fit individual int leastFittestIndex = population.getLeastFittestIndex(); //Replace least fittest individual from most fittest offspring population.individuals[leastFittestIndex] = getFittestOffspring(); &#125;&#125;//Individual classclass Individual &#123; int fitness = 0; int[] genes = new int[5]; int geneLength = 5; public Individual() &#123; Random rn = new Random(); //Set genes randomly for each individual for (int i = 0; i &lt; genes.length; i++) &#123; genes[i] = rn.nextInt() % 2; &#125; fitness = 0; &#125; //Calculate fitness public void calcFitness() &#123; fitness = 0; for (int i = 0; i &lt; 5; i++) &#123; if (genes[i] == 1) &#123; ++fitness; &#125; &#125; &#125;&#125;//Population classclass Population &#123; int popSize = 10; Individual[] individuals = new Individual[10]; int fittest = 0; //Initialize population public void initializePopulation(int size) &#123; for (int i = 0; i &lt; individuals.length; i++) &#123; individuals[i] = new Individual(); &#125; &#125; //Get the fittest individual public Individual getFittest() &#123; int maxFit = Integer.MIN_VALUE; for (int i = 0; i &lt; individuals.length; i++) &#123; if (maxFit &lt;= individuals[i].fitness) &#123; maxFit = i; &#125; &#125; fittest = individuals[maxFit].fitness; return individuals[maxFit]; &#125; //Get the second most fittest individual public Individual getSecondFittest() &#123; int maxFit1 = 0; int maxFit2 = 0; for (int i = 0; i &lt; individuals.length; i++) &#123; if (individuals[i].fitness &gt; individuals[maxFit1].fitness) &#123; maxFit2 = maxFit1; maxFit1 = i; &#125; else if (individuals[i].fitness &gt; individuals[maxFit2].fitness) &#123; maxFit2 = i; &#125; &#125; return individuals[maxFit2]; &#125; //Get index of least fittest individual public int getLeastFittestIndex() &#123; int minFit = 0; for (int i = 0; i &lt; individuals.length; i++) &#123; if (minFit &gt;= individuals[i].fitness) &#123; minFit = i; &#125; &#125; return minFit; &#125; //Calculate fitness of each individual public void calculateFitness() &#123; for (int i = 0; i &lt; individuals.length; i++) &#123; individuals[i].calcFitness(); &#125; getFittest(); &#125;&#125; åŸæ–‡æ¥è‡ªï¼šIntroduction to Genetic Algorithms â€” Including Example Code","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Javaã€‘Integerå˜é‡ç›¸ç­‰ï¼ˆ==ï¼‰æ¯”è¾ƒé—®é¢˜","slug":"ã€Javaã€‘Integerå˜é‡ç›¸ç­‰ï¼ˆ==ï¼‰æ¯”è¾ƒé—®é¢˜","date":"2017-07-11T04:30:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/07/11/ã€Javaã€‘Integerå˜é‡ç›¸ç­‰ï¼ˆ==ï¼‰æ¯”è¾ƒé—®é¢˜/","link":"","permalink":"http://github.com/2017/07/11/ã€Javaã€‘Integerå˜é‡ç›¸ç­‰ï¼ˆ==ï¼‰æ¯”è¾ƒé—®é¢˜/","excerpt":"é¢˜ç›®è¿™æ˜¯å…³äºä¸€æ®µä»¤äººç–‘æƒ‘çš„Javaä»£ç : 12345678910111213class TestIntegerCache &#123; public static void main(String[] args)&#123; Integer i3 = 100; Integer i4 = 100; System.out.println(i3 == i4); Integer i5 = 1000; Integer i6 = 1000; System.out.println(i5 == i6); &#125; &#125; è¿™ä¹ˆç®€å•ï¼Œæ‰§è¡Œç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ truefalse ä¸€ä¸ªæ˜¯trueï¼Œä¸€ä¸ªæ˜¯falseï¼è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆå’Œå¤§å¤šæ•°äººå¿ƒé‡Œæƒ³çš„ä¸ä¸€æ ·ï¼","text":"é¢˜ç›®è¿™æ˜¯å…³äºä¸€æ®µä»¤äººç–‘æƒ‘çš„Javaä»£ç : 12345678910111213class TestIntegerCache &#123; public static void main(String[] args)&#123; Integer i3 = 100; Integer i4 = 100; System.out.println(i3 == i4); Integer i5 = 1000; Integer i6 = 1000; System.out.println(i5 == i6); &#125; &#125; è¿™ä¹ˆç®€å•ï¼Œæ‰§è¡Œç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ truefalse ä¸€ä¸ªæ˜¯trueï¼Œä¸€ä¸ªæ˜¯falseï¼è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆå’Œå¤§å¤šæ•°äººå¿ƒé‡Œæƒ³çš„ä¸ä¸€æ ·ï¼ åˆ†ææ ¹æ®Javaç¼–è¯‘æœºåˆ¶ï¼Œ.javaæ–‡ä»¶åœ¨ç¼–è¯‘ä»¥åä¼šç”Ÿæˆ.classæ–‡ä»¶ç»™JVMåŠ è½½æ‰§è¡Œï¼Œäºæ˜¯æ‰¾åˆ°.classæ–‡ä»¶ï¼Œåç¼–è¯‘çœ‹äº†ä¸€ä¸‹ï¼Œå‘ç°ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æˆ‘ä»¬çš„ä»£ç æ—¶ï¼Œå¾ˆè°ƒçš®ï¼ˆèªæ˜çš„ï¼‰çš„åœ¨æˆ‘ä»¬å£°æ˜çš„å˜é‡åŠ ä¸Šäº†valueOfæ–¹æ³• ï¼Œä»£ç å˜æˆäº†å¦‚ä¸‹ï¼š 12345678910111213class TestIntegerCache &#123; public static void main(String[] args)&#123; Integer i3 = Integer.valueOf(100); Integer i4 = Integer.valueOf(100); System.out.println(i3 == i4); Integer i5 = Integer.valueOf(1000); Integer i6 = Integer.valueOf(1000); System.out.println(i5 == i6); &#125;&#125; valueOf() æ–¹æ³•å¯¹å®ƒåšäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬çœ‹çœ‹æºä»£ç ï¼š 1234567891011121314151617181920/** * Returns an &#123;@code Integer&#125; instance representing the specified * &#123;@code int&#125; value. If a new &#123;@code Integer&#125; instance is not * required, this method should generally be used in preference to * the constructor &#123;@link #Integer(int)&#125;, as this method is likely * to yield significantly better space and time performance by * caching frequently requested values. * * This method will always cache values in the range -128 to 127, * inclusive, and may cache other values outside of this range. * * @param i an &#123;@code int&#125; value. * @return an &#123;@code Integer&#125; instance representing &#123;@code i&#125;. * @since 1.5 */public static Integer valueOf(int i) &#123; if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high) //æˆ‘ä»¬çœ‹åˆ°è¿™é‡Œæœ‰ä¸ªç¼“å­˜ï¼Œåœ¨ç¼“å­˜åŒºé—´å°±è¿”å›ç¼“å­˜é‡Œçš„ return IntegerCache.cache[i + (-IntegerCache.low)]; //ç¼“å­˜æ•°ç»„ç›¸åº”çš„å¯¹è±¡ return new Integer(i); //ä¸åœ¨ç¼“å­˜æ•°ç»„åŒºé—´å°±newä¸€ä¸ªå¯¹è±¡ &#125; æˆ‘ä»¬å‘ç°ï¼ŒIntegerçš„ä½œè€…åœ¨å†™è¿™ä¸ªç±»æ—¶ï¼Œä¸ºäº†é¿å…é‡å¤åˆ›å»ºå¯¹è±¡ï¼Œå¯¹Integerå€¼åšäº†ç¼“å­˜ï¼Œå¦‚æœè¿™ä¸ªå€¼åœ¨ç¼“å­˜èŒƒå›´å†…ï¼Œç›´æ¥è¿”å›ç¼“å­˜å¥½çš„å¯¹è±¡ï¼Œå¦åˆ™newä¸€ä¸ªæ–°çš„å¯¹è±¡è¿”å›ï¼Œé‚£ç©¶ç«Ÿè¿™ä¸ªç¼“å­˜åˆ°åº•ç¼“å­˜äº†å“ªäº›å†…å®¹å‘¢ï¼Ÿçœ‹ä¸€ä¸‹IntegerCacheè¿™ä¸ªç±»ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546/** * Cache to support the object identity semantics of autoboxing for values between * -128 and 127 (inclusive) as required by JLS. * * The cache is initialized on first usage. The size of the cache * may be controlled by the &#123;@code -XX:AutoBoxCacheMax=&lt;size&gt;&#125; option. * During VM initialization, java.lang.Integer.IntegerCache.high property * may be set and saved in the private system properties in the * sun.misc.VM class. */ private static class IntegerCache &#123; static final int low = -128; static final int high; static final Integer cache[]; static &#123; //æ£€æŸ¥è™šæ‹Ÿæœºé‡Œæ˜¯å¦æœ‰ç¼“å­˜åŒºé—´é…ç½®é¡¹ï¼Œå¦‚æœæœ‰å°±èµ‹æˆè¯¥å€¼ï¼Œæ²¡æœ‰å°±é»˜è®¤[-128, 127] // high value may be configured by property int h = 127; String integerCacheHighPropValue = sun.misc.VM.getSavedProperty(\"java.lang.Integer.IntegerCache.high\"); if (integerCacheHighPropValue != null) &#123; try &#123; int i = parseInt(integerCacheHighPropValue); i = Math.max(i, 127); // Maximum array size is Integer.MAX_VALUE h = Math.min(i, Integer.MAX_VALUE - (-low) -1); &#125; catch( NumberFormatException nfe) &#123; // If the property cannot be parsed into an int, ignore it. &#125; &#125; high = h; //åˆ›å»ºç¼“å­˜æ•°ç»„ï¼Œå¹¶åˆå§‹åŒ–ï¼ˆç¼“å­˜å€¼ï¼‰ cache = new Integer[(high - low) + 1]; int j = low; for(int k = 0; k &lt; cache.length; k++) cache[k] = new Integer(j++); // range [-128, 127] must be interned (JLS7 5.1.7) assert IntegerCache.high &gt;= 127; &#125; private IntegerCache() &#123;&#125; &#125; è¿™æ˜¯ä¸€ä¸ªå†…éƒ¨é™æ€ç±»ï¼Œè¯¥ç±»åªèƒ½åœ¨Integerè¿™ä¸ªç±»çš„å†…éƒ¨è®¿é—®ï¼Œè¿™ä¸ªç±»åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¼šå»åŠ è½½JVMçš„é…ç½®ï¼Œå¦‚æœæœ‰å€¼ï¼Œå°±ç”¨é…ç½®çš„å€¼åˆå§‹åŒ–ç¼“å­˜æ•°ç»„ï¼Œå¦åˆ™å°±ç¼“å­˜-128åˆ°127ä¹‹é—´çš„å€¼ã€‚å†æ¥çœ‹çœ‹æˆ‘ä»¬ä¹‹å‰çš„ä»£ç ï¼š çœ‹å®Œè¿™ä¸ªï¼Œæ˜¯ä¸æ˜¯æ˜ç™½äº†å‘¢ å‚è€ƒèµ„æ–™è®©äººç–‘æƒ‘çš„ä»£ç ï¼Œç«Ÿæˆå¤§å¤šå…¬å¸é¢è¯•é¢˜çƒ­é—¨ï¼","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap","slug":"Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap","date":"2017-06-16T09:30:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/06/16/Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap/","link":"","permalink":"http://github.com/2017/06/16/Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap/","excerpt":"æœ¬æ–‡æ¥è‡ªç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿï¼š Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap æ‘˜è¦HashMapæ˜¯Javaç¨‹åºå‘˜ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„ç”¨äºæ˜ å°„(é”®å€¼å¯¹)å¤„ç†çš„æ•°æ®ç±»å‹ã€‚éšç€JDKï¼ˆJava Developmet Kitï¼‰ç‰ˆæœ¬çš„æ›´æ–°ï¼ŒJDK1.8å¯¹HashMapåº•å±‚çš„å®ç°è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¾‹å¦‚å¼•å…¥çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„å’Œæ‰©å®¹çš„ä¼˜åŒ–ç­‰ã€‚æœ¬æ–‡ç»“åˆJDK1.7å’ŒJDK1.8çš„åŒºåˆ«ï¼Œæ·±å…¥æ¢è®¨HashMapçš„ç»“æ„å®ç°å’ŒåŠŸèƒ½åŸç†ã€‚ ç®€ä»‹Javaä¸ºæ•°æ®ç»“æ„ä¸­çš„æ˜ å°„å®šä¹‰äº†ä¸€ä¸ªæ¥å£java.util.Mapï¼Œæ­¤æ¥å£ä¸»è¦æœ‰å››ä¸ªå¸¸ç”¨çš„å®ç°ç±»ï¼Œåˆ†åˆ«æ˜¯HashMapã€Hashtableã€LinkedHashMapå’ŒTreeMapï¼Œç±»ç»§æ‰¿å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š","text":"æœ¬æ–‡æ¥è‡ªç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿï¼š Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap æ‘˜è¦HashMapæ˜¯Javaç¨‹åºå‘˜ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„ç”¨äºæ˜ å°„(é”®å€¼å¯¹)å¤„ç†çš„æ•°æ®ç±»å‹ã€‚éšç€JDKï¼ˆJava Developmet Kitï¼‰ç‰ˆæœ¬çš„æ›´æ–°ï¼ŒJDK1.8å¯¹HashMapåº•å±‚çš„å®ç°è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¾‹å¦‚å¼•å…¥çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„å’Œæ‰©å®¹çš„ä¼˜åŒ–ç­‰ã€‚æœ¬æ–‡ç»“åˆJDK1.7å’ŒJDK1.8çš„åŒºåˆ«ï¼Œæ·±å…¥æ¢è®¨HashMapçš„ç»“æ„å®ç°å’ŒåŠŸèƒ½åŸç†ã€‚ ç®€ä»‹Javaä¸ºæ•°æ®ç»“æ„ä¸­çš„æ˜ å°„å®šä¹‰äº†ä¸€ä¸ªæ¥å£java.util.Mapï¼Œæ­¤æ¥å£ä¸»è¦æœ‰å››ä¸ªå¸¸ç”¨çš„å®ç°ç±»ï¼Œåˆ†åˆ«æ˜¯HashMapã€Hashtableã€LinkedHashMapå’ŒTreeMapï¼Œç±»ç»§æ‰¿å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸‹é¢é’ˆå¯¹å„ä¸ªå®ç°ç±»çš„ç‰¹ç‚¹åšä¸€äº›è¯´æ˜ï¼š (1) HashMapï¼šå®ƒæ ¹æ®é”®çš„hashCodeå€¼å­˜å‚¨æ•°æ®ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ç›´æ¥å®šä½åˆ°å®ƒçš„å€¼ï¼Œå› è€Œå…·æœ‰å¾ˆå¿«çš„è®¿é—®é€Ÿåº¦ï¼Œä½†éå†é¡ºåºå´æ˜¯ä¸ç¡®å®šçš„ã€‚ HashMapæœ€å¤šåªå…è®¸ä¸€æ¡è®°å½•çš„é”®ä¸ºnullï¼Œå…è®¸å¤šæ¡è®°å½•çš„å€¼ä¸ºnullã€‚HashMapéçº¿ç¨‹å®‰å…¨ï¼Œå³ä»»ä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™HashMapï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚å¦‚æœéœ€è¦æ»¡è¶³çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥ç”¨ Collectionsçš„synchronizedMapæ–¹æ³•ä½¿HashMapå…·æœ‰çº¿ç¨‹å®‰å…¨çš„èƒ½åŠ›ï¼Œæˆ–è€…ä½¿ç”¨ConcurrentHashMapã€‚ (2) Hashtableï¼šHashtableæ˜¯é—ç•™ç±»ï¼Œå¾ˆå¤šæ˜ å°„çš„å¸¸ç”¨åŠŸèƒ½ä¸HashMapç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å®ƒæ‰¿è‡ªDictionaryç±»ï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä»»ä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å†™Hashtableï¼Œå¹¶å‘æ€§ä¸å¦‚ConcurrentHashMapï¼Œå› ä¸ºConcurrentHashMapå¼•å…¥äº†åˆ†æ®µé”ã€‚Hashtableä¸å»ºè®®åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ï¼Œä¸éœ€è¦çº¿ç¨‹å®‰å…¨çš„åœºåˆå¯ä»¥ç”¨HashMapæ›¿æ¢ï¼Œéœ€è¦çº¿ç¨‹å®‰å…¨çš„åœºåˆå¯ä»¥ç”¨ConcurrentHashMapæ›¿æ¢ã€‚ (3) LinkedHashMapï¼šLinkedHashMapæ˜¯HashMapçš„ä¸€ä¸ªå­ç±»ï¼Œä¿å­˜äº†è®°å½•çš„æ’å…¥é¡ºåºï¼Œåœ¨ç”¨Iteratoréå†LinkedHashMapæ—¶ï¼Œå…ˆå¾—åˆ°çš„è®°å½•è‚¯å®šæ˜¯å…ˆæ’å…¥çš„ï¼Œä¹Ÿå¯ä»¥åœ¨æ„é€ æ—¶å¸¦å‚æ•°ï¼ŒæŒ‰ç…§è®¿é—®æ¬¡åºæ’åºã€‚ (4) TreeMapï¼šTreeMapå®ç°SortedMapæ¥å£ï¼Œèƒ½å¤ŸæŠŠå®ƒä¿å­˜çš„è®°å½•æ ¹æ®é”®æ’åºï¼Œé»˜è®¤æ˜¯æŒ‰é”®å€¼çš„å‡åºæ’åºï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ’åºçš„æ¯”è¾ƒå™¨ï¼Œå½“ç”¨Iteratoréå†TreeMapæ—¶ï¼Œå¾—åˆ°çš„è®°å½•æ˜¯æ’è¿‡åºçš„ã€‚å¦‚æœä½¿ç”¨æ’åºçš„æ˜ å°„ï¼Œå»ºè®®ä½¿ç”¨TreeMapã€‚åœ¨ä½¿ç”¨TreeMapæ—¶ï¼Œkeyå¿…é¡»å®ç°Comparableæ¥å£æˆ–è€…åœ¨æ„é€ TreeMapä¼ å…¥è‡ªå®šä¹‰çš„Comparatorï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡ºjava.lang.ClassCastExceptionç±»å‹çš„å¼‚å¸¸ã€‚ å¯¹äºä¸Šè¿°å››ç§Mapç±»å‹çš„ç±»ï¼Œè¦æ±‚æ˜ å°„ä¸­çš„keyæ˜¯ä¸å¯å˜å¯¹è±¡ã€‚ä¸å¯å˜å¯¹è±¡æ˜¯è¯¥å¯¹è±¡åœ¨åˆ›å»ºåå®ƒçš„å“ˆå¸Œå€¼ä¸ä¼šè¢«æ”¹å˜ã€‚å¦‚æœå¯¹è±¡çš„å“ˆå¸Œå€¼å‘ç”Ÿå˜åŒ–ï¼ŒMapå¯¹è±¡å¾ˆå¯èƒ½å°±å®šä½ä¸åˆ°æ˜ å°„çš„ä½ç½®äº†ã€‚ é€šè¿‡ä¸Šé¢çš„æ¯”è¾ƒï¼Œæˆ‘ä»¬çŸ¥é“äº†HashMapæ˜¯Javaçš„Mapå®¶æ—ä¸­ä¸€ä¸ªæ™®é€šæˆå‘˜ï¼Œé‰´äºå®ƒå¯ä»¥æ»¡è¶³å¤§å¤šæ•°åœºæ™¯çš„ä½¿ç”¨æ¡ä»¶ï¼Œæ‰€ä»¥æ˜¯ä½¿ç”¨é¢‘åº¦æœ€é«˜çš„ä¸€ä¸ªã€‚ä¸‹æ–‡æˆ‘ä»¬ä¸»è¦ç»“åˆæºç ï¼Œä»å­˜å‚¨ç»“æ„ã€å¸¸ç”¨æ–¹æ³•åˆ†æã€æ‰©å®¹ä»¥åŠå®‰å…¨æ€§ç­‰æ–¹é¢æ·±å…¥è®²è§£HashMapçš„å·¥ä½œåŸç†ã€‚ å†…éƒ¨å®ç°ææ¸…æ¥šHashMapï¼Œé¦–å…ˆéœ€è¦çŸ¥é“HashMapæ˜¯ä»€ä¹ˆï¼Œå³å®ƒçš„å­˜å‚¨ç»“æ„-å­—æ®µï¼›å…¶æ¬¡å¼„æ˜ç™½å®ƒèƒ½å¹²ä»€ä¹ˆï¼Œå³å®ƒçš„åŠŸèƒ½å®ç°-æ–¹æ³•ã€‚ä¸‹é¢æˆ‘ä»¬é’ˆå¯¹è¿™ä¸¤ä¸ªæ–¹é¢è¯¦ç»†å±•å¼€è®²è§£ã€‚ å­˜å‚¨ç»“æ„-å­—æ®µä»ç»“æ„å®ç°æ¥è®²ï¼ŒHashMapæ˜¯æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼ˆJDK1.8å¢åŠ äº†çº¢é»‘æ ‘éƒ¨åˆ†ï¼‰å®ç°çš„ï¼Œå¦‚ä¸‹å¦‚æ‰€ç¤ºã€‚ è¿™é‡Œéœ€è¦è®²æ˜ç™½ä¸¤ä¸ªé—®é¢˜ï¼šæ•°æ®åº•å±‚å…·ä½“å­˜å‚¨çš„æ˜¯ä»€ä¹ˆï¼Ÿè¿™æ ·çš„å­˜å‚¨æ–¹å¼æœ‰ä»€ä¹ˆï¼Ÿä¼˜ç‚¹å‘¢ï¼Ÿ (1) ä»æºç å¯çŸ¥ï¼ŒHashMapç±»ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å­—æ®µï¼Œå°±æ˜¯ Node[] tableï¼Œå³å“ˆå¸Œæ¡¶æ•°ç»„ï¼Œæ˜æ˜¾å®ƒæ˜¯ä¸€ä¸ªNodeçš„æ•°ç»„ã€‚æˆ‘ä»¬æ¥çœ‹Node[JDK1.8]æ˜¯ä½•ç‰©ã€‚ 1234567891011121314static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; &#123; final int hash; //ç”¨æ¥å®šä½æ•°ç»„ç´¢å¼•ä½ç½® final K key; V value; Node&lt;K,V&gt; next; //é“¾è¡¨çš„ä¸‹ä¸€ä¸ªnode Node(int hash, K key, V value, Node&lt;K,V&gt; next) &#123; ... &#125; public final K getKey()&#123; ... &#125; public final V getValue() &#123; ... &#125; public final String toString() &#123; ... &#125; public final int hashCode() &#123; ... &#125; public final V setValue(V newValue) &#123; ... &#125; public final boolean equals(Object o) &#123; ... &#125;&#125; Nodeæ˜¯HashMapçš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®ç°äº†Map.Entryæ¥å£ï¼Œæœ¬è´¨æ˜¯å°±æ˜¯ä¸€ä¸ªæ˜ å°„(é”®å€¼å¯¹)ã€‚ä¸Šå›¾ä¸­çš„æ¯ä¸ªé»‘è‰²åœ†ç‚¹å°±æ˜¯ä¸€ä¸ªNodeå¯¹è±¡ã€‚ (2) HashMapå°±æ˜¯ä½¿ç”¨å“ˆå¸Œè¡¨æ¥å­˜å‚¨çš„ã€‚å“ˆå¸Œè¡¨ä¸ºè§£å†³å†²çªï¼Œå¯ä»¥é‡‡ç”¨å¼€æ”¾åœ°å€æ³•å’Œé“¾åœ°å€æ³•ç­‰æ¥è§£å†³é—®é¢˜ï¼ŒJavaä¸­HashMapé‡‡ç”¨äº†é“¾åœ°å€æ³•ã€‚é“¾åœ°å€æ³•ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ•°ç»„åŠ é“¾è¡¨çš„ç»“åˆã€‚åœ¨æ¯ä¸ªæ•°ç»„å…ƒç´ ä¸Šéƒ½ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œå½“æ•°æ®è¢«Hashåï¼Œå¾—åˆ°æ•°ç»„ä¸‹æ ‡ï¼ŒæŠŠæ•°æ®æ”¾åœ¨å¯¹åº”ä¸‹æ ‡å…ƒç´ çš„é“¾è¡¨ä¸Šã€‚ä¾‹å¦‚ç¨‹åºæ‰§è¡Œä¸‹é¢ä»£ç ï¼š 1map.put(\"ç¾å›¢\",\"å°ç¾\"); ç³»ç»Ÿå°†è°ƒç”¨â€ç¾å›¢â€è¿™ä¸ªkeyçš„hashCode()æ–¹æ³•å¾—åˆ°å…¶hashCode å€¼ï¼ˆè¯¥æ–¹æ³•é€‚ç”¨äºæ¯ä¸ªJavaå¯¹è±¡ï¼‰ï¼Œç„¶åå†é€šè¿‡Hashç®—æ³•çš„åä¸¤æ­¥è¿ç®—ï¼ˆé«˜ä½è¿ç®—å’Œå–æ¨¡è¿ç®—ï¼Œä¸‹æ–‡æœ‰ä»‹ç»ï¼‰æ¥å®šä½è¯¥é”®å€¼å¯¹çš„å­˜å‚¨ä½ç½®ï¼Œæœ‰æ—¶ä¸¤ä¸ªkeyä¼šå®šä½åˆ°ç›¸åŒçš„ä½ç½®ï¼Œè¡¨ç¤ºå‘ç”Ÿäº†Hashç¢°æ’ã€‚å½“ç„¶Hashç®—æ³•è®¡ç®—ç»“æœè¶Šåˆ†æ•£å‡åŒ€ï¼ŒHashç¢°æ’çš„æ¦‚ç‡å°±è¶Šå°ï¼Œmapçš„å­˜å–æ•ˆç‡å°±ä¼šè¶Šé«˜ã€‚ å¦‚æœå“ˆå¸Œæ¡¶æ•°ç»„å¾ˆå¤§ï¼Œå³ä½¿è¾ƒå·®çš„Hashç®—æ³•ä¹Ÿä¼šæ¯”è¾ƒåˆ†æ•£ï¼Œå¦‚æœå“ˆå¸Œæ¡¶æ•°ç»„æ•°ç»„å¾ˆå°ï¼Œå³ä½¿å¥½çš„Hashç®—æ³•ä¹Ÿä¼šå‡ºç°è¾ƒå¤šç¢°æ’ï¼Œæ‰€ä»¥å°±éœ€è¦åœ¨ç©ºé—´æˆæœ¬å’Œæ—¶é—´æˆæœ¬ä¹‹é—´æƒè¡¡ï¼Œå…¶å®å°±æ˜¯åœ¨æ ¹æ®å®é™…æƒ…å†µç¡®å®šå“ˆå¸Œæ¡¶æ•°ç»„çš„å¤§å°ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè®¾è®¡å¥½çš„hashç®—æ³•å‡å°‘Hashç¢°æ’ã€‚é‚£ä¹ˆé€šè¿‡ä»€ä¹ˆæ–¹å¼æ¥æ§åˆ¶mapä½¿å¾—Hashç¢°æ’çš„æ¦‚ç‡åˆå°ï¼Œå“ˆå¸Œæ¡¶æ•°ç»„ï¼ˆNode[] tableï¼‰å ç”¨ç©ºé—´åˆå°‘å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯å¥½çš„Hashç®—æ³•å’Œæ‰©å®¹æœºåˆ¶ã€‚ åœ¨ç†è§£Hashå’Œæ‰©å®¹æµç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆäº†è§£ä¸‹HashMapçš„å‡ ä¸ªå­—æ®µã€‚ä»HashMapçš„é»˜è®¤æ„é€ å‡½æ•°æºç å¯çŸ¥ï¼Œæ„é€ å‡½æ•°å°±æ˜¯å¯¹ä¸‹é¢å‡ ä¸ªå­—æ®µè¿›è¡Œåˆå§‹åŒ–ï¼Œæºç å¦‚ä¸‹ï¼š 1234int threshold; // æ‰€èƒ½å®¹çº³çš„key-valueå¯¹æé™ final float loadFactor; // è´Ÿè½½å› å­int modCount; int size; é¦–å…ˆï¼ŒNode[] tableçš„åˆå§‹åŒ–é•¿åº¦length(é»˜è®¤å€¼æ˜¯16)ï¼ŒLoad factorä¸ºè´Ÿè½½å› å­(é»˜è®¤å€¼æ˜¯0.75)ï¼Œthresholdæ˜¯HashMapæ‰€èƒ½å®¹çº³çš„æœ€å¤§æ•°æ®é‡çš„Node(é”®å€¼å¯¹)ä¸ªæ•°ã€‚threshold = length * Load factorã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ•°ç»„å®šä¹‰å¥½é•¿åº¦ä¹‹åï¼Œè´Ÿè½½å› å­è¶Šå¤§ï¼Œæ‰€èƒ½å®¹çº³çš„é”®å€¼å¯¹ä¸ªæ•°è¶Šå¤šã€‚ ç»“åˆè´Ÿè½½å› å­çš„å®šä¹‰å…¬å¼å¯çŸ¥ï¼Œthresholdå°±æ˜¯åœ¨æ­¤Load factorå’Œlength(æ•°ç»„é•¿åº¦)å¯¹åº”ä¸‹å…è®¸çš„æœ€å¤§å…ƒç´ æ•°ç›®ï¼Œè¶…è¿‡è¿™ä¸ªæ•°ç›®å°±é‡æ–°resize(æ‰©å®¹)ï¼Œæ‰©å®¹åçš„HashMapå®¹é‡æ˜¯ä¹‹å‰å®¹é‡çš„ä¸¤å€ã€‚é»˜è®¤çš„è´Ÿè½½å› å­0.75æ˜¯å¯¹ç©ºé—´å’Œæ—¶é—´æ•ˆç‡çš„ä¸€ä¸ªå¹³è¡¡é€‰æ‹©ï¼Œå»ºè®®å¤§å®¶ä¸è¦ä¿®æ”¹ï¼Œé™¤éåœ¨æ—¶é—´å’Œç©ºé—´æ¯”è¾ƒç‰¹æ®Šçš„æƒ…å†µä¸‹ï¼Œå¦‚æœå†…å­˜ç©ºé—´å¾ˆå¤šè€Œåˆå¯¹æ—¶é—´æ•ˆç‡è¦æ±‚å¾ˆé«˜ï¼Œå¯ä»¥é™ä½è´Ÿè½½å› å­Load factorçš„å€¼ï¼›ç›¸åï¼Œå¦‚æœå†…å­˜ç©ºé—´ç´§å¼ è€Œå¯¹æ—¶é—´æ•ˆç‡è¦æ±‚ä¸é«˜ï¼Œå¯ä»¥å¢åŠ è´Ÿè½½å› å­loadFactorçš„å€¼ï¼Œè¿™ä¸ªå€¼å¯ä»¥å¤§äº1ã€‚ sizeè¿™ä¸ªå­—æ®µå…¶å®å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯HashMapä¸­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡ã€‚æ³¨æ„å’Œtableçš„é•¿åº¦lengthã€å®¹çº³æœ€å¤§é”®å€¼å¯¹æ•°é‡thresholdçš„åŒºåˆ«ã€‚è€ŒmodCountå­—æ®µä¸»è¦ç”¨æ¥è®°å½•HashMapå†…éƒ¨ç»“æ„å‘ç”Ÿå˜åŒ–çš„æ¬¡æ•°ï¼Œä¸»è¦ç”¨äºè¿­ä»£çš„å¿«é€Ÿå¤±è´¥ã€‚å¼ºè°ƒä¸€ç‚¹ï¼Œå†…éƒ¨ç»“æ„å‘ç”Ÿå˜åŒ–æŒ‡çš„æ˜¯ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œä¾‹å¦‚putæ–°é”®å€¼å¯¹ï¼Œä½†æ˜¯æŸä¸ªkeyå¯¹åº”çš„valueå€¼è¢«è¦†ç›–ä¸å±äºç»“æ„å˜åŒ–ã€‚ åœ¨HashMapä¸­ï¼Œå“ˆå¸Œæ¡¶æ•°ç»„tableçš„é•¿åº¦lengthå¤§å°å¿…é¡»ä¸º2çš„næ¬¡æ–¹(ä¸€å®šæ˜¯åˆæ•°)ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸è§„çš„è®¾è®¡ï¼Œå¸¸è§„çš„è®¾è®¡æ˜¯æŠŠæ¡¶çš„å¤§å°è®¾è®¡ä¸ºç´ æ•°ã€‚ç›¸å¯¹æ¥è¯´ç´ æ•°å¯¼è‡´å†²çªçš„æ¦‚ç‡è¦å°äºåˆæ•°ï¼Œå…·ä½“è¯æ˜å¯ä»¥å‚è€ƒhttp://blog.csdn.net/liuqiyao_01/article/details/14475159 ï¼ŒHashtableåˆå§‹åŒ–æ¡¶å¤§å°ä¸º11ï¼Œå°±æ˜¯æ¡¶å¤§å°è®¾è®¡ä¸ºç´ æ•°çš„åº”ç”¨ï¼ˆHashtableæ‰©å®¹åä¸èƒ½ä¿è¯è¿˜æ˜¯ç´ æ•°ï¼‰ã€‚HashMapé‡‡ç”¨è¿™ç§éå¸¸è§„è®¾è®¡ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨å–æ¨¡å’Œæ‰©å®¹æ—¶åšä¼˜åŒ–ï¼ŒåŒæ—¶ä¸ºäº†å‡å°‘å†²çªï¼ŒHashMapå®šä½å“ˆå¸Œæ¡¶ç´¢å¼•ä½ç½®æ—¶ï¼Œä¹ŸåŠ å…¥äº†é«˜ä½å‚ä¸è¿ç®—çš„è¿‡ç¨‹ã€‚ è¿™é‡Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³ä½¿è´Ÿè½½å› å­å’ŒHashç®—æ³•è®¾è®¡çš„å†åˆç†ï¼Œä¹Ÿå…ä¸äº†ä¼šå‡ºç°æ‹‰é“¾è¿‡é•¿çš„æƒ…å†µï¼Œä¸€æ—¦å‡ºç°æ‹‰é“¾è¿‡é•¿ï¼Œåˆ™ä¼šä¸¥é‡å½±å“HashMapçš„æ€§èƒ½ã€‚äºæ˜¯ï¼Œåœ¨JDK1.8ç‰ˆæœ¬ä¸­ï¼Œå¯¹æ•°æ®ç»“æ„åšäº†è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œå¼•å…¥äº†çº¢é»‘æ ‘ã€‚è€Œå½“é“¾è¡¨é•¿åº¦å¤ªé•¿ï¼ˆé»˜è®¤è¶…è¿‡8ï¼‰æ—¶ï¼Œé“¾è¡¨å°±è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåˆ©ç”¨çº¢é»‘æ ‘å¿«é€Ÿå¢åˆ æ”¹æŸ¥çš„ç‰¹ç‚¹æé«˜HashMapçš„æ€§èƒ½ï¼Œå…¶ä¸­ä¼šç”¨åˆ°çº¢é»‘æ ‘çš„æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾ç­‰ç®—æ³•ã€‚æœ¬æ–‡ä¸å†å¯¹çº¢é»‘æ ‘å±•å¼€è®¨è®ºï¼Œæƒ³äº†è§£æ›´å¤šçº¢é»‘æ ‘æ•°æ®ç»“æ„çš„å·¥ä½œåŸç†å¯ä»¥å‚è€ƒhttp://blog.csdn.net/v_july_v/article/details/6105630 ã€‚ åŠŸèƒ½å®ç°-æ–¹æ³•HashMapçš„å†…éƒ¨åŠŸèƒ½å®ç°å¾ˆå¤šï¼Œæœ¬æ–‡ä¸»è¦ä»æ ¹æ®keyè·å–å“ˆå¸Œæ¡¶æ•°ç»„ç´¢å¼•ä½ç½®ã€putæ–¹æ³•çš„è¯¦ç»†æ‰§è¡Œã€æ‰©å®¹è¿‡ç¨‹ä¸‰ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„ç‚¹æ·±å…¥å±•å¼€è®²è§£ã€‚ 1. ç¡®å®šå“ˆå¸Œæ¡¶æ•°ç»„ç´¢å¼•ä½ç½®ä¸ç®¡å¢åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾é”®å€¼å¯¹ï¼Œå®šä½åˆ°å“ˆå¸Œæ¡¶æ•°ç»„çš„ä½ç½®éƒ½æ˜¯å¾ˆå…³é”®çš„ç¬¬ä¸€æ­¥ã€‚å‰é¢è¯´è¿‡HashMapçš„æ•°æ®ç»“æ„æ˜¯æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆï¼Œæ‰€ä»¥æˆ‘ä»¬å½“ç„¶å¸Œæœ›è¿™ä¸ªHashMapé‡Œé¢çš„å…ƒç´ ä½ç½®å°½é‡åˆ†å¸ƒå‡åŒ€äº›ï¼Œå°½é‡ä½¿å¾—æ¯ä¸ªä½ç½®ä¸Šçš„å…ƒç´ æ•°é‡åªæœ‰ä¸€ä¸ªï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ç”¨hashç®—æ³•æ±‚å¾—è¿™ä¸ªä½ç½®çš„æ—¶å€™ï¼Œé©¬ä¸Šå°±å¯ä»¥çŸ¥é“å¯¹åº”ä½ç½®çš„å…ƒç´ å°±æ˜¯æˆ‘ä»¬è¦çš„ï¼Œä¸ç”¨éå†é“¾è¡¨ï¼Œå¤§å¤§ä¼˜åŒ–äº†æŸ¥è¯¢çš„æ•ˆç‡ã€‚HashMapå®šä½æ•°ç»„ç´¢å¼•ä½ç½®ï¼Œç›´æ¥å†³å®šäº†hashæ–¹æ³•çš„ç¦»æ•£æ€§èƒ½ã€‚å…ˆçœ‹çœ‹æºç çš„å®ç°(æ–¹æ³•ä¸€+æ–¹æ³•äºŒ): 1234567891011æ–¹æ³•ä¸€ï¼šstatic final int hash(Object key) &#123; //jdk1.8 &amp; jdk1.7 int h; // h = key.hashCode() ä¸ºç¬¬ä¸€æ­¥ å–hashCodeå€¼ // h ^ (h &gt;&gt;&gt; 16) ä¸ºç¬¬äºŒæ­¥ é«˜ä½å‚ä¸è¿ç®— return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);&#125;æ–¹æ³•äºŒï¼šstatic int indexFor(int h, int length) &#123; //jdk1.7çš„æºç ï¼Œjdk1.8æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯å®ç°åŸç†ä¸€æ ·çš„ return h &amp; (length-1); //ç¬¬ä¸‰æ­¥ å–æ¨¡è¿ç®—&#125; è¿™é‡Œçš„Hashç®—æ³•æœ¬è´¨ä¸Šå°±æ˜¯ä¸‰æ­¥ï¼šå–keyçš„hashCodeå€¼ã€é«˜ä½è¿ç®—ã€å–æ¨¡è¿ç®—ã€‚ å¯¹äºä»»æ„ç»™å®šçš„å¯¹è±¡ï¼Œåªè¦å®ƒçš„hashCode()è¿”å›å€¼ç›¸åŒï¼Œé‚£ä¹ˆç¨‹åºè°ƒç”¨æ–¹æ³•ä¸€æ‰€è®¡ç®—å¾—åˆ°çš„Hashç å€¼æ€»æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯æŠŠhashå€¼å¯¹æ•°ç»„é•¿åº¦å–æ¨¡è¿ç®—ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå…ƒç´ çš„åˆ†å¸ƒç›¸å¯¹æ¥è¯´æ˜¯æ¯”è¾ƒå‡åŒ€çš„ã€‚ä½†æ˜¯ï¼Œæ¨¡è¿ç®—çš„æ¶ˆè€—è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œåœ¨HashMapä¸­æ˜¯è¿™æ ·åšçš„ï¼šè°ƒç”¨æ–¹æ³•äºŒæ¥è®¡ç®—è¯¥å¯¹è±¡åº”è¯¥ä¿å­˜åœ¨tableæ•°ç»„çš„å“ªä¸ªç´¢å¼•å¤„ã€‚ è¿™ä¸ªæ–¹æ³•éå¸¸å·§å¦™ï¼Œå®ƒé€šè¿‡h &amp; (table.length -1)æ¥å¾—åˆ°è¯¥å¯¹è±¡çš„ä¿å­˜ä½ï¼Œè€ŒHashMapåº•å±‚æ•°ç»„çš„é•¿åº¦æ€»æ˜¯2çš„næ¬¡æ–¹ï¼Œè¿™æ˜¯HashMapåœ¨é€Ÿåº¦ä¸Šçš„ä¼˜åŒ–ã€‚å½“lengthæ€»æ˜¯2çš„næ¬¡æ–¹æ—¶ï¼Œh&amp; (length-1)è¿ç®—ç­‰ä»·äºå¯¹lengthå–æ¨¡ï¼Œä¹Ÿå°±æ˜¯h%lengthï¼Œä½†æ˜¯&amp;æ¯”%å…·æœ‰æ›´é«˜çš„æ•ˆç‡ã€‚ åœ¨JDK1.8çš„å®ç°ä¸­ï¼Œä¼˜åŒ–äº†é«˜ä½è¿ç®—çš„ç®—æ³•ï¼Œé€šè¿‡hashCode()çš„é«˜16ä½å¼‚æˆ–ä½16ä½å®ç°çš„ï¼š(h = k.hashCode()) ^ (h &gt;&gt;&gt; 16)ï¼Œä¸»è¦æ˜¯ä»é€Ÿåº¦ã€åŠŸæ•ˆã€è´¨é‡æ¥è€ƒè™‘çš„ï¼Œè¿™ä¹ˆåšå¯ä»¥åœ¨æ•°ç»„tableçš„lengthæ¯”è¾ƒå°çš„æ—¶å€™ï¼Œä¹Ÿèƒ½ä¿è¯è€ƒè™‘åˆ°é«˜ä½Bitéƒ½å‚ä¸åˆ°Hashçš„è®¡ç®—ä¸­ï¼ŒåŒæ—¶ä¸ä¼šæœ‰å¤ªå¤§çš„å¼€é”€ã€‚ ä¸‹é¢ä¸¾ä¾‹è¯´æ˜ä¸‹ï¼Œnä¸ºtableçš„é•¿åº¦ã€‚ 2. åˆ†æHashMapçš„putæ–¹æ³•HashMapçš„putæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹å¯ä»¥é€šè¿‡ä¸‹å›¾æ¥ç†è§£ï¼Œè‡ªå·±æœ‰å…´è¶£å¯ä»¥å»å¯¹æ¯”æºç æ›´æ¸…æ¥šåœ°ç ”ç©¶å­¦ä¹ ã€‚ â‘ . åˆ¤æ–­é”®å€¼å¯¹æ•°ç»„table[i]æ˜¯å¦ä¸ºç©ºæˆ–ä¸ºnullï¼Œå¦åˆ™æ‰§è¡Œresize()è¿›è¡Œæ‰©å®¹ï¼› â‘¡. æ ¹æ®é”®å€¼keyè®¡ç®—hashå€¼å¾—åˆ°æ’å…¥çš„æ•°ç»„ç´¢å¼•iï¼Œå¦‚æœtable[i]==nullï¼Œç›´æ¥æ–°å»ºèŠ‚ç‚¹æ·»åŠ ï¼Œè½¬å‘â‘¥ï¼Œå¦‚æœtable[i]ä¸ä¸ºç©ºï¼Œè½¬å‘â‘¢ï¼› â‘¢. åˆ¤æ–­table[i]çš„é¦–ä¸ªå…ƒç´ æ˜¯å¦å’Œkeyä¸€æ ·ï¼Œå¦‚æœç›¸åŒç›´æ¥è¦†ç›–valueï¼Œå¦åˆ™è½¬å‘â‘£ï¼Œè¿™é‡Œçš„ç›¸åŒæŒ‡çš„æ˜¯hashCodeä»¥åŠequalsï¼› â‘£. åˆ¤æ–­table[i] æ˜¯å¦ä¸ºtreeNodeï¼Œå³table[i] æ˜¯å¦æ˜¯çº¢é»‘æ ‘ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥é”®å€¼å¯¹ï¼Œå¦åˆ™è½¬å‘â‘¤ï¼› â‘¤. éå†table[i]ï¼Œåˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº8ï¼Œå¤§äº8çš„è¯æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¦åˆ™è¿›è¡Œé“¾è¡¨çš„æ’å…¥æ“ä½œï¼›éå†è¿‡ç¨‹ä¸­è‹¥å‘ç°keyå·²ç»å­˜åœ¨ç›´æ¥è¦†ç›–valueå³å¯ï¼› â‘¥. æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡sizeæ˜¯å¦è¶…å¤šäº†æœ€å¤§å®¹é‡thresholdï¼Œå¦‚æœè¶…è¿‡ï¼Œè¿›è¡Œæ‰©å®¹ã€‚ JDK1.8HashMapçš„putæ–¹æ³•æºç å¦‚ä¸‹: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657 1 public V put(K key, V value) &#123; 2 // å¯¹keyçš„hashCode()åšhash 3 return putVal(hash(key), key, value, false, true); 4 &#125; 5 6 final V putVal(int hash, K key, V value, boolean onlyIfAbsent, 7 boolean evict) &#123; 8 Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; 9 // æ­¥éª¤â‘ ï¼štabä¸ºç©ºåˆ™åˆ›å»º10 if ((tab = table) == null || (n = tab.length) == 0)11 n = (tab = resize()).length;12 // æ­¥éª¤â‘¡ï¼šè®¡ç®—indexï¼Œå¹¶å¯¹nullåšå¤„ç† 13 if ((p = tab[i = (n - 1) &amp; hash]) == null) 14 tab[i] = newNode(hash, key, value, null);15 else &#123;16 Node&lt;K,V&gt; e; K k;17 // æ­¥éª¤â‘¢ï¼šèŠ‚ç‚¹keyå­˜åœ¨ï¼Œç›´æ¥è¦†ç›–value18 if (p.hash == hash &amp;&amp;19 ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))20 e = p;21 // æ­¥éª¤â‘£ï¼šåˆ¤æ–­è¯¥é“¾ä¸ºçº¢é»‘æ ‘22 else if (p instanceof TreeNode)23 e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);24 // æ­¥éª¤â‘¤ï¼šè¯¥é“¾ä¸ºé“¾è¡¨25 else &#123;26 for (int binCount = 0; ; ++binCount) &#123;27 if ((e = p.next) == null) &#123;28 p.next = newNode(hash, key,value,null); //é“¾è¡¨é•¿åº¦å¤§äº8è½¬æ¢ä¸ºçº¢é»‘æ ‘è¿›è¡Œå¤„ç†29 if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st 30 treeifyBin(tab, hash);31 break;32 &#125; // keyå·²ç»å­˜åœ¨ç›´æ¥è¦†ç›–value33 if (e.hash == hash &amp;&amp;34 ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) 35 break;36 p = e;37 &#125;38 &#125;39 40 if (e != null) &#123; // existing mapping for key41 V oldValue = e.value;42 if (!onlyIfAbsent || oldValue == null)43 e.value = value;44 afterNodeAccess(e);45 return oldValue;46 &#125;47 &#125;48 ++modCount;49 // æ­¥éª¤â‘¥ï¼šè¶…è¿‡æœ€å¤§å®¹é‡ å°±æ‰©å®¹50 if (++size &gt; threshold)51 resize();52 afterNodeInsertion(evict);53 return null;54 &#125; 3. æ‰©å®¹æœºåˆ¶æ‰©å®¹(resize)å°±æ˜¯é‡æ–°è®¡ç®—å®¹é‡ï¼Œå‘HashMapå¯¹è±¡é‡Œä¸åœçš„æ·»åŠ å…ƒç´ ï¼Œè€ŒHashMapå¯¹è±¡å†…éƒ¨çš„æ•°ç»„æ— æ³•è£…è½½æ›´å¤šçš„å…ƒç´ æ—¶ï¼Œå¯¹è±¡å°±éœ€è¦æ‰©å¤§æ•°ç»„çš„é•¿åº¦ï¼Œä»¥ä¾¿èƒ½è£…å…¥æ›´å¤šçš„å…ƒç´ ã€‚å½“ç„¶Javaé‡Œçš„æ•°ç»„æ˜¯æ— æ³•è‡ªåŠ¨æ‰©å®¹çš„ï¼Œæ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªæ–°çš„æ•°ç»„ä»£æ›¿å·²æœ‰çš„å®¹é‡å°çš„æ•°ç»„ï¼Œå°±åƒæˆ‘ä»¬ç”¨ä¸€ä¸ªå°æ¡¶è£…æ°´ï¼Œå¦‚æœæƒ³è£…æ›´å¤šçš„æ°´ï¼Œå°±å¾—æ¢å¤§æ°´æ¡¶ã€‚ æˆ‘ä»¬åˆ†æä¸‹resizeçš„æºç ï¼Œé‰´äºJDK1.8èå…¥äº†çº¢é»‘æ ‘ï¼Œè¾ƒå¤æ‚ï¼Œä¸ºäº†ä¾¿äºç†è§£æˆ‘ä»¬ä»ç„¶ä½¿ç”¨JDK1.7çš„ä»£ç ï¼Œå¥½ç†è§£ä¸€äº›ï¼Œæœ¬è´¨ä¸ŠåŒºåˆ«ä¸å¤§ï¼Œå…·ä½“åŒºåˆ«åæ–‡å†è¯´ã€‚ 12345678910111213 1 void resize(int newCapacity) &#123; //ä¼ å…¥æ–°çš„å®¹é‡ 2 Entry[] oldTable = table; //å¼•ç”¨æ‰©å®¹å‰çš„Entryæ•°ç»„ 3 int oldCapacity = oldTable.length; 4 if (oldCapacity == MAXIMUM_CAPACITY) &#123; //æ‰©å®¹å‰çš„æ•°ç»„å¤§å°å¦‚æœå·²ç»è¾¾åˆ°æœ€å¤§(2^30)äº† 5 threshold = Integer.MAX_VALUE; //ä¿®æ”¹é˜ˆå€¼ä¸ºintçš„æœ€å¤§å€¼(2^31-1)ï¼Œè¿™æ ·ä»¥åå°±ä¸ä¼šæ‰©å®¹äº† 6 return; 7 &#125; 8 9 Entry[] newTable = new Entry[newCapacity]; //åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„Entryæ•°ç»„10 transfer(newTable); //ï¼ï¼å°†æ•°æ®è½¬ç§»åˆ°æ–°çš„Entryæ•°ç»„é‡Œ11 table = newTable; //HashMapçš„tableå±æ€§å¼•ç”¨æ–°çš„Entryæ•°ç»„12 threshold = (int)(newCapacity * loadFactor);//ä¿®æ”¹é˜ˆå€¼13 &#125; è¿™é‡Œå°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå®¹é‡æ›´å¤§çš„æ•°ç»„æ¥ä»£æ›¿å·²æœ‰çš„å®¹é‡å°çš„æ•°ç»„ï¼Œtransfer()æ–¹æ³•å°†åŸæœ‰Entryæ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°çš„Entryæ•°ç»„é‡Œã€‚ 1234567891011121314151617 1 void transfer(Entry[] newTable) &#123; 2 Entry[] src = table; //srcå¼•ç”¨äº†æ—§çš„Entryæ•°ç»„ 3 int newCapacity = newTable.length; 4 for (int j = 0; j &lt; src.length; j++) &#123; //éå†æ—§çš„Entryæ•°ç»„ 5 Entry&lt;K,V&gt; e = src[j]; //å–å¾—æ—§Entryæ•°ç»„çš„æ¯ä¸ªå…ƒç´  6 if (e != null) &#123; 7 src[j] = null;//é‡Šæ”¾æ—§Entryæ•°ç»„çš„å¯¹è±¡å¼•ç”¨ï¼ˆforå¾ªç¯åï¼Œæ—§çš„Entryæ•°ç»„ä¸å†å¼•ç”¨ä»»ä½•å¯¹è±¡ï¼‰ 8 do &#123; 9 Entry&lt;K,V&gt; next = e.next;10 int i = indexFor(e.hash, newCapacity); //ï¼ï¼é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®11 e.next = newTable[i]; //æ ‡è®°[1]12 newTable[i] = e; //å°†å…ƒç´ æ”¾åœ¨æ•°ç»„ä¸Š13 e = next; //è®¿é—®ä¸‹ä¸€ä¸ªEntryé“¾ä¸Šçš„å…ƒç´ 14 &#125; while (e != null);15 &#125;16 &#125;17 &#125; newTable[i]çš„å¼•ç”¨èµ‹ç»™äº†e.nextï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨äº†å•é“¾è¡¨çš„å¤´æ’å…¥æ–¹å¼ï¼ŒåŒä¸€ä½ç½®ä¸Šæ–°å…ƒç´ æ€»ä¼šè¢«æ”¾åœ¨é“¾è¡¨çš„å¤´éƒ¨ä½ç½®ï¼›è¿™æ ·å…ˆæ”¾åœ¨ä¸€ä¸ªç´¢å¼•ä¸Šçš„å…ƒç´ ç»ˆä¼šè¢«æ”¾åˆ°Entryé“¾çš„å°¾éƒ¨(å¦‚æœå‘ç”Ÿäº†hashå†²çªçš„è¯ï¼‰ï¼Œè¿™ä¸€ç‚¹å’ŒJdk1.8æœ‰åŒºåˆ«ï¼Œä¸‹æ–‡è¯¦è§£ã€‚åœ¨æ—§æ•°ç»„ä¸­åŒä¸€æ¡Entryé“¾ä¸Šçš„å…ƒç´ ï¼Œé€šè¿‡é‡æ–°è®¡ç®—ç´¢å¼•ä½ç½®åï¼Œæœ‰å¯èƒ½è¢«æ”¾åˆ°äº†æ–°æ•°ç»„çš„ä¸åŒä½ç½®ä¸Šã€‚ ä¸‹é¢ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸‹æ‰©å®¹è¿‡ç¨‹ã€‚å‡è®¾äº†æˆ‘ä»¬çš„hashç®—æ³•å°±æ˜¯ç®€å•çš„ç”¨key mod ä¸€ä¸‹è¡¨çš„å¤§å°ï¼ˆä¹Ÿå°±æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ã€‚å…¶ä¸­çš„å“ˆå¸Œæ¡¶æ•°ç»„tableçš„size=2ï¼Œ æ‰€ä»¥key = 3ã€7ã€5ï¼Œputé¡ºåºä¾æ¬¡ä¸º 5ã€7ã€3ã€‚åœ¨mod 2ä»¥åéƒ½å†²çªåœ¨table[1]è¿™é‡Œäº†ã€‚è¿™é‡Œå‡è®¾è´Ÿè½½å› å­ loadFactor=1ï¼Œå³å½“é”®å€¼å¯¹çš„å®é™…å¤§å°size å¤§äº tableçš„å®é™…å¤§å°æ—¶è¿›è¡Œæ‰©å®¹ã€‚æ¥ä¸‹æ¥çš„ä¸‰ä¸ªæ­¥éª¤æ˜¯å“ˆå¸Œæ¡¶æ•°ç»„ resizeæˆ4ï¼Œç„¶åæ‰€æœ‰çš„Nodeé‡æ–°rehashçš„è¿‡ç¨‹ã€‚ ä¸‹é¢æˆ‘ä»¬è®²è§£ä¸‹JDK1.8åšäº†å“ªäº›ä¼˜åŒ–ã€‚ç»è¿‡è§‚æµ‹å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯2æ¬¡å¹‚çš„æ‰©å±•(æŒ‡é•¿åº¦æ‰©ä¸ºåŸæ¥2å€)ï¼Œæ‰€ä»¥ï¼Œå…ƒç´ çš„ä½ç½®è¦ä¹ˆæ˜¯åœ¨åŸä½ç½®ï¼Œè¦ä¹ˆæ˜¯åœ¨åŸä½ç½®å†ç§»åŠ¨2æ¬¡å¹‚çš„ä½ç½®ã€‚çœ‹ä¸‹å›¾å¯ä»¥æ˜ç™½è¿™å¥è¯çš„æ„æ€ï¼Œnä¸ºtableçš„é•¿åº¦ï¼Œå›¾ï¼ˆaï¼‰è¡¨ç¤ºæ‰©å®¹å‰çš„key1å’Œkey2ä¸¤ç§keyç¡®å®šç´¢å¼•ä½ç½®çš„ç¤ºä¾‹ï¼Œå›¾ï¼ˆbï¼‰è¡¨ç¤ºæ‰©å®¹åkey1å’Œkey2ä¸¤ç§keyç¡®å®šç´¢å¼•ä½ç½®çš„ç¤ºä¾‹ï¼Œå…¶ä¸­hash1æ˜¯key1å¯¹åº”çš„å“ˆå¸Œä¸é«˜ä½è¿ç®—ç»“æœã€‚ å…ƒç´ åœ¨é‡æ–°è®¡ç®—hashä¹‹åï¼Œå› ä¸ºnå˜ä¸º2å€ï¼Œé‚£ä¹ˆn-1çš„maskèŒƒå›´åœ¨é«˜ä½å¤š1bit(çº¢è‰²)ï¼Œå› æ­¤æ–°çš„indexå°±ä¼šå‘ç”Ÿè¿™æ ·çš„å˜åŒ–ï¼š å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ‰©å……HashMapçš„æ—¶å€™ï¼Œä¸éœ€è¦åƒJDK1.7çš„å®ç°é‚£æ ·é‡æ–°è®¡ç®—hashï¼Œåªéœ€è¦çœ‹çœ‹åŸæ¥çš„hashå€¼æ–°å¢çš„é‚£ä¸ªbitæ˜¯1è¿˜æ˜¯0å°±å¥½äº†ï¼Œæ˜¯0çš„è¯ç´¢å¼•æ²¡å˜ï¼Œæ˜¯1çš„è¯ç´¢å¼•å˜æˆâ€œåŸç´¢å¼•+oldCapâ€ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹å›¾ä¸º16æ‰©å……ä¸º32çš„resizeç¤ºæ„å›¾ï¼š è¿™ä¸ªè®¾è®¡ç¡®å®éå¸¸çš„å·§å¦™ï¼Œæ—¢çœå»äº†é‡æ–°è®¡ç®—hashå€¼çš„æ—¶é—´ï¼Œè€Œä¸”åŒæ—¶ï¼Œç”±äºæ–°å¢çš„1bitæ˜¯0è¿˜æ˜¯1å¯ä»¥è®¤ä¸ºæ˜¯éšæœºçš„ï¼Œå› æ­¤resizeçš„è¿‡ç¨‹ï¼Œå‡åŒ€çš„æŠŠä¹‹å‰çš„å†²çªçš„èŠ‚ç‚¹åˆ†æ•£åˆ°æ–°çš„bucketäº†ã€‚è¿™ä¸€å—å°±æ˜¯JDK1.8æ–°å¢çš„ä¼˜åŒ–ç‚¹ã€‚æœ‰ä¸€ç‚¹æ³¨æ„åŒºåˆ«ï¼ŒJDK1.7ä¸­rehashçš„æ—¶å€™ï¼Œæ—§é“¾è¡¨è¿ç§»æ–°é“¾è¡¨çš„æ—¶å€™ï¼Œå¦‚æœåœ¨æ–°è¡¨çš„æ•°ç»„ç´¢å¼•ä½ç½®ç›¸åŒï¼Œåˆ™é“¾è¡¨å…ƒç´ ä¼šå€’ç½®ï¼Œä½†æ˜¯ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒJDK1.8ä¸ä¼šå€’ç½®ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ç ”ç©¶ä¸‹JDK1.8çš„resizeæºç ï¼Œå†™çš„å¾ˆèµï¼Œå¦‚ä¸‹: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182 1 final Node&lt;K,V&gt;[] resize() &#123; 2 Node&lt;K,V&gt;[] oldTab = table; 3 int oldCap = (oldTab == null) ? 0 : oldTab.length; 4 int oldThr = threshold; 5 int newCap, newThr = 0; 6 if (oldCap &gt; 0) &#123; 7 // è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§ 8 if (oldCap &gt;= MAXIMUM_CAPACITY) &#123; 9 threshold = Integer.MAX_VALUE;10 return oldTab;11 &#125;12 // æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€13 else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;14 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)15 newThr = oldThr &lt;&lt; 1; // double threshold16 &#125;17 else if (oldThr &gt; 0) // initial capacity was placed in threshold18 newCap = oldThr;19 else &#123; // zero initial threshold signifies using defaults20 newCap = DEFAULT_INITIAL_CAPACITY;21 newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);22 &#125;23 // è®¡ç®—æ–°çš„resizeä¸Šé™24 if (newThr == 0) &#123;25 26 float ft = (float)newCap * loadFactor;27 newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?28 (int)ft : Integer.MAX_VALUE);29 &#125;30 threshold = newThr;31 @SuppressWarnings(&#123;\"rawtypes\"ï¼Œ\"unchecked\"&#125;)32 Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap];33 table = newTab;34 if (oldTab != null) &#123;35 // æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­36 for (int j = 0; j &lt; oldCap; ++j) &#123;37 Node&lt;K,V&gt; e;38 if ((e = oldTab[j]) != null) &#123;39 oldTab[j] = null;40 if (e.next == null)41 newTab[e.hash &amp; (newCap - 1)] = e;42 else if (e instanceof TreeNode)43 ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);44 else &#123; // é“¾è¡¨ä¼˜åŒ–é‡hashçš„ä»£ç å—45 Node&lt;K,V&gt; loHead = null, loTail = null;46 Node&lt;K,V&gt; hiHead = null, hiTail = null;47 Node&lt;K,V&gt; next;48 do &#123;49 next = e.next;50 // åŸç´¢å¼•51 if ((e.hash &amp; oldCap) == 0) &#123;52 if (loTail == null)53 loHead = e;54 else55 loTail.next = e;56 loTail = e;57 &#125;58 // åŸç´¢å¼•+oldCap59 else &#123;60 if (hiTail == null)61 hiHead = e;62 else63 hiTail.next = e;64 hiTail = e;65 &#125;66 &#125; while ((e = next) != null);67 // åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ68 if (loTail != null) &#123;69 loTail.next = null;70 newTab[j] = loHead;71 &#125;72 // åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ73 if (hiTail != null) &#123;74 hiTail.next = null;75 newTab[j + oldCap] = hiHead;76 &#125;77 &#125;78 &#125;79 &#125;80 &#125;81 return newTab;82 &#125; çº¿ç¨‹å®‰å…¨æ€§åœ¨å¤šçº¿ç¨‹ä½¿ç”¨åœºæ™¯ä¸­ï¼Œåº”è¯¥å°½é‡é¿å…ä½¿ç”¨çº¿ç¨‹ä¸å®‰å…¨çš„HashMapï¼Œè€Œä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„ConcurrentHashMapã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè¯´HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸‹é¢ä¸¾ä¾‹å­è¯´æ˜åœ¨å¹¶å‘çš„å¤šçº¿ç¨‹ä½¿ç”¨åœºæ™¯ä¸­ä½¿ç”¨HashMapå¯èƒ½é€ æˆæ­»å¾ªç¯ã€‚ä»£ç ä¾‹å­å¦‚ä¸‹(ä¾¿äºç†è§£ï¼Œä»ç„¶ä½¿ç”¨JDK1.7çš„ç¯å¢ƒ)ï¼š 1234567891011121314151617181920public class HashMapInfiniteLoop &#123; private static HashMap&lt;Integer,String&gt; map = new HashMap&lt;Integer,String&gt;(2, 0.75f); public static void main(String[] args) &#123; map.put(5, \"C\"); new Thread(\"Thread1\") &#123; public void run() &#123; map.put(7, \"B\"); System.out.println(map); &#125;; &#125;.start(); new Thread(\"Thread2\") &#123; public void run() &#123; map.put(3, \"A); System.out.println(map); &#125;; &#125;.start(); &#125; &#125; å…¶ä¸­ï¼Œmapåˆå§‹åŒ–ä¸ºä¸€ä¸ªé•¿åº¦ä¸º2çš„æ•°ç»„ï¼ŒloadFactor=0.75ï¼Œthreshold=2*0.75=1ï¼Œä¹Ÿå°±æ˜¯è¯´å½“putç¬¬äºŒä¸ªkeyçš„æ—¶å€™ï¼Œmapå°±éœ€è¦è¿›è¡Œresizeã€‚ é€šè¿‡è®¾ç½®æ–­ç‚¹è®©çº¿ç¨‹1å’Œçº¿ç¨‹2åŒæ—¶debugåˆ°transferæ–¹æ³•(3.3å°èŠ‚ä»£ç å—)çš„é¦–è¡Œã€‚æ³¨æ„æ­¤æ—¶ä¸¤ä¸ªçº¿ç¨‹å·²ç»æˆåŠŸæ·»åŠ æ•°æ®ã€‚æ”¾å¼€thread1çš„æ–­ç‚¹è‡³transferæ–¹æ³•çš„â€œEntry next = e.next;â€ è¿™ä¸€è¡Œï¼›ç„¶åæ”¾å¼€çº¿ç¨‹2çš„çš„æ–­ç‚¹ï¼Œè®©çº¿ç¨‹2è¿›è¡Œresizeã€‚ç»“æœå¦‚ä¸‹å›¾ã€‚ æ³¨æ„ï¼ŒThread1çš„ e æŒ‡å‘äº†key(3)ï¼Œè€ŒnextæŒ‡å‘äº†key(7)ï¼Œå…¶åœ¨çº¿ç¨‹äºŒrehashåï¼ŒæŒ‡å‘äº†çº¿ç¨‹äºŒé‡ç»„åçš„é“¾è¡¨ã€‚ çº¿ç¨‹ä¸€è¢«è°ƒåº¦å›æ¥æ‰§è¡Œï¼Œå…ˆæ˜¯æ‰§è¡Œ newTalbe[i] = eï¼Œ ç„¶åæ˜¯e = nextï¼Œå¯¼è‡´äº†eæŒ‡å‘äº†key(7)ï¼Œè€Œä¸‹ä¸€æ¬¡å¾ªç¯çš„next = e.nextå¯¼è‡´äº†nextæŒ‡å‘äº†key(3)ã€‚ e.next = newTable[i] å¯¼è‡´ key(3).next æŒ‡å‘äº† key(7)ã€‚æ³¨æ„ï¼šæ­¤æ—¶çš„key(7).next å·²ç»æŒ‡å‘äº†key(3)ï¼Œ ç¯å½¢é“¾è¡¨å°±è¿™æ ·å‡ºç°äº†ã€‚ äºæ˜¯ï¼Œå½“æˆ‘ä»¬ç”¨çº¿ç¨‹ä¸€è°ƒç”¨map.get(11)æ—¶ï¼Œæ‚²å‰§å°±å‡ºç°äº†â€”â€”Infinite Loopã€‚ JDK1.8ä¸JDK1.7çš„æ€§èƒ½å¯¹æ¯”HashMapä¸­ï¼Œå¦‚æœkeyç»è¿‡hashç®—æ³•å¾—å‡ºçš„æ•°ç»„ç´¢å¼•ä½ç½®å…¨éƒ¨ä¸ç›¸åŒï¼Œå³Hashç®—æ³•éå¸¸å¥½ï¼Œé‚£æ ·çš„è¯ï¼ŒgetKeyæ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯O(1)ï¼Œå¦‚æœHashç®—æ³•æŠ€æœ¯çš„ç»“æœç¢°æ’éå¸¸å¤šï¼Œå‡å¦‚Hashç®—æå…¶å·®ï¼Œæ‰€æœ‰çš„Hashç®—æ³•ç»“æœå¾—å‡ºçš„ç´¢å¼•ä½ç½®ä¸€æ ·ï¼Œé‚£æ ·æ‰€æœ‰çš„é”®å€¼å¯¹éƒ½é›†ä¸­åˆ°ä¸€ä¸ªæ¡¶ä¸­ï¼Œæˆ–è€…åœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ï¼Œæˆ–è€…åœ¨ä¸€ä¸ªçº¢é»‘æ ‘ä¸­ï¼Œæ—¶é—´å¤æ‚åº¦åˆ†åˆ«ä¸ºO(n)å’ŒO(lgn)ã€‚ é‰´äºJDK1.8åšäº†å¤šæ–¹é¢çš„ä¼˜åŒ–ï¼Œæ€»ä½“æ€§èƒ½ä¼˜äºJDK1.7ï¼Œä¸‹é¢æˆ‘ä»¬ä»ä¸¤ä¸ªæ–¹é¢ç”¨ä¾‹å­è¯æ˜è¿™ä¸€ç‚¹ã€‚ Hashè¾ƒå‡åŒ€çš„æƒ…å†µä¸ºäº†ä¾¿äºæµ‹è¯•ï¼Œæˆ‘ä»¬å…ˆå†™ä¸€ä¸ªç±»Keyï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627class Key implements Comparable&lt;Key&gt; &#123; private final int value; Key(int value) &#123; this.value = value; &#125; @Override public int compareTo(Key o) &#123; return Integer.compare(this.value, o.value); &#125; @Override public boolean equals(Object o) &#123; if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; Key key = (Key) o; return value == key.value; &#125; @Override public int hashCode() &#123; return value; &#125;&#125; è¿™ä¸ªç±»å¤å†™äº†equalsæ–¹æ³•ï¼Œå¹¶ä¸”æä¾›äº†ç›¸å½“å¥½çš„hashCodeå‡½æ•°ï¼Œä»»ä½•ä¸€ä¸ªå€¼çš„hashCodeéƒ½ä¸ä¼šç›¸åŒï¼Œå› ä¸ºç›´æ¥ä½¿ç”¨valueå½“åšhashcodeã€‚ä¸ºäº†é¿å…é¢‘ç¹çš„GCï¼Œæˆ‘å°†ä¸å˜çš„Keyå®ä¾‹ç¼“å­˜äº†èµ·æ¥ï¼Œè€Œä¸æ˜¯ä¸€éä¸€éçš„åˆ›å»ºå®ƒä»¬ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415public class Keys &#123; public static final int MAX_KEY = 10_000_000; private static final Key[] KEYS_CACHE = new Key[MAX_KEY]; static &#123; for (int i = 0; i &lt; MAX_KEY; ++i) &#123; KEYS_CACHE[i] = new Key(i); &#125; &#125; public static Key of(int value) &#123; return KEYS_CACHE[value]; &#125;&#125; ç°åœ¨å¼€å§‹æˆ‘ä»¬çš„è¯•éªŒï¼Œæµ‹è¯•éœ€è¦åšçš„ä»…ä»…æ˜¯ï¼Œåˆ›å»ºä¸åŒsizeçš„HashMapï¼ˆ1ã€10ã€100ã€â€¦â€¦10000000ï¼‰ï¼Œå±è”½äº†æ‰©å®¹çš„æƒ…å†µï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920static void test(int mapSize) &#123; HashMap&lt;Key, Integer&gt; map = new HashMap&lt;Key,Integer&gt;(mapSize); for (int i = 0; i &lt; mapSize; ++i) &#123; map.put(Keys.of(i), i); &#125; long beginTime = System.nanoTime(); //è·å–çº³ç§’ for (int i = 0; i &lt; mapSize; i++) &#123; map.get(Keys.of(i)); &#125; long endTime = System.nanoTime(); System.out.println(endTime - beginTime); &#125; public static void main(String[] args) &#123; for(int i=10;i&lt;= 1000 0000;i*= 10)&#123; test(i); &#125; &#125; åœ¨æµ‹è¯•ä¸­ä¼šæŸ¥æ‰¾ä¸åŒçš„å€¼ï¼Œç„¶ååº¦é‡èŠ±è´¹çš„æ—¶é—´ï¼Œä¸ºäº†è®¡ç®—getKeyçš„å¹³å‡æ—¶é—´ï¼Œæˆ‘ä»¬éå†æ‰€æœ‰çš„getæ–¹æ³•ï¼Œè®¡ç®—æ€»çš„æ—¶é—´ï¼Œé™¤ä»¥keyçš„æ•°é‡ï¼Œè®¡ç®—ä¸€ä¸ªå¹³å‡å€¼ï¼Œä¸»è¦ç”¨æ¥æ¯”è¾ƒï¼Œç»å¯¹å€¼å¯èƒ½ä¼šå—å¾ˆå¤šç¯å¢ƒå› ç´ çš„å½±å“ã€‚ç»“æœå¦‚ä¸‹ï¼š é€šè¿‡è§‚æµ‹æµ‹è¯•ç»“æœå¯çŸ¥ï¼ŒJDK1.8çš„æ€§èƒ½è¦é«˜äºJDK1.7 15%ä»¥ä¸Šï¼Œåœ¨æŸäº›sizeçš„åŒºåŸŸä¸Šï¼Œç”šè‡³é«˜äº100%ã€‚ç”±äºHashç®—æ³•è¾ƒå‡åŒ€ï¼ŒJDK1.8å¼•å…¥çš„çº¢é»‘æ ‘æ•ˆæœä¸æ˜æ˜¾ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹çœ‹Hashä¸å‡åŒ€çš„çš„æƒ…å†µã€‚ Hashæä¸å‡åŒ€çš„æƒ…å†µå‡è®¾æˆ‘ä»¬åˆä¸€ä¸ªéå¸¸å·®çš„Keyï¼Œå®ƒä»¬æ‰€æœ‰çš„å®ä¾‹éƒ½è¿”å›ç›¸åŒçš„hashCodeå€¼ã€‚è¿™æ˜¯ä½¿ç”¨HashMapæœ€åçš„æƒ…å†µã€‚ä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š 123456789class Key implements Comparable&lt;Key&gt; &#123; //... @Override public int hashCode() &#123; return 1; &#125;&#125; ä»ç„¶æ‰§è¡Œmainæ–¹æ³•ï¼Œå¾—å‡ºçš„ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š ä»è¡¨ä¸­ç»“æœä¸­å¯çŸ¥ï¼Œéšç€sizeçš„å˜å¤§ï¼ŒJDK1.7çš„èŠ±è´¹æ—¶é—´æ˜¯å¢é•¿çš„è¶‹åŠ¿ï¼Œè€ŒJDK1.8æ˜¯æ˜æ˜¾çš„é™ä½è¶‹åŠ¿ï¼Œå¹¶ä¸”å‘ˆç°å¯¹æ•°å¢é•¿ç¨³å®šã€‚å½“ä¸€ä¸ªé“¾è¡¨å¤ªé•¿çš„æ—¶å€™ï¼ŒHashMapä¼šåŠ¨æ€çš„å°†å®ƒæ›¿æ¢æˆä¸€ä¸ªçº¢é»‘æ ‘ï¼Œè¿™è¯çš„è¯ä¼šå°†æ—¶é—´å¤æ‚åº¦ä»O(n)é™ä¸ºO(logn)ã€‚hashç®—æ³•å‡åŒ€å’Œä¸å‡åŒ€æ‰€èŠ±è´¹çš„æ—¶é—´æ˜æ˜¾ä¹Ÿä¸ç›¸åŒï¼Œè¿™ä¸¤ç§æƒ…å†µçš„ç›¸å¯¹æ¯”è¾ƒï¼Œå¯ä»¥è¯´æ˜ä¸€ä¸ªå¥½çš„hashç®—æ³•çš„é‡è¦æ€§ã€‚ æµ‹è¯•ç¯å¢ƒï¼šå¤„ç†å™¨ä¸º2.2 GHz Intel Core i7ï¼Œå†…å­˜ä¸º16 GB 1600 MHz DDR3ï¼ŒSSDç¡¬ç›˜ï¼Œä½¿ç”¨é»˜è®¤çš„JVMå‚æ•°ï¼Œè¿è¡Œåœ¨64ä½çš„OS X 10.10.1ä¸Šã€‚ å°ç»“(1) æ‰©å®¹æ˜¯ä¸€ä¸ªç‰¹åˆ«è€—æ€§èƒ½çš„æ“ä½œï¼Œæ‰€ä»¥å½“ç¨‹åºå‘˜åœ¨ä½¿ç”¨HashMapçš„æ—¶å€™ï¼Œä¼°ç®—mapçš„å¤§å°ï¼Œåˆå§‹åŒ–çš„æ—¶å€™ç»™ä¸€ä¸ªå¤§è‡´çš„æ•°å€¼ï¼Œé¿å…mapè¿›è¡Œé¢‘ç¹çš„æ‰©å®¹ã€‚ (2) è´Ÿè½½å› å­æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä¹Ÿå¯ä»¥å¤§äº1ï¼Œä½†æ˜¯å»ºè®®ä¸è¦è½»æ˜“ä¿®æ”¹ï¼Œé™¤éæƒ…å†µéå¸¸ç‰¹æ®Šã€‚ (3) HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸è¦åœ¨å¹¶å‘çš„ç¯å¢ƒä¸­åŒæ—¶æ“ä½œHashMapï¼Œå»ºè®®ä½¿ç”¨ConcurrentHashMapã€‚ (4) JDK1.8å¼•å…¥çº¢é»‘æ ‘å¤§ç¨‹åº¦ä¼˜åŒ–äº†HashMapçš„æ€§èƒ½ã€‚ (5) è¿˜æ²¡å‡çº§JDK1.8çš„ï¼Œç°åœ¨å¼€å§‹å‡çº§å§ã€‚HashMapçš„æ€§èƒ½æå‡ä»…ä»…æ˜¯JDK1.8çš„å†°å±±ä¸€è§’ã€‚ å‚è€ƒ JDK1.7&amp;JDK1.8 æºç ã€‚ é…·å£³COOLSHELLï¼Œç–«è‹—ï¼šJAVA HASHMAPçš„æ­»å¾ªç¯ï¼Œ2013 CSDNåšå®¢é¢‘é“ï¼ŒHashMapå¤šçº¿ç¨‹æ­»å¾ªç¯é—®é¢˜ï¼Œ2014ã€‚ çº¢é»‘è”ç›Ÿï¼ŒJavaç±»é›†æ¡†æ¶ä¹‹HashMap(JDK1.8)æºç å‰–æï¼Œ2015ã€‚ CSDNåšå®¢é¢‘é“ï¼Œ æ•™ä½ åˆæ­¥äº†è§£çº¢é»‘æ ‘ï¼Œ2010ã€‚ Java Code Geeksï¼ŒHashMap performance improvements in Java 8ï¼Œ2014ã€‚ Importnewï¼Œå±é™©ï¼åœ¨HashMapä¸­å°†å¯å˜å¯¹è±¡ç”¨ä½œKeyï¼Œ2014ã€‚ CSDNåšå®¢é¢‘é“ï¼Œä¸ºä»€ä¹ˆä¸€èˆ¬hashtableçš„æ¡¶æ•°ä¼šå–ä¸€ä¸ªç´ æ•°ï¼Œ2013ã€‚","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€é¢è¯•é¢˜ã€‘Java Stringå¸¸é‡ç›¸ç­‰ï¼ˆ==ï¼‰é—®é¢˜","slug":"ã€é¢è¯•é¢˜ã€‘Java Stringå¸¸é‡ç›¸ç­‰ï¼ˆ==ï¼‰é—®é¢˜","date":"2017-06-15T08:51:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/06/15/ã€é¢è¯•é¢˜ã€‘Java Stringå¸¸é‡ç›¸ç­‰ï¼ˆ==ï¼‰é—®é¢˜/","link":"","permalink":"http://github.com/2017/06/15/ã€é¢è¯•é¢˜ã€‘Java Stringå¸¸é‡ç›¸ç­‰ï¼ˆ==ï¼‰é—®é¢˜/","excerpt":"é—®é¢˜ä»¥ä¸‹ä¸‰ä¸ªç»“æœåˆ†åˆ«è¾“å‡ºï¼ˆtrue or falseï¼‰ï¼Ÿåˆ«å°çœ‹å®ƒï¼Œå¾ˆå¤šç¨‹åºå‘˜å› ä¸ºä¸Šé¢é—®é¢˜å‡ºè¿‡ç”Ÿäº§bug 12345678910111213141516171819202122String s3 = \"s\";String s4 = \"s\";System.out.println(s3==s4);---String s5 = \"hello\";String s6 = \"he\"+\"llo\";System.out.println(s5==s6);---Integer i = 2017;Integer j = 2017;System.out.println(i==j);---String s1 = new String(\"s\");String s2 = new String(\"s\");System.out.println(s1==s2);System.out.println(s1.intern()==s2.intern());","text":"é—®é¢˜ä»¥ä¸‹ä¸‰ä¸ªç»“æœåˆ†åˆ«è¾“å‡ºï¼ˆtrue or falseï¼‰ï¼Ÿåˆ«å°çœ‹å®ƒï¼Œå¾ˆå¤šç¨‹åºå‘˜å› ä¸ºä¸Šé¢é—®é¢˜å‡ºè¿‡ç”Ÿäº§bug 12345678910111213141516171819202122String s3 = \"s\";String s4 = \"s\";System.out.println(s3==s4);---String s5 = \"hello\";String s6 = \"he\"+\"llo\";System.out.println(s5==s6);---Integer i = 2017;Integer j = 2017;System.out.println(i==j);---String s1 = new String(\"s\");String s2 = new String(\"s\");System.out.println(s1==s2);System.out.println(s1.intern()==s2.intern()); çœŸæ­£æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š 12345678910111213141516171819202122String s3 = \"s\";String s4 = \"s\";System.out.println(s3==s4); //true---String s5 = \"hello\";String s6 = \"he\"+\"llo\";System.out.println(s5==s6); //true---Integer i = 2017;Integer j = 2017;System.out.println(i==j); //false---String s1 = new String(\"s\");String s2 = new String(\"s\");System.out.println(s1==s2); //falseSystem.out.println(s1.intern()==s2.intern()); //true è§£é‡Š çœ‹çœ‹Integerçš„æºä»£ç å°±çŸ¥é“Integer æŠŠ-128-127ä¹‹é—´çš„æ¯ä¸ªå€¼å»ºç«‹äº†ç¼“å­˜æ± ï¼Œæ‰€ä»¥Integer i =127ï¼ŒInteger j =127ï¼Œä»–ä»¬æ˜¯trueï¼Œè¶…å‡ºå°±æ˜¯falseã€‚ String s = â€œsâ€ æ˜¯å¸¸é‡æ± ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡â€sâ€ï¼Œæ‰€ä»¥æ˜¯trueã€‚è€ŒString s = new Stringï¼ˆâ€sâ€ï¼‰åœ¨å †ä¸Šé¢åˆ†é…å†…å­˜åˆ›å»ºä¸€ä¸ªStringå¯¹è±¡ï¼Œæ ˆæ”¾äº†å¯¹è±¡å¼•ç”¨ã€‚å¦‚ä¸‹å›¾ï¼š ä½†åœ¨è°ƒç”¨s.intern()æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå°†å…±äº«æ± ä¸­çš„å­—ç¬¦ä¸²ä¸å¤–éƒ¨çš„å­—ç¬¦ä¸²(sï¼‰è¿›è¡Œæ¯”è¾ƒ,å¦‚æœå…±äº«æ± å­˜åœ¨ï¼Œè¿”å›å®ƒï¼Œå¦‚æœä¸åŒåˆ™å°†å¤–éƒ¨å­—ç¬¦ä¸²æ”¾å…¥å…±äº«æ± ä¸­ï¼Œå¹¶è¿”å›å…¶å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯èƒ½å¤ŸèŠ‚çº¦ç©ºé—´ã€‚ String çš„intern()æ–¹æ³•çš„å®˜æ–¹è§£é‡Šå¦‚ä¸‹ï¼š 1234567891011121314/** * Returns an interned string equal to this string. The VM maintains an internal set of * unique strings. All string literals found in loaded classes' * constant pools are automatically interned. Manually-interned strings are only weakly * referenced, so calling &#123;@code intern&#125; won't lead to unwanted retention. * * &lt;p&gt;Interning is typically used because it guarantees that for interned strings * &#123;@code a&#125; and &#123;@code b&#125;, &#123;@code a.equals(b)&#125; can be simplified to * &#123;@code a == b&#125;. (This is not true of non-interned strings.) * * &lt;p&gt;Many applications find it simpler and more convenient to use an explicit * &#123;@link java.util.HashMap&#125; to implement their own pools. */ public native String intern(); s.intern()ä½œç”¨è¿˜æ˜¯å¾ˆå¤šï¼Œæ¯”å¦‚forå¾ªç¯åˆ›å»ºStringå¯¹è±¡ï¼Œå› ä¸ºä»£ç äº‹å…ˆä¸å¹¶ä¸çŸ¥é“æ˜¯å¦å­˜åœ¨â€helloâ€æˆ–è€…å…¶ä»–å­—ç¬¦ä¸²çš„å®ä¾‹ã€‚è¿™æ ·å¯ä»¥èŠ‚çº¦å¾ˆå¤šå†…å­˜ç©ºé—´ã€‚ å‚è€ƒèµ„æ–™ï¼š 1ã€ä½ é‡åˆ°è¿‡å“ªäº›è´¨é‡å¾ˆé«˜çš„ Java é¢è¯•ï¼Ÿ","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"è¯¦è§£Javaç±»çš„ç”Ÿå‘½å‘¨æœŸ","slug":"è¯¦è§£Javaç±»çš„ç”Ÿå‘½å‘¨æœŸ","date":"2017-06-02T03:36:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/06/02/è¯¦è§£Javaç±»çš„ç”Ÿå‘½å‘¨æœŸ/","link":"","permalink":"http://github.com/2017/06/02/è¯¦è§£Javaç±»çš„ç”Ÿå‘½å‘¨æœŸ/","excerpt":"å¼•è¨€æœ€è¿‘æœ‰ä½ç»†å¿ƒçš„æœ‹å‹åœ¨é˜…è¯»ç¬”è€…çš„æ–‡ç« æ—¶ï¼Œå¯¹Javaç±»çš„ç”Ÿå‘½å‘¨æœŸé—®é¢˜æœ‰ä¸€äº›ç–‘æƒ‘ï¼Œç¬”è€…æ‰“å¼€ç™¾åº¦æœäº†ä¸€ä¸‹ç›¸å…³çš„é—®é¢˜ï¼Œçœ‹åˆ°ç½‘ä¸Šçš„èµ„æ–™å¾ˆå°‘æœ‰æŠŠè¿™ä¸ªé—®é¢˜è®²æ˜ç™½çš„ï¼Œä¸»è¦æ˜¯å› ä¸ºç›®å‰å›½å†…Javaæ–¹é¢çš„æ•™æå¤§å¤šåªæ˜¯å‘Šè¯‰ä½ â€œæ€æ ·åšâ€ï¼Œä½†è‡³äºâ€œä¸ºä»€ä¹ˆè¿™æ ·åšâ€å´ä¸å¤šè¯´ï¼Œæ‰€ä»¥é€ æˆå¤§å®¶åœ¨åŸºç¡€å’ŒåŸç†æ–¹é¢çš„çŸ¥è¯†æ¯”è¾ƒåŒ®ä¹ï¼Œæ‰€ä»¥ç¬”è€…ä»Šå¤©å°±æ–—èƒ†æ¥è®²ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œæƒå½“æŠ›ç –å¼•ç‰ï¼Œå¸Œæœ›å¯¹åœ¨è¿™ä¸ªé—®é¢˜ä¸Šæœ‰ç–‘æƒ‘çš„æœ‹å‹æœ‰æ‰€å¸®åŠ©ï¼Œæ–‡ä¸­æœ‰è¯´çš„ä¸å¯¹çš„åœ°æ–¹ï¼Œä¹Ÿå¸Œæœ›å„è·¯é«˜æ‰‹å‰æ¥æŒ‡æ­£ã€‚ é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹jvmï¼ˆjavaè™šæ‹Ÿæœºï¼‰ä¸­çš„å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å†…å­˜åŒºåŸŸï¼Œè¿™å‡ ä¸ªåŒºåŸŸåœ¨javaç±»çš„ç”Ÿå‘½å‘¨æœŸä¸­æ‰®æ¼”ç€æ¯”è¾ƒé‡è¦çš„è§’è‰²ï¼š æ–¹æ³•åŒºï¼šåœ¨javaçš„è™šæ‹Ÿæœºä¸­æœ‰ä¸€å—ä¸“é—¨ç”¨æ¥å­˜æ”¾å·²ç»åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ä»¥åŠæ–¹æ³•ä»£ç çš„å†…å­˜åŒºåŸŸï¼Œå«åšæ–¹æ³•åŒºã€‚ å¸¸é‡æ± ï¼šå¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨æ¥å­˜æ”¾å¸¸é‡å’Œç±»ä¸­çš„ç¬¦å·å¼•ç”¨ç­‰ä¿¡æ¯ã€‚ å †åŒºï¼šç”¨äºå­˜æ”¾ç±»çš„å¯¹è±¡å®ä¾‹ã€‚ æ ˆåŒºï¼šä¹Ÿå«javaè™šæ‹Ÿæœºæ ˆï¼Œæ˜¯ç”±ä¸€ä¸ªä¸€ä¸ªçš„æ ˆå¸§ç»„æˆçš„åè¿›å…ˆå‡ºçš„æ ˆå¼ç»“æ„ï¼Œæ ˆæ¡¢ä¸­å­˜æ”¾æ–¹æ³•è¿è¡Œæ—¶äº§ç”Ÿçš„å±€éƒ¨å˜é‡ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚å½“è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºæ ˆä¸­å°±ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§å­˜æ”¾è¿™äº›æ•°æ®ï¼Œå½“æ–¹æ³•è°ƒç”¨å®Œæˆæ—¶ï¼Œæ ˆå¸§æ¶ˆå¤±ï¼Œå¦‚æœæ–¹æ³•ä¸­è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œåˆ™ç»§ç»­åœ¨æ ˆé¡¶åˆ›å»ºæ–°çš„æ ˆæ¡¢ã€‚","text":"å¼•è¨€æœ€è¿‘æœ‰ä½ç»†å¿ƒçš„æœ‹å‹åœ¨é˜…è¯»ç¬”è€…çš„æ–‡ç« æ—¶ï¼Œå¯¹Javaç±»çš„ç”Ÿå‘½å‘¨æœŸé—®é¢˜æœ‰ä¸€äº›ç–‘æƒ‘ï¼Œç¬”è€…æ‰“å¼€ç™¾åº¦æœäº†ä¸€ä¸‹ç›¸å…³çš„é—®é¢˜ï¼Œçœ‹åˆ°ç½‘ä¸Šçš„èµ„æ–™å¾ˆå°‘æœ‰æŠŠè¿™ä¸ªé—®é¢˜è®²æ˜ç™½çš„ï¼Œä¸»è¦æ˜¯å› ä¸ºç›®å‰å›½å†…Javaæ–¹é¢çš„æ•™æå¤§å¤šåªæ˜¯å‘Šè¯‰ä½ â€œæ€æ ·åšâ€ï¼Œä½†è‡³äºâ€œä¸ºä»€ä¹ˆè¿™æ ·åšâ€å´ä¸å¤šè¯´ï¼Œæ‰€ä»¥é€ æˆå¤§å®¶åœ¨åŸºç¡€å’ŒåŸç†æ–¹é¢çš„çŸ¥è¯†æ¯”è¾ƒåŒ®ä¹ï¼Œæ‰€ä»¥ç¬”è€…ä»Šå¤©å°±æ–—èƒ†æ¥è®²ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œæƒå½“æŠ›ç –å¼•ç‰ï¼Œå¸Œæœ›å¯¹åœ¨è¿™ä¸ªé—®é¢˜ä¸Šæœ‰ç–‘æƒ‘çš„æœ‹å‹æœ‰æ‰€å¸®åŠ©ï¼Œæ–‡ä¸­æœ‰è¯´çš„ä¸å¯¹çš„åœ°æ–¹ï¼Œä¹Ÿå¸Œæœ›å„è·¯é«˜æ‰‹å‰æ¥æŒ‡æ­£ã€‚ é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹jvmï¼ˆjavaè™šæ‹Ÿæœºï¼‰ä¸­çš„å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å†…å­˜åŒºåŸŸï¼Œè¿™å‡ ä¸ªåŒºåŸŸåœ¨javaç±»çš„ç”Ÿå‘½å‘¨æœŸä¸­æ‰®æ¼”ç€æ¯”è¾ƒé‡è¦çš„è§’è‰²ï¼š æ–¹æ³•åŒºï¼šåœ¨javaçš„è™šæ‹Ÿæœºä¸­æœ‰ä¸€å—ä¸“é—¨ç”¨æ¥å­˜æ”¾å·²ç»åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ä»¥åŠæ–¹æ³•ä»£ç çš„å†…å­˜åŒºåŸŸï¼Œå«åšæ–¹æ³•åŒºã€‚ å¸¸é‡æ± ï¼šå¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨æ¥å­˜æ”¾å¸¸é‡å’Œç±»ä¸­çš„ç¬¦å·å¼•ç”¨ç­‰ä¿¡æ¯ã€‚ å †åŒºï¼šç”¨äºå­˜æ”¾ç±»çš„å¯¹è±¡å®ä¾‹ã€‚ æ ˆåŒºï¼šä¹Ÿå«javaè™šæ‹Ÿæœºæ ˆï¼Œæ˜¯ç”±ä¸€ä¸ªä¸€ä¸ªçš„æ ˆå¸§ç»„æˆçš„åè¿›å…ˆå‡ºçš„æ ˆå¼ç»“æ„ï¼Œæ ˆæ¡¢ä¸­å­˜æ”¾æ–¹æ³•è¿è¡Œæ—¶äº§ç”Ÿçš„å±€éƒ¨å˜é‡ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚å½“è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºæ ˆä¸­å°±ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§å­˜æ”¾è¿™äº›æ•°æ®ï¼Œå½“æ–¹æ³•è°ƒç”¨å®Œæˆæ—¶ï¼Œæ ˆå¸§æ¶ˆå¤±ï¼Œå¦‚æœæ–¹æ³•ä¸­è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œåˆ™ç»§ç»­åœ¨æ ˆé¡¶åˆ›å»ºæ–°çš„æ ˆæ¡¢ã€‚ é™¤äº†ä»¥ä¸Šå››ä¸ªå†…å­˜åŒºåŸŸä¹‹å¤–ï¼Œjvmä¸­çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸè¿˜åŒ…æ‹¬æœ¬åœ°æ–¹æ³•æ ˆå’Œç¨‹åºè®¡æ•°å™¨ï¼Œè¿™ä¸¤ä¸ªåŒºåŸŸä¸javaç±»çš„ç”Ÿå‘½å‘¨æœŸå…³ç³»ä¸æ˜¯å¾ˆå¤§ï¼Œåœ¨è¿™é‡Œå°±ä¸è¯´äº†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±ç™¾åº¦ä¸€ä¸‹ã€‚ ç±»çš„ç”Ÿå‘½å‘¨æœŸå½“æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªjavaçš„æºæ–‡ä»¶åï¼Œç»è¿‡ç¼–è¯‘ä¼šç”Ÿæˆä¸€ä¸ªåç¼€åä¸ºclassçš„æ–‡ä»¶ï¼Œè¿™ç§æ–‡ä»¶å«åšå­—èŠ‚ç æ–‡ä»¶ï¼Œåªæœ‰è¿™ç§å­—èŠ‚ç æ–‡ä»¶æ‰èƒ½å¤Ÿåœ¨javaè™šæ‹Ÿæœºä¸­è¿è¡Œï¼Œjavaç±»çš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯æŒ‡ä¸€ä¸ªclassæ–‡ä»¶ä»åŠ è½½åˆ°å¸è½½çš„å…¨è¿‡ç¨‹ã€‚ ä¸€ä¸ªjavaç±»çš„å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸä¼šç»å†åŠ è½½ã€è¿æ¥ã€åˆå§‹åŒ–ã€ä½¿ç”¨ã€å’Œå¸è½½äº”ä¸ªé˜¶æ®µï¼Œå½“ç„¶ä¹Ÿæœ‰åœ¨åŠ è½½æˆ–è€…è¿æ¥ä¹‹åæ²¡æœ‰è¢«åˆå§‹åŒ–å°±ç›´æ¥è¢«ä½¿ç”¨çš„æƒ…å†µï¼Œå¦‚å›¾æ‰€ç¤ºï¼š ä¸‹é¢æˆ‘ä»¬å°±ä¾æ¬¡æ¥è¯´ä¸€è¯´è¿™äº”ä¸ªé˜¶æ®µã€‚ åŠ è½½åœ¨javaä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæ¥è§¦åˆ°ä¸€ä¸ªè¯â€”â€”ç±»åŠ è½½ï¼Œå®ƒå’Œè¿™é‡Œçš„åŠ è½½å¹¶ä¸æ˜¯ä¸€å›äº‹ï¼Œé€šå¸¸æˆ‘ä»¬è¯´ç±»åŠ è½½æŒ‡çš„æ˜¯ç±»çš„ç”Ÿå‘½å‘¨æœŸä¸­åŠ è½½ã€è¿æ¥ã€åˆå§‹åŒ–ä¸‰ä¸ªé˜¶æ®µã€‚åœ¨åŠ è½½é˜¶æ®µï¼Œjavaè™šæ‹Ÿæœºä¼šåšä»€ä¹ˆå·¥ä½œå‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯æ‰¾åˆ°éœ€è¦åŠ è½½çš„ç±»å¹¶æŠŠç±»çš„ä¿¡æ¯åŠ è½½åˆ°jvmçš„æ–¹æ³•åŒºä¸­ï¼Œç„¶ååœ¨å †åŒºä¸­å®ä¾‹åŒ–ä¸€ä¸ªjava.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºä¸­è¿™ä¸ªç±»çš„ä¿¡æ¯çš„å…¥å£ã€‚ ç±»çš„åŠ è½½æ–¹å¼æ¯”è¾ƒçµæ´»ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„åŠ è½½æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯æ ¹æ®ç±»çš„å…¨è·¯å¾„åæ‰¾åˆ°ç›¸åº”çš„classæ–‡ä»¶ï¼Œç„¶åä»classæ–‡ä»¶ä¸­è¯»å–æ–‡ä»¶å†…å®¹ï¼›å¦ä¸€ç§æ˜¯ä»jaræ–‡ä»¶ä¸­è¯»å–ã€‚å¦å¤–ï¼Œè¿˜æœ‰ä¸‹é¢å‡ ç§æ–¹å¼ä¹Ÿæ¯”è¾ƒå¸¸ç”¨ï¼š ä»ç½‘ç»œä¸­è·å–ï¼šæ¯”å¦‚10å¹´å‰ååˆ†æµè¡Œçš„Appletã€‚ æ ¹æ®ä¸€å®šçš„è§„åˆ™å®æ—¶ç”Ÿæˆï¼Œæ¯”å¦‚è®¾è®¡æ¨¡å¼ä¸­çš„åŠ¨æ€ä»£ç†æ¨¡å¼ï¼Œå°±æ˜¯æ ¹æ®ç›¸åº”çš„ç±»è‡ªåŠ¨ç”Ÿæˆå®ƒçš„ä»£ç†ç±»ã€‚ ä»éclassæ–‡ä»¶ä¸­è·å–ï¼Œå…¶å®è¿™ä¸ç›´æ¥ä»classæ–‡ä»¶ä¸­è·å–çš„æ–¹å¼æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œè¿™äº›éclassæ–‡ä»¶åœ¨jvmä¸­è¿è¡Œä¹‹å‰ä¼šè¢«è½¬æ¢ä¸ºå¯è¢«jvmæ‰€è¯†åˆ«çš„å­—èŠ‚ç æ–‡ä»¶ã€‚ å¯¹äºåŠ è½½çš„æ—¶æœºï¼Œå„ä¸ªè™šæ‹Ÿæœºçš„åšæ³•å¹¶ä¸ä¸€æ ·ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªåŸåˆ™ï¼Œå°±æ˜¯å½“jvmâ€œé¢„æœŸâ€åˆ°ä¸€ä¸ªç±»å°†è¦è¢«ä½¿ç”¨æ—¶ï¼Œå°±ä¼šåœ¨ä½¿ç”¨å®ƒä¹‹å‰å¯¹è¿™ä¸ªç±»è¿›è¡ŒåŠ è½½ã€‚æ¯”å¦‚è¯´ï¼Œåœ¨ä¸€æ®µä»£ç ä¸­å‡ºç°äº†ä¸€ä¸ªç±»çš„åå­—ï¼Œjvmåœ¨æ‰§è¡Œè¿™æ®µä»£ç ä¹‹å‰å¹¶ä¸èƒ½ç¡®å®šè¿™ä¸ªç±»æ˜¯å¦ä¼šè¢«ä½¿ç”¨åˆ°ï¼Œäºæ˜¯ï¼Œæœ‰äº›jvmä¼šåœ¨æ‰§è¡Œå‰å°±åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæœ‰äº›åˆ™åœ¨çœŸæ­£éœ€è¦ç”¨çš„æ—¶å€™æ‰ä¼šå»åŠ è½½å®ƒï¼Œè¿™å–å†³äºå…·ä½“çš„jvmå®ç°ã€‚æˆ‘ä»¬å¸¸ç”¨çš„hotspotè™šæ‹Ÿæœºæ˜¯é‡‡ç”¨çš„åè€…ï¼Œå°±æ˜¯è¯´å½“çœŸæ­£ç”¨åˆ°ä¸€ä¸ªç±»çš„æ—¶å€™æ‰å¯¹å®ƒè¿›è¡ŒåŠ è½½ã€‚ åŠ è½½é˜¶æ®µæ˜¯ç±»çš„ç”Ÿå‘½å‘¨æœŸä¸­çš„ç¬¬ä¸€ä¸ªé˜¶æ®µï¼ŒåŠ è½½é˜¶æ®µä¹‹åï¼Œæ˜¯è¿æ¥é˜¶æ®µã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯æœ‰æ—¶è¿æ¥é˜¶æ®µå¹¶ä¸ä¼šç­‰åŠ è½½é˜¶æ®µå®Œå…¨å®Œæˆä¹‹åæ‰å¼€å§‹ï¼Œè€Œæ˜¯äº¤å‰è¿›è¡Œï¼Œå¯èƒ½ä¸€ä¸ªç±»åªåŠ è½½äº†ä¸€éƒ¨åˆ†ä¹‹åï¼Œè¿æ¥é˜¶æ®µå°±å·²ç»å¼€å§‹äº†ã€‚ä½†æ˜¯è¿™ä¸¤ä¸ªé˜¶æ®µæ€»çš„å¼€å§‹æ—¶é—´å’Œå®Œæˆæ—¶é—´æ€»æ˜¯å›ºå®šçš„ï¼šåŠ è½½é˜¶æ®µæ€»æ˜¯åœ¨è¿æ¥é˜¶æ®µä¹‹å‰å¼€å§‹ï¼Œè¿æ¥é˜¶æ®µæ€»æ˜¯åœ¨åŠ è½½é˜¶æ®µå®Œæˆä¹‹åå®Œæˆã€‚ è¿æ¥è¿æ¥é˜¶æ®µæ¯”è¾ƒå¤æ‚ï¼Œä¸€èˆ¬ä¼šè·ŸåŠ è½½é˜¶æ®µå’Œåˆå§‹åŒ–é˜¶æ®µäº¤å‰è¿›è¡Œï¼Œè¿™ä¸ªé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡å°±æ˜¯åšä¸€äº›åŠ è½½åçš„éªŒè¯å·¥ä½œä»¥åŠä¸€äº›åˆå§‹åŒ–å‰çš„å‡†å¤‡å·¥ä½œï¼Œå¯ä»¥ç»†åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šéªŒè¯ã€å‡†å¤‡å’Œè§£æã€‚ éªŒè¯ï¼šå½“ä¸€ä¸ªç±»è¢«åŠ è½½ä¹‹åï¼Œå¿…é¡»è¦éªŒè¯ä¸€ä¸‹è¿™ä¸ªç±»æ˜¯å¦åˆæ³•ï¼Œæ¯”å¦‚è¿™ä¸ªç±»æ˜¯ä¸æ˜¯ç¬¦åˆå­—èŠ‚ç çš„æ ¼å¼ã€å˜é‡ä¸æ–¹æ³•æ˜¯ä¸æ˜¯æœ‰é‡å¤ã€æ•°æ®ç±»å‹æ˜¯ä¸æ˜¯æœ‰æ•ˆã€ç»§æ‰¿ä¸å®ç°æ˜¯å¦åˆä¹æ ‡å‡†ç­‰ç­‰ã€‚æ€»ä¹‹ï¼Œè¿™ä¸ªé˜¶æ®µçš„ç›®çš„å°±æ˜¯ä¿è¯åŠ è½½çš„ç±»æ˜¯èƒ½å¤Ÿè¢«jvmæ‰€è¿è¡Œã€‚ å‡†å¤‡ï¼šå‡†å¤‡é˜¶æ®µçš„å·¥ä½œå°±æ˜¯ä¸ºç±»çš„é™æ€å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ä¸ºjvmé»˜è®¤çš„åˆå€¼ï¼Œå¯¹äºéé™æ€çš„å˜é‡ï¼Œåˆ™ä¸ä¼šä¸ºå®ƒä»¬åˆ†é…å†…å­˜ã€‚æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œè¿™æ—¶å€™ï¼Œé™æ€å˜é‡çš„åˆå€¼ä¸ºjvmé»˜è®¤çš„åˆå€¼ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬åœ¨ç¨‹åºä¸­è®¾å®šçš„åˆå€¼ã€‚jvmé»˜è®¤çš„åˆå€¼æ˜¯è¿™æ ·çš„ï¼š åŸºæœ¬ç±»å‹ï¼šï¼ˆintã€longã€shortã€charã€byteã€booleanã€floatã€doubleï¼‰çš„é»˜è®¤å€¼ä¸º0ã€‚ å¼•ç”¨ç±»å‹ï¼šé»˜è®¤å€¼ä¸ºnullã€‚ å¸¸é‡ï¼šé»˜è®¤å€¼ä¸ºæˆ‘ä»¬ç¨‹åºä¸­è®¾å®šçš„å€¼ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨ç¨‹åºä¸­å®šä¹‰final static int a = 100ï¼Œåˆ™å‡†å¤‡é˜¶æ®µä¸­açš„åˆå€¼å°±æ˜¯100ã€‚ è§£æï¼šè¿™ä¸€é˜¶æ®µçš„ä»»åŠ¡å°±æ˜¯æŠŠå¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯ç¬¦å·å¼•ç”¨ï¼Œä»€ä¹ˆåˆæ˜¯ç›´æ¥å¼•ç”¨å‘¢ï¼Ÿæˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬è¦æ‰¾ä¸€ä¸ªäººï¼Œæˆ‘ä»¬ç°æœ‰çš„ä¿¡æ¯æ˜¯è¿™ä¸ªäººçš„èº«ä»½è¯å·æ˜¯1234567890ã€‚åªæœ‰è¿™ä¸ªä¿¡æ¯æˆ‘ä»¬æ˜¾ç„¶æ‰¾ä¸åˆ°è¿™ä¸ªäººï¼Œä½†æ˜¯é€šè¿‡å…¬å®‰å±€çš„èº«ä»½ç³»ç»Ÿï¼Œæˆ‘ä»¬è¾“å…¥1234567890è¿™ä¸ªå·ä¹‹åï¼Œå°±ä¼šå¾—åˆ°å®ƒçš„å…¨éƒ¨ä¿¡æ¯ï¼šæ¯”å¦‚å®‰å¾½çœé»„å±±å¸‚ä½™æš‡æ‘18å·å¼ ä¸‰ï¼Œé€šè¿‡è¿™ä¸ªä¿¡æ¯æˆ‘ä»¬å°±èƒ½æ‰¾åˆ°è¿™ä¸ªäººäº†ã€‚è¿™é‡Œï¼Œ123456790å°±å¥½æ¯”æ˜¯ä¸€ä¸ªç¬¦å·å¼•ç”¨ï¼Œè€Œå®‰å¾½çœé»„å±±å¸‚ä½™æš‡æ‘18å·å¼ ä¸‰å°±æ˜¯ç›´æ¥å¼•ç”¨ã€‚åœ¨å†…å­˜ä¸­ä¹Ÿæ˜¯ä¸€æ ·ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦åœ¨å†…å­˜ä¸­æ‰¾ä¸€ä¸ªç±»é‡Œé¢çš„ä¸€ä¸ªå«åšshowçš„æ–¹æ³•ï¼Œæ˜¾ç„¶æ˜¯æ‰¾ä¸åˆ°ã€‚ä½†æ˜¯åœ¨è§£æé˜¶æ®µï¼Œjvmå°±ä¼šæŠŠshowè¿™ä¸ªåå­—è½¬æ¢ä¸ºæŒ‡å‘æ–¹æ³•åŒºçš„çš„ä¸€å—å†…å­˜åœ°å€ï¼Œæ¯”å¦‚c17164ï¼Œé€šè¿‡c17164å°±å¯ä»¥æ‰¾åˆ°showè¿™ä¸ªæ–¹æ³•å…·ä½“åˆ†é…åœ¨å†…å­˜çš„å“ªä¸€ä¸ªåŒºåŸŸäº†ã€‚è¿™é‡Œshowå°±æ˜¯ç¬¦å·å¼•ç”¨ï¼Œè€Œc17164å°±æ˜¯ç›´æ¥å¼•ç”¨ã€‚åœ¨è§£æé˜¶æ®µï¼Œjvmä¼šå°†æ‰€æœ‰çš„ç±»æˆ–æ¥å£åã€å­—æ®µåã€æ–¹æ³•åè½¬æ¢ä¸ºå…·ä½“çš„å†…å­˜åœ°å€ã€‚ è¿æ¥é˜¶æ®µå®Œæˆä¹‹åä¼šæ ¹æ®ä½¿ç”¨çš„æƒ…å†µï¼ˆç›´æ¥å¼•ç”¨è¿˜æ˜¯è¢«åŠ¨å¼•ç”¨ï¼‰æ¥é€‰æ‹©æ˜¯å¦å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ã€‚ åˆå§‹åŒ–å¦‚æœä¸€ä¸ªç±»è¢«ç›´æ¥å¼•ç”¨ï¼Œå°±ä¼šè§¦å‘ç±»çš„åˆå§‹åŒ–ã€‚åœ¨javaä¸­ï¼Œç›´æ¥å¼•ç”¨çš„æƒ…å†µæœ‰ï¼š é€šè¿‡newå…³é”®å­—å®ä¾‹åŒ–å¯¹è±¡ã€è¯»å–æˆ–è®¾ç½®ç±»çš„é™æ€å˜é‡ã€è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•ã€‚ é€šè¿‡åå°„æ–¹å¼æ‰§è¡Œä»¥ä¸Šä¸‰ç§è¡Œä¸ºã€‚ åˆå§‹åŒ–å­ç±»çš„æ—¶å€™ï¼Œä¼šè§¦å‘çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚ ä½œä¸ºç¨‹åºå…¥å£ç›´æ¥è¿è¡Œæ—¶ï¼ˆä¹Ÿå°±æ˜¯ç›´æ¥è°ƒç”¨mainæ–¹æ³•ï¼‰ã€‚ é™¤äº†ä»¥ä¸Šå››ç§æƒ…å†µï¼Œå…¶ä»–ä½¿ç”¨ç±»çš„æ–¹å¼å«åšè¢«åŠ¨å¼•ç”¨ï¼Œè€Œè¢«åŠ¨å¼•ç”¨ä¸ä¼šè§¦å‘ç±»çš„åˆå§‹åŒ–ã€‚è¯·çœ‹ä¸»åŠ¨å¼•ç”¨çš„ç¤ºä¾‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import java.lang.reflect.Field; import java.lang.reflect.Method; class InitClass&#123; static &#123; System.out.println(\"åˆå§‹åŒ–InitClass\"); &#125; public static String a = null; public static void method()&#123;&#125; &#125; class SubInitClass extends InitClass&#123;&#125; public class Test1 &#123; /** * ä¸»åŠ¨å¼•ç”¨å¼•èµ·ç±»çš„åˆå§‹åŒ–çš„ç¬¬å››ç§æƒ…å†µå°±æ˜¯è¿è¡ŒTest1çš„mainæ–¹æ³•æ—¶ * å¯¼è‡´Test1åˆå§‹åŒ–ï¼Œè¿™ä¸€ç‚¹å¾ˆå¥½ç†è§£ï¼Œå°±ä¸ç‰¹åˆ«æ¼”ç¤ºäº†ã€‚ * æœ¬ä»£ç æ¼”ç¤ºäº†å‰ä¸‰ç§æƒ…å†µï¼Œä»¥ä¸‹ä»£ç éƒ½ä¼šå¼•èµ·InitClassçš„åˆå§‹åŒ–ï¼Œ * ä½†ç”±äºåˆå§‹åŒ–åªä¼šè¿›è¡Œä¸€æ¬¡ï¼Œè¿è¡Œæ—¶è¯·å°†æ³¨è§£å»æ‰ï¼Œä¾æ¬¡è¿è¡ŒæŸ¥çœ‹ç»“æœã€‚ * @param args * @throws Exception */ public static void main(String[] args) throws Exception&#123; // ä¸»åŠ¨å¼•ç”¨å¼•èµ·ç±»çš„åˆå§‹åŒ–ä¸€: newå¯¹è±¡ã€è¯»å–æˆ–è®¾ç½®ç±»çš„é™æ€å˜é‡ã€è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•ã€‚ // new InitClass(); // InitClass.a = \"\"; // String a = InitClass.a; // InitClass.method(); // ä¸»åŠ¨å¼•ç”¨å¼•èµ·ç±»çš„åˆå§‹åŒ–äºŒï¼šé€šè¿‡åå°„å®ä¾‹åŒ–å¯¹è±¡ã€è¯»å–æˆ–è®¾ç½®ç±»çš„é™æ€å˜é‡ã€è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•ã€‚ // Class cls = InitClass.class; // cls.newInstance(); // Field f = cls.getDeclaredField(\"a\"); // f.get(null); // f.set(null, \"s\"); // Method md = cls.getDeclaredMethod(\"method\"); // md.invoke(null, null); // ä¸»åŠ¨å¼•ç”¨å¼•èµ·ç±»çš„åˆå§‹åŒ–ä¸‰ï¼šå®ä¾‹åŒ–å­ç±»ï¼Œå¼•èµ·çˆ¶ç±»åˆå§‹åŒ–ã€‚ // new SubInitClass(); &#125; &#125; ä¸Šé¢çš„ç¨‹åºæ¼”ç¤ºäº†ä¸»åŠ¨å¼•ç”¨è§¦å‘ç±»çš„åˆå§‹åŒ–çš„å››ç§æƒ…å†µã€‚ ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šæŒ‰ç…§é¡ºåºè‡ªä¸Šè€Œä¸‹è¿è¡Œç±»ä¸­çš„å˜é‡èµ‹å€¼è¯­å¥å’Œé™æ€è¯­å¥ï¼Œå¦‚æœæœ‰çˆ¶ç±»ï¼Œåˆ™é¦–å…ˆæŒ‰ç…§é¡ºåºè¿è¡Œçˆ¶ç±»ä¸­çš„å˜é‡èµ‹å€¼è¯­å¥å’Œé™æ€è¯­å¥ã€‚å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼Œé¦–å…ˆå»ºä¸¤ä¸ªç±»ç”¨æ¥æ˜¾ç¤ºèµ‹å€¼æ“ä½œï¼š 12345678910public class Field1&#123; public Field1()&#123; System.out.println(\"Field1æ„é€ æ–¹æ³•\"); &#125; &#125; public class Field2&#123; public Field2()&#123; System.out.println(\"Field2æ„é€ æ–¹æ³•\"); &#125; &#125; ä¸‹é¢æ˜¯æ¼”ç¤ºåˆå§‹åŒ–é¡ºåºçš„ä»£ç ï¼š 1234567891011121314151617181920class InitClass2&#123; static&#123; System.out.println(\"è¿è¡Œçˆ¶ç±»é™æ€ä»£ç \"); &#125; public static Field1 f1 = new Field1(); public static Field1 f2; &#125; class SubInitClass2 extends InitClass2&#123; static&#123; System.out.println(\"è¿è¡Œå­ç±»é™æ€ä»£ç \"); &#125; public static Field2 f2 = new Field2(); &#125; public class Test2 &#123; public static void main(String[] args) throws ClassNotFoundException&#123; new SubInitClass2(); &#125; &#125; ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆå§‹åŒ–çš„é¡ºåºæ˜¯ï¼šç¬¬03è¡Œï¼Œç¬¬05è¡Œï¼Œç¬¬11è¡Œï¼Œç¬¬13è¡Œã€‚ç¬¬04è¡Œæ˜¯å£°æ˜æ“ä½œï¼Œæ²¡æœ‰èµ‹å€¼ï¼Œæ‰€ä»¥ä¸ä¼šè¢«è¿è¡Œã€‚è€Œä¸‹é¢çš„ä»£ç ï¼š 1234567891011121314151617181920class InitClass2&#123; public static Field1 f1 = new Field1(); public static Field1 f2; static&#123; System.out.println(\"è¿è¡Œçˆ¶ç±»é™æ€ä»£ç \"); &#125; &#125; class SubInitClass2 extends InitClass2&#123; public static Field2 f2 = new Field2(); static&#123; System.out.println(\"è¿è¡Œå­ç±»é™æ€ä»£ç \"); &#125; &#125; public class Test2 &#123; public static void main(String[] args) throws ClassNotFoundException&#123; new SubInitClass2(); &#125; &#125; åˆå§‹åŒ–é¡ºåºä¸ºï¼šç¬¬02è¡Œã€ç¬¬05è¡Œã€ç¬¬10è¡Œã€ç¬¬12è¡Œï¼Œå„ä½å¯ä»¥è¿è¡Œç¨‹åºæŸ¥çœ‹ç»“æœã€‚ åœ¨ç±»çš„åˆå§‹åŒ–é˜¶æ®µï¼Œåªä¼šåˆå§‹åŒ–ä¸ç±»ç›¸å…³çš„é™æ€èµ‹å€¼è¯­å¥å’Œé™æ€è¯­å¥ï¼Œä¹Ÿå°±æ˜¯æœ‰staticå…³é”®å­—ä¿®é¥°çš„ä¿¡æ¯ï¼Œè€Œæ²¡æœ‰staticä¿®é¥°çš„èµ‹å€¼è¯­å¥å’Œæ‰§è¡Œè¯­å¥åœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™æ‰ä¼šè¿è¡Œã€‚ ä½¿ç”¨ç±»çš„ä½¿ç”¨åŒ…æ‹¬ä¸»åŠ¨å¼•ç”¨å’Œè¢«åŠ¨å¼•ç”¨ï¼Œä¸»åŠ¨å¼•ç”¨åœ¨åˆå§‹åŒ–çš„ç« èŠ‚ä¸­å·²ç»è¯´è¿‡äº†ï¼Œä¸‹é¢æˆ‘ä»¬ä¸»è¦æ¥è¯´ä¸€ä¸‹è¢«åŠ¨å¼•ç”¨ï¼š å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œåªä¼šå¼•èµ·çˆ¶ç±»çš„åˆå§‹åŒ–ï¼Œè€Œä¸ä¼šå¼•èµ·å­ç±»çš„åˆå§‹åŒ–ã€‚ å®šä¹‰ç±»æ•°ç»„ï¼Œä¸ä¼šå¼•èµ·ç±»çš„åˆå§‹åŒ–ã€‚ å¼•ç”¨ç±»çš„å¸¸é‡ï¼Œä¸ä¼šå¼•èµ·ç±»çš„åˆå§‹åŒ–ã€‚ è¢«åŠ¨å¼•ç”¨çš„ç¤ºä¾‹ä»£ç ï¼š 1234567891011121314151617181920212223class InitClass&#123; static &#123; System.out.println(\"åˆå§‹åŒ–InitClass\"); &#125; public static String a = null; public final static String b = \"b\"; public static void method()&#123;&#125; &#125; class SubInitClass extends InitClass&#123; static &#123; System.out.println(\"åˆå§‹åŒ–SubInitClass\"); &#125; &#125; public class Test4 &#123; public static void main(String[] args) throws Exception&#123; // String a = SubInitClass.a;// å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œåªä¼šå¼•èµ·çˆ¶ç±»åˆå§‹åŒ–ï¼Œè€Œä¸ä¼šå¼•èµ·å­ç±»çš„åˆå§‹åŒ– // String b = InitClass.b;// ä½¿ç”¨ç±»çš„å¸¸é‡ä¸ä¼šå¼•èµ·ç±»çš„åˆå§‹åŒ– SubInitClass[] sc = new SubInitClass[10];// å®šä¹‰ç±»æ•°ç»„ä¸ä¼šå¼•èµ·ç±»çš„åˆå§‹åŒ– &#125; &#125; æœ€åæ€»ç»“ä¸€ä¸‹ä½¿ç”¨é˜¶æ®µï¼šä½¿ç”¨é˜¶æ®µåŒ…æ‹¬ä¸»åŠ¨å¼•ç”¨å’Œè¢«åŠ¨å¼•ç”¨ï¼Œä¸»åŠ¨é¥®ç”¨ä¼šå¼•èµ·ç±»çš„åˆå§‹åŒ–ï¼Œè€Œè¢«åŠ¨å¼•ç”¨ä¸ä¼šå¼•èµ·ç±»çš„åˆå§‹åŒ–ã€‚ å½“ä½¿ç”¨é˜¶æ®µå®Œæˆä¹‹åï¼Œjavaç±»å°±è¿›å…¥äº†å¸è½½é˜¶æ®µã€‚ å¸è½½å…³äºç±»çš„å¸è½½ï¼Œç¬”è€…åœ¨å•ä¾‹æ¨¡å¼è®¨è®ºç¯‡ï¼šå•ä¾‹æ¨¡å¼ä¸åƒåœ¾å›æ”¶ä¸€æ–‡ä¸­æœ‰è¿‡æè¿°ï¼Œåœ¨ç±»ä½¿ç”¨å®Œä¹‹åï¼Œå¦‚æœæ»¡è¶³ä¸‹é¢çš„æƒ…å†µï¼Œç±»å°±ä¼šè¢«å¸è½½ï¼š è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯javaå †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚ åŠ è½½è¯¥ç±»çš„ClassLoaderå·²ç»è¢«å›æ”¶ã€‚ è¯¥ç±»å¯¹åº”çš„java.lang.Classå¯¹è±¡æ²¡æœ‰ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚ å¦‚æœä»¥ä¸Šä¸‰ä¸ªæ¡ä»¶å…¨éƒ¨æ»¡è¶³ï¼Œjvmå°±ä¼šåœ¨æ–¹æ³•åŒºåƒåœ¾å›æ”¶çš„æ—¶å€™å¯¹ç±»è¿›è¡Œå¸è½½ï¼Œç±»çš„å¸è½½è¿‡ç¨‹å…¶å®å°±æ˜¯åœ¨æ–¹æ³•åŒºä¸­æ¸…ç©ºç±»ä¿¡æ¯ï¼Œjavaç±»çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå°±ç»“æŸäº†ã€‚ æ€»ç»“åšjavaçš„æœ‹å‹å¯¹äºå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå¯èƒ½éƒ½æ¯”è¾ƒç†Ÿæ‚‰ï¼Œå¯¹è±¡åŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨jvmçš„å †åŒºä¸­åˆ›å»ºï¼Œåœ¨åˆ›å»ºå¯¹è±¡ä¹‹å‰ï¼Œä¼šè§¦å‘ç±»åŠ è½½ï¼ˆåŠ è½½ã€è¿æ¥ã€åˆå§‹åŒ–ï¼‰ï¼Œå½“ç±»åˆå§‹åŒ–å®Œæˆåï¼Œæ ¹æ®ç±»ä¿¡æ¯åœ¨å †åŒºä¸­å®ä¾‹åŒ–ç±»å¯¹è±¡ï¼Œåˆå§‹åŒ–éé™æ€å˜é‡ã€éé™æ€ä»£ç ä»¥åŠé»˜è®¤æ„é€ æ–¹æ³•ï¼Œå½“å¯¹è±¡ä½¿ç”¨å®Œä¹‹åä¼šåœ¨åˆé€‚çš„æ—¶å€™è¢«jvmåƒåœ¾æ”¶é›†å™¨å›æ”¶ã€‚è¯»å®Œæœ¬æ–‡åæˆ‘ä»¬çŸ¥é“ï¼Œå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåªæ˜¯ç±»çš„ç”Ÿå‘½å‘¨æœŸä¸­ä½¿ç”¨é˜¶æ®µçš„ä¸»åŠ¨å¼•ç”¨çš„ä¸€ç§æƒ…å†µï¼ˆå³å®ä¾‹åŒ–ç±»å¯¹è±¡ï¼‰ã€‚è€Œç±»çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸåˆ™è¦æ¯”å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸé•¿çš„å¤šã€‚ å‚è€ƒèµ„æ–™JVM çš„ å·¥ä½œåŸç†ï¼Œå±‚æ¬¡ç»“æ„ ä»¥åŠ GCå·¥ä½œåŸç† æœ¬æ–‡è½¬è½½è‡ª è¯¦è§£javaç±»çš„ç”Ÿå‘½å‘¨æœŸ - å¡å¥´è¾¾æ‘©çš„ä¸“æ ","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€Androidã€‘AudioéŸ³é¢‘è¾“å‡ºé€šé“åˆ‡æ¢ - è“ç‰™ã€å¤–æ”¾","slug":"ã€Androidã€‘AudioéŸ³é¢‘è¾“å‡ºé€šé“åˆ‡æ¢ - è“ç‰™ã€å¤–æ”¾","date":"2017-05-18T03:40:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/05/18/ã€Androidã€‘AudioéŸ³é¢‘è¾“å‡ºé€šé“åˆ‡æ¢ - è“ç‰™ã€å¤–æ”¾/","link":"","permalink":"http://github.com/2017/05/18/ã€Androidã€‘AudioéŸ³é¢‘è¾“å‡ºé€šé“åˆ‡æ¢ - è“ç‰™ã€å¤–æ”¾/","excerpt":"æ‰‹æœºéŸ³é¢‘çš„è¾“å‡ºæœ‰å¤–æ”¾ï¼ˆSpeakerï¼‰ã€å¬ç­’ï¼ˆTelephone Receiverï¼‰ã€æœ‰çº¿è€³æœºï¼ˆWiredHeadsetï¼‰ã€è“ç‰™éŸ³ç®±ï¼ˆBluetooth A2DPï¼‰ç­‰è¾“å‡ºè®¾å¤‡ã€‚åœ¨å¹³æ—¶ï¼Œç”µè¯å…æã€æ’æ‹”è€³æœºã€è¿æ¥æ–­å¼€è“ç‰™è®¾å¤‡ç­‰æ“ä½œç³»ç»Ÿéƒ½ä¼šè‡ªåŠ¨åˆ‡æ¢AudioéŸ³é¢‘åˆ°ç›¸åº”çš„è¾“å‡ºè®¾å¤‡ä¸Šã€‚æ¯”å¦‚ç”µè¯å…æå°±æ˜¯ä»å¬ç­’åˆ‡æ¢åˆ°å¤–æ”¾æ‰¬å£°å™¨ï¼Œæ’å…¥è€³æœºå°±æ˜¯ä»å¤–æ”¾åˆ‡æ¢åˆ°è€³æœºã€‚ åœºæ™¯éœ€æ±‚Androidç³»ç»Ÿè‡ªåŠ¨åˆ‡æ¢çš„è¿™äº›ç­–ç•¥ï¼Œå¹¶ä¸èƒ½å…¨éƒ¨æ»¡è¶³æˆ‘ä»¬çš„äº§å“éœ€æ±‚ï¼Œæ¯”å¦‚éŸ³ä¹Appéœ€è¦å¯¹å¬æ­Œæ—¶æ‹”å‡ºè€³æœºçš„æ“ä½œè¿›è¡Œé˜»æ­¢ï¼ˆæš‚åœæ’­æ”¾ï¼‰ï¼Œé˜²æ­¢çªç„¶åˆ‡æ¢åˆ°å¤–æ”¾å¯¼è‡´å°´å°¬ã€‚ æœ€è¿‘é¡¹ç›®éœ€æ±‚å¸Œæœ›å³ä½¿åœ¨è¿æ¥è“ç‰™éŸ³ç®±çš„æƒ…å†µä¸‹ï¼Œä»æ—§ä½¿ç”¨æ‰‹æœºå¤–æ”¾æ’­æ”¾éŸ³é¢‘ã€‚è¿™å°±éœ€è¦å¼ºåˆ¶åˆ‡æ¢Audioè¾“å‡ºé€šé“ï¼Œæ‰“ç ´ç³»ç»ŸåŸæœ‰çš„ç­–ç•¥ã€‚ æŸ¥é˜…èµ„æ–™ï¼Œçœ‹åˆ°äº†Androidä¸­å¯ä»¥é€šè¿‡AudioManageræŸ¥è¯¢ã€åˆ‡æ¢å½“å‰Audioè¾“å‡ºé€šé“ï¼Œå¹¶ä¸”åœ¨Audioè¾“å‡ºå‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ•è·å¹¶å¤„ç†è¿™ç§å˜åŒ–ã€‚","text":"æ‰‹æœºéŸ³é¢‘çš„è¾“å‡ºæœ‰å¤–æ”¾ï¼ˆSpeakerï¼‰ã€å¬ç­’ï¼ˆTelephone Receiverï¼‰ã€æœ‰çº¿è€³æœºï¼ˆWiredHeadsetï¼‰ã€è“ç‰™éŸ³ç®±ï¼ˆBluetooth A2DPï¼‰ç­‰è¾“å‡ºè®¾å¤‡ã€‚åœ¨å¹³æ—¶ï¼Œç”µè¯å…æã€æ’æ‹”è€³æœºã€è¿æ¥æ–­å¼€è“ç‰™è®¾å¤‡ç­‰æ“ä½œç³»ç»Ÿéƒ½ä¼šè‡ªåŠ¨åˆ‡æ¢AudioéŸ³é¢‘åˆ°ç›¸åº”çš„è¾“å‡ºè®¾å¤‡ä¸Šã€‚æ¯”å¦‚ç”µè¯å…æå°±æ˜¯ä»å¬ç­’åˆ‡æ¢åˆ°å¤–æ”¾æ‰¬å£°å™¨ï¼Œæ’å…¥è€³æœºå°±æ˜¯ä»å¤–æ”¾åˆ‡æ¢åˆ°è€³æœºã€‚ åœºæ™¯éœ€æ±‚Androidç³»ç»Ÿè‡ªåŠ¨åˆ‡æ¢çš„è¿™äº›ç­–ç•¥ï¼Œå¹¶ä¸èƒ½å…¨éƒ¨æ»¡è¶³æˆ‘ä»¬çš„äº§å“éœ€æ±‚ï¼Œæ¯”å¦‚éŸ³ä¹Appéœ€è¦å¯¹å¬æ­Œæ—¶æ‹”å‡ºè€³æœºçš„æ“ä½œè¿›è¡Œé˜»æ­¢ï¼ˆæš‚åœæ’­æ”¾ï¼‰ï¼Œé˜²æ­¢çªç„¶åˆ‡æ¢åˆ°å¤–æ”¾å¯¼è‡´å°´å°¬ã€‚ æœ€è¿‘é¡¹ç›®éœ€æ±‚å¸Œæœ›å³ä½¿åœ¨è¿æ¥è“ç‰™éŸ³ç®±çš„æƒ…å†µä¸‹ï¼Œä»æ—§ä½¿ç”¨æ‰‹æœºå¤–æ”¾æ’­æ”¾éŸ³é¢‘ã€‚è¿™å°±éœ€è¦å¼ºåˆ¶åˆ‡æ¢Audioè¾“å‡ºé€šé“ï¼Œæ‰“ç ´ç³»ç»ŸåŸæœ‰çš„ç­–ç•¥ã€‚ æŸ¥é˜…èµ„æ–™ï¼Œçœ‹åˆ°äº†Androidä¸­å¯ä»¥é€šè¿‡AudioManageræŸ¥è¯¢ã€åˆ‡æ¢å½“å‰Audioè¾“å‡ºé€šé“ï¼Œå¹¶ä¸”åœ¨Audioè¾“å‡ºå‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ•è·å¹¶å¤„ç†è¿™ç§å˜åŒ–ã€‚ é¦–å…ˆæé†’ä¸‹å¤§å®¶ï¼Œä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ—¶ï¼Œéœ€è¦æ·»åŠ æƒé™ï¼š 1&lt;uses-permission android:name=\"android.permission.MODIFY_AUDIO_SETTINGS\" /&gt; Audioè¾“å‡ºçŠ¶æ€æŸ¥è¯¢AudioManager æä¾›çš„ä¸‹åˆ—æ–¹æ³•å¯ä»¥ç”¨æ¥æŸ¥è¯¢å½“å‰Audioè¾“å‡ºçš„çŠ¶æ€ï¼š isBluetoothA2dpOn()ï¼šæ£€æŸ¥A2DPAudioéŸ³é¢‘è¾“å‡ºæ˜¯å¦é€šè¿‡è“ç‰™è€³æœºï¼› isSpeakerphoneOn()ï¼šæ£€æŸ¥æ‰¬å£°å™¨æ˜¯å¦æ‰“å¼€ï¼› isWiredHeadsetOn()ï¼šæ£€æŸ¥çº¿æ§è€³æœºæ˜¯å¦è¿ç€ï¼›æ³¨æ„è¿™ä¸ªæ–¹æ³•åªæ˜¯ç”¨æ¥åˆ¤æ–­è€³æœºæ˜¯å¦æ˜¯æ’å…¥çŠ¶æ€ï¼Œå¹¶ä¸èƒ½ç”¨å®ƒçš„ç»“æœæ¥åˆ¤å®šå½“å‰çš„Audioæ˜¯é€šè¿‡è€³æœºè¾“å‡ºçš„ï¼Œè¿™è¿˜ä¾èµ–äºå…¶ä»–æ¡ä»¶ã€‚ setSpeakerphoneOn(boolean on)ï¼šç›´æ¥é€‰æ‹©å¤–æ”¾æ‰¬å£°å™¨å‘å£°ï¼› setBluetoothScoOn(boolean on)ï¼šè¦æ±‚ä½¿ç”¨è“ç‰™SCOè€³æœºè¿›è¡Œé€šè®¯ï¼› æ­¤å¤„æ ¹æ®è¿™ç¯‡æ–‡ç« ç®€å•åœ°ä»‹ç»ä¸€ä¸‹è“ç‰™è€³æœºçš„ä¸¤ç§é“¾è·¯ï¼ŒA2DPåŠSCOã€‚androidçš„apiè¡¨æ˜ï¼š A2DPï¼šæ˜¯ä¸€ç§å•å‘çš„é«˜å“è´¨éŸ³é¢‘æ•°æ®ä¼ è¾“é“¾è·¯ï¼Œé€šå¸¸ç”¨äºæ’­æ”¾ç«‹ä½“å£°éŸ³ä¹ï¼› SCOï¼š åˆ™æ˜¯ä¸€ç§åŒå‘çš„éŸ³é¢‘æ•°æ®çš„ä¼ è¾“é“¾è·¯ï¼Œè¯¥é“¾è·¯åªæ”¯æŒ8KåŠ16Kå•å£°é“çš„éŸ³é¢‘æ•°æ®ï¼Œåªèƒ½ç”¨äºæ™®é€šè¯­éŸ³çš„ä¼ è¾“ï¼Œè‹¥ç”¨äºæ’­æ”¾éŸ³ä¹é‚£å°±åªèƒ½å‘µå‘µäº†ã€‚ ä¸¤è€…çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼šA2DPåªèƒ½æ’­æ”¾ï¼Œé»˜è®¤æ˜¯æ‰“å¼€çš„ï¼Œè€ŒSCOæ—¢èƒ½å½•éŸ³ä¹Ÿèƒ½æ’­æ”¾ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ã€‚ å¦‚æœè¦å½•éŸ³è‚¯å®šè¦æ‰“å¼€scoå•¦ï¼Œå› æ­¤è°ƒç”¨ä¸Šé¢çš„setBluetoothScoOn(boolean on)å°±å¯ä»¥é€šè¿‡è“ç‰™è€³æœºå½•éŸ³ã€æ’­æ”¾éŸ³é¢‘äº†ï¼Œå½•å®Œã€æ’­æ”¾å®Œè®°å¾—è¦å…³é—­ã€‚ å¦å¤–ï¼Œåœ¨Androidç³»ç»Ÿä¸­é€šè¿‡AudioManager.setMode()æ–¹æ³•æ¥ç®¡ç†æ’­æ”¾æ¨¡å¼ã€‚åœ¨setMode()æ–¹æ³•ä¸­æœ‰ä»¥ä¸‹å‡ ç§å¯¹åº”ä¸åŒçš„æ’­æ”¾æ¨¡å¼: MODE_NORMAL : æ™®é€šæ¨¡å¼ï¼Œæ—¢ä¸æ˜¯é“ƒå£°æ¨¡å¼ä¹Ÿä¸æ˜¯é€šè¯æ¨¡å¼ MODE_RINGTONE : é“ƒå£°æ¨¡å¼ MODE_IN_CALL : é€šè¯æ¨¡å¼ MODE_IN_COMMUNICATION : é€šä¿¡æ¨¡å¼ï¼ŒåŒ…æ‹¬éŸ³/è§†é¢‘,VoIPé€šè¯.(3.0åŠ å…¥çš„ï¼Œä¸é€šè¯æ¨¡å¼ç±»ä¼¼) åœ¨è®¾ç½®æ’­æ”¾æ¨¡å¼çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘æµç±»å‹ï¼Œæˆ‘åœ¨è¿™é‡Œä½¿ç”¨çš„æµç±»å‹æ˜¯ STREAM_MUSIC ï¼Œæ‰€ä»¥åˆ‡æ¢æ’­æ”¾è®¾å¤‡çš„æ—¶å€™å°±éœ€è¦è®¾ç½®ä¸ºMODE_IN_COMMUNICATION æ¨¡å¼è€Œä¸æ˜¯ MODE_NORMAL æ¨¡å¼ã€‚å¯ä»¥å‚è€ƒè¿™ä¸ªé—®é¢˜ã€‚ è§£å†³é—®é¢˜ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•åˆ‡æ¢éŸ³é¢‘Audioè¾“å‡ºï¼Œå‚è€ƒAndroid : Switching audio between Bluetooth and Phone Speaker is inconsistentï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748AudioManager audioManager = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);/** * åˆ‡æ¢åˆ°å¤–æ”¾ */public void changeToSpeaker()&#123; //æ³¨æ„æ­¤å¤„ï¼Œè“ç‰™æœªæ–­å¼€æ—¶ä½¿ç”¨MODE_IN_COMMUNICATIONè€Œä¸æ˜¯MODE_NORMAL mAudioManager.setMode(bluetoothIsConnected ? AudioManager.MODE_IN_COMMUNICATION : AudioManager.MODE_NORMAL); mAudioManager.stopBluetoothSco(); mAudioManager.setBluetoothScoOn(false); mAudioManager.setSpeakerphoneOn(true);&#125;/** * åˆ‡æ¢åˆ°è“ç‰™éŸ³ç®± */public void changeToHeadset()&#123; mAudioManager.setMode(AudioManager.MODE_IN_COMMUNICATION); mAudioManager.startBluetoothSco(); mAudioManager.setBluetoothScoOn(true); mAudioManager.setSpeakerphoneOn(false);&#125;/************************************************************///æ³¨æ„ï¼šä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•è¿˜æœªéªŒè¯/************************************************************//** * åˆ‡æ¢åˆ°è€³æœºæ¨¡å¼ */public void changeToHeadset()&#123; mAudioManager.setMode(AudioManager.MODE_IN_COMMUNICATION); mAudioManager.stopBluetoothSco(); mAudioManager.setBluetoothScoOn(false); mAudioManager.setSpeakerphoneOn(false);&#125;/** * åˆ‡æ¢åˆ°å¬ç­’ */public void changeToReceiver()&#123; audioManager.setSpeakerphoneOn(false); if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB)&#123; audioManager.setMode(AudioManager.MODE_IN_COMMUNICATION); &#125; else &#123; audioManager.setMode(AudioManager.MODE_IN_CALL); &#125;&#125; ç›´æ¥åˆ‡æ¢è¾“å‡ºé€šé“çš„æ–¹æ³•æˆ‘ä»¬å·²ç»çŸ¥é“äº†ã€‚å‰©ä¸‹éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå½“è“ç‰™è®¾å¤‡æ–­å¼€ã€è¿æ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥è‡ªåŠ¨åˆ‡æ¢åˆ°ç”¨æˆ·åŸæœ¬è®¾ç½®çš„è¾“å‡ºé€šé“ä¸Šï¼Œæ¯”å¦‚åœ¨è“ç‰™æœªè¿æ¥æ—¶ï¼Œç”¨æˆ·è®¾ç½®çš„æ˜¯å¸Œæœ›é€šè¿‡è“ç‰™æ’­æŠ¥ï¼Œæ‰€ä»¥åº”è¯¥åœ¨è“ç‰™ä¸€æ—¦è¿æ¥ä»¥åï¼Œå°±æŠŠéŸ³é¢‘åˆ‡æ¢åˆ°è“ç‰™è®¾å¤‡ä¸Šã€‚ ä¸‹é¢æˆ‘ä»¬å°±çœ‹çœ‹å¦‚ä½•ç›‘å¬è“ç‰™è®¾å¤‡çš„è¿æ¥çŠ¶æ€ã€‚ ç›‘å¬è“ç‰™è¿æ¥çŠ¶æ€é¦–å…ˆæ³¨æ„ä½¿ç”¨å‰éœ€è¦ä»¥ä¸‹æƒé™ï¼š 12&lt;uses-permission android:name=\"android.permission.BLUETOOTH_ADMIN\" /&gt;&lt;uses-permission android:name=\"android.permission.BLUETOOTH\" /&gt; æ ¹æ®è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å‘ç°å¯ä»¥ä½¿ç”¨ AudioManager.ACTION_AUDIO_BECOMING_NOISY è¿™ä¸ªIntent Actionæ¥ç›‘å¬è“ç‰™æ–­å¼€ã€è€³æœºæ’æ‹”çš„å¹¿æ’­ï¼Œä½†æ˜¯æµ‹è¯•å‘ç°ï¼Œå®ƒä¹Ÿåªèƒ½æ”¶åˆ°è“ç‰™æ–­å¼€çš„å¹¿æ’­ï¼Œæ— æ³•æ¥æ”¶åˆ°è“ç‰™è¿æ¥çš„å¹¿æ’­ï¼Œæ‰€ä»¥ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ è¿›ä¸€æ­¥æ‰¾åˆ°è¿™ç¯‡æ–‡ç« ï¼šå…³äºè“ç‰™å¼€å‘ï¼Œå¿…é¡»æ³¨æ„çš„å¹¿æ’­ï¼Œæ€»ç»“äº†ä»¥ä¸‹è“ç‰™å¹¿æ’­ã€‚ 12345678910111213141516171819/** * æœ‰æ³¨é‡Šçš„å¹¿æ’­ï¼Œè“ç‰™è¿æ¥æ—¶éƒ½ä¼šç”¨åˆ° */intentFilter.addAction(BluetoothDevice.ACTION_FOUND); //æœç´¢è“å‹è®¾å¤‡ï¼Œæ¯æœåˆ°ä¸€ä¸ªè®¾å¤‡å‘é€ä¸€æ¡å¹¿æ’­intentFilter.addAction(BluetoothDevice.ACTION_BOND_STATE_CHANGED); //é…å¯¹å¼€å§‹æ—¶ï¼Œé…å¯¹æˆåŠŸæ—¶intentFilter.addAction(BluetoothDevice.ACTION_ACL_CONNECTED); //é…å¯¹æ—¶ï¼Œå‘èµ·è¿æ¥intentFilter.addAction(BluetoothDevice.ACTION_ACL_DISCONNECT_REQUESTED);intentFilter.addAction(BluetoothDevice.ACTION_ACL_DISCONNECTED); //é…å¯¹ç»“æŸæ—¶ï¼Œæ–­å¼€è¿æ¥intentFilter.addAction(PAIRING_REQUEST); //é…å¯¹è¯·æ±‚ï¼ˆAndroid.bluetooth.device.action.PAIRING_REQUESTï¼‰intentFilter.addAction(BluetoothAdapter.ACTION_DISCOVERY_STARTED); //å¼€å§‹æœç´¢intentFilter.addAction(BluetoothAdapter.ACTION_DISCOVERY_FINISHED); //æœç´¢ç»“æŸã€‚é‡æ–°æœç´¢æ—¶ï¼Œä¼šå…ˆç»ˆæ­¢æœç´¢intentFilter.addAction(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);intentFilter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED); //æœ¬æœºå¼€å¯ã€å…³é—­è“ç‰™å¼€å…³ intentFilter.addAction(BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED); //è“ç‰™è®¾å¤‡è¿æ¥æˆ–æ–­å¼€intentFilter.addAction(BluetoothAdapter.ACTION_LOCAL_NAME_CHANGED); //æ›´æ”¹è“ç‰™åç§°ï¼Œæ‰“å¼€è“ç‰™æ—¶ï¼Œå¯èƒ½ä¼šè°ƒç”¨å¤šæ¬¡intentFilter.addAction(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);intentFilter.addAction(BluetoothAdapter.ACTION_REQUEST_ENABLE);intentFilter.addAction(BluetoothAdapter.ACTION_SCAN_MODE_CHANGED); //æœç´¢æ¨¡å¼æ”¹å˜ æˆ‘ä»¬å‘ç°äº†BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED å’Œ BluetoothAdapter.ACTION_STATE_CHANGED è¿™ä¸¤ä¸ªIntentå¹¿æ’­ã€‚ é‚£ä¹ˆè¿™ä¸¤ä¸ªå¹¿æ’­Intentçš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåªç”¨å…¶ä¸­ä¸€ä¸ªå¯ä»¥å—ï¼ŸæŸ¥çœ‹Googleæ–‡æ¡£å‘ç° BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED ï¼šæŒ‡çš„æ˜¯æœ¬åœ°è“ç‰™é€‚é…å™¨çš„è¿æ¥çŠ¶æ€çš„å‘ç”Ÿæ”¹å˜ï¼ˆæ¯”å¦‚æ²¡æœ‰å…³é—­æœ¬æœºè“ç‰™å¼€å…³æ—¶ï¼Œå¦å¤–ä¸€ä¸ªé…å¯¹è®¾å¤‡è‡ªå·±æŠŠè¿æ¥æ–­å¼€ï¼‰ BluetoothAdapter.ACTION_STATE_CHANGED ï¼šæŒ‡çš„æ˜¯æœ¬åœ°è“ç‰™é€‚é…å™¨çš„çŠ¶æ€å·²æ›´æ”¹ã€‚ ä¾‹å¦‚ï¼Œè“ç‰™å¼€å…³æ‰“å¼€æˆ–å…³é—­ã€‚ æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªæ˜¯ç”¨äºè¿æ¥çŠ¶æ€çš„å˜åŒ–ï¼Œå¦ä¸€ä¸ªç”¨äºè“ç‰™é€‚é…å™¨æœ¬èº«çš„çŠ¶æ€å˜åŒ–ã€‚ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå¦‚æœåªä½¿ç”¨BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED ç›‘å¬å¹¿æ’­ï¼Œåˆ™ä¼šæ¥æ”¶ä¸åˆ°â€œä¸»åŠ¨å…³é—­æœ¬æœºè“ç‰™å¼€å…³â€çš„å¹¿æ’­äº‹ä»¶ã€‚ä½†åªæ˜¯ç”¨BluetoothAdapter.ACTION_STATE_CHANGED çš„è¯ï¼Œå¾ˆæ˜æ˜¾è¿™æ—¶å€™è“ç‰™è®¾å¤‡å¹¶æœªçœŸæ­£é…å¯¹ã€‚ åŠ¨æ€æ³¨å†Œè“ç‰™è¿æ¥ã€æ–­å¼€å¹¿æ’­çš„æ–¹å¼å¦‚ä¸‹ï¼š åŠ¨æ€æ³¨å†Œå¹¿æ’­ 123456789101112131415161718public class BluetoothConnectionReceiver extends BroadcastReceiver &#123; @Override public void onReceive(Context context, Intent intent)&#123; if (BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED.equals(intent.getAction())) &#123; //è“ç‰™è¿æ¥çŠ¶æ€ int state = intent.getIntExtra(BluetoothAdapter.EXTRA_CONNECTION_STATE, -1); if (state == BluetoothAdapter.STATE_CONNECTED || state == BluetoothAdapter.STATE_DISCONNECTED) &#123; //è¿æ¥æˆ–å¤±è”ï¼Œåˆ‡æ¢éŸ³é¢‘è¾“å‡ºï¼ˆåˆ°è“ç‰™ã€æˆ–è€…å¼ºåˆ¶ä»ç„¶æ‰¬å£°å™¨å¤–æ”¾ï¼‰ &#125; &#125; else if (BluetoothAdapter.ACTION_STATE_CHANGED.equals(intent.getAction()))&#123; //æœ¬åœ°è“ç‰™æ‰“å¼€æˆ–å…³é—­ int state = intent.getIntExtra(BluetoothAdapter.EXTRA_STATE, -1); if (state == BluetoothAdapter.STATE_OFF || state == BluetoothAdapter.STATE_TURNING_OFF) &#123; //æ–­å¼€ï¼Œåˆ‡æ¢éŸ³é¢‘è¾“å‡º &#125; &#125; &#125;&#125; 1234567BluetoothConnectionReceiver audioNoisyReceiver = new BluetoothConnectionReceiver();//è“ç‰™çŠ¶æ€å¹¿æ’­ç›‘å¬IntentFilter audioFilter = new IntentFilter();audioFilter.addAction(BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED);audioFilter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED);mContext.registerReceiver(audioNoisyReceiver, audioFilter); ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ä¸Šé¢åˆ‡æ¢éŸ³é¢‘è¾“å‡ºé€šé“çš„ä»£ç æ¥å®ç°è“ç‰™è®¾å¤‡è¿æ¥ã€æ–­å¼€ä»¥åå¼ºåˆ¶æ‰“ç ´æ“ä½œç³»ç»ŸåŸæœ‰çš„è¾“å‡ºé€šé“åˆ‡æ¢ç­–ç•¥ï¼Œæ¥å®ç°æˆ‘ä»¬è‡ªå·±æƒ³è¦çš„åˆ‡æ¢åŠŸèƒ½äº†ã€‚ å‚è€ƒèµ„æ–™ï¼š1ã€Androidä¸­çš„Audioæ’­æ”¾ï¼šæ§åˆ¶Audioè¾“å‡ºé€šé“åˆ‡æ¢ 2ã€AndroidéŸ³ä¹æ’­æ”¾æ¨¡å¼åˆ‡æ¢-å¤–æ”¾ã€å¬ç­’ã€è€³æœº3ã€Android : Switching audio between Bluetooth and Phone Speaker is inconsistent4ã€Listening to bluetooth connections","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"Audio","slug":"Audio","permalink":"http://github.com/tags/Audio/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"Google é¢è¯•é¢˜ | åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦å¯ç”±é‡å¤å­å­—ç¬¦ä¸²ç»„æˆ","slug":"Google é¢è¯•é¢˜ - åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦å¯ç”±é‡å¤å­å­—ç¬¦ä¸²ç»„æˆ","date":"2017-05-05T09:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/05/05/Google é¢è¯•é¢˜ - åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦å¯ç”±é‡å¤å­å­—ç¬¦ä¸²ç»„æˆ/","link":"","permalink":"http://github.com/2017/05/05/Google é¢è¯•é¢˜ - åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦å¯ç”±é‡å¤å­å­—ç¬¦ä¸²ç»„æˆ/","excerpt":"é¢˜ç›®æè¿°å¯¹äºä¸€ä¸ªéç©ºå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å…¶æ˜¯å¦å¯ç”±ä¸€ä¸ªå­å­—ç¬¦ä¸²é‡å¤å¤šæ¬¡ç»„æˆã€‚å­—ç¬¦ä¸²åªåŒ…å«å°å†™å­—æ¯ä¸”é•¿åº¦ä¸è¶…è¿‡10000ã€‚ æ ·ä¾‹1 è¾“å…¥ï¼š â€œababâ€ è¾“å‡ºï¼š True æ ·ä¾‹è§£é‡Šï¼š è¾“å…¥å¯ç”±â€abâ€é‡å¤ä¸¤æ¬¡ç»„æˆ æ ·ä¾‹ 2 è¾“å…¥ï¼š â€œabaâ€ è¾“å‡ºï¼š False æ ·ä¾‹ 3 è¾“å…¥ï¼š â€œabcabcabcabcâ€ è¾“å‡ºï¼š True æ ·ä¾‹è§£é‡Šï¼šè¾“å…¥å¯ç”±â€abcâ€é‡å¤å››æ¬¡ç»„æˆ","text":"é¢˜ç›®æè¿°å¯¹äºä¸€ä¸ªéç©ºå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å…¶æ˜¯å¦å¯ç”±ä¸€ä¸ªå­å­—ç¬¦ä¸²é‡å¤å¤šæ¬¡ç»„æˆã€‚å­—ç¬¦ä¸²åªåŒ…å«å°å†™å­—æ¯ä¸”é•¿åº¦ä¸è¶…è¿‡10000ã€‚ æ ·ä¾‹1 è¾“å…¥ï¼š â€œababâ€ è¾“å‡ºï¼š True æ ·ä¾‹è§£é‡Šï¼š è¾“å…¥å¯ç”±â€abâ€é‡å¤ä¸¤æ¬¡ç»„æˆ æ ·ä¾‹ 2 è¾“å…¥ï¼š â€œabaâ€ è¾“å‡ºï¼š False æ ·ä¾‹ 3 è¾“å…¥ï¼š â€œabcabcabcabcâ€ è¾“å‡ºï¼š True æ ·ä¾‹è§£é‡Šï¼šè¾“å…¥å¯ç”±â€abcâ€é‡å¤å››æ¬¡ç»„æˆ è§£é¢˜æ€è·¯1. ä¸€ä¸ªç®€å•çš„æ€è·¯æšä¸¾å­å­—ç¬¦ä¸²çš„é•¿åº¦lenSub &lt; len(lenä¸ºåŸå­—ç¬¦ä¸²é•¿åº¦)ï¼Œå°†åŸå­—ç¬¦ä¸²åˆ†æˆå¤šä¸ªå­å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­å­—ç¬¦ä¸²é•¿åº¦ä¸ºlenSubï¼ˆç”±æ­¤å¯è§ï¼ŒlenSubæ•´é™¤lenï¼‰ï¼Œå†åˆ¤æ–­è¿™äº›å­å­—ç¬¦ä¸²æ˜¯å¦å…¨éƒ¨ç›¸ç­‰ï¼Œè‹¥å…¨éƒ¨ç›¸ç­‰ï¼Œåˆ™è¿”å›Trueï¼Œå¦‚æœå¯¹äºæ‰€æœ‰lenSubå‡ä¸æ»¡è¶³è¯¥æ¡ä»¶ï¼Œåˆ™è¿”å›Falseã€‚æ—¶é—´å¤æ‚åº¦ä¸ºO(len*v(len))ï¼Œå…¶ä¸­v(len)ä¸ºlençš„å› æ•°ä¸ªæ•°ï¼ˆå› ä¸ºæˆ‘ä»¬åªéœ€è¦å¯¹æ•´é™¤lençš„lenSubè¿›è¡Œè¿›ä¸€æ­¥åˆ¤æ–­ï¼‰ã€‚ 2. ä¸‹é¢å†è¯´ä¸€ç§ç¥å¥‡çš„æ–¹æ³•ç”±kmpç®—æ³•ä¸­çš„nextæ•°ç»„å®ç°ã€‚ å­—ç¬¦ä¸²sçš„ä¸‹æ ‡ä»0åˆ°n-1ï¼Œnä¸ºå­—ç¬¦ä¸²é•¿åº¦ï¼Œè®°s(i)è¡¨ç¤ºsçš„ç¬¬iä½å­—ç¬¦ï¼Œs(i,j)è¡¨ç¤ºä»sçš„ç¬¬iä½åˆ°ç¬¬jä½çš„å­å­—ç¬¦ä¸²ï¼Œè‹¥i&gt;jï¼Œåˆ™s(i,j)=â€â€(ç©ºä¸²ï¼‰ã€‚ nextæ•°ç»„çš„å®šä¹‰ä¸ºï¼šnext(i)=pï¼Œè¡¨ç¤ºpä¸ºå°äºiä¸”æ»¡è¶³s(0 , p) = s(i-p , i)çš„æœ€å¤§çš„pï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„pï¼Œåˆ™next(i) = -1ï¼Œæ˜¾ç„¶next(0) = -1ã€‚æˆ‘ä»¬å¯ä»¥ç”¨O(n)çš„æ—¶é—´è®¡ç®—å‡ºnextæ•°ç»„ã€‚å‡è®¾æˆ‘ä»¬å·²çŸ¥next(0)ï¼Œnext(1)ï¼Œâ€¦â€¦ï¼Œnext(i-1) ï¼Œç°åœ¨è¦æ±‚next(i)ï¼Œä¸å¦¨è®¾next(i-1) = j0ï¼Œåˆ™ç”±nextæ•°ç»„å®šä¹‰å¯çŸ¥s(0 , j0) = s(i-1-j0 , i-1)ã€‚ è‹¥s(j0+1) = s(i)ï¼Œåˆ™ç»“åˆs(0 , j0) = s(i-1-j0 , i-1)å¯çŸ¥s(0 , j0+1) = s(i - (j0+1) , i)ï¼Œç”±æ­¤å¯çŸ¥ï¼Œnext(i)=j0+1ã€‚ è‹¥s(j0+1)!=s(i)ä½†s(next(j0)+1)=s(i)ï¼Œè®°j1=next(j0)ï¼Œåˆ™s(j1+1)=s(i)ï¼Œç”±nextæ•°ç»„çš„å®šä¹‰ï¼Œs(0 , j1) = s(j0 - j1 , j0) = s(i - 1 - j1 , i - 1)ï¼Œå³s(0ï¼Œj1) = s(i - 1 - j1 , i - 1)ï¼Œç”±å‡è®¾s(j1+1) = s(i)ï¼Œåˆ™s(0 , j1+1) = s(i - (j1+1) , i)ï¼Œæ•…next(i) = j1+1ã€‚ åŒå‰ä¸¤æ­¥çš„åˆ†æï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€ä¸ªkï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰å°äºkçš„k0ï¼Œs(j(k0)+1)!=s(i)ï¼Œä½†æœ‰s(j(k)+1) = s(i)ï¼Œåˆ™ç”±nextæ•°ç»„çš„å®šä¹‰å¯ä»¥å¾—åˆ°next(i)=j(k)+1ï¼Œå¦åˆ™éœ€è¿›ä¸€æ­¥è€ƒè™‘j(k+1) = next(j(k))ï¼Œå¦‚æœæˆ‘ä»¬æ‰¾ä¸åˆ°è¿™æ ·çš„kï¼Œåˆ™next(i)=-1ã€‚ å¯¹äºå­—ç¬¦ä¸²sï¼Œå¦‚æœjæ»¡è¶³ï¼Œ0&lt;=j&lt;=n-1ï¼Œä¸”s(0ï¼Œj) = s(n-1-jï¼Œn-1)ï¼Œä»¤k=n-1-jï¼Œè‹¥kæ•´é™¤nï¼Œä¸å¦¨è®¾n=mkï¼Œåˆ™s(0ï¼Œ(m-1)k - 1) = s(kï¼Œmk - 1)ï¼Œå³s(0ï¼Œk-1) = s(kï¼Œ2k-1) = â€¦â€¦ = s((m-1)k - 1ï¼Œmk - 1)ï¼Œå³sæ»¡è¶³é¢˜è®¾æ¡ä»¶ã€‚æ•…è¦åˆ¤æ–­sæ˜¯å¦ä¸ºé‡å¤å­ä¸²ç»„æˆï¼Œåªéœ€æ‰¾åˆ°æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„jï¼Œä¸”kæ•´é™¤nï¼Œå³è¯´æ˜sæ»¡è¶³æ¡ä»¶ï¼Œå¦åˆ™ä¸æ»¡è¶³ã€‚ åˆ©ç”¨å·²ç®—å‡ºçš„next(n-1)ï¼Œä»¤k=n-1-next(n-1)ï¼Œç”±cå¯çŸ¥ï¼Œè‹¥kæ•´é™¤nï¼Œä¸”k &lt; nï¼Œåˆ™sæ»¡è¶³æ¡ä»¶ï¼Œå¦åˆ™ä¸æ»¡è¶³ã€‚ä¸Šè¿°ç®—æ³•çš„å¤æ‚åº¦å¯è¯æ˜ä¸ºO(n)ã€‚ å‚è€ƒä»£ç å‚è€ƒä»£ç ç»™å‡ºäº†åˆ©ç”¨nextæ•°ç»„æ±‚è§£çš„ä»£ç ã€‚æ¥è‡ªä¹ç« ç®—æ³•ç­”æ¡ˆ 12345678910111213141516171819public class Solution &#123; public boolean repeatedSubstringPattern(String s) &#123; int l = s.length(); int[] next = new int[l]; next[0] = -1; int i, j = -1; for (i = 1; i &lt; l; i++) &#123; while (j &gt;= 0 &amp;&amp; s.charAt(i) != s.charAt(j + 1)) &#123; j = next[j]; &#125; if (s.charAt(i) == s.charAt(j + 1)) &#123; j++; &#125; next[i] = j; &#125; int lenSub = l - 1 - next[l - 1]; return lenSub != l &amp;&amp; l % lenSub ==0; &#125;&#125; é¢è¯•å®˜è§’åº¦åˆ†æè¿™é“é¢˜çš„ç¬¬ä¸€ç§è§£æ³•æ¯”è¾ƒç®€å•ï¼Œè€ƒå¯Ÿç©·ä¸¾å’Œå­—ç¬¦ä¸²å¤„ç†çš„èƒ½åŠ›ï¼Œç»™å‡ºç¬¬ä¸€ç§æ–¹æ³•å¹¶æ­£ç¡®åˆ†ææ—¶é—´å¤æ‚åº¦åŸºæœ¬å¯ä»¥è¾¾åˆ°hireï¼›å¦‚æœé¢è¯•è€…å¯¹KMPç®—æ³•æœ‰äº†è§£ï¼Œå¯ä»¥ç»™å‡ºç¬¬äºŒç§nextæ•°ç»„çš„ç®—æ³•å¯ä»¥è¾¾åˆ°strong hireã€‚ æœ¬æ–‡æ¥è‡ªä¹ç« ç®—æ³•å…¬ä¼—å· Google é¢è¯•é¢˜ | é‡å¤å­å­—ç¬¦ä¸²æ¨¡å¼","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Google","slug":"Google","permalink":"http://github.com/tags/Google/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Androidã€‘åˆ¤æ–­åº”ç”¨Applicationã€Activityæ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€","slug":"ã€Androidã€‘åˆ¤æ–­åº”ç”¨Applicationã€Activityæ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€","date":"2017-05-03T07:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/05/03/ã€Androidã€‘åˆ¤æ–­åº”ç”¨Applicationã€Activityæ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€/","link":"","permalink":"http://github.com/2017/05/03/ã€Androidã€‘åˆ¤æ–­åº”ç”¨Applicationã€Activityæ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€/","excerpt":"é€šè¿‡ActivityManageræˆ‘ä»¬å¯ä»¥è·å¾—ç³»ç»Ÿé‡Œæ­£åœ¨è¿è¡Œçš„activitiesï¼ŒåŒ…æ‹¬è¿›ç¨‹(Process)ç­‰ã€åº”ç”¨ç¨‹åº/åŒ…ã€æœåŠ¡(Service)ã€ä»»åŠ¡(Task)ä¿¡æ¯ã€‚ 1ã€åˆ¤æ–­åº”ç”¨Appæ˜¯å¦æ´»åŠ¨12345678910111213141516171819202122/** * åˆ¤æ–­åº”ç”¨æ˜¯å¦å·²ç»å¯åŠ¨ * @param context ä¸€ä¸ªcontext * @param packageName è¦åˆ¤æ–­åº”ç”¨çš„åŒ…å * @return boolean */private boolean isAppAlive(Context context, String packageName)&#123; ActivityManager activityManager = (ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE); List&lt;ActivityManager.RunningAppProcessInfo&gt; processInfos = activityManager.getRunningAppProcesses(); for(int i = 0; i &lt; processInfos.size(); i++)&#123; if(processInfos.get(i).processName.equals(packageName))&#123; Log.i(\"NotificationLaunch\", String.format(\"the %s is running, isAppAlive return true\", packageName)); return true; &#125; &#125; Log.i(\"NotificationLaunch\", String.format(\"the %s is not running, isAppAlive return false\", packageName)); return false;&#125;","text":"é€šè¿‡ActivityManageræˆ‘ä»¬å¯ä»¥è·å¾—ç³»ç»Ÿé‡Œæ­£åœ¨è¿è¡Œçš„activitiesï¼ŒåŒ…æ‹¬è¿›ç¨‹(Process)ç­‰ã€åº”ç”¨ç¨‹åº/åŒ…ã€æœåŠ¡(Service)ã€ä»»åŠ¡(Task)ä¿¡æ¯ã€‚ 1ã€åˆ¤æ–­åº”ç”¨Appæ˜¯å¦æ´»åŠ¨12345678910111213141516171819202122/** * åˆ¤æ–­åº”ç”¨æ˜¯å¦å·²ç»å¯åŠ¨ * @param context ä¸€ä¸ªcontext * @param packageName è¦åˆ¤æ–­åº”ç”¨çš„åŒ…å * @return boolean */private boolean isAppAlive(Context context, String packageName)&#123; ActivityManager activityManager = (ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE); List&lt;ActivityManager.RunningAppProcessInfo&gt; processInfos = activityManager.getRunningAppProcesses(); for(int i = 0; i &lt; processInfos.size(); i++)&#123; if(processInfos.get(i).processName.equals(packageName))&#123; Log.i(\"NotificationLaunch\", String.format(\"the %s is running, isAppAlive return true\", packageName)); return true; &#125; &#125; Log.i(\"NotificationLaunch\", String.format(\"the %s is not running, isAppAlive return false\", packageName)); return false;&#125; 2ã€åˆ¤æ–­Activityæ˜¯å¦æ´»åŠ¨123456789101112131415161718/** * åˆ¤æ–­MainActivityæ˜¯å¦æ´»åŠ¨ * @param context ä¸€ä¸ªcontext * @param activityName è¦åˆ¤æ–­Activity * @return boolean*/private boolean isMainActivityAlive(Context context, String activityName)&#123; ActivityManager am = (ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE); List&lt;ActivityManager.RunningTaskInfo&gt; list = am.getRunningTasks(100); for (ActivityManager.RunningTaskInfo info : list) &#123; // æ³¨æ„è¿™é‡Œçš„ topActivity åŒ…å« packageNameå’ŒclassNameï¼Œå¯ä»¥æ‰“å°å‡ºæ¥çœ‹çœ‹ if (info.topActivity.toString().equals(activityName) || info.baseActivity.toString().equals(activityName)) &#123; Log.i(TAG,info.topActivity.getPackageName() + \" info.baseActivity.getPackageName()=\"+info.baseActivity.getPackageName()); return true; &#125; &#125; return false;&#125; 3ã€Activityæ˜¯å¦æ˜¾ç¤ºåœ¨å‰å°123456789101112131415/** * æ£€æµ‹æŸActivityæ˜¯å¦åœ¨å½“å‰Taskçš„æ ˆé¡¶ */private boolean isTopActivity(String activityName)&#123; ActivityManager manager = (ActivityManager) mContext.getSystemService(ACTIVITY_SERVICE); List&lt;ActivityManager.RunningTaskInfo&gt; runningTaskInfos = manager.getRunningTasks(1); String cmpNameTemp = null; if(runningTaskInfos != null)&#123; cmpNameTemp = runningTaskInfos.get(0).topActivity.toString(); &#125; if(cmpNameTemp == null)&#123; return false; &#125; return cmpNameTemp.equals(activityName);&#125; 4ã€Serviceæ˜¯å¦åœ¨è¿è¡Œ123456789101112131415161718192021222324/** * ç”¨æ¥åˆ¤æ–­æœåŠ¡æ˜¯å¦è¿è¡Œ. * @param context * @param className åˆ¤æ–­çš„æœåŠ¡åå­— * @return true åœ¨è¿è¡Œ false ä¸åœ¨è¿è¡Œ */ public static boolean isServiceRunning(Context mContext,String className) &#123; boolean isRunning = false; ActivityManager activityManager = (ActivityManager) mContext.getSystemService(Context.ACTIVITY_SERVICE); //æ­¤å¤„åªåœ¨å‰30ä¸ªä¸­æŸ¥æ‰¾ï¼Œå¤§å®¶æ ¹æ®éœ€è¦è°ƒæ•´ List&lt;ActivityManager.RunningServiceInfo&gt; serviceList = activityManager.getRunningServices(30); if (!(serviceList.size()&gt;0)) &#123; return false; &#125; for (int i=0; i&lt;serviceList.size(); i++) &#123; if (serviceList.get(i).service.getClassName().equals(className) == true) &#123; isRunning = true; break; &#125; &#125; return isRunning; &#125; å‚è€ƒèµ„æ–™1ã€Androidä¸­ActivityManagerçš„ä½¿ç”¨æ¡ˆä¾‹2ã€Androidå®ç°ç‚¹å‡»é€šçŸ¥æ åï¼Œå…ˆå¯åŠ¨åº”ç”¨å†æ‰“å¼€ç›®æ ‡Activityçš„ä¸€ä¸ªå°demo3ã€Android ActivityManager æ£€æµ‹Serviceä¸Activityæ˜¯å¦æ­£åœ¨è¿è¡Œ","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘ä½¿ç”¨UncaughtExceptionHandleræ•è·å…¨å±€å¼‚å¸¸","slug":"ã€Androidã€‘ä½¿ç”¨UncaughtExceptionHandleræ•è·å…¨å±€å¼‚å¸¸","date":"2017-04-20T06:10:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/04/20/ã€Androidã€‘ä½¿ç”¨UncaughtExceptionHandleræ•è·å…¨å±€å¼‚å¸¸/","link":"","permalink":"http://github.com/2017/04/20/ã€Androidã€‘ä½¿ç”¨UncaughtExceptionHandleræ•è·å…¨å±€å¼‚å¸¸/","excerpt":"ç®€ä»‹å½“ç¨‹åºå´©æºƒï¼ˆCrashï¼‰çš„æ—¶å€™ï¼Œé»˜è®¤æ˜¯ä¸å¯¹å¼‚å¸¸ä¿¡æ¯åšå¤„ç†çš„ã€‚å¦‚æœæƒ³è¦æŠŠå¼‚å¸¸ä¿¡æ¯ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ï¼Œæˆ–ä¸Šä¼ çš„æœåŠ¡å™¨ã€‚é‚£ä¹ˆå°±è¦å€ŸåŠ©UncaughtExceptionHandlerè¿™ä¸ªç±»ã€‚","text":"ç®€ä»‹å½“ç¨‹åºå´©æºƒï¼ˆCrashï¼‰çš„æ—¶å€™ï¼Œé»˜è®¤æ˜¯ä¸å¯¹å¼‚å¸¸ä¿¡æ¯åšå¤„ç†çš„ã€‚å¦‚æœæƒ³è¦æŠŠå¼‚å¸¸ä¿¡æ¯ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ï¼Œæˆ–ä¸Šä¼ çš„æœåŠ¡å™¨ã€‚é‚£ä¹ˆå°±è¦å€ŸåŠ©UncaughtExceptionHandlerè¿™ä¸ªç±»ã€‚ ä½¿ç”¨æ–¹æ³•ä¸€ã€å®ä¾‹åŒ–1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677public class CrashLogCatch &#123; public static final String THREAD_NAME_MAIN = \"com.example.ABC\"; //ä¸»çº¿ç¨‹åç§° public static final String THREAD_NAME_REMOTE = \"com.example.ABC:remote_service\"; public static void initCrashLog(final Context context) &#123; final Thread.UncaughtExceptionHandler oriHandler = Thread.getDefaultUncaughtExceptionHandler(); Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() &#123; public void uncaughtException(Thread thread, Throwable e) &#123; try &#123; StringBuilder buffer = new StringBuilder(); buffer.append(getCurProcessName(context) + \"\\n\"); buffer.append(\"uncaught exception at \") .append(new Date(System.currentTimeMillis())) .append(\"\\n\"); buffer.append(ExceptionUtils.formatException(e)); String log = HttpLogController.getInstance().makeCrashLog(buffer.toString()); //å‘é€å´©æºƒæ—¥å¿— sendExceptionLog(log); SdLog.dFileAlways(\"crash\" + System.currentTimeMillis() + \".log\", log); if (Global.DEBUG) &#123; oriHandler.uncaughtException(thread, e); //debugæ¨¡å¼ï¼Œé»˜è®¤æŠ›å‡ºå¼‚å¸¸ &#125; else &#123; String threadName = thread.getName(); if (threadName.equals(THREAD_NAME_REMOTE)) &#123; android.os.Process.killProcess(android.os.Process.myPid()); //å¦‚æœæ˜¯serviceç›´æ¥killæ‰ &#125; else if (threadName.equals(THREAD_NAME_MAIN)) &#123; oriHandler.uncaughtException(thread, e); //å¦‚æœæ˜¯ä¸»çº¿ç¨‹ï¼ŒæŠ›å‡ºå¼‚å¸¸ &#125; &#125; &#125; catch (Exception ex) &#123;&#125; &#125; &#125;); &#125; /** * è·å–å½“å‰è¿›ç¨‹å */ private static String getCurProcessName(Context context) &#123; try &#123; int pid = android.os.Process.myPid(); ActivityManager mActivityManager = (ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE); for (ActivityManager.RunningAppProcessInfo appProcess : mActivityManager.getRunningAppProcesses()) &#123; if (appProcess.pid == pid)&#123; return appProcess.processName; &#125; &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return \"\"; &#125; /** * å‘é€å´©æºƒæ—¥å¿— */ private static void sendExceptionLog(String log) &#123; try &#123; JSONObject jsonObject = new JSONObject(log); Iterator keyIter = jsonObject.keys(); String key; Object value; HashMap&lt;String, Object&gt; valueMap = new HashMap&lt;String, Object&gt;(); while (keyIter.hasNext()) &#123; key = (String) keyIter.next(); value = jsonObject.get(key); valueMap.put(key, value); &#125; // æŠŠå¼‚å¸¸ä¿¡æ¯å‘é€åˆ°æœåŠ¡å™¨ ComponentHolder.getLogController().sendLog(valueMap, LogType.EXCEPTION); &#125; catch (JSONException e) &#123; e.printStackTrace(); &#125; &#125;&#125; äºŒã€è°ƒç”¨1ã€å¯¹äºæ•´ä¸ªApplicationåªè¦åœ¨æŒ‡å®šçš„Applicationç±»çš„onCreate()å›è°ƒä¸­ï¼ŒæŠŠUncaughtExceptionHandlerå’ŒApplicationçš„å®ä¾‹ç»‘å®šåœ¨ä¸€èµ·å°±å¯ä»¥äº†ã€‚å…³é”®ä»£ç å¦‚ä¸‹ï¼š 12345678public class MyApplication extends Application &#123; @Override public void onCreate() &#123; CrashLogCatch.initCrashLog(this); //æ³¨æ„è¿™é‡Œ super.onCreate(); &#125;&#125; è¿™æ ·ï¼Œå¦‚æœç¨‹åºå´©æºƒï¼Œé”™è¯¯æ—¥å¿—å°±ä¼šè¢«ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚ 2ã€ç»‘å®šService å®ä¾‹12345678public class MyService extends Service &#123; @Override public void onCreate() &#123; Thread.currentThread().setName(CrashLogCatch.THREAD_NAME_REMOTE); //çº¿ç¨‹åç§° CrashLogCatch.initCrashLog(this); //æ³¨æ„è¿™é‡Œ &#125;&#125; 3ã€ç»‘å®šBroadcastReceiverå®ä¾‹12345678public class LaunchReceiver extends BroadcastReceiver &#123; @Override public void onReceive(Context context, Intent intent) &#123; Thread.currentThread().setName(CrashLogCatch.THREAD_NAME_REMOTE); //çº¿ç¨‹åç§° CrashLogCatch.initCrashLog(context); //æ³¨æ„è¿™é‡Œ &#125;&#125; å‚è€ƒèµ„æ–™ ã€ç§»åŠ¨å¼€å‘ã€‘æ•è·å¼‚å¸¸ä¿¡æ¯_UncaughtExceptionHandler Androidä½¿ç”¨UncaughtExceptionHandleræ•è·å…¨å±€å¼‚å¸¸","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"Exception","slug":"Exception","permalink":"http://github.com/tags/Exception/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Android ã€‘ç¡¬ä»¶åŠ é€ŸåŸç†ä¸å®ç°ç®€ä»‹","slug":"ã€Android ã€‘ç¡¬ä»¶åŠ é€ŸåŸç†ä¸å®ç°ç®€ä»‹","date":"2017-03-30T07:29:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/03/30/ã€Android ã€‘ç¡¬ä»¶åŠ é€ŸåŸç†ä¸å®ç°ç®€ä»‹/","link":"","permalink":"http://github.com/2017/03/30/ã€Android ã€‘ç¡¬ä»¶åŠ é€ŸåŸç†ä¸å®ç°ç®€ä»‹/","excerpt":"åœ¨æ‰‹æœºå®¢æˆ·ç«¯å°¤å…¶æ˜¯Androidåº”ç”¨çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæ¥è§¦åˆ°â€œç¡¬ä»¶åŠ é€Ÿâ€è¿™ä¸ªè¯ã€‚ç”±äºæ“ä½œç³»ç»Ÿå¯¹åº•å±‚è½¯ç¡¬ä»¶å°è£…éå¸¸å®Œå–„ï¼Œä¸Šå±‚è½¯ä»¶å¼€å‘è€…å¾€å¾€å¯¹ç¡¬ä»¶åŠ é€Ÿçš„åº•å±‚åŸç†äº†è§£å¾ˆå°‘ï¼Œä¹Ÿä¸æ¸…æ¥šäº†è§£åº•å±‚åŸç†çš„æ„ä¹‰ï¼Œå› æ­¤å¸¸ä¼šæœ‰ä¸€äº›è¯¯è§£ï¼Œå¦‚ç¡¬ä»¶åŠ é€Ÿæ˜¯ä¸æ˜¯é€šè¿‡ç‰¹æ®Šç®—æ³•å®ç°é¡µé¢æ¸²æŸ“åŠ é€Ÿï¼Œæˆ–æ˜¯é€šè¿‡ç¡¬ä»¶æé«˜CPU/GPUè¿ç®—é€Ÿç‡å®ç°æ¸²æŸ“åŠ é€Ÿã€‚ æœ¬æ–‡å°è¯•ä»åº•å±‚ç¡¬ä»¶åŸç†ï¼Œä¸€ç›´åˆ°ä¸Šå±‚ä»£ç å®ç°ï¼Œå¯¹ç¡¬ä»¶åŠ é€ŸæŠ€æœ¯è¿›è¡Œç®€å•ä»‹ç»ï¼Œå…¶ä¸­ä¸Šå±‚å®ç°åŸºäºAndroid 6.0ã€‚","text":"åœ¨æ‰‹æœºå®¢æˆ·ç«¯å°¤å…¶æ˜¯Androidåº”ç”¨çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæ¥è§¦åˆ°â€œç¡¬ä»¶åŠ é€Ÿâ€è¿™ä¸ªè¯ã€‚ç”±äºæ“ä½œç³»ç»Ÿå¯¹åº•å±‚è½¯ç¡¬ä»¶å°è£…éå¸¸å®Œå–„ï¼Œä¸Šå±‚è½¯ä»¶å¼€å‘è€…å¾€å¾€å¯¹ç¡¬ä»¶åŠ é€Ÿçš„åº•å±‚åŸç†äº†è§£å¾ˆå°‘ï¼Œä¹Ÿä¸æ¸…æ¥šäº†è§£åº•å±‚åŸç†çš„æ„ä¹‰ï¼Œå› æ­¤å¸¸ä¼šæœ‰ä¸€äº›è¯¯è§£ï¼Œå¦‚ç¡¬ä»¶åŠ é€Ÿæ˜¯ä¸æ˜¯é€šè¿‡ç‰¹æ®Šç®—æ³•å®ç°é¡µé¢æ¸²æŸ“åŠ é€Ÿï¼Œæˆ–æ˜¯é€šè¿‡ç¡¬ä»¶æé«˜CPU/GPUè¿ç®—é€Ÿç‡å®ç°æ¸²æŸ“åŠ é€Ÿã€‚ æœ¬æ–‡å°è¯•ä»åº•å±‚ç¡¬ä»¶åŸç†ï¼Œä¸€ç›´åˆ°ä¸Šå±‚ä»£ç å®ç°ï¼Œå¯¹ç¡¬ä»¶åŠ é€ŸæŠ€æœ¯è¿›è¡Œç®€å•ä»‹ç»ï¼Œå…¶ä¸­ä¸Šå±‚å®ç°åŸºäºAndroid 6.0ã€‚ äº†è§£ç¡¬ä»¶åŠ é€Ÿå¯¹Appå¼€å‘çš„æ„ä¹‰å¯¹äºAppå¼€å‘è€…ï¼Œç®€å•äº†è§£ç¡¬ä»¶åŠ é€ŸåŸç†åŠä¸Šå±‚APIå®ç°ï¼Œå¼€å‘æ—¶å°±å¯ä»¥å……åˆ†åˆ©ç”¨ç¡¬ä»¶åŠ é€Ÿæé«˜é¡µé¢çš„æ€§èƒ½ã€‚ä»¥Androidä¸¾ä¾‹ï¼Œå®ç°ä¸€ä¸ªåœ†è§’çŸ©å½¢æŒ‰é’®é€šå¸¸æœ‰ä¸¤ç§æ–¹æ¡ˆï¼šä½¿ç”¨PNGå›¾ç‰‡ï¼›ä½¿ç”¨ä»£ç ï¼ˆXML/Javaï¼‰å®ç°ã€‚ç®€å•å¯¹æ¯”ä¸¤ç§æ–¹æ¡ˆå¦‚ä¸‹ã€‚ æ–¹æ¡ˆ åŸç† ç‰¹ç‚¹ ä½¿ç”¨PNGå›¾ç‰‡ï¼ˆBitmapDrawableï¼‰ è§£ç PNGå›¾ç‰‡ç”ŸæˆBitmapï¼Œä¼ åˆ°åº•å±‚ï¼Œç”±GPUæ¸²æŸ“ å›¾ç‰‡è§£ç æ¶ˆè€—CPUè¿ç®—èµ„æºï¼ŒBitmapå ç”¨å†…å­˜å¤§ï¼Œç»˜åˆ¶æ…¢ ä½¿ç”¨XMLæˆ–Javaä»£ç å®ç°ï¼ˆShapeDrawableï¼‰ ç›´æ¥å°†Shapeä¿¡æ¯ä¼ åˆ°åº•å±‚ï¼Œç”±GPUæ¸²æŸ“ æ¶ˆè€—CPUèµ„æºå°‘ï¼Œå ç”¨å†…å­˜å°ï¼Œç»˜åˆ¶å¿« é¡µé¢æ¸²æŸ“èƒŒæ™¯çŸ¥è¯† é¡µé¢æ¸²æŸ“æ—¶ï¼Œè¢«ç»˜åˆ¶çš„å…ƒç´ æœ€ç»ˆè¦è½¬æ¢æˆçŸ©é˜µåƒç´ ç‚¹ï¼ˆå³å¤šç»´æ•°ç»„å½¢å¼ï¼Œç±»ä¼¼å®‰å“ä¸­çš„Bitmapï¼‰ï¼Œæ‰èƒ½è¢«æ˜¾ç¤ºå™¨æ˜¾ç¤ºã€‚ é¡µé¢ç”±å„ç§åŸºæœ¬å…ƒç´ ç»„æˆï¼Œä¾‹å¦‚åœ†å½¢ã€åœ†è§’çŸ©å½¢ã€çº¿æ®µã€æ–‡å­—ã€çŸ¢é‡å›¾ï¼ˆå¸¸ç”¨è´å¡å°”æ›²çº¿ç»„æˆï¼‰ã€Bitmapç­‰ã€‚ å…ƒç´ ç»˜åˆ¶æ—¶å°¤å…¶æ˜¯åŠ¨ç”»ç»˜åˆ¶è¿‡ç¨‹ä¸­ï¼Œç»å¸¸æ¶‰åŠæ’å€¼ã€ç¼©æ”¾ã€æ—‹è½¬ã€é€æ˜åº¦å˜åŒ–ã€åŠ¨ç”»è¿‡æ¸¡ã€æ¯›ç»ç’ƒæ¨¡ç³Šï¼Œç”šè‡³åŒ…æ‹¬3Då˜æ¢ã€ç‰©ç†è¿åŠ¨ï¼ˆä¾‹å¦‚æ¸¸æˆä¸­å¸¸è§çš„æŠ›ç‰©çº¿è¿åŠ¨ï¼‰ã€å¤šåª’ä½“æ–‡ä»¶è§£ç ï¼ˆä¸»è¦åœ¨æ¡Œé¢æœºä¸­æœ‰åº”ç”¨ï¼Œç§»åŠ¨è®¾å¤‡ä¸€èˆ¬ä¸ç”¨GPUåšè§£ç ï¼‰ç­‰è¿ç®—ã€‚ ç»˜åˆ¶è¿‡ç¨‹ç»å¸¸éœ€è¦è¿›è¡Œé€»è¾‘è¾ƒç®€å•ã€ä½†æ•°æ®é‡åºå¤§çš„æµ®ç‚¹è¿ç®—ã€‚ CPUä¸GPUç»“æ„å¯¹æ¯”CPUï¼ˆCentral Processing Unitï¼Œä¸­å¤®å¤„ç†å™¨ï¼‰æ˜¯è®¡ç®—æœºè®¾å¤‡æ ¸å¿ƒå™¨ä»¶ï¼Œç”¨äºæ‰§è¡Œç¨‹åºä»£ç ï¼Œè½¯ä»¶å¼€å‘è€…å¯¹æ­¤éƒ½å¾ˆç†Ÿæ‚‰ï¼›GPUï¼ˆGraphics Processing Unitï¼Œå›¾å½¢å¤„ç†å™¨ï¼‰ä¸»è¦ç”¨äºå¤„ç†å›¾å½¢è¿ç®—ï¼Œé€šå¸¸æ‰€è¯´â€œæ˜¾å¡â€çš„æ ¸å¿ƒéƒ¨ä»¶å°±æ˜¯GPUã€‚ ä¸‹é¢æ˜¯CPUå’ŒGPUçš„ç»“æ„å¯¹æ¯”å›¾ã€‚å…¶ä¸­ï¼š é»„è‰²çš„Controlä¸ºæ§åˆ¶å™¨ï¼Œç”¨äºåè°ƒæ§åˆ¶æ•´ä¸ªCPUçš„è¿è¡Œï¼ŒåŒ…æ‹¬å–å‡ºæŒ‡ä»¤ã€æ§åˆ¶å…¶ä»–æ¨¡å—çš„è¿è¡Œç­‰ï¼› ç»¿è‰²çš„ALUï¼ˆArithmetic Logic Unitï¼‰æ˜¯ç®—æœ¯é€»è¾‘å•å…ƒï¼Œç”¨äºè¿›è¡Œæ•°å­¦ã€é€»è¾‘è¿ç®—ï¼› æ©™è‰²çš„Cacheå’ŒDRAMåˆ†åˆ«ä¸ºç¼“å­˜å’ŒRAMï¼Œç”¨äºå­˜å‚¨ä¿¡æ¯ã€‚ ä»ç»“æ„å›¾å¯ä»¥çœ‹å‡ºï¼ŒCPUçš„æ§åˆ¶å™¨è¾ƒä¸ºå¤æ‚ï¼Œè€ŒALUæ•°é‡è¾ƒå°‘ã€‚å› æ­¤CPUæ“…é•¿å„ç§å¤æ‚çš„é€»è¾‘è¿ç®—ï¼Œä½†ä¸æ“…é•¿æ•°å­¦å°¤å…¶æ˜¯æµ®ç‚¹è¿ç®—ã€‚ ä»¥8086ä¸ºä¾‹ï¼Œä¸€ç™¾å¤šæ¡æ±‡ç¼–æŒ‡ä»¤å¤§éƒ¨åˆ†éƒ½æ˜¯é€»è¾‘æŒ‡ä»¤ï¼Œæ•°å­¦è®¡ç®—ç›¸å…³çš„ä¸»è¦æ˜¯16ä½åŠ å‡ä¹˜é™¤å’Œç§»ä½è¿ç®—ã€‚ä¸€æ¬¡æ•´å‹å’Œé€»è¾‘è¿ç®—ä¸€èˆ¬éœ€è¦1~3ä¸ªæœºå™¨å‘¨æœŸï¼Œè€Œæµ®ç‚¹è¿ç®—è¦è½¬æ¢æˆæ•´æ•°è®¡ç®—ï¼Œä¸€æ¬¡è¿ç®—å¯èƒ½æ¶ˆè€—ä¸Šç™¾ä¸ªæœºå™¨å‘¨æœŸã€‚ æ›´ç®€å•çš„CPUç”šè‡³åªæœ‰åŠ æ³•æŒ‡ä»¤ï¼Œå‡æ³•ç”¨è¡¥ç åŠ æ³•å®ç°ï¼Œä¹˜æ³•ç”¨ç´¯åŠ å®ç°ï¼Œé™¤æ³•ç”¨å‡æ³•å¾ªç¯å®ç°ã€‚ ç°ä»£CPUä¸€èˆ¬éƒ½å¸¦æœ‰ç¡¬ä»¶æµ®ç‚¹è¿ç®—å™¨ï¼ˆFPUï¼‰ï¼Œä½†ä¸»è¦é€‚ç”¨äºæ•°æ®é‡ä¸å¤§çš„æƒ…å†µã€‚ CPUæ˜¯ä¸²è¡Œç»“æ„ã€‚ä»¥è®¡ç®—100ä¸ªæ•°å­—ä¸ºä¾‹ï¼Œå¯¹äºCPUçš„ä¸€ä¸ªæ ¸ï¼Œæ¯æ¬¡åªèƒ½è®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œï¼Œç»“æœé€æ­¥ç´¯åŠ ã€‚ å’ŒCPUä¸åŒçš„æ˜¯ï¼ŒGPUå°±æ˜¯ä¸ºå®ç°å¤§é‡æ•°å­¦è¿ç®—è®¾è®¡çš„ã€‚ä»ç»“æ„å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒGPUçš„æ§åˆ¶å™¨æ¯”è¾ƒç®€å•ï¼Œä½†åŒ…å«äº†å¤§é‡ALUã€‚GPUä¸­çš„ALUä½¿ç”¨äº†å¹¶è¡Œè®¾è®¡ï¼Œä¸”å…·æœ‰è¾ƒå¤šæµ®ç‚¹è¿ç®—å•å…ƒã€‚ ç¡¬ä»¶åŠ é€Ÿçš„ä¸»è¦åŸç†ï¼Œå°±æ˜¯é€šè¿‡åº•å±‚è½¯ä»¶ä»£ç ï¼Œå°†CPUä¸æ“…é•¿çš„å›¾å½¢è®¡ç®—è½¬æ¢æˆGPUä¸“ç”¨æŒ‡ä»¤ï¼Œç”±GPUå®Œæˆã€‚ â€‹ æ‰©å±•ï¼šå¾ˆå¤šè®¡ç®—æœºä¸­çš„GPUæœ‰è‡ªå·±ç‹¬ç«‹çš„æ˜¾å­˜ï¼›æ²¡æœ‰ç‹¬ç«‹æ˜¾å­˜åˆ™ä½¿ç”¨å…±äº«å†…å­˜çš„å½¢å¼ï¼Œä»å†…å­˜ä¸­åˆ’åˆ†ä¸€å—åŒºåŸŸä½œä¸ºæ˜¾å­˜ã€‚æ˜¾å­˜å¯ä»¥ä¿å­˜GPUæŒ‡ä»¤ç­‰ä¿¡æ¯ã€‚ å¹¶è¡Œç»“æ„ä¸¾ä¾‹ï¼šçº§è”åŠ æ³•å™¨ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œè¿™é‡Œå…ˆä»åº•å±‚ç”µè·¯ç»“æ„çš„è§’åº¦ä¸¾ä¸€ä¸ªä¾‹å­ã€‚å¦‚ä¸‹å›¾ä¸ºä¸€ä¸ªåŠ æ³•å™¨ï¼Œå¯¹åº”å®é™…çš„æ•°å­—ç”µè·¯ç»“æ„ã€‚ Aã€Bä¸ºè¾“å…¥ï¼ŒCä¸ºè¾“å‡ºï¼Œä¸”Aã€Bã€Cå‡ä¸ºæ€»çº¿ï¼Œä»¥32ä½CPUä¸ºä¾‹ï¼Œåˆ™æ¯æ ¹æ€»çº¿å®é™…ç”±32æ ¹å¯¼çº¿ç»„æˆï¼Œæ¯æ ¹å¯¼çº¿ç”¨ä¸åŒçš„ç”µå‹è¡¨ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶çš„0æˆ–1ã€‚ Clockä¸ºæ—¶é’Ÿä¿¡å·çº¿ï¼Œæ¯ä¸ªå›ºå®šçš„æ—¶é’Ÿå‘¨æœŸå¯å‘å…¶è¾“å…¥ä¸€ä¸ªç‰¹å®šçš„ç”µå‹ä¿¡å·ï¼Œæ¯å½“ä¸€ä¸ªæ—¶é’Ÿä¿¡å·åˆ°æ¥æ—¶ï¼ŒAå’ŒBçš„å’Œå°±ä¼šè¾“å‡ºåˆ°Cã€‚ ç°åœ¨æˆ‘ä»¬è¦è®¡ç®—8ä¸ªæ•´æ•°çš„å’Œã€‚ å¯¹äºCPUè¿™ç§ä¸²è¡Œç»“æ„ï¼Œä»£ç ç¼–å†™å¾ˆç®€å•ï¼Œç”¨forå¾ªç¯æŠŠæ‰€æœ‰æ•°å­—é€ä¸ªç›¸åŠ å³å¯ã€‚ä¸²è¡Œç»“æ„åªæœ‰ä¸€ä¸ªåŠ æ³•å™¨ï¼Œéœ€è¦7æ¬¡æ±‚å’Œè¿ç®—ï¼›æ¯æ¬¡è®¡ç®—å®Œéƒ¨åˆ†å’Œï¼Œè¿˜è¦å°†å…¶å†è½¬ç§»åˆ°åŠ æ³•å™¨çš„è¾“å…¥ç«¯ï¼Œåšä¸‹ä¸€æ¬¡è®¡ç®—ã€‚æ•´ä¸ªè¿‡ç¨‹è‡³å°‘è¦æ¶ˆè€—åå‡ ä¸ªæœºå™¨å‘¨æœŸã€‚ è€Œå¯¹äºå¹¶è¡Œç»“æ„ï¼Œä¸€ç§å¸¸è§çš„è®¾è®¡æ˜¯çº§è”åŠ æ³•å™¨ï¼Œå¦‚ä¸‹å›¾ï¼Œå…¶ä¸­æ‰€æœ‰çš„clockè¿åœ¨ä¸€èµ·ã€‚å½“éœ€è¦ç›¸åŠ çš„8ä¸ªæ•°æ®åœ¨è¾“å…¥ç«¯A1~B4å‡†å¤‡å¥½åï¼Œç»è¿‡ä¸‰ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œæ±‚å’Œæ“ä½œå°±å®Œæˆäº†ã€‚å¦‚æœæ•°æ®é‡æ›´å¤§ã€çº§è”çš„å±‚çº§æ›´å¤§ï¼Œåˆ™å¹¶è¡Œç»“æ„çš„ä¼˜åŠ¿æ›´æ˜æ˜¾ã€‚ ç”±äºç”µè·¯çš„é™åˆ¶ï¼Œä¸å®¹æ˜“é€šè¿‡æé«˜æ—¶é’Ÿé¢‘ç‡ã€å‡å°æ—¶é’Ÿå‘¨æœŸçš„æ–¹å¼æé«˜è¿ç®—é€Ÿåº¦ã€‚å¹¶è¡Œç»“æ„é€šè¿‡å¢åŠ ç”µè·¯è§„æ¨¡ã€å¹¶è¡Œå¤„ç†ï¼Œæ¥å®ç°æ›´å¿«çš„è¿ç®—ã€‚ä½†å¹¶è¡Œç»“æ„ä¸å®¹æ˜“å®ç°å¤æ‚é€»è¾‘ï¼Œå› ä¸ºåŒæ—¶è€ƒè™‘å¤šä¸ªæ”¯è·¯çš„è¾“å‡ºç»“æœï¼Œå¹¶åè°ƒåŒæ­¥å¤„ç†çš„è¿‡ç¨‹å¾ˆå¤æ‚ï¼ˆæœ‰ç‚¹åƒå¤šçº¿ç¨‹ç¼–ç¨‹ï¼‰ã€‚ GPUå¹¶è¡Œè®¡ç®—ä¸¾ä¾‹å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹å›¾åƒå¤„ç†ä»»åŠ¡ï¼Œç»™æ¯ä¸ªåƒç´ å€¼åŠ 1ã€‚GPUå¹¶è¡Œè®¡ç®—çš„æ–¹å¼ç®€å•ç²—æš´ï¼Œåœ¨èµ„æºå…è®¸çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªåƒç´ å¼€ä¸€ä¸ªGPUçº¿ç¨‹ï¼Œç”±å…¶è¿›è¡ŒåŠ 1æ“ä½œã€‚æ•°å­¦è¿ç®—é‡è¶Šå¤§ï¼Œè¿™ç§å¹¶è¡Œæ–¹å¼æ€§èƒ½ä¼˜åŠ¿è¶Šæ˜æ˜¾ã€‚ Androidä¸­çš„ç¡¬ä»¶åŠ é€Ÿåœ¨Androidä¸­ï¼Œå¤§å¤šæ•°åº”ç”¨çš„ç•Œé¢éƒ½æ˜¯åˆ©ç”¨å¸¸è§„çš„Viewæ¥æ„å»ºçš„ï¼ˆé™¤äº†æ¸¸æˆã€è§†é¢‘ã€å›¾åƒç­‰åº”ç”¨å¯èƒ½ç›´æ¥ä½¿ç”¨OpenGL ESï¼‰ã€‚ä¸‹é¢æ ¹æ®Android 6.0åŸç”Ÿç³»ç»Ÿçš„Javaå±‚ä»£ç ï¼Œå¯¹Viewçš„è½¯ä»¶å’Œç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“åšä¸€äº›åˆ†æå’Œå¯¹æ¯”ã€‚ DisplayListDisplayListæ˜¯ä¸€ä¸ªåŸºæœ¬ç»˜åˆ¶å…ƒç´ ï¼ŒåŒ…å«å…ƒç´ åŸå§‹å±æ€§ï¼ˆä½ç½®ã€å°ºå¯¸ã€è§’åº¦ã€é€æ˜åº¦ç­‰ï¼‰ï¼Œå¯¹åº”Canvasçš„drawXxx()æ–¹æ³•ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚ ä¿¡æ¯ä¼ é€’æµç¨‹ï¼šCanvas(Java API) â€”&gt; OpenGL(C/C++ Lib) â€”&gt; é©±åŠ¨ç¨‹åº â€”&gt; GPUã€‚ åœ¨Android 4.1åŠä»¥ä¸Šç‰ˆæœ¬ï¼ŒDisplayListæ”¯æŒå±æ€§ï¼Œå¦‚æœViewçš„ä¸€äº›å±æ€§å‘ç”Ÿå˜åŒ–ï¼ˆæ¯”å¦‚Scaleã€Alphaã€Translateï¼‰ï¼Œåªéœ€æŠŠå±æ€§æ›´æ–°ç»™GPUï¼Œä¸éœ€è¦ç”Ÿæˆæ–°çš„DisplayListã€‚ RenderNodeä¸€ä¸ªRenderNodeåŒ…å«è‹¥å¹²ä¸ªDisplayListï¼Œé€šå¸¸ä¸€ä¸ªRenderNodeå¯¹åº”ä¸€ä¸ªViewï¼ŒåŒ…å«Viewè‡ªèº«åŠå…¶å­Viewçš„æ‰€æœ‰DisplayListã€‚ Androidç»˜åˆ¶æµç¨‹ï¼ˆAndroid 6.0ï¼‰ä¸‹é¢æ˜¯å®‰å“Viewå®Œæ•´çš„ç»˜åˆ¶æµç¨‹å›¾ï¼Œä¸»è¦é€šè¿‡é˜…è¯»æºç å’Œè°ƒè¯•å¾—å‡ºï¼Œè™šçº¿ç®­å¤´è¡¨ç¤ºé€’å½’è°ƒç”¨ã€‚ ä»ViewRootImpl.performTraversalsåˆ°PhoneWindow.DecroView.drawChildæ˜¯æ¯æ¬¡éå†Viewæ ‘çš„å›ºå®šæµç¨‹ï¼Œé¦–å…ˆæ ¹æ®æ ‡å¿—ä½åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°å¸ƒå±€å¹¶æ‰§è¡Œå¸ƒå±€ï¼›ç„¶åè¿›è¡ŒCanvasçš„åˆ›å»ºç­‰æ“ä½œå¼€å§‹ç»˜åˆ¶ã€‚ å¦‚æœç¡¬ä»¶åŠ é€Ÿä¸æ”¯æŒæˆ–è€…è¢«å…³é—­ï¼Œåˆ™ä½¿ç”¨è½¯ä»¶ç»˜åˆ¶ï¼Œç”Ÿæˆçš„Canvaså³Canvas.classçš„å¯¹è±¡ï¼› å¦‚æœæ”¯æŒç¡¬ä»¶åŠ é€Ÿï¼Œåˆ™ç”Ÿæˆçš„æ˜¯DisplayListCanvas.classçš„å¯¹è±¡ï¼› ä¸¤è€…çš„isHardwareAccelerated()æ–¹æ³•è¿”å›çš„å€¼åˆ†åˆ«ä¸ºfalseã€trueï¼ŒViewæ ¹æ®è¿™ä¸ªå€¼åˆ¤æ–­æ˜¯å¦ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿã€‚ Viewä¸­çš„draw(canvas,parent,drawingTime) - draw(canvas) - onDraw - dispachDraw - drawChildè¿™æ¡é€’å½’è·¯å¾„ï¼ˆä¸‹æ–‡ç®€ç§°Drawè·¯å¾„ï¼‰ï¼Œè°ƒç”¨äº†Canvas.drawXxx()æ–¹æ³•ï¼Œåœ¨è½¯ä»¶æ¸²æŸ“æ—¶ç”¨äºå®é™…ç»˜åˆ¶ï¼›åœ¨ç¡¬ä»¶åŠ é€Ÿæ—¶ï¼Œç”¨äºæ„å»ºDisplayListã€‚ Viewä¸­çš„updateDisplayListIfDirty - dispatchGetDisplayList - recreateChildDisplayListè¿™æ¡é€’å½’è·¯å¾„ï¼ˆä¸‹æ–‡ç®€ç§°DisplayListè·¯å¾„ï¼‰ï¼Œä»…åœ¨ç¡¬ä»¶åŠ é€Ÿæ—¶ä¼šç»è¿‡ï¼Œç”¨äºåœ¨éå†Viewæ ‘ç»˜åˆ¶çš„è¿‡ç¨‹ä¸­æ›´æ–°DisplayListå±æ€§ï¼Œå¹¶å¿«é€Ÿè·³è¿‡ä¸éœ€è¦é‡å»ºDisplayListçš„Viewã€‚ Android 6.0ä¸­ï¼Œå’ŒDisplayListç›¸å…³çš„APIç›®å‰ä»è¢«æ ‡è®°ä¸ºâ€œ@hideâ€ä¸å¯è®¿é—®ï¼Œè¡¨ç¤ºè¿˜ä¸æˆç†Ÿï¼Œåç»­ç‰ˆæœ¬å¯èƒ½å¼€æ”¾ã€‚ ç¡¬ä»¶åŠ é€Ÿæƒ…å†µä¸‹ï¼Œdrawæµç¨‹æ‰§è¡Œç»“æŸåDisplayListæ„å»ºå®Œæˆï¼Œç„¶åé€šè¿‡ThreadedRenderer.nSyncAndDrawFrame()åˆ©ç”¨GPUç»˜åˆ¶DisplayListåˆ°å±å¹•ä¸Šã€‚ çº¯è½¯ä»¶ç»˜åˆ¶ VS ç¡¬ä»¶åŠ é€Ÿï¼ˆAndroid 6.0ï¼‰ä¸‹é¢æ ¹æ®å…·ä½“çš„å‡ ç§åœºæ™¯ï¼Œå…·ä½“åˆ†æä¸€ä¸‹ç¡¬ä»¶åŠ é€Ÿå‰åçš„æµç¨‹ä¸åŠ é€Ÿæ•ˆæœã€‚ æ¸²æŸ“åœºæ™¯ çº¯è½¯ä»¶ç»˜åˆ¶ ç¡¬ä»¶åŠ é€Ÿ åŠ é€Ÿæ•ˆæœåˆ†æ é¡µé¢åˆå§‹åŒ– ç»˜åˆ¶æ‰€æœ‰View åˆ›å»ºæ‰€æœ‰DisplayList GPUåˆ†æ‹…äº†å¤æ‚è®¡ç®—ä»»åŠ¡ åœ¨ä¸€ä¸ªå¤æ‚é¡µé¢è°ƒç”¨èƒŒæ™¯é€æ˜TextViewçš„setText()ï¼Œä¸”è°ƒç”¨åå…¶å°ºå¯¸ä½ç½®ä¸å˜ é‡ç»˜è„åŒºæ‰€æœ‰View TextViewåŠæ¯ä¸€çº§çˆ¶Viewé‡å»ºDisplayList é‡å çš„å…„å¼ŸèŠ‚ç‚¹ä¸éœ€CPUé‡ç»˜ï¼ŒGPUä¼šè‡ªè¡Œå¤„ç† TextViewé€å¸§æ’­æ”¾Alpha / Translation / ScaleåŠ¨ç”» æ¯å¸§éƒ½è¦é‡ç»˜è„åŒºæ‰€æœ‰View é™¤ç¬¬ä¸€å¸§åŒåœºæ™¯2ï¼Œä¹‹åæ¯å¸§åªæ›´æ–°TextViewå¯¹åº”RenderNodeçš„å±æ€§ åˆ·æ–°ä¸€å¸§æ€§èƒ½æå¤§æé«˜ï¼ŒåŠ¨ç”»æµç•…åº¦æé«˜ ä¿®æ”¹TextViewé€æ˜åº¦ é‡ç»˜è„åŒºæ‰€æœ‰View ç›´æ¥è°ƒç”¨RenderNode.setAlpha()æ›´æ–° åŠ é€Ÿå‰éœ€å…¨é¡µé¢éå†ï¼Œå¹¶é‡ç»˜å¾ˆå¤šViewï¼›åŠ é€Ÿååªè§¦å‘DecorView.updateDisplayListIfDirtyï¼Œä¸å†å¾€ä¸‹éå†ï¼ŒCPUæ‰§è¡Œæ—¶é—´å¯å¿½ç•¥ä¸è®¡ åœºæ™¯1ä¸­ï¼Œæ— è®ºæ˜¯å¦åŠ é€Ÿï¼Œéå†Viewæ ‘å¹¶éƒ½ä¼šèµ°Drawè·¯å¾„ã€‚ç¡¬ä»¶åŠ é€ŸåDrawè·¯å¾„ä¸åšå®é™…ç»˜åˆ¶å·¥ä½œï¼Œåªæ˜¯æ„å»ºDisplayListï¼Œå¤æ‚çš„ç»˜åˆ¶è®¡ç®—ä»»åŠ¡è¢«GPUåˆ†æ‹…ï¼Œå·²ç»æœ‰äº†è¾ƒå¤§çš„åŠ é€Ÿæ•ˆæœã€‚ åœºæ™¯2ä¸­ï¼ŒTextViewè®¾ç½®å‰åå°ºå¯¸ä½ç½®ä¸å˜ï¼Œä¸ä¼šè§¦å‘é‡æ–°Layoutã€‚ è½¯ä»¶ç»˜åˆ¶æ—¶ï¼ŒTextViewæ‰€åœ¨åŒºåŸŸå³ä¸ºè„åŒºã€‚ç”±äºTextViewæœ‰é€æ˜åŒºåŸŸï¼Œéå†Viewæ ‘çš„è¿‡ç¨‹ä¸­ï¼Œå’Œè„åŒºé‡å çš„å¤šæ•°Viewéƒ½è¦é‡ç»˜ï¼ŒåŒ…æ‹¬ä¸ä¹‹é‡å çš„å…„å¼ŸèŠ‚ç‚¹å’Œä»–ä»¬çš„çˆ¶èŠ‚ç‚¹ï¼ˆè¯¦è§åé¢çš„ä»‹ç»ï¼‰ï¼Œä¸éœ€è¦ç»˜åˆ¶çš„Viewåœ¨draw(canvas,parent,drawingTime)æ–¹æ³•ä¸­åˆ¤æ–­ç›´æ¥è¿”å›ã€‚ ç¡¬ä»¶åŠ é€Ÿåï¼Œä¹Ÿéœ€è¦éå†Viewæ ‘ï¼Œä½†åªæœ‰TextViewåŠå…¶æ¯ä¸€å±‚çˆ¶èŠ‚ç‚¹éœ€è¦é‡å»ºDisplayListï¼Œèµ°çš„æ˜¯Drawè·¯å¾„ï¼Œå…¶ä»–Viewç›´æ¥èµ°äº†DisplayListè·¯å¾„ï¼Œå‰©ä¸‹çš„å·¥ä½œéƒ½äº¤ç»™GPUå¤„ç†ã€‚é¡µé¢è¶Šå¤æ‚ï¼Œä¸¤è€…æ€§èƒ½å·®è·è¶Šæ˜æ˜¾ã€‚ åœºæ™¯3ä¸­ï¼Œè½¯ä»¶ç»˜åˆ¶æ¯ä¸€å¸§éƒ½è¦åšå¤§é‡ç»˜åˆ¶å·¥ä½œï¼Œå¾ˆå®¹æ˜“å¯¼è‡´åŠ¨ç”»å¡é¡¿ã€‚ç¡¬ä»¶åŠ é€Ÿåï¼ŒåŠ¨ç”»è¿‡ç¨‹ç›´æ¥èµ°DisplayListè·¯å¾„æ›´æ–°DisplayListçš„å±æ€§ï¼ŒåŠ¨ç”»æµç•…åº¦èƒ½å¾—åˆ°æå¤§æé«˜ã€‚ åœºæ™¯4ä¸­ï¼Œä¸¤è€…çš„æ€§èƒ½å·®è·æ›´æ˜æ˜¾ã€‚ç®€å•ä¿®æ”¹é€æ˜åº¦ï¼Œè½¯ä»¶ç»˜åˆ¶ä»ç„¶è¦åšå¾ˆå¤šå·¥ä½œï¼›ç¡¬ä»¶åŠ é€Ÿåä¸€èˆ¬ç›´æ¥æ›´æ–°RenderNodeçš„å±æ€§ï¼Œä¸éœ€è¦è§¦å‘invalidateï¼Œä¹Ÿä¸ä¼šéå†Viewæ ‘ï¼ˆé™¤äº†å°‘æ•°Viewå¯èƒ½è¦å¯¹Alphaåšç‰¹æ®Šå“åº”å¹¶åœ¨onSetAlpha()è¿”å›trueï¼Œä»£ç å¦‚ä¸‹ï¼‰ã€‚ 12345678910111213141516171819202122public class View &#123; // ... public void setAlpha(@FloatRange(from=0.0, to=1.0) float alpha) &#123; ensureTransformationInfo(); if (mTransformationInfo.mAlpha != alpha) &#123; mTransformationInfo.mAlpha = alpha; if (onSetAlpha((int) (alpha * 255))) &#123; // ... invalidate(true); &#125; else &#123; // ... mRenderNode.setAlpha(getFinalAlpha()); // ... &#125; &#125; &#125; protected boolean onSetAlpha(int alpha) &#123; return false; &#125; // ...&#125; è½¯ä»¶ç»˜åˆ¶åˆ·æ–°é€»è¾‘ç®€ä»‹å®é™…é˜…è¯»æºç å¹¶å®éªŒï¼Œå¾—å‡ºé€šå¸¸æƒ…å†µä¸‹çš„è½¯ä»¶ç»˜åˆ¶åˆ·æ–°é€»è¾‘ï¼š é»˜è®¤æƒ…å†µä¸‹ï¼ŒViewçš„clipChildrenå±æ€§ä¸ºtrueï¼Œå³æ¯ä¸ªViewç»˜åˆ¶åŒºåŸŸä¸èƒ½è¶…å‡ºå…¶çˆ¶Viewçš„èŒƒå›´ã€‚å¦‚æœè®¾ç½®ä¸€ä¸ªé¡µé¢æ ¹å¸ƒå±€çš„clipChildrenå±æ€§ä¸ºfalseï¼Œåˆ™å­Viewå¯ä»¥è¶…å‡ºçˆ¶Viewçš„ç»˜åˆ¶åŒºåŸŸã€‚ å½“ä¸€ä¸ªViewè§¦å‘invalidateï¼Œä¸”æ²¡æœ‰æ’­æ”¾åŠ¨ç”»ã€æ²¡æœ‰è§¦å‘layoutçš„æƒ…å†µä¸‹ï¼š å¯¹äºå…¨ä¸é€æ˜çš„Viewï¼Œå…¶è‡ªèº«ä¼šè®¾ç½®æ ‡å¿—ä½PFLAG_DIRTYï¼Œå…¶çˆ¶Viewä¼šè®¾ç½®æ ‡å¿—ä½PFLAG_DIRTY_OPAQUEã€‚åœ¨draw(canvas)æ–¹æ³•ä¸­ï¼Œåªæœ‰è¿™ä¸ªViewè‡ªèº«é‡ç»˜ã€‚ å¯¹äºå¯èƒ½æœ‰é€æ˜åŒºåŸŸçš„Viewï¼Œå…¶è‡ªèº«å’Œçˆ¶Viewéƒ½ä¼šè®¾ç½®æ ‡å¿—ä½PFLAG_DIRTYã€‚ clipChildrenä¸ºtrueæ—¶ï¼Œè„åŒºä¼šè¢«è½¬æ¢æˆViewRootä¸­çš„Rectï¼Œåˆ·æ–°æ—¶å±‚å±‚å‘ä¸‹åˆ¤æ–­ï¼Œå½“Viewä¸è„åŒºæœ‰é‡å åˆ™é‡ç»˜ã€‚å¦‚æœä¸€ä¸ªViewè¶…å‡ºçˆ¶ViewèŒƒå›´ä¸”ä¸è„åŒºé‡å ï¼Œä½†å…¶çˆ¶Viewä¸ä¸è„åŒºé‡å ï¼Œè¿™ä¸ªå­Viewä¸ä¼šé‡ç»˜ã€‚ clipChildrenä¸ºfalseæ—¶ï¼ŒViewGroup.invalidateChildInParent()ä¸­ä¼šæŠŠè„åŒºæ‰©å¤§åˆ°è‡ªèº«æ•´ä¸ªåŒºåŸŸï¼Œäºæ˜¯ä¸è¿™ä¸ªåŒºåŸŸé‡å çš„æ‰€æœ‰Viewéƒ½ä¼šé‡ç»˜ã€‚ æ€»ç»“è‡³æ­¤ï¼Œç¡¬ä»¶åŠ é€Ÿç›¸å…³çš„å†…å®¹å°±ä»‹ç»å®Œäº†ï¼Œè¿™é‡Œåšä¸ªç®€å•æ€»ç»“ï¼š CPUæ›´æ“…é•¿å¤æ‚é€»è¾‘æ§åˆ¶ï¼Œè€ŒGPUå¾—ç›Šäºå¤§é‡ALUå’Œå¹¶è¡Œç»“æ„è®¾è®¡ï¼Œæ›´æ“…é•¿æ•°å­¦è¿ç®—ã€‚ é¡µé¢ç”±å„ç§åŸºç¡€å…ƒç´ ï¼ˆDisplayListï¼‰æ„æˆï¼Œæ¸²æŸ“æ—¶éœ€è¦è¿›è¡Œå¤§é‡æµ®ç‚¹è¿ç®—ã€‚ ç¡¬ä»¶åŠ é€Ÿæ¡ä»¶ä¸‹ï¼ŒCPUç”¨äºæ§åˆ¶å¤æ‚ç»˜åˆ¶é€»è¾‘ã€æ„å»ºæˆ–æ›´æ–°DisplayListï¼›GPUç”¨äºå®Œæˆå›¾å½¢è®¡ç®—ã€æ¸²æŸ“DisplayListã€‚ ç¡¬ä»¶åŠ é€Ÿæ¡ä»¶ä¸‹ï¼Œåˆ·æ–°ç•Œé¢å°¤å…¶æ˜¯æ’­æ”¾åŠ¨ç”»æ—¶ï¼ŒCPUåªé‡å»ºæˆ–æ›´æ–°å¿…è¦çš„DisplayListï¼Œè¿›ä¸€æ­¥æé«˜æ¸²æŸ“æ•ˆç‡ã€‚ å®ç°åŒæ ·æ•ˆæœï¼Œåº”å°½é‡ä½¿ç”¨æ›´ç®€å•çš„DisplayListï¼Œä»è€Œè¾¾åˆ°æ›´å¥½çš„æ€§èƒ½ï¼ˆShapeä»£æ›¿Bitmapç­‰ï¼‰ã€‚ å‚è€ƒèµ„æ–™ GPUâ€”å¹¶è¡Œè®¡ç®—åˆ©å™¨ æ˜¾ç¤ºå¡çš„â€œå¿ƒè„â€GPUå·¥ä½œåŸç†ä»‹ç» Matlabçš„GPUåŠ é€Ÿ å¤„ç†å™¨ä½“ç³»ç»“æ„ï¼šäº†è§£CPUçš„åŸºæœ¬è¿è¡ŒåŸç† CPUçš„å†…éƒ¨æ¶æ„å’Œå·¥ä½œåŸç† ä»€ä¹ˆæ˜¯å¼‚æ„å¤šå¤„ç†ç³»ç»Ÿï¼Œä¸ºä»€ä¹ˆéœ€è¦å¼‚æ„å¤šå¤„ç†ç³»ç»Ÿ Androidåº”ç”¨ç¨‹åºUIç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“çš„Display Listæ„å»ºè¿‡ç¨‹åˆ†æ Androidåº”ç”¨ç¨‹åºUIç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“çš„Display Listæ¸²æŸ“è¿‡ç¨‹åˆ†æ Android Choreographeræºç åˆ†æ Android Project Butteråˆ†æ æœ¬æ–‡æ¥è‡ªç¾å›¢ç‚¹è¯„æŠ€æœ¯å›¢é˜Ÿï¼šAndroidç¡¬ä»¶åŠ é€ŸåŸç†ä¸å®ç°ç®€ä»‹","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"},{"name":"GPU","slug":"GPU","permalink":"http://github.com/tags/GPU/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Gradleã€‘Android Studioä¸­Gradleé‡å¤ä¾èµ–çš„é—®é¢˜","slug":"ã€Gradleã€‘Android Studioä¸­Gradleé‡å¤ä¾èµ–çš„é—®é¢˜","date":"2017-02-23T05:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/02/23/ã€Gradleã€‘Android Studioä¸­Gradleé‡å¤ä¾èµ–çš„é—®é¢˜/","link":"","permalink":"http://github.com/2017/02/23/ã€Gradleã€‘Android Studioä¸­Gradleé‡å¤ä¾èµ–çš„é—®é¢˜/","excerpt":"é—®é¢˜é¡¹ç›®ä¸­æœ‰ä¸ªModuleéœ€è¦è§£æjsonæ‰€ä»¥é€‰ç”¨äº†ä¾èµ–Gsonï¼Œä½†æ˜¯ç¼–è¯‘æ—¶æŠ¥é”™å¦‚ä¸‹ï¼š 12Error:Execution failed for task &apos;:app:transformClassesWithJarMergingForAutoioDebug&apos;.&gt; com.android.build.api.transform.TransformException: java.util.zip.ZipException: duplicate entry: com/google/gson/annotations/Expose.class åˆ†æçœ‹åˆ°é”™è¯¯ä¸­çš„è¿™ä¸ªduplicateï¼Œç¬¬ä¸€ååº”å’Œå¹³å¸¸ä¸€æ ·ï¼Œéš¾é“æ˜¯å¾—å…ˆæ¸…ç†ä¸€ä¸‹Clean project ? åå¤è¯•äº†å‡ æ¬¡éƒ½ä¸è¡Œï¼Œä¸Šç½‘æŸ¥æ‰å‘ç°æ˜¯é‡å¤ä¾èµ–Gsonåº“çš„é—®é¢˜ï¼Œå¯¼è‡´é¡¹ç›®ä¸­æœ‰äº†ä¸¤ä¸ªé‡å¤çš„Expose.class ç±»ã€‚ ä½¿ç”¨å¿«æ·é”®ï¼ˆShift + Ctrl + Tï¼‰æŸ¥çœ‹é¡¹ç›®ä¸­çš„Expose.class ç±»ï¼Œå‘ç°æ˜¯å’Œpassport-1.4.2.jarè¿™ä¸ªæœ¬åœ°jaråŒ…å†²çªäº†ï¼Œå®ƒä¹Ÿä¾èµ–äº†gsonåº“æ‰€ä»¥å¯¼è‡´äº†é‡å¤ä¾èµ–ã€‚","text":"é—®é¢˜é¡¹ç›®ä¸­æœ‰ä¸ªModuleéœ€è¦è§£æjsonæ‰€ä»¥é€‰ç”¨äº†ä¾èµ–Gsonï¼Œä½†æ˜¯ç¼–è¯‘æ—¶æŠ¥é”™å¦‚ä¸‹ï¼š 12Error:Execution failed for task &apos;:app:transformClassesWithJarMergingForAutoioDebug&apos;.&gt; com.android.build.api.transform.TransformException: java.util.zip.ZipException: duplicate entry: com/google/gson/annotations/Expose.class åˆ†æçœ‹åˆ°é”™è¯¯ä¸­çš„è¿™ä¸ªduplicateï¼Œç¬¬ä¸€ååº”å’Œå¹³å¸¸ä¸€æ ·ï¼Œéš¾é“æ˜¯å¾—å…ˆæ¸…ç†ä¸€ä¸‹Clean project ? åå¤è¯•äº†å‡ æ¬¡éƒ½ä¸è¡Œï¼Œä¸Šç½‘æŸ¥æ‰å‘ç°æ˜¯é‡å¤ä¾èµ–Gsonåº“çš„é—®é¢˜ï¼Œå¯¼è‡´é¡¹ç›®ä¸­æœ‰äº†ä¸¤ä¸ªé‡å¤çš„Expose.class ç±»ã€‚ ä½¿ç”¨å¿«æ·é”®ï¼ˆShift + Ctrl + Tï¼‰æŸ¥çœ‹é¡¹ç›®ä¸­çš„Expose.class ç±»ï¼Œå‘ç°æ˜¯å’Œpassport-1.4.2.jarè¿™ä¸ªæœ¬åœ°jaråŒ…å†²çªäº†ï¼Œå®ƒä¹Ÿä¾èµ–äº†gsonåº“æ‰€ä»¥å¯¼è‡´äº†é‡å¤ä¾èµ–ã€‚ é¡¹ç›®ç»“æ„åœ¨å¾€ä¸‹é¢åˆ†æä¹‹å‰ï¼Œéœ€è¦å…ˆæ ¹æ®é¡¹ç›®ç»“æ„è¯´æ˜ä¸€ä¸‹é—®é¢˜çš„æœ¬è´¨ï¼Œå°±æ˜¯Module è¸©è¿‡çš„å‘ç¬¬ä¸€ä¸ªæŸ¥åˆ°çš„è§£å†³åŠæ³•æ˜¯è¿™ä¸ªAndroid Studioä¸­å¦‚ä½•è§£å†³é‡å¤ä¾èµ–å¯¼è‡´çš„app:transformClassesWithJarMergingForDebugï¼Œä½†æ˜¯ä»–çš„é—®é¢˜æ˜¯ä¾èµ–å¦å¤–ä¸€ä¸ªåº“retrofitï¼Œå¥¹ç”¨äº†ä¸‹é¢çš„åŠæ³•ï¼š 123compile ('com.squareup.retrofit2:converter-gson:2.1.0')&#123; exclude group: 'com.google.code.gson'&#125; æ‰€ä»¥æˆ‘ä¹Ÿå°è¯•ä»¿ç…§ä»–çš„æ–¹æ³•ï¼Œåœ¨æˆ‘çš„Speechæ¨¡å—ä¸‹çš„build.gradleæ–‡ä»¶é‡Œä¿®æ”¹ 123456//æ³¨æ„ï¼šä¸‹é¢çš„æ–¹æ³•æ˜¯é”™çš„dependencies &#123; compile fileTree(include: '*.jar', dir: 'libs')&#123; //é”™çš„ exclude group: 'com.google.code.gson', module: 'gson' &#125;&#125; æŠ¥é”™å¦‚ä¸‹ï¼Œæ˜¾ç„¶è¿™ä¹ˆå†™æ˜¯ä¸å¯¹çš„ï¼Œå¯¹äºä¾èµ–æœ¬åœ°jaræ–‡ä»¶è¿™ä¹ˆå†™æ˜¯ä¸å¯¹çš„ï¼š 1Error:Could not find method exclude() for arguments [&#123;group=com.google.code.gson, module=gson&#125;] on directory &apos;&#123;include=*.jar, dir=libs&#125;&apos; of type org.gradle.api.internal.file.collections.DefaultConfigurableFileTree. ä½†æ˜¯ï¼Œä»–ä»¬çš„è§£å†³æ€è·¯æ˜¯å¯¹çš„ï¼Œå°±æ˜¯æƒ³åŠæ³•å±è”½å…¶ä¸­ä¸€ä¸ªGsonåº“ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¤šå°è¯•å„ä¸ªå¼•å…¥å®ƒä»¬çš„åœ°æ–¹ã€‚ è§£å†³åŠæ³•æœ€åè¯•æ¥è¯•å»ï¼Œæ‰å‘ç°excludeéœ€è¦å†™åœ¨App ä¸»Module çš„build.gradleæ–‡ä»¶ä¸­æ‰èƒ½ç”Ÿæ•ˆï¼Œè€Œä¸”æ³¨æ„ project(â€˜:Speechâ€™) å¤–é¢é‚£å±‚æ‹¬å·ï¼š 12345678910111213141516apply plugin: 'com.android.application' //æ³¨æ„è¿™æ˜¯ä¸»Modulerepositories &#123; mavenCentral()&#125;dependencies &#123; // Module dependency compile project(':passportSDKLib') compile (project(':Speech'))&#123; //è§£å†³Gsoné‡å¤ä¾èµ–é—®é¢˜ï¼Œä¸passport-1.4.2.jaræœ‰å†²çª exclude group: 'com.google.code.gson', module: 'gson' &#125; compile project(':Skin') compile fileTree(include: '*.jar', dir: 'src/main/libs')&#125; å”‰ï¼Œä¸–ç•Œç»ˆäºæ¸…é™äº† å‚è€ƒèµ„æ–™1ã€AndroidStudioä¸­å¦‚ä½•è§£å†³é‡å¤ä¾èµ–å¯¼è‡´çš„app:transformClassesWithJarMergingForDebug2ã€AndroidStudioçš„Gradleæ·»åŠ é‡å¤ä¾èµ–çš„é—®é¢˜","categories":[{"name":"Gradle","slug":"Gradle","permalink":"http://github.com/categories/Gradle/"}],"tags":[{"name":"Gradle","slug":"Gradle","permalink":"http://github.com/tags/Gradle/"}],"keywords":[{"name":"Gradle","slug":"Gradle","permalink":"http://github.com/categories/Gradle/"}]},{"title":"ã€Androidã€‘å†…å­˜æ³„æ¼åˆ†æå¿ƒå¾—","slug":"ã€Androidã€‘å†…å­˜æ³„æ¼åˆ†æå¿ƒå¾—","date":"2017-02-13T08:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/02/13/ã€Androidã€‘å†…å­˜æ³„æ¼åˆ†æå¿ƒå¾—/","link":"","permalink":"http://github.com/2017/02/13/ã€Androidã€‘å†…å­˜æ³„æ¼åˆ†æå¿ƒå¾—/","excerpt":"æœ¬æ–‡æ¥æºï¼šQQç©ºé—´ç»ˆç«¯å¼€å‘å›¢é˜Ÿå…¬ä¼—å· å‰è¨€å¯¹äºC++æ¥è¯´ï¼Œå†…å­˜æ³„æ¼å°±æ˜¯newå‡ºæ¥çš„å¯¹è±¡æ²¡æœ‰deleteï¼Œä¿—ç§°é‡æŒ‡é’ˆï¼›å¯¹äºJavaæ¥è¯´ï¼Œå°±æ˜¯newå‡ºæ¥çš„Object æ”¾åœ¨Heapä¸Šæ— æ³•è¢«GCå›æ”¶ï¼› æœ¬æ–‡é€šè¿‡QQå’ŒQzoneä¸­å†…å­˜æ³„æ¼å®ä¾‹æ¥è®²androidä¸­å†…å­˜æ³„æ¼åˆ†æè§£æ³•å’Œç¼–å†™ä»£ç åº”æ³¨æ„çš„äº‹é¡¹ã€‚ Java ä¸­çš„å†…å­˜åˆ†é… é™æ€å‚¨å­˜åŒºï¼šç¼–è¯‘æ—¶å°±åˆ†é…å¥½ï¼Œåœ¨ç¨‹åºæ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚å®ƒä¸»è¦å­˜æ”¾é™æ€æ•°æ®å’Œå¸¸é‡ï¼› æ ˆåŒºï¼šå½“æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œä¼šåœ¨æ ˆåŒºå†…å­˜ä¸­åˆ›å»ºæ–¹æ³•ä½“å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œæ–¹æ³•ç»“æŸåè‡ªåŠ¨é‡Šæ”¾å†…å­˜ï¼› å †åŒºï¼šé€šå¸¸å­˜æ”¾ new å‡ºæ¥çš„å¯¹è±¡ã€‚ç”± Java åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚","text":"æœ¬æ–‡æ¥æºï¼šQQç©ºé—´ç»ˆç«¯å¼€å‘å›¢é˜Ÿå…¬ä¼—å· å‰è¨€å¯¹äºC++æ¥è¯´ï¼Œå†…å­˜æ³„æ¼å°±æ˜¯newå‡ºæ¥çš„å¯¹è±¡æ²¡æœ‰deleteï¼Œä¿—ç§°é‡æŒ‡é’ˆï¼›å¯¹äºJavaæ¥è¯´ï¼Œå°±æ˜¯newå‡ºæ¥çš„Object æ”¾åœ¨Heapä¸Šæ— æ³•è¢«GCå›æ”¶ï¼› æœ¬æ–‡é€šè¿‡QQå’ŒQzoneä¸­å†…å­˜æ³„æ¼å®ä¾‹æ¥è®²androidä¸­å†…å­˜æ³„æ¼åˆ†æè§£æ³•å’Œç¼–å†™ä»£ç åº”æ³¨æ„çš„äº‹é¡¹ã€‚ Java ä¸­çš„å†…å­˜åˆ†é… é™æ€å‚¨å­˜åŒºï¼šç¼–è¯‘æ—¶å°±åˆ†é…å¥½ï¼Œåœ¨ç¨‹åºæ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚å®ƒä¸»è¦å­˜æ”¾é™æ€æ•°æ®å’Œå¸¸é‡ï¼› æ ˆåŒºï¼šå½“æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œä¼šåœ¨æ ˆåŒºå†…å­˜ä¸­åˆ›å»ºæ–¹æ³•ä½“å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œæ–¹æ³•ç»“æŸåè‡ªåŠ¨é‡Šæ”¾å†…å­˜ï¼› å †åŒºï¼šé€šå¸¸å­˜æ”¾ new å‡ºæ¥çš„å¯¹è±¡ã€‚ç”± Java åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚ å››ç§å¼•ç”¨ç±»å‹çš„ä»‹ç» å¼ºå¼•ç”¨(StrongReference)ï¼šJVM å®å¯æŠ›å‡º OOM ï¼Œä¹Ÿä¸ä¼šè®© GC å›æ”¶å…·æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡ï¼› è½¯å¼•ç”¨(SoftReference)ï¼šåªæœ‰åœ¨å†…å­˜ç©ºé—´ä¸è¶³æ—¶ï¼Œæ‰ä¼šè¢«å›çš„å¯¹è±¡ï¼› å¼±å¼•ç”¨(WeakReference)ï¼šåœ¨ GC æ—¶ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ï¼› è™šå¼•ç”¨(PhantomReference)ï¼šä»»ä½•æ—¶å€™éƒ½å¯ä»¥è¢«GCå›æ”¶ï¼Œå½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ç¨‹åºå¯ä»¥é€šè¿‡åˆ¤æ–­å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯å¦å­˜åœ¨è¯¥å¯¹è±¡çš„è™šå¼•ç”¨ï¼Œæ¥äº†è§£è¿™ä¸ªå¯¹è±¡æ˜¯å¦å°†è¦è¢«å›æ”¶ã€‚å¯ä»¥ç”¨æ¥ä½œä¸ºGCå›æ”¶Objectçš„æ ‡å¿—ã€‚ æˆ‘ä»¬å¸¸è¯´çš„å†…å­˜æ³„æ¼æ˜¯æŒ‡newå‡ºæ¥çš„Objectæ— æ³•è¢«GCå›æ”¶ï¼Œå³ä¸ºå¼ºå¼•ç”¨ï¼š å†…å­˜æ³„æ¼å‘ç”Ÿæ—¶çš„ä¸»è¦è¡¨ç°ä¸ºå†…å­˜æŠ–åŠ¨ï¼Œå¯ç”¨å†…å­˜æ…¢æ…¢å˜å°‘ï¼š Andriod ä¸­åˆ†æå†…å­˜æ³„æ¼çš„å·¥å…·MATMATï¼ˆMemory Analyzer Toolsï¼‰æ˜¯ä¸€ä¸ª Eclipse æ’ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¿«é€Ÿã€åŠŸèƒ½ä¸°å¯Œçš„JAVA heapåˆ†æå·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥æ‰¾å†…å­˜æ³„æ¼å’Œå‡å°‘å†…å­˜æ¶ˆè€—ã€‚ MAT æ’ä»¶çš„ä¸‹è½½åœ°å€ï¼š Eclipse Memory Analyzer Open Source Project QQ å’Œ Qzoneå†…å­˜æ³„æ¼å¦‚ä½•ç›‘æ§ QQå’ŒQzone çš„å†…å­˜æ³„æ¼é‡‡ç”¨SNGAPMè§£å†³æ–¹æ¡ˆï¼ŒSNGAPMæ˜¯ä¸€ä¸ªæ€§èƒ½ç›‘æ§ã€åˆ†æçš„ç»Ÿä¸€è§£å†³æ–¹æ¡ˆï¼Œå®ƒä»ç»ˆç«¯æ”¶é›†æ€§èƒ½ä¿¡æ¯ï¼Œä¸ŠæŠ¥åˆ°ä¸€ä¸ªåå°ï¼Œåå°å°†ç›‘æ§ç±»ä¿¡æ¯èšåˆå±•ç¤ºä¸ºå›¾è¡¨ï¼Œå°†åˆ†æç±»ä¿¡æ¯è¿›è¡Œåˆ†æå¹¶æå•ï¼Œé€šçŸ¥å¼€å‘è€…ï¼› SNGAPMç”±Appï¼ˆMagnifierAppï¼‰å’Œ web serverï¼ˆMagnifierServerï¼‰ä¸¤éƒ¨åˆ†ç»„æˆï¼› MagnifierAppåœ¨è‡ªåŠ¨å†…å­˜æ³„æ¼æ£€æµ‹ä¸­æ˜¯ä¸€ä¸ªè¡”æ¥æ£€æµ‹ç»„ä»¶ï¼ˆLeakInspectorï¼‰å’Œè‡ªåŠ¨åŒ–äº‘åˆ†æï¼ˆMagnifierCloudï¼‰çš„ä¸­é—´æ€§å¹³å°ï¼Œå®ƒä»LeakInspectorçš„å†…å­˜dumpè‡ªåŠ¨åŒ–ä¸Šä¼ MagnifierServerï¼› MagnifierServeråå°ä¼šå®šæ—¶æäº¤åˆ†æä»»åŠ¡åˆ°MagnifierCloudï¼› MagnifierCloudåˆ†æç»“æŸä¹‹åä¼šæ›´æ–°æ•°æ®åˆ°magnifier webä¸Šï¼ŒåŒæ—¶ä»¥bugå•å½¢å¼é€šçŸ¥å¼€å‘è€…ã€‚ å¸¸è§çš„å†…å­˜æ³„æ¼æ¡ˆä¾‹case 1. å•ä¾‹é€ æˆçš„å†…å­˜æ³„éœ²å•ä¾‹çš„é™æ€ç‰¹æ€§å¯¼è‡´å…¶ç”Ÿå‘½å‘¨æœŸåŒåº”ç”¨ä¸€æ ·é•¿ã€‚ è§£å†³æ–¹æ¡ˆï¼š 1ã€å°†è¯¥å±æ€§çš„å¼•ç”¨æ–¹å¼æ”¹ä¸ºå¼±å¼•ç”¨;2ã€å¦‚æœä¼ å…¥Contextï¼Œä½¿ç”¨ApplicationContext; æ³„æ¼ä»£ç ç‰‡æ®µ exampleï¼š 123456789101112131415161718192021private static ScrollHelper mInstance; private ScrollHelper() &#123;&#125; public static ScrollHelper getInstance() &#123; if (mInstance == null) &#123; synchronized (ScrollHelper.class) &#123; if (mInstance == null) &#123; mInstance = new ScrollHelper(); &#125; &#125; &#125; return mInstance;&#125; /** * è¢«ç‚¹å‡»çš„view */private View mScrolledView = null; public void setScrolledView(View scrolledView) &#123; mScrolledView = scrolledView;&#125; Solutionï¼šä½¿ç”¨WeakReference 123456789101112131415161718192021private static ScrollHelper mInstance; private ScrollHelper() &#123;&#125; public static ScrollHelper getInstance() &#123; if (mInstance == null) &#123; synchronized (ScrollHelper.class) &#123; if (mInstance == null) &#123; mInstance = new ScrollHelper(); &#125; &#125; &#125; return mInstance;&#125; /** * è¢«ç‚¹å‡»çš„view */private WeakReference&lt;View&gt; mScrolledViewWeakRef = null; public void setScrolledView(View scrolledView) &#123; mScrolledViewWeakRef = new WeakReference&lt;View&gt;(scrolledView);&#125; case 2. InnerClassåŒ¿åå†…éƒ¨ç±»åœ¨Javaä¸­ï¼Œéé™æ€å†…éƒ¨ç±» å’Œ åŒ¿åç±» éƒ½ä¼šæ½œåœ¨çš„å¼•ç”¨å®ƒä»¬æ‰€å±çš„å¤–éƒ¨ç±»ï¼Œä½†æ˜¯ï¼Œé™æ€å†…éƒ¨ç±»å´ä¸ä¼šã€‚å¦‚æœè¿™ä¸ªéé™æ€å†…éƒ¨ç±»å®ä¾‹åšäº†ä¸€äº›è€—æ—¶çš„æ“ä½œï¼Œå°±ä¼šé€ æˆå¤–å›´å¯¹è±¡ä¸ä¼šè¢«å›æ”¶ï¼Œä»è€Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚ è§£å†³æ–¹æ¡ˆï¼š 1ã€å°†å†…éƒ¨ç±»å˜æˆé™æ€å†…éƒ¨ç±»;2ã€å¦‚æœæœ‰å¼ºå¼•ç”¨Activityä¸­çš„å±æ€§ï¼Œåˆ™å°†è¯¥å±æ€§çš„å¼•ç”¨æ–¹å¼æ”¹ä¸ºå¼±å¼•ç”¨;3ã€åœ¨ä¸šåŠ¡å…è®¸çš„æƒ…å†µä¸‹ï¼Œå½“Activityæ‰§è¡ŒonDestoryæ—¶ï¼Œç»“æŸè¿™äº›è€—æ—¶ä»»åŠ¡; exampleï¼š 1234567891011121314151617181920212223public class LeakAct extends Activity &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.aty_leak); test(); &#125; //è¿™å„¿å‘ç”Ÿæ³„æ¼ public void test() &#123; new Thread(new Runnable() &#123; @Override public void run() &#123; while (true) &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125;).start(); &#125;&#125; Solutionï¼š 1234567891011121314151617181920212223public class LeakAct extends Activity &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.aty_leak); test(); &#125; //åŠ ä¸Šstaticï¼Œå˜æˆé™æ€åŒ¿åå†…éƒ¨ç±» public static void test() &#123; new Thread(new Runnable() &#123; @Override public void run() &#123; while (true) &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125; &#125;).start(); &#125;&#125; case 3. Activity Context çš„ä¸æ­£ç¡®ä½¿ç”¨åœ¨Androidåº”ç”¨ç¨‹åºä¸­é€šå¸¸å¯ä»¥ä½¿ç”¨ä¸¤ç§Contextå¯¹è±¡ï¼šActivityå’ŒApplicationã€‚å½“ç±»æˆ–æ–¹æ³•éœ€è¦Contextå¯¹è±¡çš„æ—¶å€™å¸¸è§çš„åšæ³•æ˜¯ä½¿ç”¨ç¬¬ä¸€ä¸ªä½œä¸ºContextå‚æ•°ã€‚è¿™æ ·å°±æ„å‘³ç€Viewå¯¹è±¡å¯¹æ•´ä¸ªActivityä¿æŒå¼•ç”¨ï¼Œå› æ­¤ä¹Ÿå°±ä¿æŒå¯¹Activtyçš„æ‰€æœ‰çš„å¼•ç”¨ã€‚ å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œå½“åº”ç”¨ç¨‹åºæœ‰ä¸ªæ¯”è¾ƒå¤§çš„Bitmapç±»å‹çš„å›¾ç‰‡ï¼Œæ¯æ¬¡æ—‹è½¬æ˜¯éƒ½é‡æ–°åŠ è½½å›¾ç‰‡æ‰€ç”¨çš„æ—¶é—´è¾ƒå¤šã€‚ä¸ºäº†æé«˜å±å¹•æ—‹è½¬æ˜¯Activityçš„åˆ›å»ºé€Ÿåº¦ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ—¶å°†è¿™ä¸ªBitmapå¯¹è±¡ä½¿ç”¨Staticä¿®é¥°ã€‚ å½“ä¸€ä¸ªDrawableç»‘å®šåœ¨Viewä¸Šï¼Œå®é™…ä¸Šè¿™ä¸ªViewå¯¹è±¡å°±ä¼šæˆä¸ºè¿™ä»½Drawableçš„ä¸€ä¸ªCallbackæˆå‘˜å˜é‡ã€‚è€Œé™æ€å˜é‡çš„ç”Ÿå‘½å‘¨æœŸè¦é•¿äºActivityã€‚å¯¼è‡´äº†å½“æ—‹è½¬å±å¹•æ—¶ï¼ŒActivityæ— æ³•è¢«å›æ”¶ï¼Œè€Œé€ æˆå†…å­˜æ³„éœ²ã€‚ è§£å†³æ–¹æ¡ˆï¼š 1ã€ä½¿ç”¨ApplicationContextä»£æ›¿ActivityContextï¼Œå› ä¸ºApplicationContextä¼šéšç€åº”ç”¨ç¨‹åºçš„å­˜åœ¨è€Œå­˜åœ¨ï¼Œè€Œä¸ä¾èµ–äºactivityçš„ç”Ÿå‘½å‘¨æœŸï¼› 2ã€å¯¹Contextçš„å¼•ç”¨ä¸è¦è¶…è¿‡å®ƒæœ¬èº«çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ…é‡çš„å¯¹Contextä½¿ç”¨â€œstaticâ€å…³é”®å­—ã€‚Contexté‡Œå¦‚æœæœ‰çº¿ç¨‹ï¼Œä¸€å®šè¦åœ¨onDestroy()é‡ŒåŠæ—¶åœæ‰ã€‚ exampleï¼š 123456789101112private static Drawable sBackground;@Overrideprotected void onCreate(Bundle state) &#123; super.onCreate(state); TextView label = new TextView(this); label.setText(\"Leaks are bad\"); if (sBackground == null) &#123; sBackground = getDrawable(R.drawable.large_bitmap); &#125; label.setBackgroundDrawable(sBackground); setContentView(label);&#125; Solutionï¼š 123456789101112private static Drawable sBackground;@Overrideprotected void onCreate(Bundle state) &#123; super.onCreate(state); TextView label = new TextView(this); label.setText(\"Leaks are bad\"); if (sBackground == null) &#123; sBackground = getApplicationContext().getDrawable(R.drawable.large_bitmap); &#125; label.setBackgroundDrawable(sBackground); setContentView(label);&#125; case 4. Handlerå¼•èµ·çš„å†…å­˜æ³„æ¼å½“Handlerä¸­æœ‰å»¶è¿Ÿçš„çš„ä»»åŠ¡æˆ–æ˜¯ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡é˜Ÿåˆ—è¿‡é•¿ï¼Œç”±äºæ¶ˆæ¯æŒæœ‰å¯¹Handlerçš„å¼•ç”¨ï¼Œè€ŒHandleråˆæŒæœ‰å¯¹å…¶å¤–éƒ¨ç±»çš„æ½œåœ¨å¼•ç”¨ï¼Œè¿™æ¡å¼•ç”¨å…³ç³»ä¼šä¸€ç›´ä¿æŒåˆ°æ¶ˆæ¯å¾—åˆ°å¤„ç†ï¼Œè€Œå¯¼è‡´äº†Activityæ— æ³•è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼Œè€Œå¯¼è‡´äº†å†…å­˜æ³„éœ²ã€‚ è§£å†³æ–¹æ¡ˆï¼š 1ã€å¯ä»¥æŠŠHandlerç±»æ”¾åœ¨å•ç‹¬çš„ç±»æ–‡ä»¶ä¸­ï¼Œæˆ–è€…ä½¿ç”¨é™æ€å†…éƒ¨ç±»ä¾¿å¯ä»¥é¿å…æ³„éœ²;2ã€å¦‚æœæƒ³åœ¨Handlerå†…éƒ¨å»è°ƒç”¨æ‰€åœ¨çš„Activity,é‚£ä¹ˆå¯ä»¥åœ¨handlerå†…éƒ¨ä½¿ç”¨å¼±å¼•ç”¨çš„æ–¹å¼å»æŒ‡å‘æ‰€åœ¨Activity.ä½¿ç”¨Static + WeakReferenceçš„æ–¹å¼æ¥è¾¾åˆ°æ–­å¼€Handlerä¸Activityä¹‹é—´å­˜åœ¨å¼•ç”¨å…³ç³»çš„ç›®çš„ã€‚ Solution 123456789@Overrideprotected void doOnDestroy() &#123; super.doOnDestroy(); if (mHandler != null) &#123; mHandler.removeCallbacksAndMessages(null); &#125; mHandler = null; mRenderCallback = null;&#125; case 5. æ³¨å†Œç›‘å¬å™¨çš„æ³„æ¼ç³»ç»ŸæœåŠ¡å¯ä»¥é€šè¿‡Context.getSystemService è·å–ï¼Œå®ƒä»¬è´Ÿè´£æ‰§è¡ŒæŸäº›åå°ä»»åŠ¡ï¼Œæˆ–è€…ä¸ºç¡¬ä»¶è®¿é—®æä¾›æ¥å£ã€‚å¦‚æœContext å¯¹è±¡æƒ³è¦åœ¨æœåŠ¡å†…éƒ¨çš„äº‹ä»¶å‘ç”Ÿæ—¶è¢«é€šçŸ¥ï¼Œé‚£å°±éœ€è¦æŠŠè‡ªå·±æ³¨å†Œåˆ°æœåŠ¡çš„ç›‘å¬å™¨ä¸­ã€‚ç„¶è€Œï¼Œè¿™ä¼šè®©æœåŠ¡æŒæœ‰Activity çš„å¼•ç”¨ï¼Œå¦‚æœåœ¨Activity onDestoryæ—¶æ²¡æœ‰é‡Šæ”¾æ‰å¼•ç”¨å°±ä¼šå†…å­˜æ³„æ¼ã€‚ è§£å†³æ–¹æ¡ˆï¼š ä½¿ç”¨ApplicationContextä»£æ›¿ActivityContext; åœ¨Activityæ‰§è¡ŒonDestoryæ—¶ï¼Œè°ƒç”¨åæ³¨å†Œ; 1mSensorManager = (SensorManager) this.getSystemService(Context.SENSOR_SERVICE); Solutionï¼š 1mSensorManager = (SensorManager) getApplicationContext().getSystemService(Context.SENSOR_SERVICE); ä¸‹é¢æ˜¯å®¹æ˜“é€ æˆå†…å­˜æ³„æ¼çš„ç³»ç»ŸæœåŠ¡ï¼š 1InputMethodManager imm = (InputMethodManager) context.getApplicationContext().getSystemService(Context.INPUT_METHOD_SERVICE); Solution 123456789101112protected void onDetachedFromWindow() &#123; if (this.mActionShell != null) &#123; this.mActionShell.setOnClickListener((OnAreaClickListener)null); &#125; if (this.mButtonShell != null) &#123; this.mButtonShell.setOnClickListener((OnAreaClickListener)null); &#125; if (this.mCountShell != this.mCountShell) &#123; this.mCountShell.setOnClickListener((OnAreaClickListener)null); &#125; super.onDetachedFromWindow();&#125; case 6. Cursorï¼ŒStreamæ²¡æœ‰closeï¼ŒViewæ²¡æœ‰recyleèµ„æºæ€§å¯¹è±¡æ¯”å¦‚(Cursorï¼ŒFileæ–‡ä»¶ç­‰)å¾€å¾€éƒ½ç”¨äº†ä¸€äº›ç¼“å†²ï¼Œæˆ‘ä»¬åœ¨ä¸ä½¿ç”¨çš„æ—¶å€™ï¼Œåº”è¯¥åŠæ—¶å…³é—­å®ƒä»¬ï¼Œä»¥ä¾¿å®ƒä»¬çš„ç¼“å†²åŠæ—¶å›æ”¶å†…å­˜ã€‚å®ƒä»¬çš„ç¼“å†²ä¸ä»…å­˜åœ¨äº javaè™šæ‹Ÿæœºå†…ï¼Œè¿˜å­˜åœ¨äºjavaè™šæ‹Ÿæœºå¤–ã€‚å¦‚æœæˆ‘ä»¬ä»…ä»…æ˜¯æŠŠå®ƒçš„å¼•ç”¨è®¾ç½®ä¸ºnull,è€Œä¸å…³é—­å®ƒä»¬ï¼Œå¾€å¾€ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚å› ä¸ºæœ‰äº›èµ„æºæ€§å¯¹è±¡ï¼Œæ¯”å¦‚SQLiteCursor(åœ¨ææ„å‡½æ•°finalize(),å¦‚æœæˆ‘ä»¬æ²¡æœ‰å…³é—­å®ƒï¼Œå®ƒè‡ªå·±ä¼šè°ƒclose()å…³é—­)ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰å…³é—­å®ƒï¼Œç³»ç»Ÿåœ¨å›æ”¶å®ƒæ—¶ä¹Ÿä¼šå…³é—­å®ƒï¼Œä½†æ˜¯è¿™æ ·çš„æ•ˆç‡å¤ªä½äº†ã€‚å› æ­¤å¯¹äºèµ„æºæ€§å¯¹è±¡åœ¨ä¸ä½¿ç”¨çš„æ—¶å€™ï¼Œåº”è¯¥è°ƒç”¨å®ƒçš„close()å‡½æ•°ï¼Œå°†å…¶å…³é—­æ‰ï¼Œç„¶åæ‰ç½®ä¸ºnull. åœ¨æˆ‘ä»¬çš„ç¨‹åºé€€å‡ºæ—¶ä¸€å®šè¦ç¡®ä¿æˆ‘ä»¬çš„èµ„æºæ€§å¯¹è±¡å·²ç»å…³é—­ã€‚ Solutionï¼š è°ƒç”¨onRecycled() 12345@Overridepublic void onRecycled() &#123; reset(); mSinglePicArea.onRecycled();&#125; åœ¨Viewä¸­è°ƒç”¨reset() 12345678910111213141516public void reset() &#123; if (mHasRecyled) &#123; return; &#125;... SubAreaShell.recycle(mActionBtnShell); mActionBtnShell = null;... mIsDoingAvatartRedPocketAnim = false; if (mAvatarArea != null) &#123; mAvatarArea.reset(); &#125; if (mNickNameArea != null) &#123; mNickNameArea.reset(); &#125;&#125; case 7. é›†åˆä¸­å¯¹è±¡æ²¡æ¸…ç†é€ æˆçš„å†…å­˜æ³„æ¼æˆ‘ä»¬é€šå¸¸æŠŠä¸€äº›å¯¹è±¡çš„å¼•ç”¨åŠ å…¥åˆ°äº†é›†åˆå®¹å™¨ï¼ˆæ¯”å¦‚ArrayListï¼‰ä¸­ï¼Œå½“æˆ‘ä»¬ä¸éœ€è¦è¯¥å¯¹è±¡æ—¶ï¼Œå¹¶æ²¡æœ‰æŠŠå®ƒçš„å¼•ç”¨ä»é›†åˆä¸­æ¸…ç†æ‰ï¼Œè¿™æ ·è¿™ä¸ªé›†åˆå°±ä¼šè¶Šæ¥è¶Šå¤§ã€‚å¦‚æœè¿™ä¸ªé›†åˆæ˜¯staticçš„è¯ï¼Œé‚£æƒ…å†µå°±æ›´ä¸¥é‡äº†ã€‚æ‰€ä»¥è¦åœ¨é€€å‡ºç¨‹åºä¹‹å‰ï¼Œå°†é›†åˆé‡Œçš„ä¸œè¥¿clearï¼Œç„¶åç½®ä¸ºnullï¼Œå†é€€å‡ºç¨‹åºã€‚ è§£å†³æ–¹æ¡ˆï¼š åœ¨Activityé€€å‡ºä¹‹å‰ï¼Œå°†é›†åˆé‡Œçš„ä¸œè¥¿clearï¼Œç„¶åç½®ä¸ºnullï¼Œå†é€€å‡ºç¨‹åºã€‚ Solution 1234567private List&lt;EmotionPanelInfo&gt; data; public void onDestory() &#123; if (data != null) &#123; data.clear(); data = null; &#125;&#125; case 8. WebViewé€ æˆçš„æ³„éœ²å½“æˆ‘ä»¬ä¸è¦ä½¿ç”¨WebViewå¯¹è±¡æ—¶ï¼Œåº”è¯¥è°ƒç”¨å®ƒçš„destory()å‡½æ•°æ¥é”€æ¯å®ƒï¼Œå¹¶é‡Šæ”¾å…¶å ç”¨çš„å†…å­˜ï¼Œå¦åˆ™å…¶å ç”¨çš„å†…å­˜é•¿æœŸä¹Ÿä¸èƒ½è¢«å›æ”¶ï¼Œä»è€Œé€ æˆå†…å­˜æ³„éœ²ã€‚ è§£å†³æ–¹æ¡ˆï¼š ä¸ºwebViewå¼€å¯å¦å¤–ä¸€ä¸ªè¿›ç¨‹ï¼Œé€šè¿‡AIDLä¸ä¸»çº¿ç¨‹è¿›è¡Œé€šä¿¡ï¼ŒWebViewæ‰€åœ¨çš„è¿›ç¨‹å¯ä»¥æ ¹æ®ä¸šåŠ¡çš„éœ€è¦é€‰æ‹©åˆé€‚çš„æ—¶æœºè¿›è¡Œé”€æ¯ï¼Œä»è€Œè¾¾åˆ°å†…å­˜çš„å®Œæ•´é‡Šæ”¾ã€‚ case 9. æ„é€ Adapteræ—¶ï¼Œæ²¡æœ‰ä½¿ç”¨ç¼“å­˜çš„ConvertViewåˆå§‹æ—¶ListViewä¼šä»Adapterä¸­æ ¹æ®å½“å‰çš„å±å¹•å¸ƒå±€å®ä¾‹åŒ–ä¸€å®šæ•°é‡çš„Viewå¯¹è±¡ï¼ŒåŒæ—¶ListViewä¼šå°†è¿™äº›Viewå¯¹è±¡ ç¼“å­˜èµ·æ¥ã€‚ å½“å‘ä¸Šæ»šåŠ¨ListViewæ—¶ï¼ŒåŸå…ˆä½äºæœ€ä¸Šé¢çš„List Itemçš„Viewå¯¹è±¡ä¼šè¢«å›æ”¶ï¼Œç„¶åè¢«ç”¨æ¥æ„é€ æ–°å‡ºç°çš„æœ€ä¸‹é¢çš„List Itemã€‚ è¿™ä¸ªæ„é€ è¿‡ç¨‹å°±æ˜¯ç”±getView()æ–¹æ³•å®Œæˆçš„ï¼ŒgetView()çš„ç¬¬äºŒä¸ªå½¢å‚View ConvertViewå°±æ˜¯è¢«ç¼“å­˜èµ·æ¥çš„List Itemçš„Viewå¯¹è±¡(åˆå§‹åŒ–æ—¶ç¼“å­˜ä¸­æ²¡æœ‰Viewå¯¹è±¡åˆ™ConvertViewæ˜¯null)ã€‚","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€ç®—æ³•ã€‘åè½¬å•é“¾è¡¨ï¼Œä¸¤ä¸¤åè½¬","slug":"ã€ç®—æ³•ã€‘å•é“¾è¡¨åè½¬ï¼Œä¸¤ä¸¤åè½¬","date":"2017-01-31T09:20:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/01/31/ã€ç®—æ³•ã€‘å•é“¾è¡¨åè½¬ï¼Œä¸¤ä¸¤åè½¬/","link":"","permalink":"http://github.com/2017/01/31/ã€ç®—æ³•ã€‘å•é“¾è¡¨åè½¬ï¼Œä¸¤ä¸¤åè½¬/","excerpt":"é—®é¢˜ä¸€ã€åè½¬å•é“¾è¡¨é¢˜ç›®ï¼šå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œåè½¬è¯¥é“¾è¡¨å¹¶è¾“å‡ºåè½¬åé“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚ é“¾è¡¨ç»“ç‚¹å®šä¹‰å¦‚ä¸‹ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯Javaæè¿°ï¼š 12345public class ListNode &#123; int val; ListNode next; ListNode(int x) &#123; val = x; &#125;&#125;","text":"é—®é¢˜ä¸€ã€åè½¬å•é“¾è¡¨é¢˜ç›®ï¼šå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œåè½¬è¯¥é“¾è¡¨å¹¶è¾“å‡ºåè½¬åé“¾è¡¨çš„å¤´ç»“ç‚¹ã€‚ é“¾è¡¨ç»“ç‚¹å®šä¹‰å¦‚ä¸‹ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯Javaæè¿°ï¼š 12345public class ListNode &#123; int val; ListNode next; ListNode(int x) &#123; val = x; &#125;&#125; æ€è·¯å¦‚ä½•æŠŠä¸€ä¸ªå•é“¾è¡¨è¿›è¡Œåè½¬ï¼Ÿ æ–¹æ³•1ï¼šå°†å•é“¾è¡¨å‚¨å­˜ä¸ºæ•°ç»„ï¼Œç„¶åæŒ‰ç…§æ•°ç»„çš„ç´¢å¼•é€†åºè¿›è¡Œåè½¬ã€‚ æ–¹æ³•2ï¼šç”¨å¤´æ’æ³•æ–°å»ºé“¾è¡¨ã€‚æˆ‘ä»¬çŸ¥é“åˆ›å»ºé“¾è¡¨çš„ä¸¤ç§æ–¹å¼ï¼šå¤´æ’æ³•å’Œå°¾æ’æ³•ï¼Œå¤´ç»“ç‚¹æ’å…¥æ³•å½¢æˆçš„é“¾è¡¨æ˜¯å’Œè¾“å…¥é¡ºåºç›¸åçš„ï¼Œå°¾èŠ‚ç‚¹æ’å…¥æ³•å½¢æˆçš„é“¾è¡¨æ˜¯å’Œè¾“å…¥é¡ºåºç›¸åŒçš„ï¼Œæ‰€ä»¥å…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ï¼Œéå†åŸé“¾è¡¨ï¼Œç„¶åç”¨åŸé“¾è¡¨çš„è¾“å‡ºå…ƒç´ é¡ºåºç”¨å¤´ç»“ç‚¹æ’å…¥æ³•æ–°å»ºé“¾è¡¨ï¼Œè¿™æ ·æ–°å»ºçš„é“¾è¡¨å°±æ˜¯åè½¬åçš„é“¾è¡¨ã€‚ æ–¹æ³•3ï¼šå°±åœ°åè½¬é“¾è¡¨ã€‚ä½¿ç”¨3ä¸ªæŒ‡é’ˆéå†å•é“¾è¡¨ï¼Œé€ä¸ªé“¾æ¥ç‚¹è¿›è¡Œåè½¬ã€‚ 1ã€å€ŸåŠ©æ•°ç»„é€†åºåè½¬ç”±äºé¢˜ç›®å¹¶æ²¡æœ‰è¦æ±‚å¿…é¡»åŸåœ°åè½¬ï¼Œå› æ­¤å¯ä»¥å€ŸåŠ©å¤–éƒ¨ç©ºé—´å®ç°ã€‚è¿™é‡Œå¯ä»¥å°†å•é“¾è¡¨å‚¨å­˜ä¸ºæ•°ç»„ï¼Œç„¶åæŒ‰ç…§æ•°ç»„çš„ç´¢å¼•é€†åºè¿›è¡Œåè½¬ã€‚ä½†æ˜¯ï¼Œæ­¤æ–¹å¼æ¯”è¾ƒæµªè´¹ç©ºé—´ï¼Œè€Œä¸”éœ€è¦ä¸¤æ¬¡éå†ï¼Œæ•ˆç‡ä¸å ä¼˜åŠ¿ã€‚ 1234567891011121314151617181920212223242526/** * ä½¿ç”¨æ•°ç»„æ‹·è´çš„æ–¹å¼åè½¬å•é“¾è¡¨ */public static ListNode reverseList1(ListNode head)&#123; if(head == null) return null; //è½¬ç§»åˆ°æ•°ç»„å­˜å‚¨(è¿™é‡Œç”¨ArrayListæ–¹ä¾¿äº›) List&lt;ListNode&gt; nodeList = new ArrayList&lt;ListNode&gt;(); while (head != null) &#123; nodeList.add(head); head = head.next; &#125; int startIndex = nodeList.size() - 1; for (int i = startIndex; i &gt;= 0; i--) &#123; ListNode node = nodeList.get(i); if (i == 0) &#123; node.next = null; &#125; else &#123; node.next = nodeList.get(i - 1); &#125; &#125; // ç°åœ¨å¤´ç»“ç‚¹æ˜¯åŸæ¥çš„å°¾èŠ‚ç‚¹ head = nodeList.get(startIndex); return head;&#125; 2ã€å¤´æ’æ³•æ–°å»ºé“¾è¡¨æ¥åè½¬è¿™ä¸ªæ–¹æ³•å’Œç¬¬ä¸€ä¸ªå€ŸåŠ©æ•°ç»„ä¸€æ ·ï¼Œéœ€è¦é¢å¤–ä¸€å€çš„ç©ºé—´æ¥å­˜å‚¨ç”Ÿæˆçš„æ–°é“¾è¡¨ 123456789101112131415161718/** * å¤´æ’æ³•å»ºç«‹æ–°é“¾è¡¨ï¼Œè¾¾åˆ°åè½¬ç›®çš„ */public static ListNode reverseList2(ListNode head)&#123; if(head == null) return null; ListNode previous = null; //è®°å½•ä¸Šä¸ªèŠ‚ç‚¹ ListNode newHead = null; //å¤´æ’æ³•çš„æ–°å¤´èŠ‚ç‚¹ while(head != null)&#123; newHead = new ListNode(head.val); //æ–°å»ºå¤´ç»“ç‚¹ newHead.next = previous; previous = newHead; head = head.next; //ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ &#125; return newHead;&#125; 3ã€ä¸‰ä¸ªæŒ‡é’ˆå°±åœ°åè½¬ä½¿ç”¨ä¸‰ä¸ªæŒ‡é’ˆæŒ‡å‘ï¼šå½“å‰èŠ‚ç‚¹Aï¼Œä¸‹ä¸ªèŠ‚ç‚¹Bï¼Œä»¥åŠä¸‹ä¸‹ä¸ªèŠ‚ç‚¹Cã€‚ éå†æ—¶ï¼Œå¦‚ä¸‹é¦–å…ˆè®°å½•ä¸‹ä¸‹ä¸ªèŠ‚ç‚¹Cï¼Œç„¶åèŠ‚ç‚¹Bçš„æŒ‡é’ˆæ–­å¼€å¹¶æŒ‡å‘Aã€‚ç„¶åç§»åŠ¨è¿›å…¥ä¸‹ä¸€ç»„ã€‚ A -&gt; B -&gt; C -&gt;D -&gt; E A &lt;- B C -&gt;D -&gt; E æ•´ä¸ªè¿‡ç¨‹åªéœ€éå†é“¾è¡¨ä¸€æ¬¡ï¼Œæ•ˆç‡æé«˜ä¸å°‘ï¼Œä¸”éœ€è¦çš„å¤–éƒ¨ç©ºé—´ä¹Ÿè¾ƒç¬¬ä¸€ç§æ–¹æ³•è¦å°‘å¾ˆå¤šï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526/** * ä½¿ç”¨ä¸‰ä¸ªæŒ‡é’ˆåŸåœ°åè½¬å•é“¾è¡¨ */public static ListNode reverseList(ListNode head)&#123; if(head == null) return null; ListNode a = head; //å½“å‰èŠ‚ç‚¹A ListNode b = head.next; //ä¸‹ä¸ªèŠ‚ç‚¹B ListNode temp; //ä¸‹ä¸‹ä¸ªèŠ‚ç‚¹C //å¤´ç»“ç‚¹çš„æŒ‡é’ˆå…ˆæ¸…ç©º head.next = null; //æœ‰å¯èƒ½é“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥éœ€è¦çœ‹bæ˜¯å¦ä¸ºnull while(b != null)&#123; temp = b.next; // è®°å½•CèŠ‚ç‚¹ b.next = a; // a-&gt;b åå‘ if(temp == null)&#123; break; &#125; a = b; //ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ b = temp; &#125; return b == null ? a : b;&#125; å•å…ƒæµ‹è¯•æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425public class Test &#123; public static void main(String[] args) &#123; ListNode a1 = new ListNode(5); ListNode a2 = new ListNode(4); ListNode a3 = new ListNode(30); ListNode a4 = new ListNode(78); ListNode a5 = new ListNode(99); a1.next = a2; a2.next = a3; a3.next = a4; a4.next = a5; //åè½¬å•é“¾è¡¨ ListNode node = reverseList(a1); //æ‰“å°è¾“å‡ºç»“æœ while (node != null)&#123; System.out.print(node.val); node = node.next; System.out.print(node != null ? \"-&gt;\" : \"\"); &#125; &#125;&#125; é—®é¢˜äºŒã€å•é“¾è¡¨ä¸¤ä¸¤åè½¬ä¸€ä¸ªé“¾è¡¨ï¼ša-&gt;b-&gt;c-&gt;d-&gt;eæ¯ä¸¤ä¸ªå…ƒç´ è¿›è¡Œåè½¬ï¼šb-&gt;a-&gt;d-&gt;c-&gt;eè¾“å…¥ï¼šé“¾è¡¨å¤´æŒ‡é’ˆè¾“å‡ºï¼šåè½¬åçš„é“¾è¡¨å¤´æŒ‡é’ˆè¦æ±‚ï¼šä¸æ–°å»ºèŠ‚ç‚¹ è§£ç­”ä»¿ç…§å‰é¢çš„å•é“¾è¡¨åè½¬ï¼Œæˆ‘ä»¬æœ€å°‘éœ€è¦ä¸‰ä¸ªæŒ‡é’ˆï¼š currentï¼Œnextï¼Œ nextNextã€‚ åˆ†æï¼šæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªâ€œæŒ‡é’ˆâ€æŒ‡ç€å½“å‰è¦åè½¬çš„ä¸¤ä¸ªå€¼currentå’Œnextã€‚ä¸¤ä¸¤åè½¬åï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®°å½•ä¸‹ä¸€ä¸ªçš„å€¼ï¼Œå³åè½¬Aå’ŒBåï¼Œ éœ€è¦è®°å½• C å€¼ï¼Œæˆ‘ä»¬æ‰èƒ½å¤Ÿä¸æ–­å‘ä¸‹èµ°ï¼Œç›´åˆ°åˆ°è¾¾é“¾è¡¨æœ«ç«¯ã€‚æ‰€ä»¥ï¼Œéœ€è¦å¦ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå€¼çš„â€œæŒ‡é’ˆâ€ï¼Œå³nextNextã€‚åè½¬ä»¥åï¼ŒAçš„ä¸‹ä¸€ä¸ªæ˜¯Cï¼Œ ä½†æ˜¯ï¼Œå®é™…ä¸Šï¼ŒAçš„ä¸‹ä¸€ä¸ªåº”è¯¥æ˜¯Dï¼Œæ‰€ä»¥ï¼Œæ¯æ¬¡åè½¬æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°å‰ä¸€ä¸ªå€¼çš„ä¸‹ä¸€ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æŠŠ A -&gt; C æ”¹æˆ A -&gt; Dï¼Œæ‰€ä»¥éœ€è¦prevæŒ‡é’ˆã€‚æ‰€ä»¥ï¼Œè¦å®Œæˆè¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬æ€»å…±éœ€è¦4ä¸ªâ€œæŒ‡é’ˆâ€ã€‚å…·ä½“çœ‹ä»£ç ï¼š æ‰€ä»¥æœ€ç»ˆæˆ‘ä»¬ä¸€å…±éœ€è¦åˆ†æå››ä¸ªæŒ‡é’ˆï¼š prevï¼Œcurrentï¼Œnextï¼Œ nextNextã€‚ 1234567891011121314151617181920212223242526272829303132/** * å•é“¾è¡¨ä¸¤ä¸¤åè½¬ * * å·²çŸ¥ä¸€ä¸ªé“¾è¡¨ï¼ša-&gt;b-&gt;c-&gt;d-&gt;e * æ¯ä¸¤ä¸ªå…ƒç´ è¿›è¡Œåè½¬ï¼šb-&gt;a-&gt;d-&gt;c-&gt;e */public static ListNode reversePairedList(ListNode head)&#123; if(head == null) return null; ListNode a = head; //å½“å‰èŠ‚ç‚¹A ListNode b = head.next; //ä¸‹ä¸ªèŠ‚ç‚¹B ListNode temp; //ä¸‹ä¸‹ä¸ªèŠ‚ç‚¹C ListNode previous = null; //ä¸Šä¸€ç»„çš„å°¾æŒ‡é’ˆï¼Œåœ¨ä¸‹ä¸€ç»„åè½¬åéœ€è¦æ”¹å˜ ListNode newHead = b == null ? a : b; while(b != null)&#123; temp = b.next; // è®°å½•CèŠ‚ç‚¹ b.next = a; // a-&gt;b åå‘ a.next = temp; if(previous != null)&#123; previous.next = b; &#125; if(temp == null)&#123; break; &#125; previous = a; a = temp; //ç§»åŠ¨åˆ°ä¸‹ä¸€ç»„ b = temp.next; &#125; return newHead;&#125; å‚è€ƒèµ„æ–™ çœ‹å›¾ç†è§£å•é“¾è¡¨çš„åè½¬ ç®—æ³•å­¦ä¹ ä¹‹æ•°æ®ç»“æ„ä¹‹å•é“¾è¡¨åè½¬ï¼Œä¸¤ä¸¤åè½¬ å•é“¾è¡¨çš„å»ºç«‹(Cè¯­è¨€)ï¼šå¤´æ’æ³•å’Œå°¾æ’æ³•å»ºç«‹å•é“¾è¡¨ èš‚èšé‡‘æœåœ¨çº¿ç¬”è¯•é¢˜ - é“¾è¡¨ä¸¤ä¸¤åè½¬ ç®—æ³•é¢˜ï¼šåè½¬å•é“¾è¡¨","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Androidã€‘AlertDialogä¸­çš„EditTextä¸èƒ½å¼¹å‡ºè½¯é”®ç›˜çš„é—®é¢˜","slug":"ã€Androidã€‘AlertDialogä¸­çš„EditTextä¸èƒ½å¼¹å‡ºè½¯é”®ç›˜çš„é—®é¢˜","date":"2017-01-20T03:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/01/20/ã€Androidã€‘AlertDialogä¸­çš„EditTextä¸èƒ½å¼¹å‡ºè½¯é”®ç›˜çš„é—®é¢˜/","link":"","permalink":"http://github.com/2017/01/20/ã€Androidã€‘AlertDialogä¸­çš„EditTextä¸èƒ½å¼¹å‡ºè½¯é”®ç›˜çš„é—®é¢˜/","excerpt":"æ‘˜è¦AlertDialogä¸­åŠ å…¥EditTextä½†æ˜¯ä¸å¼¹å‡ºè½¯é”®ç›˜ç­‰é—®é¢˜ç½‘ä¸Šæœ‰å¾ˆå¤šä¸ç®¡ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œæœ‰çš„æ–¹æ¡ˆæ˜¯å¼ºåˆ¶å¼¹å‡ºè½¯é”®ç›˜ï¼Œç„¶è€Œå³ä½¿å¼¹å‡ºæ¥ï¼Œä¹Ÿæ˜¯æ˜¾ç¤ºåœ¨AlertDialogçš„åé¢ï¼Œè¢«Dialogé®æŒ¡ã€‚ è§£å†³æ–¹æ¡ˆDialogçš„å®˜æ–¹æ–‡æ¡£ï¼šhttp://developer.android.com/reference/android/app/Dialog.html ï¼Œå…¶ä¸­æœ‰ä¸€æ®µï¼š Note: Activities provide a facility to manage the creation, saving and restoring of dialogs. See onCreateDialog(int), onPrepareDialog(int, Dialog), showDialog(int), and dismissDialog(int). If these methods are used, getOwnerActivity() will return the Activity that managed this dialog.","text":"æ‘˜è¦AlertDialogä¸­åŠ å…¥EditTextä½†æ˜¯ä¸å¼¹å‡ºè½¯é”®ç›˜ç­‰é—®é¢˜ç½‘ä¸Šæœ‰å¾ˆå¤šä¸ç®¡ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œæœ‰çš„æ–¹æ¡ˆæ˜¯å¼ºåˆ¶å¼¹å‡ºè½¯é”®ç›˜ï¼Œç„¶è€Œå³ä½¿å¼¹å‡ºæ¥ï¼Œä¹Ÿæ˜¯æ˜¾ç¤ºåœ¨AlertDialogçš„åé¢ï¼Œè¢«Dialogé®æŒ¡ã€‚ è§£å†³æ–¹æ¡ˆDialogçš„å®˜æ–¹æ–‡æ¡£ï¼šhttp://developer.android.com/reference/android/app/Dialog.html ï¼Œå…¶ä¸­æœ‰ä¸€æ®µï¼š Note: Activities provide a facility to manage the creation, saving and restoring of dialogs. See onCreateDialog(int), onPrepareDialog(int, Dialog), showDialog(int), and dismissDialog(int). If these methods are used, getOwnerActivity() will return the Activity that managed this dialog. Often you will want to have a Dialog display on top of the current input method, because there is no reason for it to accept text. You can do this by setting the WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM window flag (assuming your Dialog takes input focus, as it the default) with the following code:12getWindow().setFlags(WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM, WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM); è¿™æ®µè¯çš„å¤§æ¦‚æ„æ€æ˜¯è¯´ï¼ŒWindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM è¿™ä¸ªå‚æ•°ä¼šè®©Dialogé®æŒ¡ä½è½¯é”®ç›˜ï¼Œæ˜¾ç¤ºåœ¨è½¯é”®ç›˜çš„å‰é¢ã€‚ è¿™æ˜¯é»˜è®¤æƒ…å†µä¸‹éšè—è½¯é”®ç›˜çš„æ–¹æ³•ï¼Œè¦é‡æ–°æ˜¾ç¤ºè½¯é”®ç›˜ï¼Œè¦æ‰§è¡Œä¸‹é¢è¿™æ®µä»£ç ï¼š 1alertDialog.getWindow().clearFlags(WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM); æˆ‘æ˜¯æŠŠå®ƒå†™åœ¨äº†setOnFocusChangeListeneré‡Œï¼Œèµ·æ•ˆäº† 12345678910editText.setOnFocusChangeListener(new View.OnFocusChangeListener() &#123; @Override public void onFocusChange(View view, boolean focused) &#123; if (focused) &#123; //dialogå¼¹å‡ºè½¯é”®ç›˜ alertDialog.getWindow() .clearFlags(WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM); &#125; &#125;&#125;); AlertDialog.setView()åˆ™ä¸ä¼šå‡ºç°ä»¥ä¸Šé—®é¢˜ã€‚ å¦å¤–ä¸ºäº†é˜²æ­¢å¼¹å‡ºè¾“å…¥æ³•æ—¶æŠŠåé¢çš„èƒŒæ™¯æŒ¤å˜å½¢ï¼Œå¯ä»¥åœ¨Manifesté‡Œçš„ç›¸åº”Activityæ·»åŠ ï¼š 1android:windowSoftInputMode=\"adjustPan|stateHidden\" åƒè¿™æ ·ï¼š 123456789&lt;activity android:name=\".MainActivity\" android:windowSoftInputMode=\"adjustPan|stateHidden\" android:label=\"@string/app_name\"&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.MAIN\" /&gt; &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt; &lt;/intent-filter&gt;&lt;/activity&gt; ã€å‚è€ƒèµ„æ–™ã€‘1ã€å…³äºAlertDialogä¸­EditTextä¸èƒ½å¼¹å‡ºè¾“å…¥æ³•è§£å†³æ–¹æ³•","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘TextViewä¸­ä¸åŒå¤§å°å­—ä½“å¦‚ä½•ä¸Šä¸‹å‚ç›´å±…ä¸­ï¼Ÿ","slug":"ã€Androidã€‘TextViewä¸­ä¸åŒå¤§å°å­—ä½“å¦‚ä½•ä¸Šä¸‹å‚ç›´å±…ä¸­ï¼Ÿ","date":"2017-01-03T09:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2017/01/03/ã€Androidã€‘TextViewä¸­ä¸åŒå¤§å°å­—ä½“å¦‚ä½•ä¸Šä¸‹å‚ç›´å±…ä¸­ï¼Ÿ/","link":"","permalink":"http://github.com/2017/01/03/ã€Androidã€‘TextViewä¸­ä¸åŒå¤§å°å­—ä½“å¦‚ä½•ä¸Šä¸‹å‚ç›´å±…ä¸­ï¼Ÿ/","excerpt":"å‰è¨€åœ¨å®¢æˆ·ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦å¯¹ä¸€ä¸ªTextViewçš„æ–‡å­—çš„éƒ¨åˆ†å†…å®¹è¿›è¡Œç‰¹æ®ŠåŒ–å¤„ç†ï¼Œæ¯”å¦‚åŠ ç²—ã€æ”¹å˜é¢œè‰²ã€åŠ é“¾æ¥ã€ä¸‹åˆ’çº¿ç­‰ã€‚iOSä¸ºæˆ‘ä»¬æä¾›äº†AttributedStringï¼Œè€ŒAndroidåˆ™æä¾›äº†SpannableStringã€‚ åœ¨Androidçš„android.text.styleåŒ…ä¸‹ä¸ºæˆ‘ä»¬æä¾›äº†å„ç§å„æ ·çš„spanï¼ˆå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼‰ï¼Œä¾‹å¦‚ï¼š AbsoluteSizeSpan(int size) â€”â€” è®¾ç½®å­—ä½“å¤§å°ï¼Œå‚æ•°æ˜¯ç»å¯¹æ•°å€¼ï¼Œç›¸å½“äºWordä¸­çš„å­—ä½“å¤§å° RelativeSizeSpan(float proportion) â€”â€” è®¾ç½®å­—ä½“å¤§å°ï¼Œå‚æ•°æ˜¯ç›¸å¯¹äºé»˜è®¤å­—ä½“å¤§å°çš„å€æ•°ï¼Œæ¯”å¦‚é»˜è®¤å­—ä½“å¤§å°æ˜¯x, é‚£ä¹ˆè®¾ç½®åçš„å­—ä½“å¤§å°å°±æ˜¯x*proportionï¼Œè¿™ä¸ªç”¨èµ·æ¥æ¯”è¾ƒçµæ´»ï¼Œproportion&gt;1å°±æ˜¯æ”¾å¤§(zoom in), proportion&lt;1å°±æ˜¯ç¼©å°(zoom out) BackgroundColorSpan(int color) â€”â€” èƒŒæ™¯ç€è‰²ï¼Œå‚æ•°æ˜¯é¢œè‰²æ•°å€¼ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨android.graphics.Coloré‡Œé¢å®šä¹‰çš„å¸¸é‡ï¼Œæˆ–æ˜¯ç”¨Color.rgb(int, int, int) ForegroundColorSpan(int color) â€”â€” å‰æ™¯ç€è‰²ï¼Œä¹Ÿå°±æ˜¯å­—çš„ç€è‰²ï¼Œå‚æ•°ä¸èƒŒæ™¯ç€è‰²ä¸€è‡´","text":"å‰è¨€åœ¨å®¢æˆ·ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦å¯¹ä¸€ä¸ªTextViewçš„æ–‡å­—çš„éƒ¨åˆ†å†…å®¹è¿›è¡Œç‰¹æ®ŠåŒ–å¤„ç†ï¼Œæ¯”å¦‚åŠ ç²—ã€æ”¹å˜é¢œè‰²ã€åŠ é“¾æ¥ã€ä¸‹åˆ’çº¿ç­‰ã€‚iOSä¸ºæˆ‘ä»¬æä¾›äº†AttributedStringï¼Œè€ŒAndroidåˆ™æä¾›äº†SpannableStringã€‚ åœ¨Androidçš„android.text.styleåŒ…ä¸‹ä¸ºæˆ‘ä»¬æä¾›äº†å„ç§å„æ ·çš„spanï¼ˆå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼‰ï¼Œä¾‹å¦‚ï¼š AbsoluteSizeSpan(int size) â€”â€” è®¾ç½®å­—ä½“å¤§å°ï¼Œå‚æ•°æ˜¯ç»å¯¹æ•°å€¼ï¼Œç›¸å½“äºWordä¸­çš„å­—ä½“å¤§å° RelativeSizeSpan(float proportion) â€”â€” è®¾ç½®å­—ä½“å¤§å°ï¼Œå‚æ•°æ˜¯ç›¸å¯¹äºé»˜è®¤å­—ä½“å¤§å°çš„å€æ•°ï¼Œæ¯”å¦‚é»˜è®¤å­—ä½“å¤§å°æ˜¯x, é‚£ä¹ˆè®¾ç½®åçš„å­—ä½“å¤§å°å°±æ˜¯x*proportionï¼Œè¿™ä¸ªç”¨èµ·æ¥æ¯”è¾ƒçµæ´»ï¼Œproportion&gt;1å°±æ˜¯æ”¾å¤§(zoom in), proportion&lt;1å°±æ˜¯ç¼©å°(zoom out) BackgroundColorSpan(int color) â€”â€” èƒŒæ™¯ç€è‰²ï¼Œå‚æ•°æ˜¯é¢œè‰²æ•°å€¼ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨android.graphics.Coloré‡Œé¢å®šä¹‰çš„å¸¸é‡ï¼Œæˆ–æ˜¯ç”¨Color.rgb(int, int, int) ForegroundColorSpan(int color) â€”â€” å‰æ™¯ç€è‰²ï¼Œä¹Ÿå°±æ˜¯å­—çš„ç€è‰²ï¼Œå‚æ•°ä¸èƒŒæ™¯ç€è‰²ä¸€è‡´ é—®é¢˜ç½‘ä¸Šå·²ç»æœ‰ç€å¾ˆå¤šä½¿ç”¨è¿™äº›spançš„æ•™ç¨‹äº†ï¼Œæ‰€ä»¥æ²¡å¿…è¦åœ¨è¿™é‡Œç»§ç»­æ¢è®¨è¿™äº›åŸºç¡€ä½¿ç”¨äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨äº†AbsoluteSizeSpan(int size) åœ¨åŒä¸€ä¸ªTextViewä¸­å®šä¹‰äº†ä¸åŒå­—ä½“å¤§å°ï¼Œå°±ä¼šé»˜è®¤æ˜¾ç¤ºæˆåº•éƒ¨å¯¹é½çš„æ–¹å¼ï¼š è¯´åˆ°è¿™é‡Œï¼Œç¬¬ä¸€ååº”è‚¯å®šæ˜¯tv.setGravity(Gravity.CENTER_VERTICAL)ï¼Œä½†æ˜¯å¾ˆä¸å¹¸ï¼Œæ€ä¹ˆè¯•éƒ½ä¸å‡‘æ•ˆã€‚é‚£ä¹ˆåˆ°åº•æœ‰æ²¡æœ‰åŠæ³•ä½¿ç”¨Spanè®©ä¸åŒå­—ä½“å¤§å°çš„å‚ç›´å±…ä¸­å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šå½“ç„¶å¯ä»¥ï¼Œå¾—ç”¨ReplacementSpan åˆ†æä¸ºä½•æ˜¯ReplacementSpanï¼Ÿå®ƒæ˜¯ç³»ç»Ÿæä¾›ç»™æˆ‘ä»¬çš„ä¸€ä¸ªæŠ½è±¡ç±»ã€‚é€šè¿‡åå­—æˆ‘ä»¬å¯ä»¥çŸ¥é“å…¶å®ç”¨äºæ˜¯ç”¨äºæ›¿æ¢ã€‚æŒ‡ç¤ºæˆ‘ä»¬å¯ä»¥æŠŠæ–‡æœ¬çš„æŸä¸€éƒ¨åˆ†æ›¿æ¢æˆæˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚è¿™ä¹Ÿè®¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ Relpacementçš„å®šä¹‰å¾ˆç®€å•ï¼š 123456789public abstract class ReplacementSpan extends MetricAffectingSpan &#123; public abstract int getSize(Paint paint, CharSequence text, int start, int end, Paint.FontMetricsInt fm); public abstract void draw(Canvas canvas, CharSequence text, int start, int end, float x, int top, int y, int bottom, Paint paint); public void updateMeasureState(TextPaint p) &#123; &#125; public void updateDrawState(TextPaint ds) &#123; &#125;&#125; æˆ‘ä»¬åœ¨ç»§æ‰¿å®ƒçš„æ—¶å€™ï¼Œéœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•getSize()å’Œdraw()ã€‚é€šè¿‡æ–¹æ³•åï¼Œæˆ‘ä»¬ä¹Ÿè®¸èƒ½å¤ŸçŸ¥é“å…¶ä½œç”¨ï¼šgetSize()ç”¨äºç¡®å®šspançš„å¤§å°ï¼ˆå®é™…ä¸Šåªæ˜¯ä¸€ä¸ªå®½åº¦ï¼‰ï¼Œdraw()ç”¨äºç»˜åˆ¶æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚ ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œè¿™äº›æ–¹æ³•çš„ä¼ å‚æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä½•getSize()åªè¿”å›äº†ä¸€ä¸ªintå€¼ï¼Ÿ äº†è§£äº†è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œå°±åŸºæœ¬å¼„æ‡‚äº†è‡ªå®šä¹‰spanã€‚æ¥å›ç­”è¿™ä¸¤ä¸ªé—®é¢˜å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ˜ç¡®çš„ä¸€ä»¶äº‹æƒ…æ˜¯ï¼šspanæ˜¯ç”¨äºSpannableStringä¸­ï¼Œå¹¶ä¸”æœ€ç»ˆè¢«ç”¨äºTextViewä¸­ã€‚æ‰€ä»¥åœ¨å®šä¹‰spanæ—¶ï¼Œæˆ‘ä»¬çš„å¤§å°ã€ç»˜åˆ¶å†…å®¹éƒ½åº”è¯¥ä¾èµ–äºä½¿ç”¨æ—¶çš„ç¯å¢ƒã€‚æˆ‘ä»¬å‡è®¾è‡ªå®šä¹‰spanä½¿ç”¨çš„ç¯å¢ƒä¸ºA,é‚£ä¹ˆAå°†åŒ…æ¢ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šbaselineã€Paintã€FontMetricsIntç­‰ä¿¡æ¯ã€‚ é‚£æˆ‘ä»¬ç°åœ¨æ¥çœ‹çœ‹getSize()æ–¹æ³•ã€‚getSize()çš„è¿”å›å€¼æ˜¯intï¼Œå…¶å®è¿™ä¸ªå€¼æŒ‡çš„æ˜¯è‡ªå®šä¹‰spançš„å®½åº¦ï¼Œé‚£å®ƒçš„é«˜åº¦å‘¢ï¼Ÿå…¶å®é«˜åº¦æ˜¯å·²çŸ¥çš„ï¼Œé‚£å°±æ˜¯å¤–ç•Œç¯å¢ƒAå¸¦æ¥çš„å­—çš„é«˜åº¦ã€‚ä½†æˆ‘æŸäº›æƒ…å†µæˆ‘ä»¬å¸Œæœ›æ”¹å˜spançš„é«˜åº¦ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ å¦‚æœå¯¹Androidä¸Šå­—ä½“ç»˜åˆ¶æœ‰ä¸€å®šäº†è§£çš„åŒå­¦ä¼šçŸ¥é“ï¼Œä¸€ä¸ªå­—çš„é«˜åº¦å–å†³äºç»˜åˆ¶è¿™ä¸ªå­çš„Paint.FontMetricsInt ä»€ä¹ˆæ˜¯ Paint.FontMetricså®ƒè¡¨ç¤ºç»˜åˆ¶å­—ä½“æ—¶çš„åº¦é‡æ ‡å‡†ã€‚googleçš„å®˜æ–¹apiæ–‡æ¡£å¯¹å®ƒçš„å­—æ®µè¯´æ˜å¦‚ä¸‹ï¼š Type Fields public float ascent - The recommended distance above the baseline for singled spaced text. public float bottom - The maximum distance below the baseline for the lowest glyph in the font at a given text size. public float descent - The recommended distance below the baseline for singled spaced text. public float leading - The recommended additional space to add between lines of text. public float top - The maximum distance above the baseline for the tallest glyph in the font at a given text size. å…¶ä¸­ï¼š ascent : å­—ä½“æœ€ä¸Šç«¯åˆ°åŸºçº¿çš„è·ç¦»ï¼Œä¸ºè´Ÿå€¼ã€‚ descentï¼šå­—ä½“æœ€ä¸‹ç«¯åˆ°åŸºçº¿çš„è·ç¦»ï¼Œä¸ºæ­£å€¼ã€‚ å¦‚ä¸Šå›¾ï¼Œä¸­é—´é‚£æ¡çº¿ï¼ˆBaselineï¼‰å°±æ˜¯åŸºçº¿ï¼ŒåŸºçº¿åˆ°ä¸Šé¢é‚£æ¡çº¿çš„è·ç¦»å°±æ˜¯ascentï¼ŒåŸºçº¿åˆ°ä¸‹é¢é‚£æ¡çº¿çš„è·ç¦»å°±æ˜¯descentã€‚ å›åˆ°æˆ‘ä»¬çš„ä¸»é¢˜ï¼Œ æˆ‘ä»¬å‘ç°getSize()æ–¹æ³•çš„å‚æ•°ä¸­æœ‰Paint.FontMetricsIntï¼Œé‚£æˆ‘ä»¬æ˜¯å¦å°±å¯ä»¥é€šè¿‡æ”¹å˜ä¼ å…¥çš„Paint.FontMetricsIntçš„asentå’Œdesentæ¥è¾¾åˆ°æ”¹å˜é«˜åº¦çš„ç›®çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯è¡Œçš„ã€‚ è§£å†³æ–¹æ³•æŒ‰ç…§ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬ç»§æ‰¿ReplacementSpan è‡ªå®šä¹‰ä¸€ä¸ªSpan 12345678910111213141516171819202122232425262728293031/** * ä½¿TextViewä¸­ä¸åŒå¤§å°å­—ä½“å‚ç›´å±…ä¸­ */public class CustomVerticalCenterSpan extends ReplacementSpan &#123; private int fontSizeSp; //å­—ä½“å¤§å°sp public CustomVerticalCenterSpan(int fontSizeSp)&#123; this.fontSizeSp = fontSizeSp; &#125; @Override public int getSize(Paint paint, CharSequence text, int start, int end, Paint.FontMetricsInt fm) &#123; text = text.subSequence(start, end); Paint p = getCustomTextPaint(paint); return (int) p.measureText(text.toString()); &#125; @Override public void draw(Canvas canvas, CharSequence text, int start, int end, float x, int top, int y, int bottom, Paint paint) &#123; text = text.subSequence(start, end); Paint p = getCustomTextPaint(paint); Paint.FontMetricsInt fm = p.getFontMetricsInt(); canvas.drawText(text.toString(), x, y - ((y + fm.descent + y + fm.ascent) / 2 - (bottom + top) / 2), p); //æ­¤å¤„é‡æ–°è®¡ç®—yåæ ‡ï¼Œä½¿å­—ä½“å±…ä¸­ &#125; private TextPaint getCustomTextPaint(Paint srcPaint) &#123; TextPaint paint = new TextPaint(srcPaint); paint.setTextSize(ViewUtils.getSpPixel(mContext, fontSizeSp)); //è®¾å®šå­—ä½“å¤§å°, spè½¬æ¢ä¸ºpx return paint; &#125;&#125; è§£é‡Šä¸‹å½¢å‚ï¼š xï¼šè¦ç»˜åˆ¶çš„imageçš„å·¦è¾¹æ¡†åˆ°textviewå·¦è¾¹æ¡†çš„è·ç¦»ã€‚ yï¼šè¦æ›¿æ¢çš„æ–‡å­—çš„åŸºçº¿ï¼ˆBaselineï¼‰çš„çºµåæ ‡ã€‚ topï¼šæ›¿æ¢è¡Œçš„æœ€é¡¶éƒ¨ä½ç½®ã€‚ bottomï¼šæ›¿æ¢è¡Œçš„æœ€åº•éƒ¨ä½ç½®ã€‚æ³¨æ„ï¼Œtextviewä¸­ä¸¤è¡Œä¹‹é—´çš„è¡Œé—´è·æ˜¯å±äºä¸Šä¸€è¡Œçš„ï¼Œæ‰€ä»¥è¿™é‡Œbottomæ˜¯æŒ‡è¡Œé—´éš”çš„åº•éƒ¨ä½ç½®ã€‚ paintï¼šç”»ç¬”ï¼ŒåŒ…å«äº†è¦ç»˜åˆ¶å­—ä½“çš„åº¦é‡ä¿¡æ¯ã€‚ æ‰€ä»¥å°±æœ‰ï¼š y + fm.descentï¼šå¾—åˆ°å­—ä½“çš„descentçº¿åæ ‡ï¼› y + fm.ascentï¼šå¾—åˆ°å­—ä½“çš„ascentçº¿åæ ‡ï¼› (y + fm.descent + y + fm.ascent) / 2 ä¹Ÿå°±æ˜¯å­—ä½“ä¸­é—´çº¿çš„çºµåæ ‡ ((y + fm.descent + y + fm.ascent) / 2 - (bottom + top) / 2) å°±æ˜¯å­—ä½“éœ€è¦å‘ä¸Šè°ƒæ•´çš„è·ç¦» ä½¿ç”¨æ–¹å¼12345SpannableString ss = new SpannableString(disStr + unitString);ss.setSpan(new AbsoluteSizeSpan(40, true), 0, disStr.length(), Spannable.SPAN_EXCLUSIVE_INCLUSIVE);//å‚ç›´å±…ä¸­æ˜¾ç¤ºæ–‡å­—ss.setSpan(new CustomVerticalCenterSpan(23), disStr.length(), ss.length(), Spannable.SPAN_EXCLUSIVE_INCLUSIVE); çœ‹çœ‹æ•ˆæœï¼š ã€å‚è€ƒèµ„æ–™ã€‘ How to make RelativeSizeSpan align to topï¼Ÿ How to create vertically aligned superscript and subscript in TextView æ•™ä½ è‡ªå®šä¹‰androidä¸­span Android ImageSpanä¸TextViewä¸­çš„textå±…ä¸­å¯¹é½é—®é¢˜è§£å†³ï¼ˆæ— è®ºTextViewè®¾ç½®è¡Œè·ä¸å¦ï¼‰","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Javaã€‘æ³›å‹ä¸­ extends å’Œ super çš„åŒºåˆ«ï¼Ÿ","slug":"ã€Javaã€‘æ³›å‹ä¸­ extends å’Œ super çš„åŒºåˆ«ï¼Ÿ","date":"2016-12-27T06:46:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/12/27/ã€Javaã€‘æ³›å‹ä¸­ extends å’Œ super çš„åŒºåˆ«ï¼Ÿ/","link":"","permalink":"http://github.com/2016/12/27/ã€Javaã€‘æ³›å‹ä¸­ extends å’Œ super çš„åŒºåˆ«ï¼Ÿ/","excerpt":"&lt;? extends T&gt;å’Œ&lt;? super T&gt;æ˜¯Javaæ³›å‹ä¸­çš„â€œé€šé…ç¬¦ï¼ˆWildcardsï¼‰â€å’Œâ€œè¾¹ç•Œï¼ˆBoundsï¼‰â€çš„æ¦‚å¿µã€‚ &lt;? extends T&gt;ï¼šæ˜¯æŒ‡ â€œä¸Šç•Œé€šé…ç¬¦ï¼ˆUpper Bounds Wildcardsï¼‰â€ &lt;? super T&gt;ï¼šæ˜¯æŒ‡ â€œä¸‹ç•Œé€šé…ç¬¦ï¼ˆLower Bounds Wildcardsï¼‰â€ ä¸ºä»€ä¹ˆè¦ç”¨é€šé…ç¬¦å’Œè¾¹ç•Œï¼Ÿä½¿ç”¨æ³›å‹çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸å‡ºç°ä¸€ç§å¾ˆåˆ«æ‰­çš„æƒ…å†µã€‚æ¯”å¦‚æŒ‰ç…§é¢˜ä¸»çš„ä¾‹å­ï¼Œæˆ‘ä»¬æœ‰Fruitç±»ï¼Œå’Œå®ƒçš„æ´¾ç”Ÿç±»Appleç±»ã€‚ 12class Fruit &#123;&#125;class Apple extends Fruit &#123;&#125; ç„¶åæœ‰ä¸€ä¸ªæœ€ç®€å•çš„å®¹å™¨ï¼šPlateç±»ã€‚ç›˜å­é‡Œå¯ä»¥æ”¾ä¸€ä¸ªæ³›å‹çš„â€œä¸œè¥¿â€ã€‚æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªä¸œè¥¿åšæœ€ç®€å•çš„â€œæ”¾â€å’Œâ€œå–â€çš„åŠ¨ä½œï¼šset( )å’Œget( )æ–¹æ³•ã€‚ 123456class Plate&lt;T&gt;&#123; private T item; public Plate(T t)&#123;item=t;&#125; public void set(T t)&#123;item=t;&#125; public T get()&#123;return item;&#125;&#125;","text":"&lt;? extends T&gt;å’Œ&lt;? super T&gt;æ˜¯Javaæ³›å‹ä¸­çš„â€œé€šé…ç¬¦ï¼ˆWildcardsï¼‰â€å’Œâ€œè¾¹ç•Œï¼ˆBoundsï¼‰â€çš„æ¦‚å¿µã€‚ &lt;? extends T&gt;ï¼šæ˜¯æŒ‡ â€œä¸Šç•Œé€šé…ç¬¦ï¼ˆUpper Bounds Wildcardsï¼‰â€ &lt;? super T&gt;ï¼šæ˜¯æŒ‡ â€œä¸‹ç•Œé€šé…ç¬¦ï¼ˆLower Bounds Wildcardsï¼‰â€ ä¸ºä»€ä¹ˆè¦ç”¨é€šé…ç¬¦å’Œè¾¹ç•Œï¼Ÿä½¿ç”¨æ³›å‹çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸å‡ºç°ä¸€ç§å¾ˆåˆ«æ‰­çš„æƒ…å†µã€‚æ¯”å¦‚æŒ‰ç…§é¢˜ä¸»çš„ä¾‹å­ï¼Œæˆ‘ä»¬æœ‰Fruitç±»ï¼Œå’Œå®ƒçš„æ´¾ç”Ÿç±»Appleç±»ã€‚ 12class Fruit &#123;&#125;class Apple extends Fruit &#123;&#125; ç„¶åæœ‰ä¸€ä¸ªæœ€ç®€å•çš„å®¹å™¨ï¼šPlateç±»ã€‚ç›˜å­é‡Œå¯ä»¥æ”¾ä¸€ä¸ªæ³›å‹çš„â€œä¸œè¥¿â€ã€‚æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªä¸œè¥¿åšæœ€ç®€å•çš„â€œæ”¾â€å’Œâ€œå–â€çš„åŠ¨ä½œï¼šset( )å’Œget( )æ–¹æ³•ã€‚ 123456class Plate&lt;T&gt;&#123; private T item; public Plate(T t)&#123;item=t;&#125; public void set(T t)&#123;item=t;&#125; public T get()&#123;return item;&#125;&#125; ç°åœ¨æˆ‘å®šä¹‰ä¸€ä¸ªâ€œæ°´æœç›˜å­â€ï¼Œé€»è¾‘ä¸Šæ°´æœç›˜å­å½“ç„¶å¯ä»¥è£…è‹¹æœã€‚ 1Plate&lt;Fruit&gt; p=new Plate&lt;Apple&gt;(new Apple()); ä½†å®é™…ä¸ŠJavaç¼–è¯‘å™¨ä¸å…è®¸è¿™ä¸ªæ“ä½œã€‚ä¼šæŠ¥é”™ï¼Œâ€œè£…è‹¹æœçš„ç›˜å­â€æ— æ³•è½¬æ¢æˆâ€œè£…æ°´æœçš„ç›˜å­â€ã€‚ 1error: incompatible types: Plate&lt;Apple&gt; cannot be converted to Plate&lt;Fruit&gt; æ‰€ä»¥æˆ‘çš„å°´å°¬ç—‡å°±çŠ¯äº†ã€‚å®é™…ä¸Šï¼Œç¼–è¯‘å™¨è„‘è¢‹é‡Œè®¤å®šçš„é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š è‹¹æœ IS-A æ°´æœ è£…è‹¹æœçš„ç›˜å­ NOT-IS-A è£…æ°´æœçš„ç›˜å­ æ‰€ä»¥ï¼Œå°±ç®—å®¹å™¨é‡Œè£…çš„ä¸œè¥¿ä¹‹é—´æœ‰ç»§æ‰¿å…³ç³»ï¼Œä½†å®¹å™¨ä¹‹é—´æ˜¯æ²¡æœ‰ç»§æ‰¿å…³ç³»çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å¯ä»¥æŠŠPlateçš„å¼•ç”¨ä¼ é€’ç»™Plateã€‚ ä¸ºäº†è®©æ³›å‹ç”¨èµ·æ¥æ›´èˆ’æœï¼ŒSunçš„å¤§è„‘è¢‹ä»¬å°±æƒ³å‡ºäº†&lt;? extends T&gt;å’Œ&lt;? super T&gt;çš„åŠæ³•ï¼Œæ¥è®©â€œæ°´æœç›˜å­â€å’Œâ€œè‹¹æœç›˜å­â€ä¹‹é—´å‘ç”Ÿå…³ç³»ã€‚ ä»€ä¹ˆæ˜¯ä¸Šç•Œï¼Ÿä¸‹é¢ä»£ç å°±æ˜¯â€œä¸Šç•Œé€šé…ç¬¦ï¼ˆUpper Bounds Wildcardsï¼‰â€ï¼š 1Plate&lt;ï¼Ÿ extends Fruit&gt; ç¿»è¯‘æˆäººè¯å°±æ˜¯ï¼šä¸€ä¸ªèƒ½æ”¾æ°´æœä»¥åŠä¸€åˆ‡æ˜¯æ°´æœæ´¾ç”Ÿç±»çš„ç›˜å­ã€‚å†ç›´ç™½ç‚¹å°±æ˜¯ï¼šå•¥æ°´æœéƒ½èƒ½æ”¾çš„ç›˜å­ã€‚è¿™å’Œæˆ‘ä»¬äººç±»çš„é€»è¾‘å°±æ¯”è¾ƒæ¥è¿‘äº†ã€‚Plate&lt;ï¼Ÿ extends Fruit&gt;å’ŒPlate&lt;Apple&gt;æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼šPlate&lt;ï¼Ÿ extends Fruit&gt;æ˜¯Plate&lt;Fruit&gt;ä»¥åŠPlate&lt;Apple&gt;çš„åŸºç±»ã€‚ç›´æ¥çš„å¥½å¤„å°±æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨â€œè‹¹æœç›˜å­â€ç»™â€œæ°´æœç›˜å­â€èµ‹å€¼äº†ã€‚ 1Plate&lt;? extends Fruit&gt; p=new Plate&lt;Apple&gt;(new Apple()); å¦‚æœæŠŠFruitå’ŒAppleçš„ä¾‹å­å†æ‰©å±•ä¸€ä¸‹ï¼Œé£Ÿç‰©åˆ†æˆæ°´æœå’Œè‚‰ç±»ï¼Œæ°´æœæœ‰è‹¹æœå’Œé¦™è•‰ï¼Œè‚‰ç±»æœ‰çŒªè‚‰å’Œç‰›è‚‰ï¼Œè‹¹æœè¿˜æœ‰ä¸¤ç§é’è‹¹æœå’Œçº¢è‹¹æœã€‚ 12345678910111213141516//Lev 1class Food&#123;&#125;//Lev 2class Fruit extends Food&#123;&#125;class Meat extends Food&#123;&#125;//Lev 3class Apple extends Fruit&#123;&#125;class Banana extends Fruit&#123;&#125;class Pork extends Meat&#123;&#125;class Beef extends Meat&#123;&#125;//Lev 4class RedApple extends Apple&#123;&#125;class GreenApple extends Apple&#123;&#125; åœ¨è¿™ä¸ªä½“ç³»ä¸­ï¼Œä¸‹ç•Œé€šé…ç¬¦ Plate&lt;ï¼Ÿ extends Fruit&gt; è¦†ç›–ä¸‹å›¾ä¸­è“è‰²çš„åŒºåŸŸã€‚ ä»€ä¹ˆæ˜¯ä¸‹ç•Œï¼Ÿç›¸å¯¹åº”çš„ï¼Œâ€œä¸‹ç•Œé€šé…ç¬¦ï¼ˆLower Bounds Wildcardsï¼‰â€ï¼š 1Plate&lt;ï¼Ÿ super Fruit&gt; è¡¨è¾¾çš„å°±æ˜¯ç›¸åçš„æ¦‚å¿µï¼šä¸€ä¸ªèƒ½æ”¾æ°´æœä»¥åŠä¸€åˆ‡æ˜¯æ°´æœåŸºç±»çš„ç›˜å­ã€‚Plate&lt;ï¼Ÿ super Fruit&gt;æ˜¯Plate&lt;Fruit&gt;çš„åŸºç±»ï¼Œä½†ä¸æ˜¯Plate&lt;Apple&gt;çš„åŸºç±»ã€‚å¯¹åº”åˆšæ‰é‚£ä¸ªä¾‹å­ï¼ŒPlate&lt;ï¼Ÿ super Fruit&gt;è¦†ç›–ä¸‹å›¾ä¸­çº¢è‰²çš„åŒºåŸŸã€‚ ä¸Šä¸‹ç•Œé€šé…ç¬¦çš„å‰¯ä½œç”¨è¾¹ç•Œè®©Javaä¸åŒæ³›å‹ä¹‹é—´çš„è½¬æ¢æ›´å®¹æ˜“äº†ã€‚ä½†ä¸è¦å¿˜è®°ï¼Œè¿™æ ·çš„è½¬æ¢ä¹Ÿæœ‰ä¸€å®šçš„å‰¯ä½œç”¨ã€‚é‚£å°±æ˜¯å®¹å™¨çš„éƒ¨åˆ†åŠŸèƒ½å¯èƒ½å¤±æ•ˆã€‚ è¿˜æ˜¯ä»¥åˆšæ‰çš„Plateä¸ºä¾‹ã€‚æˆ‘ä»¬å¯ä»¥å¯¹ç›˜å­åšä¸¤ä»¶äº‹ï¼Œå¾€ç›˜å­é‡Œset()æ–°ä¸œè¥¿ï¼Œä»¥åŠä»ç›˜å­é‡Œget()ä¸œè¥¿ã€‚ 123456class Plate&lt;T&gt;&#123; private T item; public Plate(T t)&#123;item=t;&#125; public void set(T t)&#123;item=t;&#125; public T get()&#123;return item;&#125;&#125; ä¸Šç•Œ&lt;? extends T&gt;ä¸èƒ½å¾€é‡Œå­˜ï¼Œåªèƒ½å¾€å¤–å–&lt;? extends Fruit&gt;ä¼šä½¿å¾€ç›˜å­é‡Œæ”¾ä¸œè¥¿çš„set( )æ–¹æ³•å¤±æ•ˆã€‚ä½†å–ä¸œè¥¿get( )æ–¹æ³•è¿˜æœ‰æ•ˆã€‚æ¯”å¦‚ä¸‹é¢ä¾‹å­é‡Œä¸¤ä¸ªset()æ–¹æ³•ï¼Œæ’å…¥Appleå’ŒFruitéƒ½æŠ¥é”™ã€‚ 12345678910Plate&lt;? extends Fruit&gt; p=new Plate&lt;Apple&gt;(new Apple()); //ä¸èƒ½å­˜å…¥ä»»ä½•å…ƒç´ p.set(new Fruit()); //Errorp.set(new Apple()); //Error//è¯»å–å‡ºæ¥çš„ä¸œè¥¿åªèƒ½å­˜æ”¾åœ¨Fruitæˆ–å®ƒçš„åŸºç±»é‡Œã€‚Fruit newFruit1=p.get();Object newFruit2=p.get();Apple newFruit3=p.get(); //Error åŸå› æ˜¯ç¼–è¯‘å™¨åªçŸ¥é“å®¹å™¨å†…æ˜¯Fruitæˆ–è€…å®ƒçš„æ´¾ç”Ÿç±»ï¼Œä½†å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ä¸çŸ¥é“ã€‚å¯èƒ½æ˜¯Fruitï¼Ÿå¯èƒ½æ˜¯Appleï¼Ÿä¹Ÿå¯èƒ½æ˜¯Bananaï¼ŒRedAppleï¼ŒGreenAppleï¼Ÿç¼–è¯‘å™¨åœ¨çœ‹åˆ°åé¢ç”¨Plateèµ‹å€¼ä»¥åï¼Œç›˜å­é‡Œæ²¡æœ‰è¢«æ ‡ä¸Šæœ‰â€œè‹¹æœâ€ã€‚è€Œæ˜¯æ ‡ä¸Šä¸€ä¸ªå ä½ç¬¦ï¼šCAP#1ï¼Œæ¥è¡¨ç¤ºæ•è·ä¸€ä¸ªFruitæˆ–Fruitçš„å­ç±»ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆç±»ä¸çŸ¥é“ï¼Œä»£å·CAP#1ã€‚ç„¶åæ— è®ºæ˜¯æƒ³å¾€é‡Œæ’å…¥Appleæˆ–è€…Meatæˆ–è€…Fruitç¼–è¯‘å™¨éƒ½ä¸çŸ¥é“èƒ½ä¸èƒ½å’Œè¿™ä¸ªCAP#1åŒ¹é…ï¼Œæ‰€ä»¥å°±éƒ½ä¸å…è®¸ã€‚ æ‰€ä»¥é€šé…ç¬¦&lt;?&gt;å’Œç±»å‹å‚æ•°çš„åŒºåˆ«å°±åœ¨äºï¼Œå¯¹ç¼–è¯‘å™¨æ¥è¯´æ‰€æœ‰çš„Téƒ½ä»£è¡¨åŒä¸€ç§ç±»å‹ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªæ³›å‹æ–¹æ³•é‡Œï¼Œä¸‰ä¸ªTéƒ½æŒ‡ä»£åŒä¸€ä¸ªç±»å‹ï¼Œè¦ä¹ˆéƒ½æ˜¯Stringï¼Œè¦ä¹ˆéƒ½æ˜¯Integerã€‚ 1public &lt;T&gt; List&lt;T&gt; fill(T... t); ä½†é€šé…ç¬¦&lt;?&gt;æ²¡æœ‰è¿™ç§çº¦æŸï¼ŒPlate&lt;?&gt;å•çº¯çš„å°±è¡¨ç¤ºï¼šç›˜å­é‡Œæ”¾äº†ä¸€ä¸ªä¸œè¥¿ï¼Œæ˜¯ä»€ä¹ˆæˆ‘ä¸çŸ¥é“ã€‚ æ‰€ä»¥é¢˜ä¸»é—®é¢˜é‡Œçš„é”™è¯¯å°±åœ¨è¿™é‡Œï¼ŒPlate&lt;ï¼Ÿ extends Fruit&gt;é‡Œä»€ä¹ˆéƒ½æ”¾ä¸è¿›å»ã€‚ ä¸‹ç•Œ&lt;? super T&gt;ä¸å½±å“å¾€é‡Œå­˜ï¼Œä½†å¾€å¤–å–åªèƒ½æ”¾åœ¨Objectå¯¹è±¡é‡Œä½¿ç”¨ä¸‹ç•Œ&lt;? super Fruit&gt;ä¼šä½¿ä»ç›˜å­é‡Œå–ä¸œè¥¿çš„get( )æ–¹æ³•éƒ¨åˆ†å¤±æ•ˆï¼Œåªèƒ½å­˜æ”¾åˆ°Objectå¯¹è±¡é‡Œã€‚set( )æ–¹æ³•æ­£å¸¸ã€‚ 12345678910Plate&lt;? super Fruit&gt; p=new Plate&lt;Fruit&gt;(new Fruit());//å­˜å…¥å…ƒç´ æ­£å¸¸p.set(new Fruit());p.set(new Apple());//è¯»å–å‡ºæ¥çš„ä¸œè¥¿åªèƒ½å­˜æ”¾åœ¨Objectç±»é‡Œã€‚Apple newFruit3=p.get(); //ErrorFruit newFruit1=p.get(); //ErrorObject newFruit2=p.get(); å› ä¸ºä¸‹ç•Œè§„å®šäº†å…ƒç´ çš„æœ€å°ç²’åº¦çš„ä¸‹é™ï¼Œå®é™…ä¸Šæ˜¯æ”¾æ¾äº†å®¹å™¨å…ƒç´ çš„ç±»å‹æ§åˆ¶ã€‚æ—¢ç„¶å…ƒç´ æ˜¯Fruitçš„åŸºç±»ï¼Œé‚£å¾€é‡Œå­˜ç²’åº¦æ¯”Fruitå°çš„éƒ½å¯ä»¥ã€‚ä½†å¾€å¤–è¯»å–å…ƒç´ å°±è´¹åŠ²äº†ï¼Œåªæœ‰æ‰€æœ‰ç±»çš„åŸºç±»Objectå¯¹è±¡æ‰èƒ½è£…ä¸‹ã€‚ä½†è¿™æ ·çš„è¯ï¼Œå…ƒç´ çš„ç±»å‹ä¿¡æ¯å°±å…¨éƒ¨ä¸¢å¤±ã€‚ PECSåŸåˆ™æœ€åçœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯PECSï¼ˆProducer Extends Consumer Superï¼‰åŸåˆ™ï¼Œå·²ç»å¾ˆå¥½ç†è§£äº†ï¼š é¢‘ç¹å¾€å¤–è¯»å–å†…å®¹çš„ï¼Œé€‚åˆç”¨ä¸Šç•ŒExtendsã€‚ ç»å¸¸å¾€é‡Œæ’å…¥çš„ï¼Œé€‚åˆç”¨ä¸‹ç•ŒSuperã€‚ å‚è€ƒèµ„æ–™ Javaæ³›å‹ä¸­extendså’Œsuperçš„åŒºåˆ«ï¼Ÿ","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java Generics","slug":"Java-Generics","permalink":"http://github.com/tags/Java-Generics/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€Javaã€‘æ³›å‹è¯¦è§£","slug":"ã€Javaã€‘æ³›å‹è¯¦è§£","date":"2016-12-27T04:30:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/12/27/ã€Javaã€‘æ³›å‹è¯¦è§£/","link":"","permalink":"http://github.com/2016/12/27/ã€Javaã€‘æ³›å‹è¯¦è§£/","excerpt":"ä¸€. ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬çœ‹ä¸‹ä¸‹é¢è¿™æ®µç®€çŸ­çš„ä»£ç : 1234567891011121314public class GenericTest &#123; public static void main(String[] args) &#123; List list = new ArrayList(); list.add(\"qqyumidi\"); list.add(\"corn\"); list.add(100); for (int i = 0; i &lt; list.size(); i++) &#123; String name = (String) list.get(i); // â‘  é”™è¯¯ System.out.println(\"name:\" + name); &#125; &#125;&#125; å®šä¹‰äº†ä¸€ä¸ªListç±»å‹çš„é›†åˆï¼Œå…ˆå‘å…¶ä¸­åŠ å…¥äº†ä¸¤ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼ï¼ŒéšååŠ å…¥ä¸€ä¸ªIntegerç±»å‹çš„å€¼ã€‚è¿™æ˜¯å®Œå…¨å…è®¸çš„ï¼Œå› ä¸ºæ­¤æ—¶listé»˜è®¤çš„ç±»å‹ä¸ºObjectç±»å‹ã€‚åœ¨ä¹‹åçš„å¾ªç¯ä¸­ï¼Œç”±äºå¿˜è®°äº†ä¹‹å‰åœ¨listä¸­ä¹ŸåŠ å…¥äº†Integerç±»å‹çš„å€¼æˆ–å…¶ä»–ç¼–ç åŸå› ï¼Œå¾ˆå®¹æ˜“å‡ºç°ç±»ä¼¼äº//â‘ ä¸­çš„é”™è¯¯ã€‚å› ä¸ºç¼–è¯‘é˜¶æ®µæ­£å¸¸ï¼Œè€Œè¿è¡Œæ—¶ä¼šå‡ºç°â€œjava.lang.ClassCastExceptionâ€å¼‚å¸¸ã€‚å› æ­¤ï¼Œå¯¼è‡´æ­¤ç±»é”™è¯¯ç¼–ç è¿‡ç¨‹ä¸­ä¸æ˜“å‘ç°ã€‚ åœ¨å¦‚ä¸Šçš„ç¼–ç è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°ä¸»è¦å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š å½“æˆ‘ä»¬å°†ä¸€ä¸ªå¯¹è±¡æ”¾å…¥é›†åˆä¸­ï¼Œé›†åˆä¸ä¼šè®°ä½æ­¤å¯¹è±¡çš„ç±»å‹ï¼Œå½“å†æ¬¡ä»é›†åˆä¸­å–å‡ºæ­¤å¯¹è±¡æ—¶ï¼Œæ”¹å¯¹è±¡çš„ç¼–è¯‘ç±»å‹å˜æˆäº†Objectç±»å‹ï¼Œä½†å…¶è¿è¡Œæ—¶ç±»å‹ä»»ç„¶ä¸ºå…¶æœ¬èº«ç±»å‹ã€‚ å› æ­¤ï¼Œ//â‘  å¤„å–å‡ºé›†åˆå…ƒç´ æ—¶éœ€è¦äººä¸ºçš„å¼ºåˆ¶ç±»å‹è½¬åŒ–åˆ°å…·ä½“çš„ç›®æ ‡ç±»å‹ï¼Œä¸”å¾ˆå®¹æ˜“å‡ºç°â€œjava.lang.ClassCastExceptionâ€å¼‚å¸¸ã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ä½¿é›†åˆèƒ½å¤Ÿè®°ä½é›†åˆå†…å…ƒç´ å„ç±»å‹ï¼Œä¸”èƒ½å¤Ÿè¾¾åˆ°åªè¦ç¼–è¯‘æ—¶ä¸å‡ºç°é—®é¢˜ï¼Œè¿è¡Œæ—¶å°±ä¸ä¼šå‡ºç°â€œjava.lang.ClassCastExceptionâ€å¼‚å¸¸å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ä½¿ç”¨æ³›å‹ã€‚","text":"ä¸€. ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬çœ‹ä¸‹ä¸‹é¢è¿™æ®µç®€çŸ­çš„ä»£ç : 1234567891011121314public class GenericTest &#123; public static void main(String[] args) &#123; List list = new ArrayList(); list.add(\"qqyumidi\"); list.add(\"corn\"); list.add(100); for (int i = 0; i &lt; list.size(); i++) &#123; String name = (String) list.get(i); // â‘  é”™è¯¯ System.out.println(\"name:\" + name); &#125; &#125;&#125; å®šä¹‰äº†ä¸€ä¸ªListç±»å‹çš„é›†åˆï¼Œå…ˆå‘å…¶ä¸­åŠ å…¥äº†ä¸¤ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼ï¼ŒéšååŠ å…¥ä¸€ä¸ªIntegerç±»å‹çš„å€¼ã€‚è¿™æ˜¯å®Œå…¨å…è®¸çš„ï¼Œå› ä¸ºæ­¤æ—¶listé»˜è®¤çš„ç±»å‹ä¸ºObjectç±»å‹ã€‚åœ¨ä¹‹åçš„å¾ªç¯ä¸­ï¼Œç”±äºå¿˜è®°äº†ä¹‹å‰åœ¨listä¸­ä¹ŸåŠ å…¥äº†Integerç±»å‹çš„å€¼æˆ–å…¶ä»–ç¼–ç åŸå› ï¼Œå¾ˆå®¹æ˜“å‡ºç°ç±»ä¼¼äº//â‘ ä¸­çš„é”™è¯¯ã€‚å› ä¸ºç¼–è¯‘é˜¶æ®µæ­£å¸¸ï¼Œè€Œè¿è¡Œæ—¶ä¼šå‡ºç°â€œjava.lang.ClassCastExceptionâ€å¼‚å¸¸ã€‚å› æ­¤ï¼Œå¯¼è‡´æ­¤ç±»é”™è¯¯ç¼–ç è¿‡ç¨‹ä¸­ä¸æ˜“å‘ç°ã€‚ åœ¨å¦‚ä¸Šçš„ç¼–ç è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°ä¸»è¦å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š å½“æˆ‘ä»¬å°†ä¸€ä¸ªå¯¹è±¡æ”¾å…¥é›†åˆä¸­ï¼Œé›†åˆä¸ä¼šè®°ä½æ­¤å¯¹è±¡çš„ç±»å‹ï¼Œå½“å†æ¬¡ä»é›†åˆä¸­å–å‡ºæ­¤å¯¹è±¡æ—¶ï¼Œæ”¹å¯¹è±¡çš„ç¼–è¯‘ç±»å‹å˜æˆäº†Objectç±»å‹ï¼Œä½†å…¶è¿è¡Œæ—¶ç±»å‹ä»»ç„¶ä¸ºå…¶æœ¬èº«ç±»å‹ã€‚ å› æ­¤ï¼Œ//â‘  å¤„å–å‡ºé›†åˆå…ƒç´ æ—¶éœ€è¦äººä¸ºçš„å¼ºåˆ¶ç±»å‹è½¬åŒ–åˆ°å…·ä½“çš„ç›®æ ‡ç±»å‹ï¼Œä¸”å¾ˆå®¹æ˜“å‡ºç°â€œjava.lang.ClassCastExceptionâ€å¼‚å¸¸ã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ä½¿é›†åˆèƒ½å¤Ÿè®°ä½é›†åˆå†…å…ƒç´ å„ç±»å‹ï¼Œä¸”èƒ½å¤Ÿè¾¾åˆ°åªè¦ç¼–è¯‘æ—¶ä¸å‡ºç°é—®é¢˜ï¼Œè¿è¡Œæ—¶å°±ä¸ä¼šå‡ºç°â€œjava.lang.ClassCastExceptionâ€å¼‚å¸¸å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ä½¿ç”¨æ³›å‹ã€‚ äºŒ. ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿæ³›å‹ï¼Œå³â€œå‚æ•°åŒ–ç±»å‹â€ã€‚ä¸€æåˆ°å‚æ•°ï¼Œæœ€ç†Ÿæ‚‰çš„å°±æ˜¯å®šä¹‰æ–¹æ³•æ—¶æœ‰å½¢å‚ï¼Œç„¶åè°ƒç”¨æ­¤æ–¹æ³•æ—¶ä¼ é€’å®å‚ã€‚é‚£ä¹ˆå‚æ•°åŒ–ç±»å‹æ€ä¹ˆç†è§£å‘¢ï¼Ÿé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†ç±»å‹ç”±åŸæ¥çš„å…·ä½“çš„ç±»å‹å‚æ•°åŒ–ï¼Œç±»ä¼¼äºæ–¹æ³•ä¸­çš„å˜é‡å‚æ•°ï¼Œæ­¤æ—¶ç±»å‹ä¹Ÿå®šä¹‰æˆå‚æ•°å½¢å¼ï¼ˆå¯ä»¥ç§°ä¹‹ä¸ºç±»å‹å½¢å‚ï¼‰ï¼Œç„¶ååœ¨ä½¿ç”¨/è°ƒç”¨æ—¶ä¼ å…¥å…·ä½“çš„ç±»å‹ï¼ˆç±»å‹å®å‚ï¼‰ã€‚ çœ‹ç€å¥½åƒæœ‰ç‚¹å¤æ‚ï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹ä¸‹ä¸Šé¢é‚£ä¸ªä¾‹å­é‡‡ç”¨æ³›å‹çš„å†™æ³•ã€‚ 123456789101112131415161718192021public class GenericTest &#123; public static void main(String[] args) &#123; /* List list = new ArrayList(); list.add(\"qqyumidi\"); list.add(\"corn\"); list.add(100); */ List&lt;String&gt; list = new ArrayList&lt;String&gt;(); list.add(\"qqyumidi\"); list.add(\"corn\"); //list.add(100); // 1 æç¤ºç¼–è¯‘é”™è¯¯ for (int i = 0; i &lt; list.size(); i++) &#123; String name = list.get(i); // 2 æ— é¡»è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ System.out.println(\"name:\" + name); &#125; &#125;&#125; é‡‡ç”¨æ³›å‹å†™æ³•åï¼Œåœ¨//1å¤„æƒ³åŠ å…¥ä¸€ä¸ªIntegerç±»å‹çš„å¯¹è±¡æ—¶ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œé€šè¿‡Listï¼Œç›´æ¥é™å®šäº†listé›†åˆä¸­åªèƒ½å«æœ‰Stringç±»å‹çš„å…ƒç´ ï¼Œä»è€Œåœ¨//2 å¤„æ— é¡»è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œå› ä¸ºæ­¤æ—¶ï¼Œé›†åˆèƒ½å¤Ÿè®°ä½å…ƒç´ çš„ç±»å‹ä¿¡æ¯ï¼Œç¼–è¯‘å™¨å·²ç»èƒ½å¤Ÿç¡®è®¤å®ƒæ˜¯Stringç±»å‹äº†ã€‚ ç»“åˆä¸Šé¢çš„æ³›å‹å®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨Listä¸­ï¼ŒStringæ˜¯ç±»å‹å®å‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸åº”çš„Listæ¥å£ä¸­è‚¯å®šå«æœ‰ç±»å‹å½¢å‚ã€‚ä¸”get()æ–¹æ³•çš„è¿”å›ç»“æœä¹Ÿç›´æ¥æ˜¯æ­¤å½¢å‚ç±»å‹ï¼ˆä¹Ÿå°±æ˜¯å¯¹åº”çš„ä¼ å…¥çš„ç±»å‹å®å‚ï¼‰ã€‚ä¸‹é¢å°±æ¥çœ‹çœ‹Listæ¥å£çš„çš„å…·ä½“å®šä¹‰ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public interface List&lt;E&gt; extends Collection&lt;E&gt; &#123; int size(); boolean isEmpty(); boolean contains(Object o); Iterator&lt;E&gt; iterator(); Object[] toArray(); &lt;T&gt; T[] toArray(T[] a); boolean add(E e); boolean remove(Object o); boolean containsAll(Collection&lt;?&gt; c); boolean addAll(Collection&lt;? extends E&gt; c); boolean addAll(int index, Collection&lt;? extends E&gt; c); boolean removeAll(Collection&lt;?&gt; c); boolean retainAll(Collection&lt;?&gt; c); void clear(); boolean equals(Object o); int hashCode(); E get(int index); E set(int index, E element); void add(int index, E element); E remove(int index); int indexOf(Object o); int lastIndexOf(Object o); ListIterator&lt;E&gt; listIterator(); ListIterator&lt;E&gt; listIterator(int index); List&lt;E&gt; subList(int fromIndex, int toIndex);&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨Listæ¥å£ä¸­é‡‡ç”¨æ³›å‹åŒ–å®šä¹‰ä¹‹åï¼Œ&lt;E&gt;ä¸­çš„ E è¡¨ç¤ºç±»å‹å½¢å‚ï¼Œå¯ä»¥æ¥æ”¶å…·ä½“çš„ç±»å‹å®å‚ï¼Œå¹¶ä¸”æ­¤æ¥å£å®šä¹‰ä¸­ï¼Œå‡¡æ˜¯å‡ºç°Eçš„åœ°æ–¹å‡è¡¨ç¤ºç›¸åŒçš„æ¥å—è‡ªå¤–éƒ¨çš„ç±»å‹å®å‚ã€‚ è‡ªç„¶çš„ï¼ŒArrayListä½œä¸ºListæ¥å£çš„å®ç°ç±»ï¼Œå…¶å®šä¹‰å½¢å¼æ˜¯ï¼š 123456789101112131415161718public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable &#123; public boolean add(E e) &#123; ensureCapacityInternal(size + 1); // Increments modCount!! elementData[size++] = e; return true; &#125; public E get(int index) &#123; rangeCheck(index); checkForComodification(); return ArrayList.this.elementData(offset + index); &#125; //...çœç•¥æ‰å…¶ä»–å…·ä½“çš„å®šä¹‰è¿‡ç¨‹&#125; ç”±æ­¤ï¼Œæˆ‘ä»¬ä»æºä»£ç è§’åº¦æ˜ç™½äº†ä¸ºä»€ä¹ˆ//1å¤„åŠ å…¥Integerç±»å‹å¯¹è±¡ç¼–è¯‘é”™è¯¯ï¼Œä¸”//2å¤„get()åˆ°çš„ç±»å‹ç›´æ¥å°±æ˜¯Stringç±»å‹äº†ã€‚ ä¸‰. è‡ªå®šä¹‰æ³›å‹æ¥å£ã€æ³›å‹ç±»å’Œæ³›å‹æ–¹æ³•ä»ä¸Šé¢çš„å†…å®¹ä¸­ï¼Œå¤§å®¶å·²ç»æ˜ç™½äº†æ³›å‹çš„å…·ä½“è¿ä½œè¿‡ç¨‹ã€‚ä¹ŸçŸ¥é“äº†æ¥å£ã€ç±»å’Œæ–¹æ³•ä¹Ÿéƒ½å¯ä»¥ä½¿ç”¨æ³›å‹å»å®šä¹‰ï¼Œä»¥åŠç›¸åº”çš„ä½¿ç”¨ã€‚æ˜¯çš„ï¼Œåœ¨å…·ä½“ä½¿ç”¨æ—¶ï¼Œå¯ä»¥åˆ†ä¸ºæ³›å‹æ¥å£ã€æ³›å‹ç±»å’Œæ³›å‹æ–¹æ³•ã€‚ è‡ªå®šä¹‰æ³›å‹æ¥å£ã€æ³›å‹ç±»å’Œæ³›å‹æ–¹æ³•ä¸ä¸Šè¿°Javaæºç ä¸­çš„Listã€ArrayListç±»ä¼¼ã€‚å¦‚ä¸‹ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸ªæœ€ç®€å•çš„æ³›å‹ç±»å’Œæ–¹æ³•å®šä¹‰ï¼š 123456789101112131415161718192021222324252627public class GenericTest &#123; public static void main(String[] args) &#123; Box&lt;String&gt; name = new Box&lt;String&gt;(\"corn\"); System.out.println(\"name:\" + name.getData()); &#125;&#125;class Box&lt;T&gt; &#123; private T data; public Box() &#123; &#125; public Box(T data) &#123; this.data = data; &#125; public T getData() &#123; return data; &#125;&#125; åœ¨æ³›å‹æ¥å£ã€æ³›å‹ç±»å’Œæ³›å‹æ–¹æ³•çš„å®šä¹‰è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸è§çš„å¦‚Tã€Eã€Kã€Vç­‰å½¢å¼çš„å‚æ•°å¸¸ç”¨äºè¡¨ç¤ºæ³›å‹å½¢å‚ï¼Œç”±äºæ¥æ”¶æ¥è‡ªå¤–éƒ¨ä½¿ç”¨æ—¶å€™ä¼ å…¥çš„ç±»å‹å®å‚ã€‚é‚£ä¹ˆå¯¹äºä¸åŒä¼ å…¥çš„ç±»å‹å®å‚ï¼Œç”Ÿæˆçš„ç›¸åº”å¯¹è±¡å®ä¾‹çš„ç±»å‹æ˜¯ä¸æ˜¯ä¸€æ ·çš„å‘¢ï¼Ÿ 1234567891011121314public class GenericTest &#123; public static void main(String[] args) &#123; Box&lt;String&gt; name = new Box&lt;String&gt;(\"corn\"); Box&lt;Integer&gt; age = new Box&lt;Integer&gt;(712); System.out.println(\"name class:\" + name.getClass()); // com.qqyumidi.Box System.out.println(\"age class:\" + age.getClass()); // com.qqyumidi.Box System.out.println(name.getClass() == age.getClass()); // true &#125;&#125; ç”±æ­¤ï¼Œæˆ‘ä»¬å‘ç°ï¼Œåœ¨ä½¿ç”¨æ³›å‹ç±»æ—¶ï¼Œè™½ç„¶ä¼ å…¥äº†ä¸åŒçš„æ³›å‹å®å‚ï¼Œä½†å¹¶æ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šç”Ÿæˆä¸åŒçš„ç±»å‹ï¼Œä¼ å…¥ä¸åŒæ³›å‹å®å‚çš„æ³›å‹ç±»åœ¨å†…å­˜ä¸Šåªæœ‰ä¸€ä¸ªï¼Œå³è¿˜æ˜¯åŸæ¥çš„æœ€åŸºæœ¬çš„ç±»å‹ï¼ˆæœ¬å®ä¾‹ä¸­ä¸ºBoxï¼‰ï¼Œå½“ç„¶ï¼Œåœ¨é€»è¾‘ä¸Šæˆ‘ä»¬å¯ä»¥ç†è§£æˆå¤šä¸ªä¸åŒçš„æ³›å‹ç±»å‹ã€‚ ç©¶å…¶åŸå› ï¼Œåœ¨äºJavaä¸­çš„æ³›å‹è¿™ä¸€æ¦‚å¿µæå‡ºçš„ç›®çš„ï¼Œå¯¼è‡´å…¶åªæ˜¯ä½œç”¨äºä»£ç ç¼–è¯‘é˜¶æ®µï¼Œåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œå¯¹äºæ­£ç¡®æ£€éªŒæ³›å‹ç»“æœåï¼Œä¼šå°†æ³›å‹çš„ç›¸å…³ä¿¡æ¯æ“¦å‡ºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæˆåŠŸç¼–è¯‘è¿‡åçš„classæ–‡ä»¶ä¸­æ˜¯ä¸åŒ…å«ä»»ä½•æ³›å‹ä¿¡æ¯çš„ã€‚æ³›å‹ä¿¡æ¯ä¸ä¼šè¿›å…¥åˆ°è¿è¡Œæ—¶é˜¶æ®µã€‚ å¯¹æ­¤æ€»ç»“æˆä¸€å¥è¯ï¼šæ³›å‹ç±»å‹åœ¨é€»è¾‘ä¸Šçœ‹ä»¥çœ‹æˆæ˜¯å¤šä¸ªä¸åŒçš„ç±»å‹ï¼Œå®é™…ä¸Šéƒ½æ˜¯ç›¸åŒçš„åŸºæœ¬ç±»å‹ã€‚ å››. ç±»å‹é€šé…ç¬¦æ¥ç€ä¸Šé¢çš„ç»“è®ºï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒBox&lt;Number&gt;å’ŒBox&lt;Integer&gt;å®é™…ä¸Šéƒ½æ˜¯Boxç±»å‹ï¼Œç°åœ¨éœ€è¦ç»§ç»­æ¢è®¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆåœ¨é€»è¾‘ä¸Šï¼Œç±»ä¼¼äºBox&lt;Number&gt;å’ŒBox&lt;Integer&gt;æ˜¯å¦å¯ä»¥çœ‹æˆå…·æœ‰çˆ¶å­å…³ç³»çš„æ³›å‹ç±»å‹å‘¢ï¼Ÿ ä¸ºäº†å¼„æ¸…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ä¸‹ä¸‹é¢è¿™ä¸ªä¾‹å­: 1234567891011121314151617181920public class GenericTest &#123; public static void main(String[] args) &#123; Box&lt;Number&gt; name = new Box&lt;Number&gt;(99); Box&lt;Integer&gt; age = new Box&lt;Integer&gt;(712); getData(name); //The method getData(Box&lt;Number&gt;) in the type GenericTest is //not applicable for the arguments (Box&lt;Integer&gt;) getData(age); // 1 &#125; public static void getData(Box&lt;Number&gt; data)&#123; System.out.println(\"data :\" + data.getData()); &#125;&#125; æˆ‘ä»¬å‘ç°ï¼Œåœ¨ä»£ç //1 å¤„å‡ºç°äº†é”™è¯¯æç¤ºä¿¡æ¯ï¼šThe method getData(Box&lt;Number&gt;) in the t ype GenericTest is not applicable for the arguments (Box&lt;Integer&gt;)ã€‚æ˜¾ç„¶ï¼Œé€šè¿‡æç¤ºä¿¡æ¯ï¼Œæˆ‘ä»¬çŸ¥é“Box&lt;Number&gt;åœ¨é€»è¾‘ä¸Šä¸èƒ½è§†ä¸ºBox&lt;Integer&gt;çš„çˆ¶ç±»ã€‚é‚£ä¹ˆï¼ŒåŸå› ä½•åœ¨å‘¢ï¼Ÿ 1234567891011121314151617181920212223242526272829303132333435363738public class GenericTest &#123; public static void main(String[] args) &#123; Box&lt;Integer&gt; a = new Box&lt;Integer&gt;(712); Box&lt;Number&gt; b = a; // 1 Box&lt;Float&gt; f = new Box&lt;Float&gt;(3.14f); b.setData(f); // 2 &#125; public static void getData(Box&lt;Number&gt; data) &#123; System.out.println(\"data :\" + data.getData()); &#125;&#125;class Box&lt;T&gt; &#123; private T data; public Box() &#123; &#125; public Box(T data) &#123; setData(data); &#125; public T getData() &#123; return data; &#125; public void setData(T data) &#123; this.data = data; &#125;&#125; è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ˜¾ç„¶//1 å’Œ//2 å¤„è‚¯å®šä¼šå‡ºç°é”™è¯¯æç¤ºçš„ã€‚åœ¨æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åè¯æ³•æ¥è¿›è¡Œè¯´æ˜ã€‚ å‡è®¾Box&lt;Number&gt;åœ¨é€»è¾‘ä¸Šå¯ä»¥è§†ä¸ºBox&lt;Integer&gt;çš„çˆ¶ç±»ï¼Œé‚£ä¹ˆ//1å’Œ//2å¤„å°†ä¸ä¼šæœ‰é”™è¯¯æç¤ºäº†ï¼Œé‚£ä¹ˆé—®é¢˜å°±å‡ºæ¥äº†ï¼Œé€šè¿‡getData()æ–¹æ³•å–å‡ºæ•°æ®æ—¶åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹å‘¢ï¼ŸInteger? Float? è¿˜æ˜¯Numberï¼Ÿä¸”ç”±äºåœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­çš„é¡ºåºä¸å¯æ§æ€§ï¼Œå¯¼è‡´åœ¨å¿…è¦çš„æ—¶å€™å¿…é¡»è¦è¿›è¡Œç±»å‹åˆ¤æ–­ï¼Œä¸”è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚æ˜¾ç„¶ï¼Œè¿™ä¸æ³›å‹çš„ç†å¿µçŸ›ç›¾ï¼Œå› æ­¤ï¼Œåœ¨é€»è¾‘ä¸ŠBox&lt;Number&gt;ä¸èƒ½è§†ä¸ºBox&lt;Integer&gt;çš„çˆ¶ç±»ã€‚ å¥½ï¼Œé‚£æˆ‘ä»¬å›è¿‡å¤´æ¥ç»§ç»­çœ‹â€œç±»å‹é€šé…ç¬¦â€ä¸­çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬çŸ¥é“å…¶å…·ä½“çš„é”™è¯¯æç¤ºçš„æ·±å±‚æ¬¡åŸå› äº†ã€‚é‚£ä¹ˆå¦‚ä½•è§£å†³å‘¢ï¼Ÿæ€»éƒ¨èƒ½å†å®šä¹‰ä¸€ä¸ªæ–°çš„å‡½æ•°å§ã€‚è¿™å’ŒJavaä¸­çš„å¤šæ€ç†å¿µæ˜¾ç„¶æ˜¯è¿èƒŒçš„ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœ¨é€»è¾‘ä¸Šå¯ä»¥ç”¨æ¥è¡¨ç¤ºåŒæ—¶æ˜¯Box&lt;Integer&gt;å’ŒBox&lt;Number&gt;çš„çˆ¶ç±»çš„ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œç”±æ­¤ï¼Œç±»å‹é€šé…ç¬¦åº”è¿è€Œç”Ÿã€‚ ç±»å‹é€šé…ç¬¦ä¸€èˆ¬æ˜¯ä½¿ç”¨ ? ä»£æ›¿å…·ä½“çš„ç±»å‹å®å‚ã€‚æ³¨æ„äº†ï¼Œæ­¤å¤„æ˜¯ç±»å‹å®å‚ï¼Œè€Œä¸æ˜¯ç±»å‹å½¢å‚ï¼ä¸”Box&lt;?&gt;åœ¨é€»è¾‘ä¸Šæ˜¯Box&lt;Integer&gt;ã€Box&lt;Number&gt;â€¦ç­‰æ‰€æœ‰Box&lt;å…·ä½“ç±»å‹å®å‚&gt;çš„çˆ¶ç±»ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥å®šä¹‰æ³›å‹æ–¹æ³•ï¼Œæ¥å®Œæˆæ­¤ç±»éœ€æ±‚ã€‚ 123456789101112131415161718public class GenericTest &#123; public static void main(String[] args) &#123; Box&lt;String&gt; name = new Box&lt;String&gt;(\"corn\"); Box&lt;Integer&gt; age = new Box&lt;Integer&gt;(712); Box&lt;Number&gt; number = new Box&lt;Number&gt;(314); getData(name); getData(age); getData(number); &#125; public static void getData(Box&lt;?&gt; data) &#123; System.out.println(\"data :\" + data.getData()); &#125;&#125; æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜å¯èƒ½å¬åˆ°ç±»å‹é€šé…ç¬¦ä¸Šé™å’Œç±»å‹é€šé…ç¬¦ä¸‹é™ã€‚å…·ä½“æœ‰æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœéœ€è¦å®šä¹‰ä¸€ä¸ªåŠŸèƒ½ç±»ä¼¼äºgetData()çš„æ–¹æ³•ï¼Œä½†å¯¹ç±»å‹å®å‚åˆæœ‰è¿›ä¸€æ­¥çš„é™åˆ¶ï¼šåªèƒ½æ˜¯Numberç±»åŠå…¶å­ç±»ã€‚æ­¤æ—¶ï¼Œéœ€è¦ç”¨åˆ°ç±»å‹é€šé…ç¬¦ä¸Šé™ã€‚ 1234567891011121314151617181920212223242526public class GenericTest &#123; public static void main(String[] args) &#123; Box&lt;String&gt; name = new Box&lt;String&gt;(\"corn\"); Box&lt;Integer&gt; age = new Box&lt;Integer&gt;(712); Box&lt;Number&gt; number = new Box&lt;Number&gt;(314); getData(name); getData(age); getData(number); //getUpperNumberData(name); // 1 getUpperNumberData(age); // 2 getUpperNumberData(number); // 3 &#125; public static void getData(Box&lt;?&gt; data) &#123; System.out.println(\"data :\" + data.getData()); &#125; public static void getUpperNumberData(Box&lt;? extends Number&gt; data)&#123; System.out.println(\"data :\" + data.getData()); &#125;&#125; æ­¤æ—¶ï¼Œæ˜¾ç„¶ï¼Œåœ¨ä»£ç //1å¤„è°ƒç”¨å°†å‡ºç°é”™è¯¯æç¤ºï¼Œè€Œ//2 //3å¤„è°ƒç”¨æ­£å¸¸ã€‚ ç±»å‹é€šé…ç¬¦ä¸Šé™é€šè¿‡å½¢å¦‚Box&lt;? extends Number&gt;å½¢å¼å®šä¹‰ï¼Œç›¸å¯¹åº”çš„ï¼Œç±»å‹é€šé…ç¬¦ä¸‹é™ä¸ºBox&lt;? super Number&gt;å½¢å¼ï¼Œå…¶å«ä¹‰ä¸ç±»å‹é€šé…ç¬¦ä¸Šé™æ­£å¥½ç›¸åï¼Œåœ¨æ­¤ä¸ä½œè¿‡å¤šé˜è¿°äº†ã€‚ äº”. è¯å¤–ç¯‡æœ¬æ–‡ä¸­çš„ä¾‹å­ä¸»è¦æ˜¯ä¸ºäº†é˜è¿°æ³›å‹ä¸­çš„ä¸€äº›æ€æƒ³è€Œç®€å•ä¸¾å‡ºçš„ï¼Œå¹¶ä¸ä¸€å®šæœ‰ç€å®é™…çš„å¯ç”¨æ€§ã€‚å¦å¤–ï¼Œä¸€æåˆ°æ³›å‹ï¼Œç›¸ä¿¡å¤§å®¶ç”¨åˆ°æœ€å¤šçš„å°±æ˜¯åœ¨é›†åˆä¸­ï¼Œå…¶å®ï¼Œåœ¨å®é™…çš„ç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œè‡ªå·±å¯ä»¥ä½¿ç”¨æ³›å‹å»ç®€åŒ–å¼€å‘ï¼Œä¸”èƒ½å¾ˆå¥½çš„ä¿è¯ä»£ç è´¨é‡ã€‚å¹¶ä¸”è¿˜è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒJavaä¸­æ²¡æœ‰æ‰€è°“çš„æ³›å‹æ•°ç»„ä¸€è¯´ã€‚ å¯¹äºæ³›å‹ï¼Œæœ€ä¸»è¦çš„è¿˜æ˜¯éœ€è¦ç†è§£å…¶èƒŒåçš„æ€æƒ³å’Œç›®çš„ã€‚ ã€å‚è€ƒèµ„æ–™ã€‘ Javaæ€»ç»“ç¯‡ç³»åˆ—ï¼šJavaæ³›å‹","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"æ•°å­¦ä¹‹ç¾ç•ªå¤–ç¯‡ï¼šå¹³å‡¡è€Œåˆç¥å¥‡çš„è´å¶æ–¯æ–¹æ³•","slug":"æ•°å­¦ä¹‹ç¾ç•ªå¤–ç¯‡ï¼šå¹³å‡¡è€Œåˆç¥å¥‡çš„è´å¶æ–¯æ–¹æ³•","date":"2016-12-22T03:08:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/12/22/æ•°å­¦ä¹‹ç¾ç•ªå¤–ç¯‡ï¼šå¹³å‡¡è€Œåˆç¥å¥‡çš„è´å¶æ–¯æ–¹æ³•/","link":"","permalink":"http://github.com/2016/12/22/æ•°å­¦ä¹‹ç¾ç•ªå¤–ç¯‡ï¼šå¹³å‡¡è€Œåˆç¥å¥‡çš„è´å¶æ–¯æ–¹æ³•/","excerpt":"Probability is nothing but common sense reduced to calculation.ï¼ˆæ¦‚ç‡è®ºåªä¸è¿‡æ˜¯æŠŠå¸¸è¯†ç”¨æ•°å­¦å…¬å¼è¡¨è¾¾äº†å‡ºæ¥ã€‚ï¼‰ â€”â€” Pierre-Simon Laplace è®°å¾—è¯»æœ¬ç§‘çš„æ—¶å€™ï¼Œæœ€å–œæ¬¢åˆ°åŸé‡Œçš„è®¡ç®—æœºä¹¦åº—é‡Œé¢å»é—²é€›ï¼Œä¸€é€›å°±æ˜¯å¥½å‡ ä¸ªå°æ—¶ï¼›æœ‰ä¸€æ¬¡ï¼Œåœ¨ä¹¦åº—çœ‹åˆ°ä¸€æœ¬ä¹¦ï¼Œåå«è´å¶æ–¯æ–¹æ³•ã€‚å½“æ—¶æ•°å­¦ç³»çš„è¯¾ç¨‹è¿˜æ²¡æœ‰å­¦åˆ°æ¦‚ç‡ç»Ÿè®¡ã€‚æˆ‘å¿ƒæƒ³ï¼Œä¸€ä¸ªæ–¹æ³•èƒ½å¤Ÿä¸“é—¨å†™å‡ºä¸€æœ¬ä¹¦æ¥ï¼Œè‚¯å®šå¾ˆç‰›é€¼ã€‚åæ¥ï¼Œæˆ‘å‘ç°å½“åˆçš„é‚£ä¸ªæœ´ç´ å½’çº³æ¨ç†æˆç«‹äº† â€”â€” è¿™æœç„¶æ˜¯ä¸ªç‰›é€¼çš„æ–¹æ³•ã€‚ â€”â€”é¢˜è®° å‰è¨€è¿™æ˜¯ä¸€ç¯‡å…³äºè´å¶æ–¯æ–¹æ³•çš„ç§‘æ™®æ–‡ï¼Œæˆ‘ä¼šå°½é‡å°‘ç”¨å…¬å¼ï¼Œå¤šç”¨å¹³ç™½çš„è¯­è¨€å™è¿°ï¼Œå¤šä¸¾å®é™…ä¾‹å­ã€‚æ›´ä¸¥æ ¼çš„å…¬å¼å’Œè®¡ç®—æˆ‘ä¼šåœ¨ç›¸åº”çš„åœ°æ–¹æ³¨æ˜å‚è€ƒèµ„æ–™ã€‚è´å¶æ–¯æ–¹æ³•è¢«è¯æ˜æ˜¯éå¸¸ general ä¸”å¼ºå¤§çš„æ¨ç†æ¡†æ¶ï¼Œæ–‡ä¸­ä½ ä¼šçœ‹åˆ°å¾ˆå¤šæœ‰è¶£çš„åº”ç”¨ã€‚","text":"Probability is nothing but common sense reduced to calculation.ï¼ˆæ¦‚ç‡è®ºåªä¸è¿‡æ˜¯æŠŠå¸¸è¯†ç”¨æ•°å­¦å…¬å¼è¡¨è¾¾äº†å‡ºæ¥ã€‚ï¼‰ â€”â€” Pierre-Simon Laplace è®°å¾—è¯»æœ¬ç§‘çš„æ—¶å€™ï¼Œæœ€å–œæ¬¢åˆ°åŸé‡Œçš„è®¡ç®—æœºä¹¦åº—é‡Œé¢å»é—²é€›ï¼Œä¸€é€›å°±æ˜¯å¥½å‡ ä¸ªå°æ—¶ï¼›æœ‰ä¸€æ¬¡ï¼Œåœ¨ä¹¦åº—çœ‹åˆ°ä¸€æœ¬ä¹¦ï¼Œåå«è´å¶æ–¯æ–¹æ³•ã€‚å½“æ—¶æ•°å­¦ç³»çš„è¯¾ç¨‹è¿˜æ²¡æœ‰å­¦åˆ°æ¦‚ç‡ç»Ÿè®¡ã€‚æˆ‘å¿ƒæƒ³ï¼Œä¸€ä¸ªæ–¹æ³•èƒ½å¤Ÿä¸“é—¨å†™å‡ºä¸€æœ¬ä¹¦æ¥ï¼Œè‚¯å®šå¾ˆç‰›é€¼ã€‚åæ¥ï¼Œæˆ‘å‘ç°å½“åˆçš„é‚£ä¸ªæœ´ç´ å½’çº³æ¨ç†æˆç«‹äº† â€”â€” è¿™æœç„¶æ˜¯ä¸ªç‰›é€¼çš„æ–¹æ³•ã€‚ â€”â€”é¢˜è®° å‰è¨€è¿™æ˜¯ä¸€ç¯‡å…³äºè´å¶æ–¯æ–¹æ³•çš„ç§‘æ™®æ–‡ï¼Œæˆ‘ä¼šå°½é‡å°‘ç”¨å…¬å¼ï¼Œå¤šç”¨å¹³ç™½çš„è¯­è¨€å™è¿°ï¼Œå¤šä¸¾å®é™…ä¾‹å­ã€‚æ›´ä¸¥æ ¼çš„å…¬å¼å’Œè®¡ç®—æˆ‘ä¼šåœ¨ç›¸åº”çš„åœ°æ–¹æ³¨æ˜å‚è€ƒèµ„æ–™ã€‚è´å¶æ–¯æ–¹æ³•è¢«è¯æ˜æ˜¯éå¸¸ general ä¸”å¼ºå¤§çš„æ¨ç†æ¡†æ¶ï¼Œæ–‡ä¸­ä½ ä¼šçœ‹åˆ°å¾ˆå¤šæœ‰è¶£çš„åº”ç”¨ã€‚ 1. å†å²æ‰˜é©¬æ–¯Â·è´å¶æ–¯ï¼ˆThomas Bayesï¼‰åŒå­¦çš„è¯¦ç»†ç”Ÿå¹³åœ¨è¿™é‡Œã€‚ä»¥ä¸‹æ‘˜ä¸€æ®µ wikipedia ä¸Šçš„ç®€ä»‹ï¼š æ‰€è°“çš„è´å¶æ–¯æ–¹æ³•æºäºä»–ç”Ÿå‰ä¸ºè§£å†³ä¸€ä¸ªâ€œé€†æ¦‚â€é—®é¢˜å†™çš„ä¸€ç¯‡æ–‡ç« ï¼Œè€Œè¿™ç¯‡æ–‡ç« æ˜¯åœ¨ä»–æ­»åæ‰ç”±ä»–çš„ä¸€ä½æœ‹å‹å‘è¡¨å‡ºæ¥çš„ã€‚åœ¨è´å¶æ–¯å†™è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œäººä»¬å·²ç»èƒ½å¤Ÿè®¡ç®—â€œæ­£å‘æ¦‚ç‡â€ï¼Œå¦‚â€œå‡è®¾è¢‹å­é‡Œé¢æœ‰Nä¸ªç™½çƒï¼ŒMä¸ªé»‘çƒï¼Œä½ ä¼¸æ‰‹è¿›å»æ‘¸ä¸€æŠŠï¼Œæ‘¸å‡ºé»‘çƒçš„æ¦‚ç‡æ˜¯å¤šå¤§â€ã€‚è€Œä¸€ä¸ªè‡ªç„¶è€Œç„¶çš„é—®é¢˜æ˜¯åè¿‡æ¥ï¼šâ€œå¦‚æœæˆ‘ä»¬äº‹å…ˆå¹¶ä¸çŸ¥é“è¢‹å­é‡Œé¢é»‘ç™½çƒçš„æ¯”ä¾‹ï¼Œè€Œæ˜¯é—­ç€çœ¼ç›æ‘¸å‡ºä¸€ä¸ªï¼ˆæˆ–å¥½å‡ ä¸ªï¼‰çƒï¼Œè§‚å¯Ÿè¿™äº›å–å‡ºæ¥çš„çƒçš„é¢œè‰²ä¹‹åï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°±æ­¤å¯¹è¢‹å­é‡Œé¢çš„é»‘ç™½çƒçš„æ¯”ä¾‹ä½œå‡ºä»€ä¹ˆæ ·çš„æ¨æµ‹â€ã€‚è¿™ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ‰€è°“çš„é€†æ¦‚é—®é¢˜ã€‚ å®é™…ä¸Šï¼Œè´å¶æ–¯å½“æ—¶çš„è®ºæ–‡åªæ˜¯å¯¹è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªç›´æ¥çš„æ±‚è§£å°è¯•ï¼Œå¹¶ä¸æ¸…æ¥šä»–å½“æ—¶æ˜¯ä¸æ˜¯å·²ç»æ„è¯†åˆ°è¿™é‡Œé¢åŒ…å«ç€çš„æ·±åˆ»çš„æ€æƒ³ã€‚ç„¶è€Œåæ¥ï¼Œè´å¶æ–¯æ–¹æ³•å¸­å·äº†æ¦‚ç‡è®ºï¼Œå¹¶å°†åº”ç”¨å»¶ä¼¸åˆ°å„ä¸ªé—®é¢˜é¢†åŸŸï¼Œæ‰€æœ‰éœ€è¦ä½œå‡ºæ¦‚ç‡é¢„æµ‹çš„åœ°æ–¹éƒ½å¯ä»¥è§åˆ°è´å¶æ–¯æ–¹æ³•çš„å½±å­ï¼Œç‰¹åˆ«åœ°ï¼Œè´å¶æ–¯æ˜¯æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒæ–¹æ³•ä¹‹ä¸€ã€‚è¿™èƒŒåçš„æ·±åˆ»åŸå› åœ¨äºï¼Œç°å®ä¸–ç•Œæœ¬èº«å°±æ˜¯ä¸ç¡®å®šçš„ï¼Œäººç±»çš„è§‚å¯Ÿèƒ½åŠ›æ˜¯æœ‰å±€é™æ€§çš„ï¼ˆå¦åˆ™æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ç§‘å­¦å°±æ²¡æœ‰å¿…è¦åšäº†â€”â€”è®¾æƒ³æˆ‘ä»¬èƒ½å¤Ÿç›´æ¥è§‚å¯Ÿåˆ°ç”µå­çš„è¿è¡Œï¼Œè¿˜éœ€è¦å¯¹åŸå­æ¨¡å‹äº‰åµä¸ä¼‘å—ï¼Ÿï¼‰ï¼Œæˆ‘ä»¬æ—¥å¸¸æ‰€è§‚å¯Ÿåˆ°çš„åªæ˜¯äº‹ç‰©è¡¨é¢ä¸Šçš„ç»“æœï¼Œæ²¿ç”¨åˆšæ‰é‚£ä¸ªè¢‹å­é‡Œé¢å–çƒçš„æ¯”æ–¹ï¼Œæˆ‘ä»¬å¾€å¾€åªèƒ½çŸ¥é“ä»é‡Œé¢å–å‡ºæ¥çš„çƒæ˜¯ä»€ä¹ˆé¢œè‰²ï¼Œè€Œå¹¶ä¸èƒ½ç›´æ¥çœ‹åˆ°è¢‹å­é‡Œé¢å®é™…çš„æƒ…å†µã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦æä¾›ä¸€ä¸ªçŒœæµ‹ï¼ˆhypothesisï¼Œæ›´ä¸ºä¸¥æ ¼çš„è¯´æ³•æ˜¯â€œå‡è®¾â€ï¼Œè¿™é‡Œç”¨â€œçŒœæµ‹â€æ›´é€šä¿—æ˜“æ‡‚ä¸€ç‚¹ï¼‰ï¼Œæ‰€è°“çŒœæµ‹ï¼Œå½“ç„¶å°±æ˜¯ä¸ç¡®å®šçš„ï¼ˆå¾ˆå¯èƒ½æœ‰å¥½å¤šç§ä¹ƒè‡³æ— æ•°ç§çŒœæµ‹éƒ½èƒ½æ»¡è¶³ç›®å‰çš„è§‚æµ‹ï¼‰ï¼Œä½†ä¹Ÿç»å¯¹ä¸æ˜¯ä¸¤çœ¼ä¸€æŠ¹é»‘çè’™â€”â€”å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤ä»¶äº‹æƒ…ï¼š1. ç®—å‡ºå„ç§ä¸åŒçŒœæµ‹çš„å¯èƒ½æ€§å¤§å°ã€‚2. ç®—å‡ºæœ€é è°±çš„çŒœæµ‹æ˜¯ä»€ä¹ˆã€‚ç¬¬ä¸€ä¸ªå°±æ˜¯è®¡ç®—ç‰¹å®šçŒœæµ‹çš„åéªŒæ¦‚ç‡ï¼Œå¯¹äºè¿ç»­çš„çŒœæµ‹ç©ºé—´åˆ™æ˜¯è®¡ç®—çŒœæµ‹çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚ç¬¬äºŒä¸ªåˆ™æ˜¯æ‰€è°“çš„æ¨¡å‹æ¯”è¾ƒï¼Œæ¨¡å‹æ¯”è¾ƒå¦‚æœä¸è€ƒè™‘å…ˆéªŒæ¦‚ç‡çš„è¯å°±æ˜¯æœ€å¤§ä¼¼ç„¶æ–¹æ³•ã€‚ 1.1 ä¸€ä¸ªä¾‹å­ï¼šè‡ªç„¶è¯­è¨€çš„äºŒä¹‰æ€§ä¸‹é¢ä¸¾ä¸€ä¸ªè‡ªç„¶è¯­è¨€çš„ä¸ç¡®å®šæ€§çš„ä¾‹å­ã€‚å½“ä½ çœ‹åˆ°è¿™å¥è¯ï¼š The girl saw the boy with a telescope. ä½ å¯¹è¿™å¥è¯çš„å«ä¹‰æœ‰ä»€ä¹ˆçŒœæµ‹ï¼Ÿå¹³å¸¸äººè‚¯å®šä¼šè¯´ï¼šé‚£ä¸ªå¥³å­©æ‹¿æœ›è¿œé•œçœ‹è§äº†é‚£ä¸ªç”·å­©ï¼ˆå³ä½ å¯¹è¿™ä¸ªå¥å­èƒŒåçš„å®é™…è¯­æ³•ç»“æ„çš„çŒœæµ‹æ˜¯ï¼šThe girl saw-with-a-telescope the boy ï¼‰ã€‚ç„¶è€Œï¼Œä»”ç»†ä¸€æƒ³ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªå¥å­å®Œå…¨å¯ä»¥è§£é‡Šæˆï¼šé‚£ä¸ªå¥³å­©çœ‹è§äº†é‚£ä¸ªæ‹¿ç€æœ›è¿œé•œçš„ç”·å­©ï¼ˆå³ï¼šThe girl saw the-boy-with-a-telescope ï¼‰ã€‚é‚£ä¸ºä»€ä¹ˆå¹³å¸¸ç”Ÿæ´»ä¸­æˆ‘ä»¬æ¯ä¸ªäººéƒ½èƒ½å¤Ÿè¿…é€Ÿåœ°å¯¹è¿™ç§äºŒä¹‰æ€§è¿›è¡Œæ¶ˆè§£å‘¢ï¼Ÿè¿™èƒŒååˆ°åº•éšè—ç€ä»€ä¹ˆæ ·çš„æ€ç»´æ³•åˆ™ï¼Ÿæˆ‘ä»¬ç•™åˆ°åé¢è§£é‡Šã€‚ 1.2 è´å¶æ–¯å…¬å¼è´å¶æ–¯å…¬å¼æ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ wikipedia ä¸Šçš„ä¸€ä¸ªä¾‹å­ï¼š ä¸€æ‰€å­¦æ ¡é‡Œé¢æœ‰ 60% çš„ç”·ç”Ÿï¼Œ40% çš„å¥³ç”Ÿã€‚ç”·ç”Ÿæ€»æ˜¯ç©¿é•¿è£¤ï¼Œå¥³ç”Ÿåˆ™ä¸€åŠç©¿é•¿è£¤ä¸€åŠç©¿è£™å­ã€‚æœ‰äº†è¿™äº›ä¿¡æ¯ä¹‹åæˆ‘ä»¬å¯ä»¥å®¹æ˜“åœ°è®¡ç®—â€œéšæœºé€‰å–ä¸€ä¸ªå­¦ç”Ÿï¼Œä»–ï¼ˆå¥¹ï¼‰ç©¿é•¿è£¤çš„æ¦‚ç‡å’Œç©¿è£™å­çš„æ¦‚ç‡æ˜¯å¤šå¤§â€ï¼Œè¿™ä¸ªå°±æ˜¯å‰é¢è¯´çš„â€œæ­£å‘æ¦‚ç‡â€çš„è®¡ç®—ã€‚ç„¶è€Œï¼Œå‡è®¾ä½ èµ°åœ¨æ ¡å›­ä¸­ï¼Œè¿é¢èµ°æ¥ä¸€ä¸ªç©¿é•¿è£¤çš„å­¦ç”Ÿï¼ˆå¾ˆä¸å¹¸çš„æ˜¯ä½ é«˜åº¦è¿‘ä¼¼ï¼Œä½ åªçœ‹å¾—è§ä»–ï¼ˆå¥¹ï¼‰ç©¿çš„æ˜¯å¦é•¿è£¤ï¼Œè€Œæ— æ³•ç¡®å®šä»–ï¼ˆå¥¹ï¼‰çš„æ€§åˆ«ï¼‰ï¼Œä½ èƒ½å¤Ÿæ¨æ–­å‡ºä»–ï¼ˆå¥¹ï¼‰æ˜¯ç”·ç”Ÿçš„æ¦‚ç‡æ˜¯å¤šå¤§å—ï¼Ÿ ä¸€äº›è®¤çŸ¥ç§‘å­¦çš„ç ”ç©¶è¡¨æ˜ï¼ˆã€Šå†³ç­–ä¸åˆ¤æ–­ã€‹ä»¥åŠã€ŠRationality for Mortalsã€‹ç¬¬12ç« ï¼šå°å­©ä¹Ÿå¯ä»¥è§£å†³è´å¶æ–¯é—®é¢˜ï¼‰ï¼Œæˆ‘ä»¬å¯¹å½¢å¼åŒ–çš„è´å¶æ–¯é—®é¢˜ä¸æ“…é•¿ï¼Œä½†å¯¹äºä»¥é¢‘ç‡å½¢å¼å‘ˆç°çš„ç­‰ä»·é—®é¢˜å´å¾ˆæ“…é•¿ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸å¦¨æŠŠé—®é¢˜é‡æ–°å™è¿°æˆï¼šä½ åœ¨æ ¡å›­é‡Œé¢éšæœºæ¸¸èµ°ï¼Œé‡åˆ°äº† N ä¸ªç©¿é•¿è£¤çš„äººï¼ˆä»ç„¶å‡è®¾ä½ æ— æ³•ç›´æ¥è§‚å¯Ÿåˆ°ä»–ä»¬çš„æ€§åˆ«ï¼‰ï¼Œé—®è¿™ N ä¸ªäººé‡Œé¢æœ‰å¤šå°‘ä¸ªå¥³ç”Ÿå¤šå°‘ä¸ªç”·ç”Ÿã€‚ ä½ è¯´ï¼Œè¿™è¿˜ä¸ç®€å•ï¼šç®—å‡ºå­¦æ ¡é‡Œé¢æœ‰å¤šå°‘ç©¿é•¿è£¤çš„ï¼Œç„¶ååœ¨è¿™äº›äººé‡Œé¢å†ç®—å‡ºæœ‰å¤šå°‘å¥³ç”Ÿï¼Œä¸å°±è¡Œäº†ï¼Ÿ æˆ‘ä»¬æ¥ç®—ä¸€ç®—ï¼šå‡è®¾å­¦æ ¡é‡Œé¢äººçš„æ€»æ•°æ˜¯ U ä¸ªã€‚60% çš„ç”·ç”Ÿéƒ½ç©¿é•¿è£¤ï¼Œäºæ˜¯æˆ‘ä»¬å¾—åˆ°äº† U * P(Boy) * P(Pants|Boy)ä¸ªç©¿é•¿è£¤çš„ï¼ˆç”·ç”Ÿï¼‰ï¼ˆå…¶ä¸­ç”·ç”Ÿçš„æ¦‚ç‡ P(Boy) = 60%ï¼Œè¿™é‡Œå¯ä»¥ç®€å•çš„ç†è§£ä¸ºç”·ç”Ÿçš„æ¯”ä¾‹ï¼›P(Pants|Boy) æ˜¯æ¡ä»¶æ¦‚ç‡ï¼Œå³åœ¨ Boy è¿™ä¸ªæ¡ä»¶ä¸‹ç©¿é•¿è£¤çš„æ¦‚ç‡æ˜¯å¤šå¤§ï¼Œè¿™é‡Œæ˜¯ 100% ï¼Œå› ä¸ºæ‰€æœ‰ç”·ç”Ÿéƒ½ç©¿é•¿è£¤ï¼‰ã€‚40% çš„å¥³ç”Ÿé‡Œé¢åˆæœ‰ä¸€åŠï¼ˆ50%ï¼‰æ˜¯ç©¿é•¿è£¤çš„ï¼Œäºæ˜¯æˆ‘ä»¬åˆå¾—åˆ°äº† U * P(Girl) * P(Pants|Girl) ä¸ªç©¿é•¿è£¤çš„ï¼ˆå¥³ç”Ÿï¼‰ã€‚åŠ èµ·æ¥ä¸€å…±æ˜¯ U P(Boy) P(Pants|Boy) + U P(Girl) P(Pants|Girl) ä¸ªç©¿é•¿è£¤çš„ï¼Œå…¶ä¸­æœ‰ U * P(Girl) * P(Pants|Girl) ä¸ªå¥³ç”Ÿã€‚ä¸¤è€…ä¸€æ¯”å°±æ˜¯ä½ è¦æ±‚çš„ç­”æ¡ˆã€‚ ä¸‹é¢æˆ‘ä»¬æŠŠè¿™ä¸ªç­”æ¡ˆå½¢å¼åŒ–ä¸€ä¸‹ï¼šæˆ‘ä»¬è¦æ±‚çš„æ˜¯ P(Girl|Pants) ï¼ˆç©¿é•¿è£¤çš„äººé‡Œé¢æœ‰å¤šå°‘å¥³ç”Ÿï¼‰ï¼Œæˆ‘ä»¬è®¡ç®—çš„ç»“æœæ˜¯ U P(Girl) P(Pants|Girl) / [U P(Boy) P(Pants|Boy) + U P(Girl) P(Pants|Girl)] ã€‚å®¹æ˜“å‘ç°è¿™é‡Œæ ¡å›­å†…äººçš„æ€»æ•°æ˜¯æ— å…³çš„ï¼Œå¯ä»¥æ¶ˆå»ã€‚äºæ˜¯å¾—åˆ° 1P(Girl|Pants) = P(Girl) * P(Pants|Girl) / [P(Boy) * P(Pants|Boy) + P(Girl) * P(Pants|Girl)] æ³¨æ„ï¼Œå¦‚æœæŠŠä¸Šå¼æ”¶ç¼©èµ·æ¥ï¼Œåˆ†æ¯å…¶å®å°±æ˜¯ P(Pants) ï¼Œåˆ†å­å…¶å®å°±æ˜¯ P(Pants, Girl) ã€‚è€Œè¿™ä¸ªæ¯”ä¾‹å¾ˆè‡ªç„¶åœ°å°±è¯»ä½œï¼šåœ¨ç©¿é•¿è£¤çš„äººï¼ˆ P(Pants) ï¼‰é‡Œé¢æœ‰å¤šå°‘ï¼ˆç©¿é•¿è£¤ï¼‰çš„å¥³å­©ï¼ˆ P(Pants, Girl) ï¼‰ã€‚ ä¸Šå¼ä¸­çš„ Pants å’Œ Boy/Girl å¯ä»¥æŒ‡ä»£ä¸€åˆ‡ä¸œè¥¿ï¼Œæ‰€ä»¥å…¶ä¸€èˆ¬å½¢å¼å°±æ˜¯ï¼š 1P(B|A) = P(A|B) * P(B) / [P(A|B) * P(B) + P(A|~B) * P(~B) ] æ”¶ç¼©èµ·æ¥å°±æ˜¯ï¼š 1P(B|A) = P(AB) / P(A) å…¶å®è¿™ä¸ªå°±ç­‰äºï¼š 1P(B|A) * P(A) = P(AB) éš¾æ€ªæ‹‰æ™®æ‹‰æ–¯è¯´æ¦‚ç‡è®ºåªæ˜¯æŠŠå¸¸è¯†ç”¨æ•°å­¦å…¬å¼è¡¨è¾¾äº†å‡ºæ¥ã€‚ ç„¶è€Œï¼Œåé¢æˆ‘ä»¬ä¼šé€æ¸å‘ç°ï¼Œçœ‹ä¼¼è¿™ä¹ˆå¹³å‡¡çš„è´å¶æ–¯å…¬å¼ï¼ŒèƒŒåå´éšå«ç€éå¸¸æ·±åˆ»çš„åŸç†ã€‚ 2. æ‹¼å†™çº æ­£ç»å…¸è‘—ä½œã€Šäººå·¥æ™ºèƒ½ï¼šç°ä»£æ–¹æ³•ã€‹çš„ä½œè€…ä¹‹ä¸€ Peter Norvig æ›¾ç»å†™è¿‡ä¸€ç¯‡ä»‹ç»å¦‚ä½•å†™ä¸€ä¸ªæ‹¼å†™æ£€æŸ¥/çº æ­£å™¨çš„æ–‡ç« ï¼ˆåŸæ–‡åœ¨è¿™é‡Œï¼Œè¿™ç¯‡æ–‡ç« å¾ˆæ·±å…¥æµ…å‡ºï¼Œå¼ºçƒˆå»ºè®®è¯»ä¸€è¯»ï¼‰ï¼Œé‡Œé¢ç”¨åˆ°çš„å°±æ˜¯è´å¶æ–¯æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸æ‰“ç®—å¤è¿°ä»–å†™çš„æ–‡ç« ï¼Œè€Œæ˜¯ç®€è¦åœ°å°†å…¶æ ¸å¿ƒæ€æƒ³ä»‹ç»ä¸€ä¸‹ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è¯¢é—®çš„æ˜¯ï¼šâ€œé—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿâ€ é—®é¢˜æ˜¯æˆ‘ä»¬çœ‹åˆ°ç”¨æˆ·è¾“å…¥äº†ä¸€ä¸ªä¸åœ¨å­—å…¸ä¸­çš„å•è¯ï¼Œæˆ‘ä»¬éœ€è¦å»çŒœæµ‹ï¼šâ€œè¿™ä¸ªå®¶ä¼™åˆ°åº•çœŸæ­£æƒ³è¾“å…¥çš„å•è¯æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿâ€ç”¨åˆšæ‰æˆ‘ä»¬å½¢å¼åŒ–çš„è¯­è¨€æ¥å™è¿°å°±æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦æ±‚ï¼š 1P(æˆ‘ä»¬çŒœæµ‹ä»–æƒ³è¾“å…¥çš„å•è¯ | ä»–å®é™…è¾“å…¥çš„å•è¯) è¿™ä¸ªæ¦‚ç‡ã€‚å¹¶æ‰¾å‡ºé‚£ä¸ªä½¿å¾—è¿™ä¸ªæ¦‚ç‡æœ€å¤§çš„çŒœæµ‹å•è¯ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬çš„çŒœæµ‹æœªå¿…æ˜¯å”¯ä¸€çš„ï¼Œå°±åƒå‰é¢ä¸¾çš„é‚£ä¸ªè‡ªç„¶è¯­è¨€çš„æ­§ä¹‰æ€§çš„ä¾‹å­ä¸€æ ·ï¼›è¿™é‡Œï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥ï¼š thew ï¼Œé‚£ä¹ˆä»–åˆ°åº•æ˜¯æƒ³è¾“å…¥ the ï¼Œè¿˜æ˜¯æƒ³è¾“å…¥ thaw ï¼Ÿåˆ°åº•å“ªä¸ªçŒœæµ‹å¯èƒ½æ€§æ›´å¤§å‘¢ï¼Ÿå¹¸è¿çš„æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨è´å¶æ–¯å…¬å¼æ¥ç›´æ¥å‡ºå®ƒä»¬å„è‡ªçš„æ¦‚ç‡ï¼Œæˆ‘ä»¬ä¸å¦¨å°†æˆ‘ä»¬çš„å¤šä¸ªçŒœæµ‹è®°ä¸º h1 h2 .. ï¼ˆ h ä»£è¡¨ hypothesisï¼‰ï¼Œå®ƒä»¬éƒ½å±äºä¸€ä¸ªæœ‰é™ä¸”ç¦»æ•£çš„çŒœæµ‹ç©ºé—´ H ï¼ˆå•è¯æ€»å…±å°±é‚£ä¹ˆå¤šè€Œå·²ï¼‰ï¼Œå°†ç”¨æˆ·å®é™…è¾“å…¥çš„å•è¯è®°ä¸º D ï¼ˆ D ä»£è¡¨ Data ï¼Œå³è§‚æµ‹æ•°æ®ï¼‰ï¼Œäºæ˜¯ 1P(æˆ‘ä»¬çš„çŒœæµ‹1 | ä»–å®é™…è¾“å…¥çš„å•è¯) å¯ä»¥æŠ½è±¡åœ°è®°ä¸ºï¼š P(h1 | D) ç±»ä¼¼åœ°ï¼Œå¯¹äºæˆ‘ä»¬çš„çŒœæµ‹2ï¼Œåˆ™æ˜¯ P(h2 | D)ã€‚ä¸å¦¨ç»Ÿä¸€è®°ä¸ºï¼š P(h | D) è¿ç”¨ä¸€æ¬¡è´å¶æ–¯å…¬å¼ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š 1P(h | D) = P(h) * P(D | h) / P(D) å¯¹äºä¸åŒçš„å…·ä½“çŒœæµ‹ h1 h2 h3 .. ï¼ŒP(D) éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥åœ¨æ¯”è¾ƒ P(h1 | D) å’Œ P(h2 | D) çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥å¿½ç•¥è¿™ä¸ªå¸¸æ•°ã€‚å³æˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼š 1P(h | D) âˆ P(h) * P(D | h) //æ³¨ï¼šâˆ è¿™ä¸ªç¬¦å·çš„æ„æ€æ˜¯â€œæ­£æ¯”ä¾‹äºâ€ï¼Œä¸æ˜¯æ— ç©·å¤§ï¼Œæ³¨æ„ç¬¦å·å³ç«¯æ˜¯æœ‰ä¸€ä¸ªå°ç¼ºå£çš„ã€‚ è¿™ä¸ªå¼å­çš„æŠ½è±¡å«ä¹‰æ˜¯ï¼šå¯¹äºç»™å®šè§‚æµ‹æ•°æ®ï¼Œä¸€ä¸ªçŒœæµ‹æ˜¯å¥½æ˜¯åï¼Œå–å†³äºâ€œè¿™ä¸ªçŒœæµ‹æœ¬èº«ç‹¬ç«‹çš„å¯èƒ½æ€§å¤§å°ï¼ˆå…ˆéªŒæ¦‚ç‡ï¼ŒPrior ï¼‰â€å’Œâ€œè¿™ä¸ªçŒœæµ‹ç”Ÿæˆæˆ‘ä»¬è§‚æµ‹åˆ°çš„æ•°æ®çš„å¯èƒ½æ€§å¤§å°â€ï¼ˆä¼¼ç„¶ï¼ŒLikelihood ï¼‰çš„ä¹˜ç§¯ã€‚å…·ä½“åˆ°æˆ‘ä»¬çš„é‚£ä¸ª thew ä¾‹å­ä¸Šï¼Œå«ä¹‰å°±æ˜¯ï¼Œç”¨æˆ·å®é™…æ˜¯æƒ³è¾“å…¥ the çš„å¯èƒ½æ€§å¤§å°å–å†³äº the æœ¬èº«åœ¨è¯æ±‡è¡¨ä¸­è¢«ä½¿ç”¨çš„å¯èƒ½æ€§ï¼ˆé¢‘ç¹ç¨‹åº¦ï¼‰å¤§å°ï¼ˆå…ˆéªŒæ¦‚ç‡ï¼‰å’Œ æƒ³æ‰“ the å´æ‰“æˆ thew çš„å¯èƒ½æ€§å¤§å°ï¼ˆä¼¼ç„¶ï¼‰çš„ä¹˜ç§¯ã€‚ ä¸‹é¢çš„äº‹æƒ…å°±å¾ˆç®€å•äº†ï¼Œå¯¹äºæˆ‘ä»¬çŒœæµ‹ä¸ºå¯èƒ½çš„æ¯ä¸ªå•è¯è®¡ç®—ä¸€ä¸‹ P(h) * P(D | h) è¿™ä¸ªå€¼ï¼Œç„¶åå–æœ€å¤§çš„ï¼Œå¾—åˆ°çš„å°±æ˜¯æœ€é è°±çš„çŒœæµ‹ã€‚ ä¸€ç‚¹æ³¨è®°ï¼š Norvig çš„æ‹¼å†™çº æ­£å™¨é‡Œé¢åªæå–äº†ç¼–è¾‘è·ç¦»ä¸º 2 ä»¥å†…çš„æ‰€æœ‰å·²çŸ¥å•è¯ã€‚è¿™æ˜¯ä¸ºäº†é¿å…å»éå†å­—å…¸ä¸­æ¯ä¸ªå•è¯è®¡ç®—å®ƒä»¬çš„ P(h) * P(D | h) ï¼Œä½†è¿™ç§åšæ³•ä¸ºäº†èŠ‚çœæ—¶é—´å¸¦æ¥äº†ä¸€äº›è¯¯å·®ã€‚ä½†è¯è¯´å›æ¥éš¾é“æˆ‘ä»¬äººç±»çœŸçš„å›å»éå†æ¯ä¸ªå¯èƒ½çš„å•è¯æ¥è®¡ç®—ä»–ä»¬çš„åéªŒæ¦‚ç‡å—ï¼Ÿä¸å¯èƒ½ã€‚å®é™…ä¸Šï¼Œæ ¹æ®è®¤çŸ¥ç¥ç»ç§‘å­¦çš„è§‚ç‚¹ï¼Œæˆ‘ä»¬é¦–å…ˆæ ¹æ®é”™è¯¯çš„å•è¯åšä¸€ä¸ª bottom-up çš„å…³è”æå–ï¼Œæå–å‡ºæœ‰å¯èƒ½æ˜¯å®é™…å•è¯çš„é‚£äº›å€™é€‰å•è¯ï¼Œè¿™ä¸ªæå–è¿‡ç¨‹å°±æ˜¯æ‰€è°“çš„åŸºäºå†…å®¹çš„æå–ï¼Œå¯ä»¥æ ¹æ®é”™è¯¯å•è¯çš„ä¸€äº›æ¨¡å¼ç‰‡æ®µæå–å‡ºæœ‰é™çš„ä¸€ç»„å€™é€‰ï¼Œéå¸¸å¿«åœ°ç¼©å°çš„æœç´¢ç©ºé—´ï¼ˆæ¯”å¦‚æˆ‘è¾“å…¥ explaination ï¼Œå•è¯é‡Œé¢å°±æœ‰å……åˆ†çš„ä¿¡æ¯ä½¿å¾—æˆ‘ä»¬çš„å¤§è„‘åœ¨å¸¸æ•°æ—¶é—´å†…æŠŠå¯èƒ½æ€§ narrow down åˆ° explanation è¿™ä¸ªå•è¯ä¸Šï¼Œè‡³äºå…·ä½“æ˜¯æ ¹æ®å“ªäº›çº¿ç´¢â€”â€”å¦‚éŸ³èŠ‚â€”â€”æ¥æå–ï¼Œåˆæ˜¯å¦‚ä½•åœ¨ç”Ÿç‰©ç¥ç»ç½‘ç»œä¸­å®ç°è¿™ä¸ªæå–æœºåˆ¶çš„ï¼Œç›®å‰è¿˜æ˜¯ä¸€ä¸ªæ²¡æœ‰å¼„æ¸…çš„é¢†åŸŸï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯¹è¿™æœ‰é™çš„å‡ ä¸ªçŒœæµ‹åšä¸€ä¸ª top-down çš„é¢„æµ‹ï¼Œçœ‹çœ‹åˆ°åº•å“ªä¸ªå¯¹äºè§‚æµ‹æ•°æ®ï¼ˆå³é”™è¯¯å•è¯ï¼‰çš„é¢„æµ‹æ•ˆåŠ›æœ€å¥½ï¼Œè€Œå¦‚ä½•è¡¡é‡é¢„æµ‹æ•ˆç‡åˆ™å°±æ˜¯ç”¨è´å¶æ–¯å…¬å¼é‡Œé¢çš„é‚£ä¸ª P(h) * P(D | h) äº†â€”â€”è™½ç„¶æˆ‘ä»¬å¾ˆå¯èƒ½ä½¿ç”¨äº†ä¸€äº›å¯å‘æ³•æ¥ç®€åŒ–è®¡ç®—ã€‚åé¢æˆ‘ä»¬è¿˜ä¼šæåˆ°è¿™æ ·çš„ bottom-up çš„å…³è”æå–ã€‚ 3. æ¨¡å‹æ¯”è¾ƒä¸å¥¥å¡å§†å‰ƒåˆ€3.1 å†è®¿æ‹¼å†™çº æ­£ä»‹ç»äº†è´å¶æ–¯æ‹¼å†™çº æ­£ä¹‹åï¼Œæ¥ä¸‹æ¥çš„ä¸€ä¸ªè‡ªç„¶è€Œç„¶çš„é—®é¢˜å°±æ¥äº†ï¼šâ€œä¸ºä»€ä¹ˆï¼Ÿâ€ ä¸ºä»€ä¹ˆè¦ç”¨è´å¶æ–¯å…¬å¼ï¼Ÿä¸ºä»€ä¹ˆè´å¶æ–¯å…¬å¼åœ¨è¿™é‡Œå¯ä»¥ç”¨ï¼Ÿæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°é¢†ä¼šä¸ºä»€ä¹ˆè´å¶æ–¯å…¬å¼ç”¨åœ¨å‰é¢ä»‹ç»çš„é‚£ä¸ªç”·ç”Ÿå¥³ç”Ÿé•¿è£¤è£™å­çš„é—®é¢˜é‡Œæ˜¯æ­£ç¡®çš„ã€‚ä½†ä¸ºä»€ä¹ˆè¿™é‡Œï¼Ÿ ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªå¸¸è§çš„æ€è·¯å°±æ˜¯æƒ³æƒ³ï¼šéå¾—è¿™æ ·å—ï¼Ÿ å› ä¸ºå¦‚æœä½ æƒ³åˆ°äº†å¦ä¸€ç§åšæ³•å¹¶ä¸”è¯æ˜äº†å®ƒä¹Ÿæ˜¯é è°±çš„ï¼Œé‚£ä¹ˆå°†å®ƒä¸ç°åœ¨è¿™ä¸ªä¸€æ¯”è¾ƒï¼Œä¹Ÿè®¸å°±èƒ½å¾—å‡ºå¾ˆæœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚é‚£ä¹ˆå¯¹äºæ‹¼å†™çº é”™é—®é¢˜ä½ èƒ½æƒ³åˆ°å…¶ä»–æ–¹æ¡ˆå—ï¼Ÿ ä¸ç®¡æ€æ ·ï¼Œä¸€ä¸ªæœ€å¸¸è§çš„æ›¿ä»£æ–¹æ¡ˆå°±æ˜¯ï¼Œé€‰æ‹©ç¦» thew çš„ç¼–è¾‘è·ç¦»ï¼ˆEdit distanceï¼‰æœ€è¿‘çš„ã€‚ç„¶è€Œ the å’Œ thaw ç¦» thew çš„ç¼–è¾‘è·ç¦»éƒ½æ˜¯ 1 ã€‚è¿™å¯å’‹åŠæï¼Ÿä½ è¯´ï¼Œä¸æ…Œï¼Œé‚£è¿˜æ˜¯å¥½åŠã€‚æˆ‘ä»¬å°±çœ‹åˆ°åº•å“ªä¸ªæ›´å¯èƒ½è¢«é”™æ‰“ä¸º thew å°±æ˜¯äº†ã€‚æˆ‘ä»¬æ³¨æ„åˆ°å­—æ¯ e å’Œå­—æ¯ w åœ¨é”®ç›˜ä¸Šç¦»å¾—å¾ˆç´§ï¼Œæ— åæŒ‡ä¸€æŠ½ç­‹å°±ä¸å°å¿ƒå¤šæ‰“å‡ºä¸€ä¸ª w æ¥ï¼Œthe å°±å˜æˆ thew äº†ã€‚è€Œå¦ä¸€æ–¹é¢ thaw è¢«é”™æ‰“æˆ thew çš„å¯èƒ½æ€§å°±ç›¸å¯¹å°ä¸€ç‚¹ï¼Œå› ä¸º e å’Œ a ç¦»å¾—è¾ƒè¿œè€Œä¸”ä½¿ç”¨çš„æŒ‡å¤´ç›¸å·®ä¸€ä¸ªæŒ‡å¤´ï¼ˆä¸€ä¸ªæ˜¯ä¸­æŒ‡ä¸€ä¸ªæ˜¯å°æŒ‡ï¼Œä¸åƒ e å’Œ w ä½¿ç”¨çš„æŒ‡å¤´é åœ¨ä¸€å—â€”â€”ç¥ç»ç§‘å­¦çš„è¯æ®è¡¨æ˜ç´§é‚»çš„èº«ä½“è®¾æ–½ä¹‹é—´å®¹æ˜“ä¸²ä½ï¼‰ã€‚OKï¼Œå¾ˆå¥½ï¼Œå› ä¸ºä½ ç°åœ¨å·²ç»æ˜¯åœ¨ç”¨æœ€å¤§ä¼¼ç„¶æ–¹æ³•äº†ï¼Œæˆ–è€…ç›´ç™½ä¸€ç‚¹ï¼Œä½ å°±æ˜¯åœ¨è®¡ç®—é‚£ä¸ªä½¿å¾— P(D | h) æœ€å¤§çš„ h ã€‚ è€Œè´å¶æ–¯æ–¹æ³•è®¡ç®—çš„æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ P(h) * P(D | h) ã€‚å¤šå‡ºæ¥äº†ä¸€ä¸ª P(h) ã€‚æˆ‘ä»¬åˆšæ‰è¯´äº†ï¼Œè¿™ä¸ªå¤šå‡ºæ¥çš„ P(h) æ˜¯ç‰¹å®šçŒœæµ‹çš„å…ˆéªŒæ¦‚ç‡ã€‚ä¸ºä»€ä¹ˆè¦æºå’Œè¿›ä¸€ä¸ªå…ˆéªŒæ¦‚ç‡ï¼Ÿåˆšæ‰è¯´çš„é‚£ä¸ªæœ€å¤§ä¼¼ç„¶ä¸æ˜¯æŒºå¥½ä¹ˆï¼Ÿå¾ˆé›„è¾©åœ°æŒ‡å‡ºäº† the æ˜¯æ›´é è°±çš„çŒœæµ‹ã€‚æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿæ—¢ç„¶è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä»ç»™æœ€å¤§ä¼¼ç„¶æ‰¾èŒ¬å¼€å§‹å§â€”â€”æˆ‘ä»¬å‡è®¾ä¸¤è€…çš„ä¼¼ç„¶ç¨‹åº¦æ˜¯ä¸€æ ·æˆ–éå¸¸ç›¸è¿‘ï¼Œè¿™æ ·ä¸å°±éš¾ä»¥åŒºåˆ†å“ªä¸ªçŒœæµ‹æ›´é è°±äº†å—ï¼Ÿæ¯”å¦‚ç”¨æˆ·è¾“å…¥tlp ï¼Œé‚£åˆ°åº•æ˜¯ top è¿˜æ˜¯ tip ï¼Ÿï¼ˆè¿™ä¸ªä¾‹å­ä¸æ€ä¹ˆå¥½ï¼Œå› ä¸º top å’Œ tip çš„è¯é¢‘å¯èƒ½ä»ç„¶æ˜¯æ¥è¿‘çš„ï¼Œä½†ä¸€æ—¶æƒ³ä¸åˆ°å¥½çš„è‹±æ–‡å•è¯çš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¸å¦¨å°±å‡è®¾ top æ¯” tip å¸¸è§è®¸å¤šå§ï¼Œè¿™ä¸ªå‡è®¾å¹¶ä¸å½±å“é—®é¢˜çš„æœ¬è´¨ã€‚ï¼‰è¿™ä¸ªæ—¶å€™ï¼Œå½“æœ€å¤§ä¼¼ç„¶ä¸èƒ½ä½œå‡ºå†³å®šæ€§çš„åˆ¤æ–­æ—¶ï¼Œå…ˆéªŒæ¦‚ç‡å°±å¯ä»¥æ’æ‰‹è¿›æ¥ç»™å‡ºæŒ‡ç¤ºâ€”â€”â€œæ—¢ç„¶ä½ æ— æ³•å†³å®šï¼Œé‚£ä¹ˆæˆ‘å‘Šè¯‰ä½ ï¼Œä¸€èˆ¬æ¥è¯´ top å‡ºç°çš„ç¨‹åº¦è¦é«˜è®¸å¤šï¼Œæ‰€ä»¥æ›´å¯èƒ½ä»–æƒ³æ‰“çš„æ˜¯ top â€ï¼‰ã€‚ ä»¥ä¸Šåªæ˜¯æœ€å¤§ä¼¼ç„¶çš„ä¸€ä¸ªé—®é¢˜ï¼Œå³å¹¶ä¸èƒ½æä¾›å†³ç­–çš„å…¨éƒ¨ä¿¡æ¯ã€‚ æœ€å¤§ä¼¼ç„¶è¿˜æœ‰å¦ä¸€ä¸ªé—®é¢˜ï¼šå³ä¾¿ä¸€ä¸ªçŒœæµ‹ä¸æ•°æ®éå¸¸ç¬¦åˆï¼Œä¹Ÿå¹¶ä¸ä»£è¡¨è¿™ä¸ªçŒœæµ‹å°±æ˜¯æ›´å¥½çš„çŒœæµ‹ï¼Œå› ä¸ºè¿™ä¸ªçŒœæµ‹æœ¬èº«çš„å¯èƒ½æ€§ä¹Ÿè®¸å°±éå¸¸ä½ã€‚æ¯”å¦‚ MacKay åœ¨ã€ŠInformation Theory : Inference and Learning Algorithmsã€‹é‡Œé¢å°±ä¸¾äº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼š-1 3 7 11 ä½ è¯´æ˜¯ç­‰å·®æ•°åˆ—æ›´æœ‰å¯èƒ½å‘¢ï¼Ÿè¿˜æ˜¯ -X^3 / 11 + 9/11*X^2 + 23/11 æ¯é¡¹æŠŠå‰é¡¹ä½œä¸º X å¸¦å…¥åè®¡ç®—å¾—åˆ°çš„æ•°åˆ—ï¼Ÿæ­¤å¤–æ›²çº¿æ‹Ÿåˆä¹Ÿæ˜¯ï¼Œå¹³é¢ä¸Š N ä¸ªç‚¹æ€»æ˜¯å¯ä»¥ç”¨ N-1 é˜¶å¤šé¡¹å¼æ¥å®Œå…¨æ‹Ÿåˆï¼Œå½“ N ä¸ªç‚¹è¿‘ä¼¼ä½†ä¸ç²¾ç¡®å…±çº¿çš„æ—¶å€™ï¼Œç”¨ N-1 é˜¶å¤šé¡¹å¼æ¥æ‹Ÿåˆèƒ½å¤Ÿç²¾ç¡®é€šè¿‡æ¯ä¸€ä¸ªç‚¹ï¼Œç„¶è€Œç”¨ç›´çº¿æ¥åšæ‹Ÿåˆ/çº¿æ€§å›å½’çš„æ—¶å€™å´ä¼šä½¿å¾—æŸäº›ç‚¹ä¸èƒ½ä½äºç›´çº¿ä¸Šã€‚ä½ è¯´åˆ°åº•å“ªä¸ªå¥½å‘¢ï¼Ÿå¤šé¡¹å¼ï¼Ÿè¿˜æ˜¯ç›´çº¿ï¼Ÿä¸€èˆ¬åœ°è¯´è‚¯å®šæ˜¯è¶Šä½é˜¶çš„å¤šé¡¹å¼è¶Šé è°±ï¼ˆå½“ç„¶å‰ææ˜¯ä¹Ÿä¸èƒ½å¿½è§†â€œä¼¼ç„¶â€P(D | h) ï¼Œæ˜æ‘†ç€ä¸€ä¸ªå¤šé¡¹å¼åˆ†å¸ƒæ‚¨æ„£æ˜¯å»æ‹¿ç›´çº¿æ‹Ÿåˆä¹Ÿæ˜¯ä¸é è°±çš„ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦æŠŠå®ƒä»¬ä¸¤è€…ä¹˜èµ·æ¥è€ƒè™‘ã€‚ï¼‰ï¼ŒåŸå› ä¹‹ä¸€å°±æ˜¯ä½é˜¶å¤šé¡¹å¼æ›´å¸¸è§ï¼Œå…ˆéªŒæ¦‚ç‡ï¼ˆ P(h) ï¼‰è¾ƒå¤§ï¼ˆåŸå› ä¹‹äºŒåˆ™éšè—åœ¨ P(D | h) é‡Œé¢ï¼‰ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨æ ·æ¡ï¼ˆSpline interpolationï¼‰æ¥æ’å€¼ï¼Œè€Œä¸æ˜¯ç›´æ¥æä¸€ä¸ª N-1 é˜¶å¤šé¡¹å¼æ¥é€šè¿‡ä»»æ„ N ä¸ªç‚¹çš„åŸå› ã€‚ ä»¥ä¸Šåˆ†æå½“ä¸­éšå«çš„å“²å­¦æ˜¯ï¼Œè§‚æµ‹æ•°æ®æ€»æ˜¯ä¼šæœ‰å„ç§å„æ ·çš„è¯¯å·®ï¼Œæ¯”å¦‚è§‚æµ‹è¯¯å·®ï¼ˆæ¯”å¦‚ä½ è§‚æµ‹çš„æ—¶å€™ä¸€ä¸ª MM ç»è¿‡ä½ ä¸€ä¸ç•™ç¥ï¼Œæ‰‹ä¸€æŠ–å°±æ˜¯ä¸€ä¸ªè¯¯å·®å‡ºç°äº†ï¼‰ï¼Œæ‰€ä»¥å¦‚æœè¿‡åˆ†å»å¯»æ±‚èƒ½å¤Ÿå®Œç¾è§£é‡Šè§‚æµ‹æ•°æ®çš„æ¨¡å‹ï¼Œå°±ä¼šè½å…¥æ‰€è°“çš„æ•°æ®è¿‡é…ï¼ˆoverfittingï¼‰çš„å¢ƒåœ°ï¼Œä¸€ä¸ªè¿‡é…çš„æ¨¡å‹è¯•å›¾è¿è¯¯å·®ï¼ˆå™ªéŸ³ï¼‰éƒ½å»è§£é‡Šï¼ˆè€Œå®é™…ä¸Šå™ªéŸ³åˆæ˜¯ä¸éœ€è¦è§£é‡Šçš„ï¼‰ï¼Œæ˜¾ç„¶å°±è¿‡çŠ¹ä¸åŠäº†ã€‚æ‰€ä»¥ P(D | h) å¤§ä¸ä»£è¡¨ä½ çš„ h ï¼ˆçŒœæµ‹ï¼‰å°±æ˜¯æ›´å¥½çš„ hã€‚è¿˜è¦çœ‹ P(h) æ˜¯æ€æ ·çš„ã€‚æ‰€è°“å¥¥å¡å§†å‰ƒåˆ€ç²¾ç¥å°±æ˜¯è¯´ï¼šå¦‚æœä¸¤ä¸ªç†è®ºå…·æœ‰ç›¸ä¼¼çš„è§£é‡ŠåŠ›åº¦ï¼Œé‚£ä¹ˆä¼˜å…ˆé€‰æ‹©é‚£ä¸ªæ›´ç®€å•çš„ï¼ˆå¾€å¾€ä¹Ÿæ­£æ˜¯æ›´å¹³å‡¡çš„ï¼Œæ›´å°‘ç¹å¤çš„ï¼Œæ›´å¸¸è§çš„ï¼‰ã€‚ è¿‡åˆ†åŒ¹é…çš„å¦ä¸€ä¸ªåŸå› åœ¨äºå½“è§‚æµ‹çš„ç»“æœå¹¶ä¸æ˜¯å› ä¸ºè¯¯å·®è€Œæ˜¾å¾—â€œä¸ç²¾ç¡®â€è€Œæ˜¯å› ä¸ºçœŸå®ä¸–ç•Œä¸­å¯¹æ•°æ®çš„ç»“æœäº§ç”Ÿè´¡çŒ®çš„å› ç´ å¤ªå¤šå¤ªå¤šï¼Œè·Ÿå™ªéŸ³ä¸åŒï¼Œè¿™äº›åå·®æ˜¯ä¸€äº›å¦å¤–çš„å› ç´ é›†ä½“è´¡çŒ®çš„ç»“æœï¼Œä¸æ˜¯ä½ çš„æ¨¡å‹æ‰€èƒ½è§£é‡Šçš„â€”â€”å™ªéŸ³é‚£æ˜¯ä¸éœ€è¦è§£é‡Šâ€”â€”ä¸€ä¸ªç°å®çš„æ¨¡å‹å¾€å¾€åªæå–å‡ºå‡ ä¸ªä¸ç»“æœç›¸å…³åº¦å¾ˆé«˜ï¼Œå¾ˆé‡è¦çš„å› ç´ ï¼ˆcauseï¼‰ã€‚è¿™ä¸ªæ—¶å€™è§‚å¯Ÿæ•°æ®ä¼šå€¾å‘äºå›´ç»•ä½ çš„æœ‰é™æ¨¡å‹çš„é¢„æµ‹ç»“æœå‘ˆæ­£æ€åˆ†å¸ƒï¼Œäºæ˜¯ä½ å®é™…è§‚å¯Ÿåˆ°çš„ç»“æœå°±æ˜¯è¿™ä¸ªæ­£æ€åˆ†å¸ƒçš„éšæœºå–æ ·ï¼Œè¿™ä¸ªå–æ ·å¾ˆå¯èƒ½å—åˆ°å…¶ä½™å› ç´ çš„å½±å“åç¦»ä½ çš„æ¨¡å‹æ‰€é¢„æµ‹çš„ä¸­å¿ƒï¼Œè¿™ä¸ªæ—¶å€™ä¾¿ä¸èƒ½è´ªå¿ƒä¸è¶³åœ°è¯•å›¾é€šè¿‡æ”¹å˜æ¨¡å‹æ¥â€œå®Œç¾â€åŒ¹é…æ•°æ®ï¼Œå› ä¸ºé‚£äº›ä½¿ç»“æœåç¦»ä½ çš„é¢„æµ‹çš„è´¡çŒ®å› ç´ ä¸æ˜¯ä½ è¿™ä¸ªæœ‰é™æ¨¡å‹é‡Œé¢å«æœ‰çš„å› ç´ æ‰€èƒ½æ¦‚æ‹¬çš„ï¼Œç¡¬è¦æ‰“è‚¿è„¸å……èƒ–å­åªèƒ½å¯¼è‡´ä¸å®é™…çš„æ¨¡å‹ï¼Œä¸¾ä¸ªæ•™ç§‘ä¹¦ä¾‹å­ï¼šèº«é«˜å’Œä½“é‡çš„å®é™…å…³ç³»è¿‘ä¼¼äºä¸€ä¸ªäºŒé˜¶å¤šé¡¹å¼çš„å…³ç³»ï¼Œä½†å¤§å®¶éƒ½çŸ¥é“å¹¶ä¸æ˜¯åªæœ‰èº«é«˜æ‰ä¼šå¯¹ä½“é‡äº§ç”Ÿå½±å“ï¼Œç‰©ç†ä¸–ç•Œå½±å“ä½“é‡çš„å› ç´ å¤ªå¤šå¤ªå¤šäº†ï¼Œæœ‰äººèº«æé«˜å¤§å´ç˜¦å¾—è·Ÿç¨»è‰ï¼Œæœ‰äººå´æ˜¯æ¨ªé•¿ç«–ä¸é•¿ã€‚ä½†ä¸å¯å¦è®¤çš„æ˜¯æ€»ä½“ä¸Šæ¥è¯´ï¼Œé‚£äº›ç‰¹æ®Šæƒ…å†µè¶Šæ˜¯ç‰¹æ®Šå°±è¶Šæ˜¯ç¨€å°‘ï¼Œå‘ˆå›´ç»•æœ€æ™®éæƒ…å†µï¼ˆèƒ–ç˜¦é€‚ä¸­ï¼‰çš„æ­£æ€åˆ†å¸ƒï¼Œè¿™ä¸ªåˆ†å¸ƒå°±ä¿è¯äº†æˆ‘ä»¬çš„èº«é«˜â€”â€”ä½“é‡ç›¸å…³æ¨¡å‹èƒ½å¤Ÿåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åšå‡ºé è°±çš„é¢„æµ‹ã€‚ä½†æ˜¯â€”â€”åˆšæ‰è¯´äº†ï¼Œç‰¹ä¾‹æ˜¯å­˜åœ¨çš„ï¼Œå°±ç®—ä¸æ˜¯ç‰¹ä¾‹ï¼Œäººæœ‰èƒ–ç˜¦ï¼Œå¯†åº¦ä¹Ÿæœ‰å¤§å°ï¼Œæ‰€ä»¥å®Œç¾ç¬¦åˆèº«é«˜â€”â€”ä½“é‡çš„æŸä¸ªå‡æƒ³çš„äºŒé˜¶å¤šé¡¹å¼å…³ç³»çš„äººæ˜¯ä¸å­˜åœ¨çš„ï¼Œæˆ‘ä»¬åˆä¸æ˜¯æ¬§å‡ é‡Œå¾·å‡ ä½•ä¸–ç•Œå½“ä¸­çš„ç†æƒ³å¤šé¢ä½“ï¼Œæ‰€ä»¥ï¼Œå½“æˆ‘ä»¬å¯¹äººç¾¤éšæœºæŠ½å–äº† N ä¸ªæ ·æœ¬ï¼ˆæ•°æ®ç‚¹ï¼‰è¯•å›¾å¯¹è¿™ N ä¸ªæ•°æ®ç‚¹æ‹Ÿåˆå‡ºä¸€ä¸ªå¤šé¡¹å¼çš„è¯å°±å¾—æ³¨æ„ï¼Œå®ƒè‚¯å®šå¾—æ˜¯äºŒé˜¶å¤šé¡¹å¼ï¼Œæˆ‘ä»¬è¦åšçš„åªæ˜¯å»æ ¹æ®æ•°æ®ç‚¹è®¡ç®—å‡ºå¤šé¡¹å¼å„é¡¹çš„å‚æ•°ï¼ˆä¸€ä¸ªå…¸å‹çš„æ–¹æ³•å°±æ˜¯æœ€å°äºŒä¹˜ï¼‰ï¼›å®ƒè‚¯å®šä¸æ˜¯ç›´çº¿ï¼ˆæˆ‘ä»¬åˆä¸æ˜¯ç¨»è‰ï¼‰ï¼Œä¹Ÿä¸æ˜¯ä¸‰é˜¶å¤šé¡¹å¼å››é˜¶å¤šé¡¹å¼.. å¦‚æœç¡¬è¦å®Œç¾æ‹Ÿåˆ N ä¸ªç‚¹ï¼Œä½ å¯èƒ½ä¼šæ•´å‡ºä¸€ä¸ª N-1 é˜¶å¤šé¡¹å¼æ¥â€”â€”è®¾æƒ³èº«é«˜å’Œä½“é‡çš„å…³ç³»æ˜¯ 5 é˜¶å¤šé¡¹å¼çœ‹çœ‹ï¼Ÿ 3.2 æ¨¡å‹æ¯”è¾ƒç†è®ºï¼ˆModel Comparasionï¼‰ä¸è´å¶æ–¯å¥¥å¡å§†å‰ƒåˆ€ï¼ˆBayesian Occamâ€™s Razorï¼‰å®é™…ä¸Šï¼Œæ¨¡å‹æ¯”è¾ƒå°±æ˜¯å»æ¯”è¾ƒå“ªä¸ªæ¨¡å‹ï¼ˆçŒœæµ‹ï¼‰æ›´å¯èƒ½éšè—åœ¨è§‚å¯Ÿæ•°æ®çš„èƒŒåã€‚å…¶åŸºæœ¬æ€æƒ³å‰é¢å·²ç»ç”¨æ‹¼å†™çº æ­£çš„ä¾‹å­æ¥è¯´æ˜äº†ã€‚æˆ‘ä»¬å¯¹ç”¨æˆ·å®é™…æƒ³è¾“å…¥çš„å•è¯çš„çŒœæµ‹å°±æ˜¯æ¨¡å‹ï¼Œç”¨æˆ·è¾“é”™çš„å•è¯å°±æ˜¯è§‚æµ‹æ•°æ®ã€‚æˆ‘ä»¬é€šè¿‡ï¼š 1P(h | D) âˆ P(h) * P(D | h) æ¥æ¯”è¾ƒå“ªä¸ªæ¨¡å‹æœ€ä¸ºé è°±ã€‚å‰é¢æåˆ°ï¼Œå…‰é  P(D | h) ï¼ˆå³â€œä¼¼ç„¶â€ï¼‰æ˜¯ä¸å¤Ÿçš„ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦å¼•å…¥ P(h) è¿™ä¸ªå…ˆéªŒæ¦‚ç‡ã€‚å¥¥å¡å§†å‰ƒåˆ€å°±æ˜¯è¯´ P(h) è¾ƒå¤§çš„æ¨¡å‹æœ‰è¾ƒå¤§çš„ä¼˜åŠ¿ï¼Œè€Œæœ€å¤§ä¼¼ç„¶åˆ™æ˜¯è¯´æœ€ç¬¦åˆè§‚æµ‹æ•°æ®çš„ï¼ˆå³ P(D | h) æœ€å¤§çš„ï¼‰æœ€æœ‰ä¼˜åŠ¿ã€‚æ•´ä¸ªæ¨¡å‹æ¯”è¾ƒå°±æ˜¯è¿™ä¸¤æ–¹åŠ›é‡çš„æ‹‰é”¯ã€‚æˆ‘ä»¬ä¸å¦¨å†ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜è¿™ä¸€ç²¾ç¥ï¼šä½ éšä¾¿æ‰¾æšç¡¬å¸ï¼Œæ·ä¸€ä¸‹ï¼Œè§‚å¯Ÿä¸€ä¸‹ç»“æœã€‚å¥½ï¼Œä½ è§‚å¯Ÿåˆ°çš„ç»“æœè¦ä¹ˆæ˜¯â€œæ­£â€ï¼Œè¦ä¹ˆæ˜¯â€œåâ€ï¼ˆä¸ï¼Œä¸æ˜¯å°‘æ—è¶³çƒé‚£æšç¡¬å¸:P ï¼‰ï¼Œä¸å¦¨å‡è®¾ä½ è§‚å¯Ÿåˆ°çš„æ˜¯â€œæ­£â€ã€‚ç°åœ¨ä½ è¦å»æ ¹æ®è¿™ä¸ªè§‚æµ‹æ•°æ®æ¨æ–­è¿™æšç¡¬å¸æ·å‡ºâ€œæ­£â€çš„æ¦‚ç‡æ˜¯å¤šå¤§ã€‚æ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„ç²¾ç¥ï¼Œæˆ‘ä»¬åº”è¯¥çŒœæµ‹è¿™æšç¡¬å¸æ·å‡ºâ€œæ­£â€çš„æ¦‚ç‡æ˜¯ 1 ï¼Œå› ä¸ºè¿™ä¸ªæ‰æ˜¯èƒ½æœ€å¤§åŒ– P(D | h) çš„é‚£ä¸ªçŒœæµ‹ã€‚ç„¶è€Œæ¯ä¸ªäººéƒ½ä¼šå¤§æ‘‡å…¶å¤´â€”â€”å¾ˆæ˜¾ç„¶ï¼Œä½ éšæœºæ‘¸å‡ºä¸€æšç¡¬å¸è¿™æšç¡¬å¸å±…ç„¶æ²¡æœ‰åé¢çš„æ¦‚ç‡æ˜¯â€œä¸å­˜åœ¨çš„â€ï¼Œæˆ‘ä»¬å¯¹ä¸€æšéšæœºç¡¬å¸æ˜¯å¦ä¸€æšæœ‰åç¡¬å¸ï¼Œåäº†å¤šå°‘ï¼Œæ˜¯æœ‰ç€ä¸€ä¸ªå…ˆéªŒçš„è®¤è¯†çš„ï¼Œè¿™ä¸ªè®¤è¯†å°±æ˜¯ç»å¤§å¤šæ•°ç¡¬å¸éƒ½æ˜¯åŸºæœ¬å…¬å¹³çš„ï¼Œåå¾—è¶Šå¤šçš„ç¡¬å¸è¶Šå°‘è§ï¼ˆå¯ä»¥ç”¨ä¸€ä¸ª betaåˆ†å¸ƒæ¥è¡¨è¾¾è¿™ä¸€å…ˆéªŒæ¦‚ç‡ï¼‰ã€‚å°†è¿™ä¸ªå…ˆéªŒæ­£æ€åˆ†å¸ƒ p(Î¸) ï¼ˆå…¶ä¸­ Î¸ è¡¨ç¤ºç¡¬å¸æ·å‡ºæ­£é¢çš„æ¯”ä¾‹ï¼Œå°å†™çš„ p ä»£è¡¨è¿™æ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼‰ç»“åˆåˆ°æˆ‘ä»¬çš„é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ä¾¿ä¸æ˜¯å»æœ€å¤§åŒ– P(D | h) ï¼Œè€Œæ˜¯å»æœ€å¤§åŒ– P(D | Î¸) * p(Î¸) ï¼Œæ˜¾ç„¶ Î¸ = 1 æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸º P(Î¸=1) ä¸º 0 ï¼Œå¯¼è‡´æ•´ä¸ªä¹˜ç§¯ä¹Ÿä¸º 0 ã€‚å®é™…ä¸Šï¼Œåªè¦å¯¹è¿™ä¸ªå¼å­æ±‚ä¸€ä¸ªå¯¼æ•°å°±å¯ä»¥å¾—åˆ°æœ€å€¼ç‚¹ã€‚ ä»¥ä¸Šè¯´çš„æ˜¯å½“æˆ‘ä»¬çŸ¥é“å…ˆéªŒæ¦‚ç‡ P(h) çš„æ—¶å€™ï¼Œå…‰ç”¨æœ€å¤§ä¼¼ç„¶æ˜¯ä¸é è°±çš„ï¼Œå› ä¸ºæœ€å¤§ä¼¼ç„¶çš„çŒœæµ‹å¯èƒ½å…ˆéªŒæ¦‚ç‡éå¸¸å°ã€‚ç„¶è€Œï¼Œæœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬å¯¹äºå…ˆéªŒæ¦‚ç‡ä¸€æ— æ‰€çŸ¥ï¼Œåªèƒ½å‡è®¾æ¯ç§çŒœæµ‹çš„å…ˆéªŒæ¦‚ç‡æ˜¯å‡ç­‰çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±åªæœ‰ç”¨æœ€å¤§ä¼¼ç„¶äº†ã€‚å®é™…ä¸Šï¼Œç»Ÿè®¡å­¦å®¶å’Œè´å¶æ–¯å­¦å®¶æœ‰ä¸€ä¸ªæœ‰è¶£çš„äº‰è®ºï¼Œç»Ÿè®¡å­¦å®¶è¯´ï¼šæˆ‘ä»¬è®©æ•°æ®è‡ªå·±è¯´è¯ã€‚è¨€ä¸‹ä¹‹æ„å°±æ˜¯è¦æ‘’å¼ƒå…ˆéªŒæ¦‚ç‡ã€‚è€Œè´å¶æ–¯æ”¯æŒè€…åˆ™è¯´ï¼šæ•°æ®ä¼šæœ‰å„ç§å„æ ·çš„åå·®ï¼Œè€Œä¸€ä¸ªé è°±çš„å…ˆéªŒæ¦‚ç‡åˆ™å¯ä»¥å¯¹è¿™äº›éšæœºå™ªéŸ³åšåˆ°å¥å£®ã€‚äº‹å®è¯æ˜è´å¶æ–¯æ´¾èƒœåˆ©äº†ï¼Œèƒœåˆ©çš„å…³é”®åœ¨äºæ‰€è°“å…ˆéªŒæ¦‚ç‡å…¶å®ä¹Ÿæ˜¯ç»éªŒç»Ÿè®¡çš„ç»“æœï¼Œè­¬å¦‚ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šè®¤ä¸ºç»å¤§å¤šæ•°ç¡¬å¸æ˜¯åŸºæœ¬å…¬å¹³çš„ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬è®¤ä¸ºå¤§å¤šæ•°äººçš„è‚¥èƒ–é€‚ä¸­ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬è®¤ä¸ºè‚¤è‰²æ˜¯ç§æ—ç›¸å…³çš„ï¼Œè€Œä½“é‡åˆ™ä¸ç§æ—æ— å…³ï¼Ÿå…ˆéªŒæ¦‚ç‡é‡Œé¢çš„â€œå…ˆéªŒâ€å¹¶ä¸æ˜¯æŒ‡å…ˆäºä¸€åˆ‡ç»éªŒï¼Œè€Œæ˜¯ä»…æŒ‡å…ˆäºæˆ‘ä»¬â€œå½“å‰â€ç»™å‡ºçš„è§‚æµ‹æ•°æ®è€Œå·²ï¼Œåœ¨ç¡¬å¸çš„ä¾‹å­ä¸­å…ˆéªŒæŒ‡çš„åªæ˜¯å…ˆäºæˆ‘ä»¬çŸ¥é“æŠ•æ·çš„ç»“æœè¿™ä¸ªç»éªŒï¼Œè€Œå¹¶éâ€œå…ˆå¤©â€ã€‚ ç„¶è€Œï¼Œè¯è¯´å›æ¥ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¿…é¡»å¾—æ‰¿è®¤ï¼Œå°±ç®—æ˜¯åŸºäºä»¥å¾€çš„ç»éªŒï¼Œæˆ‘ä»¬æ‰‹å¤´çš„â€œå…ˆéªŒâ€æ¦‚ç‡è¿˜æ˜¯å‡åŒ€åˆ†å¸ƒï¼Œè¿™ä¸ªæ—¶å€™å°±å¿…é¡»ä¾èµ–ç”¨æœ€å¤§ä¼¼ç„¶ï¼Œæˆ‘ä»¬ç”¨å‰é¢ç•™ä¸‹çš„ä¸€ä¸ªè‡ªç„¶è¯­è¨€äºŒä¹‰æ€§é—®é¢˜æ¥è¯´æ˜è¿™ä¸€ç‚¹ï¼š The girl saw the boy with a telescope. åˆ°åº•æ˜¯ The girl saw-with-a-telescope the boy è¿™ä¸€è¯­æ³•ç»“æ„ï¼Œè¿˜æ˜¯ The girl saw the-boy-with-a-telescope å‘¢ï¼Ÿä¸¤ç§è¯­æ³•ç»“æ„çš„å¸¸è§ç¨‹åº¦éƒ½å·®ä¸å¤šï¼ˆä½ å¯èƒ½ä¼šè§‰å¾—åä¸€ç§è¯­æ³•ç»“æ„çš„å¸¸è§ç¨‹åº¦è¾ƒä½ï¼Œè¿™æ˜¯äº‹ååè§ï¼Œä½ åªéœ€æƒ³æƒ³ The girl saw the boy with a book å°±çŸ¥é“äº†ã€‚å½“ç„¶ï¼Œå®é™…ä¸Šä»å¤§è§„æ¨¡è¯­æ–™ç»Ÿè®¡ç»“æœæ¥çœ‹åä¸€ç§è¯­æ³•ç»“æ„çš„ç¡®ç¨ç¨ä¸å¸¸è§ä¸€ä¸ç‚¹ï¼Œä½†æ˜¯ç»å¯¹ä¸è¶³ä»¥è§£é‡Šæˆ‘ä»¬å¯¹ç¬¬ä¸€ç§ç»“æ„çš„å¼ºçƒˆå€¾å‘ï¼‰ã€‚é‚£ä¹ˆåˆ°åº•ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ æˆ‘ä»¬ä¸å¦¨å…ˆæ¥çœ‹çœ‹ MacKay åœ¨ä¹¦ä¸­ä¸¾çš„ä¸€ä¸ªæ¼‚äº®çš„ä¾‹å­ï¼š å›¾ä¸­æœ‰å¤šå°‘ä¸ªç®±å­ï¼Ÿç‰¹åˆ«åœ°ï¼Œé‚£æ£µä¹¦åé¢æ˜¯ä¸€ä¸ªç®±å­ï¼Ÿè¿˜æ˜¯ä¸¤ä¸ªç®±å­ï¼Ÿè¿˜æ˜¯ä¸‰ä¸ªç®±å­ï¼Ÿè¿˜æ˜¯.. ä½ å¯èƒ½ä¼šè§‰å¾—æ ‘åé¢è‚¯å®šæ˜¯ä¸€ä¸ªç®±å­ï¼Œä½†ä¸ºä»€ä¹ˆä¸æ˜¯ä¸¤ä¸ªå‘¢ï¼Ÿå¦‚ä¸‹å›¾ï¼š å¾ˆç®€å•ï¼Œä½ ä¼šè¯´ï¼šè¦æ˜¯çœŸçš„æœ‰ä¸¤ä¸ªç®±å­é‚£æ‰æ€ªäº†ï¼Œæ€ä¹ˆå°±é‚£ä¹ˆå·§è¿™ä¸¤ä¸ªç®±å­åˆšåˆšå¥½é¢œè‰²ç›¸åŒï¼Œé«˜åº¦ç›¸åŒå‘¢ï¼Ÿ ç”¨æ¦‚ç‡è®ºçš„è¯­è¨€æ¥è¯´ï¼Œä½ åˆšæ‰çš„è¯å°±ç¿»è¯‘ä¸ºï¼šçŒœæµ‹ h ä¸æˆç«‹ï¼Œå› ä¸º P(D | h) å¤ªå°ï¼ˆå¤ªå·§åˆï¼‰äº†ã€‚æˆ‘ä»¬çš„ç›´è§‰æ˜¯ï¼šå·§åˆï¼ˆå°æ¦‚ç‡ï¼‰äº‹ä»¶ä¸ä¼šå‘ç”Ÿã€‚æ‰€ä»¥å½“ä¸€ä¸ªçŒœæµ‹ï¼ˆå‡è®¾ï¼‰ä½¿å¾—æˆ‘ä»¬çš„è§‚æµ‹ç»“æœæˆä¸ºå°æ¦‚ç‡äº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±è¯´â€œæ‰æ€ªå‘¢ï¼Œå“ªèƒ½é‚£ä¹ˆå·§æï¼Ÿï¼â€ ç°åœ¨æˆ‘ä»¬å¯ä»¥å›åˆ°é‚£ä¸ªè‡ªç„¶è¯­è¨€äºŒä¹‰æ€§çš„ä¾‹å­ï¼Œå¹¶ç»™å‡ºä¸€ä¸ªå®Œç¾çš„è§£é‡Šäº†ï¼šå¦‚æœè¯­æ³•ç»“æ„æ˜¯ The girl saw the-boy-with-a-telecope çš„è¯ï¼Œæ€ä¹ˆé‚£ä¸ªç”·å­©ååæ‰‹é‡Œæ‹¿çš„å°±æ˜¯æœ›è¿œé•œâ€”â€”ä¸€ä¸ªå¯ä»¥è¢«ç”¨æ¥ saw-with çš„ä¸œä¸œæï¼Ÿè¿™ä¹Ÿå¿’å°æ¦‚ç‡äº†å§ã€‚ä»–å’‹å°±ä¸ä¼šæ‹¿æœ¬ä¹¦å‘¢ï¼Ÿæ‹¿ä»€ä¹ˆéƒ½å¥½ã€‚æ€ä¹ˆååå°±æ‹¿äº†æœ›è¿œé•œï¼Ÿæ‰€ä»¥å”¯ä¸€çš„è§£é‡Šæ˜¯ï¼Œè¿™ä¸ªâ€œå·§åˆâ€èƒŒåè‚¯å®šæœ‰å®ƒçš„å¿…ç„¶æ€§ï¼Œè¿™ä¸ªå¿…ç„¶æ€§å°±æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å°†è¯­æ³•ç»“æ„è§£é‡Šä¸º The girl saw-with-a-telescope the boy çš„è¯ï¼Œå°±è·Ÿæ•°æ®å®Œç¾å»åˆäº†â€”â€”æ—¢ç„¶é‚£ä¸ªå¥³å­©æ˜¯ç”¨æŸä¸ªä¸œè¥¿å»çœ‹è¿™ä¸ªç”·å­©çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸œè¥¿æ˜¯ä¸€ä¸ªæœ›è¿œé•œå°±å®Œå…¨å¯ä»¥è§£é‡Šäº†ï¼ˆä¸å†æ˜¯å°æ¦‚ç‡äº‹ä»¶äº†ï¼‰ã€‚ è‡ªç„¶è¯­è¨€äºŒä¹‰æ€§å¾ˆå¸¸è§ï¼Œè­¬å¦‚ä¸Šæ–‡ä¸­çš„ä¸€å¥è¯ï¼š å‚è§ã€Šå†³ç­–ä¸åˆ¤æ–­ã€‹ä»¥åŠã€ŠRationality for Mortalsã€‹ç¬¬12ç« ï¼šå°å­©ä¹Ÿå¯ä»¥è§£å†³è´å¶æ–¯é—®é¢˜ å°±æœ‰äºŒä¹‰æ€§ï¼šåˆ°åº•æ˜¯å‚è§è¿™ä¸¤æœ¬ä¹¦çš„ç¬¬ 12 ç« ï¼Œè¿˜æ˜¯ä»…ä»…æ˜¯ç¬¬äºŒæœ¬ä¹¦çš„ç¬¬ 12 ç« å‘¢ï¼Ÿå¦‚æœæ˜¯è¿™ä¸¤æœ¬ä¹¦çš„ç¬¬ 12 ç« é‚£å°±æ˜¯å’„å’„æ€ªäº‹äº†ï¼Œæ€ä¹ˆæ°å¥½ä¸¤æœ¬ä¹¦éƒ½æœ‰ç¬¬ 12 ç« ï¼Œéƒ½æ˜¯è®²åŒä¸€ä¸ªé—®é¢˜ï¼Œæ›´è¯¡å¼‚çš„æ˜¯ï¼Œæ ‡é¢˜è¿˜ç›¸åŒå‘¢ï¼Ÿ æ³¨æ„ï¼Œä»¥ä¸Šåšçš„æ˜¯ä¼¼ç„¶ä¼°è®¡ï¼ˆå³åªçœ‹ P(D | h) çš„å¤§å°ï¼‰ï¼Œä¸å«å…ˆéªŒæ¦‚ç‡ã€‚é€šè¿‡è¿™ä¸¤ä¸ªä¾‹å­ï¼Œå°¤å…¶æ˜¯é‚£ä¸ªæ ‘åé¢çš„ç®±å­çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¼¼ç„¶ä¼°è®¡é‡Œé¢ä¹Ÿè•´å«ç€å¥¥å¡å§†å‰ƒåˆ€ï¼šæ ‘åé¢çš„ç®±å­æ•°ç›®è¶Šå¤šï¼Œè¿™ä¸ªæ¨¡å‹å°±è¶Šå¤æ‚ã€‚å•ä¸ªç®±å­çš„æ¨¡å‹æ˜¯æœ€ç®€å•çš„ã€‚ä¼¼ç„¶ä¼°è®¡é€‰æ‹©äº†æ›´ç®€å•çš„æ¨¡å‹ã€‚ è¿™ä¸ªå°±æ˜¯æ‰€è°“çš„è´å¶æ–¯å¥¥å¡å§†å‰ƒåˆ€ï¼ˆBayesian Occamâ€™s Razorï¼‰ï¼Œå› ä¸ºè¿™ä¸ªå‰ƒåˆ€å·¥ä½œåœ¨è´å¶æ–¯å…¬å¼çš„ä¼¼ç„¶ï¼ˆP(D | h) ï¼‰ä¸Šï¼Œè€Œä¸æ˜¯æ¨¡å‹æœ¬èº«ï¼ˆ P(h) ï¼‰çš„å…ˆéªŒæ¦‚ç‡ä¸Šï¼Œåè€…æ˜¯ä¼ ç»Ÿçš„å¥¥å¡å§†å‰ƒåˆ€ã€‚å…³äºè´å¶æ–¯å¥¥å¡å§†å‰ƒåˆ€æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªå‰é¢è¯´åˆ°çš„æ›²çº¿æ‹Ÿåˆçš„ä¾‹å­ï¼šå¦‚æœå¹³é¢ä¸Šæœ‰ N ä¸ªç‚¹ï¼Œè¿‘ä¼¼æ„æˆä¸€æ¡ç›´çº¿ï¼Œä½†ç»ä¸ç²¾ç¡®åœ°ä½äºä¸€æ¡ç›´çº¿ä¸Šã€‚è¿™æ—¶æˆ‘ä»¬æ—¢å¯ä»¥ç”¨ç›´çº¿æ¥æ‹Ÿåˆï¼ˆæ¨¡å‹1ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨äºŒé˜¶å¤šé¡¹å¼ï¼ˆæ¨¡å‹2ï¼‰æ‹Ÿåˆï¼Œä¹Ÿå¯ä»¥ç”¨ä¸‰é˜¶å¤šé¡¹å¼ï¼ˆæ¨¡å‹3ï¼‰ï¼Œ.. ï¼Œç‰¹åˆ«åœ°ï¼Œç”¨ N-1 é˜¶å¤šé¡¹å¼ä¾¿èƒ½å¤Ÿä¿è¯è‚¯å®šèƒ½å®Œç¾é€šè¿‡ N ä¸ªæ•°æ®ç‚¹ã€‚é‚£ä¹ˆï¼Œè¿™äº›å¯èƒ½çš„æ¨¡å‹ä¹‹ä¸­åˆ°åº•å“ªä¸ªæ˜¯æœ€é è°±çš„å‘¢ï¼Ÿå‰é¢æåˆ°ï¼Œä¸€ä¸ªè¡¡é‡çš„ä¾æ®æ˜¯å¥¥å¡å§†å‰ƒåˆ€ï¼šè¶Šæ˜¯é«˜é˜¶çš„å¤šé¡¹å¼è¶Šæ˜¯ç¹å¤å’Œä¸å¸¸è§ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å…¶å®å¹¶ä¸éœ€è¦ä¾èµ–äºè¿™ä¸ªå…ˆéªŒçš„å¥¥å¡å§†å‰ƒåˆ€ï¼Œå› ä¸ºæœ‰äººå¯èƒ½ä¼šäº‰è¾©è¯´ï¼šä½ æ€ä¹ˆå°±èƒ½è¯´è¶Šé«˜é˜¶çš„å¤šé¡¹å¼è¶Šä¸å¸¸è§å‘¢ï¼Ÿæˆ‘ååè§‰å¾—æ‰€æœ‰é˜¶å¤šé¡¹å¼éƒ½æ˜¯ç­‰å¯èƒ½çš„ã€‚å¥½å§ï¼Œæ—¢ç„¶å¦‚æ­¤é‚£æˆ‘ä»¬ä¸å¦¨å°±æ‰”æ‰ P(h) é¡¹ï¼Œçœ‹çœ‹ P(D | h) èƒ½å‘Šè¯‰æˆ‘ä»¬ä»€ä¹ˆã€‚æˆ‘ä»¬æ³¨æ„åˆ°è¶Šæ˜¯é«˜é˜¶çš„å¤šé¡¹å¼ï¼Œå®ƒçš„è½¨è¿¹å¼¯æ›²ç¨‹åº¦è¶Šæ˜¯å¤§ï¼Œåˆ°äº†å…«ä¹é˜¶ç®€ç›´å°±æ˜¯ç›´ä¸Šç›´ä¸‹ï¼Œäºæ˜¯æˆ‘ä»¬ä¸ä»…è¦é—®ï¼šä¸€ä¸ªæ¯”å¦‚è¯´å…«é˜¶å¤šé¡¹å¼åœ¨å¹³é¢ä¸Šéšæœºç”Ÿæˆçš„ä¸€å † N ä¸ªç‚¹ååæ°å¥½è¿‘ä¼¼æ„æˆä¸€æ¡ç›´çº¿çš„æ¦‚ç‡ï¼ˆå³ P(D | h) ï¼‰æœ‰å¤šå¤§ï¼Ÿå¤ªå°å¤ªå°äº†ã€‚åä¹‹ï¼Œå¦‚æœèƒŒåçš„æ¨¡å‹æ˜¯ä¸€æ¡ç›´çº¿ï¼Œé‚£ä¹ˆæ ¹æ®è¯¥æ¨¡å‹ç”Ÿæˆä¸€å †è¿‘ä¼¼æ„æˆç›´çº¿çš„ç‚¹çš„æ¦‚ç‡å°±å¤§å¾—å¤šäº†ã€‚è¿™å°±æ˜¯è´å¶æ–¯å¥¥å¡å§†å‰ƒåˆ€ã€‚ è¿™é‡Œåªæ˜¯æä¾›ä¸€ä¸ªå…³äºè´å¶æ–¯å¥¥å¡å§†å‰ƒåˆ€çš„ç§‘æ™®ï¼Œå¼ºè°ƒç›´è§‚è§£é‡Šï¼Œæ›´å¤šç†è®ºå…¬å¼è¯·å‚è€ƒ MacKay çš„è‘—ä½œ ã€ŠInformation Theory : Inference and Learning Algorithmsã€‹ç¬¬ 28 ç« ã€‚ 3.3 æœ€å°æè¿°é•¿åº¦åŸåˆ™è´å¶æ–¯æ¨¡å‹æ¯”è¾ƒç†è®ºä¸ä¿¡æ¯è®ºæœ‰ä¸€ä¸ªæœ‰è¶£çš„å…³è”ï¼š 1P(h | D) âˆ P(h) * P(D | h) ä¸¤è¾¹æ±‚å¯¹æ•°ï¼Œå°†å³å¼çš„ä¹˜ç§¯å˜æˆç›¸åŠ ï¼š 1ln P(h | D) âˆ ln P(h) + ln P(D | h) æ˜¾ç„¶ï¼Œæœ€å¤§åŒ– P(h | D) ä¹Ÿå°±æ˜¯æœ€å¤§åŒ– ln P(h | D)ã€‚è€Œ ln P(h) + ln P(D | h) åˆ™å¯ä»¥è§£é‡Šä¸ºæ¨¡å‹ï¼ˆæˆ–è€…ç§°â€œå‡è®¾â€ã€â€œçŒœæµ‹â€ï¼‰h çš„ç¼–ç é•¿åº¦åŠ ä¸Šåœ¨è¯¥æ¨¡å‹ä¸‹æ•°æ® D çš„ç¼–ç é•¿åº¦ã€‚ä½¿è¿™ä¸ªå’Œæœ€å°çš„æ¨¡å‹å°±æ˜¯æœ€ä½³æ¨¡å‹ã€‚ è€Œç©¶ç«Ÿå¦‚ä½•å®šä¹‰ä¸€ä¸ªæ¨¡å‹çš„ç¼–ç é•¿åº¦ï¼Œä»¥åŠæ•°æ®åœ¨æ¨¡å‹ä¸‹çš„ç¼–ç é•¿åº¦åˆ™æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚æ›´å¤šå¯å‚è€ƒ Mitchell çš„ ã€ŠMachine Learningã€‹çš„ 6.6 èŠ‚ï¼Œæˆ– Mackay çš„ 28.3 èŠ‚ï¼‰ 3.4 æœ€ä¼˜è´å¶æ–¯æ¨ç†æ‰€è°“çš„æ¨ç†ï¼Œåˆ†ä¸ºä¸¤ä¸ªè¿‡ç¨‹ï¼Œç¬¬ä¸€æ­¥æ˜¯å¯¹è§‚æµ‹æ•°æ®å»ºç«‹ä¸€ä¸ªæ¨¡å‹ã€‚ç¬¬äºŒæ­¥åˆ™æ˜¯ä½¿ç”¨è¿™ä¸ªæ¨¡å‹æ¥æ¨æµ‹æœªçŸ¥ç°è±¡å‘ç”Ÿçš„æ¦‚ç‡ã€‚æˆ‘ä»¬å‰é¢éƒ½æ˜¯è®²çš„å¯¹äºè§‚æµ‹æ•°æ®ç»™å‡ºæœ€é è°±çš„é‚£ä¸ªæ¨¡å‹ã€‚ç„¶è€Œå¾ˆå¤šæ—¶å€™ï¼Œè™½ç„¶æŸä¸ªæ¨¡å‹æ˜¯æ‰€æœ‰æ¨¡å‹é‡Œé¢æœ€é è°±çš„ï¼Œä½†æ˜¯åˆ«çš„æ¨¡å‹ä¹Ÿå¹¶ä¸æ˜¯ä¸€ç‚¹æœºä¼šéƒ½æ²¡æœ‰ã€‚è­¬å¦‚ç¬¬ä¸€ä¸ªæ¨¡å‹åœ¨è§‚æµ‹æ•°æ®ä¸‹çš„æ¦‚ç‡æ˜¯ 0.5 ã€‚ç¬¬äºŒä¸ªæ¨¡å‹æ˜¯ 0.4 ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ 0.1 ã€‚å¦‚æœæˆ‘ä»¬åªæƒ³çŸ¥é“å¯¹äºè§‚æµ‹æ•°æ®å“ªä¸ªæ¨¡å‹æœ€å¯èƒ½ï¼Œé‚£ä¹ˆåªè¦å–ç¬¬ä¸€ä¸ªå°±è¡Œäº†ï¼Œæ•…äº‹åˆ°æ­¤ç»“æŸã€‚ç„¶è€Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å»ºç«‹æ¨¡å‹æ˜¯ä¸ºäº†æ¨æµ‹æœªçŸ¥çš„äº‹æƒ…çš„å‘ç”Ÿæ¦‚ç‡ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¸‰ä¸ªæ¨¡å‹å¯¹æœªçŸ¥çš„äº‹æƒ…å‘ç”Ÿçš„æ¦‚ç‡éƒ½ä¼šæœ‰è‡ªå·±çš„é¢„æµ‹ï¼Œä»…ä»…å› ä¸ºæŸä¸€ä¸ªæ¨¡å‹æ¦‚ç‡ç¨å¤§ä¸€ç‚¹å°±åªå¬ä»–ä¸€ä¸ªäººçš„å°±å¤ªä¸æ°‘ä¸»äº†ã€‚æ‰€è°“çš„æœ€ä¼˜è´å¶æ–¯æ¨ç†å°±æ˜¯å°†ä¸‰ä¸ªæ¨¡å‹å¯¹äºæœªçŸ¥æ•°æ®çš„é¢„æµ‹ç»“è®ºåŠ æƒå¹³å‡èµ·æ¥ï¼ˆæƒå€¼å°±æ˜¯æ¨¡å‹ç›¸åº”çš„æ¦‚ç‡ï¼‰ã€‚æ˜¾ç„¶ï¼Œè¿™ä¸ªæ¨ç†æ˜¯ç†è®ºä¸Šçš„åˆ¶é«˜ç‚¹ï¼Œæ— æ³•å†ä¼˜äº†ï¼Œå› ä¸ºå®ƒå·²ç»æŠŠæ‰€æœ‰å¯èƒ½æ€§éƒ½è€ƒè™‘è¿›å»äº†ã€‚ åªä¸è¿‡å®é™…ä¸Šæˆ‘ä»¬æ˜¯åŸºæœ¬ä¸ä¼šä½¿ç”¨è¿™ä¸ªæ¡†æ¶çš„ï¼Œå› ä¸ºè®¡ç®—æ¨¡å‹å¯èƒ½éå¸¸è´¹æ—¶é—´ï¼ŒäºŒæ¥æ¨¡å‹ç©ºé—´å¯èƒ½æ˜¯è¿ç»­çš„ï¼Œå³æœ‰æ— ç©·å¤šä¸ªæ¨¡å‹ï¼ˆè¿™ä¸ªæ—¶å€™éœ€è¦è®¡ç®—æ¨¡å‹çš„æ¦‚ç‡åˆ†å¸ƒï¼‰ã€‚ç»“æœè¿˜æ˜¯éå¸¸è´¹æ—¶é—´ã€‚æ‰€ä»¥è¿™ä¸ªè¢«çœ‹ä½œæ˜¯ä¸€ä¸ªç†è®ºåŸºå‡†ã€‚ 4. æ— å¤„ä¸åœ¨çš„è´å¶æ–¯ä»¥ä¸‹æˆ‘ä»¬å†ä¸¾ä¸€äº›å®é™…ä¾‹å­æ¥è¯´æ˜è´å¶æ–¯æ–¹æ³•è¢«è¿ç”¨çš„æ™®éæ€§ï¼Œè¿™é‡Œä¸»è¦é›†ä¸­åœ¨æœºå™¨å­¦ä¹ æ–¹é¢ï¼Œå› ä¸ºæˆ‘ä¸æ˜¯å­¦ç»æµçš„ï¼Œå¦åˆ™è¿˜å¯ä»¥æ‰¾åˆ°ä¸€å †ç»æµå­¦çš„ä¾‹å­ã€‚ 4.1 ä¸­æ–‡åˆ†è¯è´å¶æ–¯æ˜¯æœºå™¨å­¦ä¹ çš„æ ¸å¿ƒæ–¹æ³•ä¹‹ä¸€ã€‚æ¯”å¦‚ä¸­æ–‡åˆ†è¯é¢†åŸŸå°±ç”¨åˆ°äº†è´å¶æ–¯ã€‚Google ç ”ç©¶å‘˜å´å†›åœ¨ã€Šæ•°å­¦ä¹‹ç¾ã€‹ç³»åˆ—ä¸­å°±æœ‰ä¸€ç¯‡æ˜¯ä»‹ç»ä¸­æ–‡åˆ†è¯çš„ï¼Œè¿™é‡Œåªä»‹ç»ä¸€ä¸‹æ ¸å¿ƒçš„æ€æƒ³ï¼Œä¸åšèµ˜è¿°ã€‚ åˆ†è¯é—®é¢˜çš„æè¿°ä¸ºï¼šç»™å®šä¸€ä¸ªå¥å­ï¼ˆå­—ä¸²ï¼‰ï¼Œå¦‚ï¼š å—äº¬å¸‚é•¿æ±Ÿå¤§æ¡¥ å¦‚ä½•å¯¹è¿™ä¸ªå¥å­è¿›è¡Œåˆ†è¯ï¼ˆè¯ä¸²ï¼‰æ‰æ˜¯æœ€é è°±çš„ã€‚ä¾‹å¦‚ï¼š å—äº¬å¸‚/é•¿æ±Ÿå¤§æ¡¥ å—äº¬/å¸‚é•¿/æ±Ÿå¤§æ¡¥ è¿™ä¸¤ä¸ªåˆ†è¯ï¼Œåˆ°åº•å“ªä¸ªæ›´é è°±å‘¢ï¼Ÿ æˆ‘ä»¬ç”¨è´å¶æ–¯å…¬å¼æ¥å½¢å¼åŒ–åœ°æè¿°è¿™ä¸ªé—®é¢˜ï¼Œä»¤ X ä¸ºå­—ä¸²ï¼ˆå¥å­ï¼‰ï¼ŒY ä¸ºè¯ä¸²ï¼ˆä¸€ç§ç‰¹å®šçš„åˆ†è¯å‡è®¾ï¼‰ã€‚æˆ‘ä»¬å°±æ˜¯éœ€è¦å¯»æ‰¾ä½¿å¾— P(Y|X) æœ€å¤§çš„ Y ï¼Œä½¿ç”¨ä¸€æ¬¡è´å¶æ–¯å¯å¾—ï¼š 1P(Y|X) âˆ P(Y)*P(X|Y) ç”¨è‡ªç„¶è¯­è¨€æ¥è¯´å°±æ˜¯ è¿™ç§åˆ†è¯æ–¹å¼ï¼ˆè¯ä¸²ï¼‰çš„å¯èƒ½æ€§ ä¹˜ä»¥ è¿™ä¸ªè¯ä¸²ç”Ÿæˆæˆ‘ä»¬çš„å¥å­çš„å¯èƒ½æ€§ã€‚æˆ‘ä»¬è¿›ä¸€æ­¥å®¹æ˜“çœ‹åˆ°ï¼šå¯ä»¥è¿‘ä¼¼åœ°å°† P(X|Y) çœ‹ä½œæ˜¯æ’ç­‰äº 1 çš„ï¼Œå› ä¸ºä»»æ„å‡æƒ³çš„ä¸€ç§åˆ†è¯æ–¹å¼ä¹‹ä¸‹ç”Ÿæˆæˆ‘ä»¬çš„å¥å­æ€»æ˜¯ç²¾å‡†åœ°ç”Ÿæˆçš„ï¼ˆåªéœ€æŠŠåˆ†è¯ä¹‹é—´çš„åˆ†ç•Œç¬¦å·æ‰”æ‰å³å¯ï¼‰ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å°±å˜æˆäº†å»æœ€å¤§åŒ– P(Y) ï¼Œä¹Ÿå°±æ˜¯å¯»æ‰¾ä¸€ç§åˆ†è¯ä½¿å¾—è¿™ä¸ªè¯ä¸²ï¼ˆå¥å­ï¼‰çš„æ¦‚ç‡æœ€å¤§åŒ–ã€‚è€Œå¦‚ä½•è®¡ç®—ä¸€ä¸ªè¯ä¸²ï¼š W1, W2, W3, W4 .. çš„å¯èƒ½æ€§å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œæ ¹æ®è”åˆæ¦‚ç‡ï¼ˆJoint probability distributionï¼‰çš„å…¬å¼å±•å¼€ï¼šP(W1, W2, W3, W4 ..) = P(W1) P(W2|W1) P(W3|W2, W1) P(W4|W1,W2,W3) .. äºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ç³»åˆ—çš„æ¡ä»¶æ¦‚ç‡ï¼ˆå³å¼ï¼‰çš„ä¹˜ç§¯æ¥æ±‚æ•´ä¸ªè”åˆæ¦‚ç‡ã€‚ç„¶è€Œä¸å¹¸çš„æ˜¯éšç€æ¡ä»¶æ•°ç›®çš„å¢åŠ ï¼ˆP(Wn|Wn-1,Wn-2,..,W1) çš„æ¡ä»¶æœ‰ n-1 ä¸ªï¼‰ï¼Œæ•°æ®ç¨€ç–é—®é¢˜ä¹Ÿä¼šè¶Šæ¥è¶Šä¸¥é‡ï¼Œå³ä¾¿è¯­æ–™åº“å†å¤§ä¹Ÿæ— æ³•ç»Ÿè®¡å‡ºä¸€ä¸ªé è°±çš„ P(Wn|Wn-1,Wn-2,..,W1) æ¥ã€‚ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œè®¡ç®—æœºç§‘å­¦å®¶ä»¬ä¸€å¦‚æ—¢å¾€åœ°ä½¿ç”¨äº†â€œå¤©çœŸâ€å‡è®¾ï¼šæˆ‘ä»¬å‡è®¾å¥å­ä¸­ä¸€ä¸ªè¯çš„å‡ºç°æ¦‚ç‡åªä¾èµ–äºå®ƒå‰é¢çš„æœ‰é™çš„ k ä¸ªè¯ï¼ˆk ä¸€èˆ¬ä¸è¶…è¿‡ 3ï¼Œå¦‚æœåªä¾èµ–äºå‰é¢çš„ä¸€ä¸ªè¯ï¼Œå°±æ˜¯2å…ƒè¯­è¨€æ¨¡å‹ï¼ˆ2-gramï¼‰ï¼ŒåŒç†æœ‰ 3-gram ã€ 4-gram ç­‰ï¼‰ï¼Œè¿™ä¸ªå°±æ˜¯æ‰€è°“çš„â€œæœ‰é™åœ°å¹³çº¿â€å‡è®¾ã€‚è™½ç„¶è¿™ä¸ªå‡è®¾å¾ˆå‚»å¾ˆå¤©çœŸï¼Œä½†ç»“æœå´è¡¨æ˜å®ƒçš„ç»“æœå¾€å¾€æ˜¯å¾ˆå¥½å¾ˆå¼ºå¤§çš„ï¼Œåé¢è¦æåˆ°çš„æœ´ç´ è´å¶æ–¯æ–¹æ³•ä½¿ç”¨çš„å‡è®¾è·Ÿè¿™ä¸ªç²¾ç¥ä¸Šæ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œæˆ‘ä»¬ä¼šè§£é‡Šä¸ºä»€ä¹ˆåƒè¿™æ ·ä¸€ä¸ªå¤©çœŸçš„å‡è®¾èƒ½å¤Ÿå¾—åˆ°å¼ºå¤§çš„ç»“æœã€‚ç›®å‰æˆ‘ä»¬åªè¦çŸ¥é“ï¼Œæœ‰äº†è¿™ä¸ªå‡è®¾ï¼Œåˆšæ‰é‚£ä¸ªä¹˜ç§¯å°±å¯ä»¥æ”¹å†™æˆï¼š P(W1) P(W2|W1) P(W3|W2) * P(W4|W3) .. ï¼ˆå‡è®¾æ¯ä¸ªè¯åªä¾èµ–äºå®ƒå‰é¢çš„ä¸€ä¸ªè¯ï¼‰ã€‚è€Œç»Ÿè®¡ P(W2|W1) å°±ä¸å†å—åˆ°æ•°æ®ç¨€ç–é—®é¢˜çš„å›°æ‰°äº†ã€‚å¯¹äºæˆ‘ä»¬ä¸Šé¢æåˆ°çš„ä¾‹å­â€œå—äº¬å¸‚é•¿æ±Ÿå¤§æ¡¥â€ï¼Œå¦‚æœæŒ‰ç…§è‡ªå·¦åˆ°å³çš„è´ªå©ªæ–¹æ³•åˆ†è¯çš„è¯ï¼Œç»“æœå°±æˆäº†â€œå—äº¬å¸‚é•¿/æ±Ÿå¤§æ¡¥â€ã€‚ä½†å¦‚æœæŒ‰ç…§è´å¶æ–¯åˆ†è¯çš„è¯ï¼ˆå‡è®¾ä½¿ç”¨ 3-gramï¼‰ï¼Œç”±äºâ€œå—äº¬å¸‚é•¿â€å’Œâ€œæ±Ÿå¤§æ¡¥â€åœ¨è¯­æ–™åº“ä¸­ä¸€èµ·å‡ºç°çš„é¢‘ç‡ä¸º 0 ï¼Œè¿™ä¸ªæ•´å¥çš„æ¦‚ç‡ä¾¿ä¼šè¢«åˆ¤å®šä¸º 0 ã€‚ ä»è€Œä½¿å¾—â€œå—äº¬å¸‚/é•¿æ±Ÿå¤§æ¡¥â€è¿™ä¸€åˆ†è¯æ–¹å¼èƒœå‡ºã€‚ ä¸€ç‚¹æ³¨è®°ï¼šæœ‰äººå¯èƒ½ä¼šç–‘æƒ‘ï¼Œéš¾é“æˆ‘ä»¬äººç±»ä¹Ÿæ˜¯åŸºäºè¿™äº›å¤©çœŸçš„å‡è®¾æ¥è¿›è¡Œæ¨ç†çš„ï¼Ÿä¸æ˜¯çš„ã€‚äº‹å®ä¸Šï¼Œç»Ÿè®¡æœºå™¨å­¦ä¹ æ–¹æ³•æ‰€ç»Ÿè®¡çš„ä¸œè¥¿å¾€å¾€å¤„äºç›¸å½“è¡¨å±‚ï¼ˆshallowï¼‰çš„å±‚é¢ï¼Œåœ¨è¿™ä¸ªå±‚é¢æœºå™¨å­¦ä¹ åªèƒ½çœ‹åˆ°ä¸€äº›éå¸¸è¡¨é¢çš„ç°è±¡ï¼Œæœ‰ä¸€ç‚¹ç§‘å­¦ç ”ç©¶çš„ç†å¿µçš„äººéƒ½çŸ¥é“ï¼šè¶Šæ˜¯å¾€è¡¨å±‚å»ï¼Œä¸–ç•Œå°±è¶Šæ˜¯ç¹å¤å¤šå˜ã€‚ä»æœºå™¨å­¦ä¹ çš„è§’åº¦æ¥è¯´ï¼Œç‰¹å¾ï¼ˆfeatureï¼‰å°±è¶Šå¤šï¼Œæˆç™¾ä¸Šåƒç»´åº¦éƒ½æ˜¯å¯èƒ½çš„ã€‚ç‰¹å¾ä¸€å¤šï¼Œå¥½äº†ï¼Œé«˜ç»´è¯…å’’å°±äº§ç”Ÿäº†ï¼Œæ•°æ®å°±ç¨€ç–å¾—è¦å‘½ï¼Œä¸å¤Ÿç”¨äº†ã€‚è€Œæˆ‘ä»¬äººç±»çš„è§‚å¯Ÿæ°´å¹³æ˜¾ç„¶æ¯”æœºå™¨å­¦ä¹ çš„è§‚å¯Ÿæ°´å¹³è¦æ›´æ·±å…¥ä¸€äº›ï¼Œä¸ºäº†é¿å…æ•°æ®ç¨€ç–æˆ‘ä»¬ä¸æ–­åœ°å‘æ˜å„ç§è£…ç½®ï¼ˆæœ€å…¸å‹å°±æ˜¯æ˜¾å¾®é•œï¼‰ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬ç›´æ¥æ·±å…¥åˆ°æ›´æ·±å±‚çš„äº‹ç‰©å±‚é¢å»è§‚å¯Ÿæ›´æœ¬è´¨çš„è”ç³»ï¼Œè€Œä¸æ˜¯åœ¨æµ…å±‚å¯¹è¡¨é¢ç°è±¡ä½œç»Ÿè®¡å½’çº³ã€‚ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œé€šè¿‡å¯¹å¤§è§„æ¨¡è¯­æ–™åº“çš„ç»Ÿè®¡ï¼Œæœºå™¨å­¦ä¹ å¯èƒ½ä¼šå‘ç°è¿™æ ·ä¸€ä¸ªè§„å¾‹ï¼šæ‰€æœ‰çš„â€œä»–â€éƒ½æ˜¯ä¸ä¼šç©¿ bra çš„ï¼Œæ‰€æœ‰çš„â€œå¥¹â€åˆ™éƒ½æ˜¯ç©¿çš„ã€‚ç„¶è€Œï¼Œä½œä¸ºä¸€ä¸ªç”·äººï¼Œå´å®Œå…¨æ— éœ€è¿›è¡Œä»»ä½•ç»Ÿè®¡å­¦ä¹ ï¼Œå› ä¸ºæ·±å±‚çš„è§„å¾‹å°±å†³å®šäº†æˆ‘ä»¬æ ¹æœ¬ä¸ä¼šå»ç©¿ bra ã€‚è‡³äºæœºå™¨å­¦ä¹ èƒ½ä¸èƒ½å®Œæˆåè€…ï¼ˆåƒäººç±»é‚£æ ·çš„ï¼‰è¿™ä¸ªæ¨ç†ï¼Œåˆ™æ˜¯äººå·¥æ™ºèƒ½é¢†åŸŸçš„ç»å…¸é—®é¢˜ã€‚è‡³å°‘åœ¨é‚£ä¹‹å‰ï¼Œå£°ç§°ç»Ÿè®¡å­¦ä¹ æ–¹æ³•èƒ½å¤Ÿç»ˆç»“ç§‘å­¦ç ”ç©¶ï¼ˆåŸæ–‡ï¼‰çš„è¯´æ³•æ˜¯çº¯ç²¹å¤–è¡Œäººè¯´çš„è¯ã€‚ 4.2 ç»Ÿè®¡æœºå™¨ç¿»è¯‘ç»Ÿè®¡æœºå™¨ç¿»è¯‘å› ä¸ºå…¶ç®€å•ï¼Œè‡ªåŠ¨ï¼ˆæ— éœ€æ‰‹åŠ¨æ·»åŠ è§„åˆ™ï¼‰ï¼Œè¿…é€Ÿæˆä¸ºäº†æœºå™¨ç¿»è¯‘çš„äº‹å®æ ‡å‡†ã€‚è€Œç»Ÿè®¡æœºå™¨ç¿»è¯‘çš„æ ¸å¿ƒç®—æ³•ä¹Ÿæ˜¯ä½¿ç”¨çš„è´å¶æ–¯æ–¹æ³•ã€‚ é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿç»Ÿè®¡æœºå™¨ç¿»è¯‘çš„é—®é¢˜å¯ä»¥æè¿°ä¸ºï¼šç»™å®šä¸€ä¸ªå¥å­ e ï¼Œå®ƒçš„å¯èƒ½çš„å¤–æ–‡ç¿»è¯‘ f ä¸­å“ªä¸ªæ˜¯æœ€é è°±çš„ã€‚å³æˆ‘ä»¬éœ€è¦è®¡ç®—ï¼šP(f|e) ã€‚ä¸€æ—¦å‡ºç°æ¡ä»¶æ¦‚ç‡è´å¶æ–¯æ€»æ˜¯æŒºèº«è€Œå‡ºï¼š 1P(f|e) âˆ P(f) * P(e|f) è¿™ä¸ªå¼å­çš„å³ç«¯å¾ˆå®¹æ˜“è§£é‡Šï¼šé‚£äº›å…ˆéªŒæ¦‚ç‡è¾ƒé«˜ï¼Œå¹¶ä¸”æ›´å¯èƒ½ç”Ÿæˆå¥å­ e çš„å¤–æ–‡å¥å­ f å°†ä¼šèƒœå‡ºã€‚æˆ‘ä»¬åªéœ€ç®€å•ç»Ÿè®¡ï¼ˆç»“åˆä¸Šé¢æåˆ°çš„ N-Gram è¯­è¨€æ¨¡å‹ï¼‰å°±å¯ä»¥ç»Ÿè®¡ä»»æ„ä¸€ä¸ªå¤–æ–‡å¥å­ f çš„å‡ºç°æ¦‚ç‡ã€‚ç„¶è€Œ P(e|f) å´ä¸æ˜¯é‚£ä¹ˆå¥½æ±‚çš„ï¼Œç»™å®šä¸€ä¸ªå€™é€‰çš„å¤–æ–‡å±€å­ f ï¼Œå®ƒç”Ÿæˆï¼ˆæˆ–å¯¹åº”ï¼‰å¥å­ e çš„æ¦‚ç‡æ˜¯å¤šå¤§å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦å®šä¹‰ä»€ä¹ˆå« â€œå¯¹åº”â€ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°ä¸€ä¸ªåˆ†è¯å¯¹é½çš„å¹³è¡Œè¯­æ–™åº“ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å‚è€ƒ ã€ŠFoundations of Statistical Natural Language Processingã€‹ç¬¬ 13 ç« ï¼Œè¿™é‡Œæ‘˜é€‰å…¶ä¸­çš„ä¸€ä¸ªä¾‹å­ï¼šå‡è®¾ e ä¸ºï¼šJohn loves Mary ã€‚æˆ‘ä»¬éœ€è¦è€ƒå¯Ÿçš„é¦–é€‰ f æ˜¯ï¼šJean aime Marie ï¼ˆæ³•æ–‡ï¼‰ã€‚æˆ‘ä»¬éœ€è¦æ±‚å‡º P(e|f) æ˜¯å¤šå¤§ï¼Œä¸ºæ­¤æˆ‘ä»¬è€ƒè™‘ e å’Œ f æœ‰å¤šå°‘ç§å¯¹é½çš„å¯èƒ½æ€§ï¼Œå¦‚ï¼š John (Jean) loves (aime) Marie (Mary) å°±æ˜¯å…¶ä¸­çš„ä¸€ç§ï¼ˆæœ€é è°±çš„ï¼‰å¯¹é½ï¼Œä¸ºä»€ä¹ˆè¦å¯¹é½ï¼Œæ˜¯å› ä¸ºä¸€æ—¦å¯¹é½äº†ä¹‹åï¼Œå°±å¯ä»¥å®¹æ˜“åœ°è®¡ç®—åœ¨è¿™ä¸ªå¯¹é½ä¹‹ä¸‹çš„ P(e|f) æ˜¯å¤šå¤§ï¼Œåªéœ€è®¡ç®—ï¼š 1P(John|Jean) * P(loves|aime) * P(Marie|Mary) å³å¯ã€‚ ç„¶åæˆ‘ä»¬éå†æ‰€æœ‰çš„å¯¹é½æ–¹å¼ï¼Œå¹¶å°†æ¯ç§å¯¹é½æ–¹å¼ä¹‹ä¸‹çš„ç¿»è¯‘æ¦‚ç‡ âˆ‘ æ±‚å’Œã€‚ä¾¿å¯ä»¥è·å¾—æ•´ä¸ªçš„ P(e|f) æ˜¯å¤šå¤§ã€‚ ä¸€ç‚¹æ³¨è®°ï¼š è¿˜æ˜¯é‚£ä¸ªé—®é¢˜ï¼šéš¾é“æˆ‘ä»¬äººç±»çœŸçš„æ˜¯ç”¨è¿™ç§æ–¹å¼è¿›è¡Œç¿»è¯‘çš„ï¼Ÿhighly unlikely ã€‚è¿™ç§è®¡ç®—å¤æ‚æ€§éå¸¸é«˜çš„ä¸œè¥¿è¿ä¸‰ä½æ•°ä¹˜æ³•éƒ½æä¸å®šçš„æˆ‘ä»¬æ‰ä¸ä¼šç¬¨åˆ°å»ä½¿ç”¨å‘¢ã€‚æ ¹æ®è®¤çŸ¥ç¥ç»ç§‘å­¦çš„è®¤è¯†ï¼Œå¾ˆå¯èƒ½æˆ‘ä»¬æ˜¯å…ˆä»å¥å­åˆ°è¯­ä¹‰ï¼ˆä¸€ä¸ªé€å±‚å¾€ä¸Šï¼ˆbottom-upï¼‰æŠ½è±¡çš„ folding è¿‡ç¨‹ï¼‰ï¼Œç„¶åä»è¯­ä¹‰æ ¹æ®å¦ä¸€é—¨è¯­è¨€çš„è¯­æ³•å±•å¼€ä¸ºå¦ä¸€é—¨è¯­è¨€ï¼ˆä¸€ä¸ªé€å±‚å¾€ä¸‹ï¼ˆtop-downï¼‰çš„å…·ä½“åŒ– unfolding è¿‡ç¨‹ï¼‰ã€‚å¦‚ä½•å¯è®¡ç®—åœ°å®ç°è¿™ä¸ªè¿‡ç¨‹ï¼Œç›®å‰ä»ç„¶æ˜¯ä¸ªéš¾é¢˜ã€‚ï¼ˆæˆ‘ä»¬çœ‹åˆ°å¾ˆå¤šåœ°æ–¹éƒ½æœ‰ bottom-up/top-down è¿™æ ·ä¸€ä¸ªå¯¹ç§°çš„è¿‡ç¨‹ï¼Œå®é™…ä¸Šæœ‰äººçŒœæµ‹è¿™æ­£æ˜¯ç”Ÿç‰©ç¥ç»ç½‘ç»œåŸåˆ™ä¸Šçš„è¿ä½œæ–¹å¼ï¼Œå¯¹è§†è§‰ç¥ç»ç³»ç»Ÿçš„ç ”ç©¶å°¤å…¶è¯æ˜äº†è¿™ä¸€ç‚¹ï¼ŒHawkins åœ¨ ã€ŠOn Intelligenceã€‹ é‡Œé¢æå‡ºäº†ä¸€ç§ HTM ï¼ˆHierarchical Temporal Memoryï¼‰æ¨¡å‹æ­£æ˜¯ä½¿ç”¨äº†è¿™ä¸ªåŸåˆ™ã€‚ï¼‰ 4.3 è´å¶æ–¯å›¾åƒè¯†åˆ«(Analysis by Synthesis)è´å¶æ–¯æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸ general çš„æ¨ç†æ¡†æ¶ã€‚å…¶æ ¸å¿ƒç†å¿µå¯ä»¥æè¿°æˆï¼šAnalysis by Synthesis ï¼ˆé€šè¿‡åˆæˆæ¥åˆ†æï¼‰ã€‚06 å¹´çš„è®¤çŸ¥ç§‘å­¦æ–°è¿›å±•ä¸Šæœ‰ä¸€ç¯‡ paper å°±æ˜¯è®²ç”¨è´å¶æ–¯æ¨ç†æ¥è§£é‡Šè§†è§‰è¯†åˆ«çš„ï¼Œä¸€å›¾èƒœåƒè¨€ï¼Œä¸‹å›¾å°±æ˜¯æ‘˜è‡ªè¿™ç¯‡ paper ï¼š é¦–å…ˆæ˜¯è§†è§‰ç³»ç»Ÿæå–å›¾å½¢çš„è¾¹è§’ç‰¹å¾ï¼Œç„¶åä½¿ç”¨è¿™äº›ç‰¹å¾è‡ªåº•å‘ä¸Šåœ°æ¿€æ´»é«˜å±‚çš„æŠ½è±¡æ¦‚å¿µï¼ˆæ¯”å¦‚æ˜¯ E è¿˜æ˜¯ F è¿˜æ˜¯ç­‰å·ï¼‰ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªè‡ªé¡¶å‘ä¸‹çš„éªŒè¯æ¥æ¯”è¾ƒåˆ°åº•å“ªä¸ªæ¦‚å¿µæœ€ä½³åœ°è§£é‡Šäº†è§‚å¯Ÿåˆ°çš„å›¾åƒã€‚ 4.4 EM ç®—æ³•ä¸åŸºäºæ¨¡å‹çš„èšç±»èšç±»ï¼ˆCluster analysisï¼‰æ˜¯ä¸€ç§æ— ç›‘ç£çš„æœºå™¨å­¦ä¹ é—®é¢˜ï¼Œé—®é¢˜æè¿°ï¼šç»™ä½ ä¸€å †æ•°æ®ç‚¹ï¼Œè®©ä½ å°†å®ƒä»¬æœ€é è°±åœ°åˆ†æˆä¸€å †ä¸€å †çš„ã€‚èšç±»ç®—æ³•å¾ˆå¤šï¼Œä¸åŒçš„ç®—æ³•é€‚åº”äºä¸åŒçš„é—®é¢˜ï¼Œè¿™é‡Œä»…ä»‹ç»ä¸€ä¸ªåŸºäºæ¨¡å‹çš„èšç±»ï¼Œè¯¥èšç±»ç®—æ³•å¯¹æ•°æ®ç‚¹çš„å‡è®¾æ˜¯ï¼Œè¿™äº›æ•°æ®ç‚¹åˆ†åˆ«æ˜¯å›´ç»• K ä¸ªæ ¸å¿ƒçš„ K ä¸ªæ­£æ€åˆ†å¸ƒæºæ‰€éšæœºç”Ÿæˆçš„ï¼Œä½¿ç”¨ Han JiaWei çš„ã€ŠData Mingï¼š Concepts and Techniquesã€‹ä¸­çš„å›¾ï¼š å›¾ä¸­æœ‰ä¸¤ä¸ªæ­£æ€åˆ†å¸ƒæ ¸å¿ƒï¼Œç”Ÿæˆäº†å¤§è‡´ä¸¤å †ç‚¹ã€‚æˆ‘ä»¬çš„èšç±»ç®—æ³•å°±æ˜¯éœ€è¦æ ¹æ®ç»™å‡ºæ¥çš„é‚£äº›ç‚¹ï¼Œç®—å‡ºè¿™ä¸¤ä¸ªæ­£æ€åˆ†å¸ƒçš„æ ¸å¿ƒåœ¨ä»€ä¹ˆä½ç½®ï¼Œä»¥åŠåˆ†å¸ƒçš„å‚æ•°æ˜¯å¤šå°‘ã€‚è¿™å¾ˆæ˜æ˜¾åˆæ˜¯ä¸€ä¸ªè´å¶æ–¯é—®é¢˜ï¼Œä½†è¿™æ¬¡ä¸åŒçš„æ˜¯ï¼Œç­”æ¡ˆæ˜¯è¿ç»­çš„ä¸”æœ‰æ— ç©·å¤šç§å¯èƒ½æ€§ï¼Œæ›´ç³Ÿçš„æ˜¯ï¼Œåªæœ‰å½“æˆ‘ä»¬çŸ¥é“äº†å“ªäº›ç‚¹å±äºåŒä¸€ä¸ªæ­£æ€åˆ†å¸ƒåœˆçš„æ—¶å€™æ‰èƒ½å¤Ÿå¯¹è¿™ä¸ªåˆ†å¸ƒçš„å‚æ•°ä½œå‡ºé è°±çš„é¢„æµ‹ï¼Œç°åœ¨ä¸¤å †ç‚¹æ··åœ¨ä¸€å—æˆ‘ä»¬åˆä¸çŸ¥é“å“ªäº›ç‚¹å±äºç¬¬ä¸€ä¸ªæ­£æ€åˆ†å¸ƒï¼Œå“ªäº›å±äºç¬¬äºŒä¸ªã€‚åè¿‡æ¥ï¼Œåªæœ‰å½“æˆ‘ä»¬å¯¹åˆ†å¸ƒçš„å‚æ•°ä½œå‡ºäº†é è°±çš„é¢„æµ‹æ—¶å€™ï¼Œæ‰èƒ½çŸ¥é“åˆ°åº•å“ªäº›ç‚¹å±äºç¬¬ä¸€ä¸ªåˆ†å¸ƒï¼Œé‚£äº›ç‚¹å±äºç¬¬äºŒä¸ªåˆ†å¸ƒã€‚è¿™å°±æˆäº†ä¸€ä¸ªå…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹çš„é—®é¢˜äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªå¾ªç¯ä¾èµ–ï¼Œæ€»æœ‰ä¸€æ–¹è¦å…ˆæ‰“ç ´åƒµå±€ï¼Œè¯´ï¼Œä¸ç®¡äº†ï¼Œæˆ‘å…ˆéšä¾¿æ•´ä¸€ä¸ªå€¼å‡ºæ¥ï¼Œçœ‹ä½ æ€ä¹ˆå˜ï¼Œç„¶åæˆ‘å†æ ¹æ®ä½ çš„å˜åŒ–è°ƒæ•´æˆ‘çš„å˜åŒ–ï¼Œç„¶åå¦‚æ­¤è¿­ä»£ç€ä¸æ–­äº’ç›¸æ¨å¯¼ï¼Œæœ€ç»ˆæ”¶æ•›åˆ°ä¸€ä¸ªè§£ã€‚è¿™å°±æ˜¯ EM ç®—æ³•ã€‚ EM çš„æ„æ€æ˜¯â€œExpectation-Maximazationâ€ï¼Œåœ¨è¿™ä¸ªèšç±»é—®é¢˜é‡Œé¢ï¼Œæˆ‘ä»¬æ˜¯å…ˆéšä¾¿çŒœä¸€ä¸‹è¿™ä¸¤ä¸ªæ­£æ€åˆ†å¸ƒçš„å‚æ•°ï¼šå¦‚æ ¸å¿ƒåœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œæ–¹å·®æ˜¯å¤šå°‘ã€‚ç„¶åè®¡ç®—å‡ºæ¯ä¸ªæ•°æ®ç‚¹æ›´å¯èƒ½å±äºç¬¬ä¸€ä¸ªè¿˜æ˜¯ç¬¬äºŒä¸ªæ­£æ€åˆ†å¸ƒåœˆï¼Œè¿™ä¸ªæ˜¯å±äº Expectation ä¸€æ­¥ã€‚æœ‰äº†æ¯ä¸ªæ•°æ®ç‚¹çš„å½’å±ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å±äºç¬¬ä¸€ä¸ªåˆ†å¸ƒçš„æ•°æ®ç‚¹æ¥é‡æ–°è¯„ä¼°ç¬¬ä¸€ä¸ªåˆ†å¸ƒçš„å‚æ•°ï¼ˆä»è›‹å†å›åˆ°é¸¡ï¼‰ï¼Œè¿™ä¸ªæ˜¯ Maximazation ã€‚å¦‚æ­¤å¾€å¤ï¼Œç›´åˆ°å‚æ•°åŸºæœ¬ä¸å†å‘ç”Ÿå˜åŒ–ä¸ºæ­¢ã€‚è¿™ä¸ªè¿­ä»£æ”¶æ•›è¿‡ç¨‹ä¸­çš„è´å¶æ–¯æ–¹æ³•åœ¨ç¬¬äºŒæ­¥ï¼Œæ ¹æ®æ•°æ®ç‚¹æ±‚åˆ†å¸ƒçš„å‚æ•°ä¸Šé¢ã€‚ 4.5 æœ€å¤§ä¼¼ç„¶ä¸æœ€å°äºŒä¹˜ å­¦è¿‡çº¿æ€§ä»£æ•°çš„å¤§æ¦‚éƒ½çŸ¥é“ç»å…¸çš„æœ€å°äºŒä¹˜æ–¹æ³•æ¥åšçº¿æ€§å›å½’ã€‚é—®é¢˜æè¿°æ˜¯ï¼šç»™å®šå¹³é¢ä¸Š N ä¸ªç‚¹ï¼Œï¼ˆè¿™é‡Œä¸å¦¨å‡è®¾æˆ‘ä»¬æƒ³ç”¨ä¸€æ¡ç›´çº¿æ¥æ‹Ÿåˆè¿™äº›ç‚¹â€”â€”å›å½’å¯ä»¥çœ‹ä½œæ˜¯æ‹Ÿåˆçš„ç‰¹ä¾‹ï¼Œå³å…è®¸è¯¯å·®çš„æ‹Ÿåˆï¼‰ï¼Œæ‰¾å‡ºä¸€æ¡æœ€ä½³æè¿°äº†è¿™äº›ç‚¹çš„ç›´çº¿ã€‚ ä¸€ä¸ªæ¥è¸µè€Œæ¥çš„é—®é¢˜å°±æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•å®šä¹‰æœ€ä½³ï¼Ÿæˆ‘ä»¬è®¾æ¯ä¸ªç‚¹çš„åæ ‡ä¸º (Xi, Yi) ã€‚å¦‚æœç›´çº¿ä¸º y = f(x) ã€‚é‚£ä¹ˆ (Xi, Yi) è·Ÿç›´çº¿å¯¹è¿™ä¸ªç‚¹çš„â€œé¢„æµ‹â€ï¼š(Xi, f(Xi)) å°±ç›¸å·®äº†ä¸€ä¸ª Î”Yi = |Yi â€“ f(Xi)| ã€‚æœ€å°äºŒä¹˜å°±æ˜¯è¯´å¯»æ‰¾ç›´çº¿ä½¿å¾— (Î”Y1)^2 + (Î”Y2)^2 + .. ï¼ˆå³è¯¯å·®çš„å¹³æ–¹å’Œï¼‰æœ€å°ï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯è¯¯å·®çš„å¹³æ–¹å’Œè€Œä¸æ˜¯è¯¯å·®çš„ç»å¯¹å€¼å’Œï¼Œç»Ÿè®¡å­¦ä¸Šä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¥½çš„è§£é‡Šã€‚ç„¶è€Œè´å¶æ–¯æ–¹æ³•å´èƒ½å¯¹æ­¤æä¾›ä¸€ä¸ªå®Œç¾çš„è§£é‡Šã€‚ æˆ‘ä»¬å‡è®¾ç›´çº¿å¯¹äºåæ ‡ Xi ç»™å‡ºçš„é¢„æµ‹ f(Xi) æ˜¯æœ€é è°±çš„é¢„æµ‹ï¼Œæ‰€æœ‰çºµåæ ‡åç¦» f(Xi) çš„é‚£äº›æ•°æ®ç‚¹éƒ½å«æœ‰å™ªéŸ³ï¼Œæ˜¯å™ªéŸ³ä½¿å¾—å®ƒä»¬åç¦»äº†å®Œç¾çš„ä¸€æ¡ç›´çº¿ï¼Œä¸€ä¸ªåˆç†çš„å‡è®¾å°±æ˜¯åç¦»è·¯çº¿è¶Šè¿œçš„æ¦‚ç‡è¶Šå°ï¼Œå…·ä½“å°å¤šå°‘ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæ­£æ€åˆ†å¸ƒæ›²çº¿æ¥æ¨¡æ‹Ÿï¼Œè¿™ä¸ªåˆ†å¸ƒæ›²çº¿ä»¥ç›´çº¿å¯¹ Xi ç»™å‡ºçš„é¢„æµ‹ f(Xi) ä¸ºä¸­å¿ƒï¼Œå®é™…çºµåæ ‡ä¸º Yi çš„ç‚¹ (Xi, Yi) å‘ç”Ÿçš„æ¦‚ç‡å°±æ­£æ¯”äº EXP[-(Î”Yi)^2]ã€‚ï¼ˆEXP(..) ä»£è¡¨ä»¥å¸¸æ•° e ä¸ºåº•çš„å¤šå°‘æ¬¡æ–¹ï¼‰ã€‚ ç°åœ¨æˆ‘ä»¬å›åˆ°é—®é¢˜çš„è´å¶æ–¯æ–¹é¢ï¼Œæˆ‘ä»¬è¦æƒ³æœ€å¤§åŒ–çš„åéªŒæ¦‚ç‡æ˜¯ï¼š 1P(h|D) âˆ P(h) * P(D|h) åˆè§è´å¶æ–¯ï¼è¿™é‡Œ h å°±æ˜¯æŒ‡ä¸€æ¡ç‰¹å®šçš„ç›´çº¿ï¼ŒD å°±æ˜¯æŒ‡è¿™ N ä¸ªæ•°æ®ç‚¹ã€‚æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€æ¡ç›´çº¿ h ä½¿å¾— P(h) P(D|h) æœ€å¤§ã€‚å¾ˆæ˜¾ç„¶ï¼ŒP(h) è¿™ä¸ªå…ˆéªŒæ¦‚ç‡æ˜¯å‡åŒ€çš„ï¼Œå› ä¸ºå“ªæ¡ç›´çº¿ä¹Ÿä¸æ¯”å¦ä¸€æ¡æ›´ä¼˜è¶Šã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦çœ‹ P(D|h) è¿™ä¸€é¡¹ï¼Œè¿™ä¸€é¡¹æ˜¯æŒ‡è¿™æ¡ç›´çº¿ç”Ÿæˆè¿™äº›æ•°æ®ç‚¹çš„æ¦‚ç‡ï¼Œåˆšæ‰è¯´è¿‡äº†ï¼Œç”Ÿæˆæ•°æ®ç‚¹ (Xi, Yi) çš„æ¦‚ç‡ä¸º EXP[-(Î”Yi)^2] ä¹˜ä»¥ä¸€ä¸ªå¸¸æ•°ã€‚è€Œ P(D|h) = P(d1|h) P(d2|h) .. å³å‡è®¾å„ä¸ªæ•°æ®ç‚¹æ˜¯ç‹¬ç«‹ç”Ÿæˆçš„ï¼Œæ‰€ä»¥å¯ä»¥æŠŠæ¯ä¸ªæ¦‚ç‡ä¹˜èµ·æ¥ã€‚äºæ˜¯ç”Ÿæˆ N ä¸ªæ•°æ®ç‚¹çš„æ¦‚ç‡ä¸º EXP[-(Î”Y1)^2] EXP[-(Î”Y2)^2] EXP[-(Î”Y3)^2] .. = EXP{-[(Î”Y1)^2 + (Î”Y2)^2 + (Î”Y3)^2 + ..]} æœ€å¤§åŒ–è¿™ä¸ªæ¦‚ç‡å°±æ˜¯è¦æœ€å°åŒ– (Î”Y1)^2 + (Î”Y2)^2 + (Î”Y3)^2 + .. ã€‚ ç†Ÿæ‚‰è¿™ä¸ªå¼å­å—ï¼Ÿ 5. æœ´ç´ è´å¶æ–¯æ–¹æ³•æœ´ç´ è´å¶æ–¯æ–¹æ³•æ˜¯ä¸€ä¸ªå¾ˆç‰¹åˆ«çš„æ–¹æ³•ï¼Œæ‰€ä»¥å€¼å¾—ä»‹ç»ä¸€ä¸‹ã€‚æˆ‘ä»¬ç”¨æœ´ç´ è´å¶æ–¯åœ¨åƒåœ¾é‚®ä»¶è¿‡æ»¤ä¸­çš„åº”ç”¨æ¥ä¸¾ä¾‹è¯´æ˜ã€‚ 5.1 è´å¶æ–¯åƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿé—®é¢˜æ˜¯ï¼Œç»™å®šä¸€å°é‚®ä»¶ï¼Œåˆ¤å®šå®ƒæ˜¯å¦å±äºåƒåœ¾é‚®ä»¶ã€‚æŒ‰ç…§å…ˆä¾‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ D æ¥è¡¨ç¤ºè¿™å°é‚®ä»¶ï¼Œæ³¨æ„ D ç”± N ä¸ªå•è¯ç»„æˆã€‚æˆ‘ä»¬ç”¨ h+ æ¥è¡¨ç¤ºåƒåœ¾é‚®ä»¶ï¼Œh- è¡¨ç¤ºæ­£å¸¸é‚®ä»¶ã€‚é—®é¢˜å¯ä»¥å½¢å¼åŒ–åœ°æè¿°ä¸ºæ±‚ï¼š 123P(h+|D) = P(h+) * P(D|h+) / P(D)P(h-|D) = P(h-) * P(D|h-) / P(D) å…¶ä¸­ P(h+) å’Œ P(h-) è¿™ä¸¤ä¸ªå…ˆéªŒæ¦‚ç‡éƒ½æ˜¯å¾ˆå®¹æ˜“æ±‚å‡ºæ¥çš„ï¼Œåªéœ€è¦è®¡ç®—ä¸€ä¸ªé‚®ä»¶åº“é‡Œé¢åƒåœ¾é‚®ä»¶å’Œæ­£å¸¸é‚®ä»¶çš„æ¯”ä¾‹å°±è¡Œäº†ã€‚ç„¶è€Œ P(D|h+) å´ä¸å®¹æ˜“æ±‚ï¼Œå› ä¸º D é‡Œé¢å«æœ‰ N ä¸ªå•è¯ d1, d2, d3, .. ï¼Œæ‰€ä»¥P(D|h+) = P(d1,d2,..,dn|h+) ã€‚æˆ‘ä»¬åˆä¸€æ¬¡é‡åˆ°äº†æ•°æ®ç¨€ç–æ€§ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼ŸP(d1,d2,..,dn|h+) å°±æ˜¯è¯´åœ¨åƒåœ¾é‚®ä»¶å½“ä¸­å‡ºç°è·Ÿæˆ‘ä»¬ç›®å‰è¿™å°é‚®ä»¶ä¸€æ¨¡ä¸€æ ·çš„ä¸€å°é‚®ä»¶çš„æ¦‚ç‡æ˜¯å¤šå¤§ï¼å¼€ç©ç¬‘ï¼Œæ¯å°é‚®ä»¶éƒ½æ˜¯ä¸åŒçš„ï¼Œä¸–ç•Œä¸Šæœ‰æ— ç©·å¤šå°é‚®ä»¶ã€‚ç§ï¼Œè¿™å°±æ˜¯æ•°æ®ç¨€ç–æ€§ï¼Œå› ä¸ºå¯ä»¥è‚¯å®šåœ°è¯´ï¼Œä½ æ”¶é›†çš„è®­ç»ƒæ•°æ®åº“ä¸ç®¡é‡Œé¢å«äº†å¤šå°‘å°é‚®ä»¶ï¼Œä¹Ÿä¸å¯èƒ½æ‰¾å‡ºä¸€å°è·Ÿç›®å‰è¿™å°ä¸€æ¨¡ä¸€æ ·çš„ã€‚ç»“æœå‘¢ï¼Ÿæˆ‘ä»¬åˆè¯¥å¦‚ä½•æ¥è®¡ç®— P(d1,d2,..,dn|h+) å‘¢ï¼Ÿ æˆ‘ä»¬å°† P(d1,d2,..,dn|h+) æ‰©å±•ä¸ºï¼š P(d1|h+) P(d2|d1, h+) P(d3|d2,d1, h+) .. ã€‚ç†Ÿæ‚‰è¿™ä¸ªå¼å­å—ï¼Ÿè¿™é‡Œæˆ‘ä»¬ä¼šä½¿ç”¨ä¸€ä¸ªæ›´æ¿€è¿›çš„å‡è®¾ï¼Œæˆ‘ä»¬å‡è®¾ di ä¸ di-1 æ˜¯å®Œå…¨æ¡ä»¶æ— å…³çš„ï¼Œäºæ˜¯å¼å­å°±ç®€åŒ–ä¸º P(d1|h+) P(d2|h+) P(d3|h+) .. ã€‚è¿™ä¸ªå°±æ˜¯æ‰€è°“çš„æ¡ä»¶ç‹¬ç«‹å‡è®¾ï¼Œä¹Ÿæ­£æ˜¯æœ´ç´ è´å¶æ–¯æ–¹æ³•çš„æœ´ç´ ä¹‹å¤„ã€‚è€Œè®¡ç®— P(d1|h+) P(d2|h+) P(d3|h+) * .. å°±å¤ªç®€å•äº†ï¼Œåªè¦ç»Ÿè®¡ di è¿™ä¸ªå•è¯åœ¨åƒåœ¾é‚®ä»¶ä¸­å‡ºç°çš„é¢‘ç‡å³å¯ã€‚å…³äºè´å¶æ–¯åƒåœ¾é‚®ä»¶è¿‡æ»¤æ›´å¤šçš„å†…å®¹å¯ä»¥å‚è€ƒè¿™ä¸ªæ¡ç›®ï¼Œæ³¨æ„å…¶ä¸­æåˆ°çš„å…¶ä»–èµ„æ–™ã€‚ ä¸€ç‚¹æ³¨è®°ï¼šè¿™é‡Œï¼Œä¸ºä»€ä¹ˆæœ‰è¿™ä¸ªæ•°æ®ç¨€ç–é—®é¢˜ï¼Œè¿˜æ˜¯å› ä¸ºç»Ÿè®¡å­¦ä¹ æ–¹æ³•å·¥ä½œåœ¨æµ…å±‚é¢ï¼Œä¸–ç•Œä¸Šçš„å•è¯å°±ç®—ä¸å†å˜å¤šä¹Ÿæ˜¯éå¸¸ä¹‹å¤šçš„ï¼Œå•è¯ä¹‹é—´ç»„æˆçš„å¥å­ä¹Ÿæ˜¯å˜åŒ–å¤šç«¯ï¼Œæ›´ä¸ç”¨è¯´ä¸€ç¯‡æ–‡ç« äº†ï¼Œæ–‡ç« æ•°ç›®åˆ™æ˜¯æ— ç©·çš„ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªå±‚é¢ä½œç»Ÿè®¡ï¼Œè‚¯å®šè¦è¢«æ•°æ®ç¨€ç–æ€§å›°æ‰°ã€‚æˆ‘ä»¬è¦æ³¨æ„ï¼Œè™½ç„¶å¥å­å’Œæ–‡ç« çš„æ•°ç›®æ˜¯æ— é™çš„ï¼Œç„¶è€Œå°±æ‹¿é‚®ä»¶æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬åªå…³å¿ƒé‚®ä»¶ä¸­å¥å­çš„è¯­ä¹‰ï¼ˆè¿›è€Œæ›´é«˜æŠ½è±¡å±‚é¢çš„â€œæ„å›¾â€ï¼ˆè¯­ä¹‰ï¼Œæ„å›¾å¦‚ä½•å¯è®¡ç®—åœ°å®šä¹‰å‡ºæ¥æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½é—®é¢˜ï¼‰ï¼Œåœ¨è¿™ä¸ªå±‚é¢ä¸Šå¯èƒ½æ€§ä¾¿å¤§å¤§ç¼©å‡äº†ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æŠ½è±¡å±‚é¢è¶Šé«˜ï¼Œå¯èƒ½æ€§è¶Šå°ã€‚å•è¯é›†åˆå’Œå¥å­çš„å¯¹åº”æ˜¯å¤šå¯¹ä¸€çš„ï¼Œå¥å­å’Œè¯­ä¹‰çš„å¯¹åº”åˆæ˜¯å¤šå¯¹ä¸€çš„ï¼Œè¯­ä¹‰å’Œæ„å›¾çš„å¯¹åº”è¿˜æ˜¯å¤šå¯¹ä¸€çš„ï¼Œè¿™æ˜¯ä¸ªå±‚çº§ä½“ç³»ã€‚ç¥ç»ç§‘å­¦çš„å‘ç°ä¹Ÿè¡¨æ˜å¤§è„‘çš„çš®å±‚å¤§è‡´æœ‰ä¸€ç§å±‚çº§ç»“æ„ï¼Œå¯¹åº”ç€è¶Šæ¥è¶ŠæŠ½è±¡çš„å„ä¸ªå±‚é¢ï¼Œè‡³äºå¦‚ä½•å…·ä½“å®ç°ä¸€ä¸ªå¯æ”¾åœ¨è®¡ç®—æœºå†…çš„å¤§è„‘çš®å±‚ï¼Œä»ç„¶æ˜¯ä¸€ä¸ªæœªè§£å†³é—®é¢˜ï¼Œä»¥ä¸Šåªæ˜¯ä¸€ä¸ªåŸåˆ™ï¼ˆprincipleï¼‰ä¸Šçš„è®¤è¯†ï¼Œåªæœ‰å½“ computational çš„ cortex æ¨¡å‹è¢«å»ºç«‹èµ·æ¥äº†ä¹‹åæ‰å¯èƒ½å°†å…¶æ”¾å…¥ç”µè„‘ã€‚ 5.2 ä¸ºä»€ä¹ˆæœ´ç´ è´å¶æ–¯æ–¹æ³•ä»¤äººè¯§å¼‚åœ°å¥½â€”â€”ä¸€ä¸ªç†è®ºè§£é‡Šæœ´ç´ è´å¶æ–¯æ–¹æ³•çš„æ¡ä»¶ç‹¬ç«‹å‡è®¾çœ‹ä¸Šå»å¾ˆå‚»å¾ˆå¤©çœŸï¼Œä¸ºä»€ä¹ˆç»“æœå´å¾ˆå¥½å¾ˆå¼ºå¤§å‘¢ï¼Ÿå°±æ‹¿ä¸€ä¸ªå¥å­æ¥è¯´ï¼Œæˆ‘ä»¬æ€ä¹ˆèƒ½é²è½åœ°å£°ç§°å…¶ä¸­ä»»æ„ä¸€ä¸ªå•è¯å‡ºç°çš„æ¦‚ç‡åªå—åˆ°å®ƒå‰é¢çš„ 3 ä¸ªæˆ– 4 ä¸ªå•è¯çš„å½±å“å‘¢ï¼Ÿåˆ«è¯´ 3 ä¸ªï¼Œæœ‰æ—¶å€™ä¸€ä¸ªå•è¯çš„æ¦‚ç‡å—åˆ°ä¸Šä¸€å¥è¯çš„å½±å“éƒ½æ˜¯ç»å¯¹å¯èƒ½çš„ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¸ªå‡è®¾åœ¨å®é™…ä¸­çš„è¡¨ç°å´ä¸æ¯”å†³ç­–æ ‘å·®å‘¢ï¼Ÿæœ‰äººå¯¹æ­¤æå‡ºäº†ä¸€ä¸ªç†è®ºè§£é‡Šï¼Œå¹¶ä¸”å»ºç«‹äº†ä»€ä¹ˆæ—¶å€™æœ´ç´ è´å¶æ–¯çš„æ•ˆæœèƒ½å¤Ÿç­‰ä»·äºéæœ´ç´ è´å¶æ–¯çš„å……è¦æ¡ä»¶ï¼Œè¿™ä¸ªè§£é‡Šçš„æ ¸å¿ƒå°±æ˜¯ï¼šæœ‰äº›ç‹¬ç«‹å‡è®¾åœ¨å„ä¸ªåˆ†ç±»ä¹‹é—´çš„åˆ†å¸ƒéƒ½æ˜¯å‡åŒ€çš„æ‰€ä»¥å¯¹äºä¼¼ç„¶çš„ç›¸å¯¹å¤§å°ä¸äº§ç”Ÿå½±å“ï¼›å³ä¾¿ä¸æ˜¯å¦‚æ­¤ï¼Œä¹Ÿæœ‰å¾ˆå¤§çš„å¯èƒ½æ€§å„ä¸ªç‹¬ç«‹å‡è®¾æ‰€äº§ç”Ÿçš„æ¶ˆæå½±å“æˆ–ç§¯æå½±å“äº’ç›¸æŠµæ¶ˆï¼Œæœ€ç»ˆå¯¼è‡´ç»“æœå—åˆ°çš„å½±å“ä¸å¤§ã€‚å…·ä½“çš„æ•°å­¦å…¬å¼è¯·å‚è€ƒè¿™ç¯‡ paperï¼ˆThe Optimality of Naive Bayesï¼‰ ã€‚ 6. å±‚çº§è´å¶æ–¯æ¨¡å‹ å±‚çº§è´å¶æ–¯æ¨¡å‹æ˜¯ç°ä»£è´å¶æ–¯æ–¹æ³•çš„æ ‡å¿—æ€§å»ºç­‘ä¹‹ä¸€ã€‚å‰é¢è®²çš„è´å¶æ–¯ï¼Œéƒ½æ˜¯åœ¨åŒä¸€ä¸ªäº‹ç‰©å±‚æ¬¡ä¸Šçš„å„ä¸ªå› ç´ ä¹‹é—´è¿›è¡Œç»Ÿè®¡æ¨ç†ï¼Œç„¶è€Œå±‚æ¬¡è´å¶æ–¯æ¨¡å‹åœ¨å“²å­¦ä¸Šæ›´æ·±å…¥äº†ä¸€å±‚ï¼Œå°†è¿™äº›å› ç´ èƒŒåçš„å› ç´ ï¼ˆåŸå› çš„åŸå› ï¼ŒåŸå› çš„åŸå› ï¼Œä»¥æ­¤ç±»æ¨ï¼‰å›Šæ‹¬è¿›æ¥ã€‚ä¸€ä¸ªæ•™ç§‘ä¹¦ä¾‹å­æ˜¯ï¼šå¦‚æœä½ æ‰‹å¤´æœ‰ N æšç¡¬å¸ï¼Œå®ƒä»¬æ˜¯åŒä¸€ä¸ªå·¥å‚é“¸å‡ºæ¥çš„ï¼Œä½ æŠŠæ¯ä¸€æšç¡¬å¸æ·å‡ºä¸€ä¸ªç»“æœï¼Œç„¶ååŸºäºè¿™ N ä¸ªç»“æœå¯¹è¿™ N ä¸ªç¡¬å¸çš„ Î¸ ï¼ˆå‡ºç°æ­£é¢çš„æ¯”ä¾‹ï¼‰è¿›è¡Œæ¨ç†ã€‚å¦‚æœæ ¹æ®æœ€å¤§ä¼¼ç„¶ï¼Œæ¯ä¸ªç¡¬å¸çš„ Î¸ ä¸æ˜¯ 1 å°±æ˜¯ 0 ï¼ˆè¿™ä¸ªå‰é¢æåˆ°è¿‡çš„ï¼‰ï¼Œç„¶è€Œæˆ‘ä»¬åˆçŸ¥é“æ¯ä¸ªç¡¬å¸çš„ p(Î¸) æ˜¯æœ‰ä¸€ä¸ªå…ˆéªŒæ¦‚ç‡çš„ï¼Œä¹Ÿè®¸æ˜¯ä¸€ä¸ª beta åˆ†å¸ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªç¡¬å¸çš„å®é™…æŠ•æ·ç»“æœ Xi æœä»ä»¥ Î¸ ä¸ºä¸­å¿ƒçš„æ­£æ€åˆ†å¸ƒï¼Œè€Œ Î¸ åˆæœä»å¦ä¸€ä¸ªä»¥ Î¨ ä¸ºä¸­å¿ƒçš„ beta åˆ†å¸ƒã€‚å±‚å±‚å› æœå…³ç³»å°±ä½“ç°å‡ºæ¥äº†ã€‚è¿›è€Œ Î¨ è¿˜å¯èƒ½ä¾èµ–äºå› æœé“¾ä¸Šæ›´ä¸Šå±‚çš„å› ç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚ 6.1 éšé©¬å¯å¤«æ¨¡å‹ï¼ˆHMMï¼‰ å´å†›åœ¨æ•°å­¦ä¹‹ç¾ç³»åˆ—é‡Œé¢ä»‹ç»çš„éšé©¬å¯å¤«æ¨¡å‹ï¼ˆHidden Markov modelï¼‰å°±æ˜¯ä¸€ä¸ªç®€å•çš„å±‚çº§è´å¶æ–¯æ¨¡å‹ï¼š é‚£ä¹ˆæ€ä¹ˆæ ¹æ®æ¥æ”¶åˆ°çš„ä¿¡æ¯æ¥æ¨æµ‹è¯´è¯è€…æƒ³è¡¨è¾¾çš„æ„æ€å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å«åšâ€œéšå«é©¬å°”å¯å¤«æ¨¡å‹â€ï¼ˆHidden Markov Modelï¼‰æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚ä»¥è¯­éŸ³è¯†åˆ«ä¸ºä¾‹ï¼Œå½“æˆ‘ä»¬è§‚æµ‹åˆ°è¯­éŸ³ä¿¡å· o1,o2,o3 æ—¶ï¼Œæˆ‘ä»¬è¦æ ¹æ®è¿™ç»„ä¿¡å·æ¨æµ‹å‡ºå‘é€çš„å¥å­ s1,s2,s3ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨æ‰€æœ‰å¯èƒ½çš„å¥å­ä¸­æ‰¾æœ€æœ‰å¯èƒ½æ€§çš„ä¸€ä¸ªã€‚ç”¨æ•°å­¦è¯­è¨€æ¥æè¿°ï¼Œå°±æ˜¯åœ¨å·²çŸ¥ o1,o2,o3,â€¦çš„æƒ…å†µä¸‹ï¼Œæ±‚ä½¿å¾—æ¡ä»¶æ¦‚ç‡ P (s1,s2,s3,â€¦|o1,o2,o3â€¦.) è¾¾åˆ°æœ€å¤§å€¼çš„é‚£ä¸ªå¥å­ s1,s2,s3,â€¦ å´å†›çš„æ–‡ç« ä¸­è¿™é‡Œçœæ‰æ²¡è¯´çš„æ˜¯ï¼Œs1, s2, s3, .. è¿™ä¸ªå¥å­çš„ç”Ÿæˆæ¦‚ç‡åŒæ—¶åˆå–å†³äºä¸€ç»„å‚æ•°ï¼Œè¿™ç»„å‚æ•°å†³å®šäº† s1, s2, s3, .. è¿™ä¸ªé©¬å¯å¤«é“¾çš„å…ˆéªŒç”Ÿæˆæ¦‚ç‡ã€‚å¦‚æœæˆ‘ä»¬å°†è¿™ç»„å‚æ•°è®°ä¸º Î» ï¼Œæˆ‘ä»¬å®é™…ä¸Šè¦æ±‚çš„æ˜¯ï¼šP(S|O, Î») ï¼ˆå…¶ä¸­ O è¡¨ç¤º o1,o2,o3,.. ï¼ŒSè¡¨ç¤º s1,s2,s3,..ï¼‰ å½“ç„¶ï¼Œä¸Šé¢çš„æ¦‚ç‡ä¸å®¹æ˜“ç›´æ¥æ±‚å‡ºï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥é—´æ¥åœ°è®¡ç®—å®ƒã€‚åˆ©ç”¨è´å¶æ–¯å…¬å¼å¹¶ä¸”çœæ‰ä¸€ä¸ªå¸¸æ•°é¡¹ï¼Œå¯ä»¥æŠŠä¸Šè¿°å…¬å¼ç­‰ä»·å˜æ¢æˆ P(o1,o2,o3,â€¦|s1,s2,s3â€¦.) * P(s1,s2,s3,â€¦) å…¶ä¸­ P(o1,o2,o3,â€¦|s1,s2,s3â€¦.) è¡¨ç¤ºæŸå¥è¯ s1,s2,s3â€¦è¢«è¯»æˆ o1,o2,o3,â€¦çš„å¯èƒ½æ€§, è€ŒP(s1,s2,s3,â€¦) è¡¨ç¤ºå­—ä¸² s1,s2,s3,â€¦æœ¬èº«èƒ½å¤Ÿæˆä¸ºä¸€ä¸ªåˆä¹æƒ…ç†çš„å¥å­çš„å¯èƒ½æ€§ï¼Œæ‰€ä»¥è¿™ä¸ªå…¬å¼çš„æ„ä¹‰æ˜¯ç”¨å‘é€ä¿¡å·ä¸ºs1,s2,s3â€¦è¿™ä¸ªæ•°åˆ—çš„å¯èƒ½æ€§ä¹˜ä»¥ s1,s2,s3.. æœ¬èº«å¯ä»¥ä¸€ä¸ªå¥å­çš„å¯èƒ½æ€§ï¼Œå¾—å‡ºæ¦‚ç‡ã€‚ è¿™é‡Œï¼Œs1,s2,s3â€¦æœ¬èº«å¯ä»¥ä¸€ä¸ªå¥å­çš„å¯èƒ½æ€§å…¶å®å°±å–å†³äºå‚æ•° Î» ï¼Œä¹Ÿå°±æ˜¯è¯­è¨€æ¨¡å‹ã€‚æ‰€ä»¥ç®€è€Œè¨€ä¹‹å°±æ˜¯å‘å‡ºçš„è¯­éŸ³ä¿¡å·å–å†³äºèƒŒåå®é™…æƒ³å‘å‡ºçš„å¥å­ï¼Œè€ŒèƒŒåå®é™…æƒ³å‘å‡ºçš„å¥å­æœ¬èº«çš„ç‹¬ç«‹å…ˆéªŒæ¦‚ç‡åˆå–å†³äºè¯­è¨€æ¨¡å‹ã€‚ 7. è´å¶æ–¯ç½‘ç»œå´å†›å·²ç»å¯¹è´å¶æ–¯ç½‘ç»œä½œäº†ç§‘æ™®ã€‚æ›´è¯¦ç»†çš„ç†è®ºå‚è€ƒæ‰€æœ‰æœºå™¨å­¦ä¹ çš„ä¹¦ä¸Šéƒ½æœ‰ã€‚ ã€å‚è€ƒèµ„æ–™ã€‘ä¸€å †æœºå™¨å­¦ä¹ ï¼Œä¸€å †æ¦‚ç‡ç»Ÿè®¡ï¼Œä¸€å † Google ï¼Œå’Œä¸€å † Wikipedia æ¡ç›®ï¼Œä¸€å † paper ã€‚ éƒ¨åˆ†ä¹¦ç±å‚è€ƒã€Šæœºå™¨å­¦ä¹ ä¸äººå·¥æ™ºèƒ½èµ„æºå¯¼å¼•ã€‹ã€‚ æœ¬æ–‡è½¬è½½è‡ª ã€Šæ•°å­¦ä¹‹ç¾ç•ªå¤–ç¯‡ï¼šå¹³å‡¡è€Œåˆç¥å¥‡çš„è´å¶æ–¯æ–¹æ³•ã€‹ åˆ˜æœªé¹mindhacks.cn","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Bayesian","slug":"Bayesian","permalink":"http://github.com/tags/Bayesian/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Androidã€‘RxJava å…¥é—¨è¯¦è§£","slug":"ã€Androidã€‘RxJava å…¥é—¨è¯¦è§£","date":"2016-12-19T11:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/12/19/ã€Androidã€‘RxJava å…¥é—¨è¯¦è§£/","link":"","permalink":"http://github.com/2016/12/19/ã€Androidã€‘RxJava å…¥é—¨è¯¦è§£/","excerpt":"æœ¬æ–‡è½¬è½½è‡ª ç»™ Android å¼€å‘è€…çš„ RxJava è¯¦è§£ â€”â€” by æ‰”ç‰©çº¿ å‰è¨€æˆ‘ä»å»å¹´å¼€å§‹ä½¿ç”¨ RxJava ï¼Œåˆ°ç°åœ¨ä¸€å¹´å¤šäº†ã€‚ä»Šå¹´åŠ å…¥äº† Flipboard åï¼Œçœ‹åˆ° Flipboard çš„ Android é¡¹ç›®ä¹Ÿåœ¨ä½¿ç”¨ RxJava ï¼Œå¹¶ä¸”ä½¿ç”¨çš„åœºæ™¯è¶Šæ¥è¶Šå¤š ã€‚è€Œæœ€è¿‘è¿™å‡ ä¸ªæœˆï¼Œæˆ‘ä¹Ÿå‘ç°å›½å†…è¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹æåŠ RxJava ã€‚æœ‰äººè¯´ã€RxJava çœŸæ˜¯å¤ªå¥½ç”¨äº†ã€ï¼Œæœ‰äººè¯´ã€RxJava çœŸæ˜¯å¤ªéš¾ç”¨äº†ã€ï¼Œå¦å¤–æ›´å¤šçš„äººè¡¨ç¤ºï¼šæˆ‘çœŸçš„ç™¾åº¦äº†ä¹Ÿè°·æ­Œäº†ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³é—®ï¼š RxJava åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ é‰´äº RxJava ç›®å‰è¿™ç§æ—¢ç«çˆ†åˆç¥ç§˜çš„ç°çŠ¶ï¼Œè€Œæˆ‘åˆåœ¨ä¸€å¹´çš„ä½¿ç”¨è¿‡ç¨‹ä¸­å¯¹ RxJava æœ‰äº†ä¸€äº›ç†è§£ï¼Œæˆ‘å†³å®šå†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥å¯¹ RxJava åšä¸€ä¸ªç›¸å¯¹è¯¦ç»†çš„ã€é’ˆå¯¹ Android å¼€å‘è€…çš„ä»‹ç»ã€‚ è¿™ç¯‡æ–‡ç« çš„ç›®çš„æœ‰ä¸¤ä¸ªï¼š ç»™å¯¹ RxJava æ„Ÿå…´è¶£çš„äººä¸€äº›å…¥é—¨çš„æŒ‡å¼• ç»™æ­£åœ¨ä½¿ç”¨ RxJava ä½†ä»ç„¶å¿ƒå­˜ç–‘æƒ‘çš„äººä¸€äº›æ›´æ·±å…¥çš„è§£æ åœ¨æ­£æ–‡å¼€å§‹ä¹‹å‰çš„æœ€åï¼Œæ”¾ä¸Š GitHub é“¾æ¥å’Œå¼•å…¥ä¾èµ–çš„ gradle ä»£ç ï¼šRxJava ï¼š https://github.com/ReactiveX/RxJavaRxAndroidï¼š https://github.com/ReactiveX/RxAndroid å¼•å…¥ä¾èµ–ï¼š 123//ï¼ˆç‰ˆæœ¬å·æ˜¯æ–‡ç« å‘å¸ƒæ—¶çš„æœ€æ–°ç¨³å®šç‰ˆï¼‰compile 'io.reactivex:rxjava:1.0.14' compile 'io.reactivex:rxandroid:1.0.1'","text":"æœ¬æ–‡è½¬è½½è‡ª ç»™ Android å¼€å‘è€…çš„ RxJava è¯¦è§£ â€”â€” by æ‰”ç‰©çº¿ å‰è¨€æˆ‘ä»å»å¹´å¼€å§‹ä½¿ç”¨ RxJava ï¼Œåˆ°ç°åœ¨ä¸€å¹´å¤šäº†ã€‚ä»Šå¹´åŠ å…¥äº† Flipboard åï¼Œçœ‹åˆ° Flipboard çš„ Android é¡¹ç›®ä¹Ÿåœ¨ä½¿ç”¨ RxJava ï¼Œå¹¶ä¸”ä½¿ç”¨çš„åœºæ™¯è¶Šæ¥è¶Šå¤š ã€‚è€Œæœ€è¿‘è¿™å‡ ä¸ªæœˆï¼Œæˆ‘ä¹Ÿå‘ç°å›½å†…è¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹æåŠ RxJava ã€‚æœ‰äººè¯´ã€RxJava çœŸæ˜¯å¤ªå¥½ç”¨äº†ã€ï¼Œæœ‰äººè¯´ã€RxJava çœŸæ˜¯å¤ªéš¾ç”¨äº†ã€ï¼Œå¦å¤–æ›´å¤šçš„äººè¡¨ç¤ºï¼šæˆ‘çœŸçš„ç™¾åº¦äº†ä¹Ÿè°·æ­Œäº†ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³é—®ï¼š RxJava åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ é‰´äº RxJava ç›®å‰è¿™ç§æ—¢ç«çˆ†åˆç¥ç§˜çš„ç°çŠ¶ï¼Œè€Œæˆ‘åˆåœ¨ä¸€å¹´çš„ä½¿ç”¨è¿‡ç¨‹ä¸­å¯¹ RxJava æœ‰äº†ä¸€äº›ç†è§£ï¼Œæˆ‘å†³å®šå†™ä¸‹è¿™ç¯‡æ–‡ç« æ¥å¯¹ RxJava åšä¸€ä¸ªç›¸å¯¹è¯¦ç»†çš„ã€é’ˆå¯¹ Android å¼€å‘è€…çš„ä»‹ç»ã€‚ è¿™ç¯‡æ–‡ç« çš„ç›®çš„æœ‰ä¸¤ä¸ªï¼š ç»™å¯¹ RxJava æ„Ÿå…´è¶£çš„äººä¸€äº›å…¥é—¨çš„æŒ‡å¼• ç»™æ­£åœ¨ä½¿ç”¨ RxJava ä½†ä»ç„¶å¿ƒå­˜ç–‘æƒ‘çš„äººä¸€äº›æ›´æ·±å…¥çš„è§£æ åœ¨æ­£æ–‡å¼€å§‹ä¹‹å‰çš„æœ€åï¼Œæ”¾ä¸Š GitHub é“¾æ¥å’Œå¼•å…¥ä¾èµ–çš„ gradle ä»£ç ï¼šRxJava ï¼š https://github.com/ReactiveX/RxJavaRxAndroidï¼š https://github.com/ReactiveX/RxAndroid å¼•å…¥ä¾èµ–ï¼š 123//ï¼ˆç‰ˆæœ¬å·æ˜¯æ–‡ç« å‘å¸ƒæ—¶çš„æœ€æ–°ç¨³å®šç‰ˆï¼‰compile 'io.reactivex:rxjava:1.0.14' compile 'io.reactivex:rxandroid:1.0.1' RxJava åˆ°åº•æ˜¯ä»€ä¹ˆä¸€ä¸ªè¯ï¼šå¼‚æ­¥ã€‚ RxJava åœ¨ GitHub ä¸»é¡µä¸Šçš„è‡ªæˆ‘ä»‹ç»æ˜¯ â€œa library for composing asynchronous and event-based programs using observable sequences for the Java VMâ€ï¼ˆä¸€ä¸ªåœ¨ Java VM ä¸Šä½¿ç”¨å¯è§‚æµ‹çš„åºåˆ—æ¥ç»„æˆå¼‚æ­¥çš„ã€åŸºäºäº‹ä»¶çš„ç¨‹åºçš„åº“ï¼‰ã€‚è¿™å°±æ˜¯ RxJava ï¼Œæ¦‚æ‹¬å¾—éå¸¸ç²¾å‡†ã€‚ ç„¶è€Œï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œè¿™å¤ªéš¾çœ‹æ‡‚äº†ã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªã€æ€»ç»“ã€ï¼Œè€Œåˆå­¦è€…æ›´éœ€è¦ä¸€ä¸ªã€å¼•è¨€ã€ã€‚ å…¶å®ï¼Œ RxJava çš„æœ¬è´¨å¯ä»¥å‹ç¼©ä¸ºå¼‚æ­¥è¿™ä¸€ä¸ªè¯ã€‚è¯´åˆ°æ ¹ä¸Šï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå®ç°å¼‚æ­¥æ“ä½œçš„åº“ï¼Œè€Œåˆ«çš„å®šè¯­éƒ½æ˜¯åŸºäºè¿™ä¹‹ä¸Šçš„ã€‚ RxJava å¥½åœ¨å“ªæ¢å¥è¯è¯´ï¼Œã€åŒæ ·æ˜¯åšå¼‚æ­¥ï¼Œä¸ºä»€ä¹ˆäººä»¬ç”¨å®ƒï¼Œè€Œä¸ç”¨ç°æˆçš„ AsyncTask / Handler / XXX / â€¦ ï¼Ÿã€ ä¸€ä¸ªè¯ï¼šç®€æ´ã€‚ å¼‚æ­¥æ“ä½œå¾ˆå…³é”®çš„ä¸€ç‚¹æ˜¯ç¨‹åºçš„ç®€æ´æ€§ï¼Œå› ä¸ºåœ¨è°ƒåº¦è¿‡ç¨‹æ¯”è¾ƒå¤æ‚çš„æƒ…å†µä¸‹ï¼Œå¼‚æ­¥ä»£ç ç»å¸¸ä¼šæ—¢éš¾å†™ä¹Ÿéš¾è¢«è¯»æ‡‚ã€‚ Android åˆ›é€ çš„ AsyncTask å’ŒHandler ï¼Œå…¶å®éƒ½æ˜¯ä¸ºäº†è®©å¼‚æ­¥ä»£ç æ›´åŠ ç®€æ´ã€‚RxJava çš„ä¼˜åŠ¿ä¹Ÿæ˜¯ç®€æ´ï¼Œä½†å®ƒçš„ç®€æ´çš„ä¸ä¼—ä¸åŒä¹‹å¤„åœ¨äºï¼Œéšç€ç¨‹åºé€»è¾‘å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œå®ƒä¾ç„¶èƒ½å¤Ÿä¿æŒç®€æ´ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Ÿå‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šç•Œé¢ä¸Šæœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„è§†å›¾ imageCollectorView ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ˜¾ç¤ºå¤šå¼ å›¾ç‰‡ï¼Œå¹¶èƒ½ä½¿ç”¨ addImage(Bitmap) æ–¹æ³•æ¥ä»»æ„å¢åŠ æ˜¾ç¤ºçš„å›¾ç‰‡ã€‚ç°åœ¨éœ€è¦ç¨‹åºå°†ä¸€ä¸ªç»™å‡ºçš„ç›®å½•æ•°ç»„ File[] folders ä¸­æ¯ä¸ªç›®å½•ä¸‹çš„ png å›¾ç‰‡éƒ½åŠ è½½å‡ºæ¥å¹¶æ˜¾ç¤ºåœ¨ imageCollectorView ä¸­ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºè¯»å–å›¾ç‰‡çš„è¿™ä¸€è¿‡ç¨‹è¾ƒä¸ºè€—æ—¶ï¼Œéœ€è¦æ”¾åœ¨åå°æ‰§è¡Œï¼Œè€Œå›¾ç‰‡çš„æ˜¾ç¤ºåˆ™å¿…é¡»åœ¨ UI çº¿ç¨‹æ‰§è¡Œã€‚å¸¸ç”¨çš„å®ç°æ–¹å¼æœ‰å¤šç§ï¼Œæˆ‘è¿™é‡Œè´´å‡ºå…¶ä¸­ä¸€ç§ï¼š 1234567891011121314151617181920new Thread() &#123; @Override public void run() &#123; super.run(); for (File folder : folders) &#123; File[] files = folder.listFiles(); for (File file : files) &#123; if (file.getName().endsWith(\".png\")) &#123; final Bitmap bitmap = getBitmapFromFile(file); getActivity().runOnUiThread(new Runnable() &#123; @Override public void run() &#123; imageCollectorView.addImage(bitmap); &#125; &#125;); &#125; &#125; &#125; &#125;&#125;.start(); è€Œå¦‚æœä½¿ç”¨ RxJava ï¼Œå®ç°æ–¹å¼æ˜¯è¿™æ ·çš„ï¼š 123456789101112131415161718192021222324252627Observable.from(folders) .flatMap(new Func1&lt;File, Observable&lt;File&gt;&gt;() &#123; @Override public Observable&lt;File&gt; call(File file) &#123; return Observable.from(file.listFiles()); &#125; &#125;) .filter(new Func1&lt;File, Boolean&gt;() &#123; @Override public Boolean call(File file) &#123; return file.getName().endsWith(\".png\"); &#125; &#125;) .map(new Func1&lt;File, Bitmap&gt;() &#123; @Override public Bitmap call(File file) &#123; return getBitmapFromFile(file); &#125; &#125;) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .subscribe(new Action1&lt;Bitmap&gt;() &#123; @Override public void call(Bitmap bitmap) &#123; imageCollectorView.addImage(bitmap); &#125; &#125;); é‚£ä½è¯´è¯äº†ï¼šã€ä½ è¿™ä»£ç æ˜æ˜å˜å¤šäº†å•Šï¼ç®€æ´ä¸ªæ¯›å•Šï¼ã€å¤§å…„å¼Ÿä½ æ¶ˆæ¶ˆæ°”ï¼Œæˆ‘è¯´çš„æ˜¯é€»è¾‘çš„ç®€æ´ï¼Œä¸æ˜¯å•çº¯çš„ä»£ç é‡å°‘ï¼ˆé€»è¾‘ç®€æ´æ‰æ˜¯æå‡è¯»å†™ä»£ç é€Ÿåº¦çš„å¿…æ€æŠ€å¯¹ä¸ï¼Ÿï¼‰ã€‚è§‚å¯Ÿä¸€ä¸‹ä½ ä¼šå‘ç°ï¼Œ RxJava çš„è¿™ä¸ªå®ç°ï¼Œæ˜¯ä¸€æ¡ä»ä¸Šåˆ°ä¸‹çš„é“¾å¼è°ƒç”¨ï¼Œæ²¡æœ‰ä»»ä½•åµŒå¥—ï¼Œè¿™åœ¨é€»è¾‘çš„ç®€æ´æ€§ä¸Šæ˜¯å…·æœ‰ä¼˜åŠ¿çš„ã€‚å½“éœ€æ±‚å˜å¾—å¤æ‚æ—¶ï¼Œè¿™ç§ä¼˜åŠ¿å°†æ›´åŠ æ˜æ˜¾ï¼ˆè¯•æƒ³å¦‚æœè¿˜è¦æ±‚åªé€‰å–å‰ 10 å¼ å›¾ç‰‡ï¼Œå¸¸è§„æ–¹å¼è¦æ€ä¹ˆåŠï¼Ÿå¦‚æœæœ‰æ›´å¤šè¿™æ ·é‚£æ ·çš„è¦æ±‚å‘¢ï¼Ÿå†è¯•æƒ³ï¼Œåœ¨è¿™ä¸€å¤§å †éœ€æ±‚å®ç°å®Œä¸¤ä¸ªæœˆä¹‹åéœ€è¦æ”¹åŠŸèƒ½ï¼Œå½“ä½ ç¿»å›è¿™é‡Œçœ‹åˆ°è‡ªå·±å½“åˆå†™ä¸‹çš„é‚£ä¸€ç‰‡è¿·ä¹‹ç¼©è¿›ï¼Œä½ èƒ½ä¿è¯è‡ªå·±å°†è¿…é€Ÿçœ‹æ‡‚ï¼Œè€Œä¸æ˜¯å¯¹ç€ä»£ç é‡æ–°æ‹ä¸€éæ€è·¯ï¼Ÿï¼‰ã€‚ å¦å¤–ï¼Œå¦‚æœä½ çš„ IDE æ˜¯ Android Studio ï¼Œå…¶å®æ¯æ¬¡æ‰“å¼€æŸä¸ª Java æ–‡ä»¶çš„æ—¶å€™ï¼Œä½ ä¼šçœ‹åˆ°è¢«è‡ªåŠ¨ Lambda åŒ–çš„é¢„è§ˆï¼Œè¿™å°†è®©ä½ æ›´åŠ æ¸…æ™°åœ°çœ‹åˆ°ç¨‹åºé€»è¾‘ï¼š 1234567Observable.from(folders) .flatMap((Func1) (folder) -&gt; &#123; Observable.from(file.listFiles()) &#125;) .filter((Func1) (file) -&gt; &#123; file.getName().endsWith(\".png\") &#125;) .map((Func1) (file) -&gt; &#123; getBitmapFromFile(file) &#125;) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .subscribe((Action1) (bitmap) -&gt; &#123; imageCollectorView.addImage(bitmap) &#125;); å¦‚æœä½ ä¹ æƒ¯ä½¿ç”¨ Retrolambda ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥æŠŠä»£ç å†™æˆä¸Šé¢è¿™ç§ç®€æ´çš„å½¢å¼ã€‚è€Œå¦‚æœä½ çœ‹åˆ°è¿™é‡Œè¿˜ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ Retrolambda ï¼Œæˆ‘ä¸å»ºè®®ä½ ç°åœ¨å°±å»å­¦ä¹ å®ƒã€‚åŸå› æœ‰ä¸¤ç‚¹ï¼š1. Lambda æ˜¯æŠŠåŒåˆƒå‰‘ï¼Œå®ƒè®©ä½ çš„ä»£ç ç®€æ´çš„åŒæ—¶ï¼Œé™ä½äº†ä»£ç çš„å¯è¯»æ€§ï¼Œå› æ­¤åŒæ—¶å­¦ä¹  RxJava å’Œ Retrolambda å¯èƒ½ä¼šè®©ä½ å¿½ç•¥ RxJava çš„ä¸€äº›æŠ€æœ¯ç»†èŠ‚ï¼›2. Retrolambda æ˜¯ Java 6/7 å¯¹ Lambda è¡¨è¾¾å¼çš„éå®˜æ–¹å…¼å®¹æ–¹æ¡ˆï¼Œå®ƒçš„å‘åå…¼å®¹æ€§å’Œç¨³å®šæ€§æ˜¯æ— æ³•ä¿éšœçš„ï¼Œå› æ­¤å¯¹äºä¼ä¸šé¡¹ç›®ï¼Œä½¿ç”¨ Retrolambda æ˜¯æœ‰é£é™©çš„ã€‚æ‰€ä»¥ï¼Œä¸å¾ˆå¤š RxJava çš„æ¨å¹¿è€…ä¸åŒï¼Œæˆ‘å¹¶ä¸æ¨èåœ¨å­¦ä¹  RxJava çš„åŒæ—¶ä¸€èµ·å­¦ä¹  Retrolambdaã€‚äº‹å®ä¸Šï¼Œæˆ‘ä¸ªäººè™½ç„¶å¾ˆæ¬£èµ Retrolambdaï¼Œä½†æˆ‘ä»æ¥ä¸ç”¨å®ƒã€‚ åœ¨Flipboard çš„ Android ä»£ç ä¸­ï¼Œæœ‰ä¸€æ®µé€»è¾‘éå¸¸å¤æ‚ï¼ŒåŒ…å«äº†å¤šæ¬¡å†…å­˜æ“ä½œã€æœ¬åœ°æ–‡ä»¶æ“ä½œå’Œç½‘ç»œæ“ä½œï¼Œå¯¹è±¡åˆ†åˆ†åˆåˆï¼Œçº¿ç¨‹é—´ç›¸äº’é…åˆç›¸äº’ç­‰å¾…ï¼Œä¸€ä¼šå„¿æ’æˆäººå­—ï¼Œä¸€ä¼šå„¿æ’æˆä¸€å­—ã€‚å¦‚æœä½¿ç”¨å¸¸è§„çš„æ–¹æ³•æ¥å®ç°ï¼Œè‚¯å®šæ˜¯è¦å†™å¾—æ¬²ä»™æ¬²æ­»ï¼Œç„¶è€Œåœ¨ä½¿ç”¨ RxJava çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶åªæ˜¯ä¸€æ¡é“¾å¼è°ƒç”¨å°±å®Œæˆäº†ã€‚å®ƒå¾ˆé•¿ï¼Œä½†å¾ˆæ¸…æ™°ã€‚ æ‰€ä»¥ï¼Œ RxJava å¥½åœ¨å“ªï¼Ÿå°±å¥½åœ¨ç®€æ´ï¼Œå¥½åœ¨é‚£æŠŠä»€ä¹ˆå¤æ‚é€»è¾‘éƒ½èƒ½ç©¿æˆä¸€æ¡çº¿çš„ç®€æ´ã€‚ API ä»‹ç»å’ŒåŸç†ç®€æè¿™ä¸ªæˆ‘å°±åšä¸åˆ°ä¸€ä¸ªè¯è¯´æ˜äº†â€¦â€¦å› ä¸ºè¿™ä¸€èŠ‚çš„ä¸»è¦å†…å®¹å°±æ˜¯ä¸€æ­¥æ­¥åœ°è¯´æ˜ RxJava åˆ°åº•æ€æ ·åšåˆ°äº†å¼‚æ­¥ï¼Œæ€æ ·åšåˆ°äº†ç®€æ´ã€‚ 1. æ¦‚å¿µï¼šæ‰©å±•çš„è§‚å¯Ÿè€…æ¨¡å¼RxJava çš„å¼‚æ­¥å®ç°ï¼Œæ˜¯é€šè¿‡ä¸€ç§æ‰©å±•çš„è§‚å¯Ÿè€…æ¨¡å¼æ¥å®ç°çš„ã€‚ è§‚å¯Ÿè€…æ¨¡å¼å…ˆç®€è¿°ä¸€ä¸‹è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå·²ç»ç†Ÿæ‚‰çš„å¯ä»¥è·³è¿‡è¿™ä¸€æ®µã€‚ è§‚å¯Ÿè€…æ¨¡å¼é¢å‘çš„éœ€æ±‚æ˜¯ï¼šA å¯¹è±¡ï¼ˆè§‚å¯Ÿè€…ï¼‰å¯¹ B å¯¹è±¡ï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰çš„æŸç§å˜åŒ–é«˜åº¦æ•æ„Ÿï¼Œéœ€è¦åœ¨ B å˜åŒ–çš„ä¸€ç¬é—´åšå‡ºååº”ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ–°é—»é‡Œå–œé—»ä¹è§çš„è­¦å¯ŸæŠ“å°å·ï¼Œè­¦å¯Ÿéœ€è¦åœ¨å°å·ä¼¸æ‰‹ä½œæ¡ˆçš„æ—¶å€™å®æ–½æŠ“æ•ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œè­¦å¯Ÿæ˜¯è§‚å¯Ÿè€…ï¼Œå°å·æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œè­¦å¯Ÿéœ€è¦æ—¶åˆ»ç›¯ç€å°å·çš„ä¸€ä¸¾ä¸€åŠ¨ï¼Œæ‰èƒ½ä¿è¯ä¸ä¼šæ¼è¿‡ä»»ä½•ç¬é—´ã€‚ç¨‹åºçš„è§‚å¯Ÿè€…æ¨¡å¼å’Œè¿™ç§çœŸæ­£çš„ã€è§‚å¯Ÿã€ç•¥æœ‰ä¸åŒï¼Œè§‚å¯Ÿè€…ä¸éœ€è¦æ—¶åˆ»ç›¯ç€è¢«è§‚å¯Ÿè€…ï¼ˆä¾‹å¦‚ A ä¸éœ€è¦æ¯è¿‡ 2ms å°±æ£€æŸ¥ä¸€æ¬¡ B çš„çŠ¶æ€ï¼‰ï¼Œè€Œæ˜¯é‡‡ç”¨æ³¨å†Œ(Register)æˆ–è€…ç§°ä¸ºè®¢é˜…(Subscribe)çš„æ–¹å¼ï¼Œå‘Šè¯‰è¢«è§‚å¯Ÿè€…ï¼šæˆ‘éœ€è¦ä½ çš„æŸæŸçŠ¶æ€ï¼Œä½ è¦åœ¨å®ƒå˜åŒ–çš„æ—¶å€™é€šçŸ¥æˆ‘ã€‚ Android å¼€å‘ä¸­ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„ä¾‹å­æ˜¯ç‚¹å‡»ç›‘å¬å™¨ OnClickListener ã€‚å¯¹è®¾ç½® OnClickListener æ¥è¯´ï¼Œ View æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œ OnClickListener æ˜¯è§‚å¯Ÿè€…ï¼ŒäºŒè€…é€šè¿‡ setOnClickListener() æ–¹æ³•è¾¾æˆè®¢é˜…å…³ç³»ã€‚è®¢é˜…ä¹‹åç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„ç¬é—´ï¼ŒAndroid Framework å°±ä¼šå°†ç‚¹å‡»äº‹ä»¶å‘é€ç»™å·²ç»æ³¨å†Œçš„ OnClickListener ã€‚é‡‡å–è¿™æ ·è¢«åŠ¨çš„è§‚å¯Ÿæ–¹å¼ï¼Œæ—¢çœå»äº†åå¤æ£€ç´¢çŠ¶æ€çš„èµ„æºæ¶ˆè€—ï¼Œä¹Ÿèƒ½å¤Ÿå¾—åˆ°æœ€é«˜çš„åé¦ˆé€Ÿåº¦ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿå¾—ç›Šäºæˆ‘ä»¬å¯ä»¥éšæ„å®šåˆ¶è‡ªå·±ç¨‹åºä¸­çš„è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ï¼Œè€Œè­¦å¯Ÿå”å”æ˜æ˜¾æ— æ³•è¦æ±‚å°å·ï¼šã€ä½ åœ¨ä½œæ¡ˆçš„æ—¶å€™åŠ¡å¿…é€šçŸ¥æˆ‘ã€ã€‚ OnClickListener çš„æ¨¡å¼å¤§è‡´å¦‚ä¸‹å›¾ï¼š å¦‚å›¾æ‰€ç¤ºï¼Œé€šè¿‡ setOnClickListener() æ–¹æ³•ï¼ŒButton æŒæœ‰ OnClickListener çš„å¼•ç”¨ï¼ˆè¿™ä¸€è¿‡ç¨‹æ²¡æœ‰åœ¨å›¾ä¸Šç”»å‡ºï¼‰ï¼›å½“ç”¨æˆ·ç‚¹å‡»æ—¶ï¼ŒButton è‡ªåŠ¨è°ƒç”¨ OnClickListener çš„ onClick() æ–¹æ³•ã€‚å¦å¤–ï¼Œå¦‚æœæŠŠè¿™å¼ å›¾ä¸­çš„æ¦‚å¿µæŠ½è±¡å‡ºæ¥ï¼ˆButton -&gt; è¢«è§‚å¯Ÿè€…ã€OnClickListener -&gt; è§‚å¯Ÿè€…ã€setOnClickListener() -&gt; è®¢é˜…ï¼ŒonClick() -&gt; äº‹ä»¶ï¼‰ï¼Œå°±ç”±ä¸“ç”¨çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¾‹å¦‚åªç”¨äºç›‘å¬æ§ä»¶ç‚¹å‡»ï¼‰è½¬å˜æˆäº†é€šç”¨çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚å¦‚ä¸‹å›¾ï¼š è€Œ RxJava ä½œä¸ºä¸€ä¸ªå·¥å…·åº“ï¼Œä½¿ç”¨çš„å°±æ˜¯é€šç”¨å½¢å¼çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚ RxJava çš„è§‚å¯Ÿè€…æ¨¡å¼RxJava æœ‰å››ä¸ªåŸºæœ¬æ¦‚å¿µï¼š Observable (å¯è§‚å¯Ÿè€…ï¼Œå³è¢«è§‚å¯Ÿè€…) Observer (è§‚å¯Ÿè€…) subscribe (è®¢é˜…) Event (äº‹ä»¶) Observable å’Œ Observer é€šè¿‡ subscribe() æ–¹æ³•å®ç°è®¢é˜…å…³ç³»ï¼Œä»è€Œ Observable å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å‘å‡ºäº‹ä»¶æ¥é€šçŸ¥ Observerã€‚ ä¸ä¼ ç»Ÿè§‚å¯Ÿè€…æ¨¡å¼ä¸åŒï¼Œ RxJava çš„äº‹ä»¶å›è°ƒæ–¹æ³•é™¤äº†æ™®é€šäº‹ä»¶ onNext() ï¼ˆç›¸å½“äº onClick() / onEvent()ï¼‰ä¹‹å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸¤ä¸ªç‰¹æ®Šçš„äº‹ä»¶ï¼šonCompleted() å’Œ onError()ã€‚ onCompleted(): äº‹ä»¶é˜Ÿåˆ—å®Œç»“ã€‚RxJava ä¸ä»…æŠŠæ¯ä¸ªäº‹ä»¶å•ç‹¬å¤„ç†ï¼Œè¿˜ä¼šæŠŠå®ƒä»¬çœ‹åšä¸€ä¸ªé˜Ÿåˆ—ã€‚RxJava è§„å®šï¼Œå½“ä¸ä¼šå†æœ‰æ–°çš„ onNext() å‘å‡ºæ—¶ï¼Œéœ€è¦è§¦å‘ onCompleted() æ–¹æ³•ä½œä¸ºæ ‡å¿—ã€‚ onError(): äº‹ä»¶é˜Ÿåˆ—å¼‚å¸¸ã€‚åœ¨äº‹ä»¶å¤„ç†è¿‡ç¨‹ä¸­å‡ºå¼‚å¸¸æ—¶ï¼ŒonError() ä¼šè¢«è§¦å‘ï¼ŒåŒæ—¶é˜Ÿåˆ—è‡ªåŠ¨ç»ˆæ­¢ï¼Œä¸å…è®¸å†æœ‰äº‹ä»¶å‘å‡ºã€‚ åœ¨ä¸€ä¸ªæ­£ç¡®è¿è¡Œçš„äº‹ä»¶åºåˆ—ä¸­, onCompleted() å’Œ onError() æœ‰ä¸”åªæœ‰ä¸€ä¸ªï¼Œå¹¶ä¸”æ˜¯äº‹ä»¶åºåˆ—ä¸­çš„æœ€åä¸€ä¸ªã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒonCompleted() å’Œ onError() äºŒè€…ä¹Ÿæ˜¯äº’æ–¥çš„ï¼Œå³åœ¨é˜Ÿåˆ—ä¸­è°ƒç”¨äº†å…¶ä¸­ä¸€ä¸ªï¼Œå°±ä¸åº”è¯¥å†è°ƒç”¨å¦ä¸€ä¸ªã€‚ RxJava çš„è§‚å¯Ÿè€…æ¨¡å¼å¤§è‡´å¦‚ä¸‹å›¾ï¼š 2. åŸºæœ¬å®ç°åŸºäºä»¥ä¸Šçš„æ¦‚å¿µï¼Œ RxJava çš„åŸºæœ¬å®ç°ä¸»è¦æœ‰ä¸‰ç‚¹ï¼š 1) åˆ›å»º ObserverObserver å³è§‚å¯Ÿè€…ï¼Œå®ƒå†³å®šäº‹ä»¶è§¦å‘çš„æ—¶å€™å°†æœ‰æ€æ ·çš„è¡Œä¸ºã€‚ RxJava ä¸­çš„ Observer æ¥å£çš„å®ç°æ–¹å¼ï¼š 12345678910111213141516Observer&lt;String&gt; observer = new Observer&lt;String&gt;() &#123; @Override public void onNext(String s) &#123; Log.d(tag, \"Item: \" + s); &#125; @Override public void onCompleted() &#123; Log.d(tag, \"Completed!\"); &#125; @Override public void onError(Throwable e) &#123; Log.d(tag, \"Error!\"); &#125;&#125;; é™¤äº† Observer æ¥å£ä¹‹å¤–ï¼ŒRxJava è¿˜å†…ç½®äº†ä¸€ä¸ªå®ç°äº† Observer çš„æŠ½è±¡ç±»ï¼šSubscriberã€‚ Subscriber å¯¹ Observer æ¥å£è¿›è¡Œäº†ä¸€äº›æ‰©å±•ï¼Œä½†ä»–ä»¬çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼š 12345678910111213141516Subscriber&lt;String&gt; subscriber = new Subscriber&lt;String&gt;() &#123; @Override public void onNext(String s) &#123; Log.d(tag, \"Item: \" + s); &#125; @Override public void onCompleted() &#123; Log.d(tag, \"Completed!\"); &#125; @Override public void onError(Throwable e) &#123; Log.d(tag, \"Error!\"); &#125;&#125;; ä¸ä»…åŸºæœ¬ä½¿ç”¨æ–¹å¼ä¸€æ ·ï¼Œå®è´¨ä¸Šï¼Œåœ¨ RxJava çš„ subscribe è¿‡ç¨‹ä¸­ï¼ŒObserver ä¹Ÿæ€»æ˜¯ä¼šå…ˆè¢«è½¬æ¢æˆä¸€ä¸ª Subscriber å†ä½¿ç”¨ã€‚æ‰€ä»¥å¦‚æœä½ åªæƒ³ä½¿ç”¨åŸºæœ¬åŠŸèƒ½ï¼Œé€‰æ‹© Observer å’Œ Subscriber æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚å®ƒä»¬çš„åŒºåˆ«å¯¹äºä½¿ç”¨è€…æ¥è¯´ä¸»è¦æœ‰ä¸¤ç‚¹ï¼š onStart(): è¿™æ˜¯ Subscriber å¢åŠ çš„æ–¹æ³•ã€‚å®ƒä¼šåœ¨ subscribe åˆšå¼€å§‹ï¼Œè€Œäº‹ä»¶è¿˜æœªå‘é€ä¹‹å‰è¢«è°ƒç”¨ï¼Œå¯ä»¥ç”¨äºåšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œä¾‹å¦‚æ•°æ®çš„æ¸…é›¶æˆ–é‡ç½®ã€‚è¿™æ˜¯ä¸€ä¸ªå¯é€‰æ–¹æ³•ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒçš„å®ç°ä¸ºç©ºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå¯¹å‡†å¤‡å·¥ä½œçš„çº¿ç¨‹æœ‰è¦æ±‚ï¼ˆä¾‹å¦‚å¼¹å‡ºä¸€ä¸ªæ˜¾ç¤ºè¿›åº¦çš„å¯¹è¯æ¡†ï¼Œè¿™å¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼‰ï¼Œ onStart() å°±ä¸é€‚ç”¨äº†ï¼Œå› ä¸ºå®ƒæ€»æ˜¯åœ¨ subscribe æ‰€å‘ç”Ÿçš„çº¿ç¨‹è¢«è°ƒç”¨ï¼Œè€Œä¸èƒ½æŒ‡å®šçº¿ç¨‹ã€‚è¦åœ¨æŒ‡å®šçš„çº¿ç¨‹æ¥åšå‡†å¤‡å·¥ä½œï¼Œå¯ä»¥ä½¿ç”¨ doOnSubscribe() æ–¹æ³•ï¼Œå…·ä½“å¯ä»¥åœ¨åé¢çš„æ–‡ä¸­çœ‹åˆ°ã€‚ unsubscribe(): è¿™æ˜¯ Subscriber æ‰€å®ç°çš„å¦ä¸€ä¸ªæ¥å£ Subscription çš„æ–¹æ³•ï¼Œç”¨äºå–æ¶ˆè®¢é˜…ã€‚åœ¨è¿™ä¸ªæ–¹æ³•è¢«è°ƒç”¨åï¼ŒSubscriber å°†ä¸å†æ¥æ”¶äº‹ä»¶ã€‚ä¸€èˆ¬åœ¨è¿™ä¸ªæ–¹æ³•è°ƒç”¨å‰ï¼Œå¯ä»¥ä½¿ç”¨ isUnsubscribed() å…ˆåˆ¤æ–­ä¸€ä¸‹çŠ¶æ€ã€‚ unsubscribe() è¿™ä¸ªæ–¹æ³•å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨ subscribe() ä¹‹åï¼Œ Observable ä¼šæŒæœ‰ Subscriber çš„å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨å¦‚æœä¸èƒ½åŠæ—¶è¢«é‡Šæ”¾ï¼Œå°†æœ‰å†…å­˜æ³„éœ²çš„é£é™©ã€‚æ‰€ä»¥æœ€å¥½ä¿æŒä¸€ä¸ªåŸåˆ™ï¼šè¦åœ¨ä¸å†ä½¿ç”¨çš„æ—¶å€™å°½å¿«åœ¨åˆé€‚çš„åœ°æ–¹ï¼ˆä¾‹å¦‚ onPause() onStop() ç­‰æ–¹æ³•ä¸­ï¼‰è°ƒç”¨ unsubscribe() æ¥è§£é™¤å¼•ç”¨å…³ç³»ï¼Œä»¥é¿å…å†…å­˜æ³„éœ²çš„å‘ç”Ÿã€‚ 2) åˆ›å»º ObservableObservable å³è¢«è§‚å¯Ÿè€…ï¼Œå®ƒå†³å®šä»€ä¹ˆæ—¶å€™è§¦å‘äº‹ä»¶ä»¥åŠè§¦å‘æ€æ ·çš„äº‹ä»¶ã€‚ RxJava ä½¿ç”¨ create() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª Observable ï¼Œå¹¶ä¸ºå®ƒå®šä¹‰äº‹ä»¶è§¦å‘è§„åˆ™ï¼š 123456789Observable observable = Observable.create(new Observable.OnSubscribe&lt;String&gt;() &#123; @Override public void call(Subscriber&lt;? super String&gt; subscriber) &#123; subscriber.onNext(\"Hello\"); subscriber.onNext(\"Hi\"); subscriber.onNext(\"Aloha\"); subscriber.onCompleted(); &#125;&#125;); å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œä¼ å…¥äº†ä¸€ä¸ª OnSubscribe å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚OnSubscribe ä¼šè¢«å­˜å‚¨åœ¨è¿”å›çš„ Observable å¯¹è±¡ä¸­ï¼Œå®ƒçš„ä½œç”¨ç›¸å½“äºä¸€ä¸ªè®¡åˆ’è¡¨ï¼Œå½“ Observable è¢«è®¢é˜…çš„æ—¶å€™ï¼ŒOnSubscribe çš„ call() æ–¹æ³•ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ï¼Œäº‹ä»¶åºåˆ—å°±ä¼šä¾ç…§è®¾å®šä¾æ¬¡è§¦å‘ï¼ˆå¯¹äºä¸Šé¢çš„ä»£ç ï¼Œå°±æ˜¯è§‚å¯Ÿè€…Subscriber å°†ä¼šè¢«è°ƒç”¨ä¸‰æ¬¡ onNext() å’Œä¸€æ¬¡ onCompleted()ï¼‰ã€‚è¿™æ ·ï¼Œç”±è¢«è§‚å¯Ÿè€…è°ƒç”¨äº†è§‚å¯Ÿè€…çš„å›è°ƒæ–¹æ³•ï¼Œå°±å®ç°äº†ç”±è¢«è§‚å¯Ÿè€…å‘è§‚å¯Ÿè€…çš„äº‹ä»¶ä¼ é€’ï¼Œå³è§‚å¯Ÿè€…æ¨¡å¼ã€‚ è¿™ä¸ªä¾‹å­å¾ˆç®€å•ï¼šäº‹ä»¶çš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸€äº›å¤æ‚çš„å¯¹è±¡ï¼›äº‹ä»¶çš„å†…å®¹æ˜¯å·²ç»å®šå¥½äº†çš„ï¼Œè€Œä¸åƒæœ‰çš„è§‚å¯Ÿè€…æ¨¡å¼ä¸€æ ·æ˜¯å¾…ç¡®å®šçš„ï¼ˆä¾‹å¦‚ç½‘ç»œè¯·æ±‚çš„ç»“æœåœ¨è¯·æ±‚è¿”å›ä¹‹å‰æ˜¯æœªçŸ¥çš„ï¼‰ï¼›æ‰€æœ‰äº‹ä»¶åœ¨ä¸€ç¬é—´è¢«å…¨éƒ¨å‘é€å‡ºå»ï¼Œè€Œä¸æ˜¯å¤¹æ‚ä¸€äº›ç¡®å®šæˆ–ä¸ç¡®å®šçš„æ—¶é—´é—´éš”æˆ–è€…ç»è¿‡æŸç§è§¦å‘å™¨æ¥è§¦å‘çš„ã€‚æ€»ä¹‹ï¼Œè¿™ä¸ªä¾‹å­çœ‹èµ·æ¥æ¯«æ— å®ç”¨ä»·å€¼ã€‚ä½†è¿™æ˜¯ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œå®è´¨ä¸Šåªè¦ä½ æƒ³ï¼Œå„ç§å„æ ·çš„äº‹ä»¶å‘é€è§„åˆ™ä½ éƒ½å¯ä»¥è‡ªå·±æ¥å†™ã€‚è‡³äºå…·ä½“æ€ä¹ˆåšï¼Œåé¢éƒ½ä¼šè®²åˆ°ï¼Œä½†ç°åœ¨ä¸è¡Œã€‚åªæœ‰æŠŠåŸºç¡€åŸç†å…ˆè¯´æ˜ç™½äº†ï¼Œä¸Šå±‚çš„è¿ç”¨æ‰èƒ½æ›´å®¹æ˜“è¯´æ¸…æ¥šã€‚ create() æ–¹æ³•æ˜¯ RxJava æœ€åŸºæœ¬çš„åˆ›é€ äº‹ä»¶åºåˆ—çš„æ–¹æ³•ã€‚åŸºäºè¿™ä¸ªæ–¹æ³•ï¼Œ RxJava è¿˜æä¾›äº†ä¸€äº›æ–¹æ³•ç”¨æ¥å¿«æ·åˆ›å»ºäº‹ä»¶é˜Ÿåˆ—ï¼Œä¾‹å¦‚ï¼š just(T...) : å°†ä¼ å…¥çš„å‚æ•°ä¾æ¬¡å‘é€å‡ºæ¥ã€‚ 123456Observable observable = Observable.just(\"Hello\", \"Hi\", \"Aloha\");// å°†ä¼šä¾æ¬¡è°ƒç”¨ï¼š// onNext(\"Hello\");// onNext(\"Hi\");// onNext(\"Aloha\");// onCompleted(); from(T[]) / from(Iterable&lt;? extends T&gt;) : å°†ä¼ å…¥çš„æ•°ç»„æˆ– Iterable æ‹†åˆ†æˆå…·ä½“å¯¹è±¡åï¼Œä¾æ¬¡å‘é€å‡ºæ¥ã€‚ 1234567String[] words = &#123;\"Hello\", \"Hi\", \"Aloha\"&#125;;Observable observable = Observable.from(words);// å°†ä¼šä¾æ¬¡è°ƒç”¨ï¼š// onNext(\"Hello\");// onNext(\"Hi\");// onNext(\"Aloha\");// onCompleted(); ä¸Šé¢ just(T...) çš„ä¾‹å­å’Œ from(T[]) çš„ä¾‹å­ï¼Œéƒ½å’Œä¹‹å‰çš„ create(OnSubscribe) çš„ä¾‹å­æ˜¯ç­‰ä»·çš„ã€‚ 3) Subscribe (è®¢é˜…)åˆ›å»ºäº† Observable å’Œ Observer ä¹‹åï¼Œå†ç”¨ subscribe() æ–¹æ³•å°†å®ƒä»¬è”ç»“èµ·æ¥ï¼Œæ•´æ¡é“¾å­å°±å¯ä»¥å·¥ä½œäº†ã€‚ä»£ç å½¢å¼å¾ˆç®€å•ï¼š 123observable.subscribe(observer);// æˆ–è€…ï¼šobservable.subscribe(subscriber); æœ‰äººå¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œ subscribe() è¿™ä¸ªæ–¹æ³•æœ‰ç‚¹æ€ªï¼šå®ƒçœ‹èµ·æ¥æ˜¯ã€observalbe è®¢é˜…äº† observer / subscriberã€è€Œä¸æ˜¯ã€observer / subscriber è®¢é˜…äº† observalbeã€ï¼Œè¿™çœ‹èµ·æ¥å°±åƒã€æ‚å¿—è®¢é˜…äº†è¯»è€…ã€ä¸€æ ·é¢ å€’äº†å¯¹è±¡å…³ç³»ã€‚è¿™è®©äººè¯»èµ·æ¥æœ‰ç‚¹åˆ«æ‰­ï¼Œä¸è¿‡å¦‚æœæŠŠ API è®¾è®¡æˆ observer.subscribe(observable) / subscriber.subscribe(observable) ï¼Œè™½ç„¶æ›´åŠ ç¬¦åˆæ€ç»´é€»è¾‘ï¼Œä½†å¯¹æµå¼ API çš„è®¾è®¡å°±é€ æˆå½±å“äº†ï¼Œæ¯”è¾ƒèµ·æ¥æ˜æ˜¾æ˜¯å¾—ä¸å¿å¤±çš„ã€‚ Observable.subscribe(Subscriber) çš„å†…éƒ¨å®ç°æ˜¯è¿™æ ·çš„ï¼ˆä»…æ ¸å¿ƒä»£ç ï¼‰ï¼š 1234567// æ³¨æ„ï¼šè¿™ä¸æ˜¯ subscribe() çš„æºç ï¼Œè€Œæ˜¯å°†æºç ä¸­ä¸æ€§èƒ½ã€å…¼å®¹æ€§ã€æ‰©å±•æ€§æœ‰å…³çš„ä»£ç å‰”é™¤åçš„æ ¸å¿ƒä»£ç ã€‚// å¦‚æœéœ€è¦çœ‹æºç ï¼Œå¯ä»¥å» RxJava çš„ GitHub ä»“åº“ä¸‹è½½ã€‚public Subscription subscribe(Subscriber subscriber) &#123; subscriber.onStart(); onSubscribe.call(subscriber); return subscriber;&#125; å¯ä»¥çœ‹åˆ°ï¼Œsubscriber() åšäº†3ä»¶äº‹ï¼š è°ƒç”¨ Subscriber.onStart() ã€‚è¿™ä¸ªæ–¹æ³•åœ¨å‰é¢å·²ç»ä»‹ç»è¿‡ï¼Œæ˜¯ä¸€ä¸ªå¯é€‰çš„å‡†å¤‡æ–¹æ³•ã€‚ è°ƒç”¨ Observable ä¸­çš„ OnSubscribe.call(Subscriber) ã€‚åœ¨è¿™é‡Œï¼Œäº‹ä»¶å‘é€çš„é€»è¾‘å¼€å§‹è¿è¡Œã€‚ä»è¿™ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨ RxJava ä¸­ï¼Œ Observable å¹¶ä¸æ˜¯åœ¨åˆ›å»ºçš„æ—¶å€™å°±ç«‹å³å¼€å§‹å‘é€äº‹ä»¶ï¼Œè€Œæ˜¯åœ¨å®ƒè¢«è®¢é˜…çš„æ—¶å€™ï¼Œå³å½“ subscribe() æ–¹æ³•æ‰§è¡Œçš„æ—¶å€™ã€‚ å°†ä¼ å…¥çš„ Subscriber ä½œä¸º Subscription è¿”å›ã€‚è¿™æ˜¯ä¸ºäº†æ–¹ä¾¿ unsubscribe(). æ•´ä¸ªè¿‡ç¨‹ä¸­å¯¹è±¡é—´çš„å…³ç³»å¦‚ä¸‹å›¾ï¼š é™¤äº† subscribe(Observer) å’Œ subscribe(Subscriber) ï¼Œsubscribe() è¿˜æ”¯æŒä¸å®Œæ•´å®šä¹‰çš„å›è°ƒï¼ŒRxJava ä¼šè‡ªåŠ¨æ ¹æ®å®šä¹‰åˆ›å»ºå‡º Subscriber ã€‚å½¢å¼å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728Action1&lt;String&gt; onNextAction = new Action1&lt;String&gt;() &#123; // onNext() @Override public void call(String s) &#123; Log.d(tag, s); &#125;&#125;;Action1&lt;Throwable&gt; onErrorAction = new Action1&lt;Throwable&gt;() &#123; // onError() @Override public void call(Throwable throwable) &#123; // Error handling &#125;&#125;;Action0 onCompletedAction = new Action0() &#123; // onCompleted() @Override public void call() &#123; Log.d(tag, \"completed\"); &#125;&#125;;// è‡ªåŠ¨åˆ›å»º Subscriber ï¼Œå¹¶ä½¿ç”¨ onNextAction æ¥å®šä¹‰ onNext()observable.subscribe(onNextAction);// è‡ªåŠ¨åˆ›å»º Subscriber ï¼Œå¹¶ä½¿ç”¨ onNextAction å’Œ onErrorAction æ¥å®šä¹‰ onNext() å’Œ onError()observable.subscribe(onNextAction, onErrorAction);// è‡ªåŠ¨åˆ›å»º Subscriber ï¼Œå¹¶ä½¿ç”¨ onNextActionã€ onErrorAction å’Œ onCompletedAction æ¥å®šä¹‰ onNext()ã€ onError() å’Œ onCompleted()observable.subscribe(onNextAction, onErrorAction, onCompletedAction); ç®€å•è§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç ä¸­å‡ºç°çš„ Action1 å’Œ Action0ã€‚ Action0 æ˜¯ RxJava çš„ä¸€ä¸ªæ¥å£ï¼Œå®ƒåªæœ‰ä¸€ä¸ªæ–¹æ³• call()ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯æ— å‚æ— è¿”å›å€¼çš„ï¼›ç”±äº onCompleted() æ–¹æ³•ä¹Ÿæ˜¯æ— å‚æ— è¿”å›å€¼çš„ï¼Œå› æ­¤ Action0 å¯ä»¥è¢«å½“æˆä¸€ä¸ªåŒ…è£…å¯¹è±¡ï¼Œå°† onCompleted() çš„å†…å®¹æ‰“åŒ…èµ·æ¥å°†è‡ªå·±ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ å…¥ subscribe() ä»¥å®ç°ä¸å®Œæ•´å®šä¹‰çš„å›è°ƒã€‚è¿™æ ·å…¶å®ä¹Ÿå¯ä»¥çœ‹åšå°† onCompleted() æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ è¿›äº† subscribe()ï¼Œç›¸å½“äºå…¶ä»–æŸäº›è¯­è¨€ä¸­çš„ã€é—­åŒ…ã€ã€‚ Action1 ä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒåŒæ ·åªæœ‰ä¸€ä¸ªæ–¹æ³• call(T param)ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿæ— è¿”å›å€¼ï¼Œä½†æœ‰ä¸€ä¸ªå‚æ•°ï¼›ä¸ Action0 åŒç†ï¼Œç”±äº onNext(T obj) å’Œ onError(Throwable error) ä¹Ÿæ˜¯å•å‚æ•°æ— è¿”å›å€¼çš„ï¼Œå› æ­¤ Action1 å¯ä»¥å°† onNext(obj) å’Œ onError(error) æ‰“åŒ…èµ·æ¥ä¼ å…¥ subscribe() ä»¥å®ç°ä¸å®Œæ•´å®šä¹‰çš„å›è°ƒã€‚äº‹å®ä¸Šï¼Œè™½ç„¶ Action0 å’Œ Action1 åœ¨ API ä¸­ä½¿ç”¨æœ€å¹¿æ³›ï¼Œä½† RxJava æ˜¯æä¾›äº†å¤šä¸ª ActionX å½¢å¼çš„æ¥å£ (ä¾‹å¦‚ Action2, Action3) çš„ï¼Œå®ƒä»¬å¯ä»¥è¢«ç”¨ä»¥åŒ…è£…ä¸åŒçš„æ— è¿”å›å€¼çš„æ–¹æ³•ã€‚ æ³¨ï¼šæ­£å¦‚å‰é¢æ‰€æåˆ°çš„ï¼ŒObserver å’Œ Subscriber å…·æœ‰ç›¸åŒçš„è§’è‰²ï¼Œè€Œä¸” Observer åœ¨ subscribe() è¿‡ç¨‹ä¸­æœ€ç»ˆä¼šè¢«è½¬æ¢æˆ Subscriber å¯¹è±¡ï¼Œå› æ­¤ï¼Œä»è¿™é‡Œå¼€å§‹ï¼Œåé¢çš„æè¿°æˆ‘å°†ç”¨ Subscriber æ¥ä»£æ›¿ Observer ï¼Œè¿™æ ·æ›´åŠ ä¸¥è°¨ã€‚ 4) åœºæ™¯ç¤ºä¾‹ä¸‹é¢ä¸¾ä¸¤ä¸ªä¾‹å­ï¼š ä¸ºäº†æŠŠåŸç†ç”¨æ›´æ¸…æ™°çš„æ–¹å¼è¡¨è¿°å‡ºæ¥ï¼Œæœ¬æ–‡ä¸­æŒ‘é€‰çš„éƒ½æ˜¯åŠŸèƒ½å°½å¯èƒ½ç®€å•çš„ä¾‹å­ï¼Œä»¥è‡³äºæœ‰äº›ç¤ºä¾‹ä»£ç çœ‹èµ·æ¥ä¼šæœ‰ã€ç”»è›‡æ·»è¶³ã€ã€æ˜æ˜ä¸ç”¨ RxJava å¯ä»¥æ›´ç®€ä¾¿åœ°è§£å†³é—®é¢˜ã€çš„æ„Ÿè§‰ã€‚å½“ä½ çœ‹åˆ°è¿™ç§æƒ…å†µï¼Œä¸è¦è§‰å¾—æ˜¯å› ä¸º RxJava å¤ªå•°å—¦ï¼Œè€Œæ˜¯å› ä¸ºåœ¨è¿‡æ—©çš„æ—¶å€™ä¸¾å‡ºçœŸå®åœºæ™¯çš„ä¾‹å­å¹¶ä¸åˆ©äºåŸç†çš„è§£æï¼Œå› æ­¤æˆ‘åˆ»æ„æŒ‘é€‰äº†ç®€å•çš„æƒ…æ™¯ã€‚ a. æ‰“å°å­—ç¬¦ä¸²æ•°ç»„ å°†å­—ç¬¦ä¸²æ•°ç»„ names ä¸­çš„æ‰€æœ‰å­—ç¬¦ä¸²ä¾æ¬¡æ‰“å°å‡ºæ¥ï¼š 12345678String[] names = ...;Observable.from(names) .subscribe(new Action1&lt;String&gt;() &#123; @Override public void call(String name) &#123; Log.d(tag, name); &#125; &#125;); b. ç”± id å–å¾—å›¾ç‰‡å¹¶æ˜¾ç¤º ç”±æŒ‡å®šçš„ä¸€ä¸ª drawable æ–‡ä»¶ id drawableRes å–å¾—å›¾ç‰‡ï¼Œå¹¶æ˜¾ç¤ºåœ¨ ImageView ä¸­ï¼Œå¹¶åœ¨å‡ºç°å¼‚å¸¸çš„æ—¶å€™æ‰“å° Toast æŠ¥é”™ï¼š 123456789101112131415161718192021222324int drawableRes = ...;ImageView imageView = ...;Observable.create(new OnSubscribe&lt;Drawable&gt;() &#123; @Override public void call(Subscriber&lt;? super Drawable&gt; subscriber) &#123; Drawable drawable = getTheme().getDrawable(drawableRes)); subscriber.onNext(drawable); subscriber.onCompleted(); &#125;&#125;).subscribe(new Observer&lt;Drawable&gt;() &#123; @Override public void onNext(Drawable drawable) &#123; imageView.setImageDrawable(drawable); &#125; @Override public void onCompleted() &#123; &#125; @Override public void onError(Throwable e) &#123; Toast.makeText(activity, \"Error!\", Toast.LENGTH_SHORT).show(); &#125;&#125;); æ­£å¦‚ä¸Šé¢ä¸¤ä¸ªä¾‹å­è¿™æ ·ï¼Œåˆ›å»ºå‡º Observable å’Œ Subscriber ï¼Œå†ç”¨ subscribe() å°†å®ƒä»¬ä¸²èµ·æ¥ï¼Œä¸€æ¬¡ RxJava çš„åŸºæœ¬ä½¿ç”¨å°±å®Œæˆäº†ã€‚éå¸¸ç®€å•ã€‚ ç„¶è€Œï¼Œ åœ¨ RxJava çš„é»˜è®¤è§„åˆ™ä¸­ï¼Œäº‹ä»¶çš„å‘å‡ºå’Œæ¶ˆè´¹éƒ½æ˜¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåªç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œå®ç°å‡ºæ¥çš„åªæ˜¯ä¸€ä¸ªåŒæ­¥çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚è§‚å¯Ÿè€…æ¨¡å¼æœ¬èº«çš„ç›®çš„å°±æ˜¯ã€åå°å¤„ç†ï¼Œå‰å°å›è°ƒã€çš„å¼‚æ­¥æœºåˆ¶ï¼Œå› æ­¤å¼‚æ­¥å¯¹äº RxJava æ˜¯è‡³å…³é‡è¦çš„ã€‚è€Œè¦å®ç°å¼‚æ­¥ï¼Œåˆ™éœ€è¦ç”¨åˆ° RxJava çš„å¦ä¸€ä¸ªæ¦‚å¿µï¼š Scheduler ã€‚ 3. çº¿ç¨‹æ§åˆ¶ â€”â€” Scheduler (ä¸€)åœ¨ä¸æŒ‡å®šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œ RxJava éµå¾ªçš„æ˜¯çº¿ç¨‹ä¸å˜çš„åŸåˆ™ï¼Œå³ï¼šåœ¨å“ªä¸ªçº¿ç¨‹è°ƒç”¨ subscribe()ï¼Œå°±åœ¨å“ªä¸ªçº¿ç¨‹ç”Ÿäº§äº‹ä»¶ï¼›åœ¨å“ªä¸ªçº¿ç¨‹ç”Ÿäº§äº‹ä»¶ï¼Œå°±åœ¨å“ªä¸ªçº¿ç¨‹æ¶ˆè´¹äº‹ä»¶ã€‚å¦‚æœéœ€è¦åˆ‡æ¢çº¿ç¨‹ï¼Œå°±éœ€è¦ç”¨åˆ° Scheduler ï¼ˆè°ƒåº¦å™¨ï¼‰ã€‚ 1) Scheduler çš„ API (ä¸€)åœ¨RxJava ä¸­ï¼ŒScheduler â€”â€”è°ƒåº¦å™¨ï¼Œç›¸å½“äºçº¿ç¨‹æ§åˆ¶å™¨ï¼ŒRxJava é€šè¿‡å®ƒæ¥æŒ‡å®šæ¯ä¸€æ®µä»£ç åº”è¯¥è¿è¡Œåœ¨ä»€ä¹ˆæ ·çš„çº¿ç¨‹ã€‚RxJava å·²ç»å†…ç½®äº†å‡ ä¸ª Scheduler ï¼Œå®ƒä»¬å·²ç»é€‚åˆå¤§å¤šæ•°çš„ä½¿ç”¨åœºæ™¯ï¼š Schedulers.immediate(): ç›´æ¥åœ¨å½“å‰çº¿ç¨‹è¿è¡Œï¼Œç›¸å½“äºä¸æŒ‡å®šçº¿ç¨‹ã€‚è¿™æ˜¯é»˜è®¤çš„ Schedulerã€‚ Schedulers.newThread(): æ€»æ˜¯å¯ç”¨æ–°çº¿ç¨‹ï¼Œå¹¶åœ¨æ–°çº¿ç¨‹æ‰§è¡Œæ“ä½œã€‚ Schedulers.io(): I/O æ“ä½œï¼ˆè¯»å†™æ–‡ä»¶ã€è¯»å†™æ•°æ®åº“ã€ç½‘ç»œä¿¡æ¯äº¤äº’ç­‰ï¼‰æ‰€ä½¿ç”¨çš„ Schedulerã€‚è¡Œä¸ºæ¨¡å¼å’Œ newThread() å·®ä¸å¤šï¼ŒåŒºåˆ«åœ¨äº io() çš„å†…éƒ¨å®ç°æ˜¯æ˜¯ç”¨ä¸€ä¸ªæ— æ•°é‡ä¸Šé™çš„çº¿ç¨‹æ± ï¼Œå¯ä»¥é‡ç”¨ç©ºé—²çš„çº¿ç¨‹ï¼Œå› æ­¤å¤šæ•°æƒ…å†µä¸‹ io() æ¯” newThread() æ›´æœ‰æ•ˆç‡ã€‚ä¸è¦æŠŠè®¡ç®—å·¥ä½œæ”¾åœ¨ io() ä¸­ï¼Œå¯ä»¥é¿å…åˆ›å»ºä¸å¿…è¦çš„çº¿ç¨‹ã€‚ Schedulers.computation(): è®¡ç®—æ‰€ä½¿ç”¨çš„ Schedulerã€‚è¿™ä¸ªè®¡ç®—æŒ‡çš„æ˜¯ CPU å¯†é›†å‹è®¡ç®—ï¼Œå³ä¸ä¼šè¢« I/O ç­‰æ“ä½œé™åˆ¶æ€§èƒ½çš„æ“ä½œï¼Œä¾‹å¦‚å›¾å½¢çš„è®¡ç®—ã€‚è¿™ä¸ª Scheduler ä½¿ç”¨çš„å›ºå®šçš„çº¿ç¨‹æ± ï¼Œå¤§å°ä¸º CPU æ ¸æ•°ã€‚ä¸è¦æŠŠ I/O æ“ä½œæ”¾åœ¨ computation() ä¸­ï¼Œå¦åˆ™ I/O æ“ä½œçš„ç­‰å¾…æ—¶é—´ä¼šæµªè´¹ CPUã€‚ å¦å¤–ï¼Œ Android è¿˜æœ‰ä¸€ä¸ªä¸“ç”¨çš„ AndroidSchedulers.mainThread()ï¼Œå®ƒæŒ‡å®šçš„æ“ä½œå°†åœ¨ Android ä¸»çº¿ç¨‹è¿è¡Œã€‚ æœ‰äº†è¿™å‡ ä¸ª Scheduler ï¼Œå°±å¯ä»¥ä½¿ç”¨ subscribeOn() å’Œ observeOn() ä¸¤ä¸ªæ–¹æ³•æ¥å¯¹çº¿ç¨‹è¿›è¡Œæ§åˆ¶äº†ã€‚ subscribeOn(): æŒ‡å®š subscribe() æ‰€å‘ç”Ÿçš„çº¿ç¨‹ï¼Œå³ Observable.OnSubscribe è¢«æ¿€æ´»æ—¶æ‰€å¤„çš„çº¿ç¨‹ã€‚æˆ–è€…å«åšäº‹ä»¶äº§ç”Ÿçš„çº¿ç¨‹ã€‚ observeOn(): æŒ‡å®š Subscriber æ‰€è¿è¡Œåœ¨çš„çº¿ç¨‹ã€‚æˆ–è€…å«åšäº‹ä»¶æ¶ˆè´¹çš„çº¿ç¨‹ã€‚ æ–‡å­—å™è¿°æ€»å½’éš¾ç†è§£ï¼Œä¸Šä»£ç ï¼š 123456789Observable.just(1, 2, 3, 4) .subscribeOn(Schedulers.io()) // æŒ‡å®š subscribe() å‘ç”Ÿåœ¨ IO çº¿ç¨‹ .observeOn(AndroidSchedulers.mainThread()) // æŒ‡å®š Subscriber çš„å›è°ƒå‘ç”Ÿåœ¨ä¸»çº¿ç¨‹ .subscribe(new Action1&lt;Integer&gt;() &#123; @Override public void call(Integer number) &#123; Log.d(tag, \"number:\" + number); &#125; &#125;); ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œç”±äº subscribeOn(Schedulers.io()) çš„æŒ‡å®šï¼Œè¢«åˆ›å»ºçš„äº‹ä»¶çš„å†…å®¹ 1ã€2ã€3ã€4 å°†ä¼šåœ¨ IOçº¿ç¨‹ å‘å‡ºï¼›è€Œç”±äº observeOn(AndroidScheculers.mainThread()) çš„æŒ‡å®šï¼Œå› æ­¤ subscriber æ•°å­—çš„æ‰“å°å°†å‘ç”Ÿåœ¨ä¸»çº¿ç¨‹ ã€‚äº‹å®ä¸Šï¼Œè¿™ç§åœ¨ subscribe() ä¹‹å‰å†™ä¸Šä¸¤å¥ subscribeOn(Scheduler.io()) å’Œ observeOn(AndroidSchedulers.mainThread()) çš„ä½¿ç”¨æ–¹å¼éå¸¸å¸¸è§ï¼Œå®ƒé€‚ç”¨äºå¤šæ•°çš„ ã€åå°çº¿ç¨‹å–æ•°æ®ï¼Œä¸»çº¿ç¨‹æ˜¾ç¤ºã€çš„ç¨‹åºç­–ç•¥ã€‚ è€Œå‰é¢æåˆ°çš„ç”±å›¾ç‰‡ id å–å¾—å›¾ç‰‡å¹¶æ˜¾ç¤ºçš„ä¾‹å­ï¼Œå¦‚æœä¹ŸåŠ ä¸Šè¿™ä¸¤å¥ï¼š 123456789101112131415161718192021222324252627int drawableRes = ...;ImageView imageView = ...;Observable.create(new OnSubscribe&lt;Drawable&gt;() &#123; @Override public void call(Subscriber&lt;? super Drawable&gt; subscriber) &#123; Drawable drawable = getTheme().getDrawable(drawableRes)); subscriber.onNext(drawable); subscriber.onCompleted(); &#125;&#125;).subscribeOn(Schedulers.io()) // æŒ‡å®š subscribe() å‘ç”Ÿåœ¨ IO çº¿ç¨‹.observeOn(AndroidSchedulers.mainThread()) // æŒ‡å®š Subscriber çš„å›è°ƒå‘ç”Ÿåœ¨ä¸»çº¿ç¨‹.subscribe(new Observer&lt;Drawable&gt;() &#123; @Override public void onNext(Drawable drawable) &#123; imageView.setImageDrawable(drawable); &#125; @Override public void onCompleted() &#123; &#125; @Override public void onError(Throwable e) &#123; Toast.makeText(activity, \"Error!\", Toast.LENGTH_SHORT).show(); &#125;&#125;); é‚£ä¹ˆï¼ŒåŠ è½½å›¾ç‰‡å°†ä¼šå‘ç”Ÿåœ¨ IO çº¿ç¨‹ï¼Œè€Œè®¾ç½®å›¾ç‰‡åˆ™è¢«è®¾å®šåœ¨äº†ä¸»çº¿ç¨‹ã€‚è¿™å°±æ„å‘³ç€ï¼Œå³ä½¿åŠ è½½å›¾ç‰‡è€—è´¹äº†å‡ åç”šè‡³å‡ ç™¾æ¯«ç§’çš„æ—¶é—´ï¼Œä¹Ÿä¸ä¼šé€ æˆä¸æ¯«ç•Œé¢çš„å¡é¡¿ã€‚ 2) Scheduler çš„åŸç† (ä¸€)RxJava çš„ Scheduler API å¾ˆæ–¹ä¾¿ï¼Œä¹Ÿå¾ˆç¥å¥‡ï¼ˆåŠ äº†ä¸€å¥è¯å°±æŠŠçº¿ç¨‹åˆ‡æ¢äº†ï¼Œæ€ä¹ˆåšåˆ°çš„ï¼Ÿè€Œä¸” subscribe() ä¸æ˜¯æœ€å¤–å±‚ç›´æ¥è°ƒç”¨çš„æ–¹æ³•å—ï¼Œå®ƒç«Ÿç„¶ä¹Ÿèƒ½è¢«æŒ‡å®šçº¿ç¨‹ï¼Ÿï¼‰ã€‚ç„¶è€Œ Scheduler çš„åŸç†éœ€è¦æ”¾åœ¨åé¢è®²ï¼Œå› ä¸ºå®ƒçš„åŸç†æ˜¯ä»¥ä¸‹ä¸€èŠ‚ã€Šå˜æ¢ã€‹çš„åŸç†ä½œä¸ºåŸºç¡€çš„ã€‚ å¥½å§è¿™ä¸€èŠ‚å…¶å®æˆ‘å±ä¹Ÿæ²¡è¯´ï¼Œåªæ˜¯ä¸ºäº†è®©ä½ å®‰å¿ƒï¼Œè®©ä½ çŸ¥é“æˆ‘ä¸æ˜¯å¿˜äº†è®²åŸç†ï¼Œè€Œæ˜¯æŠŠå®ƒæ”¾åœ¨äº†æ›´åˆé€‚çš„åœ°æ–¹ã€‚ 4. å˜æ¢ç»ˆäºè¦åˆ°ç‰›é€¼çš„åœ°æ–¹äº†ï¼Œä¸ç®¡ä½ æ¿€åŠ¨ä¸æ¿€åŠ¨ï¼Œåæ­£æˆ‘æ˜¯æ¿€åŠ¨äº†ã€‚ RxJava æä¾›äº†å¯¹äº‹ä»¶åºåˆ—è¿›è¡Œå˜æ¢çš„æ”¯æŒï¼Œè¿™æ˜¯å®ƒçš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯å¤§å¤šæ•°äººè¯´ã€RxJava çœŸæ˜¯å¤ªå¥½ç”¨äº†ã€çš„æœ€å¤§åŸå› ã€‚æ‰€è°“å˜æ¢ï¼Œå°±æ˜¯å°†äº‹ä»¶åºåˆ—ä¸­çš„å¯¹è±¡æˆ–æ•´ä¸ªåºåˆ—è¿›è¡ŒåŠ å·¥å¤„ç†ï¼Œè½¬æ¢æˆä¸åŒçš„äº‹ä»¶æˆ–äº‹ä»¶åºåˆ—ã€‚æ¦‚å¿µè¯´ç€æ€»æ˜¯æ¨¡ç³Šéš¾æ‡‚çš„ï¼Œæ¥çœ‹ APIã€‚ 1) APIé¦–å…ˆçœ‹ä¸€ä¸ª map() çš„ä¾‹å­ï¼š 12345678910111213Observable.just(\"images/logo.png\") // è¾“å…¥ç±»å‹ String .map(new Func1&lt;String, Bitmap&gt;() &#123; @Override public Bitmap call(String filePath) &#123; // å‚æ•°ç±»å‹ String return getBitmapFromPath(filePath); // è¿”å›ç±»å‹ Bitmap &#125; &#125;) .subscribe(new Action1&lt;Bitmap&gt;() &#123; @Override public void call(Bitmap bitmap) &#123; // å‚æ•°ç±»å‹ Bitmap showBitmap(bitmap); &#125; &#125;); è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªå«åš Func1 çš„ç±»ã€‚å®ƒå’Œ Action1 éå¸¸ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯ RxJava çš„ä¸€ä¸ªæ¥å£ï¼Œç”¨äºåŒ…è£…å«æœ‰ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•ã€‚ Func1 å’Œ Action çš„åŒºåˆ«åœ¨äºï¼Œ Func1 åŒ…è£…çš„æ˜¯æœ‰è¿”å›å€¼çš„æ–¹æ³•ã€‚å¦å¤–ï¼Œå’Œ ActionX ä¸€æ ·ï¼Œ FuncX ä¹Ÿæœ‰å¤šä¸ªï¼Œç”¨äºä¸åŒå‚æ•°ä¸ªæ•°çš„æ–¹æ³•ã€‚FuncX å’Œ ActionX çš„åŒºåˆ«åœ¨ FuncX åŒ…è£…çš„æ˜¯æœ‰è¿”å›å€¼çš„æ–¹æ³•ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œmap() æ–¹æ³•å°†å‚æ•°ä¸­çš„ String å¯¹è±¡è½¬æ¢æˆä¸€ä¸ª Bitmap å¯¹è±¡åè¿”å›ï¼Œè€Œåœ¨ç»è¿‡ map() æ–¹æ³•åï¼Œäº‹ä»¶çš„å‚æ•°ç±»å‹ä¹Ÿç”± String è½¬ä¸ºäº† Bitmapã€‚è¿™ç§ç›´æ¥å˜æ¢å¯¹è±¡å¹¶è¿”å›çš„ï¼Œæ˜¯æœ€å¸¸è§çš„ä¹Ÿæœ€å®¹æ˜“ç†è§£çš„å˜æ¢ã€‚ä¸è¿‡ RxJava çš„å˜æ¢è¿œä¸æ­¢è¿™æ ·ï¼Œå®ƒä¸ä»…å¯ä»¥é’ˆå¯¹äº‹ä»¶å¯¹è±¡ï¼Œè¿˜å¯ä»¥é’ˆå¯¹æ•´ä¸ªäº‹ä»¶é˜Ÿåˆ—ï¼Œè¿™ä½¿å¾— RxJava å˜å¾—éå¸¸çµæ´»ã€‚æˆ‘åˆ—ä¸¾å‡ ä¸ªå¸¸ç”¨çš„å˜æ¢ï¼š map(): äº‹ä»¶å¯¹è±¡çš„ç›´æ¥å˜æ¢ï¼Œå…·ä½“åŠŸèƒ½ä¸Šé¢å·²ç»ä»‹ç»è¿‡ã€‚å®ƒæ˜¯ RxJava æœ€å¸¸ç”¨çš„å˜æ¢ã€‚ map() çš„ç¤ºæ„å›¾ï¼š flatMap(): è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨ä½†éå¸¸éš¾ç†è§£çš„å˜æ¢ï¼Œå› æ­¤æˆ‘å†³å®šèŠ±å¤šäº›ç¯‡å¹…æ¥ä»‹ç»å®ƒã€‚ é¦–å…ˆå‡è®¾è¿™ä¹ˆä¸€ç§éœ€æ±‚ï¼šå‡è®¾æœ‰ä¸€ä¸ªæ•°æ®ç»“æ„ã€å­¦ç”Ÿã€ï¼Œç°åœ¨éœ€è¦æ‰“å°å‡ºä¸€ç»„å­¦ç”Ÿçš„åå­—ã€‚å®ç°æ–¹å¼å¾ˆç®€å•ï¼š 12345678910111213141516Student[] students = ...;Subscriber&lt;String&gt; subscriber = new Subscriber&lt;String&gt;() &#123; @Override public void onNext(String name) &#123; Log.d(tag, name); &#125; ...&#125;;Observable.from(students) .map(new Func1&lt;Student, String&gt;() &#123; @Override public String call(Student student) &#123; return student.getName(); &#125; &#125;) .subscribe(subscriber); å¾ˆç®€å•ã€‚é‚£ä¹ˆå†å‡è®¾ï¼šå¦‚æœè¦æ‰“å°å‡ºæ¯ä¸ªå­¦ç”Ÿæ‰€éœ€è¦ä¿®çš„æ‰€æœ‰è¯¾ç¨‹çš„åç§°å‘¢ï¼Ÿï¼ˆéœ€æ±‚çš„åŒºåˆ«åœ¨äºï¼Œæ¯ä¸ªå­¦ç”Ÿåªæœ‰ä¸€ä¸ªåå­—ï¼Œä½†å´æœ‰å¤šä¸ªè¯¾ç¨‹ã€‚ï¼‰é¦–å…ˆå¯ä»¥è¿™æ ·å®ç°ï¼š 1234567891011121314Student[] students = ...;Subscriber&lt;Student&gt; subscriber = new Subscriber&lt;Student&gt;() &#123; @Override public void onNext(Student student) &#123; List&lt;Course&gt; courses = student.getCourses(); for (int i = 0; i &lt; courses.size(); i++) &#123; Course course = courses.get(i); Log.d(tag, course.getName()); &#125; &#125; ...&#125;;Observable.from(students) .subscribe(subscriber); ä¾ç„¶å¾ˆç®€å•ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä¸æƒ³åœ¨ Subscriber ä¸­ä½¿ç”¨ for å¾ªç¯ï¼Œè€Œæ˜¯å¸Œæœ› Subscriber ä¸­ç›´æ¥ä¼ å…¥å•ä¸ªçš„ Course å¯¹è±¡å‘¢ï¼ˆè¿™å¯¹äºä»£ç å¤ç”¨å¾ˆé‡è¦ï¼‰ï¼Ÿç”¨ map() æ˜¾ç„¶æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸º map() æ˜¯ä¸€å¯¹ä¸€çš„è½¬åŒ–ï¼Œè€Œæˆ‘ç°åœ¨çš„è¦æ±‚æ˜¯ä¸€å¯¹å¤šçš„è½¬åŒ–ã€‚é‚£æ€ä¹ˆæ‰èƒ½æŠŠä¸€ä¸ª Student è½¬åŒ–æˆå¤šä¸ª Course å‘¢ï¼Ÿ è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦ç”¨ flatMap() äº†ï¼š 12345678910111213141516Student[] students = ...;Subscriber&lt;Course&gt; subscriber = new Subscriber&lt;Course&gt;() &#123; @Override public void onNext(Course course) &#123; Log.d(tag, course.getName()); &#125; ...&#125;;Observable.from(students) .flatMap(new Func1&lt;Student, Observable&lt;Course&gt;&gt;() &#123; @Override public Observable&lt;Course&gt; call(Student student) &#123; return Observable.from(student.getCourses()); &#125; &#125;) .subscribe(subscriber); ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œ flatMap() å’Œ map() æœ‰ä¸€ä¸ªç›¸åŒç‚¹ï¼šå®ƒä¹Ÿæ˜¯æŠŠä¼ å…¥çš„å‚æ•°è½¬åŒ–ä¹‹åè¿”å›å¦ä¸€ä¸ªå¯¹è±¡ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œå’Œ map() ä¸åŒçš„æ˜¯ï¼Œ flatMap() ä¸­è¿”å›çš„æ˜¯ä¸ª Observable å¯¹è±¡ï¼Œå¹¶ä¸”è¿™ä¸ª Observable å¯¹è±¡å¹¶ä¸æ˜¯è¢«ç›´æ¥å‘é€åˆ°äº† Subscriber çš„å›è°ƒæ–¹æ³•ä¸­ã€‚ flatMap() çš„åŸç†æ˜¯è¿™æ ·çš„ï¼š ä½¿ç”¨ä¼ å…¥çš„äº‹ä»¶å¯¹è±¡åˆ›å»ºä¸€ä¸ª Observable å¯¹è±¡ï¼› å¹¶ä¸å‘é€è¿™ä¸ª Observable, è€Œæ˜¯å°†å®ƒæ¿€æ´»ï¼Œäºæ˜¯å®ƒå¼€å§‹å‘é€äº‹ä»¶ï¼› æ¯ä¸€ä¸ªåˆ›å»ºå‡ºæ¥çš„ Observable å‘é€çš„äº‹ä»¶ï¼Œéƒ½è¢«æ±‡å…¥åŒä¸€ä¸ª Observable ï¼Œè€Œè¿™ä¸ª Observable è´Ÿè´£å°†è¿™äº›äº‹ä»¶ç»Ÿä¸€äº¤ç»™ Subscriber çš„å›è°ƒæ–¹æ³•ã€‚ è¿™ä¸‰ä¸ªæ­¥éª¤ï¼ŒæŠŠäº‹ä»¶æ‹†æˆäº†ä¸¤çº§ï¼Œé€šè¿‡ä¸€ç»„æ–°åˆ›å»ºçš„ Observable å°†åˆå§‹çš„å¯¹è±¡ã€é“ºå¹³ã€ä¹‹åé€šè¿‡ç»Ÿä¸€è·¯å¾„åˆ†å‘äº†ä¸‹å»ã€‚è€Œè¿™ä¸ªã€é“ºå¹³ã€å°±æ˜¯ flatMap() æ‰€è°“çš„ flatã€‚ flatMap() ç¤ºæ„å›¾ï¼š æ‰©å±•ï¼šç”±äºå¯ä»¥åœ¨åµŒå¥—çš„ Observable ä¸­æ·»åŠ å¼‚æ­¥ä»£ç ï¼Œ flatMap() ä¹Ÿå¸¸ç”¨äºåµŒå¥—çš„å¼‚æ­¥æ“ä½œï¼Œä¾‹å¦‚åµŒå¥—çš„ç½‘ç»œè¯·æ±‚ã€‚ç¤ºä¾‹ä»£ç ï¼ˆRetrofit + RxJavaï¼‰ï¼š 123456789101112131415networkClient.token() // è¿”å› Observable&lt;String&gt;ï¼Œåœ¨è®¢é˜…æ—¶è¯·æ±‚ tokenï¼Œå¹¶åœ¨å“åº”åå‘é€ token .flatMap(new Func1&lt;String, Observable&lt;Messages&gt;&gt;() &#123; @Override public Observable&lt;Messages&gt; call(String token) &#123; // è¿”å› Observable&lt;Messages&gt;ï¼Œåœ¨è®¢é˜…æ—¶è¯·æ±‚æ¶ˆæ¯åˆ—è¡¨ï¼Œå¹¶åœ¨å“åº”åå‘é€è¯·æ±‚åˆ°çš„æ¶ˆæ¯åˆ—è¡¨ return networkClient.messages(); &#125; &#125;) .subscribe(new Action1&lt;Messages&gt;() &#123; @Override public void call(Messages messages) &#123; // å¤„ç†æ˜¾ç¤ºæ¶ˆæ¯åˆ—è¡¨ showMessages(messages); &#125; &#125;); ä¼ ç»Ÿçš„åµŒå¥—è¯·æ±‚éœ€è¦ä½¿ç”¨åµŒå¥—çš„ Callback æ¥å®ç°ã€‚è€Œé€šè¿‡ flatMap() ï¼Œå¯ä»¥æŠŠåµŒå¥—çš„è¯·æ±‚å†™åœ¨ä¸€æ¡é“¾ä¸­ï¼Œä»è€Œä¿æŒç¨‹åºé€»è¾‘çš„æ¸…æ™°ã€‚ throttleFirst() : åœ¨æ¯æ¬¡äº‹ä»¶è§¦å‘åçš„ä¸€å®šæ—¶é—´é—´éš”å†…ä¸¢å¼ƒæ–°çš„äº‹ä»¶ã€‚å¸¸ç”¨ä½œå»æŠ–åŠ¨è¿‡æ»¤ï¼Œä¾‹å¦‚æŒ‰é’®çš„ç‚¹å‡»ç›‘å¬å™¨ï¼š 12RxView.clickEvents(button) // RxBinding ä»£ç ï¼Œåé¢çš„æ–‡ç« æœ‰è§£é‡Š .throttleFirst(500, TimeUnit.MILLISECONDS) // è®¾ç½®é˜²æŠ–é—´éš”ä¸º 500ms .subscribe(subscriber); å¦ˆå¦ˆå†ä¹Ÿä¸æ€•æˆ‘çš„ç”¨æˆ·æ‰‹æŠ–ç‚¹å¼€ä¸¤ä¸ªé‡å¤çš„ç•Œé¢å•¦ã€‚ æ­¤å¤–ï¼Œ RxJava è¿˜æä¾›å¾ˆå¤šä¾¿æ·çš„æ–¹æ³•æ¥å®ç°äº‹ä»¶åºåˆ—çš„å˜æ¢ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº†ã€‚ 2) å˜æ¢çš„åŸç†ï¼šlift()è¿™äº›å˜æ¢è™½ç„¶åŠŸèƒ½å„æœ‰ä¸åŒï¼Œä½†å®è´¨ä¸Šéƒ½æ˜¯é’ˆå¯¹äº‹ä»¶åºåˆ—çš„å¤„ç†å’Œå†å‘é€ã€‚è€Œåœ¨ RxJava çš„å†…éƒ¨ï¼Œå®ƒä»¬æ˜¯åŸºäºåŒä¸€ä¸ªåŸºç¡€çš„å˜æ¢æ–¹æ³•ï¼š lift(Operator)ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹ lift() çš„å†…éƒ¨å®ç°ï¼ˆä»…æ ¸å¿ƒä»£ç ï¼‰ï¼š 123456789101112// æ³¨æ„ï¼šè¿™ä¸æ˜¯ lift() çš„æºç ï¼Œè€Œæ˜¯å°†æºç ä¸­ä¸æ€§èƒ½ã€å…¼å®¹æ€§ã€æ‰©å±•æ€§æœ‰å…³çš„ä»£ç å‰”é™¤åçš„æ ¸å¿ƒä»£ç ã€‚// å¦‚æœéœ€è¦çœ‹æºç ï¼Œå¯ä»¥å» RxJava çš„ GitHub ä»“åº“ä¸‹è½½ã€‚public &lt;R&gt; Observable&lt;R&gt; lift(Operator&lt;? extends R, ? super T&gt; operator) &#123; return Observable.create(new OnSubscribe&lt;R&gt;() &#123; @Override public void call(Subscriber subscriber) &#123; Subscriber newSubscriber = operator.call(subscriber); newSubscriber.onStart(); onSubscribe.call(newSubscriber); &#125; &#125;);&#125; è¿™æ®µä»£ç å¾ˆæœ‰æ„æ€ï¼šå®ƒç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„ Observable å¹¶è¿”å›ï¼Œè€Œä¸”åˆ›å»ºæ–° Observable æ‰€ç”¨çš„å‚æ•° OnSubscribe çš„å›è°ƒæ–¹æ³• call() ä¸­çš„å®ç°ç«Ÿç„¶çœ‹èµ·æ¥å’Œå‰é¢è®²è¿‡çš„ Observable.subscribe() ä¸€æ ·ï¼ç„¶è€Œå®ƒä»¬å¹¶ä¸ä¸€æ ·å“Ÿ~ä¸ä¸€æ ·çš„åœ°æ–¹å…³é”®å°±åœ¨äºç¬¬äºŒè¡Œ onSubscribe.call(subscriber) ä¸­çš„ onSubscribe æ‰€æŒ‡ä»£çš„å¯¹è±¡ä¸åŒï¼ˆé«˜èƒ½é¢„è­¦ï¼šæ¥ä¸‹æ¥çš„å‡ å¥è¯å¯èƒ½ä¼šå¯¼è‡´èº«ä½“çš„ä¸¥é‡ä¸é€‚ï¼‰â€”â€” subscribe() ä¸­è¿™å¥è¯çš„ onSubscribe æŒ‡çš„æ˜¯ Observable ä¸­çš„ onSubscribe å¯¹è±¡ï¼Œè¿™ä¸ªæ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ lift() ä¹‹åçš„æƒ…å†µå°±å¤æ‚äº†ç‚¹ã€‚ å½“å«æœ‰ lift() æ—¶ï¼š lift() åˆ›å»ºäº†ä¸€ä¸ª Observable åï¼ŒåŠ ä¸Šä¹‹å‰çš„åŸå§‹ Observableï¼Œå·²ç»æœ‰ä¸¤ä¸ª Observable äº†ï¼› è€ŒåŒæ ·åœ°ï¼Œæ–° Observable é‡Œçš„æ–° OnSubscribe åŠ ä¸Šä¹‹å‰çš„åŸå§‹ Observable ä¸­çš„åŸå§‹ OnSubscribeï¼Œä¹Ÿå°±æœ‰äº†ä¸¤ä¸ª OnSubscribeï¼› å½“ç”¨æˆ·è°ƒç”¨ç»è¿‡ lift() åçš„ Observable çš„ subscribe() çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯ lift() æ‰€è¿”å›çš„æ–°çš„ Observable ï¼Œäºæ˜¯å®ƒæ‰€è§¦å‘çš„ onSubscribe.call(subscriber)ï¼Œä¹Ÿæ˜¯ç”¨çš„æ–° Observable ä¸­çš„æ–° OnSubscribeï¼Œå³åœ¨ lift() ä¸­ç”Ÿæˆçš„é‚£ä¸ª OnSubscribeï¼› è€Œè¿™ä¸ªæ–° OnSubscribe çš„ call() æ–¹æ³•ä¸­çš„ onSubscribe ï¼Œå°±æ˜¯æŒ‡çš„åŸå§‹ Observable ä¸­çš„åŸå§‹ OnSubscribe ï¼Œåœ¨è¿™ä¸ª call() æ–¹æ³•é‡Œï¼Œæ–° OnSubscribe åˆ©ç”¨ operator.call(subscriber) ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„ Subscriberï¼ˆOperator å°±æ˜¯åœ¨è¿™é‡Œï¼Œé€šè¿‡è‡ªå·±çš„ call() æ–¹æ³•å°†æ–° Subscriber å’ŒåŸå§‹ Subscriber è¿›è¡Œå…³è”ï¼Œå¹¶æ’å…¥è‡ªå·±çš„ã€å˜æ¢ã€ä»£ç ä»¥å®ç°å˜æ¢ï¼‰ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªæ–° Subscriber å‘åŸå§‹ Observable è¿›è¡Œè®¢é˜…ã€‚è¿™æ ·å°±å®ç°äº† lift() è¿‡ç¨‹ï¼Œæœ‰ç‚¹åƒä¸€ç§ä»£ç†æœºåˆ¶ï¼Œé€šè¿‡äº‹ä»¶æ‹¦æˆªå’Œå¤„ç†å®ç°äº‹ä»¶åºåˆ—çš„å˜æ¢ã€‚ ç²¾ç®€æ‰ç»†èŠ‚çš„è¯ï¼Œä¹Ÿå¯ä»¥è¿™ä¹ˆè¯´ï¼šåœ¨ Observable æ‰§è¡Œäº† lift(Operator) æ–¹æ³•ä¹‹åï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Observableï¼Œè¿™ä¸ªæ–°çš„ Observable ä¼šåƒä¸€ä¸ªä»£ç†ä¸€æ ·ï¼Œè´Ÿè´£æ¥æ”¶åŸå§‹çš„ Observable å‘å‡ºçš„äº‹ä»¶ï¼Œå¹¶åœ¨å¤„ç†åå‘é€ç»™ Subscriberã€‚ å¦‚æœä½ æ›´å–œæ¬¢å…·è±¡æ€ç»´ï¼Œå¯ä»¥çœ‹å›¾ï¼š æˆ–è€…å¯ä»¥çœ‹åŠ¨å›¾ï¼š ä¸¤æ¬¡å’Œå¤šæ¬¡çš„ lift() åŒç†ï¼Œå¦‚ä¸‹å›¾ï¼š ä¸¾ä¸€ä¸ªå…·ä½“çš„ Operator çš„å®ç°ã€‚ä¸‹é¢è¿™æ˜¯ä¸€ä¸ªå°†äº‹ä»¶ä¸­çš„ Integer å¯¹è±¡è½¬æ¢æˆ String çš„ä¾‹å­ï¼Œä»…ä¾›å‚è€ƒï¼š 12345678910111213141516171819202122observable.lift(new Observable.Operator&lt;String, Integer&gt;() &#123; @Override public Subscriber&lt;? super Integer&gt; call(final Subscriber&lt;? super String&gt; subscriber) &#123; // å°†äº‹ä»¶åºåˆ—ä¸­çš„ Integer å¯¹è±¡è½¬æ¢ä¸º String å¯¹è±¡ return new Subscriber&lt;Integer&gt;() &#123; @Override public void onNext(Integer integer) &#123; subscriber.onNext(\"\" + integer); &#125; @Override public void onCompleted() &#123; subscriber.onCompleted(); &#125; @Override public void onError(Throwable e) &#123; subscriber.onError(e); &#125; &#125;; &#125;&#125;); è®²è¿° lift() çš„åŸç†åªæ˜¯ä¸ºäº†è®©ä½ æ›´å¥½åœ°äº†è§£ RxJava ï¼Œä»è€Œå¯ä»¥æ›´å¥½åœ°ä½¿ç”¨å®ƒã€‚ç„¶è€Œä¸ç®¡ä½ æ˜¯å¦ç†è§£äº† lift() çš„åŸç†ï¼ŒRxJava éƒ½ä¸å»ºè®®å¼€å‘è€…è‡ªå®šä¹‰ Operator æ¥ç›´æ¥ä½¿ç”¨ lift()ï¼Œè€Œæ˜¯å»ºè®®å°½é‡ä½¿ç”¨å·²æœ‰çš„ lift() åŒ…è£…æ–¹æ³•ï¼ˆå¦‚ map() flatMap() ç­‰ï¼‰è¿›è¡Œç»„åˆæ¥å®ç°éœ€æ±‚ï¼Œå› ä¸ºç›´æ¥ä½¿ç”¨ lift() éå¸¸å®¹æ˜“å‘ç”Ÿä¸€äº›éš¾ä»¥å‘ç°çš„é”™è¯¯ã€‚ 3) compose: å¯¹ Observable æ•´ä½“çš„å˜æ¢é™¤äº† lift() ä¹‹å¤–ï¼Œ Observable è¿˜æœ‰ä¸€ä¸ªå˜æ¢æ–¹æ³•å«åš compose(Transformer)ã€‚å®ƒå’Œ lift() çš„åŒºåˆ«åœ¨äºï¼Œ lift() æ˜¯é’ˆå¯¹äº‹ä»¶é¡¹å’Œäº‹ä»¶åºåˆ—çš„ï¼Œè€Œ compose() æ˜¯é’ˆå¯¹ Observable è‡ªèº«è¿›è¡Œå˜æ¢ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾åœ¨ç¨‹åºä¸­æœ‰å¤šä¸ª Observable ï¼Œå¹¶ä¸”ä»–ä»¬éƒ½éœ€è¦åº”ç”¨ä¸€ç»„ç›¸åŒçš„ lift() å˜æ¢ã€‚ä½ å¯ä»¥è¿™ä¹ˆå†™ï¼š 123456789101112131415161718192021222324observable1 .lift1() .lift2() .lift3() .lift4() .subscribe(subscriber1);observable2 .lift1() .lift2() .lift3() .lift4() .subscribe(subscriber2);observable3 .lift1() .lift2() .lift3() .lift4() .subscribe(subscriber3);observable4 .lift1() .lift2() .lift3() .lift4() .subscribe(subscriber1); ä½ è§‰å¾—è¿™æ ·å¤ªä¸è½¯ä»¶å·¥ç¨‹äº†ï¼Œäºæ˜¯ä½ æ”¹æˆäº†è¿™æ ·ï¼š 123456789101112private Observable liftAll(Observable observable) &#123; return observable .lift1() .lift2() .lift3() .lift4();&#125;...liftAll(observable1).subscribe(subscriber1);liftAll(observable2).subscribe(subscriber2);liftAll(observable3).subscribe(subscriber3);liftAll(observable4).subscribe(subscriber4); å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§éƒ½æé«˜äº†ã€‚å¯æ˜¯ Observable è¢«ä¸€ä¸ªæ–¹æ³•åŒ…èµ·æ¥ï¼Œè¿™ç§æ–¹å¼å¯¹äº Observale çš„çµæ´»æ€§ä¼¼ä¹è¿˜æ˜¯å¢æ·»äº†é‚£ä¹ˆç‚¹é™åˆ¶ã€‚æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªæ—¶å€™ï¼Œå°±åº”è¯¥ç”¨ compose() æ¥è§£å†³äº†ï¼š 12345678910111213141516public class LiftAllTransformer implements Observable.Transformer&lt;Integer, String&gt; &#123; @Override public Observable&lt;String&gt; call(Observable&lt;Integer&gt; observable) &#123; return observable .lift1() .lift2() .lift3() .lift4(); &#125;&#125;...Transformer liftAll = new LiftAllTransformer();observable1.compose(liftAll).subscribe(subscriber1);observable2.compose(liftAll).subscribe(subscriber2);observable3.compose(liftAll).subscribe(subscriber3);observable4.compose(liftAll).subscribe(subscriber4); åƒä¸Šé¢è¿™æ ·ï¼Œä½¿ç”¨ compose() æ–¹æ³•ï¼ŒObservable å¯ä»¥åˆ©ç”¨ä¼ å…¥çš„ Transformer å¯¹è±¡çš„ call() æ–¹æ³•ç›´æ¥å¯¹è‡ªèº«è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±ä¸å¿…è¢«åŒ…åœ¨æ–¹æ³•çš„é‡Œé¢äº†ã€‚ compose() çš„åŸç†æ¯”è¾ƒç®€å•ï¼Œä¸é™„å›¾å–½ã€‚ 5. çº¿ç¨‹æ§åˆ¶ï¼šScheduler (äºŒ)é™¤äº†çµæ´»çš„å˜æ¢ï¼ŒRxJava å¦ä¸€ä¸ªç‰›é€¼çš„åœ°æ–¹ï¼Œå°±æ˜¯çº¿ç¨‹çš„è‡ªç”±æ§åˆ¶ã€‚ 1) Scheduler çš„ API (äºŒ)å‰é¢è®²åˆ°äº†ï¼Œå¯ä»¥åˆ©ç”¨ subscribeOn() ç»“åˆ observeOn() æ¥å®ç°çº¿ç¨‹æ§åˆ¶ï¼Œè®©äº‹ä»¶çš„äº§ç”Ÿå’Œæ¶ˆè´¹å‘ç”Ÿåœ¨ä¸åŒçš„çº¿ç¨‹ã€‚å¯æ˜¯åœ¨äº†è§£äº† map()ã€ flatMap() ç­‰å˜æ¢æ–¹æ³•åï¼Œæœ‰äº›å¥½äº‹çš„ï¼ˆå…¶å®å°±æ˜¯å½“åˆåˆšæ¥è§¦ RxJava æ—¶çš„æˆ‘ï¼‰å°±é—®äº†ï¼šèƒ½ä¸èƒ½å¤šåˆ‡æ¢å‡ æ¬¡çº¿ç¨‹ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šèƒ½ã€‚å› ä¸º observeOn() æŒ‡å®šçš„æ˜¯ Subscriber çš„çº¿ç¨‹ï¼Œè€Œè¿™ä¸ª Subscriber å¹¶ä¸æ˜¯ï¼ˆä¸¥æ ¼è¯´åº”è¯¥ä¸ºã€ä¸ä¸€å®šæ˜¯ã€ï¼Œä½†è¿™é‡Œä¸å¦¨ç†è§£ä¸ºã€ä¸æ˜¯ã€ï¼‰subscribe() å‚æ•°ä¸­çš„ Subscriber ï¼Œè€Œæ˜¯ observeOn() æ‰§è¡Œæ—¶çš„å½“å‰ Observable æ‰€å¯¹åº”çš„ Subscriber ï¼Œå³å®ƒçš„ç›´æ¥ä¸‹çº§ Subscriber ã€‚æ¢å¥è¯è¯´ï¼ŒobserveOn() æŒ‡å®šçš„æ˜¯å®ƒä¹‹åçš„æ“ä½œæ‰€åœ¨çš„çº¿ç¨‹ã€‚å› æ­¤å¦‚æœæœ‰å¤šæ¬¡åˆ‡æ¢çº¿ç¨‹çš„éœ€æ±‚ï¼Œåªè¦åœ¨æ¯ä¸ªæƒ³è¦åˆ‡æ¢çº¿ç¨‹çš„ä½ç½®è°ƒç”¨ä¸€æ¬¡ observeOn() å³å¯ã€‚ä¸Šä»£ç ï¼š 12345678Observable.just(1, 2, 3, 4) // IO çº¿ç¨‹ï¼Œç”± subscribeOn() æŒ‡å®š .subscribeOn(Schedulers.io()) .observeOn(Schedulers.newThread()) .map(mapOperator) // æ–°çº¿ç¨‹ï¼Œç”± observeOn() æŒ‡å®š .observeOn(Schedulers.io()) .map(mapOperator2) // IO çº¿ç¨‹ï¼Œç”± observeOn() æŒ‡å®š .observeOn(AndroidSchedulers.mainThread) .subscribe(subscriber); // Android ä¸»çº¿ç¨‹ï¼Œç”± observeOn() æŒ‡å®š å¦‚ä¸Šï¼Œé€šè¿‡ observeOn() çš„å¤šæ¬¡è°ƒç”¨ï¼Œç¨‹åºå®ç°äº†çº¿ç¨‹çš„å¤šæ¬¡åˆ‡æ¢ã€‚ ä¸è¿‡ï¼Œä¸åŒäº observeOn() ï¼Œ subscribeOn() çš„ä½ç½®æ”¾åœ¨å“ªé‡Œéƒ½å¯ä»¥ï¼Œä½†å®ƒæ˜¯åªèƒ½è°ƒç”¨ä¸€æ¬¡çš„ã€‚ åˆæœ‰å¥½äº‹çš„ï¼ˆå…¶å®è¿˜æ˜¯å½“åˆçš„æˆ‘ï¼‰é—®äº†ï¼šå¦‚æœæˆ‘éè¦è°ƒç”¨å¤šæ¬¡ subscribeOn() å‘¢ï¼Ÿä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼Ÿ è¿™ä¸ªé—®é¢˜å…ˆæ”¾ç€ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä» RxJava çº¿ç¨‹æ§åˆ¶çš„åŸç†è¯´èµ·å§ã€‚ 2) Scheduler çš„åŸç†ï¼ˆäºŒï¼‰å…¶å®ï¼Œ subscribeOn() å’Œ observeOn() çš„å†…éƒ¨å®ç°ï¼Œä¹Ÿæ˜¯ç”¨çš„ lift()ã€‚å…·ä½“çœ‹å›¾ï¼ˆä¸åŒé¢œè‰²çš„ç®­å¤´è¡¨ç¤ºä¸åŒçš„çº¿ç¨‹ï¼‰ï¼š subscribeOn() åŸç†å›¾ï¼š observeOn() åŸç†å›¾ï¼š ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒsubscribeOn() å’Œ observeOn() éƒ½åšäº†çº¿ç¨‹åˆ‡æ¢çš„å·¥ä½œï¼ˆå›¾ä¸­çš„ â€œscheduleâ€¦â€ éƒ¨ä½ï¼‰ã€‚ä¸åŒçš„æ˜¯ï¼Œ subscribeOn() çš„çº¿ç¨‹åˆ‡æ¢å‘ç”Ÿåœ¨ OnSubscribe ä¸­ï¼Œå³åœ¨å®ƒé€šçŸ¥ä¸Šä¸€çº§ OnSubscribe æ—¶ï¼Œè¿™æ—¶äº‹ä»¶è¿˜æ²¡æœ‰å¼€å§‹å‘é€ï¼Œå› æ­¤ subscribeOn() çš„çº¿ç¨‹æ§åˆ¶å¯ä»¥ä»äº‹ä»¶å‘å‡ºçš„å¼€ç«¯å°±é€ æˆå½±å“ï¼›è€Œ observeOn() çš„çº¿ç¨‹åˆ‡æ¢åˆ™å‘ç”Ÿåœ¨å®ƒå†…å»ºçš„ Subscriber ä¸­ï¼Œå³å‘ç”Ÿåœ¨å®ƒå³å°†ç»™ä¸‹ä¸€çº§ Subscriber å‘é€äº‹ä»¶æ—¶ï¼Œå› æ­¤ observeOn() æ§åˆ¶çš„æ˜¯å®ƒåé¢çš„çº¿ç¨‹ã€‚ æœ€åï¼Œæˆ‘ç”¨ä¸€å¼ å›¾æ¥è§£é‡Šå½“å¤šä¸ª subscribeOn() å’Œ observeOn() æ··åˆä½¿ç”¨æ—¶ï¼Œçº¿ç¨‹è°ƒåº¦æ˜¯æ€ä¹ˆå‘ç”Ÿçš„ï¼ˆç”±äºå›¾ä¸­å¯¹è±¡è¾ƒå¤šï¼Œç›¸å¯¹äºä¸Šé¢çš„å›¾å¯¹ç»“æ„åšäº†ä¸€äº›ç®€åŒ–è°ƒæ•´ï¼‰ï¼š å›¾ä¸­å…±æœ‰ 5 å¤„å«æœ‰å¯¹äº‹ä»¶çš„æ“ä½œã€‚ç”±å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œâ‘ å’Œâ‘¡ä¸¤å¤„å—ç¬¬ä¸€ä¸ª subscribeOn() å½±å“ï¼Œè¿è¡Œåœ¨çº¢è‰²çº¿ç¨‹ï¼›â‘¢å’Œâ‘£å¤„å—ç¬¬ä¸€ä¸ª observeOn() çš„å½±å“ï¼Œè¿è¡Œåœ¨ç»¿è‰²çº¿ç¨‹ï¼›â‘¤å¤„å—ç¬¬äºŒä¸ª onserveOn() å½±å“ï¼Œè¿è¡Œåœ¨ç´«è‰²çº¿ç¨‹ï¼›è€Œç¬¬äºŒä¸ª subscribeOn() ï¼Œç”±äºåœ¨é€šçŸ¥è¿‡ç¨‹ä¸­çº¿ç¨‹å°±è¢«ç¬¬ä¸€ä¸ª subscribeOn() æˆªæ–­ï¼Œå› æ­¤å¯¹æ•´ä¸ªæµç¨‹å¹¶æ²¡æœ‰ä»»ä½•å½±å“ã€‚è¿™é‡Œä¹Ÿå°±å›ç­”äº†å‰é¢çš„é—®é¢˜ï¼šå½“ä½¿ç”¨äº†å¤šä¸ª subscribeOn() çš„æ—¶å€™ï¼Œåªæœ‰ç¬¬ä¸€ä¸ª subscribeOn() èµ·ä½œç”¨ã€‚ 3) å»¶ä¼¸ï¼šdoOnSubscribe()ç„¶è€Œï¼Œè™½ç„¶è¶…è¿‡ä¸€ä¸ªçš„ subscribeOn() å¯¹äº‹ä»¶å¤„ç†çš„æµç¨‹æ²¡æœ‰å½±å“ï¼Œä½†åœ¨æµç¨‹ä¹‹å‰å´æ˜¯å¯ä»¥åˆ©ç”¨çš„ã€‚ åœ¨å‰é¢è®² Subscriber çš„æ—¶å€™ï¼Œæåˆ°è¿‡ Subscriber çš„ onStart() å¯ä»¥ç”¨ä½œæµç¨‹å¼€å§‹å‰çš„åˆå§‹åŒ–ã€‚ç„¶è€Œ onStart() ç”±äºåœ¨ subscribe() å‘ç”Ÿæ—¶å°±è¢«è°ƒç”¨äº†ï¼Œå› æ­¤ä¸èƒ½æŒ‡å®šçº¿ç¨‹ï¼Œè€Œæ˜¯åªèƒ½æ‰§è¡Œåœ¨ subscribe() è¢«è°ƒç”¨æ—¶çš„çº¿ç¨‹ã€‚è¿™å°±å¯¼è‡´å¦‚æœ onStart() ä¸­å«æœ‰å¯¹çº¿ç¨‹æœ‰è¦æ±‚çš„ä»£ç ï¼ˆä¾‹å¦‚åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºä¸€ä¸ª ProgressBarï¼Œè¿™å¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼‰ï¼Œå°†ä¼šæœ‰çº¿ç¨‹éæ³•çš„é£é™©ï¼Œå› ä¸ºæœ‰æ—¶ä½ æ— æ³•é¢„æµ‹ subscribe() å°†ä¼šåœ¨ä»€ä¹ˆçº¿ç¨‹æ‰§è¡Œã€‚ è€Œä¸ Subscriber.onStart() ç›¸å¯¹åº”çš„ï¼Œæœ‰ä¸€ä¸ªæ–¹æ³• Observable.doOnSubscribe() ã€‚å®ƒå’Œ Subscriber.onStart() åŒæ ·æ˜¯åœ¨ subscribe() è°ƒç”¨åè€Œä¸”åœ¨äº‹ä»¶å‘é€å‰æ‰§è¡Œï¼Œä½†åŒºåˆ«åœ¨äºå®ƒå¯ä»¥æŒ‡å®šçº¿ç¨‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ doOnSubscribe() æ‰§è¡Œåœ¨ subscribe() å‘ç”Ÿçš„çº¿ç¨‹ï¼›è€Œå¦‚æœåœ¨ doOnSubscribe() ä¹‹åæœ‰ subscribeOn() çš„è¯ï¼Œå®ƒå°†æ‰§è¡Œåœ¨ç¦»å®ƒæœ€è¿‘çš„ subscribeOn() æ‰€æŒ‡å®šçš„çº¿ç¨‹ã€‚ ç¤ºä¾‹ä»£ç ï¼š 1234567891011Observable.create(onSubscribe) .subscribeOn(Schedulers.io()) .doOnSubscribe(new Action0() &#123; @Override public void call() &#123; progressBar.setVisibility(View.VISIBLE); // éœ€è¦åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ &#125; &#125;) .subscribeOn(AndroidSchedulers.mainThread()) // æŒ‡å®šä¸»çº¿ç¨‹ .observeOn(AndroidSchedulers.mainThread()) .subscribe(subscriber); å¦‚ä¸Šï¼Œåœ¨ doOnSubscribe()çš„åé¢è·Ÿä¸€ä¸ª subscribeOn() ï¼Œå°±èƒ½æŒ‡å®šå‡†å¤‡å·¥ä½œçš„çº¿ç¨‹äº†ã€‚ RxJava çš„é€‚ç”¨åœºæ™¯å’Œä½¿ç”¨æ–¹å¼1. ä¸ Retrofit çš„ç»“åˆ Retrofit æ˜¯ Square çš„ä¸€ä¸ªè‘—åçš„ç½‘ç»œè¯·æ±‚åº“ã€‚æ²¡æœ‰ç”¨è¿‡ Retrofit çš„å¯ä»¥é€‰æ‹©è·³è¿‡è¿™ä¸€å°èŠ‚ä¹Ÿæ²¡å…³ç³»ï¼Œæˆ‘ä¸¾çš„æ¯ç§åœºæ™¯éƒ½åªæ˜¯ä¸ªä¾‹å­ï¼Œè€Œä¸”ä¾‹å­ä¹‹é—´å¹¶æ— å‰åå…³è”ï¼Œåªæ˜¯ä¸ªæŠ›ç –å¼•ç‰çš„ä½œç”¨ï¼Œæ‰€ä»¥ä½ è·³è¿‡è¿™é‡Œçœ‹åˆ«çš„åœºæ™¯ä¹Ÿå¯ä»¥çš„ã€‚ Retrofit é™¤äº†æä¾›äº†ä¼ ç»Ÿçš„ Callback å½¢å¼çš„ APIï¼Œè¿˜æœ‰ RxJava ç‰ˆæœ¬çš„ Observable å½¢å¼ APIã€‚ä¸‹é¢æˆ‘ç”¨å¯¹æ¯”çš„æ–¹å¼æ¥ä»‹ç» Retrofit çš„ RxJava ç‰ˆ API å’Œä¼ ç»Ÿç‰ˆæœ¬çš„åŒºåˆ«ã€‚ ä»¥è·å–ä¸€ä¸ª User å¯¹è±¡çš„æ¥å£ä½œä¸ºä¾‹å­ã€‚ä½¿ç”¨Retrofit çš„ä¼ ç»Ÿ APIï¼Œä½ å¯ä»¥ç”¨è¿™æ ·çš„æ–¹å¼æ¥å®šä¹‰è¯·æ±‚ï¼š 12@GET(\"/user\")public void getUser(@Query(\"userId\") String userId, Callback&lt;User&gt; callback); åœ¨ç¨‹åºçš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œ Retrofit ä¼šæŠŠè‡ªåŠ¨æŠŠæ–¹æ³•å®ç°å¹¶ç”Ÿæˆä»£ç ï¼Œç„¶åå¼€å‘è€…å°±å¯ä»¥åˆ©ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥è·å–ç‰¹å®šç”¨æˆ·å¹¶å¤„ç†å“åº”ï¼š 123456789101112getUser(userId, new Callback&lt;User&gt;() &#123; @Override public void success(User user) &#123; userView.setUser(user); &#125; @Override public void failure(RetrofitError error) &#123; // Error handling ... &#125;&#125;; è€Œä½¿ç”¨ RxJava å½¢å¼çš„ APIï¼Œå®šä¹‰åŒæ ·çš„è¯·æ±‚æ˜¯è¿™æ ·çš„ï¼š 12@GET(\"/user\")public Observable&lt;User&gt; getUser(@Query(\"userId\") String userId); ä½¿ç”¨çš„æ—¶å€™æ˜¯è¿™æ ·çš„ï¼š 123456789101112131415161718getUser(userId) .observeOn(AndroidSchedulers.mainThread()) .subscribe(new Observer&lt;User&gt;() &#123; @Override public void onNext(User user) &#123; userView.setUser(user); &#125; @Override public void onCompleted() &#123; &#125; @Override public void onError(Throwable error) &#123; // Error handling ... &#125; &#125;); çœ‹åˆ°åŒºåˆ«äº†å—ï¼Ÿ å½“ RxJava å½¢å¼çš„æ—¶å€™ï¼ŒRetrofit æŠŠè¯·æ±‚å°è£…è¿› Observable ï¼Œåœ¨è¯·æ±‚ç»“æŸåè°ƒç”¨ onNext() æˆ–åœ¨è¯·æ±‚å¤±è´¥åè°ƒç”¨ onError()ã€‚ å¯¹æ¯”æ¥çœ‹ï¼Œ Callback å½¢å¼å’Œ Observable å½¢å¼é•¿å¾—ä¸å¤ªä¸€æ ·ï¼Œä½†æœ¬è´¨éƒ½å·®ä¸å¤šï¼Œè€Œä¸”åœ¨ç»†èŠ‚ä¸Š Observable å½¢å¼ä¼¼ä¹è¿˜æ¯” Callback å½¢å¼è¦å·®ç‚¹ã€‚é‚£ Retrofit ä¸ºä»€ä¹ˆè¿˜è¦æä¾› RxJava çš„æ”¯æŒå‘¢ï¼Ÿ å› ä¸ºå®ƒå¥½ç”¨å•Šï¼ä»è¿™ä¸ªä¾‹å­çœ‹ä¸å‡ºæ¥æ˜¯å› ä¸ºè¿™åªæ˜¯æœ€ç®€å•çš„æƒ…å†µã€‚è€Œä¸€æ—¦æƒ…æ™¯å¤æ‚èµ·æ¥ï¼Œ Callback å½¢å¼é©¬ä¸Šå°±ä¼šå¼€å§‹è®©äººå¤´ç–¼ã€‚æ¯”å¦‚ï¼š å‡è®¾è¿™ä¹ˆä¸€ç§æƒ…å†µï¼šä½ çš„ç¨‹åºå–åˆ°çš„ User å¹¶ä¸åº”è¯¥ç›´æ¥æ˜¾ç¤ºï¼Œè€Œæ˜¯éœ€è¦å…ˆä¸æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œæ¯”å¯¹å’Œä¿®æ­£åå†æ˜¾ç¤ºã€‚ä½¿ç”¨ Callback æ–¹å¼å¤§æ¦‚å¯ä»¥è¿™ä¹ˆå†™ï¼š 12345678910111213getUser(userId, new Callback&lt;User&gt;() &#123; @Override public void success(User user) &#123; processUser(user); // å°è¯•ä¿®æ­£ User æ•°æ® userView.setUser(user); &#125; @Override public void failure(RetrofitError error) &#123; // Error handling ... &#125;&#125;; æœ‰é—®é¢˜å—ï¼Ÿ å¾ˆç®€ä¾¿ï¼Œä½†ä¸è¦è¿™æ ·åšã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºè¿™æ ·åšä¼šå½±å“æ€§èƒ½ã€‚æ•°æ®åº“çš„æ“ä½œå¾ˆé‡ï¼Œä¸€æ¬¡è¯»å†™æ“ä½œèŠ±è´¹ 10~20ms æ˜¯å¾ˆå¸¸è§çš„ï¼Œè¿™æ ·çš„è€—æ—¶å¾ˆå®¹æ˜“é€ æˆç•Œé¢çš„å¡é¡¿ã€‚æ‰€ä»¥é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœå¯ä»¥çš„è¯ä¸€å®šè¦é¿å…åœ¨ä¸»çº¿ç¨‹ä¸­å¤„ç†æ•°æ®åº“ã€‚æ‰€ä»¥ä¸ºäº†æå‡æ€§èƒ½ï¼Œè¿™æ®µä»£ç å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ï¼š 12345678910111213141516171819202122getUser(userId, new Callback&lt;User&gt;() &#123; @Override public void success(User user) &#123; new Thread() &#123; @Override public void run() &#123; processUser(user); // å°è¯•ä¿®æ­£ User æ•°æ® runOnUiThread(new Runnable() &#123; // åˆ‡å› UI çº¿ç¨‹ @Override public void run() &#123; userView.setUser(user); &#125; &#125;); &#125;).start(); &#125; @Override public void failure(RetrofitError error) &#123; // Error handling ... &#125;&#125;; æ€§èƒ½é—®é¢˜è§£å†³ï¼Œä½†â€¦â€¦è¿™ä»£ç å®åœ¨æ˜¯å¤ªä¹±äº†ï¼Œè¿·ä¹‹ç¼©è¿›å•Šï¼æ‚ä¹±çš„ä»£ç å¾€å¾€ä¸ä»…ä»…æ˜¯ç¾è§‚é—®é¢˜ï¼Œå› ä¸ºä»£ç è¶Šä¹±å¾€å¾€å°±è¶Šéš¾è¯»æ‡‚ï¼Œè€Œå¦‚æœé¡¹ç›®ä¸­å……æ–¥ç€æ‚ä¹±çš„ä»£ç ï¼Œæ— ç–‘ä¼šé™ä½ä»£ç çš„å¯è¯»æ€§ï¼Œé€ æˆå›¢é˜Ÿå¼€å‘æ•ˆç‡çš„é™ä½å’Œå‡ºé”™ç‡çš„å‡é«˜ã€‚ è¿™æ—¶å€™ï¼Œå¦‚æœç”¨ RxJava çš„å½¢å¼ï¼Œå°±å¥½åŠå¤šäº†ã€‚ RxJava å½¢å¼çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š 1234567891011121314151617181920212223getUser(userId) .doOnNext(new Action1&lt;User&gt;() &#123; @Override public void call(User user) &#123; processUser(user); &#125;) .observeOn(AndroidSchedulers.mainThread()) .subscribe(new Observer&lt;User&gt;() &#123; @Override public void onNext(User user) &#123; userView.setUser(user); &#125; @Override public void onCompleted() &#123; &#125; @Override public void onError(Throwable error) &#123; // Error handling ... &#125; &#125;); åå°ä»£ç å’Œå‰å°ä»£ç å…¨éƒ½å†™åœ¨ä¸€æ¡é“¾ä¸­ï¼Œæ˜æ˜¾æ¸…æ™°äº†å¾ˆå¤šã€‚ å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼šå‡è®¾ /user æ¥å£å¹¶ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œè€Œéœ€è¦å¡«å…¥ä¸€ä¸ªåœ¨çº¿è·å–çš„ token ï¼Œä»£ç åº”è¯¥æ€ä¹ˆå†™ï¼Ÿ Callback æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨åµŒå¥—çš„ Callbackï¼š 12345678910111213141516171819202122232425262728293031@GET(\"/token\")public void getToken(Callback&lt;String&gt; callback);@GET(\"/user\")public void getUser(@Query(\"token\") String token, @Query(\"userId\") String userId, Callback&lt;User&gt; callback);...getToken(new Callback&lt;String&gt;() &#123; @Override public void success(String token) &#123; getUser(token, userId, new Callback&lt;User&gt;() &#123; @Override public void success(User user) &#123; userView.setUser(user); &#125; @Override public void failure(RetrofitError error) &#123; // Error handling ... &#125; &#125;; &#125; @Override public void failure(RetrofitError error) &#123; // Error handling ... &#125;&#125;); å€’æ˜¯æ²¡æœ‰ä»€ä¹ˆæ€§èƒ½é—®é¢˜ï¼Œå¯æ˜¯è¿·ä¹‹ç¼©è¿›æ¯ä¸€ç”Ÿï¼Œä½ æ‡‚æˆ‘ä¹Ÿæ‡‚ï¼Œåšè¿‡å¤§é¡¹ç›®çš„äººåº”è¯¥æ›´æ‡‚ã€‚ è€Œä½¿ç”¨ RxJava çš„è¯ï¼Œä»£ç æ˜¯è¿™æ ·çš„ï¼š 12345678910111213141516171819202122232425262728293031@GET(\"/token\")public Observable&lt;String&gt; getToken();@GET(\"/user\")public Observable&lt;User&gt; getUser(@Query(\"token\") String token, @Query(\"userId\") String userId);...getToken() .flatMap(new Func1&lt;String, Observable&lt;User&gt;&gt;() &#123; @Override public Observable&lt;User&gt; onNext(String token) &#123; return getUser(token, userId); &#125;) .observeOn(AndroidSchedulers.mainThread()) .subscribe(new Observer&lt;User&gt;() &#123; @Override public void onNext(User user) &#123; userView.setUser(user); &#125; @Override public void onCompleted() &#123; &#125; @Override public void onError(Throwable error) &#123; // Error handling ... &#125; &#125;); ç”¨ä¸€ä¸ª flatMap() å°±æå®šäº†é€»è¾‘ï¼Œä¾ç„¶æ˜¯ä¸€æ¡é“¾ã€‚çœ‹ç€å°±å¾ˆçˆ½ï¼Œæ˜¯å§ï¼Ÿ 2016/03/31 æ›´æ–°ï¼ŒåŠ ä¸Šæˆ‘å†™çš„ä¸€ä¸ª Sample é¡¹ç›®ï¼š rengwuxian RxJava Samples å¥½ï¼ŒRetrofit éƒ¨åˆ†å°±åˆ°è¿™é‡Œã€‚ 2. RxBindingRxBinding æ˜¯ Jake Wharton çš„ä¸€ä¸ªå¼€æºåº“ï¼Œå®ƒæä¾›äº†ä¸€å¥—åœ¨ Android å¹³å°ä¸Šçš„åŸºäº RxJava çš„ Binding APIã€‚æ‰€è°“ Bindingï¼Œå°±æ˜¯ç±»ä¼¼è®¾ç½® OnClickListener ã€è®¾ç½® TextWatcher è¿™æ ·çš„æ³¨å†Œç»‘å®šå¯¹è±¡çš„ APIã€‚ ä¸¾ä¸ªè®¾ç½®ç‚¹å‡»ç›‘å¬çš„ä¾‹å­ã€‚ä½¿ç”¨ RxBinding ï¼Œå¯ä»¥æŠŠäº‹ä»¶ç›‘å¬ç”¨è¿™æ ·çš„æ–¹æ³•æ¥è®¾ç½®ï¼š 12345678Button button = ...;RxView.clickEvents(button) // ä»¥ Observable å½¢å¼æ¥åé¦ˆç‚¹å‡»äº‹ä»¶ .subscribe(new Action1&lt;ViewClickEvent&gt;() &#123; @Override public void call(ViewClickEvent event) &#123; // Click handling &#125; &#125;); çœ‹èµ·æ¥é™¤äº†å½¢å¼å˜äº†æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œå®è´¨ä¸Šä¹Ÿæ˜¯è¿™æ ·ã€‚ç”šè‡³å¦‚æœä½ çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼Œä½ ä¼šå‘ç°å®ƒè¿å®ç°éƒ½æ²¡ä»€ä¹ˆæƒŠå–œï¼šå®ƒçš„å†…éƒ¨æ˜¯ç›´æ¥ç”¨ä¸€ä¸ªåŒ…è£¹ç€çš„ setOnClickListener() æ¥å®ç°çš„ã€‚ç„¶è€Œï¼Œä»…ä»…è¿™ä¸€ä¸ªå½¢å¼çš„æ”¹å˜ï¼Œå´æ°å¥½å°±æ˜¯ RxBinding çš„ç›®çš„ï¼šæ‰©å±•æ€§ã€‚é€šè¿‡ RxBinding æŠŠç‚¹å‡»ç›‘å¬è½¬æ¢æˆ Observable ä¹‹åï¼Œå°±æœ‰äº†å¯¹å®ƒè¿›è¡Œæ‰©å±•çš„å¯èƒ½ã€‚æ‰©å±•çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œæ ¹æ®éœ€æ±‚è€Œå®šã€‚ä¸€ä¸ªä¾‹å­æ˜¯å‰é¢æåˆ°è¿‡çš„ throttleFirst() ï¼Œç”¨äºå»æŠ–åŠ¨ï¼Œä¹Ÿå°±æ˜¯æ¶ˆé™¤æ‰‹æŠ–å¯¼è‡´çš„å¿«é€Ÿè¿ç¯ç‚¹å‡»ï¼š 123RxView.clickEvents(button) .throttleFirst(500, TimeUnit.MILLISECONDS) .subscribe(clickAction); å¦‚æœæƒ³å¯¹ RxBinding æœ‰æ›´å¤šäº†è§£ï¼Œå¯ä»¥å»å®ƒçš„ GitHub é¡¹ç›® ä¸‹é¢çœ‹çœ‹ã€‚ 3. å„ç§å¼‚æ­¥æ“ä½œå‰é¢ä¸¾çš„ Retrofit å’Œ RxBinding çš„ä¾‹å­ï¼Œæ˜¯ä¸¤ä¸ªå¯ä»¥æä¾›ç°æˆçš„ Observable çš„åº“ã€‚è€Œå¦‚æœä½ æœ‰æŸäº›å¼‚æ­¥æ“ä½œæ— æ³•ç”¨è¿™äº›åº“æ¥è‡ªåŠ¨ç”Ÿæˆ Observableï¼Œä¹Ÿå®Œå…¨å¯ä»¥è‡ªå·±å†™ã€‚ä¾‹å¦‚æ•°æ®åº“çš„è¯»å†™ã€å¤§å›¾ç‰‡çš„è½½å…¥ã€æ–‡ä»¶å‹ç¼©/è§£å‹ç­‰å„ç§éœ€è¦æ”¾åœ¨åå°å·¥ä½œçš„è€—æ—¶æ“ä½œï¼Œéƒ½å¯ä»¥ç”¨ RxJava æ¥å®ç°ï¼Œæœ‰äº†ä¹‹å‰å‡ ç« çš„ä¾‹å­ï¼Œè¿™é‡Œåº”è¯¥ä¸ç”¨å†ä¸¾ä¾‹äº†ã€‚ 4. RxBusRxBus åå­—çœ‹èµ·æ¥åƒä¸€ä¸ªåº“ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªåº“ï¼Œè€Œæ˜¯ä¸€ç§æ¨¡å¼ã€‚å®ƒçš„æ€æƒ³æ˜¯ä½¿ç”¨ RxJava æ¥å®ç°äº† EventBus ï¼Œè€Œè®©ä½ ä¸å†éœ€è¦ä½¿ç”¨ Otto æˆ–è€… GreenRobot çš„ EventBusã€‚è‡³äºä»€ä¹ˆæ˜¯ RxBusï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼ŒFlipboard å·²ç»ç”¨ RxBus æ›¿æ¢æ‰äº† Otto ï¼Œç›®å‰ä¸ºæ­¢æ²¡æœ‰ä¸è‰¯ååº”ã€‚ æœ€åå¯¹äº Android å¼€å‘è€…æ¥è¯´ï¼Œ RxJava æ˜¯ä¸€ä¸ªå¾ˆéš¾ä¸Šæ‰‹çš„åº“ï¼Œå› ä¸ºå®ƒå¯¹äº Android å¼€å‘è€…æ¥è¯´æœ‰å¤ªå¤šé™Œç”Ÿçš„æ¦‚å¿µäº†ã€‚å¯æ˜¯å®ƒçœŸçš„å¾ˆç‰›é€¼ã€‚å› æ­¤ï¼Œæˆ‘å†™äº†è¿™ç¯‡ã€Šç»™ Android å¼€å‘è€…çš„ RxJava è¯¦è§£ã€‹ï¼Œå¸Œæœ›èƒ½ç»™å§‹ç»ˆæä¸æ˜ç™½ä»€ä¹ˆæ˜¯ RxJava çš„äººä¸€äº›å…¥é—¨çš„æŒ‡å¼•ï¼Œæˆ–è€…èƒ½è®©æ­£åœ¨ä½¿ç”¨ RxJava ä½†ä»ç„¶å¿ƒå­˜ç–‘æƒ‘çš„äººçœ‹åˆ°ä¸€äº›æ›´æ·±å…¥çš„è§£æã€‚æ— è®ºå¦‚ä½•ï¼Œåªè¦èƒ½ç»™å„ä½åŒä¸º Android å·¥ç¨‹å¸ˆçš„ä½ ä»¬æä¾›ä¸€äº›å¸®åŠ©ï¼Œè¿™ç¯‡æ–‡ç« çš„ç›®çš„å°±è¾¾åˆ°äº†ã€‚ å…³äºä½œè€…æœ±å‡¯ï¼ˆæ‰”ç‰©çº¿ï¼‰ï¼ŒFlipboard åŒ—äº¬ Android å·¥ç¨‹å¸ˆã€‚ ä¸ºä»€ä¹ˆå†™è¿™ä¸ªï¼Ÿä¸ä¸¤ä¸‰å¹´å‰çš„å¢ƒå†µä¸åŒï¼Œä¸­å›½ç°åœ¨å·²ç»ä¸ç¼ºåˆçº§ Android å·¥ç¨‹å¸ˆï¼Œä½†ä¸­çº§å’Œé«˜çº§å·¥ç¨‹å¸ˆä¸¥é‡ä¾›ä¸åº”æ±‚ã€‚å› æ­¤æˆ‘å†³å®šä»ä»Šå¤©å¼€å§‹ä¸å®šæœŸåœ°å‘å¸ƒæˆ‘çš„æŠ€æœ¯åˆ†äº«ï¼Œåªå¸Œæœ›èƒ½å¤Ÿå’Œå¤§å®¶å…±åŒæå‡ï¼Œé€šè¿‡æˆ‘ä»¬çš„æˆé•¿æ¥è§£å†³ä¸€ç‚¹ç‚¹å›½å†…äº’è”ç½‘å…¬å¸äººæ‰ç¨€ç¼ºçš„å›°å¢ƒï¼Œä¹Ÿæå‡å„ä½æŠ€æœ¯å…šçš„æ”¶å…¥ã€‚æ‰€ä»¥ï¼Œä¸ä»…è¦å†™è¿™ç¯‡ï¼Œæˆ‘è¿˜ä¼šå†™æ›´å¤šã€‚è‡³äºå†…å®¹çš„å®šä½ï¼Œæˆ‘è®¡åˆ’åªå®šä½çœŸæ­£çš„å¹²è´§ï¼Œä¸€äº›è¾¹è¾¹è§’è§’çš„å°æŠ€å·§å’Œç‚«é…·çš„é»‘ç§‘æŠ€åº”è¯¥éƒ½ä¸ä¼šå†™ï¼Œæ€»ä¹‹å¸Œæœ›æ¯ç¯‡æ–‡ç« éƒ½èƒ½å¸®è¯»è€…æå‡çœŸæ­£çš„å®åŠ›ã€‚","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"RxJava","slug":"RxJava","permalink":"http://github.com/tags/RxJava/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘APKç˜¦èº«è®°ï¼Œå®ç°å°†è¿‘ä¸€åŠçš„å‹ç¼©æ•ˆæœ","slug":"ã€Androidã€‘APKç˜¦èº«è®°ï¼Œå®ç°å°†è¿‘ä¸€åŠçš„å‹ç¼©æ•ˆæœ","date":"2016-11-30T02:31:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/11/30/ã€Androidã€‘APKç˜¦èº«è®°ï¼Œå®ç°å°†è¿‘ä¸€åŠçš„å‹ç¼©æ•ˆæœ/","link":"","permalink":"http://github.com/2016/11/30/ã€Androidã€‘APKç˜¦èº«è®°ï¼Œå®ç°å°†è¿‘ä¸€åŠçš„å‹ç¼©æ•ˆæœ/","excerpt":"æœ¬æ–‡è½¬è½½è‡ªçŸ¥ä¹ï¼š APKç˜¦èº«è®°ï¼Œå¦‚ä½•å®ç°é«˜è¾¾53%çš„å‹ç¼©æ•ˆæœ â€”â€” by é˜¿é‡Œèšå®‰å…¨ ä¸€ã€æˆ‘æ˜¯æ€ä¹ˆæ€è€ƒè¿™ä»¶äº‹æƒ…çš„APKæ˜¯Androidç³»ç»Ÿå®‰è£…åŒ…çš„æ–‡ä»¶æ ¼å¼ï¼Œå…³äºè¿™ä¸ªè¯é¢˜å…¶å®æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é¢˜ç›®ï¼Œä¸è®ºæ˜¯å…¬å¸å†…éƒ¨ï¼Œè¿˜æ˜¯å¤–éƒ¨ç½‘ç»œï¼Œå‰äººå‰è¾ˆå·²ç»æ€»ç»“å‡ºå¾ˆå¤šæ–¹æ³•å’Œè§„å¾‹ã€‚ä¸è¿‡éšç€ç§»åŠ¨ç«¯æŠ€æœ¯è¿‘ä¸¤å¹´çš„é£é€Ÿå‘å±•ï¼Œä¸€äº›æ–°çš„æ€ç»´æ–¹å¼å’Œä¼˜åŒ–æ–¹æ³•ä¹Ÿé€æ¸æ¶Œç°å’Œæˆç†Ÿèµ·æ¥ã€‚ç¬”è€…åœ¨å®è·µè¿‡ç¨‹ä¸­è¸©è¿‡ä¸€äº›å‘ï¼Œæ”¶è·äº†ä¸€äº›ç»éªŒï¼Œåœ¨è¿™é‡Œåšä¸ªæ€è€ƒå’Œæ€»ç»“ï¼Œæ‰€ä»¥éšç¬”ç»™å¤§å®¶ï¼Œå¸Œæœ›å¯¹å¤§å®¶ä»äº‹ç›¸å…³å·¥ä½œçš„æ—¶å€™æœ‰æ‰€å¸®åŠ©å’Œå‚è€ƒï¼ŒåŒæ—¶ä¹Ÿæ˜¯æŠ›ç –å¼•ç‰ï¼Œå¸Œæœ›å¤§å®¶å…±åŒæ¢è®¨è¿™ä¸ªå¼€æ”¾æ€§çš„è¯é¢˜ã€‚ å…³äºä¸ºä»€ä¹ˆAPKè¦ç˜¦èº«ï¼Œè¿™ä¸ªä¸å¤šè¯´ï¼Œåªä»ä¸‰ä¸ªæ–¹é¢å” å¨ä¸€ä¸‹ï¼Œå¯¹äºç”¨æˆ·ï¼ˆæˆ–è€…å®¢æˆ·ï¼‰æ¥è¯´ï¼ŒAPKè¶Šå¤§ï¼Œåœ¨ä¸‹è½½å®‰è£…è¿‡ç¨‹ä¸­ï¼Œä»–ä»¬è€—è´¹çš„æµé‡ä¼šè¶Šå¤šï¼Œå®‰è£…ç­‰å¾…æ—¶é—´ä¹Ÿä¼šè¶Šé•¿ï¼›å¯¹äºäº§å“æœ¬èº«ï¼Œæ„å‘³ç€ä¸‹è½½è½¬åŒ–ç‡ä¼šè¶Šä½ï¼ˆå› ä¸ºç«å“ä¸­ï¼Œç”¨æˆ·æœ‰æ›´å¤šæœºä¼šé€‰æ‹©é‚£ä¸ªä½“éªŒæœ€å¥½ï¼ŒåŠŸèƒ½æœ€å¤šï¼Œæ€§èƒ½æœ€å¥½ï¼ŒåŒ…æœ€å°çš„ï¼‰ï¼›å¯¹äºç ”å‘æ¥è¯´ï¼Œæ˜¯ä¸€ç§ä¼˜åŒ–æ”¹è¿›æŠ€æœ¯çš„æœºä¼šã€‚","text":"æœ¬æ–‡è½¬è½½è‡ªçŸ¥ä¹ï¼š APKç˜¦èº«è®°ï¼Œå¦‚ä½•å®ç°é«˜è¾¾53%çš„å‹ç¼©æ•ˆæœ â€”â€” by é˜¿é‡Œèšå®‰å…¨ ä¸€ã€æˆ‘æ˜¯æ€ä¹ˆæ€è€ƒè¿™ä»¶äº‹æƒ…çš„APKæ˜¯Androidç³»ç»Ÿå®‰è£…åŒ…çš„æ–‡ä»¶æ ¼å¼ï¼Œå…³äºè¿™ä¸ªè¯é¢˜å…¶å®æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„é¢˜ç›®ï¼Œä¸è®ºæ˜¯å…¬å¸å†…éƒ¨ï¼Œè¿˜æ˜¯å¤–éƒ¨ç½‘ç»œï¼Œå‰äººå‰è¾ˆå·²ç»æ€»ç»“å‡ºå¾ˆå¤šæ–¹æ³•å’Œè§„å¾‹ã€‚ä¸è¿‡éšç€ç§»åŠ¨ç«¯æŠ€æœ¯è¿‘ä¸¤å¹´çš„é£é€Ÿå‘å±•ï¼Œä¸€äº›æ–°çš„æ€ç»´æ–¹å¼å’Œä¼˜åŒ–æ–¹æ³•ä¹Ÿé€æ¸æ¶Œç°å’Œæˆç†Ÿèµ·æ¥ã€‚ç¬”è€…åœ¨å®è·µè¿‡ç¨‹ä¸­è¸©è¿‡ä¸€äº›å‘ï¼Œæ”¶è·äº†ä¸€äº›ç»éªŒï¼Œåœ¨è¿™é‡Œåšä¸ªæ€è€ƒå’Œæ€»ç»“ï¼Œæ‰€ä»¥éšç¬”ç»™å¤§å®¶ï¼Œå¸Œæœ›å¯¹å¤§å®¶ä»äº‹ç›¸å…³å·¥ä½œçš„æ—¶å€™æœ‰æ‰€å¸®åŠ©å’Œå‚è€ƒï¼ŒåŒæ—¶ä¹Ÿæ˜¯æŠ›ç –å¼•ç‰ï¼Œå¸Œæœ›å¤§å®¶å…±åŒæ¢è®¨è¿™ä¸ªå¼€æ”¾æ€§çš„è¯é¢˜ã€‚ å…³äºä¸ºä»€ä¹ˆAPKè¦ç˜¦èº«ï¼Œè¿™ä¸ªä¸å¤šè¯´ï¼Œåªä»ä¸‰ä¸ªæ–¹é¢å” å¨ä¸€ä¸‹ï¼Œå¯¹äºç”¨æˆ·ï¼ˆæˆ–è€…å®¢æˆ·ï¼‰æ¥è¯´ï¼ŒAPKè¶Šå¤§ï¼Œåœ¨ä¸‹è½½å®‰è£…è¿‡ç¨‹ä¸­ï¼Œä»–ä»¬è€—è´¹çš„æµé‡ä¼šè¶Šå¤šï¼Œå®‰è£…ç­‰å¾…æ—¶é—´ä¹Ÿä¼šè¶Šé•¿ï¼›å¯¹äºäº§å“æœ¬èº«ï¼Œæ„å‘³ç€ä¸‹è½½è½¬åŒ–ç‡ä¼šè¶Šä½ï¼ˆå› ä¸ºç«å“ä¸­ï¼Œç”¨æˆ·æœ‰æ›´å¤šæœºä¼šé€‰æ‹©é‚£ä¸ªä½“éªŒæœ€å¥½ï¼ŒåŠŸèƒ½æœ€å¤šï¼Œæ€§èƒ½æœ€å¥½ï¼ŒåŒ…æœ€å°çš„ï¼‰ï¼›å¯¹äºç ”å‘æ¥è¯´ï¼Œæ˜¯ä¸€ç§ä¼˜åŒ–æ”¹è¿›æŠ€æœ¯çš„æœºä¼šã€‚ æ¬²ç˜¦èº«ï¼Œæˆ‘ä»¬å…ˆæ‰¾æ‰¾èƒ–çš„åŸå› å’Œé—®é¢˜ã€‚æŒ‰ç›®æ ‡ï¼è·¯å¾„ï¼èµ„æºçš„æ€ç»´æ¨¡å¼ï¼Œæ‰¾åŸå› å’Œé—®é¢˜æœ‰å¦‚ä¸‹å‡ æ¡è·¯å¾„ï¼Œä¸€æ˜¯æ‹è„‘è¢‹ï¼ŒæŒ‰è‡ªå·±çš„ç»éªŒå’Œåˆ¤æ–­ï¼Œç”šè‡³æ˜¯ä¸»è§‚æƒ³è±¡ï¼›äºŒæ˜¯å»æœç´¢å¼•æ“æ‰¾å…³é”®å­—ï¼Œé€›å„ç§æŠ€æœ¯è®ºå›å¬æŠ€æœ¯å¤§ç‰›ä»¬æ€ä¹ˆè¯´ï¼Œçœ‹å„ç±»æŠ€æœ¯æ–‡ç« æŠ½å–æç‚¼ï¼›ä¸‰æ˜¯ç”¨ä¸€ç§å¯æµ‹é‡çš„å·¥å…·æˆ–è€…æ–¹æ³•å‘ç°é—®é¢˜ã€‚ å‰ä¸¤ç§ä¸èµ˜è¿°ï¼Œæˆ‘è¿™é‡Œè¯´è¯´ç¬¬ä¸‰ç§æ–¹æ³•ã€‚ç”¨ä¸€ç§å¯æµ‹é‡çš„å·¥å…·æˆ–è€…æ–¹æ³•æ¥åˆ†æï¼Œæ‰€è°“å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚è¿™ä¸ªå™¨å¯ä»¥å¯ä»¥è‡ªå·±é”»é€ ï¼Œä¹Ÿå¯ä»¥ç”¨ç°æˆçš„ã€‚è¿™é‡Œæ¨èä¸€ä¸ªåœ¨çº¿apkåˆ†æå·¥å…·ï¼Œå› ä¸ºæ˜¯å¤–éƒ¨å·¥å…·ï¼Œæ‰€ä»¥å¤§å®¶è¯·åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¸è¦ä¸Šä¼ æœªå‘å¸ƒå‡ºå»çš„äº§å“ï¼Œä¸ºäº†æ•°æ®å®‰å…¨ï¼Œç¬”è€…è¿™é‡Œæ‹¿ä¸€ä¸ªgithubä¸Šå¼€æºçš„Androidé¡¹ç›®ä½œä¸ºç˜¦èº«ç¤ºä¾‹ã€‚ äºŒã€å¯»æ‰¾é—®é¢˜NimbleDroid æ˜¯ç¾å›½å“¥ä¼¦æ¯”äºšå¤§å­¦çš„åšå£«åˆ›ä¸šå›¢é˜Ÿç ”å‘å‡ºæ¥çš„åˆ†æAndroid appæ€§èƒ½æŒ‡æ ‡çš„ç³»ç»Ÿï¼Œåˆ†æçš„æ–¹å¼æœ‰é™æ€å’ŒåŠ¨æ€ä¸¤ç§æ–¹å¼ï¼Œå…¶ä¸­é™æ€åˆ†æå¯ä»¥åˆ†æå‡ºAPKå®‰è£…åŒ…ä¸­å¤§æ–‡ä»¶æ’è¡Œæ¦œï¼Œå„ç§çŸ¥åSDKçš„å¤§å°ä»¥åŠå ä»£ç æ•´ä½“çš„æ¯”ä¾‹ï¼Œå„ç§ç±»å‹æ–‡ä»¶çš„å¤§å°ä»¥åŠå æ’è¡Œï¼Œå„ç§çŸ¥åSDKçš„æ–¹æ³•æ•°ä»¥åŠå æ‰€æœ‰dexä¸­æ–¹æ³•æ•°çš„æ¯”ä¾‹ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œä¸‹é¢ä¸Šé«˜æ¸…æ— ç å¤§å›¾çœ‹çœ‹é¢œå€¼å§ã€‚ å¦‚æœæƒ³ä½¿ç”¨åˆ†æåŠŸèƒ½åˆ†æè‡ªå·±çš„äº§å“ï¼Œè¯·ç™»å½•å¹¶ä¸Šä¼ è‡ªå·±äº§å“çš„apkåŒ…ï¼Œæ‰€æœ‰åŠŸèƒ½ç›®å‰å‡å…è´¹ä½¿ç”¨ï¼Œå¦‚æœæ˜¯æƒ³åˆ†æGoogle Playä¸Šå·²ç»å‘å¸ƒçš„äº§å“ï¼Œå¯ä»¥ç›´æ¥ç‚¹å‡»â€Play Appsâ€æŸ¥çœ‹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æœç´¢åŠŸèƒ½æ ¹æ®åº”ç”¨åå’ŒåŒ…åæŸ¥çœ‹ç»“æœã€‚å†æ¬¡å¼ºè°ƒä¸‹ï¼Œè¯·ä¸è¦ä¸Šä¼ ä»»ä½•æœªå‘å¸ƒçš„äº§å“ã€‚ ç™»å½• ä¸Šä¼ apkæ–‡ä»¶ åˆ†æç»“æœæ‘˜è¦ å¯ä»¥çœ‹åˆ°ä¸€äº›æ¦‚è§ˆçš„ä¿¡æ¯ï¼Œapkæ–‡ä»¶å¤§å°ï¼Œæ€»çš„æ–¹æ³•æ•° æ–‡ä»¶å¤§å°åˆ†æè¯¦æƒ…é¡µï¼Œå¤§æ–‡ä»¶åˆ—è¡¨ è¿™é‡Œåˆ—å‡ºçš„æ˜¯apkæ–‡ä»¶ä¸­è¶…è¿‡100kçš„æ–‡ä»¶æ’è¡Œï¼Œè¿™é‡Œçš„æ–‡ä»¶å¤§å°æŒ‡çš„æ˜¯apkæ–‡ä»¶ä¸­çš„å¤§å° å„ç§çŸ¥åSDKçš„å¤§å°ä»¥åŠå ä»£ç æ•´ä½“çš„æ¯”ä¾‹ï¼Œè¿™é‡Œç›®å‰èƒ½è¯†åˆ«å‡ºAndroid Supportï¼ŒJackson JSON parser, Google Play Services, Paypal, Glide, OkHttp, Facebook SDK, Fabric, Gsonç­‰ç­‰ï¼ŒApplicationè¡¨ç¤ºAppä¸­è‡ªå·±ç¼–å†™çš„ä»£ç éƒ¨åˆ† å„ç§ç±»å‹æ–‡ä»¶çš„å¤§å°ä»¥åŠæ’è¡Œ å„ç§çŸ¥åSDKå æ‰€æœ‰dexä¸­æ–¹æ³•æ•°çš„æ¯”ä¾‹ å„ç§çŸ¥åSDKçš„æ–¹æ³•æ•°æ’è¡Œæ¦œ çœ‹å®Œè¿™ä¸ªapkå†…å‰–å›¾æ˜¯ä¸æ˜¯æœ‰ä¸€ç§ç¥æ¸…æ°”çˆ½çš„æ„Ÿè§‰ï¼æˆ‘æŠŠè¿™ä¸ªåˆ†æå·¥å…·æ¯”åšæˆ‘ä»¬å®¶ä¹°çš„æ™ºèƒ½ä½“é‡ç§¤ï¼Œå¯ä»¥ç§°ä½“é‡ï¼Œè„‚è‚ªå«é‡ï¼Œéª¨é‡ï¼Œéª¨å¯†åº¦ï¼Œè‚Œè‚‰å«é‡ç­‰ç­‰ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å‘ç°äº†ä¸€äº›é—®é¢˜ï¼Œè¿›è€ŒæŠŠè¿™äº›é—®é¢˜å’Œæˆ‘ä»¬ä¹‹å‰é ç»éªŒå’Œä¸€æ‹è„‘è¢‹çš„åŸå› å¯ä»¥ç”¨é€»è¾‘è”ç³»åœ¨ä¸€èµ·ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥é€šè¿‡åˆ†ææ•°æ®æ•´ç†å‡ºæˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡ å¤§æ–‡ä»¶æ’è¡Œæ¦œé‡Œï¼Œæœ‰11å¼ pngæ–‡ä»¶çš„å¤§å°è¶…è¿‡äº†100kï¼Œè®°ä½ï¼Œè¿™å¯æ˜¯å‹ç¼©ä¹‹åçš„å•Šï¼› å¤§æ–‡ä»¶æ’è¡Œæ¦œé‡Œï¼Œresources.arscçš„å¤§å°æ¥è¿‘2Mï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¼˜åŒ–ç‚¹ï¼› å¤§æ–‡ä»¶æ’è¡Œæ¦œé‡Œï¼Œclasses.dexæ¥è¿‘3Mï¼Œclasses.dexæ˜¯ä»£ç çš„è½½ä½“ï¼Œè¿™å—çš„ä¼˜åŒ–éœ€è¦ç»†åˆ†ï¼Œå†å»çœ‹çœ‹ç»†åˆ†SDKçš„æ’è¡Œæ¦œï¼› ç»„ä»¶å æ¯”ç¯å›¾é‡Œï¼ŒAndroid Support, Jackson JSON Parserå’ŒGoogle Play Servicesæ˜¯ä¸‰æ–¹åº“çš„å‰ä¸‰ç”²ï¼› æ–‡ä»¶ç±»å‹æ’è¡Œæ¦œé‡Œï¼Œpng, dex å’Œarscæ˜¯å‰ä¸‰ç”²ï¼› ä¸‰ã€æ¢³ç†ä¼˜åŒ–ç›®æ ‡æ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ²¡æœ‰è›€ç‰™ï¼Œä¸å¯¹ï¼Œæ˜¯ä¸‹é¢çš„ç›®æ ‡ï¼š pngå›¾ç‰‡ä¼˜åŒ–ï¼› resources.arscæ–‡ä»¶çš„ä¼˜åŒ–ï¼› ä»£ç ä¼˜åŒ– 3.1 å›¾ç‰‡ä¼˜åŒ–çš„å°è¯•é¦–å…ˆæ˜¯ç¬¬ä¸€ä¸ªç›®æ ‡ï¼Œå›¾ç‰‡çš„ä¼˜åŒ–ï¼Œæ…¢ç‚¹ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿™äº›å›¾ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤§å…ˆï¼Œå‡†ç¡®çš„è¯´ï¼Œä¸ºä»€ä¹ˆè¿™äº›å›¾åœ¨apkï¼ˆå…¶å®å°±æ˜¯zipæ–‡ä»¶ï¼‰é‡Œè¿™ä¹ˆå¤§ï¼Œå¥½äº†ï¼Œä¸Šå·¥å…·åˆ†æã€‚ è¿™æ¬¡ç”¨äº†ä¸€äº›ç®€å•çš„å·¥å…·ç»„åˆï¼Œç³»ç»Ÿè‡ªå¸¦çš„cmdå°±å¥½ã€‚ å‘½ä»¤æ‰§è¡Œçš„ç»“æœå¦‚ä¸‹ æ©ï¼Œæ‰€æœ‰çš„pngæ–‡ä»¶å±…ç„¶æ˜¯STOREçš„æ–¹å¼å­˜å‚¨åˆ°apké‡Œçš„ï¼Œå…³äºzipé‡Œçš„STOREå’ŒDEFLATEï¼Œè¯¦è§Wikipedia ) é€šä¿—çš„è¯´ï¼Œå½“æ–‡ä»¶æ˜¯STOREDçš„æ–¹å¼å­˜å‚¨åˆ°zipï¼Œè¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶å¹¶æ²¡æœ‰ç»è¿‡å‹ç¼©ï¼Œå¦‚æœæ˜¯Defl:Nçš„æ–¹å¼ï¼Œè¡¨ç¤ºé€šè¿‡DEFLATED normalçš„æ–¹å¼å‹ç¼©å­˜å‚¨åˆ°zipã€‚ è¿™çœ‹èµ·æ¥æœ‰ç‚¹ä¸åˆç†ï¼ŒpngåŸå°ä¸åŠ¨çš„æ”¾å…¥zipï¼Œå½“ç„¶æœ€åäº§å‡ºçš„apkä¼šæ¯”è¾ƒå¤§ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•è§£å†³å‘¢ï¼Ÿç¬”è€…é¦–å…ˆå°ä½¿ç”¨android gradle pluginçš„æ–¹å¼ï¼Œå‘ç°aaptOptionså’ŒpackagingOptionséƒ½æœªèƒ½è§£å†³é—®é¢˜ã€‚åœ¨githubä¸Šå‘ç°ä¸€ä¸ªå¼€æºé¡¹ç›®AndResGuardï¼Œè¯•äº†é›†æˆåˆ°é¡¹ç›®ä¸­ï¼Œå†çœ‹ç»“æœå¦‚ä¸‹ï¼š ä¼˜åŒ–å‰ï¼š 10536027å­—èŠ‚ ä¼˜åŒ–åï¼š æ™®é€šzipå‹ç¼©ï¼š 8786265å­—èŠ‚ ï¼ˆå‹ç¼©äº†å°†è¿‘17%ï¼‰ é‡‡ç”¨7zipå‹ç¼©ï¼š8567150å­—èŠ‚ ï¼ˆå‹ç¼©äº†å°†è¿‘19%ï¼‰ å†çœ‹çœ‹è¿™ä¸ªå·¥å…·åšäº†ä»€ä¹ˆï¼Œå¯¹æ¯”ä¸‹å¼€å¯èµ„æºæ··æ·†å‰å ä¼˜åŒ–å‰ ä¼˜åŒ–å èµ„æºï¼ˆpng, xml, jpgç­‰ï¼‰åç§°æ··æ·†ï¼Œèµ„æºè·¯å¾„åç§°æ··æ·†ä»¥åŠåç§°é•¿åº¦å‹ç¼©ï¼› åŸæ¥ä»¥STOREDå½¢å¼å­˜å‚¨åˆ°zipä¸­çš„pngæ–‡ä»¶è¢«æ”¹æˆäº†DEFLATEDï¼ˆæ™®é€šå‹ç¼©å­˜å‚¨ï¼‰æ–¹å¼ï¼› æ„å¤–å‘ç°resources.arsc, META-INF/.SF ä»¥åŠ META-INF/.MFå˜å°äº†ï¼Œè€Œä¸”æ˜¯è§£å‹ä¹‹åçš„æ–‡ä»¶å¤§å°ä¹Ÿå˜å°äº†ã€‚ ç”¨apkåç¼–è¯‘ç¥å™¨jadxå†…çª¥apkå¯»æ‰¾çœŸç›¸ åŸæ¥apkä¸­èµ„æºï¼ˆpng, xmlï¼Œä»¥åŠpropertiesæ–‡ä»¶ï¼‰çš„ç›¸å¯¹è·¯å¾„ä¼šå­˜æ”¾åˆ°META-INF/.SF ä»¥åŠ META-INF/.MFä¸­å¹¶ä¸ºæ¯ä¸ªèµ„æºæ–‡ä»¶è®¡ç®—SHA1å€¼å¹¶å­˜å‚¨åœ¨è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼Œè‡³äºä¸ºå•¥è¿™ä¹ˆåšä»¥åŠè¿™ä¸¤ä¸ªSHA1æœ‰å•¥åŒºåˆ«å’Œä½œç”¨è¯·å‚è€ƒç½‘ç»œä¸Šå…³äºè¿™æ–¹é¢çŸ¥è¯†çš„æ–‡ç« ï¼Œå·²è¶…å‡ºæœ¬æ–‡çš„ä¸»é¢˜æ‰€ä»¥è¿™é‡Œä¸å†èµ˜è¿°ã€‚ å¯¹äºresources.arscæ–‡ä»¶ å¾ˆå®¹æ˜“çœ‹å‡ºæ¥å®ƒæ˜¯èµ„æºæ–‡ä»¶ç´¢å¼•è¡¨ï¼Œæ‰€ä»¥ï¼Œçœ‹åˆ°è¿™é‡Œå¤§å®¶åº”è¯¥æ˜ç™½è¿™ä¸‰ä¸ªæ–‡ä»¶ä¸ºå•¥ä¼šå˜å°äº†å§ã€‚ 3.2 ä¸€æ¬¡æ„å¤–çš„å‘ç°é¡ºç€resources.arscå¾€ä¸‹çœ‹ï¼Œå‘ç°ä¸€ä¸ªæœ‰è¶£çš„ä¸œè¥¿ï¼Œ è¿™åˆå°†æˆä¸ºä¸€ä¸ªä¼˜åŒ–ç‚¹ï¼Œå»é™¤é‚£äº›æ²¡ç”¨çš„ç¿»è¯‘èµ„æºï¼Œå¼•å…¥ä¸€äº›ç¬¬ä¸‰æ–¹çš„SDKï¼Œå¾€å¾€è¿™äº›SDKå¸¦äº†å¾ˆå¤šç¿»è¯‘èµ„æºåœ¨é‡Œé¢ï¼Œæ¯”å¦‚android supportåº“ï¼Œå»æ‰åæˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœã€‚ å‡è®¾æˆ‘ä»¬åªä¿ç•™è‹±æ–‡ï¼Œå½“ç„¶åªæ˜¯ä¸ªå®éªŒï¼Œç°å®ä¸­çœ‹å…·ä½“æƒ…å†µäº†ï¼Œ é‡‡ç”¨7zipå‹ç¼©ï¼š8220738å­—èŠ‚ ï¼ˆå‹ç¼©äº†å°†è¿‘22%ï¼Œå†å¢åŠ 3ä¸ªç‚¹ï¼‰ å½“ç„¶ï¼ŒçœŸå®çš„é¡¹ç›®é‡Œä¸å¯èƒ½è¿™æ ·ï¼Œä½†æ˜¯èšŠå­è‚‰ä¹Ÿæ˜¯è‚‰å•Šï¼ å…¶å®ï¼Œæˆ‘æƒ³è¯´çš„æ˜¯è¿™æä¾›äº†ä¸€ç§ä¼˜åŒ–æ€è·¯ï¼Œå°±æ˜¯åˆ©ç”¨gradleçš„é…ç½®å¹²æ‰æ— ç”¨çš„èµ„æºï¼ŒåŒæ ·çš„å¯ä»¥ç”¨åœ¨soæœ¬åœ°åº“ä¸Šï¼Œåˆ†è¾¨ç‡ï¼ˆgradleé…ç½®å·²deprecatedï¼‰ä¸Šã€‚ gradleé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š è®°å¾—åŒ…åœ¨android{}ä¸­é—´å“¦ã€‚é‚£ä¹ˆï¼Œæœ‰äººè¦é—®äº†ï¼Œabié‡Œè‚¿ä¹ˆæ²¡æœ‰x86ï¼Ÿæ®è¯´intelæä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå«houdiniï¼Œæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨x86è®¾å¤‡ä¸Šçš„ä¸­é—´ä»¶ï¼Œå¯ä»¥å°†armè½¬ç ä¸ºx86çš„æŒ‡ä»¤ï¼Œä¸è¿‡æ•ˆç‡å¾ˆä½ï¼Œæœ‰äº›è¿ç®—å‹çš„ï¼Œæ¯”å¦‚è®¡ç®—MD5å’ŒSHA1ï¼Œç”šè‡³ä¸å¦‚javaï¼Œç¬”è€…æ›¾ç»åšè¿‡æµ‹è¯•å¯¹æ¯”ï¼Œåˆæ˜¯å¦å¤–ä¸€ä¸ªè¯é¢˜ï¼Œæ­¤å¤„ä¸èµ˜è¿°ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥ç§»æ­¥ã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åœ¨æœç¬¬ä¸€ä¸ªç›®æ ‡è¿ˆè¿›ï¼Œä¸ç»æ„é—´å‘ç°äº†ç¬¬ä¸€ä¸ªç›®æ ‡å’Œç¬¬äºŒä¸ªç›®æ ‡ä¹‹é—´çš„å…³ç³»ï¼Œæ‰€ä»¥åˆ©ç”¨èµ„æºæ··æ·†å·¥å…·ï¼Œè¾¾æˆäº†ç¬¬äºŒä¸ªç›®æ ‡ã€‚ åˆ©ç”¨7zipå‹ç¼©ï¼Œæˆ‘ä»¬å¯¹æ•´ä¸ªåŒ…è¿›è¡Œäº†2ä¸ªç‚¹çš„å‹ç¼©ï¼Œè¿™æ˜¯ä¸€ä¸ªè¶…å‡ºé¢„æœŸçš„æˆæœã€‚ 3.3å›¾ç‰‡ä¼˜åŒ–çš„æ–¹æ³•å…³äºç¬¬ä¸€ä¸ªç›®æ ‡ï¼Œæˆ‘ä»¬çš„è·¯å¾„è¿˜æ²¡æœ‰ç»“æŸï¼Œæ‹è„‘è¢‹æƒ³å‡ºæ¥çš„è·¯å¾„æ˜¯å‹ç¼©pngï¼Œéalphaå›¾è½¬æˆjpgï¼Œè¿˜æœ‰ä»€ä¹ˆï¼Ÿæ‰€ä»¥å»å„ç§æŠ€æœ¯è®ºå›é€›äº†ä¸€åœˆï¼Œè¯·æ•™äº†å„ç§æŠ€æœ¯å¤§ç‰›ï¼Œæ¢³ç†çš„è·¯å¾„å¦‚ä¸‹ï¼š 1ã€æ‰‹åŠ¨lintæ£€æŸ¥ï¼Œæ‰‹åŠ¨åˆ é™¤ä»£ç ä¸­æ²¡æœ‰å¼•ç”¨åˆ°çš„èµ„æºï¼Œå®é™…æ•ˆæœä¸ç­‰ã€‚ åœ¨Android Studioä¸­æ‰“å¼€â€œAnalyzeâ€ ç„¶åé€‰æ‹©â€Inspect Codeâ€¦â€ï¼ŒèŒƒå›´é€‰æ‹©æ•´ä¸ªé¡¹ç›®ï¼Œç„¶åç‚¹å‡»â€OKâ€ é…ç½®å¦‚ä¸‹å›¾ 2ã€gradleè„šæœ¬ä¸­å¼€å¯shrinkResources è„šæœ¬å‚è€ƒå¦‚ä¸‹ shrinkResourcesé…åˆminifyEnabledä½¿ç”¨æ•ˆæœæ›´ä½³ï¼Œè¯¦è§shrinkResourcesç”¨æ³•ä»¥åŠæ³¨æ„ é‡‡ç”¨7zipå‹ç¼©ï¼š8115283å­—èŠ‚ ï¼ˆå‹ç¼©äº†å°†è¿‘23%ï¼Œå†å¢åŠ 1ä¸ªç‚¹ï¼‰ 3ã€ä½¿ç”¨å›¾ç‰‡å‹ç¼©å·¥å…·ï¼Œå‹ç¼©pngå›¾çš„å¤§å°ï¼Œå°†éalphaçš„å›¾è½¬æ¢æˆjpgå½¢å¼ï¼Œå…³äºè¿™ç‚¹åŒäº‹ä»¥åŠç½‘ç»œä¸Šçš„å¤§ç‰›ä»¬å·²ç»æ•´ç†çš„å¾ˆè¯¦ç»†äº†ï¼Œæˆ‘è¿™é‡Œåšç®€å•æ€»ç»“ï¼Œæ¬²çŸ¥è¯¦æƒ…ï¼Œè¯·è§é™„å½•çš„å‚è€ƒã€‚ ä½¿ç”¨tinypngï¼Œæˆ‘åªæƒ³è¯´å’±ä»¬åœ¨å…¬å¸åšäº§å“ï¼Œæ­¤æ–¹æ¡ˆæ…ç”¨ï¼Œä¸Šä¼ ä»»ä½•æœªå‘å¸ƒäº§å“çš„å†…å®¹åˆ°å¤–éƒ¨ç½‘ç»œï¼Œéƒ½æœ‰å¯èƒ½å¼•èµ·æ•°æ®æ³„æ¼ï¼Œæ‰€ä»¥æ…ç”¨æ­¤æ–¹æ¡ˆã€‚ä¸‹é¢è¯´æ›¿ä»£æ–¹æ¡ˆã€‚ WASTED pngquant ImageAlpha ImageOptim ä»¥ä¸Šå·¥å…·å¤ªæ•£ï¼Œæœ‰æ²¡æœ‰é›†æˆåŒ–çš„å·¥å…·ï¼Œç­”æ¡ˆæ˜¯â€œæœ‰â€ @å¿ƒä¼¦ ç«¥é‹å¼€å‘çš„imagemin @å§å¤«ç«¥é‹å¼€å‘çš„MSImageResourcesHelper pngè½¬æˆjpgæ ¼å¼ï¼Œå…·ä½“æ•ˆæœä¸ç­‰ã€‚ 4ã€ç»ˆæå¤§æ€å™¨ï¼Œpngè½¬æˆwebpï¼Œå…³äºwebpï¼Œæ›´å¤šè¯¦æƒ…è¯·å‚è€ƒè°·æ­Œå®˜æ–¹æ–‡æ¡£ä»¥åŠå®‰å“å¼€å‘è€…åœ¨çº¿å‚è€ƒ å…ˆä¸Šæ•ˆæœå›¾ï¼š é‡‡ç”¨7zipå‹ç¼©ï¼š4926912å­—èŠ‚ ï¼ˆå‹ç¼©äº†å°†è¿‘53%ï¼Œå†å¢åŠ 30ä¸ªç‚¹ï¼‰ æ²¡çœ‹é”™å§ï¼Œæ˜¯30ä¸ªç‚¹ï¼Œç›®å‰apkçš„å¤§å°æ˜¯åŸå§‹apkå¤§å°çš„ä¸€åŠä¸åˆ°ï¼Œè€Œæˆ‘åšçš„ï¼Œä¸€è¡Œä»£ç æœ¨æœ‰æ”¹åŠ¨ï¼Œä»…ç”¨äº†ä¸€äº›å·¥å…·è€Œå·²ï¼ è¯´äººè¯ï¼Œæˆ‘æœ¨æœ‰åƒå‡è‚¥è¯ï¼Œæœ¨æœ‰ç»é£Ÿï¼Œä½“é‡å´è½»äº†ä¸€åŠï¼ï¼ï¼ ä½†æ˜¯ï¼Œç›®å‰å´æ²¡èƒ½ç”¨åˆ°é¡¹ç›®ä¸­ï¼Œå› ä¸ºæœ‰ä¸¤ä¸ªå‘ åœ¨ä¸‰æ˜Ÿçš„éƒ¨åˆ†æœºå‹ä¸Šï¼Œéƒ¨åˆ†æœ‰alphaèƒŒæ™¯éƒ¨åˆ†çš„å›¾ä¼šæœ‰ä¸€æ¡å¾ˆæ˜æ˜¾çš„é»‘çº¿ï¼Œè¿™é‡Œå°±ä¸ä¸Šå›¾äº†ï¼Œè¿™ä¸ªé—®é¢˜ç›®å‰é€šè¿‡ç™½åå•çš„æ–¹å¼ä¸å»åšæˆwebpçš„å›¾æ¥å¤„ç†ï¼› åœ¨å°ç±³2åˆ·æˆ4.xxçš„æ‰‹æœºä¸Šï¼Œæœªèƒ½æ­£ç¡®è¯†åˆ«xmlæ–‡ä»¶ä¸­æè¿°çš„webpå›¾ç‰‡ï¼Œå¯¼è‡´ç•Œé¢èµ·æ¥ååŠ è½½xmlå¸ƒå±€æ–‡ä»¶ï¼Œæ–‡ä»¶åŠ è½½webpå¤±è´¥ï¼ŒæŠ¥é”™è¯´resource file not foundï¼Œå¯¼è‡´appå‘ç”Ÿå´©æºƒã€‚è·Ÿè¸ªå‘ç°æ˜¯å°ç±³æœºå™¨ä»£ç†äº†ç±»Resourceä¸ºMIUIResourceï¼Œä½†æ˜¯è¿™ä¸ªMIUIResourceæœªèƒ½æ­£ç¡®è¯†åˆ«webpï¼Œæ‰€ä»¥å¯¼è‡´åŠ è½½èµ„æºæ–‡ä»¶å¤±è´¥ï¼Œåˆæ­¥åˆ¤å®šï¼Œç›®å‰æš‚æ—¶æ²¡æœ‰è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥åªèƒ½å¿ç—›æ”¾å¼ƒè¿™ä¸ªä¼˜åŒ–æ–¹æ¡ˆã€‚ å…³äºç¬¬ä¸€ä¸ªç›®æ ‡ï¼Œå›¾ç‰‡èµ„æºçš„ä¼˜åŒ–ï¼Œå°±å†™åˆ°è¿™é‡Œäº†ã€‚ 3.4 ä»£ç ä¼˜åŒ–ç¬¬äºŒä¸ªç›®æ ‡å·²è¾¾æˆï¼Œå‰©ä¸‹ç¬¬ä¸‰ä¸ªç›®æ ‡ï¼Œä»£ç çš„ä¼˜åŒ–ï¼Œæ¢³ç†å¦‚ä¸‹ä¼˜åŒ–è·¯å¾„ï¼š 1ã€å¼€å¯proguardçš„ä»£ç ä¼˜åŒ–å°† 1proguardFiles getDefaultProguardFile('proguard-android.txt'),'proguard-project.txt' æ”¹ä¸º 1proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'),'proguard-project.txt' å¼€å¯ä»£ç ä¼˜åŒ–åçš„æ³¨æ„ç‚¹è¯·å‚è§é™„å½•ã€‚ 2ã€å»é™¤æ— ç”¨çš„åº“å¦‚æœapkæ”¯æŒçš„æœ€ä½ç‰ˆæœ¬æ˜¯API14,è€Œä»£ç ä¸­æ²¡æœ‰ç”¨åˆ°é«˜äºapi14çš„apiå°±å¯ä»¥è€ƒè™‘æ‹¿æ‰æ•´ä¸ªandroid supportåº“ã€‚ 3ã€ç”¨æ›´å°çš„åº“æ›¿ä»£æ–¹æ¡ˆå¦‚æœåªç”¨åˆ°äº†è°·æ­Œç»Ÿè®¡ï¼Œé‚£ä¹ˆå°±ä¸è¦æŠŠæ•´ä¸ªgoogle play serviceséƒ½é›†æˆè¿›æ¥ï¼Œåªé›†æˆéœ€è¦çš„éƒ¨åˆ†ã€‚ 4ã€å®šæœŸæ¸…ç†åºŸå¼ƒçš„ä»£ç å®šæœŸåˆ é™¤æ— ç”¨çš„é€»è¾‘å’Œè¿‡æœŸçš„ä¸šåŠ¡åŠŸèƒ½æ¨¡å—ï¼Œä»¥åŠåºŸå¼ƒçš„A/B testä»£ç ã€‚ 5ã€ä¸šåŠ¡æ¨¡å—é‡‡ç”¨æ’ä»¶åŒ–æ¡†æ¶ï¼Œä»£ç åŠ¨æ€ä»äº‘ç«¯æ‹‰å–æ’ä»¶åŒ–ï¼Œè¿™æ˜¯å¦å¤–ä¸€ä¸ªè¯¾é¢˜äº†ï¼Œè¿™é‡Œä¸èµ˜è¿°ã€‚ apkç˜¦èº«è®°æœ€ç»ˆçš„æˆæœ 10536027å­—èŠ‚å‹ç¼©åˆ°4926912å­—èŠ‚, å‹ç¼©äº†å°†è¿‘53% æ€»ç»“ è„šæœ¬ä¸­å¼€å¯èµ„æºæ··æ·†å’Œèµ„æºå‹ç¼© ç”¨7zipä»£æ›¿zip gradleè„šæœ¬ä¸­å¼€å¯ä»£ç æ··æ·†ä¼˜åŒ–å’Œæ— ç”¨èµ„æºåˆ é™¤ ç”¨æ›´å°çš„å›¾ï¼Œä½¿ç”¨å‹ç¼©å·¥å…·å‹ç¼©å›¾ç‰‡å¤§å° å»é™¤æ— ç”¨çš„èµ„æºï¼Œè¯­è¨€ï¼Œæœ¬åœ°soåº“ï¼ŒäºŒæ–¹ä¸‰æ–¹åº“å’Œåˆ†è¾¨ç‡ ç”¨æ›´å°çš„åº“ å°è¯•å°†android supportåº“å½»åº•è¸¢å‡ºä½ çš„é¡¹ç›® å®šæœŸæ¸…ç†ä»£ç  å°è¯•ç”¨H5ç¼–å†™ç•Œé¢ï¼Œå›¾ç‰‡äº‘ç«¯è·å– å°è¯•æ’ä»¶åŒ–ä¸šåŠ¡æ¨¡å— å¯»æ‰¾åˆ°zipæ–‡ä»¶å¤¹ä¸­æ‰€æœ‰ç”¨STOREå½¢å¼å­˜å‚¨çš„æ–‡ä»¶ï¼ˆä¸é™äºrawç›®å½•ä¸‹ï¼‰ï¼Œå°è¯•å‹ç¼©ï¼Œä»¥åŠæ›¿ä»£æ–¹æ¡ˆåŠ è½½è¿™äº›èµ„æº å°è¯•webpçš„å›¾ç‰‡åŠ è½½æ–¹æ¡ˆï¼Œå¯»æ±‚çªç ´ æœ€åï¼Œç»§ç»­å­¦ä¹ å’Œå°è¯•æ–°çš„ä¼˜åŒ–æ–¹æ¡ˆ ä»¥æ­¤æ–‡çŒ®ç»™â€œå”¯ç˜¦èº«ä¸äº§å“ä¸å¯è¾œè´Ÿâ€çš„æŠ€æœ¯ä»¬ï¼ï¼ï¼ é™„å½• å¦‚ä½•åšåˆ°å°†apkå¤§å°å‡å°‘6M Android APPç»ˆæç˜¦èº«æŒ‡å— APKç˜¦èº«å®è·µ","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"APK","slug":"APK","permalink":"http://github.com/tags/APK/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"åŸºäºç¤¾åŒºå‘ç°ç®—æ³•å’Œå›¾åˆ†æNeo4jè§£è¯»ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹","slug":"åŸºäºç¤¾åŒºå‘ç°ç®—æ³•å’Œå›¾åˆ†æNeo4jè§£è¯»ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹","date":"2016-11-21T03:08:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/11/21/åŸºäºç¤¾åŒºå‘ç°ç®—æ³•å’Œå›¾åˆ†æNeo4jè§£è¯»ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹/","link":"","permalink":"http://github.com/2016/11/21/åŸºäºç¤¾åŒºå‘ç°ç®—æ³•å’Œå›¾åˆ†æNeo4jè§£è¯»ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹/","excerpt":"å¯¼è¯»å‡ ä¸ªæœˆå‰ï¼Œæ•°å­¦å®¶ Andrew Beveridge å’ŒJie Shanåœ¨æ•°å­¦æ‚å¿—ä¸Šå‘è¡¨ã€ŠæƒåŠ›çš„ç½‘ç»œã€‹ï¼Œä¸»è¦åˆ†æç•…é”€å°è¯´ã€Šå†°ä¸ç«ä¹‹æ­Œã€‹ç¬¬ä¸‰éƒ¨ã€Šå†°é›¨çš„é£æš´ã€‹ä¸­äººç‰©å…³ç³»ï¼Œå…¶å·²ç»æ‹æˆç”µè§†å‰§ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹ç³»åˆ—ã€‚ä»–ä»¬åœ¨è®ºæ–‡ä¸­ä»‹ç»äº†å¦‚ä½•é€šè¿‡æ–‡æœ¬åˆ†æå’Œå®ä½“æå–æ„å»ºäººç‰©å…³ç³»çš„ç½‘ç»œã€‚ç´§æ¥ç€ï¼Œä½¿ç”¨ç¤¾äº¤ç½‘ç»œåˆ†æç®—æ³•å¯¹äººç‰©å…³ç³»ç½‘ç»œåˆ†ææ‰¾å‡ºæœ€é‡è¦çš„è§’è‰²ï¼›åº”ç”¨ç¤¾åŒºå‘ç°ç®—æ³•æ¥æ‰¾åˆ°äººç‰©èšç±»ã€‚ å…¶ä¸­çš„åˆ†æå’Œå¯è§†åŒ–æ˜¯ç”¨Gephiåšçš„ï¼ŒGephiæ˜¯éå¸¸æµè¡Œçš„å›¾åˆ†æå·¥å…·ã€‚ä½†ä½œè€…è§‰å¾—ä½¿ç”¨Neo4jæ¥å®ç°æ›´æœ‰è¶£ã€‚ å¯¼å…¥åŸå§‹æ•°æ®åˆ°Neo4jåŸå§‹æ•°æ®å¯ä»ç½‘ç»œä¸Šä¸‹è½½ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š 12345Source,Target,WeightAemon,Grenn,5Aemon,Samwell,31Aerys,Jaime,18...","text":"å¯¼è¯»å‡ ä¸ªæœˆå‰ï¼Œæ•°å­¦å®¶ Andrew Beveridge å’ŒJie Shanåœ¨æ•°å­¦æ‚å¿—ä¸Šå‘è¡¨ã€ŠæƒåŠ›çš„ç½‘ç»œã€‹ï¼Œä¸»è¦åˆ†æç•…é”€å°è¯´ã€Šå†°ä¸ç«ä¹‹æ­Œã€‹ç¬¬ä¸‰éƒ¨ã€Šå†°é›¨çš„é£æš´ã€‹ä¸­äººç‰©å…³ç³»ï¼Œå…¶å·²ç»æ‹æˆç”µè§†å‰§ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹ç³»åˆ—ã€‚ä»–ä»¬åœ¨è®ºæ–‡ä¸­ä»‹ç»äº†å¦‚ä½•é€šè¿‡æ–‡æœ¬åˆ†æå’Œå®ä½“æå–æ„å»ºäººç‰©å…³ç³»çš„ç½‘ç»œã€‚ç´§æ¥ç€ï¼Œä½¿ç”¨ç¤¾äº¤ç½‘ç»œåˆ†æç®—æ³•å¯¹äººç‰©å…³ç³»ç½‘ç»œåˆ†ææ‰¾å‡ºæœ€é‡è¦çš„è§’è‰²ï¼›åº”ç”¨ç¤¾åŒºå‘ç°ç®—æ³•æ¥æ‰¾åˆ°äººç‰©èšç±»ã€‚ å…¶ä¸­çš„åˆ†æå’Œå¯è§†åŒ–æ˜¯ç”¨Gephiåšçš„ï¼ŒGephiæ˜¯éå¸¸æµè¡Œçš„å›¾åˆ†æå·¥å…·ã€‚ä½†ä½œè€…è§‰å¾—ä½¿ç”¨Neo4jæ¥å®ç°æ›´æœ‰è¶£ã€‚ å¯¼å…¥åŸå§‹æ•°æ®åˆ°Neo4jåŸå§‹æ•°æ®å¯ä»ç½‘ç»œä¸Šä¸‹è½½ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š 12345Source,Target,WeightAemon,Grenn,5Aemon,Samwell,31Aerys,Jaime,18... ä¸Šé¢æ˜¯äººç‰©å…³ç³»çš„ä¹‹é‚»æ¥è¡¨ä»¥åŠå…³ç³»æƒé‡ã€‚ä½œè€…ä½¿ç”¨ç®€å•çš„æ•°æ®æ¨¡å‹ï¼š 1(:Character &#123;name&#125;)-[:INTERACTS]-&gt;(:Character &#123;name&#125;) å¸¦æœ‰æ ‡ç­¾Characterçš„èŠ‚ç‚¹ä»£è¡¨å°è¯´ä¸­çš„è§’è‰²ï¼Œç”¨å•å‘å…³ç³»ç±»å‹INTERACTSä»£è¡¨å°è¯´ä¸­çš„è§’è‰²æœ‰è¿‡æ¥è§¦ã€‚èŠ‚ç‚¹å±æ€§ä¼šå­˜å‚¨è§’è‰²çš„åå­—nameï¼Œä¸¤è§’è‰²é—´æ¥è§¦çš„æ¬¡æ•°ä½œä¸ºå…³ç³»çš„å±æ€§ï¼šæƒé‡ï¼ˆweightï¼‰ã€‚ é¦–å…ˆåˆ›å»ºèŠ‚ç‚¹cï¼Œå¹¶åšå”¯ä¸€é™åˆ¶æ€§çº¦æŸï¼Œc.nameå”¯ä¸€ï¼Œä¿è¯schemaçš„å®Œæ•´æ€§ï¼š 1CREATE CONSTRAINT ON (c:Character) ASSERT c.name IS UNIQUE; ä¸€æ—¦çº¦æŸåˆ›å»ºå³ç›¸åº”çš„åˆ›å»ºç´¢å¼•ï¼Œè¿™å°†æœ‰åŠ©äºé€šè¿‡è§’è‰²çš„åå­—æŸ¥è¯¢çš„æ€§èƒ½ã€‚ä½œè€…ä½¿ç”¨Neo4jçš„Cypherï¼ˆCypheræ˜¯ä¸€ç§å£°æ˜å¼å›¾æŸ¥è¯¢è¯­è¨€ï¼Œèƒ½è¡¨è¾¾é«˜æ•ˆæŸ¥è¯¢å’Œæ›´æ–°å›¾æ•°æ®åº“ï¼‰LOAD CSVè¯­å¥å¯¼å…¥æ•°æ®ï¼š 12345LOAD CSV WITH HEADERS FROM &quot;https://www.macalester.edu/~abeverid/data/stormofswords.csv&quot; AS rowMERGE (src:Character &#123;name: row.Source&#125;)MERGE (tgt:Character &#123;name: row.Target&#125;)MERGE (src)-[r:INTERACTS]-&gt;(tgt)SET r.weight = toInt(row.Weight) è¿™æ ·å¾—åˆ°ä¸€ä¸ªç®€å•çš„æ•°æ®æ¨¡å‹ï¼š 1CALL apoc.meta.graph() æˆ‘ä»¬èƒ½å¯è§†åŒ–æ•´ä¸ªå›¾å½¢ï¼Œä½†æ˜¯è¿™å¹¶ä¸èƒ½ç»™æˆ‘ä»¬å¾ˆå¤šä¿¡æ¯ï¼Œæ¯”å¦‚å“ªäº›æ˜¯æœ€é‡è¦çš„äººç‰©ï¼Œä»¥åŠä»–ä»¬ç›¸äº’æ¥è§¦çš„ä¿¡æ¯ï¼š 12MATCH p=(:Character)-[:INTERACTS]-(:Character)RETURN p äººç‰©ç½‘ç»œåˆ†æä½œè€…ä½¿ç”¨Neo4jçš„å›¾æŸ¥è¯¢è¯­è¨€Cypheræ¥åšã€ŠæƒåŠ›çš„æ¸¸æˆã€‹å›¾åˆ†æï¼Œåº”ç”¨åˆ°äº†ç½‘ç»œåˆ†æçš„ä¸€äº›å·¥å…·ï¼Œå…·ä½“è§ã€Šç½‘ç»œï¼Œäººç¾¤å’Œå¸‚åœºï¼šå…³äºé«˜åº¦è¿æ¥çš„ä¸–ç•Œã€‹ã€‚ äººç‰©æ•°é‡ä¸‡äº‹ä»¥ç®€å•å¼€å§‹ã€‚å…ˆçœ‹çœ‹ä¸Šå›¾ä¸Šç”±æœ‰å¤šå°‘äººç‰©ï¼š 1MATCH (c:Character) RETURN count(c) count(c) 107 æ¦‚è¦ç»Ÿè®¡ç»Ÿè®¡æ¯ä¸ªè§’è‰²æ¥è§¦çš„å…¶å®ƒè§’è‰²çš„æ•°ç›®ï¼š 123MATCH (c:Character)-[:INTERACTS]-&gt;()WITH c, count(*) AS numRETURN min(num) AS min, max(num) AS max, avg(num) AS avg_characters, stdev(num) AS stdev min max avg_characters stdev 1 24 4.957746478873241 6.227672391875085 å›¾ï¼ˆç½‘ç»œï¼‰çš„ç›´å¾„ç½‘ç»œçš„ç›´å¾„æˆ–è€…æµ‹åº•çº¿æˆ–è€…æœ€é•¿æœ€çŸ­è·¯å¾„ï¼š 123456// Find maximum diameter of network// maximum shortest path between two nodesMATCH (a:Character), (b:Character) WHERE id(a) &gt; id(b)MATCH p=shortestPath((a)-[:INTERACTS*]-(b))RETURN length(p) AS len, extract(x IN nodes(p) | x.name) AS pathORDER BY len DESC LIMIT 4 len path 6 [Illyrio, Belwas, Daenerys, Robert, Tywin, Oberyn, Amory] 6 [Illyrio, Belwas, Daenerys, Robert, Sansa, Bran, Jojen] 6 [Illyrio, Belwas, Daenerys, Robert, Stannis, Davos, Shireen] 6 [Illyrio, Belwas, Daenerys, Robert, Sansa, Bran, Luwin] æˆ‘ä»¬èƒ½çœ‹åˆ°ç½‘ç»œä¸­æœ‰è®¸å¤šé•¿åº¦ä¸º6çš„è·¯å¾„ã€‚ æœ€çŸ­è·¯å¾„ä½œè€…ä½¿ç”¨Cypher çš„shortestPathå‡½æ•°æ‰¾åˆ°å›¾ä¸­ä»»æ„ä¸¤ä¸ªè§’è‰²ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚è®©æˆ‘ä»¬æ‰¾å‡ºå‡¯ç‰¹ç³Â·å²å¡”å…‹ï¼ˆCatelyn Stark ï¼‰å’Œå“æˆˆÂ·å¡å¥¥ï¼ˆKahl Drogoï¼‰ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼š 1234// Shortest path from Catelyn Stark to Khal DrogoMATCH (catelyn:Character &#123;name: &quot;Catelyn&quot;&#125;), (drogo:Character &#123;name: &quot;Drogo&quot;&#125;)MATCH p=shortestPath((catelyn)-[INTERACTS*]-(drogo))RETURN p æ‰€æœ‰æœ€çŸ­è·¯å¾„è”ç»“å‡¯ç‰¹ç³Â·å²å¡”å…‹ï¼ˆCatelyn Stark ï¼‰å’Œå“æˆˆÂ·å¡å¥¥ï¼ˆKahl Drogoï¼‰ä¹‹é—´çš„æœ€çŸ­è·¯å¾„å¯èƒ½è¿˜æœ‰å…¶å®ƒè·¯å¾„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Cypherçš„allShortestPathså‡½æ•°æ¥æŸ¥æ‰¾ï¼š 1234// All shortest paths from Catelyn Stark to Khal DrogoMATCH (catelyn:Character &#123;name: &quot;Catelyn&quot;&#125;), (drogo:Character &#123;name: &quot;Drogo&quot;&#125;)MATCH p=allShortestPaths((catelyn)-[INTERACTS*]-(drogo))RETURN p å…³é”®èŠ‚ç‚¹åœ¨ç½‘ç»œä¸­ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹ä½äºå…¶å®ƒä¸¤ä¸ªèŠ‚ç‚¹æ‰€æœ‰çš„æœ€çŸ­è·¯å¾„ä¸Šï¼Œå³ç§°ä¸ºå…³é”®èŠ‚ç‚¹ã€‚ä¸‹é¢æˆ‘ä»¬æ‰¾å‡ºç½‘ç»œä¸­æ‰€æœ‰çš„å…³é”®èŠ‚ç‚¹ï¼š 12345// Find all pivotal nodes in networkMATCH (a:Character), (b:Character)MATCH p=allShortestPaths((a)-[:INTERACTS*]-(b)) WITH collect(p) AS paths, a, bMATCH (c:Character) WHERE all(x IN paths WHERE c IN nodes(x)) AND NOT c IN [a,b]RETURN a.name, b.name, c.name AS PivotalNode SKIP 490 LIMIT 10 a.name b.name PivotalNode Aegon Thoros Daenerys Aegon Thoros Robert Drogo Ramsay Robb Styr Daario Daenerys Styr Daario Jon Styr Daario Robert Qhorin Podrick Jon Qhorin Podrick Sansa Orell Theon Jon Illyrio Bronn Belwas ä»ç»“æœè¡¨æ ¼ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæœ‰è¶£çš„ç»“æœï¼šç½—æŸÂ·å²å¡”å…‹ï¼ˆRobbï¼‰æ˜¯å“æˆˆÂ·å¡å¥¥ï¼ˆDrogoï¼‰å’Œæ‹‰å§†å¡Â·æ³¢é¡¿ï¼ˆRamsayï¼‰çš„å…³é”®èŠ‚ç‚¹ã€‚è¿™æ„å‘³ç€ï¼Œæ‰€æœ‰è”ç»“å“æˆˆÂ·å¡å¥¥ï¼ˆDrogoï¼‰å’Œæ‹‰å§†å¡Â·æ³¢é¡¿ï¼ˆRamsayï¼‰çš„æœ€çŸ­è·¯å¾„éƒ½è¦ç»è¿‡ç½—æŸÂ·å²å¡”å…‹ï¼ˆRobbï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯è§†åŒ–å“æˆˆÂ·å¡å¥¥ï¼ˆDrogoï¼‰å’Œæ‹‰å§†å¡Â·æ³¢é¡¿ï¼ˆRamsayï¼‰ä¹‹é—´çš„æ‰€æœ‰æœ€çŸ­è·¯å¾„æ¥éªŒè¯ï¼š 123MATCH (a:Character &#123;name: &quot;Drogo&quot;&#125;), (b:Character &#123;name: &quot;Ramsay&quot;&#125;)MATCH p=allShortestPaths((a)-[:INTERACTS*]-(b))RETURN p èŠ‚ç‚¹ä¸­å¿ƒåº¦èŠ‚ç‚¹ä¸­å¿ƒåº¦ç»™å‡ºç½‘ç»œä¸­èŠ‚ç‚¹çš„é‡è¦æ€§çš„ç›¸å¯¹åº¦é‡ã€‚æœ‰è®¸å¤šä¸åŒçš„æ–¹å¼æ¥åº¦é‡ä¸­å¿ƒåº¦ï¼Œæ¯ç§æ–¹å¼éƒ½ä»£è¡¨ä¸åŒç±»å‹çš„â€œé‡è¦æ€§â€ã€‚ åº¦ä¸­å¿ƒæ€§(Degree Centrality)åº¦ä¸­å¿ƒæ€§æ˜¯æœ€ç®€å•åº¦é‡ï¼Œå³ä¸ºæŸä¸ªèŠ‚ç‚¹åœ¨ç½‘ç»œä¸­çš„è”ç»“æ•°ã€‚åœ¨ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹çš„å›¾ä¸­ï¼ŒæŸä¸ªè§’è‰²çš„åº¦ä¸­å¿ƒæ€§æ˜¯æŒ‡è¯¥è§’è‰²æ¥è§¦çš„å…¶ä»–è§’è‰²æ•°ã€‚ä½œè€…ä½¿ç”¨Cypherè®¡ç®—åº¦ä¸­å¿ƒæ€§ï¼š 12MATCH (c:Character)-[:INTERACTS]-()RETURN c.name AS character, count(*) AS degree ORDER BY degree DESC character degree Tyrion 36 Jon 26 Sansa 26 Robb 25 Jaime 24 Tywin 22 Cersei 20 Arya 19 Joffrey 18 Robert 18 ä»ä¸Šé¢å¯ä»¥å‘ç°ï¼Œåœ¨ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹ç½‘ç»œä¸­æåˆ©æ˜‚Â·å…°å°¼æ–¯ç‰¹ï¼ˆTyrionï¼‰å’Œæœ€å¤šçš„è§’è‰²æœ‰æ¥è§¦ã€‚é‰´äºä»–çš„å¿ƒè®¡ï¼Œæˆ‘ä»¬è§‰å¾—è¿™æ˜¯æœ‰é“ç†çš„ã€‚ åŠ æƒåº¦ä¸­å¿ƒæ€§ï¼ˆWeighted Degree Centralityï¼‰ä½œè€…å­˜å‚¨ä¸€å¯¹è§’è‰²æ¥è§¦çš„æ¬¡æ•°ä½œä¸ºINTERACTSå…³ç³»çš„weightå±æ€§ã€‚å¯¹è¯¥è§’è‰²çš„INTERACTSå…³ç³»çš„æ‰€æœ‰weightç›¸åŠ å¾—åˆ°åŠ æƒåº¦ä¸­å¿ƒæ€§ã€‚ä½œè€…ä½¿ç”¨Cypherè®¡ç®—æ‰€æœ‰è§’è‰²çš„è¿™ä¸ªåº¦é‡ï¼š 12MATCH (c:Character)-[r:INTERACTS]-()RETURN c.name AS character, sum(r.weight) AS weightedDegree ORDER BY weightedDegree DESC character weightedDegree Tyrion 551 Jon 442 Sansa 383 Jaime 372 Bran 344 Robb 342 Samwell 282 Arya 269 Joffrey 255 Daenerys 232 ä»‹æ•°ä¸­å¿ƒæ€§ï¼ˆBetweenness Centralityï¼‰ä»‹æ•°ä¸­å¿ƒæ€§ï¼šåœ¨ç½‘ç»œä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹çš„ä»‹æ•°ä¸­å¿ƒæ€§æ˜¯æŒ‡å…¶å®ƒä¸¤ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰æœ€çŸ­è·¯å¾„éƒ½ç»è¿‡è¿™ä¸ªèŠ‚ç‚¹ï¼Œåˆ™è¿™äº›æ‰€æœ‰æœ€çŸ­è·¯å¾„æ•°å³ä¸ºæ­¤èŠ‚ç‚¹çš„ä»‹æ•°ä¸­å¿ƒæ€§ã€‚ä»‹æ•°ä¸­å¿ƒæ€§æ˜¯ä¸€ç§é‡è¦çš„åº¦é‡ï¼Œå› ä¸ºå®ƒå¯ä»¥é‰´åˆ«å‡ºç½‘ç»œä¸­çš„â€œä¿¡æ¯ä¸­é—´äººâ€æˆ–è€…ç½‘ç»œèšç±»åçš„è”ç»“ç‚¹ã€‚ ä¸ºäº†è®¡ç®—ä»‹æ•°ä¸­å¿ƒæ€§ï¼Œä½œè€…ä½¿ç”¨Neo4j 3.xæˆ–è€…apocåº“ã€‚å®‰è£…apocåèƒ½ç”¨Cypherè°ƒç”¨å…¶170+çš„ç¨‹åºï¼š 12345MATCH (c:Character)WITH collect(c) AS charactersCALL apoc.algo.betweenness([&apos;INTERACTS&apos;], characters, &apos;BOTH&apos;) YIELD node, scoreSET node.betweenness = scoreRETURN node.name AS name, score ORDER BY score DESC name score Jon 1279.7533534055322 Robert 1165.6025171231624 Tyrion 1101.3849724234349 Daenerys 874.8372110508583 Robb 706.5572832464792 Sansa 705.1985623519137 Stannis 571.5247305125714 Jaime 556.1852522889822 Arya 443.01358430043337 Tywin 364.7212195528086 ç´§åº¦ä¸­å¿ƒæ€§ï¼ˆCloseness centralityï¼‰ç´§åº¦ä¸­å¿ƒæ€§æ˜¯æŒ‡åˆ°ç½‘ç»œä¸­æ‰€æœ‰å…¶ä»–è§’è‰²çš„å¹³å‡è·ç¦»çš„å€’æ•°ã€‚åœ¨å›¾ä¸­ï¼Œå…·æœ‰é«˜ç´§åº¦ä¸­å¿ƒæ€§çš„èŠ‚ç‚¹åœ¨èšç±»ç¤¾åŒºä¹‹é—´è¢«é«˜åº¦è”ç»“ï¼Œä½†åœ¨ç¤¾åŒºä¹‹å¤–ä¸ä¸€å®šæ˜¯é«˜åº¦è”ç»“çš„ã€‚ 1234MATCH (c:Character)WITH collect(c) AS charactersCALL apoc.algo.closeness([&apos;INTERACTS&apos;], characters, &apos;BOTH&apos;) YIELD node, scoreRETURN node.name AS name, score ORDER BY score DESC name score Tyrion 0.004830917874396135 Sansa 0.004807692307692308 Robert 0.0047169811320754715 Robb 0.004608294930875576 Arya 0.0045871559633027525 Jaime 0.004524886877828055 Stannis 0.004524886877828055 Jon 0.004524886877828055 Tywin 0.004424778761061947 Eddard 0.004347826086956522 ä½¿ç”¨python-igraphNeo4jä¸å…¶å®ƒå·¥å…·ï¼ˆæ¯”å¦‚ï¼ŒRå’ŒPythonæ•°æ®ç§‘å­¦å·¥å…·ï¼‰å®Œç¾ç»“åˆã€‚æˆ‘ä»¬ç»§ç»­ä½¿ç”¨apocè¿è¡Œ PageRankå’Œç¤¾åŒºå‘ç°ï¼ˆcommunity detectionï¼‰ç®—æ³•ã€‚è¿™é‡Œæ¥ç€ä½¿ç”¨python-igraphè®¡ç®—åˆ†æã€‚Python-igraphç§»æ¤è‡ªRçš„igraphå›¾å½¢åˆ†æåº“ã€‚ ä½¿ç”¨pip install python-igraphå®‰è£…å®ƒã€‚ ä»Neo4jæ„å»ºä¸€ä¸ªigraphå®ä¾‹ä¸ºäº†åœ¨ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹çš„æ•°æ®çš„å›¾åˆ†æä¸­ä½¿ç”¨igraphï¼Œé¦–å…ˆéœ€è¦ä»Neo4jæ‹‰å–æ•°æ®ï¼Œç”¨Pythonå»ºç«‹igraphå®ä¾‹ã€‚ä½œè€…ä½¿ç”¨ Neo4j çš„Pythoné©±åŠ¨åº“py2neoã€‚æˆ‘ä»¬èƒ½ç›´æ¥ä¼ å…¥Py2neoæŸ¥è¯¢ç»“æœå¯¹è±¡åˆ°igraphçš„TupleListæ„é€ å™¨ï¼Œåˆ›å»ºigraphå®ä¾‹ï¼š 12345678910from py2neo import Graphfrom igraph import Graph as IGraphgraph = Graph()query = '''MATCH (c1:Character)-[r:INTERACTS]-&gt;(c2:Character)RETURN c1.name, c2.name, r.weight AS weight'''ig = IGraph.TupleList(graph.run(query), weights=True) ç°åœ¨æœ‰äº†igraphå¯¹è±¡ï¼Œå¯ä»¥è¿è¡Œigraphå®ç°çš„å„ç§å›¾ç®—æ³•æ¥ã€‚ PageRankä½œè€…ä½¿ç”¨igraphè¿è¡Œçš„ç¬¬ä¸€ä¸ªç®—æ³•æ˜¯PageRankã€‚PageRankç®—æ³•æºè‡ªGoogleçš„ç½‘é¡µæ’åã€‚å®ƒæ˜¯ä¸€ç§ç‰¹å¾å‘é‡ä¸­å¿ƒæ€§(eigenvector centrality)ç®—æ³•ã€‚ åœ¨igraphå®ä¾‹ä¸­è¿è¡ŒPageRankç®—æ³•ï¼Œç„¶åæŠŠç»“æœå†™å›Neo4jï¼Œåœ¨è§’è‰²èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ªpagerankå±æ€§å­˜å‚¨igraphè®¡ç®—çš„å€¼ï¼š 1234567891011121314pg = ig.pagerank()pgvs = []for p in zip(ig.vs, pg): print(p) pgvs.append(&#123;\"name\": p[0][\"name\"], \"pg\": p[1]&#125;)pgvswrite_clusters_query = '''UNWIND &#123;nodes&#125; AS nMATCH (c:Character) WHERE c.name = n.nameSET c.pagerank = n.pg'''graph.run(write_clusters_query, nodes=pgvs) ç°åœ¨å¯ä»¥åœ¨Neo4jçš„å›¾ä¸­æŸ¥è¯¢æœ€é«˜PageRankå€¼çš„èŠ‚ç‚¹ï¼š 12MATCH (n:Character)RETURN n.name AS name, n.pagerank AS pagerank ORDER BY pagerank DESC LIMIT 10 name pagerank Tyrion 0.042884981999963316 Jon 0.03582869669163558 Robb 0.03017114665594764 Sansa 0.030009716660108578 Daenerys 0.02881425425830273 Jaime 0.028727587587471206 Tywin 0.02570016262642541 Robert 0.022292016521362864 Cersei 0.022287327589773507 Arya 0.022050209663844467 ç¤¾åŒºå‘ç°ç®—æ³•ç”¨æ¥æ‰¾å‡ºå›¾ä¸­çš„ç¤¾åŒºèšç±»ã€‚ä½œè€…ä½¿ç”¨igraphå®ç°çš„éšæœºæ¸¸èµ°ç®—æ³•ï¼ˆ walktrapï¼‰æ¥æ‰¾åˆ°åœ¨ç¤¾åŒºä¸­é¢‘ç¹æœ‰æ¥è§¦çš„è§’è‰²ç¤¾åŒºï¼Œåœ¨ç¤¾åŒºä¹‹å¤–è§’è‰²ä¸æ€ä¹ˆæ¥è§¦ã€‚ åœ¨igraphä¸­è¿è¡Œéšæœºæ¸¸èµ°çš„ç¤¾åŒºå‘ç°ç®—æ³•ï¼Œç„¶åæŠŠç¤¾åŒºå‘ç°çš„ç»“æœå¯¼å…¥Neo4jï¼Œå…¶ä¸­æ¯ä¸ªè§’è‰²æ‰€å±çš„ç¤¾åŒºç”¨ä¸€ä¸ªæ•´æ•°æ¥è¡¨ç¤ºï¼š 1234567891011121314clusters = IGraph.community_walktrap(ig, weights=\"weight\").as_clustering()nodes = [&#123;\"name\": node[\"name\"]&#125; for node in ig.vs]for node in nodes: idx = ig.vs.find(name=node[\"name\"]).index node[\"community\"] = clusters.membership[idx]write_clusters_query = '''UNWIND &#123;nodes&#125; AS nMATCH (c:Character) WHERE c.name = n.nameSET c.community = toInt(n.community)'''graph.run(write_clusters_query, nodes=nodes) æˆ‘ä»¬èƒ½åœ¨Neo4jä¸­æŸ¥è¯¢æœ‰å¤šå°‘ä¸ªç¤¾åŒºä»¥åŠæ¯ä¸ªç¤¾åŒºçš„æˆå‘˜æ•°ï¼š 123MATCH (c:Character)WITH c.community AS cluster, collect(c.name) AS membersRETURN cluster, members ORDER BY cluster ASC cluster members 0 [Aemon, Alliser, Craster, Eddison, Gilly, Janos, Jon, Mance, Rattleshirt, Samwell, Val, Ygritte, Grenn, Karl, Bowen, Dalla, Orell, Qhorin, Styr] 1 [Aerys, Amory, Balon, Brienne, Bronn, Cersei, Gregor, Jaime, Joffrey, Jon Arryn, Kevan, Loras, Lysa, Meryn, Myrcella, Oberyn, Podrick, Renly, Robert, Robert Arryn, Sansa, Shae, Tommen, Tyrion, Tywin, Varys, Walton, Petyr, Elia, Ilyn, Pycelle, Qyburn, Margaery, Olenna, Marillion, Ellaria, Mace, Chataya, Doran] 2 [Arya, Beric, Eddard, Gendry, Sandor, Anguy, Thoros] 3 [Brynden, Catelyn, Edmure, Hoster, Lothar, Rickard, Robb, Roose, Walder, Jeyne, Roslin, Ramsay] 4 [Bran, Hodor, Jojen, Luwin, Meera, Rickon, Nan, Theon] 5 [Belwas, Daario, Daenerys, Irri, Jorah, Missandei, Rhaegar, Viserys, Barristan, Illyrio, Drogo, Aegon, Kraznys, Rakharo, Worm] 6 [Davos, Melisandre, Shireen, Stannis, Cressen, Salladhor] 7 [Lancel] è§’è‰²â€œå¤§åˆå½±â€ ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹çš„æƒåŠ›å›¾ã€‚èŠ‚ç‚¹çš„å¤§å°æ­£æ¯”äºä»‹æ•°ä¸­å¿ƒæ€§ï¼Œé¢œè‰²è¡¨ç¤ºç¤¾åŒºï¼ˆç”±éšæœºæ¸¸èµ°ç®—æ³•è·å¾—ï¼‰ï¼Œè¾¹çš„åšåº¦æ­£æ¯”äºä¸¤èŠ‚ç‚¹æ¥è§¦çš„æ¬¡æ•°ã€‚ç°åœ¨å·²ç»è®¡ç®—å¥½è¿™äº›å›¾çš„åˆ†ææ•°æ®ï¼Œè®©æˆ‘ä»¬å¯¹å…¶è¿›è¡Œå¯è§†åŒ–ï¼Œè®©æ•°æ®çœ‹èµ·æ¥æ›´æœ‰æ„ä¹‰ã€‚ Neo4jè‡ªå¸¦æµè§ˆå™¨å¯ä»¥å¯¹CypheræŸ¥è¯¢çš„ç»“æœè¿›è¡Œå¾ˆå¥½çš„å¯è§†åŒ–ï¼Œä½†å¦‚æœæˆ‘ä»¬æƒ³æŠŠå¯è§†åŒ–å¥½çš„å›¾åµŒå…¥åˆ°å…¶å®ƒåº”ç”¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨Javascriptå¯è§†åŒ–åº“Vis.jsã€‚ä»Neo4jæ‹‰å–æ•°æ®ï¼Œç”¨Vis.jsçš„neovis.jsæ„å»ºå¯è§†åŒ–å›¾ã€‚Neovis.jsæä¾›ç®€å•çš„APIé…ç½®ï¼Œä¾‹å¦‚ï¼š 1234567891011121314151617var config = &#123; container_id: \"viz\", server_url: \"localhost\", labels: &#123; \"Character\": \"name\" &#125;, label_size: &#123; \"Character\": \"betweenness\" &#125;, relationships: &#123; \"INTERACTS\": null &#125;, relationship_thickness: &#123; \"INTERACTS\": \"weight\" &#125;, cluster_labels: &#123; \"Character\": \"community\" &#125;&#125;;var viz = new NeoVis(config);viz.render(); å…¶ä¸­ï¼š èŠ‚ç‚¹å¸¦æœ‰æ ‡ç­¾Characterï¼Œå±æ€§nameï¼› èŠ‚ç‚¹çš„å¤§å°æ­£æ¯”äºbetweennesså±æ€§ï¼› å¯è§†åŒ–ä¸­åŒ…æ‹¬INTERACTSå…³ç³»ï¼› å…³ç³»çš„åšåº¦æ­£æ¯”äºweightå±æ€§ï¼› èŠ‚ç‚¹çš„é¢œè‰²æ˜¯æ ¹æ®ç½‘ç»œä¸­ç¤¾åŒºcommunityå±æ€§å†³å®šï¼› ä»æœ¬åœ°æœåŠ¡å™¨localhostæ‹‰å–Neo4jçš„æ•°æ®ï¼› åœ¨ä¸€ä¸ªidä¸ºvizçš„DOMå…ƒç´ ä¸­å±•ç¤ºå¯è§†åŒ–ã€‚ Resources A. Beveridge and J. Shan, â€œNetwork of Thronesâ€ Math Horizons Magazine , Vol. 23, No. 4 (2016), pp. 18-22. J. Kleinberg and D. Easley, Networks, Crowds, and Markets: Reasoning About a Highly Connected World. Cambridge University Press (2010)All code is available on Github. ã€å‚è€ƒèµ„æ–™ã€‘ Analyzing the Graph of Thrones â€“ by William Lyon åŸºäºç¤¾åŒºå‘ç°ç®—æ³•å’Œå›¾åˆ†æNeo4jè§£è¯»ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹ä¸Šç¯‡ åŸºäºç¤¾åŒºå‘ç°ç®—æ³•å’Œå›¾åˆ†æNeo4jè§£è¯»ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹ä¸‹ç¯‡","categories":[{"name":"Web","slug":"Web","permalink":"http://github.com/categories/Web/"}],"tags":[{"name":"Neo4j","slug":"Neo4j","permalink":"http://github.com/tags/Neo4j/"}],"keywords":[{"name":"Web","slug":"Web","permalink":"http://github.com/categories/Web/"}]},{"title":"ã€D3.jsã€‘åŠ›å¯¼å‘å¸ƒå±€ + åœ†å½¢å›¾ç‰‡å±•ç¤ºçš„äººç‰©å…³ç³»","slug":"ã€D3.jsã€‘åŠ›å¯¼å‘å¸ƒå±€ + åœ†å½¢å›¾ç‰‡å±•ç¤ºçš„äººç‰©å…³ç³»","date":"2016-11-18T08:06:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/11/18/ã€D3.jsã€‘åŠ›å¯¼å‘å¸ƒå±€ + åœ†å½¢å›¾ç‰‡å±•ç¤ºçš„äººç‰©å…³ç³»/","link":"","permalink":"http://github.com/2016/11/18/ã€D3.jsã€‘åŠ›å¯¼å‘å¸ƒå±€ + åœ†å½¢å›¾ç‰‡å±•ç¤ºçš„äººç‰©å…³ç³»/","excerpt":"å‰è¨€ä½¿ç”¨d3çš„åŠ›å­¦å›¾ï¼ˆåŠ›å¯¼å‘å›¾ï¼‰ä¸ç”Ÿæ´»ä¸­å¸¸è§çš„äººç‰©å…³ç³»å›¾ç»“åˆï¼Œå·²ç»æœ‰äº†å¾ˆå¥½çš„ä¾‹å­ï¼š ã€ D3.js è¿›é˜¶ç³»åˆ— â€” 2.0 ã€‘ åŠ›å­¦å›¾ + äººç‰©å…³ç³»å›¾ï¼Œåšä¸»å®ç°äº†ä¸‹é¢è¿™ç§æ ·å¼ï¼Œå·²ç»ç›¸å½“ä¸é”™äº†ã€‚ ä½†æ˜¯å¯¹äºæƒ³æŠŠèŠ‚ç‚¹çš„æ–¹å½¢å›¾ç‰‡æ¢æˆåœ†å½¢å¤´åƒï¼Œç½‘ä¸Šçš„èµ„æ–™å´å¾ˆå°‘ï¼Œæœ¬ä¾‹å­å°±åœ¨ä¸Šé¢çš„å®ä¾‹çš„åŸºç¡€ä¸Šå®ç°åœ†å½¢å¤´åƒï¼Œè®©äººç‰©å…³ç³»å›¾çœ‹èµ·æ¥æ›´æ¼‚äº®äº†ä¸€ä¸ªæ¡£æ¬¡ã€‚ä¸¤ä¸ªä¸»è¦æ–‡ä»¶å¦‚ä¸‹ï¼š","text":"å‰è¨€ä½¿ç”¨d3çš„åŠ›å­¦å›¾ï¼ˆåŠ›å¯¼å‘å›¾ï¼‰ä¸ç”Ÿæ´»ä¸­å¸¸è§çš„äººç‰©å…³ç³»å›¾ç»“åˆï¼Œå·²ç»æœ‰äº†å¾ˆå¥½çš„ä¾‹å­ï¼š ã€ D3.js è¿›é˜¶ç³»åˆ— â€” 2.0 ã€‘ åŠ›å­¦å›¾ + äººç‰©å…³ç³»å›¾ï¼Œåšä¸»å®ç°äº†ä¸‹é¢è¿™ç§æ ·å¼ï¼Œå·²ç»ç›¸å½“ä¸é”™äº†ã€‚ ä½†æ˜¯å¯¹äºæƒ³æŠŠèŠ‚ç‚¹çš„æ–¹å½¢å›¾ç‰‡æ¢æˆåœ†å½¢å¤´åƒï¼Œç½‘ä¸Šçš„èµ„æ–™å´å¾ˆå°‘ï¼Œæœ¬ä¾‹å­å°±åœ¨ä¸Šé¢çš„å®ä¾‹çš„åŸºç¡€ä¸Šå®ç°åœ†å½¢å¤´åƒï¼Œè®©äººç‰©å…³ç³»å›¾çœ‹èµ·æ¥æ›´æ¼‚äº®äº†ä¸€ä¸ªæ¡£æ¬¡ã€‚ä¸¤ä¸ªä¸»è¦æ–‡ä»¶å¦‚ä¸‹ï¼š # index.html123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171&lt;html&gt;&lt;head&gt; &lt;meta charset=\"utf-8\"&gt; &lt;title&gt;Force&lt;/title&gt; &lt;style&gt;.nodetext &#123; font-size: 12px ; font-family: SimSun; fill:#000000;&#125;.linetext &#123; font-size: 12px ; font-family: SimSun; fill:#1f77b4; fill-opacity:0.0;&#125;.circleImg &#123; stroke: #ff7f0e; stroke-width: 1.5px;&#125;&lt;/style&gt;&lt;/head&gt; &lt;body&gt; &lt;script src=\"http://d3js.org/d3.v3.min.js\" charset=\"utf-8\"&gt;&lt;/script&gt; &lt;script&gt; var width = 900; var height = 800; var img_w = 77; var img_h = 80; var radius = 30; //åœ†å½¢åŠå¾„ var svg = d3.select(\"body\").append(\"svg\") .attr(\"width\",width) .attr(\"height\",height); d3.json(\"relation.json\",function(error,root)&#123; if( error )&#123; return console.log(error); &#125; console.log(root); //D3åŠ›å¯¼å‘å¸ƒå±€ var force = d3.layout.force() .nodes(root.nodes) .links(root.edges) .size([width,height]) .linkDistance(200) .charge(-1500) .start(); //è¾¹ var edges_line = svg.selectAll(\"line\") .data(root.edges) .enter() .append(\"line\") .style(\"stroke\",\"#ccc\") .style(\"stroke-width\",1); //è¾¹ä¸Šçš„æ–‡å­—ï¼ˆäººç‰©ä¹‹é—´çš„å…³ç³»ï¼‰ var edges_text = svg.selectAll(\".linetext\") .data(root.edges) .enter() .append(\"text\") .attr(\"class\",\"linetext\") .text(function(d)&#123; return d.relation; &#125;); // åœ†å½¢å›¾ç‰‡èŠ‚ç‚¹ï¼ˆäººç‰©å¤´åƒï¼‰ var nodes_img = svg.selectAll(\"image\") .data(root.nodes) .enter() .append(\"circle\") .attr(\"class\", \"circleImg\") .attr(\"r\", radius) .attr(\"fill\", function(d, i)&#123; //åˆ›å»ºåœ†å½¢å›¾ç‰‡ var defs = svg.append(\"defs\").attr(\"id\", \"imgdefs\") var catpattern = defs.append(\"pattern\") .attr(\"id\", \"catpattern\" + i) .attr(\"height\", 1) .attr(\"width\", 1) catpattern.append(\"image\") .attr(\"x\", - (img_w / 2 - radius)) .attr(\"y\", - (img_h / 2 - radius)) .attr(\"width\", img_w) .attr(\"height\", img_h) .attr(\"xlink:href\", d.image) return \"url(#catpattern\" + i + \")\"; &#125;) .on(\"mouseover\",function(d,i)&#123; //æ˜¾ç¤ºè¿æ¥çº¿ä¸Šçš„æ–‡å­— edges_text.style(\"fill-opacity\",function(edge)&#123; if( edge.source === d || edge.target === d )&#123; return 1.0; &#125; &#125;); &#125;) .on(\"mouseout\",function(d,i)&#123; //éšå»è¿æ¥çº¿ä¸Šçš„æ–‡å­— edges_text.style(\"fill-opacity\",function(edge)&#123; if( edge.source === d || edge.target === d )&#123; return 0.0; &#125; &#125;); &#125;) .call(force.drag); var text_dx = -20; var text_dy = 20; var nodes_text = svg.selectAll(\".nodetext\") .data(root.nodes) .enter() .append(\"text\") .attr(\"class\",\"nodetext\") .attr(\"dx\",text_dx) .attr(\"dy\",text_dy) .text(function(d)&#123; return d.name; &#125;); force.on(\"tick\", function()&#123; //é™åˆ¶ç»“ç‚¹çš„è¾¹ç•Œ root.nodes.forEach(function(d,i)&#123; d.x = d.x - img_w/2 &lt; 0 ? img_w/2 : d.x ; d.x = d.x + img_w/2 &gt; width ? width - img_w/2 : d.x ; d.y = d.y - img_h/2 &lt; 0 ? img_h/2 : d.y ; d.y = d.y + img_h/2 + text_dy &gt; height ? height - img_h/2 - text_dy : d.y ; &#125;); //æ›´æ–°è¿æ¥çº¿çš„ä½ç½® edges_line.attr(\"x1\",function(d)&#123; return d.source.x; &#125;); edges_line.attr(\"y1\",function(d)&#123; return d.source.y; &#125;); edges_line.attr(\"x2\",function(d)&#123; return d.target.x; &#125;); edges_line.attr(\"y2\",function(d)&#123; return d.target.y; &#125;); //æ›´æ–°è¿æ¥çº¿ä¸Šæ–‡å­—çš„ä½ç½® edges_text.attr(\"x\",function(d)&#123; return (d.source.x + d.target.x) / 2 ; &#125;); edges_text.attr(\"y\",function(d)&#123; return (d.source.y + d.target.y) / 2 ; &#125;); //æ›´æ–°ç»“ç‚¹å›¾ç‰‡å’Œæ–‡å­— nodes_img.attr(\"cx\",function(d)&#123; return d.x &#125;); nodes_img.attr(\"cy\",function(d)&#123; return d.y &#125;); nodes_text.attr(\"x\",function(d)&#123; return d.x &#125;); nodes_text.attr(\"y\",function(d)&#123; return d.y + img_w/2; &#125;); &#125;); &#125;); &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; # relation.json1234567891011121314151617181920212223242526272829303132333435363738394041424344&#123;\"nodes\":[&#123; \"name\": \"äº‘å¤©æ²³\" , \"image\" : \"tianhe.png\" &#125;,&#123; \"name\": \"éŸ©è±çº±\" , \"image\" : \"lingsha.png\" &#125;,&#123; \"name\": \"æŸ³æ¢¦ç’ƒ\" , \"image\" : \"mengli.png\" &#125;,&#123; \"name\": \"æ…•å®¹ç´«è‹±\" , \"image\" : \"ziying.png\" &#125;,&#123; \"name\": \"äº‘å¤©é’\" , \"image\" : \"tianqing.png\" &#125;,&#123; \"name\": \"å¤™ç‰\" , \"image\" : \"suyu.png\" &#125;,&#123; \"name\": \"ç„éœ„\" , \"image\" : \"xuanxiao.png\" &#125;,&#123; \"name\": \"å¤™ç‘¶\" , \"image\" : \"suyao.png\" &#125;,&#123; \"name\": \"å¤ªæ¸…\" , \"image\" : \"taiqing.png\" &#125;,&#123; \"name\": \"å®—ç‚¼\" , \"image\" : \"zonglian.png\" &#125;,&#123; \"name\": \"å©µå¹½\" , \"image\" : \"chanyou.png\" &#125;,&#123; \"name\": \"å¥šä»²\" , \"image\" : \"xizhong.png\" &#125;,&#123; \"name\": \"å½’é‚ª\" , \"image\" : \"guixie.png\" &#125;],\"edges\":[&#123; \"source\": 0 , \"target\": 1 , \"relation\":\"æŒšå‹\" &#125;,&#123; \"source\": 0 , \"target\": 2 , \"relation\":\"æŒšå‹\" &#125;,&#123; \"source\": 0 , \"target\": 3 , \"relation\":\"æŒšå‹\" &#125;,&#123; \"source\": 1 , \"target\": 2 , \"relation\":\"æŒšå‹\" &#125;,&#123; \"source\": 1 , \"target\": 3 , \"relation\":\"æŒšå‹\" &#125;,&#123; \"source\": 2 , \"target\": 3 , \"relation\":\"æŒšå‹\" &#125;,&#123; \"source\": 0 , \"target\": 4 , \"relation\":\"çˆ¶å­\" &#125;,&#123; \"source\": 0 , \"target\": 5 , \"relation\":\"æ¯å­\" &#125;,&#123; \"source\": 4 , \"target\": 5 , \"relation\":\"å¤«å¦»\" &#125;,&#123; \"source\": 0 , \"target\": 6 , \"relation\":\"ä¹‰å…„å¼Ÿ\" &#125;,&#123; \"source\": 4 , \"target\": 6 , \"relation\":\"åŒé—¨\" &#125;,&#123; \"source\": 5 , \"target\": 6 , \"relation\":\"åŒé—¨\" &#125;,&#123; \"source\": 4 , \"target\": 7 , \"relation\":\"åŒé—¨\" &#125;,&#123; \"source\": 5 , \"target\": 7 , \"relation\":\"åŒé—¨\" &#125;,&#123; \"source\": 6 , \"target\": 7 , \"relation\":\"åŒé—¨\" &#125;,&#123; \"source\": 4 , \"target\": 8 , \"relation\":\"å¸ˆå¾’\" &#125;,&#123; \"source\": 5 , \"target\": 8 , \"relation\":\"å¸ˆå¾’\" &#125;,&#123; \"source\": 6 , \"target\": 8 , \"relation\":\"å¸ˆå¾’\" &#125;,&#123; \"source\": 7 , \"target\": 8 , \"relation\":\"å¸ˆå¾’\" &#125;,&#123; \"source\": 8 , \"target\": 9 , \"relation\":\"åŒé—¨\" &#125;,&#123; \"source\": 3 , \"target\": 9 , \"relation\":\"å¸ˆå¾’\" &#125;,&#123; \"source\": 2 , \"target\": 10 , \"relation\":\"æ¯å­\" &#125;,&#123; \"source\": 10 , \"target\": 11 , \"relation\":\"ä¸»è‡£\" &#125;,&#123; \"source\": 10 , \"target\": 12 , \"relation\":\"ä¸»è‡£\" &#125;,&#123; \"source\": 11 , \"target\": 12 , \"relation\":\"åŒåƒš\" &#125;]&#125; ã€å‚è€ƒèµ„æ–™ã€‘ ã€ D3.js è¿›é˜¶ç³»åˆ— â€” 2.0 ã€‘ åŠ›å­¦å›¾ + äººç‰©å…³ç³»å›¾ how to make an image round in d3.js ç”¨D3ç”»ç®€å•çš„åŠ›å¯¼å›¾","categories":[{"name":"D3.js","slug":"D3-js","permalink":"http://github.com/categories/D3-js/"}],"tags":[{"name":"D3","slug":"D3","permalink":"http://github.com/tags/D3/"}],"keywords":[{"name":"D3.js","slug":"D3-js","permalink":"http://github.com/categories/D3-js/"}]},{"title":"ã€Androidã€‘å¾®ä¿¡çƒ­ä¿®å¤ Tinker çš„é›†æˆå’Œä½¿ç”¨","slug":"ã€Androidã€‘å¾®ä¿¡çƒ­ä¿®å¤ Tinker çš„é›†æˆå’Œä½¿ç”¨","date":"2016-11-17T03:51:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/11/17/ã€Androidã€‘å¾®ä¿¡çƒ­ä¿®å¤ Tinker çš„é›†æˆå’Œä½¿ç”¨/","link":"","permalink":"http://github.com/2016/11/17/ã€Androidã€‘å¾®ä¿¡çƒ­ä¿®å¤ Tinker çš„é›†æˆå’Œä½¿ç”¨/","excerpt":"ç®€ä»‹ Tinkerï¼š n. ã€ˆè‹±ã€‰å°ç‚‰åŒ ï¼Œè¡¥é”…åŒ ï¼Œä¿®è¡¥åŒ  Tinker æ˜¯å¾®ä¿¡å®˜æ–¹å¼€æºçš„ Android çƒ­ä¿®å¤æ¡†æ¶ï¼Œæ”¯æŒåœ¨æ— éœ€å‡çº§APKçš„å‰æä¸‹æ›´æ–° dex, library and resources æ–‡ä»¶ã€‚å®ƒä¹Ÿå°±æ˜¯ä»Šå¹´9æœˆ24æ‰åˆšåˆšå¼€æºï¼Œå‡ å¤©åŠŸå¤«staræ•°å°±è¶…è¿‡3000ï¼Œå¯è§åœ¨å¼€å‘è€…ä¸­çš„å½±å“åŠ›æœ‰å¤šå¤§ï¼Œä¹Ÿè¯´æ˜è¿™æ˜¯ä¸€ä¸ªåˆšéœ€ã€‚ Tinker GitHub: https://github.com/Tencent/tinker ä½¿ç”¨æ­¥éª¤ä¸€ä¸ªå°å‘å¾ˆå¤šäººé‡åˆ°çš„ç¬¬ä¸€ä¸ªé”™è¯¯å°±æ˜¯æç¤º tinkerId is not set ï¼Œè¿™ä¸ªåœ¨tinker-sample-androidçš„app/build.gradle ä¸­é»˜è®¤è®¾ç½®ä¸ºGitçš„æäº¤ç‰ˆæœ¬å·ï¼Œå¦‚ä¸‹ 123def getTinkerIdValue() &#123; return hasProperty(\"TINKER_ID\") ? TINKER_ID : gitSha()&#125; å¦‚æœä¸æ˜¯é€šè¿‡git cloneæ–¹å¼ä¸‹è½½çš„å°±å¯èƒ½å‡ºç°è¿™ä¸ªé”™è¯¯ï¼Œå…¶å®å¯ä»¥ç®€å•ç²—æš´çš„æ–¹å¼è§£å†³ï¼Œé‚£å°±æ˜¯åœ¨app/build.gradleä¸­æŠŠtinker idå†™æ­»ï¼š 123def getTinkerIdValue() &#123; return hasProperty(\"TINKER_ID\") ? TINKER_ID : \"tinker_id_2333\"&#125; ä¸‹é¢ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä¸€æ­¥æ­¥çš„æŠŠTinkeré›†æˆåˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œä»¥åŠä¼šé‡åˆ°å“ªäº›é—®é¢˜è¯¥å¦‚ä½•è§£å†³ã€‚","text":"ç®€ä»‹ Tinkerï¼š n. ã€ˆè‹±ã€‰å°ç‚‰åŒ ï¼Œè¡¥é”…åŒ ï¼Œä¿®è¡¥åŒ  Tinker æ˜¯å¾®ä¿¡å®˜æ–¹å¼€æºçš„ Android çƒ­ä¿®å¤æ¡†æ¶ï¼Œæ”¯æŒåœ¨æ— éœ€å‡çº§APKçš„å‰æä¸‹æ›´æ–° dex, library and resources æ–‡ä»¶ã€‚å®ƒä¹Ÿå°±æ˜¯ä»Šå¹´9æœˆ24æ‰åˆšåˆšå¼€æºï¼Œå‡ å¤©åŠŸå¤«staræ•°å°±è¶…è¿‡3000ï¼Œå¯è§åœ¨å¼€å‘è€…ä¸­çš„å½±å“åŠ›æœ‰å¤šå¤§ï¼Œä¹Ÿè¯´æ˜è¿™æ˜¯ä¸€ä¸ªåˆšéœ€ã€‚ Tinker GitHub: https://github.com/Tencent/tinker ä½¿ç”¨æ­¥éª¤ä¸€ä¸ªå°å‘å¾ˆå¤šäººé‡åˆ°çš„ç¬¬ä¸€ä¸ªé”™è¯¯å°±æ˜¯æç¤º tinkerId is not set ï¼Œè¿™ä¸ªåœ¨tinker-sample-androidçš„app/build.gradle ä¸­é»˜è®¤è®¾ç½®ä¸ºGitçš„æäº¤ç‰ˆæœ¬å·ï¼Œå¦‚ä¸‹ 123def getTinkerIdValue() &#123; return hasProperty(\"TINKER_ID\") ? TINKER_ID : gitSha()&#125; å¦‚æœä¸æ˜¯é€šè¿‡git cloneæ–¹å¼ä¸‹è½½çš„å°±å¯èƒ½å‡ºç°è¿™ä¸ªé”™è¯¯ï¼Œå…¶å®å¯ä»¥ç®€å•ç²—æš´çš„æ–¹å¼è§£å†³ï¼Œé‚£å°±æ˜¯åœ¨app/build.gradleä¸­æŠŠtinker idå†™æ­»ï¼š 123def getTinkerIdValue() &#123; return hasProperty(\"TINKER_ID\") ? TINKER_ID : \"tinker_id_2333\"&#125; ä¸‹é¢ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä¸€æ­¥æ­¥çš„æŠŠTinkeré›†æˆåˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œä»¥åŠä¼šé‡åˆ°å“ªäº›é—®é¢˜è¯¥å¦‚ä½•è§£å†³ã€‚ ä¸€ã€å·¥ç¨‹æ ¹ç›®å½•çš„build.gradleä¸­æ·»åŠ ä¾èµ–åœ¨é¡¹ç›®çš„build.gradleä¸­ï¼Œæ·»åŠ tinker-patch-gradle-pluginçš„ä¾èµ– 12345buildscript &#123; dependencies &#123; classpath ('com.tencent.tinker:tinker-patch-gradle-plugin:1.7.3') &#125;&#125; æ­¤æ—¶å¦‚æœgradle Syncä¸æˆåŠŸå¯èƒ½æ˜¯å› ä¸ºæ²¡æœ‰åŠ å…¥ jcenterä»“åº“ 1234567891011buildscript &#123; repositories &#123; mavenLocal() jcenter() //æ³¨æ„è¿™é‡Œï¼Œå› ä¸ºmavenä»“åº“é‡Œæ²¡æœ‰ &#125; dependencies &#123; classpath 'com.android.tools.build:gradle:2.2.2' classpath \"com.tencent.tinker:tinker-patch-gradle-plugin:$&#123;TINKER_VERSION&#125;\" &#125; // default values for all sub projects&#125; äºŒã€åœ¨app/build.gradleä¸­çš„dependenciesèŠ‚ç‚¹æ·»åŠ ä¾èµ–123456dependencies &#123; //å¯é€‰ï¼Œç”¨äºç”Ÿæˆapplicationç±» provided('com.tencent.tinker:tinker-android-anno:1.7.3') //tinkerçš„æ ¸å¿ƒåº“ compile('com.tencent.tinker:tinker-android-lib:1.7.3') &#125; ä¸‰ã€å¤åˆ¶å®˜æ–¹sampleå·¥ç¨‹app/build.gradleä¸­çš„å…¶ä»–ç›¸å…³é…ç½®æŠŠå®˜æ–¹ tinker-sample-android å·¥ç¨‹ä¸­çš„app/build.gradleå¤åˆ¶åˆ°è‡ªå·±çš„app/build.gradleä¸­ï¼Œç‰¹åˆ«æ˜¯æœ€ä¸‹é¢çš„task ä»£ç å—ï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆpatchã€‚ å››ã€æ›¿æ¢è‡ªå·±çš„Applicationç±»è¿™ä¸€å—éœ€è¦ç‰¹æ®Šè¯´æ˜ä¸€ä¸‹ï¼Œtinkerä¸ºäº†è¾¾åˆ°ä¿®æ”¹åº”ç”¨è‡ªå·±çš„Applicationçš„ç›®çš„ï¼Œä½¿ç”¨ä»£ç æ¡†æ¶å°è£…ç»§æ‰¿DefaultApplicationLikeçš„æ–¹å¼æ¥å®ç°å¯¹Applicationçš„ä¿®æ”¹ï¼Œä¸»è¦ä¸ºäº†å‡å°‘åå°„çš„ä½¿ç”¨å’Œæé«˜å…¼å®¹æ€§ï¼Œå…·ä½“è¯´æ˜å‚è€ƒ Tinker Wikiï¼šè‡ªå®šä¹‰Applicationç±»ã€‚ åœ¨æ›¿æ¢æ›´æ”¹ä¹‹å‰ï¼Œå¼ºçƒˆå»ºè®®å…ˆæŠŠé¡¹ç›®ä¸­çš„Applicationç±»åšä¸ªå¤‡ä»½ã€‚å› ä¸ºéœ€è¦é‡‡ç”¨Annotationè‡ªåŠ¨ç”ŸæˆApplicationï¼ŒåŸæ¥çš„Applicationç±»éœ€è¦åˆ æ‰ã€‚ ç„¶åæˆ‘ä»¬ä¿®æ”¹é¡¹ç›®çš„ Application ï¼Œä½¿ä¹‹ç»§æ‰¿DefaultApplicationLike; è¿™å—çš„ç¡®æœ‰ç‚¹å¥‡è‘©,è¿™ä¸ªDefaultApplicationLikeä¸æ˜¯ç»§æ‰¿è‡ªApplicationï¼Œéœ€è¦ç”¨æ³¨è§£æ¥è®¾ç½®é¡¹ç›®ä¸­çœŸæ­£çš„Applicationï¼ŒTinkeræ’ä»¶ä¼šè‡ªåŠ¨ç”ŸæˆçœŸæ­£çš„Applicationã€‚ 12345678910@DefaultLifeCycle(application = \"com.cuc.android.aps.MyApplication\",//é€šè¿‡æ³¨è§£ï¼Œç”±tinkerè‡ªåŠ¨ç”ŸæˆMyApplication flags = ShareConstants.TINKER_ENABLE_ALL, //tinkerFlags loaderClass = \"com.tencent.tinker.loader.TinkerLoader\", //loaderClassName, æˆ‘ä»¬è¿™é‡Œä½¿ç”¨é»˜è®¤ loadVerifyFlag = false) public class ApplicationFromTinkerLike extends DefaultApplicationLike &#123; public ApplicationFromTinkerLike(Application application, int tinkerFlags, boolean tinkerLoadVerifyFlag, long applicationStartElapsedTime, long applicationStartMillisTime, Intent tinkerResultIntent, Resources[] resources, ClassLoader[] classLoader, AssetManager[] assetManager) &#123; super(application, tinkerFlags, tinkerLoadVerifyFlag, applicationStartElapsedTime, applicationStartMillisTime, tinkerResultIntent, resources, classLoader, assetManager); &#125;&#125; ä¸Šè¾¹çš„com.cuc.android.aps.MyApplicationå°±æ˜¯çœŸæ­£çš„Application,ä¸ç”¨æˆ‘ä»¬è‡ªå·±å†™,æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ã€‚ç„¶åä¿®æ”¹manifest.xmlå°†applicationæŒ‡å‘com.cuc.android.aps.MyApplicationå°±è¡Œï¼Œå¼€å§‹ä¼šæŠ¥é”™ï¼Œbuildä¸€ä¸‹é¡¹ç›®å°±å¥½äº†ã€‚ äº”ã€åœ¨åˆšæ”¹å¥½çš„ ApplicationFromTinkerLike ä¸­é‡è½½onBaseContextAttachedæ–¹æ³•å¹¶åœ¨è¯¥æ–¹æ³•ä¸­å¢åŠ ä»¥ä¸‹ä»£ç è°ƒç”¨åˆå§‹åŒ–tinker 12345678@Overridepublic void onBaseContextAttached(Context base) &#123; super.onBaseContextAttached(base); //you must install multiDex whatever tinker is installed! MultiDex.install(base); TinkerInstaller.install(this);&#125; æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†Sampleå·¥ç¨‹ä¸­çš„æ–‡ä»¶ï¼ˆç‰¹åˆ«æ˜¯UtilsåŒ…ä¸‹çš„ï¼‰æ‹·è´åˆ°æˆ‘ä»¬è‡ªå·±çš„å·¥ç¨‹ä¸­ï¼Œå°±åƒæˆ‘ä¸€æ ·ï¼Œæ–¹ä¾¿åæœŸä½¿ç”¨ã€‚æ¯”å¦‚SampleResultServiceã€TinkerManagerè¿™å‡ ä¸ªç±» ç„¶åé‡è½½onBaseContextAttachedæ–¹æ³•ï¼Œå¯ä»¥åƒæˆ‘ä¸€æ ·å†™æˆä¸‹é¢è¿™æ · 1234567891011121314151617181920@Overridepublic void onBaseContextAttached(Context base) &#123; super.onBaseContextAttached(base); //you must install multiDex whatever tinker is installed! MultiDex.install(base); MyApplicationContext.application = (MyApplication) getApplication(); MyApplicationContext.context = getApplication(); TinkerManager.setTinkerApplicationLike(this); TinkerManager.initFastCrashProtect(); //should set before tinker is installed TinkerManager.setUpgradeRetryEnable(true); //optional set logIml, or you can use default debug log TinkerInstaller.setLogIml(new MyLogImp()); //installTinker after load multiDex //or you can put com.tencent.tinker.** to main dex TinkerManager.installTinker(this);&#125; è‡³æ­¤ï¼Œè‡ªå®šä¹‰Applicationï¼Œä¹Ÿå°±æ˜¯å°†Applicationä¸­çš„å®ç°ç§»åŠ¨åˆ°SampleApplicationLikeä¸­å·²ç»å®Œæˆã€‚ å…­ã€å¯ä»¥å¼€å§‹å†™æµ‹è¯•patchçš„ä»£ç å•¦ä½¿ç”¨ä¸‹é¢ä»£ç æ¥load patch 1TinkerInstaller.onReceiveUpgradePatch(this.getApplication(), Environment.getExternalStorageDirectory().getAbsolutePath() + \"/patch_signed_7zip.apk\"); åœ¨è‡ªå·±çš„å·¥ç¨‹ä¸­å¢åŠ ä¸¤ä¸ªæŒ‰é’®ï¼Œå…¶ä¸­ä¸€ä¸ªæŒ‰é’®ç”¨æ¥æ˜¾ç¤ºEditTextä¸­çš„å†…å®¹ï¼Œå¦ä¸€ä¸ªæŒ‰é’®ç”¨æ¥åŠ è½½è¡¥ä¸ï¼Œåœ¨åŠ è½½è¡¥ä¸æŒ‰é’®ç‚¹å‡»äº‹ä»¶ä¸­æ‰§è¡ŒåŠ è½½patchçš„æ“ä½œï¼Œä¸ºåæœŸä¿®å¤ä»£ç bugåšå‡†å¤‡ï¼Œä»£ç ä¸ºï¼š1234567891011121314151617Button toastInfo = (Button) top.findViewById(R.id.toastInfo);toastInfo.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; //æ¸…é™¤è¡¥ä¸ Toast.makeText(SysUtils.getApp(),\"clean patch!\",Toast.LENGTH_LONG).show(); Tinker.with(SysUtils.getApp()).cleanPatch(); &#125;&#125;);Button loadPatchButton = (Button) top.findViewById(R.id.loadPatch);loadPatchButton.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; //åŠ è½½è¡¥ä¸ï¼ˆåŠ è½½æˆåŠŸä»¥åpatchæ–‡ä»¶ä¼šè‡ªåŠ¨åˆ æ‰ï¼‰ TinkerInstaller.onReceiveUpgradePatch(SysUtils.getApp(), Environment.getExternalStorageDirectory().getAbsolutePath() + \"/patch_signed_7zip.apk\"); &#125;&#125;); æ‰“patchåŒ…çš„æ­¥éª¤1ã€è°ƒç”¨assembleDebugç¼–è¯‘åŸå§‹åŒ…AndroidStudio å‘½ä»¤è¡Œä¸‹è¿è¡Œ 1$ ./gradlew assembleDebug ç¼–è¯‘è¿‡çš„åŒ…ä¼šä¿å­˜åœ¨build/bakApkä¸­ã€‚ç„¶åæˆ‘ä»¬å°†å®ƒå®‰è£…åˆ°æ‰‹æœºï¼Œå¯ä»¥çœ‹åˆ°è¡¥ä¸å¹¶æ²¡æœ‰åŠ è½½ã€‚ 2ã€ä¿®æ”¹ä»£ç ï¼Œæ·»åŠ æ–°åŠŸèƒ½æˆ–è€…æ›´æ”¹åŠŸèƒ½ä¾‹å¦‚åœ¨MainActivityä¸­æ·»åŠ ä¸€ä¸ªI am on patch onCreateçš„Toast. 3ã€ç„¶åä¿®æ”¹build.gradleä¸­çš„å‚æ•°å°†æ­¥éª¤ä¸€ç¼–è¯‘ä¿å­˜çš„å®‰è£…åŒ…è·¯å¾„æ‹·è´åˆ°tinkerPatchä¸­çš„tinkerOldApkPathå‚æ•°ä¸­ï¼Œæ ¹æ®éœ€è¦ä¹Ÿå¾—åŒæ—¶ä¿®æ”¹tinkerApplyResourcePath ï¼ŒtinkerApplyMappingPath ã€‚ 1234567891011121314151617181920/** * you can use assembleRelease to build you base apk * use tinkerPatchRelease -POLD_APK= -PAPPLY_MAPPING= -PAPPLY_RESOURCE= to build patch * add apk from the build/bakApk */ext &#123; //for some reason, you may want to ignore tinkerBuild, such as instant run debug build? tinkerEnabled = true //for normal build //old apk file to build patch apk tinkerOldApkPath = \"$&#123;bakPath&#125;/app-debug-1116-15-53-17.apk\" //proguard mapping file to build patch apk tinkerApplyMappingPath = \"$&#123;bakPath&#125;/app-debug-1116-15-53-17-mapping.txt\" //resource R.txt to build patch apk, must input if there is resource changed tinkerApplyResourcePath = \"$&#123;bakPath&#125;/app-debug-1116-15-53-17-R.txt\" //only use for build all flavor, if not, just ignore this field tinkerBuildFlavorDirectory = \"$&#123;bakPath&#125;/app-debug-1107-10-33-32\"&#125; 4ã€è°ƒç”¨tinkerPatchDebug, ç”Ÿæˆè¡¥ä¸åŒ…1$ ./gradlew tinkerPatchDebug è¡¥ä¸åŒ…ä¸ç›¸å…³æ—¥å¿—ä¼šä¿å­˜åœ¨/build/outputs/tinkerPatch/ä¸­ï¼Œæˆ‘ä»¬å°†å…¶ä¸­çš„patch_signed_7zip.apkæ¨é€åˆ°æ‰‹æœºçš„sdcardä¸­ã€‚ 1$ adb push ./app/build/outputs/tinkerPatch/debug/patch_signed_7zip.apk /storage/sdcard0/ 5ã€è¿è¡Œappï¼Œæ‰§è¡ŒLOAD PATCHä»£ç å—å¦‚æœçœ‹åˆ°patch success, please restart processçš„toastï¼Œå³å¯é”å±æˆ–è€…KILL åº”ç”¨è¿›ç¨‹ã€‚ 6ã€é‡æ–°å¯åŠ¨Appæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¡¥ä¸åŒ…çš„ç¡®å·²ç»åŠ è½½æˆåŠŸäº†ã€‚ ä½¿ç”¨Tinkerçš„æ³¨æ„äº‹é¡¹ 1ã€Tinker_idçš„å¤§ç‰ˆæœ¬å‡çº§é—®é¢˜ 2ã€å¦‚æœç”Ÿæˆpatchå¤±è´¥ï¼Œå¹¶ä¸”åŸå› å¦‚ä¸‹ï¼š 1Warning: ignoreWarning is false, but we found loader classes are found in old secondary dex. é‚£ä¹ˆéœ€è¦æŠŠç›¸åº”çš„æŠ¥é”™ç±»å£°æ˜åœ¨é¡¹ç›®çš„keep_in_main_dex.txt æ–‡ä»¶ä¸­ï¼Œä¿è¯å®ƒç¼–è¯‘æ—¶ä¼šè¢«æ”¾ç½®åˆ°ä¸»dexä¸­ã€‚å‚è€ƒTinker Issue #96 ã€‚ ã€å‚è€ƒèµ„æ–™ã€‘ Tinker å®˜æ–¹æ¥å…¥æŒ‡å— å¾®ä¿¡Androidçƒ­è¡¥ä¸å®è·µæ¼”è¿›ä¹‹è·¯ å¾®ä¿¡Tinkerçš„ä¸€åˆ‡éƒ½åœ¨è¿™é‡Œï¼ŒåŒ…æ‹¬æºç (ä¸€) ã€è…¾è®¯Buglyå¹²è´§åˆ†äº«ã€‘å¾®ä¿¡çƒ­è¡¥ä¸Tinkerçš„å®è·µæ¼”è¿›ä¹‹è·¯ å°†Tinkeé›†æˆåˆ°è‡ªå·±çš„é¡¹ç›® Android å¾®ä¿¡çƒ­ä¿®å¤Tinkeræ¥å…¥è¿‡ç¨‹ä»¥åŠä½¿ç”¨æ–¹æ³• Tinker é€†å‘åˆ†æ","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"hotfix","slug":"hotfix","permalink":"http://github.com/tags/hotfix/"},{"name":"Tinker","slug":"Tinker","permalink":"http://github.com/tags/Tinker/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€D3ã€‘Link Nodes by Name","slug":"ã€D3ã€‘Link Nodes by Name","date":"2016-11-16T08:08:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/11/16/ã€D3ã€‘Link Nodes by Name/","link":"","permalink":"http://github.com/2016/11/16/ã€D3ã€‘Link Nodes by Name/","excerpt":"Source : http://bl.ocks.org/mbostock/533daf20348023dfdd76 This example shows how to link nodes in a force-directed graph using a named identifier rather than a numeric index.","text":"Source : http://bl.ocks.org/mbostock/533daf20348023dfdd76 This example shows how to link nodes in a force-directed graph using a named identifier rather than a numeric index. # index.html123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;!DOCTYPE html&gt;&lt;meta charset=\"utf-8\"&gt;&lt;style&gt;.node &#123; stroke: #000; stroke-width: 1.5px;&#125;.link &#123; stroke: #999; stroke-width: 1.5px;&#125;&lt;/style&gt;&lt;svg width=\"960\" height=\"500\"&gt;&lt;/svg&gt;&lt;script src=\"//d3js.org/d3.v4.min.js\"&gt;&lt;/script&gt;&lt;script&gt;var svg = d3.select(\"svg\"), width = +svg.attr(\"width\"), height = +svg.attr(\"height\");var simulation = d3.forceSimulation() .force(\"charge\", d3.forceManyBody().strength(-200)) .force(\"link\", d3.forceLink().id(function(d) &#123; return d.id; &#125;).distance(40)) .force(\"x\", d3.forceX(width / 2)) .force(\"y\", d3.forceY(height / 2)) .on(\"tick\", ticked);var link = svg.selectAll(\".link\"), node = svg.selectAll(\".node\");d3.json(\"graph.json\", function(error, graph) &#123; if (error) throw error; simulation.nodes(graph.nodes); simulation.force(\"link\").links(graph.links); link = link .data(graph.links) .enter().append(\"line\") .attr(\"class\", \"link\"); node = node .data(graph.nodes) .enter().append(\"circle\") .attr(\"class\", \"node\") .attr(\"r\", 6) .style(\"fill\", function(d) &#123; return d.id; &#125;);&#125;);function ticked() &#123; link.attr(\"x1\", function(d) &#123; return d.source.x; &#125;) .attr(\"y1\", function(d) &#123; return d.source.y; &#125;) .attr(\"x2\", function(d) &#123; return d.target.x; &#125;) .attr(\"y2\", function(d) &#123; return d.target.y; &#125;); node.attr(\"cx\", function(d) &#123; return d.x; &#125;) .attr(\"cy\", function(d) &#123; return d.y; &#125;);&#125;&lt;/script&gt; # graph.json123456789101112131415&#123; \"nodes\": [ &#123;\"id\": \"red\"&#125;, &#123;\"id\": \"orange\"&#125;, &#123;\"id\": \"yellow\"&#125;, &#123;\"id\": \"green\"&#125;, &#123;\"id\": \"blue\"&#125;, &#123;\"id\": \"violet\"&#125; ], \"links\": [ &#123;\"source\": \"red\", \"target\": \"yellow\"&#125;, &#123;\"source\": \"red\", \"target\": \"blue\"&#125;, &#123;\"source\": \"red\", \"target\": \"green\"&#125; ]&#125;","categories":[{"name":"D3.js","slug":"D3-js","permalink":"http://github.com/categories/D3-js/"}],"tags":[{"name":"D3","slug":"D3","permalink":"http://github.com/tags/D3/"}],"keywords":[{"name":"D3.js","slug":"D3-js","permalink":"http://github.com/categories/D3-js/"}]},{"title":"Android çƒ­ä¿®å¤åŸç†å’Œå®ç°","slug":"Android çƒ­ä¿®å¤åŸç†å’Œå®ç°","date":"2016-11-10T05:06:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/11/10/Android çƒ­ä¿®å¤åŸç†å’Œå®ç°/","link":"","permalink":"http://github.com/2016/11/10/Android çƒ­ä¿®å¤åŸç†å’Œå®ç°/","excerpt":"æŸ¥çœ‹åŸæ–‡ï¼š Android çƒ­ä¿®å¤ï¼Œæ²¡ä½ æƒ³çš„é‚£ä¹ˆéš¾ â€”â€” by kymjså¼ æ¶› ä¸€ç§åŠ¨æ€åŠ è½½æœ€ç®€å•çš„å®ç°æ–¹å¼ï¼Œä»£ç å®ç°èµ·æ¥éå¸¸ç®€å•ï¼Œé‡è¦çš„æ˜¯è¿™ç§æ€è·¯å’ŒåŸç† ã€‚ ã€Šæ’ä»¶åŒ–ä»æ”¾å¼ƒåˆ°æ¡èµ·ã€‹ç¬¬ä¸€ç« ï¼Œé¦–å…ˆçœ‹ä¸€å¼ å›¾ï¼š è¿™å¼ å›¾æ˜¯æˆ‘æ‰€ç†è§£çš„ Android æ’ä»¶åŒ–æŠ€æœ¯çš„ä¸‰ä¸ªæŠ€æœ¯ç‚¹ä»¥åŠå®ƒä»¬çš„åº”ç”¨åœºæ™¯ã€‚ä»Šå¤©ä»¥ ã€Qzone çƒ­ä¿®å¤æ–¹æ¡ˆã€‘ä¸ºä¾‹ï¼Œè·Ÿå¤§å®¶è®²ä¸€è®²æ’ä»¶åŒ–ä¸­ çƒ­ä¿®å¤æ–¹æ¡ˆ çš„å®ç°ã€‚","text":"æŸ¥çœ‹åŸæ–‡ï¼š Android çƒ­ä¿®å¤ï¼Œæ²¡ä½ æƒ³çš„é‚£ä¹ˆéš¾ â€”â€” by kymjså¼ æ¶› ä¸€ç§åŠ¨æ€åŠ è½½æœ€ç®€å•çš„å®ç°æ–¹å¼ï¼Œä»£ç å®ç°èµ·æ¥éå¸¸ç®€å•ï¼Œé‡è¦çš„æ˜¯è¿™ç§æ€è·¯å’ŒåŸç† ã€‚ ã€Šæ’ä»¶åŒ–ä»æ”¾å¼ƒåˆ°æ¡èµ·ã€‹ç¬¬ä¸€ç« ï¼Œé¦–å…ˆçœ‹ä¸€å¼ å›¾ï¼š è¿™å¼ å›¾æ˜¯æˆ‘æ‰€ç†è§£çš„ Android æ’ä»¶åŒ–æŠ€æœ¯çš„ä¸‰ä¸ªæŠ€æœ¯ç‚¹ä»¥åŠå®ƒä»¬çš„åº”ç”¨åœºæ™¯ã€‚ä»Šå¤©ä»¥ ã€Qzone çƒ­ä¿®å¤æ–¹æ¡ˆã€‘ä¸ºä¾‹ï¼Œè·Ÿå¤§å®¶è®²ä¸€è®²æ’ä»¶åŒ–ä¸­ çƒ­ä¿®å¤æ–¹æ¡ˆ çš„å®ç°ã€‚ åŸç†ClassLoaderåœ¨ Java ä¸­ï¼Œè¦åŠ è½½ä¸€ä¸ªç±»éœ€è¦ç”¨åˆ°ClassLoaderã€‚Android ä¸­æœ‰ä¸‰ä¸ª ClassLoader, åˆ†åˆ«ä¸ºURLClassLoaderã€PathClassLoaderã€DexClassLoaderã€‚å…¶ä¸­: URLClassLoader : åªèƒ½ç”¨äºåŠ è½½jaræ–‡ä»¶ï¼Œä½†æ˜¯ç”±äº dalvik ä¸èƒ½ç›´æ¥è¯†åˆ«jarï¼Œæ‰€ä»¥åœ¨ Android ä¸­æ— æ³•ä½¿ç”¨è¿™ä¸ªåŠ è½½å™¨ã€‚ PathClassLoader :å®ƒåªèƒ½åŠ è½½å·²ç»å®‰è£…çš„apkã€‚å› ä¸º PathClassLoader åªä¼šå»è¯»å– /data/dalvik-cache ç›®å½•ä¸‹çš„ dex æ–‡ä»¶ã€‚ä¾‹å¦‚æˆ‘ä»¬å®‰è£…ä¸€ä¸ªåŒ…åä¸ºcom.hujiang.xxxçš„ apk,é‚£ä¹ˆå½“ apk å®‰è£…è¿‡ç¨‹ä¸­ï¼Œå°±ä¼šåœ¨/data/dalvik-cacheç›®å½•ä¸‹ç”Ÿäº§ä¸€ä¸ªåä¸ºdata@app@com.hujiang.xxx-1.apk@classes.dexçš„ ODEX æ–‡ä»¶ã€‚åœ¨ä½¿ç”¨ PathClassLoader åŠ è½½ apk æ—¶ï¼Œå®ƒå°±ä¼šå»è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æ‰¾ç›¸åº”çš„ ODEX æ–‡ä»¶ï¼Œå¦‚æœ apk æ²¡æœ‰å®‰è£…ï¼Œè‡ªç„¶ä¼šæŠ¥ClassNotFoundExceptionã€‚ DexClassLoader : æ˜¯æœ€ç†æƒ³çš„åŠ è½½å™¨ã€‚å®ƒçš„æ„é€ å‡½æ•°åŒ…å«å››ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸ºï¼š 1ã€dexPath, æŒ‡ç›®æ ‡ç±»æ‰€åœ¨çš„APKæˆ–jaræ–‡ä»¶çš„è·¯å¾„.ç±»è£…è½½å™¨å°†ä»è¯¥è·¯å¾„ä¸­å¯»æ‰¾æŒ‡å®šçš„ç›®æ ‡ç±»,è¯¥ç±»å¿…é¡»æ˜¯APKæˆ–jarçš„å…¨è·¯å¾„.å¦‚æœè¦åŒ…å«å¤šä¸ªè·¯å¾„,è·¯å¾„ä¹‹é—´å¿…é¡»ä½¿ç”¨ç‰¹å®šçš„åˆ†å‰²ç¬¦åˆ†éš”,ç‰¹å®šçš„åˆ†å‰²ç¬¦å¯ä»¥ä½¿ç”¨System.getProperty(â€œpath.separtorâ€)è·å¾—. 2ã€dexOutputDir, ç”±äºdexæ–‡ä»¶è¢«åŒ…å«åœ¨APKæˆ–è€…Jaræ–‡ä»¶ä¸­,å› æ­¤åœ¨è£…è½½ç›®æ ‡ç±»ä¹‹å‰éœ€è¦å…ˆä»APKæˆ–Jaræ–‡ä»¶ä¸­è§£å‹å‡ºdexæ–‡ä»¶,è¯¥å‚æ•°å°±æ˜¯åˆ¶å®šè§£å‹å‡ºçš„dex æ–‡ä»¶å­˜æ”¾çš„è·¯å¾„.åœ¨Androidç³»ç»Ÿä¸­,ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸€èˆ¬å¯¹åº”ä¸€ä¸ªLinuxç”¨æˆ·id,åº”ç”¨ç¨‹åºä»…å¯¹å±äºè‡ªå·±çš„æ•°æ®ç›®å½•è·¯å¾„æœ‰å†™çš„æƒé™,å› æ­¤,è¯¥å‚æ•°å¯ä»¥ä½¿ç”¨è¯¥ç¨‹åºçš„æ•°æ®è·¯å¾„. 3ã€libPath, æŒ‡ç›®æ ‡ç±»ä¸­æ‰€ä½¿ç”¨çš„C/C++åº“å­˜æ”¾çš„è·¯å¾„ 4ã€classload, æ˜¯æŒ‡è¯¥è£…è½½å™¨çš„çˆ¶è£…è½½å™¨,ä¸€èˆ¬ä¸ºå½“å‰æ‰§è¡Œç±»çš„è£…è½½å™¨ ä»frameworkæºç ä¸­çš„dalvik.systemåŒ…ä¸‹ï¼Œæ‰¾åˆ°DexClassLoaderæºç ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨ï¼Œå®é™…å†…å®¹æ˜¯åœ¨å®ƒçš„çˆ¶ç±»BaseDexClassLoaderä¸­ï¼Œé¡ºå¸¦ä¸€æï¼Œè¿™ä¸ªç±»æœ€ä½åœ¨API14å¼€å§‹æœ‰ç”¨ã€‚åŒ…å«äº†ä¸¤ä¸ªå˜é‡ï¼š 12345/** originally specified path (just used for &#123;@code toString()&#125;) */private final String originalPath; /** structured lists of path elements */private final DexPathList pathList; å¯ä»¥çœ‹åˆ°æ³¨é‡Šï¼špathListå°±æ˜¯å¤šdexçš„ç»“æ„åˆ—è¡¨ï¼ŒæŸ¥çœ‹å…¶æºç  1234567891011121314/*package*/ final class DexPathList &#123; private static final String DEX_SUFFIX = \".dex\"; private static final String JAR_SUFFIX = \".jar\"; private static final String ZIP_SUFFIX = \".zip\"; private static final String APK_SUFFIX = \".apk\"; /** class definition context */ private final ClassLoader definingContext; /** list of dex/resource (class path) elements */ private final Element[] dexElements; /** list of native library directory elements */ private final File[] nativeLibraryDirectories; å¯ä»¥çœ‹åˆ° dexElements æ³¨é‡Šï¼ŒdexElements å°±æ˜¯ä¸€ä¸ªdexåˆ—è¡¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠæ¯ä¸ª Element å½“æˆæ˜¯ä¸€ä¸ª dexã€‚ æ­¤æ—¶æˆ‘ä»¬æ•´ç†ä¸€ä¸‹æ€è·¯ï¼ŒDexClassLoader åŒ…å«æœ‰ä¸€ä¸ªdexæ•°ç»„Element[] dexElementsï¼Œå…¶ä¸­æ¯ä¸ªdexæ–‡ä»¶æ˜¯ä¸€ä¸ªElementï¼Œå½“éœ€è¦åŠ è½½ç±»çš„æ—¶å€™ä¼šéå† dexElementsï¼Œå¦‚æœæ‰¾åˆ°ç±»åˆ™åŠ è½½ï¼Œå¦‚æœæ‰¾ä¸åˆ°ä»ä¸‹ä¸€ä¸ª dex æ–‡ä»¶ç»§ç»­æŸ¥æ‰¾ã€‚ é‚£ä¹ˆæˆ‘ä»¬çš„å®ç°å°±æ˜¯æŠŠè¿™ä¸ªæ’ä»¶ dex æ’å…¥åˆ° Elements çš„æœ€å‰é¢ï¼Œè¿™ä¹ˆåšçš„å¥½å¤„æ˜¯ä¸ä»…å¯ä»¥åŠ¨æ€çš„åŠ è½½ä¸€ä¸ªç±»ï¼Œå¹¶ä¸”ç”±äº DexClassLoader ä¼šä¼˜å…ˆåŠ è½½é å‰çš„ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬åŒæ—¶å®ç°äº†å®¿ä¸» apk çš„çƒ­ä¿®å¤åŠŸèƒ½ã€‚ ODEXè¿‡ç¨‹ä¸Šæ–‡å°±æ˜¯æ•´ä¸ªçƒ­ä¿®å¤çš„åŸç†äº†ï¼Œå°±æ˜¯å‘Classloaderåˆ—è¡¨ä¸­æ’å…¥ä¸€ä¸ªdexã€‚ä½†æ˜¯å¦‚æœä½ è¿™å„¿å®ç°äº†ï¼Œä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ ODEX è¿‡ç¨‹ä¸­å¼•å‘çš„é—®é¢˜ã€‚åœ¨è®²è¿™ä¸ªè›‹ç–¼çš„è¿‡ç¨‹ä¹‹å‰ï¼Œæœ‰å‡ ä¸ªé—®é¢˜æ˜¯è¦ææ‡‚çš„ã€‚ä¸ºä»€ä¹ˆ Android ä¸èƒ½è¯†åˆ« .class æ–‡ä»¶ï¼Œè€Œåªèƒ½è¯†åˆ« dex æ–‡ä»¶ã€‚å› ä¸º dex æ˜¯å¯¹ class çš„ä¼˜åŒ–ï¼Œå®ƒå¯¹ class åšäº†æå¤§çš„å‹ç¼©ï¼Œæ¯”å¦‚ä»¥ä¸‹æ˜¯ä¸€ä¸ª class æ–‡ä»¶çš„ç»“æ„(æ‘˜è‡ªé‚“å‡¡å¹³è€å¸ˆåšå®¢) dex å°†æ•´ä¸ª Android å·¥ç¨‹ä¸­æ‰€æœ‰çš„ class å‹ç¼©åˆ°ä¸€ä¸ª(æˆ–å‡ ä¸ª) dex æ–‡ä»¶ä¸­ï¼Œåˆå¹¶äº†æ¯ä¸ª class çš„å¸¸é‡ã€class ç‰ˆæœ¬ä¿¡æ¯ç­‰ï¼Œä¾‹å¦‚æ¯ä¸ª class ä¸­éƒ½æœ‰ä¸€ä¸ªç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œåœ¨ dex ä¸­å°±åªå­˜ä¸€ä»½å°±å¤Ÿäº†ã€‚æ‰€ä»¥ï¼Œåœ¨Android ä¸Šï¼Œdalvik è™šæ‹Ÿæœºæ˜¯æ— æ³•è¯†åˆ«ä¸€ä¸ªæ™®é€š class æ–‡ä»¶çš„ï¼Œå› ä¸ºæ— æ³•è¯†åˆ«è¿™ä¸ª class æ–‡ä»¶çš„ç»“æ„ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ª dex æ–‡ä»¶çš„ç»“æ„ : æ„Ÿå…´è¶£çš„å¯ä»¥é˜…è¯»ã€Šæ·±å…¥ç†è§£Androidã€‹è¿™æœ¬ä¹¦ã€‚ ç»§ç»­å¾€ä¸‹ï¼Œå…¶å® dalvik è™šæ‹Ÿæœºä¹Ÿå¹¶ä¸æ˜¯ç›´æ¥è¯»å– dex æ–‡ä»¶çš„ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ª APK å®‰è£…çš„æ—¶å€™ï¼Œä¼šé¦–å…ˆåšä¸€æ¬¡ä¼˜åŒ–ï¼Œä¼šç”Ÿæˆä¸€ä¸ª ODEX æ–‡ä»¶ï¼Œå³ Optimized dexã€‚ ä¸ºä»€ä¹ˆè¿˜è¦ä¼˜åŒ–ï¼Œä¾æ—§æ˜¯ä¸ºäº†æ•ˆç‡ã€‚ åªä¸è¿‡ï¼ŒClass -&gt; dex æ˜¯ä¸ºäº†å¹³å°æ— å…³çš„ä¼˜åŒ–ï¼›è€Œ dex -&gt; odex åˆ™æ˜¯é’ˆå¯¹ä¸åŒå¹³å°ï¼Œä¸åŒæ‰‹æœºçš„ç¡¬ä»¶é…ç½®åšé’ˆå¯¹æ€§çš„ä¼˜åŒ–ã€‚å°±æ˜¯åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œè™šæ‹Ÿæœºåœ¨å¯åŠ¨ä¼˜åŒ–çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªé€‰é¡¹å°±æ˜¯ verify é€‰é¡¹ï¼Œå½“ verify é€‰é¡¹è¢«æ‰“å¼€çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œä¸€æ¬¡æ ¡éªŒï¼Œæ ¡éªŒçš„ç›®çš„æ˜¯ä¸ºäº†åˆ¤æ–­ï¼Œè¿™ä¸ªç±»æ˜¯å¦æœ‰å¼•ç”¨å…¶ä»– dex ä¸­çš„ç±»ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¼šè¢«æ‰“ä¸Šä¸€ä¸ª CLASS_ISPREVERIFIED çš„æ ‡å¿—ã€‚ä¸€æ—¦è¢«æ‰“ä¸Šè¿™ä¸ªæ ‡å¿—ï¼Œå°±æ— æ³•å†ä»å…¶ä»– dex ä¸­æ›¿æ¢è¿™ä¸ªç±»äº†ã€‚è€Œè¿™ä¸ªé€‰é¡¹å¼€å¯ï¼Œåˆ™æ˜¯ç”±è™šæ‹Ÿæœºæ§åˆ¶çš„ã€‚ å­—èŠ‚ç æ“ä½œé‚£ä¹ˆæ—¢ç„¶çŸ¥é“äº†åŸå› ï¼Œè§£å†³çš„åŠæ³•è‡ªç„¶ä¹Ÿæœ‰äº†ã€‚ä½ ä¸æ˜¯æ²¡æœ‰å¼•ç”¨å…¶ä»– dex ä¸­çš„ç±»å°±ä¼šè¢«æ ‡è®°å—ï¼Œé‚£å’±ä»¬å°±å¼•ç”¨ä¸€ä¸ªå…¶ä»– dex ä¸­çš„ç±»ã€‚ ClassReader:è¯¥ç±»ç”¨æ¥è§£æç¼–è¯‘è¿‡çš„classå­—èŠ‚ç æ–‡ä»¶ã€‚ClassWriter:è¯¥ç±»ç”¨æ¥é‡æ–°æ„å»ºç¼–è¯‘åçš„ç±»ï¼Œæ¯”å¦‚è¯´ä¿®æ”¹ç±»åã€å±æ€§ä»¥åŠæ–¹æ³•ï¼Œç”šè‡³å¯ä»¥ç”Ÿæˆæ–°çš„ç±»çš„å­—èŠ‚ç æ–‡ä»¶ã€‚ClassAdapter:è¯¥ç±»ä¹Ÿå®ç°äº†ClassVisitoræ¥å£ï¼Œå®ƒå°†å¯¹å®ƒçš„æ–¹æ³•è°ƒç”¨å§”æ‰˜ç»™å¦ä¸€ä¸ªClassVisitorå¯¹è±¡ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * å½“å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™æ³¨å…¥Injectç±» * * @Note https://www.ibm.com/developerworks/cn/java/j-lo-asm30/ * @param inputStream éœ€è¦æ³¨å…¥çš„Classçš„æ–‡ä»¶è¾“å…¥æµ * @return è¿”å›æ³¨å…¥ä»¥åçš„Classæ–‡ä»¶äºŒè¿›åˆ¶æ•°ç»„ */private static byte[] referHackWhenInit(InputStream inputStream) &#123; //è¯¥ç±»ç”¨æ¥è§£æç¼–è¯‘è¿‡çš„classå­—èŠ‚ç æ–‡ä»¶ã€‚ ClassReader cr = new ClassReader(inputStream); //è¯¥ç±»ç”¨æ¥é‡æ–°æ„å»ºç¼–è¯‘åçš„ç±»ï¼Œæ¯”å¦‚è¯´ä¿®æ”¹ç±»åã€å±æ€§ä»¥åŠæ–¹æ³•ï¼Œç”šè‡³å¯ä»¥ç”Ÿæˆæ–°çš„ç±»çš„å­—èŠ‚ç æ–‡ä»¶ ClassWriter cw = new ClassWriter(cr, 0); //ç±»çš„è®¿é—®è€…,å¯ä»¥ç”¨æ¥åˆ›å»ºå¯¹ä¸€ä¸ªClassçš„æ”¹åŠ¨æ“ä½œ ClassVisitor cv = new ClassVisitor(Opcodes.ASM4, cw) &#123; @Override public MethodVisitor visitMethod(int access, String name, String desc, String signature, String[] exceptions) &#123; MethodVisitor mv = super.visitMethod(access, name, desc, signature, exceptions); //å¦‚æœæ–¹æ³•åæ˜¯&lt;init&gt;,æ¯ä¸ªç±»çš„æ„é€ å‡½æ•°å‡½æ•°åå«&lt;init&gt; if (\"&lt;init&gt;\".equals(name)) &#123; //åœ¨åŸæœ¬çš„visitMethodæ“ä½œä¸­æ·»åŠ è‡ªå·±å®šä¹‰çš„æ“ä½œ mv = new MethodVisitor(Opcodes.ASM4, mv) &#123; @Override void visitInsn(int opcode) &#123; //Opcodeså¯ä»¥çœ‹åšä¸ºå…³é”®å­— if (opcode == Opcodes.RETURN) &#123; //visitLdcInsn() å°†ä¸€ä¸ªå€¼å†™å…¥åˆ°æ ˆä¸­,å¯ä»¥æ˜¯ä¸€ä¸ªClassç±»å/methodæ–¹æ³•å/descæ–¹æ³•æè¿° //è¿™é‡Œç›¸å½“äºæ’å…¥äº†ä¸€æ¡è¯­å¥:Class a = Inject.class; super.visitLdcInsn(Type.getType(\"Lcom/hujiang/hotfix/Inject;\")); &#125; //æ‰§è¡Œopcodeå¯¹åº”çš„å…¶ä»–æ“ä½œ super.visitInsn(opcode); &#125; &#125; &#125; //è´£ä»»é“¾å®Œæˆ,è¿”å› return mv; &#125; &#125;; //acceptè¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªå®ç°äº† ClassVisitoræ¥å£çš„å¯¹è±¡å®ä¾‹ä½œä¸ºå‚æ•°ï¼Œç„¶åä¾æ¬¡è°ƒç”¨ ClassVisitoræ¥å£çš„å„ä¸ªæ–¹æ³• //ç”¨æˆ·æ— æ³•æ§åˆ¶å„ä¸ªæ–¹æ³•è°ƒç”¨é¡ºåº,ä½†æ˜¯å¯ä»¥æä¾›ä¸åŒçš„ Visitor(è®¿é—®è€…) æ¥å¯¹å­—èŠ‚ç æ ‘è¿›è¡Œä¸åŒçš„ä¿®æ”¹ //åœ¨è¿™é‡Œ,è°ƒç”¨è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯ä¸ºäº†è®©ä¸Šé¢çš„visitMethodæ–¹æ³•è¢«è°ƒç”¨ cr.accept(cv, 0); return cw.toByteArray();&#125; ä»£ç å®ç°å¯ä»¥å‚è€ƒ nuwa ä¸­çš„å®ç°ï¼Œé¦–å…ˆæ˜¯ dex æ€æ ·å»æ’å…¥åˆ°Classloaderåˆ—è¡¨ä¸­ï¼Œå…¶å®å°±æ˜¯ä¸€æ®µåå°„ï¼š 12345678public static void injectDexAtFirst(String dexPath, String defaultDexOptPath) throws NoSuchFieldException, IllegalAccessException, ClassNotFoundException &#123; DexClassLoader dexClassLoader = new DexClassLoader(dexPath, defaultDexOptPath, dexPath, getPathClassLoader()); Object baseDexElements = getDexElements(getPathList(getPathClassLoader())); Object newDexElements = getDexElements(getPathList(dexClassLoader)); Object allDexElements = combineArray(newDexElements, baseDexElements); Object pathList = getPathList(getPathClassLoader()); ReflectionUtils.setField(pathList, pathList.getClass(), \"dexElements\", allDexElements);&#125; é¦–å…ˆåˆ†åˆ«è·å–åˆ°å®¿ä¸»åº”ç”¨å’Œè¡¥ä¸çš„ dex ä¸­çš„PathList.dexElements, å¹¶æŠŠä¸¤ä¸ª dexElements æ•°ç»„åšæ‹¼æ¥ï¼Œå°†è¡¥ä¸æ•°ç»„æ”¾åœ¨å‰é¢ï¼Œæœ€åå°†æ‹¼æ¥åç”Ÿæˆçš„æ•°ç»„å†èµ‹å€¼å›Classloader. nuwa æ›´ä¸»è¦çš„æ˜¯ä»–çš„ groovy è„šæœ¬ï¼Œå®Œæ•´ä»£ç ï¼šè¿™é‡Œï¼Œç”±äºä»£ç å¾ˆå¤šï¼Œå°±åªè·Ÿå¤§å®¶è®²ä¸¤ä¸ªå…³é”®çš„ç‚¹çš„å®ç°ä»¥åŠç›®çš„ï¼Œå…·ä½“çš„å†…å®¹å¯ä»¥ç›´æ¥æŸ¥çœ‹æºç ã€‚ 123456789//è·å¾—æ‰€æœ‰è¾“å…¥æ–‡ä»¶,å³preDexçš„æ‰€æœ‰jaræ–‡ä»¶Set&lt;File&gt; inputFiles = preDexTask.inputs.files.filesinputFiles.each &#123; inputFile -&gt; def path = inputFile.absolutePath //å¦‚æœä¸æ˜¯supportåŒ…æˆ–è€…å¼•å…¥çš„ä¾èµ–åº“,åˆ™å¼€å§‹ç”Ÿæˆä»£ç ä¿®æ”¹éƒ¨åˆ†çš„hotfixåŒ… if (HotFixProcessors.shouldProcessPreDexJar(path)) &#123; HotFixProcessors.processJar(classHashFile, inputFile, patchDir, classHashMap, includePackage, excludeClass) &#125;&#125; å…¶ä¸­HotFixProcessors.processJar()æ˜¯è„šæœ¬çš„ç¬¬ä¸€ä¸ªä½œç”¨ï¼Œå°±æ˜¯æ‰¾å‡ºå“ªäº›ç±»æ˜¯å‘ç”Ÿäº†æ”¹å˜ï¼Œåº”è¯¥ç”Ÿæˆå¯¹åº”çš„è¡¥ä¸ã€‚å¾ªç¯éå†å·¥ç¨‹ä¸­çš„å…¨éƒ¨ç±»,å£°æ˜å¿½ç•¥çš„ç›´æ¥è·³è¿‡.å¯¹æ¯ä¸ªç±»è®¡ç®—hash,å¹¶å†™å…¥åˆ°hashFileæ–‡ä»¶ä¸­.é€šè¿‡æ¯”è¾ƒhashFileæ–‡ä»¶ä¸åŸå…ˆhostå·¥ç¨‹çš„hashFile(å³è¿™é‡Œçš„classHashMapå‚æ•°),å¾—åˆ°æ‰€æœ‰ä¿®æ”¹è¿‡çš„ç±»ç”Ÿæˆè¿™äº›ç±»çš„classæ–‡ä»¶,ä»¥åŠæ‰€æœ‰ä¿®æ”¹è¿‡çš„classæ–‡ä»¶çš„é›†åˆjaræ–‡ä»¶ã€‚ 123456789101112131415161718Set&lt;File&gt; inputFiles = dexTask.inputs.files.filesinputFiles.each &#123; inputFile -&gt; def path = inputFile.absolutePath if (path.endsWith(\".class\") &amp;&amp; !path.contains(\"/R\\$\") &amp;&amp; !path.endsWith(\"/R.class\") &amp;&amp; !path.endsWith(\"/BuildConfig.class\")) &#123; if (HotFixSetUtils.isIncluded(path, includePackage)) &#123; if (!HotFixSetUtils.isExcluded(path, excludeClass)) &#123; def bytes = HotFixProcessors.processClass(inputFile) path = path.split(\"$&#123;dirName&#125;/\")[1] def hash = DigestUtils.shaHex(bytes) classHashFile.append(HotFixMapUtils.format(path, hash)) if (HotFixMapUtils.notSame(classHashMap, path, hash)) &#123; HotFixFileUtils.copyBytesToFile(inputFile.bytes, HotFixFileUtils.touchFile(patchDir, path)) &#125; &#125; &#125; &#125;&#125; è¿™ä¸€æ®µæ˜¯è„šæœ¬çš„ç¬¬äºŒä¸ªä½œç”¨ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡å­—èŠ‚ç æ“ä½œçš„ç›®çš„ï¼Œä¸ºäº†é˜²æ­¢ç±»è¢«è™šæ‹Ÿæœºæ‰“ä¸ŠCLASS_ISPREVERIFIEDï¼Œæ‰€ä»¥éœ€è¦æ‰§è¡Œå­—èŠ‚ç å†™å…¥ã€‚å…¶ä¸­HotFixProcessors.processClass()å°±æ˜¯å®é™…å†™å…¥å­—èŠ‚ç çš„ä»£ç ã€‚ å¥½åƒå·®ä¸ªç»“å°¾åŒæ ·çš„æ–¹æ¡ˆï¼Œé™¤äº† nuwa è¿˜æœ‰ä¸€ä¸ªå¼€æºçš„å®ç°ï¼ŒHotFix ä¸¤è€…æ˜¯å·®ä¸å¤šçš„ï¼Œæ‰€ä»¥çœ‹ä¸€ä¸ªå°±å¯ä»¥äº†ã€‚ çœ‹åˆ°æœ‰å¾ˆå¤šæœ‹å‹é—®ï¼Œå¦‚æœæ··æ·†åä»£ç æ€ä¹ˆåŠï¼Ÿåœ¨ Gradle æ’ä»¶ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªproguardTaskï¼Œçœ‹åå­—åº”è¯¥å°±çŸ¥é“ä»–æ˜¯è´Ÿè´£ proguard ä»»åŠ¡çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¿å­˜é¦–æ¬¡æ‰§è¡Œæ—¶çš„æ··æ·†è§„åˆ™(ä¹Ÿå°±æ˜¯çº¿ä¸Šå‡ºBUGçš„åŒ…)ï¼Œè¿™ä¸ªæ··æ·†è§„åˆ™ä¿å­˜åœ¨å·¥ç¨‹ç›®å½•ä¸­çš„ä¸€ä¸ªmappingæ–‡ä»¶ï¼Œå½“æˆ‘ä»¬éœ€è¦æ‰§è¡Œçƒ­ä¿®å¤è¡¥ä¸ç”Ÿæˆçš„æ—¶å€™ï¼Œå°†çº¿ä¸ŠåŒ…çš„mappingè§„åˆ™æ‹¿å‡ºæ¥åº”ç”¨åˆ°æœ¬æ¬¡ç¼–è¯‘ä¸­ï¼Œå°±å¯ä»¥ç”Ÿæˆæ··æ·†åçš„ç±»è·Ÿçº¿ä¸Šæ··æ·†åçš„ç±»ç›¸åŒçš„ç±»åçš„è¡¥ä¸äº†ã€‚å…·ä½“å®ç°å¯ä»¥çœ‹ nuwa é¡¹ç›®çš„applymapping()æ–¹æ³•ã€‚","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"hotfix","slug":"hotfix","permalink":"http://github.com/tags/hotfix/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ä½¿ç”¨Neo4jè¿›è¡Œå…¨æ ˆWebå¼€å‘","slug":"ä½¿ç”¨Neo4jè¿›è¡Œå…¨æ ˆWebå¼€å‘","date":"2016-11-10T03:08:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/11/10/ä½¿ç”¨Neo4jè¿›è¡Œå…¨æ ˆWebå¼€å‘/","link":"","permalink":"http://github.com/2016/11/10/ä½¿ç”¨Neo4jè¿›è¡Œå…¨æ ˆWebå¼€å‘/","excerpt":"åœ¨å¼€å‘ä¸€ä¸ªå…¨æ ˆwebåº”ç”¨æ—¶ï¼Œä½œä¸ºæ•´ä¸ªæ ˆçš„åº•å±‚ï¼Œä½ å¯ä»¥åœ¨å¤šç§æ•°æ®åº“ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚ä½œä¸ºäº‹å®çš„æ•°æ®æºï¼Œä½ å½“ç„¶å¸Œæœ›é€‰æ‹©ä¸€ç§å¯é çš„æ•°æ®åº“ï¼Œä½†åŒæ—¶ä¹Ÿå¸Œæœ›å®ƒèƒ½å¤Ÿå…è®¸ä½ ä»¥è‰¯å¥½çš„æ–¹å¼è¿›è¡Œæ•°æ®å»ºæ¨¡ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä¸ºä½ ä»‹ç»Neo4jï¼Œå½“ä½ çš„æ•°æ®æ¨¡å‹åŒ…å«å¤§é‡å…³è”æ•°æ®ä»¥åŠå…³ç³»æ—¶ï¼Œå®ƒå¯ä»¥æˆä¸ºä½ çš„webåº”ç”¨æ ˆçš„åŸºç¡€çš„ä¸€ä¸ªè‰¯å¥½é€‰æ‹©ã€‚ Neo4jæ˜¯ä»€ä¹ˆï¼Ÿ Neo4jæ˜¯ä¸€ä¸ªå›¾å½¢æ•°æ®åº“ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å®ƒçš„æ•°æ®å¹¶éä¿å­˜åœ¨è¡¨æˆ–é›†åˆä¸­ï¼Œè€Œæ˜¯ä¿å­˜ä¸ºèŠ‚ç‚¹ä»¥åŠèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ã€‚åœ¨Neo4jä¸­ï¼ŒèŠ‚ç‚¹ä»¥åŠå…³ç³»éƒ½èƒ½å¤ŸåŒ…å«ä¿å­˜å€¼çš„å±æ€§ï¼Œæ­¤å¤–ï¼š å¯ä»¥ä¸ºèŠ‚ç‚¹è®¾ç½®é›¶æˆ–å¤šä¸ªæ ‡ç­¾ï¼ˆä¾‹å¦‚Authoræˆ–Bookï¼‰ æ¯ä¸ªå…³ç³»éƒ½å¯¹åº”ä¸€ç§ç±»å‹ï¼ˆä¾‹å¦‚WROTEæˆ–FRIEND_OFï¼‰ å…³ç³»æ€»æ˜¯ä»ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆä½†å¯ä»¥åœ¨ä¸è€ƒè™‘æŒ‡å‘æ€§çš„æƒ…å†µä¸‹è¿›è¡ŒæŸ¥è¯¢ï¼‰","text":"åœ¨å¼€å‘ä¸€ä¸ªå…¨æ ˆwebåº”ç”¨æ—¶ï¼Œä½œä¸ºæ•´ä¸ªæ ˆçš„åº•å±‚ï¼Œä½ å¯ä»¥åœ¨å¤šç§æ•°æ®åº“ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚ä½œä¸ºäº‹å®çš„æ•°æ®æºï¼Œä½ å½“ç„¶å¸Œæœ›é€‰æ‹©ä¸€ç§å¯é çš„æ•°æ®åº“ï¼Œä½†åŒæ—¶ä¹Ÿå¸Œæœ›å®ƒèƒ½å¤Ÿå…è®¸ä½ ä»¥è‰¯å¥½çš„æ–¹å¼è¿›è¡Œæ•°æ®å»ºæ¨¡ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä¸ºä½ ä»‹ç»Neo4jï¼Œå½“ä½ çš„æ•°æ®æ¨¡å‹åŒ…å«å¤§é‡å…³è”æ•°æ®ä»¥åŠå…³ç³»æ—¶ï¼Œå®ƒå¯ä»¥æˆä¸ºä½ çš„webåº”ç”¨æ ˆçš„åŸºç¡€çš„ä¸€ä¸ªè‰¯å¥½é€‰æ‹©ã€‚ Neo4jæ˜¯ä»€ä¹ˆï¼Ÿ Neo4jæ˜¯ä¸€ä¸ªå›¾å½¢æ•°æ®åº“ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å®ƒçš„æ•°æ®å¹¶éä¿å­˜åœ¨è¡¨æˆ–é›†åˆä¸­ï¼Œè€Œæ˜¯ä¿å­˜ä¸ºèŠ‚ç‚¹ä»¥åŠèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ã€‚åœ¨Neo4jä¸­ï¼ŒèŠ‚ç‚¹ä»¥åŠå…³ç³»éƒ½èƒ½å¤ŸåŒ…å«ä¿å­˜å€¼çš„å±æ€§ï¼Œæ­¤å¤–ï¼š å¯ä»¥ä¸ºèŠ‚ç‚¹è®¾ç½®é›¶æˆ–å¤šä¸ªæ ‡ç­¾ï¼ˆä¾‹å¦‚Authoræˆ–Bookï¼‰ æ¯ä¸ªå…³ç³»éƒ½å¯¹åº”ä¸€ç§ç±»å‹ï¼ˆä¾‹å¦‚WROTEæˆ–FRIEND_OFï¼‰ å…³ç³»æ€»æ˜¯ä»ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆä½†å¯ä»¥åœ¨ä¸è€ƒè™‘æŒ‡å‘æ€§çš„æƒ…å†µä¸‹è¿›è¡ŒæŸ¥è¯¢ï¼‰ ä¸ºä»€ä¹ˆè¦é€‰æ‹©Neo4jï¼Ÿåœ¨è€ƒè™‘ä¸ºwebåº”ç”¨é€‰æ‹©æŸä¸ªæ•°æ®åº“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å¯¹å®ƒæœ‰å“ªäº›æ–¹é¢çš„æœŸæœ›ï¼Œå…¶ä¸­æœ€é‡è¦çš„ä¸€äº›æ¡ä»¶åŒ…æ‹¬ï¼š å®ƒæ˜¯å¦æ˜“äºä½¿ç”¨ï¼Ÿ å®ƒæ˜¯å¦å…è®¸ä½ æ–¹ä¾¿åœ°å›åº”å¯¹éœ€æ±‚çš„å˜æ›´ï¼Ÿ å®ƒæ˜¯å¦æ”¯æŒé«˜æ€§èƒ½æŸ¥è¯¢ï¼Ÿ æ˜¯å¦èƒ½å¤Ÿæ–¹ä¾¿åœ°å¯¹å…¶è¿›è¡Œæ•°æ®å»ºæ¨¡ï¼Ÿ å®ƒæ˜¯å¦æ”¯æŒäº‹åŠ¡ï¼Ÿ å®ƒæ˜¯å¦æ”¯æŒå¤§è§„æ¨¡åº”ç”¨ï¼Ÿ å®ƒæ˜¯å¦è¶³å¤Ÿæœ‰è¶£ï¼ˆå¾ˆé—æ†¾çš„æ˜¯å¯¹äºæ•°æ®åº“çš„è¿™æ–¹é¢è¦æ±‚ç»å¸¸è¢«å¿½ç•¥ï¼‰ï¼Ÿ ä»è¿™å‡ ä¸ªæ–¹é¢æ¥è¯´ï¼ŒNeo4jæ˜¯ä¸€ä¸ªåˆé€‚çš„é€‰æ‹©ã€‚Neo4jâ€¦â€¦ è‡ªå¸¦ä¸€å¥—æ˜“äºå­¦ä¹ çš„æŸ¥è¯¢è¯­è¨€ï¼ˆåä¸º Cypherï¼‰ ä¸ä½¿ç”¨schemaï¼Œå› æ­¤å¯ä»¥æ»¡è¶³ä½ çš„ä»»ä½•å½¢å¼çš„éœ€æ±‚ ä¸å…³ç³»å‹æ•°æ®åº“ç›¸æ¯”ï¼Œå¯¹äºé«˜åº¦å…³è”çš„æ•°æ®ï¼ˆå›¾å½¢æ•°æ®ï¼‰çš„æŸ¥è¯¢å¿«é€Ÿè¦å¿«ä¸Šè®¸å¤š å®ƒçš„å®ä½“ä¸å…³ç³»ç»“æ„éå¸¸è‡ªç„¶åœ°åˆ‡åˆäººç±»çš„ç›´è§‚æ„Ÿå— æ”¯æŒå…¼å®¹ACIDçš„äº‹åŠ¡æ“ä½œ æä¾›äº†ä¸€ä¸ªé«˜å¯ç”¨æ€§æ¨¡å‹ï¼Œä»¥æ”¯æŒå¤§è§„æ¨¡æ•°æ®é‡çš„æŸ¥è¯¢ï¼Œæ”¯æŒå¤‡ä»½ã€æ•°æ®å±€éƒ¨æ€§ä»¥åŠå†—ä½™ æä¾›äº†ä¸€ä¸ªå¯è§†åŒ–çš„æŸ¥è¯¢æ§åˆ¶å°ï¼Œä½ ä¸ä¼šå¯¹å®ƒæ„Ÿåˆ°åŒå€¦çš„ ä»€ä¹ˆæ—¶å€™ä¸åº”ä½¿ç”¨Neo4jï¼Ÿä½œä¸ºä¸€ä¸ªå›¾å½¢NoSQLæ•°æ®åº“ï¼ŒNeo4jæä¾›äº†å¤§é‡çš„åŠŸèƒ½ï¼Œä½†æ²¡æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆæ˜¯å®Œç¾çš„ã€‚åœ¨ä»¥ä¸‹è¿™äº›ç”¨ä¾‹ä¸­ï¼ŒNeo4jå°±ä¸æ˜¯éå¸¸é€‚åˆçš„é€‰æ‹©ï¼š è®°å½•å¤§é‡åŸºäºäº‹ä»¶çš„æ•°æ®ï¼ˆä¾‹å¦‚æ—¥å¿—æ¡ç›®æˆ–ä¼ æ„Ÿå™¨æ•°æ®ï¼‰ å¯¹å¤§è§„æ¨¡åˆ†å¸ƒå¼æ•°æ®è¿›è¡Œå¤„ç†ï¼Œç±»ä¼¼äºHadoop äºŒè¿›åˆ¶æ•°æ®å­˜å‚¨ é€‚åˆäºä¿å­˜åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­çš„ç»“æ„åŒ–æ•°æ® åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä½ çœ‹åˆ°äº†ç”±Authorã€Cityã€Bookå’ŒCategoryä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»æ‰€ç»„æˆçš„ä¸€ä¸ªå›¾å½¢ã€‚å¦‚æœä½ å¸Œæœ›é€šè¿‡Cypherè¯­å¥åœ¨Neo4j webæ§åˆ¶å°ä¸­åˆ—å‡ºè¿™äº›æ•°æ®ç»“æœï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼š 12345MATCH (city:City)&lt;-[:LIVES_IN]-(:Author)-[:WROTE]-&gt; (book:Book)-[:HAS_CATEGORY]-&gt;(category:Category) WHERE city.name = â€œChicagoâ€ RETURN * è¯·æ³¨æ„è¿™ç§ASCIIé£æ ¼çš„è¯­æ³•ï¼Œå®ƒåœ¨æ‹¬å·å†…è¡¨ç¤ºèŠ‚ç‚¹åç§°ï¼Œå¹¶ç”¨ç®­å¤´è¡¨ç¤ºä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘å¦ä¸€ä¸ªèŠ‚ç‚¹çš„å…³ç³»ã€‚Cypheré€šè¿‡è¿™ç§æ–¹å¼å…è®¸ä½ åŒ¹é…æŸä¸ªæŒ‡å®šçš„å­å›¾å½¢æ¨¡å¼ã€‚ å½“ç„¶ï¼ŒNeo4jçš„åŠŸèƒ½ä¸ä»…ä»…åœ¨äºå±•ç¤ºæ¼‚äº®çš„å›¾ç‰‡ã€‚å¦‚æœä½ å¸Œæœ›æŒ‰ç…§ä½œè€…æ‰€å¤„çš„åœ°ç‚¹ï¼ˆåŸå¸‚ï¼‰è®¡ç®—ä¹¦ç±çš„åˆ†ç±»æ•°ç›®ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ç›¸åŒçš„MATCHæ¨¡å¼ï¼Œè¿”å›ä¸€ç»„ä¸åŒçš„åˆ—ï¼Œä¾‹å¦‚ï¼š 1234MATCH (city:City)&lt;-[:LIVES_IN]-(:Author)-[:WROTE]-&gt; (book:Book)-[:HAS_CATEGORY]-&gt;(category:Category) RETURN city.name, category.name, COUNT(book) æ‰§è¡Œè¿™æ¡è¯­å¥å°†è¿”å›ä»¥ä¸‹ç»“æœï¼š city.name category.name COUNT(category) Chicago Fantasy 1 Chicago Non-Fiction 2 è™½ç„¶Neo4jä¹Ÿèƒ½å¤Ÿå¤„ç†â€œå¤§æ•°æ®â€ï¼Œä½†å®ƒæ¯•ç«Ÿä¸æ˜¯Hadoopã€HBaseæˆ–Cassandraï¼Œé€šå¸¸æ¥è¯´ä¸ä¼šåœ¨Neo4jæ•°æ®åº“ä¸­ç›´æ¥å¤„ç†æµ·é‡æ•°æ®ï¼ˆä»¥PBä¸ºå•ä½ï¼‰çš„åˆ†æã€‚ä½†å¦‚æœä½ ä¹äºæä¾›å…³äºæŸä¸ªå®ä½“åŠå…¶ç›¸é‚»æ•°æ®å…³ç³»ï¼ˆæ¯”å¦‚ä½ å¯ä»¥æä¾›ä¸€ä¸ªwebé¡µé¢æˆ–æŸä¸ªAPIè¿”å›å…¶ç»“æœï¼‰ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸€ç§è‰¯å¥½çš„é€‰æ‹©ã€‚æ— è®ºæ˜¯ç®€å•çš„CRUDè®¿é—®ï¼Œæˆ–æ˜¯å¤æ‚çš„ã€æ·±åº¦åµŒå¥—çš„èµ„æºè§†å›¾éƒ½èƒ½å¤Ÿèƒœä»»ã€‚ ä½ åº”è¯¥é€‰æ‹©å“ªç§æŠ€æœ¯æ ˆä»¥é…åˆNeo4jï¼Ÿæ‰€æœ‰ä¸»æµçš„ç¼–ç¨‹è¯­è¨€éƒ½é€šè¿‡HTTP APIçš„æ–¹å¼æ”¯æŒNeo4jï¼Œæˆ–è€…é‡‡ç”¨åŸºæœ¬çš„HTTPç±»åº“ï¼Œæˆ–æ˜¯é€šè¿‡æŸäº›åŸç”Ÿçš„ç±»åº“æä¾›æ›´é«˜å±‚çš„æŠ½è±¡ã€‚æ­¤å¤–ï¼Œç”±äºNeo4jæ˜¯ä»¥Javaè¯­è¨€ç¼–å†™çš„ï¼Œå› æ­¤æ‰€æœ‰åŒ…å«JVMæ¥å£çš„è¯­è¨€éƒ½èƒ½å¤Ÿå……åˆ†åˆ©ç”¨Neo4jä¸­çš„é«˜æ€§èƒ½APIã€‚ Neo4jæœ¬èº«ä¹Ÿæä¾›äº†ä¸€ä¸ªâ€œæŠ€æœ¯æ ˆâ€ï¼Œå®ƒå…è®¸ä½ é€‰æ‹©ä¸åŒçš„è®¿é—®æ–¹å¼ï¼ŒåŒ…æ‹¬ç®€å•è®¿é—®ä¹ƒè‡³åŸç”Ÿæ€§èƒ½ç­‰ç­‰ã€‚å®ƒæä¾›çš„ç‰¹æ€§åŒ…æ‹¬ï¼š é€šè¿‡ä¸€ä¸ªHTTP APIæ‰§è¡ŒCypheræŸ¥è¯¢ï¼Œå¹¶è·å–JSONæ ¼å¼çš„ç»“æœ ä¸€ç§â€œéæ‰˜ç®¡æ‰©å±•â€æœºåˆ¶ï¼Œå…è®¸ä½ ä¸ºNeo4jæ•°æ®åº“ç¼–å†™è‡ªå·±çš„ç»ˆç»“ç‚¹ é€šè¿‡ä¸€ä¸ªé«˜å±‚Java APIæŒ‡å®šèŠ‚ç‚¹ä¸å…³ç³»çš„éå† é€šè¿‡ä¸€ä¸ªä½å±‚çš„æ‰¹é‡åŠ è½½APIå¤„ç†æµ·é‡åˆå§‹æ•°æ®çš„è·å– é€šè¿‡ä¸€ä¸ªæ ¸å¿ƒJava APIç›´æ¥è®¿é—®èŠ‚ç‚¹ä¸å…³ç³»ï¼Œä»¥è·å¾—æœ€å¤§çš„æ€§èƒ½ ä¸€ä¸ªåº”ç”¨ç¨‹åºç¤ºä¾‹æœ€è¿‘æˆ‘æ­£å¥½æœ‰æœºä¼šå°†ä¸€ä¸ªé¡¹ç›®æ‰©å±•ä¸ºåŸºäºNeo4jçš„åº”ç”¨ç¨‹åºã€‚è¯¥åº”ç”¨ç¨‹åºï¼ˆå¯ä»¥è®¿é—®graphgist.neo4j.comæŸ¥çœ‹ï¼‰æ˜¯å…³äºGraphGistçš„ä¸€ä¸ªé—¨æˆ·ç½‘ç«™ã€‚GraphGistæ˜¯ä¸€ç§é€šè¿‡äº¤äº’å¼åœ°æ¸²æŸ“ï¼ˆåœ¨ä½ çš„æµè§ˆå™¨ä¸­ï¼‰ç”Ÿæˆçš„æ–‡æ¡£ï¼Œå®ƒåŸºäºä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼ˆAsciiDoctorï¼‰ï¼Œå…¶ä¸­ç”¨æ–‡å­—æè¿°ä»¥åŠå›¾ç‰‡æè¿°äº†æ•´ä¸ªæ•°æ®æ¨¡å‹ã€æ¶æ„ä»¥åŠç”¨ä¾‹æŸ¥è¯¢ï¼Œå¯ä»¥åœ¨çº¿æ‰§è¡Œå®ƒä»¬ï¼Œå¹¶ä½¿å®ƒä»¬ä¿æŒå¯è§†åŒ–ã€‚å®ƒéå¸¸ç±»ä¼¼ä¸€ä¸ªiPython notebookæˆ–æ˜¯ä¸€å¼ äº¤äº’å¼çš„ç™½çº¸ã€‚GraphGistä¹Ÿå…è®¸è¯»è€…åœ¨æµè§ˆå™¨ä¸­ç¼–å†™è‡ªå·±å®šä¹‰çš„æŸ¥è¯¢ï¼Œä»¥æŸ¥çœ‹æ•´ä¸ªæ•°æ®é›†ã€‚ Neo4jçš„åŸä½œè€…Neo Technologyå¸Œæœ›ä¸ºGraphGistæä¾›ä¸€ä¸ªç”±ç¤¾åŒºåˆ›å»ºçš„å±•ç¤ºé¡¹ç›®ã€‚å½“ç„¶ï¼Œåç«¯æŠ€æœ¯é€‰ç”¨äº†Neo4jï¼Œè€Œæ•´ä¸ªæŠ€æœ¯æ ˆçš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘çš„é€‰æ‹©æ˜¯ï¼š Node.jsé…åˆExpress.jsï¼Œå…¶ä¸­å¼•å…¥äº†neo4jåŒ… Angular.js Swagger UI æ‰€æœ‰ä»£ç éƒ½å·²å¼€æºï¼Œå¯ä»¥åœ¨GitHubä¸Šä»»æ„æµè§ˆã€‚ ä»æ¦‚å¿µä¸Šè®²ï¼ŒGraphGisté—¨æˆ·ç½‘ç«™æ˜¯ä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªGraphGiståˆ—è¡¨ï¼Œå…è®¸ç”¨æˆ·æŸ¥çœ‹æ¯ä¸ªGraphGistçš„è¯¦ç»†å†…å®¹ã€‚æ•°æ®é¢†åŸŸæ˜¯ç”±Gistã€Keyword/Domain/Use Caseï¼ˆä½œä¸ºGiståˆ†ç±»ï¼‰ä»¥åŠPersonï¼ˆä½œä¸ºGistçš„ä½œè€…ï¼‰æ‰€ç»„æˆçš„ï¼š ç°åœ¨ä½ å·²ç»ç†Ÿæ‚‰è¿™ä¸ªæ¨¡å‹äº†ï¼Œåœ¨ç»§ç»­æ·±å…¥å­¦ä¹ ä¹‹å‰ï¼Œæˆ‘æƒ³ä¸ºä½ å¿«é€Ÿåœ°ä»‹ç»ä¸€ä¸‹Cypherè¿™é—¨æŸ¥è¯¢è¯­è¨€ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è¿”å›æ‰€æœ‰çš„Gistå’Œå®ƒä»¬çš„å…³é”®å­—ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹è¯­å¥å®ç°ï¼š 12MATCH (gist:Gist)-[:HAS_KEYWORD]-&gt;(keyword:Keyword)RETURN gist.title, keyword.name è¿™æ®µè¯­å¥å°†è¿”å›ä¸€å¼ è¡¨ï¼Œå…¶ä¸­çš„æ¯ä¸€è¡Œæ˜¯ç”±æ¯ä¸ªGistå’ŒKeywordçš„ç»„åˆæ„æˆçš„ï¼Œæ­£å¦‚åŒSQL joinçš„è¡Œä¸ºä¸€æ ·ã€‚ç°åœ¨æˆ‘ä»¬æ›´æ·±å…¥ä¸€æ­¥ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦æ‰¾åˆ°æŸä¸ªäººæ‰€ç¼–å†™çš„Gistå¯¹åº”çš„æ‰€æœ‰Domainï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸‹é¢è¿™æ¡æŸ¥è¯¢è¯­å¥ï¼š 123MATCH (person:Person)-[:WRITER_OF]-&gt;(gist:Gist)-[:HAS_DOMAIN]-&gt;(domain:Domain)WHERE person.name = â€œJohn Doeâ€RETURN domain.name, COUNT(gist) è¯¥è¯­å¥å°†è¿”å›å¦ä¸€ä¸ªç»“æœè¡¨ï¼Œå…¶ä¸­çš„æ¯ä¸€è¡ŒåŒ…å«Domainçš„åç§°ï¼Œä»¥åŠè¿™ä¸ªPersonå¯¹äºè¿™ä¸€Domainæ‰€ç¼–å†™çš„å…¨éƒ¨Gistçš„æ•°é‡ã€‚è¿™é‡Œæ— éœ€ä½¿ç”¨GROUP BYè¯­å¥ï¼Œå› ä¸ºå½“æˆ‘ä»¬ä½¿ç”¨ä¾‹å¦‚COUNT()è¿™æ ·çš„èšåˆå‡½æ•°æ—¶ï¼ŒNeo4jä¼šè‡ªåŠ¨åœ¨RETURNè¯­å¥ä¸­å¯¹å…¶å®ƒåˆ—è¿›è¡Œåˆ†ç»„æ“ä½œã€‚ ç°åœ¨ä½ å¯¹Cypherå·²ç»æœ‰ä¸€ç‚¹æ„Ÿè§‰äº†å§ï¼Ÿé‚£ä¹ˆè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ¥è‡ªå®é™…åº”ç”¨ä¸­çš„æŸ¥è¯¢ã€‚åœ¨åˆ›å»ºè¿™ä¸ªé—¨æˆ·æ—¶ï¼Œå¦‚æœèƒ½å¤Ÿé€šè¿‡æŸç§æ–¹å¼ï¼Œåªéœ€å¯¹æ•°æ®åº“è¿›è¡Œä¸€æ¬¡è¯·æ±‚å°±èƒ½å¤Ÿè¿”å›æˆ‘ä»¬æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶ä¸”ä»¥ä¸€ç§æˆ‘ä»¬éœ€è¦çš„æ ¼å¼è¿›è¡Œç»“æ„ç»„ç»‡ï¼Œé‚£å°†ååˆ†æœ‰ç”¨ã€‚ è®©æˆ‘ä»¬å¼€å§‹åˆ›å»ºè¿™ä¸ªç”¨äºé—¨æˆ·çš„APIï¼ˆå¯ä»¥åœ¨GitHubä¸Šæ‰¾åˆ°ï¼‰çš„æŸ¥è¯¢å§ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§Gistçš„titleå±æ€§è¿›è¡ŒåŒ¹é…ï¼Œå¹¶åŒ¹é…æ‰€æœ‰ç›¸å…³çš„GistèŠ‚ç‚¹ï¼š 123456// Match Gists based on title MATCH (gist:Gist) WHERE gist.title =~ &#123;search_query&#125; // Optionally match Gists with the same keyword // and pass on these related Gists with the // most common keywords first OPTIONAL MATCH (gist)-[:HAS_KEYWORD]-&gt;(keyword)&lt;-[:HAS_KEYWORD]-(related_gist) è¿™é‡Œæœ‰å‡ ä¸ªè¦æ³¨æ„çš„åœ°æ–¹ã€‚é¦–å…ˆï¼ŒWHEREè¯­å¥æ˜¯é€šè¿‡ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼ˆå³=~æ“ä½œç¬¦ï¼‰å’Œä¸€ä¸ªå‚æ•°å¯¹titleå±æ€§è¿›è¡ŒåŒ¹é…çš„ã€‚å‚æ•°ï¼ˆParameterï¼‰æ˜¯Neo4jçš„ä¸€é¡¹ç‰¹æ€§ï¼Œå®ƒèƒ½å¤Ÿå°†æŸ¥è¯¢ä¸å…¶æ‰€ä»£è¡¨çš„æ•°æ®è¿›è¡Œåˆ†ç¦»ã€‚ä½¿ç”¨å‚æ•°èƒ½å¤Ÿè®©Neo4jå¯¹æŸ¥è¯¢å’ŒæŸ¥è¯¢è®¡åˆ’è¿›è¡Œç¼“å­˜ï¼Œè¿™ä¹Ÿæ„å‘³ç€ä½ æ— éœ€æ‹…å¿ƒé­é‡æŸ¥è¯¢æ³¨å…¥æ”»å‡»ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªOPTIONAL MATCHè¯­å¥ï¼Œå®ƒè¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›å§‹ç»ˆè¿”å›åŸå§‹çš„Gistï¼Œå³ä½¿å®ƒå¹¶æ²¡æœ‰ç›¸å…³çš„Gistã€‚ ç°åœ¨è®©æˆ‘ä»¬å¯¹ä¹‹å‰çš„æŸ¥è¯¢è¿›è¡Œæ‰©å±•ï¼Œå°†RETURNè¯­å¥æ›¿æ¢ä¸ºWITHè¯­å¥ï¼š 12345678910MATCH (gist:Gist) WHERE gist.title =~ &#123;search_query&#125; OPTIONAL MATCH (gist)-[:HAS_KEYWORD]-&gt;(keyword)&lt;-[:HAS_KEYWORD]-(related_gist) WITH gist, related_gist, COUNT(DISTINCT keyword.name) AS keyword_count ORDER BY keyword_count DESC RETURN gist, COLLECT(DISTINCT &#123;related: &#123; id: related_gist.id, title: related_gist.title, poster_image: related_gist.poster_image, url: related_gist.url &#125;, weight: keyword_count &#125;) AS related åœ¨RETURNè¯­å¥ä¸­çš„COLLECT()ä½œç”¨æ˜¯å°†ç”±Gistå’Œç›¸å…³Gistæ‰€ç»„æˆçš„èŠ‚ç‚¹è½¬æ¢ä¸ºä¸€ä¸ªç»“æœé›†ï¼Œè®©å…¶ä¸­æ¯ä¸€è¡ŒGiståªå‡ºç°ä¸€æ¬¡ï¼Œå¹¶å¯¹åº”ä¸€ä¸ªç›¸å…³Gistçš„èŠ‚ç‚¹æ•°ç»„ã€‚åœ¨COLLECT()è¯­å¥ä¸­ï¼Œæˆ‘ä»¬åœ¨ç›¸å…³Gistä¸­ä»…æŒ‡å®šäº†æ‰€éœ€çš„éƒ¨åˆ†æ•°æ®ï¼Œä»¥å‡å°æ•´ä¸ªå“åº”çš„å¤§å°ã€‚ æœ€åï¼Œæˆ‘ä»¬å°†äº§ç”Ÿè¿™æ ·ä¸€æ¡æŸ¥è¯¢è¯­å¥ï¼Œè¿™ä¹Ÿæ˜¯æœ€åä¸€æ¬¡ä½¿ç”¨WITHè¯­å¥äº†ï¼š 123456789101112131415161718192021222324MATCH (gist:Gist) WHERE gist.title =~ &#123;search_query&#125; OPTIONAL MATCH (gist)-[:HAS_KEYWORD]-&gt;(keyword)&lt;-[:HAS_KEYWORD]-(related_gist) WITH gist, related_gist, COUNT(DISTINCT keyword.name) AS keyword_count ORDER BY keyword_count DESC WITH gist, COLLECT(DISTINCT &#123;related: &#123; id: related_gist.id, title: related_gist.title, poster_image: related_gist.poster_image, url: related_gist.url &#125;, weight: keyword_count &#125;) AS related // Optionally match domains, use cases, writers, and keywords for each Gist OPTIONAL MATCH (gist)-[:HAS_DOMAIN]-&gt;(domain:Domain) OPTIONAL MATCH (gist)-[:HAS_USECASE]-&gt;(usecase:UseCase) OPTIONAL MATCH (gist)&lt;-[:WRITER_OF]-(writer:Person) OPTIONAL MATCH (gist)-[:HAS_KEYWORD]-&gt;(keyword:Keyword) // Return one Gist per row with arrays of domains, use cases, writers, and keywords RETURN gist, related, COLLECT(DISTINCT domain.name) AS domains, COLLECT(DISTINCT usecase.name) AS usecases, COLLECT(DISTINCT keyword.name) AS keywords COLLECT(DISTINCT writer.name) AS writers, ORDER BY gist.title åœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œæˆ‘ä»¬å°†é€‰æ‹©æ€§åœ°åŒ¹é…æ‰€æœ‰ç›¸å…³çš„Domainã€Use Caseã€Keywordå’ŒPersonèŠ‚ç‚¹ï¼Œå¹¶ä¸”å°†å®ƒä»¬å…¨éƒ¨æ”¶é›†èµ·æ¥ï¼Œä¸æˆ‘ä»¬å¯¹ç›¸å…³Gistçš„å¤„ç†æ–¹å¼ç›¸åŒã€‚ç°åœ¨æˆ‘ä»¬çš„ç»“æœä¸å†æ˜¯å¹³å¦çš„ã€åæ­£è§„åŒ–çš„ï¼Œè€Œæ˜¯åŒ…å«ä¸€åˆ—Gistï¼Œå…¶ä¸­æ¯ä¸ªGistéƒ½å¯¹åº”ç€ç›¸å…³Gistçš„æ•°ç»„ï¼Œå½¢æˆäº†ä¸€ç§â€œhas manyâ€çš„å…³ç³»ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•é‡å¤æ•°æ®ã€‚å¤ªé…·äº†ï¼ ä¸ä»…å¦‚æ­¤ï¼Œå¦‚æœä½ è§‰å¾—ç”¨è¡¨çš„å½¢å¼è¿”å›æ•°æ®å¤ªè€åœŸï¼Œé‚£ä¹ˆCypherä¹Ÿå¯ä»¥è¿”å›å¯¹è±¡ï¼š 12345678910RETURN &#123;gist: gist, domains: collect(DISTINCT domain.name) AS domains, usecases: collect(DISTINCT usecase.name) AS usecases, writers: collect(DISTINCT writer.name) AS writers, keywords: collect(DISTINCT keyword.name) AS keywords, related_gists: related &#125; ORDER BY gist.title é€šå¸¸æ¥è¯´ï¼Œåœ¨ç¨å…·è§„æ¨¡çš„webåº”ç”¨ç¨‹åºä¸­ï¼Œéœ€è¦è¿›è¡Œå¤§é‡çš„æ•°æ®åº“è°ƒç”¨ä»¥è¿”å›HTTPå“åº”æ‰€éœ€çš„æ•°æ®ã€‚è™½ç„¶ä½ å¯ä»¥å¹¶è¡Œåœ°æ‰§è¡ŒæŸ¥è¯¢ï¼Œä½†é€šå¸¸æ¥è¯´ä½ éœ€è¦é¦–å…ˆè¿”å›æŸä¸ªæŸ¥è¯¢çš„ç»“æœé›†ï¼Œæ‰èƒ½å‘é€å¦ä¸€ä¸ªæ•°æ®åº“è¯·æ±‚ä»¥è·å–ç›¸å…³çš„æ•°æ®ã€‚åœ¨SQLä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ç”Ÿæˆå¤æ‚çš„ã€å¼€é”€å¾ˆå¤§çš„è¡¨joinè¯­å¥ï¼Œé€šè¿‡ä¸€ä¸ªæŸ¥è¯¢ä»å¤šå¼ è¡¨ä¸­è¿”å›ç»“æœã€‚ä½†åªè¦ä½ åœ¨åŒä¸€ä¸ªæŸ¥è¯¢ä¸­è¿›è¡Œäº†å¤šæ¬¡SQL joinï¼Œè¿™ä¸ªæŸ¥è¯¢çš„å¤æ‚æ€§å°†ä¼šé£å¿«åœ°å¢é•¿ã€‚æ›´ä¸ç”¨è¯´æ•°æ®åº“ä»ç„¶éœ€è¦è¿›è¡Œè¡¨æˆ–ç´¢å¼•æ‰«ææ‰èƒ½å¤Ÿè·å¾—ç›¸åº”çš„æ•°æ®äº†ã€‚è€Œåœ¨Neo4jä¸­ï¼Œé€šè¿‡å…³ç³»è·å–å®ä½“çš„æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨å¯¹åº”äºç›¸å…³èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå› æ­¤æœåŠ¡å™¨å¯ä»¥éšæ„è¿›è¡Œéå†ã€‚ å°½ç®¡å¦‚æ­¤ï¼Œè¿™ç§æ–¹å¼ä¹Ÿå­˜åœ¨ç€è¯¸å¤šç¼ºé™·ã€‚è™½ç„¶è¿™ç§æ–¹å¼èƒ½å¤Ÿé€šè¿‡ä¸€ä¸ªæŸ¥è¯¢è¿”å›æ‰€æœ‰æ•°æ®ï¼Œä½†è¿™ä¸ªæŸ¥è¯¢ä¼šç›¸å½“é•¿ã€‚æˆ‘è‡³ä»Šä¹Ÿæ²¡æœ‰æ‰¾åˆ°ä¸€ç§æ–¹å¼èƒ½å¤Ÿå¯¹è¿›è¡Œæ¨¡å—åŒ–ä»¥ä¾¿é‡ç”¨ã€‚è¿›ä¸€æ­¥è€ƒè™‘ï¼šæˆ‘ä»¬å¯ä»¥åœ¨å…¶å®ƒåœºåˆåŒæ ·è°ƒç”¨è¿™ä¸ªç»ˆç»“ç‚¹ï¼Œä½†è®©å®ƒæ˜¾ç¤ºç›¸å…³Gistçš„æ›´å¤šä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¿®æ”¹è¿™ä¸ªæŸ¥è¯¢ä»¥è¿”å›æ›´å¤šçš„æ•°æ®ï¼Œä½†ä¹Ÿæ„å‘³ç€å¯¹äºåŸå§‹çš„ç”¨ä¾‹æ¥è¯´ï¼Œå®ƒè¿”å›äº†é¢å¤–çš„ä¸å¿…è¦æ•°æ®ã€‚ æˆ‘ä»¬æ˜¯å¹¸è¿çš„ï¼Œå› ä¸ºæœ‰è¿™ä¹ˆå¤šä¼˜ç§€çš„æ•°æ®åº“å¯ä»¥é€‰æ‹©ã€‚è™½ç„¶å…³ç³»å‹æ•°æ®åº“å¯¹äºä¿å­˜ç»“æ„åŒ–æ•°æ®æ¥è¯´ä¾ç„¶æ˜¯æœ€ä½³çš„é€‰æ‹©ï¼Œä½†NoSQLæ•°æ®åº“æ›´é€‚åˆäºç®¡ç†åŠç»“æ„åŒ–æ•°æ®ã€éç»“æ„åŒ–æ•°æ®ä»¥åŠå›¾å½¢æ•°æ®ã€‚å¦‚æœä½ çš„æ•°æ®æ¨¡å‹ä¸­åŒ…æ‹¬å¤§é‡çš„å…³è”æ•°æ®ï¼Œå¹¶ä¸”å¸Œæœ›ä½¿ç”¨ä¸€ç§ç›´è§‚çš„ã€æœ‰è¶£çš„å¹¶ä¸”å¿«é€Ÿçš„æ•°æ®åº“è¿›è¡Œå¼€å‘ï¼Œé‚£ä¹ˆä½ å°±åº”å½“å°è¯•ä¸€ä¸‹Neo4jã€‚ æœ¬æ–‡ç”±Brian Underwoodæ’°å†™ï¼Œè€ŒMichael Hungerä¹Ÿä¸ºæœ¬æ–‡ä½œå‡ºäº†è®¸å¤šè´¡çŒ®ã€‚ å…³äºä½œè€…Brian Underwoodæ˜¯ä¸€ä½è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œå–œçˆ±ä»»ä½•ä¸æ•°æ®ç›¸å…³çš„ä¸œè¥¿ã€‚ä½œä¸ºä¸€åNeo4j çš„Developer Advocateï¼Œä»¥åŠneo4j ruby gemçš„ç»´æŠ¤è€…ï¼ŒBrianç»å¸¸é€šè¿‡ä¸€äº›æ¼”è®²ï¼Œä»¥åŠåœ¨ä»–çš„åšå®¢ä¸Šçš„æ–‡ç« å®£ä¼ å›¾å½¢æ•°æ®åº“çš„å¼ºå¤§ä¸ç®€æ´ã€‚Brianå¦‚ä»Šæ­£ä¸ä»–çš„å¦»å„¿åœ¨å…¨çƒæ—…è¡Œã€‚å¯ä»¥åœ¨Twitter ä¸Šæ‰¾åˆ°Brianï¼Œæˆ–åœ¨LinkedInä¸Šè”ç³»ä»–ã€‚ æŸ¥çœ‹è‹±æ–‡åŸæ–‡ï¼šFull Stack Web Development Using Neo4j","categories":[{"name":"Web","slug":"Web","permalink":"http://github.com/categories/Web/"}],"tags":[{"name":"Neo4j","slug":"Neo4j","permalink":"http://github.com/tags/Neo4j/"}],"keywords":[{"name":"Web","slug":"Web","permalink":"http://github.com/categories/Web/"}]},{"title":"D3.jsåŠ è½½æœ¬åœ°jsonæ–‡ä»¶çš„é—®é¢˜","slug":"D3.jsåŠ è½½æœ¬åœ°jsonæ–‡ä»¶çš„é—®é¢˜","date":"2016-11-09T13:13:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/11/09/D3.jsåŠ è½½æœ¬åœ°jsonæ–‡ä»¶çš„é—®é¢˜/","link":"","permalink":"http://github.com/2016/11/09/D3.jsåŠ è½½æœ¬åœ°jsonæ–‡ä»¶çš„é—®é¢˜/","excerpt":"é—®é¢˜æ‰“å¼€æœ¬åœ°htmlæ–‡ä»¶æ—¶ï¼ŒæŠ¥é”™å¦‚ä¸‹ 123XMLHttpRequest cannot load file:/cities.csv. Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension, https, chrome-extension-resource.Uncaught NetworkError: Failed to execute 'send' on 'XMLHttpRequest': Failed to load åˆ†æåŸå› æ˜¯å› ä¸ºæµè§ˆå™¨ä¸ºäº†å®‰å…¨æ€§è€ƒè™‘ï¼Œé»˜è®¤å¯¹è·¨åŸŸè®¿é—®ç¦æ­¢ï¼Œä¸å…è®¸ç›´æ¥è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚ è§£å†³ç»™æµè§ˆå™¨ä¼ å…¥å¯åŠ¨å‚æ•°ï¼ˆallow-file-access-from-filesï¼‰ï¼Œå…è®¸è·¨åŸŸè®¿é—®ã€‚Windowsä¸‹ï¼Œè¿è¡Œï¼ˆCMD+Rï¼‰æˆ–å³é”®æ¡Œé¢å¿«æ·æ–¹å¼-&gt;å±æ€§-&gt;ç›®æ ‡ï¼š","text":"é—®é¢˜æ‰“å¼€æœ¬åœ°htmlæ–‡ä»¶æ—¶ï¼ŒæŠ¥é”™å¦‚ä¸‹ 123XMLHttpRequest cannot load file:/cities.csv. Cross origin requests are only supported for protocol schemes: http, data, chrome, chrome-extension, https, chrome-extension-resource.Uncaught NetworkError: Failed to execute 'send' on 'XMLHttpRequest': Failed to load åˆ†æåŸå› æ˜¯å› ä¸ºæµè§ˆå™¨ä¸ºäº†å®‰å…¨æ€§è€ƒè™‘ï¼Œé»˜è®¤å¯¹è·¨åŸŸè®¿é—®ç¦æ­¢ï¼Œä¸å…è®¸ç›´æ¥è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚ è§£å†³ç»™æµè§ˆå™¨ä¼ å…¥å¯åŠ¨å‚æ•°ï¼ˆallow-file-access-from-filesï¼‰ï¼Œå…è®¸è·¨åŸŸè®¿é—®ã€‚Windowsä¸‹ï¼Œè¿è¡Œï¼ˆCMD+Rï¼‰æˆ–å³é”®æ¡Œé¢å¿«æ·æ–¹å¼-&gt;å±æ€§-&gt;ç›®æ ‡ï¼š 1\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\" --allow-file-access-from-files","categories":[{"name":"D3.js","slug":"D3-js","permalink":"http://github.com/categories/D3-js/"}],"tags":[{"name":"D3","slug":"D3","permalink":"http://github.com/tags/D3/"}],"keywords":[{"name":"D3.js","slug":"D3-js","permalink":"http://github.com/categories/D3-js/"}]},{"title":"ã€Androidã€‘Broadcastå¹¿æ’­æœºåˆ¶æ€»ç»“","slug":"ã€Androidã€‘Broadcastå¹¿æ’­æœºåˆ¶æ€»ç»“","date":"2016-10-25T08:06:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/10/25/ã€Androidã€‘Broadcastå¹¿æ’­æœºåˆ¶æ€»ç»“/","link":"","permalink":"http://github.com/2016/10/25/ã€Androidã€‘Broadcastå¹¿æ’­æœºåˆ¶æ€»ç»“/","excerpt":"åŸæ–‡é“¾æ¥ï¼š Androidæ€»ç»“ç¯‡ç³»åˆ—ï¼šAndroidå¹¿æ’­æœºåˆ¶ 1. Androidå¹¿æ’­æœºåˆ¶æ¦‚è¿°Androidå¹¿æ’­åˆ†ä¸ºä¸¤ä¸ªæ–¹é¢ï¼šå¹¿æ’­å‘é€è€…å’Œå¹¿æ’­æ¥æ”¶è€…ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼ŒBroadcastReceiveræŒ‡çš„å°±æ˜¯å¹¿æ’­æ¥æ”¶è€…ï¼ˆå¹¿æ’­æ¥æ”¶å™¨ï¼‰ã€‚å¹¿æ’­ä½œä¸ºAndroidç»„ä»¶é—´çš„é€šä¿¡æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨çš„åœºæ™¯å¦‚ä¸‹ï¼š åŒä¸€appå†…éƒ¨çš„åŒä¸€ç»„ä»¶å†…çš„æ¶ˆæ¯é€šä¿¡ï¼ˆå•ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ä¹‹é—´ï¼‰ï¼› åŒä¸€appå†…éƒ¨çš„ä¸åŒç»„ä»¶ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ï¼ˆå•ä¸ªè¿›ç¨‹ï¼‰ï¼› åŒä¸€appå…·æœ‰å¤šä¸ªè¿›ç¨‹çš„ä¸åŒç»„ä»¶ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ï¼› ä¸åŒappä¹‹é—´çš„ç»„ä»¶ä¹‹é—´æ¶ˆæ¯é€šä¿¡ï¼› Androidç³»ç»Ÿåœ¨ç‰¹å®šæƒ…å†µä¸‹ä¸Appä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ã€‚ ä»å®ç°åŸç†çœ‹ä¸Šï¼ŒAndroidä¸­çš„å¹¿æ’­ä½¿ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼ŒåŸºäºæ¶ˆæ¯çš„å‘å¸ƒ/è®¢é˜…äº‹ä»¶æ¨¡å‹ã€‚å› æ­¤ï¼Œä»å®ç°çš„è§’åº¦æ¥çœ‹ï¼ŒAndroidä¸­çš„å¹¿æ’­å°†å¹¿æ’­çš„å‘é€è€…å’Œæ¥å—è€…æå¤§ç¨‹åº¦ä¸Šè§£è€¦ï¼Œä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿæ–¹ä¾¿é›†æˆï¼Œæ›´æ˜“æ‰©å±•ã€‚å…·ä½“å®ç°æµç¨‹è¦ç‚¹ç²—ç•¥æ¦‚æ‹¬å¦‚ä¸‹ï¼š","text":"åŸæ–‡é“¾æ¥ï¼š Androidæ€»ç»“ç¯‡ç³»åˆ—ï¼šAndroidå¹¿æ’­æœºåˆ¶ 1. Androidå¹¿æ’­æœºåˆ¶æ¦‚è¿°Androidå¹¿æ’­åˆ†ä¸ºä¸¤ä¸ªæ–¹é¢ï¼šå¹¿æ’­å‘é€è€…å’Œå¹¿æ’­æ¥æ”¶è€…ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼ŒBroadcastReceiveræŒ‡çš„å°±æ˜¯å¹¿æ’­æ¥æ”¶è€…ï¼ˆå¹¿æ’­æ¥æ”¶å™¨ï¼‰ã€‚å¹¿æ’­ä½œä¸ºAndroidç»„ä»¶é—´çš„é€šä¿¡æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨çš„åœºæ™¯å¦‚ä¸‹ï¼š åŒä¸€appå†…éƒ¨çš„åŒä¸€ç»„ä»¶å†…çš„æ¶ˆæ¯é€šä¿¡ï¼ˆå•ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ä¹‹é—´ï¼‰ï¼› åŒä¸€appå†…éƒ¨çš„ä¸åŒç»„ä»¶ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ï¼ˆå•ä¸ªè¿›ç¨‹ï¼‰ï¼› åŒä¸€appå…·æœ‰å¤šä¸ªè¿›ç¨‹çš„ä¸åŒç»„ä»¶ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ï¼› ä¸åŒappä¹‹é—´çš„ç»„ä»¶ä¹‹é—´æ¶ˆæ¯é€šä¿¡ï¼› Androidç³»ç»Ÿåœ¨ç‰¹å®šæƒ…å†µä¸‹ä¸Appä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ã€‚ ä»å®ç°åŸç†çœ‹ä¸Šï¼ŒAndroidä¸­çš„å¹¿æ’­ä½¿ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼ŒåŸºäºæ¶ˆæ¯çš„å‘å¸ƒ/è®¢é˜…äº‹ä»¶æ¨¡å‹ã€‚å› æ­¤ï¼Œä»å®ç°çš„è§’åº¦æ¥çœ‹ï¼ŒAndroidä¸­çš„å¹¿æ’­å°†å¹¿æ’­çš„å‘é€è€…å’Œæ¥å—è€…æå¤§ç¨‹åº¦ä¸Šè§£è€¦ï¼Œä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿæ–¹ä¾¿é›†æˆï¼Œæ›´æ˜“æ‰©å±•ã€‚å…·ä½“å®ç°æµç¨‹è¦ç‚¹ç²—ç•¥æ¦‚æ‹¬å¦‚ä¸‹ï¼š å¹¿æ’­æ¥æ”¶è€…BroadcastReceiveré€šè¿‡Binderæœºåˆ¶å‘AMS(Activity Manager Service)è¿›è¡Œæ³¨å†Œï¼› å¹¿æ’­å‘é€è€…é€šè¿‡binderæœºåˆ¶å‘AMSå‘é€å¹¿æ’­ï¼› AMSæŸ¥æ‰¾ç¬¦åˆç›¸åº”æ¡ä»¶ï¼ˆIntentFilter/Permissionç­‰ï¼‰çš„BroadcastReceiverï¼Œå°†å¹¿æ’­å‘é€åˆ°BroadcastReceiverï¼ˆä¸€èˆ¬æƒ…å†µä¸‹æ˜¯Activityï¼‰ç›¸åº”çš„æ¶ˆæ¯å¾ªç¯é˜Ÿåˆ—ä¸­ï¼› æ¶ˆæ¯å¾ªç¯æ‰§è¡Œæ‹¿åˆ°æ­¤å¹¿æ’­ï¼Œå›è°ƒBroadcastReceiverä¸­çš„onReceive()æ–¹æ³•ã€‚ å¯¹äºä¸åŒçš„å¹¿æ’­ç±»å‹ï¼Œä»¥åŠä¸åŒçš„BroadcastReceiveræ³¨å†Œæ–¹å¼ï¼Œå…·ä½“å®ç°ä¸Šä¼šæœ‰ä¸åŒã€‚ä½†æ€»ä½“æµç¨‹å¤§è‡´å¦‚ä¸Šã€‚ ç”±æ­¤çœ‹æ¥ï¼Œå¹¿æ’­å‘é€è€…å’Œå¹¿æ’­æ¥æ”¶è€…åˆ†åˆ«å±äºè§‚å¯Ÿè€…æ¨¡å¼ä¸­çš„æ¶ˆæ¯å‘å¸ƒå’Œè®¢é˜…ä¸¤ç«¯ï¼ŒAMSå±äºä¸­é—´çš„å¤„ç†ä¸­å¿ƒã€‚å¹¿æ’­å‘é€è€…å’Œå¹¿æ’­æ¥æ”¶è€…çš„æ‰§è¡Œæ˜¯å¼‚æ­¥çš„ï¼Œå‘å‡ºå»çš„å¹¿æ’­ä¸ä¼šå…³å¿ƒæœ‰æ— æ¥æ”¶è€…æ¥æ”¶ï¼Œä¹Ÿä¸ç¡®å®šæ¥æ”¶è€…åˆ°åº•æ˜¯ä½•æ—¶æ‰èƒ½æ¥æ”¶åˆ°ã€‚æ˜¾ç„¶ï¼Œæ•´ä½“æµç¨‹ä¸EventBuséå¸¸ç±»ä¼¼ã€‚ åœ¨ä¸Šæ–‡è¯´åˆ—ä¸¾çš„å¹¿æ’­æœºåˆ¶å…·ä½“å¯ä»¥ä½¿ç”¨çš„åœºæ™¯ä¸­ï¼Œç°åˆ†æå®é™…åº”ç”¨ä¸­çš„é€‚ç”¨æ€§ï¼š ç¬¬ä¸€ç§æƒ…å½¢ï¼šåŒä¸€appå†…éƒ¨çš„åŒä¸€ç»„ä»¶å†…çš„æ¶ˆæ¯é€šä¿¡ï¼ˆå•ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ä¹‹é—´ï¼‰ï¼Œå®é™…åº”ç”¨ä¸­è‚¯å®šæ˜¯ä¸ä¼šç”¨åˆ°å¹¿æ’­æœºåˆ¶çš„ï¼ˆè™½ç„¶å¯ä»¥ç”¨ï¼‰ï¼Œæ— è®ºæ˜¯ä½¿ç”¨æ‰©å±•å˜é‡ä½œç”¨åŸŸã€åŸºäºæ¥å£çš„å›è°ƒè¿˜æ˜¯Handler-post/Handler-Messageç­‰æ–¹å¼ï¼Œéƒ½å¯ä»¥ç›´æ¥å¤„ç†æ­¤ç±»é—®é¢˜ï¼Œè‹¥é€‚ç”¨å¹¿æ’­æœºåˆ¶ï¼Œæ˜¾ç„¶æœ‰äº›â€œæ€é¸¡ç‰›åˆ€â€çš„æ„Ÿè§‰ï¼Œä¼šæ˜¾å¤ªâ€œé‡â€ï¼› ç¬¬äºŒç§æƒ…å½¢ï¼šåŒä¸€appå†…éƒ¨çš„ä¸åŒç»„ä»¶ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ï¼ˆå•ä¸ªè¿›ç¨‹ï¼‰ï¼Œå¯¹äºæ­¤ç±»éœ€æ±‚ï¼Œåœ¨æœ‰äº›æ•™å¤æ‚çš„æƒ…å†µä¸‹å•çº¯çš„ä¾é åŸºäºæ¥å£çš„å›è°ƒç­‰æ–¹å¼ä¸å¥½å¤„ç†ï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨EventBusç­‰ï¼Œç›¸å¯¹è€Œè¨€ï¼ŒEventBusç”±äºæ˜¯é’ˆå¯¹ç»Ÿä¸€è¿›ç¨‹ï¼Œç”¨äºå¤„ç†æ­¤ç±»éœ€æ±‚éå¸¸é€‚åˆï¼Œä¸”è½»æ¾è§£è€¦ã€‚å¯ä»¥å‚è§æ–‡ä»¶ã€ŠAndroidå„ç»„ä»¶/æ§ä»¶é—´é€šä¿¡åˆ©å™¨ä¹‹EventBusã€‹ã€‚ ç¬¬ä¸‰ã€å››ã€äº”æƒ…å½¢ï¼šç”±äºæ¶‰åŠä¸åŒè¿›ç¨‹é—´çš„æ¶ˆæ¯é€šä¿¡ï¼Œæ­¤æ—¶æ ¹æ®å®é™…ä¸šåŠ¡ä½¿ç”¨å¹¿æ’­æœºåˆ¶ä¼šæ˜¾å¾—éå¸¸é€‚å®œã€‚ä¸‹é¢ä¸»è¦é’ˆå¯¹Androidå¹¿æ’­ä¸­çš„å…·ä½“çŸ¥è¯†ç‚¹è¿›è¡Œæ€»ç»“ã€‚ 2. BroadcastReceiverè‡ªå®šä¹‰BroadcastReceiverè‡ªå®šä¹‰å¹¿æ’­æ¥æ”¶å™¨éœ€è¦ç»§æ‰¿åŸºç±»BroadcastReceivreï¼Œå¹¶å®ç°æŠ½è±¡æ–¹æ³•onReceive(context, intent)æ–¹æ³•ã€‚å¹¿æ’­æ¥æ”¶å™¨æ¥æ”¶åˆ°ç›¸åº”å¹¿æ’­åï¼Œä¼šè‡ªåŠ¨å›åˆ°onReceive(..)æ–¹æ³•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¹¿æ’­æ¥æ”¶å™¨ä¹Ÿæ˜¯è¿è¡Œåœ¨UIçº¿ç¨‹ï¼Œå› æ­¤ï¼ŒonReceiveæ–¹æ³•ä¸­ä¸èƒ½æ‰§è¡Œå¤ªè€—æ—¶çš„æ“ä½œã€‚å¦åˆ™å°†å› æ­¤ANRã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚ï¼ŒonReceiveæ–¹æ³•ä¸­éƒ½ä¼šæ¶‰åŠåˆ°ä¸å…¶ä»–ç»„ä»¶ä¹‹é—´çš„äº¤äº’ï¼Œå¦‚å‘é€Notificationã€å¯åŠ¨serviceç­‰ã€‚ä¸‹é¢ä»£ç ç‰‡æ®µæ˜¯ä¸€ä¸ªç®€å•çš„å¹¿æ’­æ¥æ”¶å™¨çš„è‡ªå®šä¹‰ï¼š 123456789101112131415public class MyBroadcastReceiver extends BroadcastReceiver &#123; public static final String TAG = \"MyBroadcastReceiver\"; public static int m = 1; @Override public void onReceive(Context context, Intent intent) &#123; Log.w(TAG, \"intent:\" + intent); String name = intent.getStringExtra(\"name\"); Log.w(TAG, \"name:\" + name + \" m=\" + m); m++; Bundle bundle = intent.getExtras(); &#125;&#125; BroadcastReceiveræ³¨å†Œç±»å‹BroadcastReceiveræ€»ä½“ä¸Šå¯ä»¥åˆ†ä¸ºä¸¤ç§æ³¨å†Œç±»å‹ï¼šé™æ€æ³¨å†Œå’ŒåŠ¨æ€æ³¨å†Œã€‚ 1). é™æ€æ³¨å†Œï¼šç›´æ¥åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­è¿›è¡Œæ³¨å†Œã€‚è§„åˆ™å¦‚ä¸‹ï¼š 123456789&lt;receiver android:enabled=[\"true\" | \"false\"]android:exported=[\"true\" | \"false\"]android:icon=\"drawable resource\"android:label=\"string resource\"android:name=\"string\"android:permission=\"string\"android:process=\"string\" &gt;. . .&lt;/receiver&gt; å…¶ä¸­ï¼Œéœ€è¦æ³¨æ„çš„å±æ€§ android:exported â€” æ­¤broadcastReceiverèƒ½å¦æ¥æ”¶å…¶ä»–Appçš„å‘å‡ºçš„å¹¿æ’­ï¼Œè¿™ä¸ªå±æ€§é»˜è®¤å€¼æœ‰ç‚¹æ„æ€ï¼Œå…¶é»˜è®¤å€¼æ˜¯ç”±receiverä¸­æœ‰æ— intent-filterå†³å®šçš„ï¼Œå¦‚æœæœ‰intent-filterï¼Œé»˜è®¤å€¼ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚ï¼ˆåŒæ ·çš„ï¼Œactivity/serviceä¸­çš„æ­¤å±æ€§é»˜è®¤å€¼ä¸€æ ·éµå¾ªæ­¤è§„åˆ™ï¼‰åŒæ—¶ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå€¼çš„è®¾å®šæ˜¯ä»¥applicationæˆ–è€…application user idä¸ºç•Œçš„ï¼Œè€Œéè¿›ç¨‹ä¸ºç•Œï¼ˆä¸€ä¸ªåº”ç”¨ä¸­å¯èƒ½å«æœ‰å¤šä¸ªè¿›ç¨‹ï¼‰ï¼› android:name â€” æ­¤broadcastReceiverç±»åï¼› android:permission â€” å¦‚æœè®¾ç½®ï¼Œå…·æœ‰ç›¸åº”æƒé™çš„å¹¿æ’­å‘é€æ–¹å‘é€çš„å¹¿æ’­æ‰èƒ½è¢«æ­¤broadcastReceiveræ‰€æ¥æ”¶ï¼› android:process â€” broadcastReceiverè¿è¡Œæ‰€å¤„çš„è¿›ç¨‹ã€‚é»˜è®¤ä¸ºappçš„è¿›ç¨‹ã€‚å¯ä»¥æŒ‡å®šç‹¬ç«‹çš„è¿›ç¨‹ï¼ˆAndroidå››å¤§åŸºæœ¬ç»„ä»¶éƒ½å¯ä»¥é€šè¿‡æ­¤å±æ€§æŒ‡å®šè‡ªå·±çš„ç‹¬ç«‹è¿›ç¨‹ï¼‰ å¸¸è§çš„æ³¨å†Œå½¢å¼æœ‰: 12345678&lt;receiver android:name=\".MyBroadcastReceiver\" &gt; &lt;intent-filter&gt; &lt;action android:name=\"android.net.conn.CONNECTIVITY_CHANGE\" /&gt; &lt;/intent-filter&gt; &lt;intent-filter&gt; &lt;action android:name=\"android.intent.action.BOOT_COMPLETED\" /&gt; &lt;/intent-filter&gt;&lt;/receiver&gt; å…¶ä¸­ï¼Œintent-filterç”±äºæŒ‡å®šæ­¤å¹¿æ’­æ¥æ”¶å™¨å°†ç”¨äºæ¥æ”¶ç‰¹å®šçš„å¹¿æ’­ç±»å‹ã€‚æœ¬ç¤ºä¾‹ä¸­ç»™å‡ºçš„æ˜¯ç”¨äºæ¥æ”¶ç½‘ç»œçŠ¶æ€æ”¹å˜æˆ–å¼€å¯å¯åŠ¨æ—¶ç³»ç»Ÿè‡ªèº«æ‰€å‘å‡ºçš„å¹¿æ’­ã€‚å½“æ­¤Appé¦–æ¬¡å¯åŠ¨æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å®ä¾‹åŒ–MyBroadcastReceiverï¼Œå¹¶æ³¨å†Œåˆ°ç³»ç»Ÿä¸­ã€‚ ä¹‹å‰å¸¸è¯´ï¼šé™æ€æ³¨å†Œçš„å¹¿æ’­æ¥æ”¶å™¨å³ä½¿appå·²ç»é€€å‡ºï¼Œä¸»è¦æœ‰ç›¸åº”çš„å¹¿æ’­å‘å‡ºï¼Œä¾ç„¶å¯ä»¥æ¥æ”¶åˆ°ï¼Œä½†æ­¤ç§æè¿°è‡ªAndroid 3.1å¼€å§‹æœ‰å¯èƒ½ä¸å†æˆç«‹ã€‚å…·ä½“åˆ†æè¯¦è§æœ¬æ–‡åé¢éƒ¨åˆ†ã€‚ 2). åŠ¨æ€æ³¨å†Œï¼šåŠ¨æ€æ³¨å†Œæ—¶ï¼Œæ— é¡»åœ¨AndroidManifestä¸­æ³¨å†Œç»„ä»¶ã€‚ç›´æ¥åœ¨ä»£ç ä¸­é€šè¿‡è°ƒç”¨Contextçš„registerReceiverå‡½æ•°ï¼Œå¯ä»¥åœ¨ç¨‹åºä¸­åŠ¨æ€æ³¨å†ŒBroadcastReceiverã€‚registerReceiverçš„å®šä¹‰å½¢å¼å¦‚ä¸‹ï¼š 123registerReceiver(BroadcastReceiver receiver, IntentFilter filter)registerReceiver(BroadcastReceiver receiver, IntentFilter filter, String broadcastPermission, Handler scheduler) å…¸å‹çš„å†™æ³•ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122public class MainActivity extends Activity &#123; public static final String BROADCAST_ACTION = \"com.example.corn\"; private BroadcastReceiver mBroadcastReceiver; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); mBroadcastReceiver = new MyBroadcastReceiver(); IntentFilter intentFilter = new IntentFilter(); intentFilter.addAction(BROADCAST_ACTION); registerReceiver(mBroadcastReceiver, intentFilter); &#125; @Override protected void onDestroy() &#123; super.onDestroy(); unregisterReceiver(mBroadcastReceiver); &#125;&#125; æ³¨ï¼šAndroidä¸­æ‰€æœ‰ä¸è§‚å¯Ÿè€…æ¨¡å¼æœ‰å…³çš„è®¾è®¡ä¸­ï¼Œä¸€æ—¦æ¶‰åŠåˆ°registerï¼Œå¿…å®šåœ¨ç›¸åº”çš„æ—¶æœºéœ€è¦unregisterã€‚å› æ­¤ï¼Œä¸Šä¾‹åœ¨onDestroy()å›åˆ°ä¸­éœ€è¦unregisterReceiver(mBroadcastReceiver)ã€‚ å½“æ­¤Activityå®ä¾‹åŒ–æ—¶ï¼Œä¼šåŠ¨æ€å°†MyBroadcastReceiveræ³¨å†Œåˆ°ç³»ç»Ÿä¸­ã€‚å½“æ­¤Activityé”€æ¯æ—¶ï¼ŒåŠ¨æ€æ³¨å†Œçš„MyBroadcastReceiverå°†ä¸å†æ¥æ”¶åˆ°ç›¸åº”çš„å¹¿æ’­ã€‚ 3. å¹¿æ’­å‘é€åŠå¹¿æ’­ç±»å‹ç»å¸¸è¯´â€å‘é€å¹¿æ’­â€œå’Œâ€æ¥æ”¶â€œï¼Œè¡¨é¢ä¸Šçœ‹å¹¿æ’­ä½œä¸ºAndroidå¹¿æ’­æœºåˆ¶ä¸­çš„å®ä½“ï¼Œå®é™…ä¸Šè¿™ä¸€å®ä½“æœ¬èº«æ˜¯å¹¶ä¸æ˜¯ä»¥æ‰€è°“çš„â€å¹¿æ’­â€œå¯¹è±¡å­˜åœ¨çš„ï¼Œè€Œæ˜¯ä»¥â€æ„å›¾â€œï¼ˆIntentï¼‰å»è¡¨ç¤ºã€‚å®šä¹‰å¹¿æ’­çš„å®šä¹‰è¿‡ç¨‹ï¼Œå®é™…å°±æ˜¯ç›¸åº”å¹¿æ’­â€æ„å›¾â€œçš„å®šä¹‰è¿‡ç¨‹ï¼Œç„¶åé€šè¿‡å¹¿æ’­å‘é€è€…å°†æ­¤â€æ„å›¾â€œå‘é€å‡ºå»ã€‚è¢«ç›¸åº”çš„BroadcastReceiveræ¥æ”¶åå°†ä¼šå›è°ƒonReceive()å‡½æ•°ã€‚ ä¸‹æ®µä»£ç ç‰‡æ®µæ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªæ™®é€šå¹¿æ’­çš„å®šä¹‰è¿‡ç¨‹ï¼Œå¹¶å‘é€å‡ºå»ã€‚å…¶ä¸­setAction(..)å¯¹åº”äºBroadcastReceiverä¸­çš„intentFilterä¸­çš„actionã€‚ 1234Intent intent = new Intent();intent.setAction(BROADCAST_ACTION);intent.putExtra(\"name\", \"qqyumidi\");sendBroadcast(intent); æ ¹æ®å¹¿æ’­çš„å‘é€æ–¹å¼ï¼Œå¯ä»¥å°†å…¶åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ï¼š Normal Broadcastï¼šæ™®é€šå¹¿æ’­ System Broadcast : ç³»ç»Ÿå¹¿æ’­ Ordered broadcastï¼šæœ‰åºå¹¿æ’­ Sticky Broadcastï¼šç²˜æ€§å¹¿æ’­(åœ¨ android 5.0/api 21ä¸­deprecated,ä¸å†æ¨èä½¿ç”¨ï¼Œç›¸åº”çš„è¿˜æœ‰ç²˜æ€§æœ‰åºå¹¿æ’­ï¼ŒåŒæ ·å·²ç»deprecated) Local Broadcastï¼šAppåº”ç”¨å†…å¹¿æ’­ ä¸‹é¢åˆ†åˆ«æ€»ç»“ä¸‹å„ç§ç±»å‹çš„å‘é€æ–¹å¼åŠå…¶ç‰¹ç‚¹ã€‚ 1). Normal Broadcastï¼šæ™®é€šå¹¿æ’­æ­¤å¤„å°†æ™®é€šå¹¿æ’­ç•Œå®šä¸ºï¼šå¼€å‘è€…è‡ªå·±å®šä¹‰çš„intentï¼Œä»¥context.sendBroadcast_â€AsUserâ€(intent, â€¦)å½¢å¼ã€‚å…·ä½“å¯ä»¥ä½¿ç”¨çš„æ–¹æ³•æœ‰ï¼šsendBroadcast(intent)/sendBroadcast(intent, receiverPermission)/sendBroadcastAsUser(intent, userHandler)/sendBroadcastAsUser(intent, userHandler,receiverPermission)ã€‚æ™®é€šå¹¿æ’­ä¼šè¢«æ³¨å†Œäº†çš„ç›¸åº”çš„æ„Ÿå…´è¶£ï¼ˆintent-filteråŒ¹é…ï¼‰æ¥æ”¶ï¼Œä¸”é¡ºåºæ˜¯æ— åºçš„ã€‚å¦‚æœå‘é€å¹¿æ’­æ—¶æœ‰ç›¸åº”çš„æƒé™è¦æ±‚ï¼ŒBroadCastReceiverå¦‚æœæƒ³è¦æ¥æ”¶æ­¤å¹¿æ’­ï¼Œä¹Ÿéœ€è¦æœ‰ç›¸åº”çš„æƒé™ã€‚ 2). System Broadcast: ç³»ç»Ÿå¹¿æ’­Androidç³»ç»Ÿä¸­å†…ç½®äº†å¤šä¸ªç³»ç»Ÿå¹¿æ’­ï¼Œåªè¦æ¶‰åŠåˆ°æ‰‹æœºçš„åŸºæœ¬æ“ä½œï¼ŒåŸºæœ¬ä¸Šéƒ½ä¼šå‘å‡ºç›¸åº”çš„ç³»ç»Ÿå¹¿æ’­ã€‚å¦‚ï¼šå¼€å¯å¯åŠ¨ï¼Œç½‘ç»œçŠ¶æ€æ”¹å˜ï¼Œæ‹ç…§ï¼Œå±å¹•å…³é—­ä¸å¼€å¯ï¼Œç‚¹äº®ä¸è¶³ç­‰ç­‰ã€‚æ¯ä¸ªç³»ç»Ÿå¹¿æ’­éƒ½å…·æœ‰ç‰¹å®šçš„intent-filterï¼Œå…¶ä¸­ä¸»è¦åŒ…æ‹¬å…·ä½“çš„actionï¼Œç³»ç»Ÿå¹¿æ’­å‘å‡ºåï¼Œå°†è¢«ç›¸åº”çš„BroadcastReceiveræ¥æ”¶ã€‚ç³»ç»Ÿå¹¿æ’­åœ¨ç³»ç»Ÿå†…éƒ¨å½“ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæœ‰ç³»ç»Ÿè‡ªåŠ¨å‘å‡ºã€‚ 3). Ordered broadcastï¼šæœ‰åºå¹¿æ’­æœ‰åºå¹¿æ’­çš„æœ‰åºå¹¿æ’­ä¸­çš„â€œæœ‰åºâ€æ˜¯é’ˆå¯¹å¹¿æ’­æ¥æ”¶è€…è€Œè¨€çš„ï¼ŒæŒ‡çš„æ˜¯å‘é€å‡ºå»çš„å¹¿æ’­è¢«BroadcastReceiveræŒ‰ç…§å…ˆåå¾ªåºæ¥æ”¶ã€‚æœ‰åºå¹¿æ’­çš„å®šä¹‰è¿‡ç¨‹ä¸æ™®é€šå¹¿æ’­æ— å¼‚ï¼Œåªæ˜¯å…¶çš„ä¸»è¦å‘é€æ–¹å¼å˜ä¸ºï¼šsendOrderedBroadcast(intent, receiverPermission, â€¦)ã€‚ å¯¹äºæœ‰åºå¹¿æ’­ï¼Œå…¶ä¸»è¦ç‰¹ç‚¹æ€»ç»“å¦‚ä¸‹ï¼š a. å¤šä¸ªå…·å½“å‰å·²ç»æ³¨å†Œä¸”æœ‰æ•ˆçš„BroadcastReceiveræ¥æ”¶æœ‰åºå¹¿æ’­æ—¶ï¼Œæ˜¯æŒ‰ç…§å…ˆåé¡ºåºæ¥æ”¶çš„ï¼Œå…ˆåé¡ºåºåˆ¤å®šæ ‡å‡†éµå¾ªä¸ºï¼šå°†å½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰æœ‰æ•ˆçš„åŠ¨æ€æ³¨å†Œå’Œé™æ€æ³¨å†Œçš„BroadcastReceiveræŒ‰ç…§priorityå±æ€§å€¼ä»å¤§åˆ°å°æ’åºï¼Œå¯¹äºå…·æœ‰ç›¸åŒçš„priorityçš„åŠ¨æ€å¹¿æ’­å’Œé™æ€å¹¿æ’­ï¼ŒåŠ¨æ€å¹¿æ’­ä¼šæ’åœ¨å‰é¢ã€‚ b. å…ˆæ¥æ”¶çš„BroadcastReceiverå¯ä»¥å¯¹æ­¤æœ‰åºå¹¿æ’­è¿›è¡Œæˆªæ–­ï¼Œä½¿åé¢çš„BroadcastReceiverä¸å†æ¥æ”¶åˆ°æ­¤å¹¿æ’­ï¼Œä¹Ÿå¯ä»¥å¯¹å¹¿æ’­è¿›è¡Œä¿®æ”¹ï¼Œä½¿åé¢çš„BroadcastReceiveræ¥æ”¶åˆ°å¹¿æ’­åè§£æå¾—åˆ°é”™è¯¯çš„å‚æ•°å€¼ã€‚å½“ç„¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å»ºè®®å¯¹æœ‰åºå¹¿æ’­è¿›è¡Œæ­¤ç±»æ“ä½œï¼Œå°¤å…¶æ˜¯é’ˆå¯¹ç³»ç»Ÿä¸­çš„æœ‰åºå¹¿æ’­ã€‚ 4)Sticky Broadcastï¼šç²˜æ€§å¹¿æ’­åœ¨ android 5.0/api 21ä¸­deprecated,ä¸å†æ¨èä½¿ç”¨ï¼Œç›¸åº”çš„è¿˜æœ‰ç²˜æ€§æœ‰åºå¹¿æ’­ï¼ŒåŒæ ·å·²ç»deprecatedã€‚æ—¢ç„¶å·²ç»deprecatedï¼Œæ­¤å¤„ä¸å†å¤šåšæ€»ç»“ã€‚ 5)Local Broadcastï¼šAppåº”ç”¨å†…å¹¿æ’­ï¼ˆæ­¤å¤„çš„Appåº”ç”¨ä»¥Appåº”ç”¨è¿›ç¨‹ä¸ºç•Œï¼‰ç”±å‰æ–‡é˜è¿°å¯çŸ¥ï¼ŒAndroidä¸­çš„å¹¿æ’­å¯ä»¥è·¨è¿›ç¨‹ç”šè‡³è·¨Appç›´æ¥é€šä¿¡ï¼Œä¸”æ³¨å†Œæ˜¯exportedå¯¹äºæœ‰intent-filterçš„æƒ…å†µä¸‹é»˜è®¤å€¼æ˜¯trueï¼Œç”±æ­¤å°†å¯èƒ½å‡ºç°å®‰å…¨éšæ‚£å¦‚ä¸‹ï¼š å…¶ä»–Appå¯èƒ½ä¼šé’ˆå¯¹æ€§çš„å‘å‡ºä¸å½“å‰App intent-filterç›¸åŒ¹é…çš„å¹¿æ’­ï¼Œç”±æ­¤å¯¼è‡´å½“å‰Appä¸æ–­æ¥æ”¶åˆ°å¹¿æ’­å¹¶å¤„ç†ï¼› å…¶ä»–Appå¯ä»¥æ³¨å†Œä¸å½“å‰Appä¸€è‡´çš„intent-filterç”¨äºæ¥æ”¶å¹¿æ’­ï¼Œè·å–å¹¿æ’­å…·ä½“ä¿¡æ¯ã€‚ æ— è®ºå“ªç§æƒ…å½¢ï¼Œè¿™äº›å®‰å…¨éšæ‚£éƒ½ç¡®å®æ˜¯å­˜åœ¨çš„ã€‚ç”±æ­¤ï¼Œæœ€å¸¸è§çš„å¢åŠ å®‰å…¨æ€§çš„æ–¹æ¡ˆæ˜¯ï¼š å¯¹äºåŒä¸€Appå†…éƒ¨å‘é€å’Œæ¥æ”¶å¹¿æ’­ï¼Œå°†exportedå±æ€§äººä¸ºè®¾ç½®æˆfalseï¼Œä½¿å¾—éæœ¬Appå†…éƒ¨å‘å‡ºçš„æ­¤å¹¿æ’­ä¸è¢«æ¥æ”¶ï¼› åœ¨å¹¿æ’­å‘é€å’Œæ¥æ”¶æ—¶ï¼Œéƒ½å¢åŠ ä¸Šç›¸åº”çš„permissionï¼Œç”¨äºæƒé™éªŒè¯ï¼› å‘é€å¹¿æ’­æ—¶ï¼ŒæŒ‡å®šç‰¹å®šå¹¿æ’­æ¥æ”¶å™¨æ‰€åœ¨çš„åŒ…åï¼Œå…·ä½“æ˜¯é€šè¿‡intent.setPackage(packageName)æŒ‡å®šåœ¨ï¼Œè¿™æ ·æ­¤å¹¿æ’­å°†åªä¼šå‘é€åˆ°æ­¤åŒ…ä¸­çš„Appå†…ä¸ä¹‹ç›¸åŒ¹é…çš„æœ‰æ•ˆå¹¿æ’­æ¥æ”¶å™¨ä¸­ã€‚ Appåº”ç”¨å†…å¹¿æ’­å¯ä»¥ç†è§£æˆä¸€ç§å±€éƒ¨å¹¿æ’­çš„å½¢å¼ï¼Œå¹¿æ’­çš„å‘é€è€…å’Œæ¥æ”¶è€…éƒ½åŒå±äºä¸€ä¸ªAppã€‚å®é™…çš„ä¸šåŠ¡éœ€æ±‚ä¸­ï¼ŒAppåº”ç”¨å†…å¹¿æ’­ç¡®å®å¯èƒ½éœ€è¦ç”¨åˆ°ã€‚åŒæ—¶ï¼Œä¹‹æ‰€ä»¥ä½¿ç”¨åº”ç”¨å†…å¹¿æ’­æ—¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å…¨å±€å¹¿æ’­çš„å½¢å¼ï¼Œæ›´å¤šçš„è€ƒè™‘åˆ°çš„æ˜¯Androidå¹¿æ’­æœºåˆ¶ä¸­çš„å®‰å…¨æ€§é—®é¢˜ã€‚ ç›¸æ¯”äºå…¨å±€å¹¿æ’­ï¼ŒAppåº”ç”¨å†…å¹¿æ’­ä¼˜åŠ¿ä½“ç°åœ¨ï¼š å®‰å…¨æ€§æ›´é«˜ï¼› æ›´åŠ é«˜æ•ˆã€‚ ä¸ºæ­¤ï¼ŒAndroid v4å…¼å®¹åŒ…ä¸­ç»™å‡ºäº†å°è£…å¥½çš„LocalBroadcastManagerç±»ï¼Œç”¨äºç»Ÿä¸€å¤„ç†Appåº”ç”¨å†…çš„å¹¿æ’­é—®é¢˜ï¼Œä½¿ç”¨æ–¹å¼ä¸Šä¸é€šå¸¸çš„å…¨å±€å¹¿æ’­å‡ ä¹ç›¸åŒï¼Œåªæ˜¯æ³¨å†Œ/å–æ¶ˆæ³¨å†Œå¹¿æ’­æ¥æ”¶å™¨å’Œå‘é€å¹¿æ’­æ—¶å°†ä¸»è°ƒcontextå˜æˆäº†LocalBroadcastManagerçš„å•ä¸€å®ä¾‹ã€‚ ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š 123456789101112131415//registerReceiver(mBroadcastReceiver, intentFilter);//æ³¨å†Œåº”ç”¨å†…å¹¿æ’­æ¥æ”¶å™¨localBroadcastManager = LocalBroadcastManager.getInstance(this);localBroadcastManager.registerReceiver(mBroadcastReceiver, intentFilter); //unregisterReceiver(mBroadcastReceiver);//å–æ¶ˆæ³¨å†Œåº”ç”¨å†…å¹¿æ’­æ¥æ”¶å™¨localBroadcastManager.unregisterReceiver(mBroadcastReceiver);Intent intent = new Intent();intent.setAction(BROADCAST_ACTION);intent.putExtra(\"name\", \"qqyumidi\");//sendBroadcast(intent);//å‘é€åº”ç”¨å†…å¹¿æ’­localBroadcastManager.sendBroadcast(intent); 4. ä¸åŒæ³¨å†Œæ–¹å¼çš„å¹¿æ’­æ¥æ”¶å™¨å›è°ƒonReceive(context, intent)ä¸­çš„contextå…·ä½“ç±»å‹ 1). å¯¹äºé™æ€æ³¨å†Œçš„ContextReceiverï¼Œå›è°ƒonReceive(context, intent)ä¸­çš„contextå…·ä½“æŒ‡çš„æ˜¯ReceiverRestrictedContextï¼› 2). å¯¹äºå…¨å±€å¹¿æ’­çš„åŠ¨æ€æ³¨å†Œçš„ContextReceiverï¼Œå›è°ƒonReceive(context, intent)ä¸­çš„contextå…·ä½“æŒ‡çš„æ˜¯Activity Contextï¼› 3). å¯¹äºé€šè¿‡LocalBroadcastManageråŠ¨æ€æ³¨å†Œçš„ContextReceiverï¼Œå›è°ƒonReceive(context, intent)ä¸­çš„contextå…·ä½“æŒ‡çš„æ˜¯Application Contextã€‚ æ³¨ï¼šå¯¹äºLocalBroadcastManageræ–¹å¼å‘é€çš„åº”ç”¨å†…å¹¿æ’­ï¼Œåªèƒ½é€šè¿‡LocalBroadcastManageråŠ¨æ€æ³¨å†Œçš„ContextReceiveræ‰æœ‰å¯èƒ½æ¥æ”¶åˆ°ï¼ˆé™æ€æ³¨å†Œæˆ–å…¶ä»–æ–¹å¼åŠ¨æ€æ³¨å†Œçš„ContextReceiveræ˜¯æ¥æ”¶ä¸åˆ°çš„ï¼‰ã€‚ 5. ä¸åŒAndroid APIç‰ˆæœ¬ä¸­å¹¿æ’­æœºåˆ¶ç›¸å…³APIé‡è¦å˜è¿1). Android5.0/API level 21å¼€å§‹ç²˜æ»å¹¿æ’­å’Œæœ‰åºç²˜æ»å¹¿æ’­è¿‡æœŸï¼Œä»¥åä¸å†å»ºè®®ä½¿ç”¨ï¼› 2). â€é™æ€æ³¨å†Œçš„å¹¿æ’­æ¥æ”¶å™¨å³ä½¿appå·²ç»é€€å‡ºï¼Œä¸»è¦æœ‰ç›¸åº”çš„å¹¿æ’­å‘å‡ºï¼Œä¾ç„¶å¯ä»¥æ¥æ”¶åˆ°ï¼Œä½†æ­¤ç§æè¿°è‡ªAndroid 3.1å¼€å§‹æœ‰å¯èƒ½ä¸å†æˆç«‹â€œ Android 3.1å¼€å§‹ç³»ç»Ÿåœ¨Intentä¸å¹¿æ’­ç›¸å…³çš„flagå¢åŠ äº†å‚æ•°ï¼Œåˆ†åˆ«æ˜¯FLAG_INCLUDE_STOPPED_PACKAGESå’ŒFLAG_EXCLUDE_STOPPED_PACKAGESã€‚ FLAG_INCLUDE_STOPPED_PACKAGESï¼šåŒ…å«å·²ç»åœæ­¢çš„åŒ…ï¼ˆåœæ­¢ï¼šå³åŒ…æ‰€åœ¨çš„è¿›ç¨‹å·²ç»é€€å‡ºï¼‰ FLAG_EXCLUDE_STOPPED_PACKAGESï¼šä¸åŒ…å«å·²ç»åœæ­¢çš„åŒ… ä¸»è¦åŸå› å¦‚ä¸‹ï¼š è‡ªAndroid3.1å¼€å§‹ï¼Œç³»ç»Ÿæœ¬èº«åˆ™å¢åŠ äº†å¯¹æ‰€æœ‰appå½“å‰æ˜¯å¦å¤„äºè¿è¡ŒçŠ¶æ€çš„è·Ÿè¸ªã€‚åœ¨å‘é€å¹¿æ’­æ—¶ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆå¹¿æ’­ç±»å‹ï¼Œç³»ç»Ÿé»˜è®¤ç›´æ¥å¢åŠ äº†å€¼ä¸ºFLAG_EXCLUDE_STOPPED_PACKAGESçš„flagï¼Œå¯¼è‡´å³ä½¿æ˜¯é™æ€æ³¨å†Œçš„å¹¿æ’­æ¥æ”¶å™¨ï¼Œå¯¹äºå…¶æ‰€åœ¨è¿›ç¨‹å·²ç»é€€å‡ºçš„appï¼ŒåŒæ ·æ— æ³•æ¥æ”¶åˆ°å¹¿æ’­ã€‚ è¯¦æƒ…å‚åŠ Androidå®˜æ–¹æ–‡æ¡£ï¼šhttp://developer.android.com/about/versions/android-3.1.html#launchcontrols ç”±æ­¤ï¼Œå¯¹äºç³»ç»Ÿå¹¿æ’­ï¼Œç”±äºæ˜¯ç³»ç»Ÿå†…éƒ¨ç›´æ¥å‘å‡ºï¼Œæ— æ³•æ›´æ”¹æ­¤intent flagå€¼ï¼Œå› æ­¤ï¼Œ3.1å¼€å§‹å¯¹äºé™æ€æ³¨å†Œçš„æ¥æ”¶ç³»ç»Ÿå¹¿æ’­çš„BroadcastReceiverï¼Œå¦‚æœAppè¿›ç¨‹å·²ç»é€€å‡ºï¼Œå°†ä¸èƒ½æ¥æ”¶åˆ°å¹¿æ’­ã€‚ ä½†æ˜¯å¯¹äºè‡ªå®šä¹‰çš„å¹¿æ’­ï¼Œå¯ä»¥é€šè¿‡å¤å†™æ­¤flagä¸ºFLAG_INCLUDE_STOPPED_PACKAGESï¼Œä½¿å¾—é™æ€æ³¨å†Œçš„BroadcastReceiverï¼Œå³ä½¿æ‰€åœ¨Appè¿›ç¨‹å·²ç»é€€å‡ºï¼Œä¹Ÿèƒ½èƒ½æ¥æ”¶åˆ°å¹¿æ’­ï¼Œå¹¶ä¼šå¯åŠ¨åº”ç”¨è¿›ç¨‹ï¼Œä½†æ­¤æ—¶çš„BroadcastReceiveræ˜¯é‡æ–°æ–°å»ºçš„ã€‚ 12345Intent intent = new Intent();intent.setAction(BROADCAST_ACTION);intent.addFlags(Intent.FLAG_INCLUDE_STOPPED_PACKAGES);intent.putExtra(\"name\", \"qqyumidi\");sendBroadcast(intent); æ³¨1ï¼šå¯¹äºåŠ¨æ€æ³¨å†Œç±»å‹çš„BroadcastReceiverï¼Œç”±äºæ­¤æ³¨å†Œå’Œå–æ¶ˆæ³¨å†Œå®åœ¨å…¶ä»–ç»„ä»¶ï¼ˆå¦‚Activityï¼‰ä¸­è¿›è¡Œï¼Œå› æ­¤ï¼Œä¸å—æ­¤æ”¹å˜å½±å“ã€‚ æ³¨2ï¼šåœ¨3.1ä»¥å‰ï¼Œç›¸ä¿¡ä¸å°‘appå¯èƒ½é€šè¿‡é™æ€æ³¨å†Œæ–¹å¼ç›‘å¬å„ç§ç³»ç»Ÿå¹¿æ’­ï¼Œä»¥æ­¤è¿›è¡Œä¸€äº›ä¸šåŠ¡ä¸Šçš„å¤„ç†ï¼ˆå¦‚å³æ—¶appå·²ç»é€€å‡ºï¼Œä»ç„¶èƒ½æ¥æ”¶åˆ°ï¼Œå¯ä»¥å¯åŠ¨serviceç­‰..ï¼‰,3.1åï¼Œé™æ€æ³¨å†Œæ¥å—å¹¿æ’­æ–¹å¼çš„æ”¹å˜ï¼Œå°†ç›´æ¥å¯¼è‡´æ­¤ç±»æ–¹æ¡ˆä¸å†å¯è¡Œã€‚äºæ˜¯ï¼Œé€šè¿‡å°†Serviceä¸Appæœ¬èº«è®¾ç½®æˆä¸åŒçš„è¿›ç¨‹å·²ç»æˆä¸ºå®ç°æ­¤ç±»éœ€æ±‚çš„å¯è¡Œæ›¿ä»£æ–¹æ¡ˆã€‚","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Broadcast","slug":"Broadcast","permalink":"http://github.com/tags/Broadcast/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"è°·æ­Œæ•´ä½“æˆ˜ç•¥ï¼šå…³äºäººå·¥æ™ºèƒ½ã€äº‘æœåŠ¡å’Œç™»æœˆè®¡åˆ’çš„æœªæ¥","slug":"è°·æ­Œæ•´ä½“æˆ˜ç•¥ï¼šå…³äºäººå·¥æ™ºèƒ½ã€äº‘æœåŠ¡å’Œç™»æœˆè®¡åˆ’çš„æœªæ¥","date":"2016-10-21T07:43:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/10/21/è°·æ­Œæ•´ä½“æˆ˜ç•¥ï¼šå…³äºäººå·¥æ™ºèƒ½ã€äº‘æœåŠ¡å’Œç™»æœˆè®¡åˆ’çš„æœªæ¥/","link":"","permalink":"http://github.com/2016/10/21/è°·æ­Œæ•´ä½“æˆ˜ç•¥ï¼šå…³äºäººå·¥æ™ºèƒ½ã€äº‘æœåŠ¡å’Œç™»æœˆè®¡åˆ’çš„æœªæ¥/","excerpt":"CB Insights ä»Šæ—¥å‘å¸ƒäº†ä¸€ç¯‡å…³äºè°·æ­Œä¸šåŠ¡æˆ˜ç•¥çš„æ·±åº¦åˆ†ææŠ¥å‘Š: Google Strategy Teardown: Betting The Future On AI, Cloud Services, And (Tamed) Moonshotsï¼Œç›˜ç‚¹äº†è°·æ­Œåœ¨äººå·¥æ™ºèƒ½ã€äº‘æœåŠ¡ã€è™šæ‹Ÿç°å®/å¢å¼ºç°å®ã€ç”µä¿¡ä¸èƒ½æºã€è¿è¾“ä¸ç‰©æµã€ç¡¬ä»¶å’ŒæœåŠ¡å¹³å°ç­‰ä¼—å¤šé¢†åŸŸçš„ä¸šåŠ¡å’Œæˆ˜ç•¥ã€‚å…¶ä¸­äººå·¥æ™ºèƒ½æ˜¯è´¯ç©¿è°·æ­Œæ‰€æœ‰æ–¹é¢çš„åˆ›æ–°çš„çº¿ç´¢ã€‚ è‡ª 1998 å¹´è°·æ­Œåœ¨åŠ åˆ©ç¦å°¼äºšå·é—¨æ´›å¸•å…‹çš„ä¸€é—´è½¦åº“å˜æˆä¸€å®¶å…¬å¸ä»¥æ¥ï¼Œå®ƒå·²ç»å‘å±•æˆä¸ºäº†å .com æ—¶ä»£ä¼ä¸šåˆ›æ–°çš„ç«ç‚¬æ‰‹ã€‚è°·æ­Œå¯¹é•¿è¿œåˆ›æ–°çš„äº²çä½“ç°åœ¨å¤šä¸ªæ–¹é¢â€”â€”ä»å…¶å¹¿ä¸ºäººçŸ¥çš„å‘˜å·¥å¯ç”¨äºä¸ªäººé¡¹ç›®çš„ã€Œ20% ä¸ªäººæ—¶é—´ã€æ”¿ç­–ï¼ˆè¿™ä¸ªæ”¿ç­–å¯¼è‡´äº† Gmail å’Œ AdSense çš„è¯ç”Ÿï¼‰ï¼Œåˆ°å…¶åœ¨ 2009 å¹´æˆç«‹çš„å‡†ç‹¬ç«‹çš„é£é™©èµ„æœ¬éƒ¨åˆ† Google Venturesï¼Œå†åˆ°å…¶é¢å‘æœªæ¥åˆ›æ–°çš„ã€Œç™»æœˆè®¡åˆ’ã€çš„ Google X åˆ›æ–°å®éªŒå®¤ï¼ˆå·²æ”¹ç§° Xï¼‰ã€‚ ä½†æ˜¯ï¼Œè¿‘äº›å¹´æ¥ï¼Œè¯¥å…¬å¸å·²ç»å¼€å§‹è½¬å˜å…¶å®éªŒæ€§çš„æ–¹æ³•ã€æœ‰é£é™©çš„ç ”å‘å’Œåˆ†æ•£å¼çš„å…¬å¸ç»“æ„äº†ã€‚ åœ¨ 2011 å¹´æ‰§æŒè°·æ­Œåï¼ŒCEO Larry Pageï¼ˆç°ä¸º Alphabet çš„é¢†å¯¼è€…ï¼‰å°±å®£å¸ƒè°·æ­Œå°†åœ¨ã€Œæ›´å°‘çš„ç®­å¤´åæ”¾æ›´å¤šæœ¨æã€ï¼Œè¦å‘æ›´é‡è¦çš„æ–¹å‘æŠ•å…¥æ›´å¤šèµ„æºï¼šä»æ°‘ä¸»åŒ–çš„è‡ªä¸‹è€Œä¸Šçš„åˆ›æ–°æ–¹æ³•å˜æˆæ›´ä¸ºè‡ªä¸Šè€Œä¸‹çš„é‡ç‚¹å¼æˆ˜ç•¥ã€‚ å®é™…ä¸Šï¼Œæ®æŠ¥é“ã€Œ20% ä¸ªäººæ—¶é—´ã€æ”¿ç­–åœ¨è¿‘äº›å¹´æ¥å·²ç»å—åˆ°äº†é™åˆ¶ï¼Œéœ€è¦æ›´å¤šçš„ç®¡ç†æ‰¹å‡†å’Œç›‘ç£ã€‚ ä¸æ­¤åŒæ—¶ï¼Œè°·æ­Œå·²ç»ä»æ ¸å¿ƒçš„æœç´¢å’Œå¹¿å‘Šä¸šåŠ¡æ‰©å±•åˆ°äº†æ›´ä¸ºå¹¿é˜”çš„ä¸šåŠ¡é¢†åŸŸï¼Œå…¶æ¶µç›–äº†ä»æ¶ˆè´¹ç¡¬ä»¶åˆ°æ±½è½¦åˆ°ç”µä¿¡åˆ°åŒ»ç–—åˆ°é£é™©æŠ•èµ„ç­‰ä¼—å¤šé¢†åŸŸã€‚","text":"CB Insights ä»Šæ—¥å‘å¸ƒäº†ä¸€ç¯‡å…³äºè°·æ­Œä¸šåŠ¡æˆ˜ç•¥çš„æ·±åº¦åˆ†ææŠ¥å‘Š: Google Strategy Teardown: Betting The Future On AI, Cloud Services, And (Tamed) Moonshotsï¼Œç›˜ç‚¹äº†è°·æ­Œåœ¨äººå·¥æ™ºèƒ½ã€äº‘æœåŠ¡ã€è™šæ‹Ÿç°å®/å¢å¼ºç°å®ã€ç”µä¿¡ä¸èƒ½æºã€è¿è¾“ä¸ç‰©æµã€ç¡¬ä»¶å’ŒæœåŠ¡å¹³å°ç­‰ä¼—å¤šé¢†åŸŸçš„ä¸šåŠ¡å’Œæˆ˜ç•¥ã€‚å…¶ä¸­äººå·¥æ™ºèƒ½æ˜¯è´¯ç©¿è°·æ­Œæ‰€æœ‰æ–¹é¢çš„åˆ›æ–°çš„çº¿ç´¢ã€‚ è‡ª 1998 å¹´è°·æ­Œåœ¨åŠ åˆ©ç¦å°¼äºšå·é—¨æ´›å¸•å…‹çš„ä¸€é—´è½¦åº“å˜æˆä¸€å®¶å…¬å¸ä»¥æ¥ï¼Œå®ƒå·²ç»å‘å±•æˆä¸ºäº†å .com æ—¶ä»£ä¼ä¸šåˆ›æ–°çš„ç«ç‚¬æ‰‹ã€‚è°·æ­Œå¯¹é•¿è¿œåˆ›æ–°çš„äº²çä½“ç°åœ¨å¤šä¸ªæ–¹é¢â€”â€”ä»å…¶å¹¿ä¸ºäººçŸ¥çš„å‘˜å·¥å¯ç”¨äºä¸ªäººé¡¹ç›®çš„ã€Œ20% ä¸ªäººæ—¶é—´ã€æ”¿ç­–ï¼ˆè¿™ä¸ªæ”¿ç­–å¯¼è‡´äº† Gmail å’Œ AdSense çš„è¯ç”Ÿï¼‰ï¼Œåˆ°å…¶åœ¨ 2009 å¹´æˆç«‹çš„å‡†ç‹¬ç«‹çš„é£é™©èµ„æœ¬éƒ¨åˆ† Google Venturesï¼Œå†åˆ°å…¶é¢å‘æœªæ¥åˆ›æ–°çš„ã€Œç™»æœˆè®¡åˆ’ã€çš„ Google X åˆ›æ–°å®éªŒå®¤ï¼ˆå·²æ”¹ç§° Xï¼‰ã€‚ ä½†æ˜¯ï¼Œè¿‘äº›å¹´æ¥ï¼Œè¯¥å…¬å¸å·²ç»å¼€å§‹è½¬å˜å…¶å®éªŒæ€§çš„æ–¹æ³•ã€æœ‰é£é™©çš„ç ”å‘å’Œåˆ†æ•£å¼çš„å…¬å¸ç»“æ„äº†ã€‚ åœ¨ 2011 å¹´æ‰§æŒè°·æ­Œåï¼ŒCEO Larry Pageï¼ˆç°ä¸º Alphabet çš„é¢†å¯¼è€…ï¼‰å°±å®£å¸ƒè°·æ­Œå°†åœ¨ã€Œæ›´å°‘çš„ç®­å¤´åæ”¾æ›´å¤šæœ¨æã€ï¼Œè¦å‘æ›´é‡è¦çš„æ–¹å‘æŠ•å…¥æ›´å¤šèµ„æºï¼šä»æ°‘ä¸»åŒ–çš„è‡ªä¸‹è€Œä¸Šçš„åˆ›æ–°æ–¹æ³•å˜æˆæ›´ä¸ºè‡ªä¸Šè€Œä¸‹çš„é‡ç‚¹å¼æˆ˜ç•¥ã€‚ å®é™…ä¸Šï¼Œæ®æŠ¥é“ã€Œ20% ä¸ªäººæ—¶é—´ã€æ”¿ç­–åœ¨è¿‘äº›å¹´æ¥å·²ç»å—åˆ°äº†é™åˆ¶ï¼Œéœ€è¦æ›´å¤šçš„ç®¡ç†æ‰¹å‡†å’Œç›‘ç£ã€‚ ä¸æ­¤åŒæ—¶ï¼Œè°·æ­Œå·²ç»ä»æ ¸å¿ƒçš„æœç´¢å’Œå¹¿å‘Šä¸šåŠ¡æ‰©å±•åˆ°äº†æ›´ä¸ºå¹¿é˜”çš„ä¸šåŠ¡é¢†åŸŸï¼Œå…¶æ¶µç›–äº†ä»æ¶ˆè´¹ç¡¬ä»¶åˆ°æ±½è½¦åˆ°ç”µä¿¡åˆ°åŒ»ç–—åˆ°é£é™©æŠ•èµ„ç­‰ä¼—å¤šé¢†åŸŸã€‚ å»å¹´åæœˆä»½çš„ Alphabet ç»„ç»‡æ¶æ„é‡ç»„å°±æ˜¯ä¸ºäº†è¿™ä¸ªåºå¤§çš„è§„åˆ’ç½‘å¼•å…¥æ›´å¤§çš„ç»“æ„ã€é€æ˜åº¦å’Œè´¢æ”¿è´£ä»»ã€‚ä¸ºäº†åŒæ ·çš„ç›®çš„ï¼Œè¯¥å…¬å¸è¿˜åœ¨ä»Šå¹´ä¸ƒæœˆä»½è˜è¯·äº†æ‘©æ ¹å£«ä¸¹åˆ©åœ¨è´¢åŠ¡çºªå¾‹ï¼ˆfinancial disciplineï¼‰äº«æœ‰ç››åçš„èµ„æ·±é«˜ç®¡ Ruth Porat ä½œä¸ºé¦–å¸­è´¢åŠ¡å®˜ã€‚ ä¸€å¹´æ¥ï¼Œè¿™äº›ä¸¾æªå·²ç»ç»™å±±æ™¯åŸåº”å¯¹æ”¶è´­å’Œç ”å‘çš„æ–¹æ³•å¸¦æ¥äº†æ˜æ˜¾çš„æ”¹å˜ã€‚æ–°çš„è‚¡æƒæ¿€åŠ±å°†ä¼šå°†å‘˜å·¥çš„å¥–åŠ±å’Œä¸ªäººå•ä½ç»©æ•ˆæŒ‚é’©ã€‚åœ¨ X å®éªŒå®¤ï¼Œè´Ÿè´£äºº Astro Teller æ›¾å†™äº†éœ€è¦æ¨è¿›ç™»æœˆé¡¹ç›®ã€Œæ¯•ä¸šã€â€”â€”ã€Œæ¯•ä¸šã€æ˜¯æŒ‡é¡¹ç›®æœ€ç»ˆæˆé•¿ä¸º Alphabet ä¼ä¸šå®¶æ—ä¸­å¯æ‰©å±•çš„å›¢é˜Ÿå’Œäº§å“ã€‚ä»¥ GV ä¸ºä¾‹ï¼Œè¯¥æŠ•èµ„éƒ¨é—¨å·²ç»å¾ˆé•¿æ—¶é—´æ²¡æœ‰é¢†å¯¼äº†ï¼Œå…¶è§„æ¨¡ä»¥åŠå°¤å…¶çš„ç§å­äº¤æ˜“æˆªè‡³ä»Šå¹´ç›®å‰ä¸ºæ­¢å·²ç»ç¼©å‡äº†ã€‚ ç”±äºè¯¥å…¬å¸å¹…å‘˜è¾½é˜”ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† CB Insights ç§‘æŠ€å¸‚åœºæ™ºèƒ½å¹³å°ä¸­çš„è®¸å¤šå·¥å…·æ¥æç‚¼ Alphabet ç»„ç»‡èŒƒå›´å†…å„ä¸ªå•ä½çš„æ”¶è´­ã€æŠ•èµ„å’Œç ”ç©¶/ä¸“åˆ©æ´»åŠ¨ï¼Œä»è€Œè·å¾—äº†ä¸€ä¸ªå…³äºå…¶æœªæ¥æˆ˜ç•¥çš„æ•°æ®é©±åŠ¨çš„è§†è§’ã€‚é‰´äºè¯¥å…¬å¸è¿è¥èŒƒå›´çš„è¾½é˜”ï¼Œæˆ‘ä»¬ä¸ä¼šè§¦åŠæ¯ä¸€é¡¹è®¡åˆ’å’Œéƒ¨é—¨ï¼Œè€Œåªå…³æ³¨æ¨åŠ¨è°·æ­Œç³»å‘å‰çš„ä¸»è¦å’Œåå¤å‡ºç°çš„ä¸»é¢˜ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š æ¨è¿›äº‘å’Œç¡¬ä»¶ï¼šAlphabet æ¨åŠ¨å¢é•¿çš„é¢†åŸŸå·²ç»ä¸å†é™äºå¹¿å‘Šäº†ï¼Œä¹Ÿåœ¨ç ”å‘ã€æ”¶è´­å’ŒæŠ•èµ„æœ‰å¯èƒ½å®ç°æ”¶å…¥å’Œå¸¦æ¥åˆ©æ¶¦çš„ä¸šåŠ¡å’Œé¢†åŸŸï¼Œä¾‹å¦‚é«˜çº§ç§»åŠ¨å’Œæ™ºèƒ½å®¶å±…ç¡¬ä»¶ï¼Œå°¤å…¶æ˜¯äº‘å’Œä¼ä¸šæœåŠ¡ã€‚æ¯”å¦‚è°·æ­Œåœ¨ Nest ä¹‹åæœ€å¤§çš„æ”¶è´­ Apigee å°±æ˜¯ä¸€å®¶å·²ç»ä¸Šå¸‚çš„ä¼ä¸šäº‘å…¬å¸ã€‚ äººå·¥æ™ºèƒ½ä¼˜å…ˆï¼ˆAI-firstï¼‰æˆ˜ç•¥ï¼šè¯¥å…¬å¸æ­£åœ¨åˆ©ç”¨å…¶äººå·¥æ™ºèƒ½/æœºå™¨å­¦ä¹ çš„ä¸“å®¶äººæ‰ï¼ˆåŒ…æ‹¬é‚£äº›é€šè¿‡ DeepMind æ”¶è´­å¸çº³è¿›æ¥çš„ï¼‰æ¥å·®å¼‚åŒ–è‡ªå·±åœ¨ä¸Šè¿°éƒ¨é—¨ä»¥åŠæœç´¢å’Œå¹¿å‘Šã€æ•´ä¸ªé¢å‘æ¶ˆè´¹è€…çš„ç½‘é¡µæœåŠ¡å’Œå…¶å®ƒ Alphabet å•ä½çš„äº§å“ã€‚è°·æ­Œæ–°æ¬¾çš„é«˜ç«¯ç§»åŠ¨å’Œæ™ºèƒ½å®¶å±…è®¾å¤‡å°±æ˜¯æä¾›ä¸€äº›äººå·¥æ™ºèƒ½æœåŠ¡çš„æ¸ é“ã€‚ å…³æ³¨å¢å¼ºç°å®/è™šæ‹Ÿç°å®ã€è‡ªåŠ¨é©¾é©¶å’Œæ•°å­—åŒ»ç–—ï¼šæŠ•èµ„ã€æ”¶è´­å’Œå±±æ™¯åŸçš„ä¸“åˆ©æ•°æ®èŒƒå›´åŒ…æ‹¬è‡ªåŠ¨é©¾é©¶ã€å¯ç©¿æˆ´ã€äººå·¥æ™ºèƒ½é©±åŠ¨çš„åŒ»ç–—å’Œä¸ºå…¨çƒæ›´å¤§èŒƒå›´çš„äººå£æä¾›ç½‘ç»œæ¥å…¥ã€‚ æ”¶è´­å†æ¬¡å›å‡ï¼šè¯¥å…¬å¸åœ¨ 2016 å¹´ç¬¬ 3 å­£åº¦è¿›è¡Œäº† 9 æ¬¡æ”¶è´­ï¼Œæ˜¯è‡ª 2014 å¹´ç¬¬ 3 å­£åº¦ä»¥æ¥æœ€å¤šçš„ã€‚è¿™è¯´æ˜äº†è¯¥å…¬å¸çš„å…¼å¹¶æ”¶è´­ï¼ˆM&amp;Aï¼‰æ„æ„¿çš„å¤å…´ï¼Œå› ä¸ºå…¶å·²ç»è¡¨ç°å‡ºäº†è¿›ä¸€æ­¥æ‹“å±•ç§»åŠ¨ç¡¬ä»¶ï¼ˆåŒ…æ‹¬ Pixel æ‰‹æœºå’Œæ™ºèƒ½å®¶å±…ä¸­æ¢ï¼‰ã€ä¼ä¸šäº‘æœåŠ¡ã€äº¤é€š/ç‰©æµã€è™šæ‹Ÿç°å®ç­‰é¢†åŸŸçš„æ‰“ç®—ã€‚ GV å·²ç»å¤§å¤§é€€å‡ºäº†ç§å­å¸‚åœºï¼šGV å·²ç»åŸºæœ¬ä¸Šä¸å†æŠ•èµ„å¹´è½»çš„åˆ›ä¸šå…¬å¸äº†ã€‚å…¶ç§å­æŠ•èµ„ä¸Šçš„è¡Œä¸ºå·²ç»è¾ƒå»å¹´åŒæœŸä¸‹é™äº† 85%ï¼Œåœ¨ 2016 å¹´ä¸ŠåŠå¹´å®Œå…¨æ²¡æœ‰ä»»ä½•æ–°çš„ç§å­äº¤æ˜“ã€‚ è§„èŒƒå…¶å®ƒç™»æœˆé¡¹ç›®ï¼šæ§åˆ¶å¼€æ”¯å’Œå¼ºè¿«ç™»æœˆé¡¹ç›®æ¦‚åˆ’ç›ˆåˆ©çš„é€”å¾„ã€‚è¿™è®©è¯¥å…¬å¸å¯ç”¨äº†èµ„æ·±äººå£«å’Œé‡ç»„äº†å›¢é˜Ÿä»¥å®ç°ä¸šåŠ¡åŒ–ï¼Œå¦å¤–è¿˜æ‹›å‹Ÿäº†ä¸€äº›å¤–éƒ¨è¡Œä¸šèµ„æ·±äººå£«æ¥æ¨åŠ¨ Loon å’Œè‡ªåŠ¨æ±½è½¦é¡¹ç›®çš„å•†ä¸šåŒ–ã€‚ ç›®å½• è°·æ­Œæ ¸å¿ƒçš„ä¸€äº›èƒŒæ™¯ æ”¶è´­ æŠ•èµ„ è°·æ­Œ GV è°·æ­Œèµ„æœ¬ ä¸“åˆ©æ•°æ®åˆ†æ æŒ‰é¢†åŸŸåˆ’åˆ†çš„ Alphabet è®¡åˆ’ äººå·¥æ™ºèƒ½ äº‘ä¸ä¼ä¸š æ¶ˆè´¹ç¡¬ä»¶å’Œå¹³å° å¢å¼ºç°å®/è™šæ‹Ÿç°å® ç”µä¿¡ä¸èƒ½æº äº¤é€šä¸ç‰©æµ åŒ»ç–—ä¿å¥å’Œæ•°å­—å¥åº· é‡‘èç§‘æŠ€ ç»“è¯­ è°·æ­Œæ ¸å¿ƒçš„ä¸€äº›èƒŒæ™¯åœ¨æˆ‘ä»¬æ·±å…¥åˆ° Alphabet æœªæ¥æˆ˜ç•¥èƒŒåçš„æ•°æ®ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å¿«é€Ÿäº†è§£å…¶ç›®å‰æœ€æˆç†Ÿå’Œæœ€ç›ˆåˆ©çš„ä¸šåŠ¡çº¿ï¼šè°·æ­Œæœç´¢å’Œå¹¿å‘Šã€‚ æé†’ä¸€ä¸‹ï¼Œç°åœ¨çš„è°·æ­ŒåŒ…å«æœç´¢ã€åœ°å›¾ã€äº‘å’Œä¼ä¸šã€è°·æ­Œå“ç‰Œçš„ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿï¼ˆChromeã€å®‰å“ç­‰ï¼‰å’Œ YouTubeã€‚å…¶å®ƒæ‰€æœ‰å•ä½ï¼ˆä»æŠ•èµ„éƒ¨é—¨ï¼ˆGVã€Google Capitalï¼‰åˆ° X éƒ¨é—¨ï¼‰ç°åœ¨éƒ½ç›´æ¥éš¶å±äº Alphabetã€‚ä½†æˆ‘ä»¬å°†ç»Ÿä¸€ä½¿ç”¨ã€Œè°·æ­Œã€è¿›è¡ŒæŒ‡ä»£ï¼Œä¸ç®¡å®ƒç°åœ¨ç¡®å®å±äºè°·æ­Œè¿˜æ˜¯åœ¨ Alphabet ä¹‹å‰å±äºè°·æ­Œã€‚ 2016 å¹´ç¬¬ 2 å­£åº¦ï¼Œè¯¥å…¬å¸çš„æ€»æ”¶å…¥ï¼ˆtop-lineï¼‰å’Œå‡€æ”¶å…¥ï¼ˆbottom-lineï¼‰å¢é•¿è¶…å‡ºäº†åˆ†æé¢„æœŸã€‚ä¸»è¦åœ¨è°·æ­Œçš„æ ¸å¿ƒå¹¿å‘Šä¸šåŠ¡çš„æ¨åŠ¨ä¸‹ï¼ŒAlphabet çš„å­£åº¦æ”¶å…¥è·ƒå‡äº† 21%ï¼Œå¢é•¿è‡³ 215 äº¿ç¾å…ƒï¼Œåˆ©æ¶¦åˆ™å¢é•¿äº† 24%ï¼Œè¶…å‡ºäº†å¸‚åœºé¢„ä¼°ã€‚è¿™ç§å¼ºåŠ²çš„åŠ¿å¤´çš„æ¨åŠ¨åŠ›æ¥è‡ªå‘ç§»åŠ¨å¹³å°çš„æˆåŠŸè¿‡æ¸¡ï¼Œå…¶ä¸­åŒ…æ‹¬æ–°çš„ç§»åŠ¨å¹¿å‘Šæ ¼å¼å’Œæ›´å¥½çš„æ•ˆæœè¯„ä¼°ã€‚ å°½ç®¡ä¸Šä¸ªå­£åº¦çš„ç»“æœå¤§éƒ¨åˆ†æ˜¯ç§¯æçš„ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›å¯èƒ½ä¼šå½±å“é•¿æœŸå‰æ™¯çš„è¶‹åŠ¿ã€‚é¦–å…ˆï¼Œè°·æ­Œå¹¿å‘Šä¸šåŠ¡çš„æ”¶å…¥ä¸­æ¥è‡ªå…¶è‡ªå®¶ç½‘ç«™çš„ä»½é¢åœ¨ 2016 å¹´ç¬¬ 2 å­£åº¦é¦–æ¬¡è¾¾åˆ°äº†å·…å³°çš„ 80%ï¼Œè€Œåœ¨ 2011 å¹´æ—¶è¿™ä¸ªæ¯”ä¾‹æ˜¯ 70%ã€‚è¿™æ„å‘³ç€æœªæ¥çš„å¹¿å‘Šå¢é•¿å°†å‰æ‰€æœªæœ‰åœ°æ›´åŠ ä¾èµ–äºè°·æ­Œå‘å…¶è‡ªå·±ç½‘ç«™ï¼ˆä¾‹å¦‚æœç´¢ç»“æœå’Œè°·æ­Œæ–°é—»ç­‰ç­‰ï¼‰çš„æµé‡å¼•å¯¼ï¼Œè€Œä¸æ˜¯å‘ç½‘ç»œæˆå‘˜çš„ç½‘ç«™ã€‚ ç§»åŠ¨å¹¿å‘Šé€šå¸¸æ¯”æ¡Œé¢å¹¿å‘Šçš„åˆ©æ¶¦ä½ï¼Œæ‰€ä»¥è°·æ­Œçš„æˆåŠŸæ˜¯åœ¨æ¯æ¬¡ç‚¹å‡»çš„æ”¶å…¥ï¼ˆCPCï¼Œå½“æ¶ˆè´¹è€…ç‚¹å‡»å¹¿å‘Šå•†çš„å¹¿å‘Šæ—¶ï¼Œå¹¿å‘Šå•†å‘è°·æ­Œçš„å¹³å‡ä»˜è´¹ï¼‰æ›´ä½çš„æƒ…å†µä¸‹å®ç°çš„ï¼Œå…¶å·¨å¤§çš„å¢é‡æŠµæ¶ˆä¸€äº›è¿™ç§æƒ…å†µçš„å½±å“ã€‚2016 å¹´ç¬¬ 2 å­£åº¦åœ¨è‡ªå®¶ç½‘ç«™çš„ CPC ä»…æœ‰ä¸¤å¹´å‰è‡ªå®¶ç½‘ç«™çš„ CPC çš„ 76%ã€‚ åº”ç”¨ç¨‹åºå’Œè¿æ¥è®¾å¤‡æ•°é‡çš„æ¿€å¢ä¹Ÿå¸¦æ¥äº†æŒ‘æˆ˜ï¼Œå› ä¸ºåœ¨ Facebook å’Œå¾®ä¿¡ç­‰åº”ç”¨ç¨‹åºå ç”¨å¤§é‡ç”¨æˆ·åœ¨çº¿æ—¶é—´ï¼Œä»¥åŠæ–°ä¸€ä»£è®¾å¤‡ï¼ˆå¦‚æ™ºèƒ½å®¶å±…ä¸­å¿ƒï¼‰å¯¼æµæœç´¢æµé‡æˆä¸ºæ½œåœ¨ç«äº‰å¯¹æ‰‹çš„æƒ…å†µä¸‹ï¼Œè¿˜ä¸æ¸…æ¥šè°·æ­Œçš„æœç´¢å¼•æ“æ˜¯å¦ä¼šç»§ç»­å é¢†ä¸»å¯¼åœ°ä½ï¼ˆä¾‹å¦‚é€šè¿‡äºšé©¬é€Šçš„ Echo æ™ºèƒ½å®¶å±…è®¾å¤‡å’Œå…¶ Alexa è¯­éŸ³åŠ©æ‰‹ç›´æ¥è¿›è¡Œçš„æœç´¢ï¼‰ã€‚ äº‹å®ä¸Šï¼Œè°·æ­Œåœ¨å…¨çƒæ•°å­—å¹¿å‘Šæ”¯å‡ºä¸­æ‰€å çš„ä»½é¢æŒç»­ä¸‹é™ï¼Œå› ä¸ºåƒ Facebook è¿™æ ·çš„å›½å†…ç«äº‰å¯¹æ‰‹ä»¥åŠç™¾åº¦å’Œé˜¿é‡Œå·´å·´ç­‰å›½é™…ç«äº‰å¯¹æ‰‹éƒ½åœ¨æŒç»­å¢åŠ å¸‚åœºä»½é¢ã€‚ è°·æ­Œçš„å¹¿å‘Šä¸šåŠ¡ä½¿å…¬å¸é•¿æœŸä»¥æ¥ä¸€ç›´ä¿æŒç¨³å®šï¼ŒåŒæ—¶å®ƒçš„è´¢åŠ¡æ‰‹æ®µä¹Ÿæˆä¸ºå…¶ç™»æœˆè®¡åˆ’ï¼ˆmoonshotï¼‰çš„æ”¯æ’‘ã€‚ç„¶è€Œï¼Œå°½ç®¡ Alphabet çš„ä¸šåŠ¡æ•°é‡åºå¤§ï¼Œå…¶è´¢åŠ¡ä¸šç»©å’Œå¢é•¿å‰æ™¯ä»ç„¶ä¸¥é‡ä¾èµ–äºè°·æ­Œçš„åŸæœ‰ä¸šåŠ¡ï¼ˆå¹¿å‘Šå äº† Alphabet 2016 å¹´ç¬¬äºŒå­£åº¦æ”¶å…¥çš„ 89ï¼…ï¼‰ã€‚å…¶æ ¸å¿ƒä¸šåŠ¡çš„å“è¶Šè¡¨ç°åœ¨å…¶å®ƒä¸ç¨³å®šçš„ä¸šåŠ¡ä¸­æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œä½†æ˜¯å±±æ™¯åŸï¼ˆåŠ åˆ©ç¦å°¼äºšå·çš„ä¸€ä¸ªå¿ï¼‰å·²ç»æ•é”åœ°è§‰å¯Ÿåˆ°è°·æ­Œçš„æ”¶å…¥æ¥æºæ˜¯ç¼ºä¹å¤šæ ·æ€§çš„ã€‚å½“æˆ‘ä»¬é€šè¿‡å®ƒçš„å­å…¬å¸æ·±å…¥äº†è§£ Alphabet çš„æ´»åŠ¨æ—¶ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¯»æ‰¾æ–°çš„å¢é•¿é€”å¾„æ˜¯å¦‚ä½•å¡‘é€ äº†è¯¥å…¬å¸çš„æˆ˜ç•¥çš„æ”¶è´­ã€‚ æ”¶è´­ä¼ ç»Ÿè®¤ä¸ºè°·æ­Œæ˜¯æœ€æœ‰æ”¶è´­èƒ½åŠ›çš„ç§‘æŠ€å…¬å¸ä¹‹ä¸€ï¼Œä½†å®ƒçš„æ”¶è´­æ­¥ä¼é€Ÿåº¦æ”¾ç¼“ï¼Œå¹¶å¯¼è‡´äº† Alphabet æ¶æ„ä¸‹çš„æœºæ„é‡ç»„ã€‚ è‡ª 2001 å¹´ä»¥æ¥ï¼Œè¯¥å…¬å¸å·²ç»è¿›è¡Œäº†è¿‘ 200 æ¬¡æ”¶è´­ï¼Œå¼•è¿›å¤–éƒ¨äººæ‰å’Œæ‰©å±•æ–°çš„éƒ¨é—¨ï¼Œå¹¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­åˆ›é€ äº† Larry Page çš„å¦ä¸€å¥ã€Œç‰™åˆ·æµ‹è¯•ï¼ˆtoothbrush testï¼‰ã€æŠ€æœ¯æ ¼è¨€ï¼Œæ¥ç¡®å®šå¹¶è´­ç›®æ ‡æ˜¯å¦å€¼å¾—ã€‚ï¼ˆç›®æ ‡æ˜¯å¿…é¡»å¼€å‘å®¢æˆ·è®¤ä¸ºæ¯å¤©éƒ½ä¸å¯ç¼ºå°‘çš„äº§å“ã€‚ï¼‰ æˆ‘ä»¬çš„æ”¶è´­è·Ÿè¸ªå·¥å…·åŒ…æ‹¬åœ¨å±±æ™¯åŸç¨³å®šçš„æ”¶è´­æµä¸­çš„æ¯ä¸ªæ”¶è´­è®°å½•ã€‚Alphabet ä»Šå¹´è¿„ä»Šï¼ˆ16 å¹´ 10 æœˆ 10 æ—¥ï¼‰å·²ç»æ”¶è´­äº† 13 å®¶å…¬å¸ï¼Œä»…åœ¨ä¸Šä¸ªæœˆå°±è¿›è¡Œäº† 3 æ¬¡æ”¶è´­ï¼Œå…¶ä¸­åŒ…æ‹¬ 6.5 äº¿ç¾å…ƒæ”¶è´­ä¸Šå¸‚äº‘å…¬å¸ Apigeeã€‚æˆ‘ä»¬ä½¿ç”¨ CB Insights Acquirer Analytics å·¥å…·è·Ÿè¸ªè°·æ­Œè‡ª 2010 å¹´ä»¥æ¥çš„å¹¶è´­æ´»åŠ¨ï¼š åœ¨è¿™åå¹´çš„å¤§éƒ¨åˆ†æ—¶é—´é‡Œï¼Œè°·æ­Œä¸€ç›´æ˜¯æŠ€æœ¯å¹¶è´­çš„ä¸»å¯¼åŠ›é‡ï¼›æ´»åŠ¨åœ¨ 2014 å¹´è¾¾åˆ°é¡¶å³°ï¼Œå› ä¸ºè°·æ­Œåœ¨ç¬¬äºŒå­£åº¦æ”¶è´­äº†åå¤šå®¶å…¬å¸ï¼Œè¿œè¿œé¢†å…ˆäºé‚£ä¸€å¹´å…¶å®ƒç§‘æŠ€å·¨å¤´çš„æ”¶è´­è§„æ¨¡ã€‚ç„¶è€Œï¼Œè¯¥å…¬å¸çš„æ”¶è´­æ­¥ä¼å¤§å¹…æ”¾ç¼“ï¼ŒAlphabet é‡ç»„ï¼Œå¹¶åœ¨ 2016 å¹´ä¸ŠåŠå¹´å¤§å¹…ä¸‹é™ã€‚æœ€è¿‘ä¸€ä¸ªå­£åº¦çš„æ”¶è´­æ´»åŠ¨å¢åŠ ï¼Œè™½ç„¶æ˜¯å¦ä¸ºæ˜™èŠ±ä¸€ç°è¿˜æœ‰å¾…è§‚å¯Ÿï¼Œä¹Ÿæˆ–è®¸æ˜¯å±±æ™¯åŸé€‚åº”äº† Alphabet çš„æ–°æ”¶è´­é€Ÿåº¦é‡Šæ”¾çš„ä¿¡å·ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œ2016 å¹´ç¬¬å››å­£åº¦ï¼ŒAlphabet åªæ”¶è´­äº† Famebitï¼Œä¸€ä¸ªå¯ä»¥å¸®åŠ©å•†ä¸šå“ç‰Œä¸ YouTube ä¸Šçš„è§†é¢‘åˆ›ä½œè€…å»ºç«‹è”ç³»çš„å¹³å°ã€‚ é™¤äº†æœ€æ–°çš„è´¢åŠ¡ç´§å¼ é—®é¢˜ï¼Œè¿‘åå¹´æ¥å¤§è§„æ¨¡æ”¶è´­å¸¦æ¥çš„ä½è¿·ç»“æœå¯èƒ½ä¹Ÿä¿ƒä½¿äº†å…¬å¸æ”¶è´­æ´»åŠ¨çš„æš‚åœã€‚è¯¥å…¬å¸å¿«é€Ÿåœ°æ”¶è´­äº†è‡³å°‘ 7 å®¶æœºå™¨äººå…¬å¸â€”â€”Schaft , Industrial Perception , Meka Robotics, Redwood Robotics ,Bot &amp; Dolly , Holomni , ä»¥åŠæœ€è‘—åçš„æ³¢å£«é¡¿åŠ¨åŠ›ï¼ˆBoston Dynamicsï¼‰â€”â€”è§¦å‘äº† 2014 å¹´çš„ç‚’ä½œé«˜å³°ï¼ˆå¦‚è¶‹åŠ¿å›¾æ‰€ç¤ºï¼Œå¦‚ä¸‹ï¼‰ï¼Œä½†è¿™äº›å…¬å¸ä»æ¥æ²¡æœ‰åˆå¹¶æˆä¸ºä¸€ä¸ªé«˜æ•ˆçš„æœºå™¨äººå…¬å¸ã€‚å‰å®‰å“è´Ÿè´£äºº Andy Rubin å¸¦é¢†äº†æœºå™¨äººæµªæ½®ï¼Œä½† Rubin äº 2014 å¹´ 10 æœˆç¦»å¼€å…¬å¸åˆ›åŠå…¨çƒç¡¬ä»¶åˆ›ä¸šå­µåŒ–å™¨ Playground Globalã€‚å¤±å»äº†æœ‰è¿œè§çš„äººç‰©å¯èƒ½ä¼šé˜»ç¢æœºå™¨äººéƒ¨é—¨çš„å‘å±•ï¼Œä¸ç®¡æ˜¯åœ¨è°·æ­Œæˆ–æ˜¯åœ¨ Alphabetï¼Œè¿™ä¸ªåä¸º Replicant çš„æœºå™¨äººéƒ¨é—¨ä»æœªçœŸæ­£åˆå¹¶æˆä¸ºä¸€ä¸ªå®Œæ•´çš„å…¬å¸ã€‚ ç›¸åï¼Œåœ¨ Alphabet åˆ›ç«‹åï¼ŒReplicant ç›´æ¥è¿›å…¥ç®¡ç†å±‚çš„è§†çº¿ï¼Œæ–°å…¬å¸ Alphabet å¯¹å…¶å„å…¬å¸çš„åˆ›æ”¶æ½œåŠ›è¿›è¡Œäº†ä¸¥æ ¼çš„å®¡æŸ¥ã€‚è™½ç„¶åƒæ³¢å£«é¡¿åŠ¨åŠ›å…¬å¸è¿™æ ·çš„å­å…¬å¸åœ¨ YouTube ä¸Šå¤‡å—æ¨å´‡ï¼Œä½†æ˜¯æ¼«é•¿çš„å•†ä¸šåŒ–é“è·¯å¯¼è‡´è¯¥å…¬å¸åœ¨ 2016 å¹´åˆè¢«å‡ºå”®ã€‚æœ€è¿‘ï¼Œè°·æ­Œ 2014 å¹´å¯¹æ™ºèƒ½å®¶å±…çš„é‡è¦æˆ˜ç•¥ç¯èŠ‚â€”â€”æ”¶è´­ Revolvï¼ŒDropcamï¼ˆ5.55 äº¿ç¾å…ƒï¼‰å’Œ Nestï¼ˆ3.2 äº¿ç¾å…ƒï¼Œè¿„ä»Šä¸ºæ­¢æ”¶è´­çš„æœ€å¤§çš„åˆåˆ›å…¬å¸ï¼‰ä¹Ÿè¢«ç®¡ç†ä¸å–„å’Œå‘˜å·¥æµå¤±çš„æŒ‡æ§æ‰€å›°æ‰°ã€‚Nest çš„ç´§å¼ å±€åŠ¿éšç€ Nest è”åˆåˆ›å§‹äººå…¼é¦–å¸­æ‰§è¡Œå®˜ Tony Fadell åœ¨ 6 æœˆä»½çš„ç¦»å¼€è€Œå…¬ä¹‹äºä¼—ã€‚Fadell è¾èŒçš„äº‹ä»¶ä¸­åå¤æåˆ°äº†æ™ºèƒ½å®¶å±…é¢†å¯¼å±‚ä¹‹é—´çš„æ‘©æ“¦ï¼Œæœ€å¼•äººæ³¨ç›®çš„æ˜¯ Dropcam åˆ›å§‹äºº Greg Duffy åœ¨ Medium ä¸Šçš„ä¸€ç¯‡åšå®¢ï¼ˆä»–çš„ Dropcam å›¢é˜Ÿè¢«çº³å…¥ Nest æ™ºèƒ½å®¶å±…éƒ¨é—¨ï¼‰ï¼š å°† Dropcam å–ç»™ Alphabet æ˜¯æˆ‘çš„é”™è¯¯â€¦â€¦å¯ä»¥è¯´ï¼Œæˆ‘ä¸å½“å‰ Nest çš„é¢†å¯¼åœ¨ç®¡ç†æ–¹å¼ä¸Šæœ‰æå¤§çš„å·®å¼‚ã€‚ Nest çš„é—®é¢˜å¯ä»¥çœ‹ä½œæ˜¯æ—§çš„ç®¡ç†ç»“æ„çš„å¤±è´¥ï¼Œå³åœ¨å…¬å¸æ‰©å±•åˆ°æ–°çš„å¸‚åœºå’Œäº§å“çº¿æ—¶ï¼Œæ²¡æœ‰æ­£ç¡®åœ°ç®¡ç†å…¶å„ä¸ªå­å…¬å¸ï¼Œåœ¨ Googleplex èƒŒæ™¯ä¸‹åè°ƒè¾¾æˆä¸€è‡´çš„ç›®æ ‡å’Œä¼ä¸šæ–‡åŒ–ã€‚äº‹å®ä¸Šï¼ŒNest éƒ¨é—¨ï¼ˆç°åœ¨æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ Alphabet å…¬å¸ï¼‰è¿œç¦»äº†è¯¥å…¬å¸çš„æ–°æ™ºèƒ½å®¶å±…ç¡¬ä»¶çš„åŠªåŠ›æ–¹å‘ï¼ˆåˆšäº 2016 å¹´ 10 æœˆ 4 æ—¥çš„æ™ºèƒ½ç¡¬ä»¶å¤§ä¼šä¸Šå‘å¸ƒ Google Homeï¼‰ã€‚ä½œä¸º Alphabet çš„äº‹å®ä¸Šçš„æ™ºèƒ½å®¶å±…å…¬å¸ï¼ŒNest å¯èƒ½æ˜¯æˆä¸ºäºšé©¬é€Š Echo è®¾å¤‡çš„ç«äº‰è€…çš„æœ€å¥½çš„é€‰æ‹©ã€‚ç„¶è€Œï¼Œäºšé©¬é€Šè®¾å¤‡å¯¹è°·æ­Œå…¬å¸çš„ä¸»è¦æœç´¢ä¸šåŠ¡çš„æ˜æ˜¾å¨èƒï¼Œä»¥åŠä¸äºšé©¬é€Šç«äº‰çš„æ—¥ç›Šæ¿€çƒˆï¼Œå¯èƒ½å¯¼è‡´è°·æ­Œå¾—å‡ºç»“è®ºï¼šå¿…é¡»å°†å¼€å‘æ™ºèƒ½å®¶å±…ä½œä¸ºå…¬å¸æ ¸å¿ƒï¼Œå¹¶ç”±è°·æ­Œçš„æ‰§è¡Œå®˜ç›´æ¥ç›‘ç£ã€‚ æ­¤å¤–ï¼Œè¿™æ ·çš„äº§å“éœ€è¦ä¸è°·æ­Œçš„æ ¸å¿ƒæœç´¢å’Œè™šæ‹ŸåŠ©ç†æœåŠ¡ç´§å¯†é›†æˆã€‚Nest ä½œä¸ºè°·æ­Œçš„éæ ¸å¿ƒå…¬å¸æƒ³è¦å®ç°è¿™ä¸€ç‚¹ï¼Œè·¨è¶Šéƒ¨é—¨é—´çš„ç•Œé™å’Œè¾¾æˆå…±è¯†å°†æœ‰æ›´å¤šçš„éº»çƒ¦ã€‚ æ–°æˆç«‹çš„ Alphabet ç»“æ„å¯èƒ½æœ‰åŠ©äºæ›´æˆåŠŸçš„å¹¶è´­å’Œä¸åŒä¸šåŠ¡çš„æ•´åˆã€‚Alphabet æ——ä¸‹çš„ä¸åŒéƒ¨é—¨å°†å¯ä»¥æ ¹æ®å®ƒä»¬è‡ªå·±çš„æˆ˜ç•¥åˆ©ç›Šå’Œè·¯çº¿è§„åˆ’è¿›è¡Œæ”¶è´­æ¸¸è¯´ï¼›ä½†ä¹Ÿä¼šé¢ä¸´ä¸€ä¸ªæ›´ä¸ºæ¸…æ™°çš„ç»„ç»‡ç»“æ„ï¼Œèƒ½è®© Alphabet ç§°éœ¸å¤©ä¸‹ï¼Œä¹Ÿä¼šè¿«ä½¿å…¶å‡å°‘å¯¹æŠ•æœºé¡¹ç›®çš„æŠ•å…¥ã€‚ å°½ç®¡è°·æ­Œçš„æœºå™¨äººå’Œæ™ºèƒ½å®¶å±…çš„æŠ•èµ„å·²ç»å˜æˆäº†è­¦ç¤ºæ€§çš„æ•…äº‹ï¼Œä½†è°·æ­Œåœ¨è®¸å¤šå…¶å®ƒé¢†åŸŸçš„æ”¶è´­å´å¸¦æ¥äº†æ¯«æ— ç–‘é—®æ›´ä¸ºç§¯æçš„ç»“æœã€‚2014 å¹´è°·æ­Œæ”¶è´­çš„ DeepMindï¼ˆé‡‘é¢åœ¨ 5 äº¿åˆ° 6 äº¿ç¾å…ƒä¹‹é—´ï¼‰å·²ç»é€šè¿‡å…¶é«˜è°ƒçš„ AlphaGo å’Œ WaveNet é¡¹ç›®å·©å›ºäº†è°·æ­Œåœ¨äººå·¥æ™ºèƒ½ç ”ç©¶æ–¹é¢çš„å£°èª‰ï¼Œè€Œä¸”å…¶æŠ€æœ¯ä¹Ÿå·²ç»åœ¨è°·æ­Œçš„æ•°æ®ä¸­å¿ƒå’Œç¿»è¯‘å·¥å…·ç­‰äº§å“ä¸­å¾—åˆ°äº†åº”ç”¨ã€‚ é™¤äº†æ™ºèƒ½å®¶å±…ï¼Œè°·æ­Œä¸äºšé©¬é€Šçš„æ¿€çƒˆç«äº‰ä¹Ÿå¸¦æ¥äº†å¯¹äº‘å’Œä¼ä¸šæœåŠ¡çš„æ”¶è´­ï¼Œä»¥åŠä¸€ç§å®Œå…¨ä¸åŒçš„æˆ˜ç•¥æ–¹æ³•ã€‚è°·æ­Œæ­£ç¡®åœ°å°†äº‘å¹³å°ä½œä¸ºäº†å…¶ä¼˜å…ˆäº‹é¡¹ï¼Œå› ä¸ºå…¶è¿‡å»åœ¨è¿™æ–¹é¢è½åäºäºšé©¬é€Šçš„ AWS å’Œå¾®è½¯çš„ Azureï¼ˆå°½ç®¡è°·æ­Œæœ€è¿‘å¾—åˆ°äº†ä¸€äº›æˆ˜ç•¥æ€§çš„äº‘å®¢æˆ·ï¼Œå…¶ä¸­åŒ…æ‹¬è‹¹æœå’Œ Spotifyï¼‰ã€‚ åœ¨è¿™ä¸ªé¢†åŸŸï¼Œè°·æ­Œä¸¥é‡ä¾èµ–äºæ”¶è´­æ¥è¡¥å……å…¶å†…éƒ¨ç ”å‘å’Œåœ¨å…¶å¹³å°ä¹‹ä¸Šæä¾›å¢å€¼æœåŠ¡ã€‚ç‰¹åˆ«åœ°ï¼ŒCEO Sundar Pichai æ›¾è¯´è¿‡è¯¥å…¬å¸çš„ç›®æ ‡æ˜¯é€šè¿‡ç¨³å¥çš„ã€å¯¹å¼€å‘è€…å‹å¥½çš„æœåŠ¡è¿›è¡Œç«äº‰ï¼Œè€Œä¸æ˜¯å•çº¯çš„è§„æ¨¡ã€‚æˆ‘ä»¬çš„æ”¶è´­æ–¹åˆ†ææ•°æ®ä¹Ÿçªå‡ºäº†è¿™æ–¹é¢çš„åŠªåŠ›ï¼š ä¸€ä¸ªä¸»è¦çš„ä¾‹å­æ˜¯è°·æ­Œåœ¨ä»Šå¹´ 9 æœˆå¯¹ Api.ai çš„æ”¶è´­ï¼Œè¿™æ˜¯ä¸€å®¶å¸®åŠ©å¼€å‘è€…å¼€å‘å¯¹è¯å¼æ™ºèƒ½æ¥å£çš„åˆ›ä¸šå…¬å¸ã€‚è¿™èƒ½å¾ˆå¥½åœ°å’Œäººå·¥æ™ºèƒ½äº¤ç»‡åœ¨ä¸€èµ·ï¼Œè€Œäººå·¥æ™ºèƒ½åˆ™æ˜¯è°·æ­Œçš„å·®å¼‚åŒ–æˆ˜ç•¥çš„å¦ä¸€æ”¯æŸ±ï¼ˆæ›´å¤šç»†èŠ‚è¯·å‚çœ‹è¡Œä¸šéƒ¨åˆ†ï¼‰ã€‚ è°·æ­Œåœ¨è¿™ä¸€é¢†åŸŸçš„å…¶å®ƒæ”¶è´­è¿˜åŒ…æ‹¬ 2014 å¹´çš„ Stackdriverã€Appurifyã€Firebase å’Œ Zync Renderï¼Œä»¥åŠè¿‡å»ä¸¤ä¸ªæœˆçš„ Apigee å’Œ Orbiteraã€‚äº‹å®ä¸Šï¼Œè°·æ­Œ 2016 å¹´çš„ä¸€åŠä»¥ä¸Šçš„æ”¶è´­éƒ½æ¶‰åŠåˆ°ä¼ä¸šåº”ç”¨æˆ– B2B äº‘æœåŠ¡ã€‚å…¶ä¸­è®¸å¤šéƒ½å‘ç”Ÿåœ¨ Recode 3 æœˆä»½çš„è°·æ­Œåœ¨å¯»æ‰¾ä¼ä¸šäº‘é¢†åŸŸçš„ç›®æ ‡ä¸Šæœ€æ´»è·ƒçš„æŠ¥é“ä¹‹åã€‚ æ®æœ€è¿‘ç¦»å¼€è°·æ­Œçš„äººè¯´ï¼Œé‚£äº›æ”¶è´­è¯·æ±‚å‡ºç°æœ€é¢‘ç¹çš„æ˜¯è¿™ä¸ªé¢†åŸŸï¼šä¼ä¸šã€‚ åœ¨äº‘çš„æ¨åŠ¨ä¸‹ï¼Œè°·æ­Œå¾—ä»¥å…³æ³¨æœåŠ¡ä¸­ç«¯å¸‚åœºçš„å¤šä¸ªç›®æ ‡ï¼Œæ—¨åœ¨å¢åŠ å¤šæ ·åŒ–çš„ä¼ä¸šèƒ½åŠ›ï¼Œè¿™å’Œå¯¹ Nest çš„æ•°åäº¿ç¾å…ƒçš„é‡ç£…æ”¶è´­ä¸åŒã€‚å…¶ 1 äº¿ç¾å…ƒæ”¶è´­çš„è®¡è´¹æœåŠ¡å…¬å¸ Orbitera æ˜¯è¿™ç§è¿½èµ¶ç­–ç•¥ä»¥åŠå…¶å¯¹ä¸€ä¸ªçµæ´»çš„ã€ã€Œå¤šäº‘ï¼ˆmulti-cloudï¼‰ã€ä¸–ç•Œï¼ˆå…¶ä¸­ä¼ä¸šå°†è¶Šæ¥è¶Šä¾èµ–äºå¤šä¸ªä¾›åº”å•†ï¼‰çš„æ”¯æŒçš„è±¡å¾ã€‚ å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå’ŒæŠ¼æ³¨å‰æ²¿çš„æœ‰å¸Œæœ›ä½†æœªå¾—åˆ°è¯æ˜çš„é¢†åŸŸç›¸æ¯”ï¼ˆæ¯”å¦‚ï¼Œè‡ªåŠ¨é©¾é©¶æ±½è½¦å’Œæœºå™¨äººï¼‰ï¼ŒAlphabet çš„ä¸€ç³»åˆ—äº‘å’Œä¼ä¸šæ”¶è´­æ›´å€¾å‘äºæœ‰æ˜æ˜¾çš„èµšé’±æœºä¼šçš„è¾ƒä¸ºæˆç†Ÿçš„å…¬å¸ã€‚ Alphabet å…­æœˆä»½å¯¹ Webpass çš„æ”¶è´­ä¹Ÿæ˜¯æ¥è‡ªäºå¯¹æˆç†Ÿçš„ç”µä¿¡é¢†åŸŸçš„æ”¶è´­ã€‚Alphabet è¿è¥ Fiber ä¸šåŠ¡çš„ Access &amp; Energy éƒ¨é—¨å·²ç»å®£å¸ƒäº†åˆ©ç”¨ Webpass çš„æ— çº¿æŠ€æœ¯é™ä½èµ„æœ¬å¼€æ”¯å’Œéƒ¨ç½²æ—¶é—´çš„è®¡åˆ’ï¼ˆä¼´éšç€ Fiber ä¸šåŠ¡æˆæœ¬é«˜æ˜‚çš„æ‰©å¼ ï¼‰ã€‚åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸­ï¼ŒWebpass çœ‹èµ·æ¥åƒæ˜¯åˆä¸€ä¸ªå¸¦æ¥äº†å³æ—¶å½±å“çš„æ”¶è´­â€”â€”é™ä½äº†å¼€å§‹å¹¶æå‡äº†ç›ˆåˆ©èƒ½åŠ›ã€‚ ä¸å¯å¦è®¤ï¼Œè‡ª Alphabet è¯ç”Ÿä»¥æ¥çš„è¿™çŸ­çŸ­ä¸€å¹´æ—¶é—´ï¼Œæ•°æ®å°±å·²ç»æ·±è¿œåœ°å½±å“äº†è¿™ä¸ªæ–°ç»„ç»‡åœ¨å¹³è¡¡ã€Œç™»æœˆé¡¹ç›®ã€å’Œè´¢æ”¿è´£ä»»ä¸Šçš„å°è¯•ï¼Œå¹¶ä¸”æ˜æ™°äº†å…¶å®ç°æ”¶å…¥çš„è·¯å¾„ã€‚ æŠ•èµ„ï¼šè°·æ­Œï¼ŒGV å’Œè°·æ­Œèµ„æœ¬Alphabet çš„æŠ•èµ„æ´»åŠ¨ä¸€ç›´è¢«ç«äº‰è€…å’Œè§‚å¯Ÿå®¶ä»¬å…³æ³¨ã€‚ä¸€éƒ¨åˆ†æŠ•èµ„ç”±ä¸‹å±çš„è°·æ­Œæˆ–å…¶åˆ†æ”¯ç›´æ¥å‘èµ·ï¼ˆä¾‹å¦‚ DeepMind ç›´æ¥æŠ•èµ„äº†è¿œç¨‹åŒ»ç–—åˆåˆ›å…¬å¸ Babylonï¼‰ã€‚ä½†å¤§éƒ¨åˆ†æŠ•èµ„æ¥è‡ª Alphabet çš„ä¸¤å®¶ä¸»è¦æŠ•èµ„æœºæ„ï¼šä¸“æ³¨äºæ—©æœŸåˆåˆ›ä¼ä¸šçš„ GVï¼ˆå‰è°·æ­Œé£æŠ•ï¼‰å’Œå¯¹æ‰©å¼ æœŸå…¬å¸æŠ•èµ„çš„è°·æ­Œèµ„æœ¬ï¼ˆGoogle Capitalï¼‰ã€‚ è¿™äº›æŠ•èµ„åˆ†æ”¯ä¸€ç›´å¼ºè°ƒå…¶æŠ•èµ„ç­–ç•¥ä¸è°·æ­Œæœ¬èº«äº’ç›¸ç‹¬ç«‹ã€‚åœ¨ 2015 å¹´ 9 æœˆï¼Œé›†å›¢çš„è¿è¥ç­–ç•¥å‘ç”Ÿäº†æ”¹å˜ï¼ŒGV å’Œè°·æ­Œèµ„æœ¬æˆä¸ºäº†æ–°æ§è‚¡å…¬å¸ä¸‹çš„ä¸¤å®¶åˆ†æ”¯å…¬å¸ã€‚ï¼ˆä½†ä»–ä»¬å…±åŒæ¥å— Aphabet çš„é«˜çº§å‰¯æ€»è£ David Drummond çš„ç›‘ç£ï¼Œæ­¤äººåŒæ—¶ç›‘ç®¡é›†å›¢çš„ä¼ä¸šå¹¶è´­ä¸šåŠ¡ã€‚ï¼‰æˆ‘ä»¬ç›¸åº”åœ°å•ç‹¬åˆ†æä»–ä»¬çš„æ´»åŠ¨ï¼Œä½†å®ƒä»¬ä»ä¼šåŒæ—¶å‡ºç°åœ¨ä¸€äº›æ·±å…¥çš„å‰–æä¸­ã€‚ æ­£å¦‚ä¸Šå›¾æ˜¾ç¤ºçš„ï¼Œä¸‰å®¶æœºæ„çš„æŠ•èµ„æ´»åŠ¨æ•°é‡åœ¨è¿‘æœŸæœ‰å¾ˆå¤§æ³¢åŠ¨ã€‚GV çš„äº¤æ˜“æ´»åŠ¨åœ¨ Alphabet æˆç«‹ä¹‹å‰å·²ç»å¼€å§‹ä¸‹é™ï¼Œè€ŒæŠ•èµ„çš„å¢é•¿æ¥è‡ªäºè°·æ­Œèµ„æœ¬å’Œè°·æ­Œæœ¬èº«çš„æˆ˜ç•¥æŠ•èµ„ã€‚ è°·æ­Œä»è°·æ­Œå¼€å§‹ï¼Œå…¬å¸çš„ä¸»è¦æˆ˜ç•¥æŠ•èµ„åŒ…æ‹¬å‡ æ¬¡å¤§å‹äº¤æ˜“åˆ°ä¸€äº›ã€Œå‰æ²¿ã€é¢†åŸŸå¦‚å¢å¼ºç°å®ï¼Œå¤ªç©ºè¿è¾“å’Œæ¢ç´¢ã€‚è°·æ­Œåœ¨ 2014 å¹´ 10 æœˆé¢†æŠ•äº†éšå½¢å¢å¼ºç°å®è®¾å¤‡ Magic Leap 5.42 äº¿ç¾å…ƒçš„ä¸€è½®æŠ•èµ„ï¼Œåœ¨ 2015 å¹´ 1 æœˆåˆå‚ä¸äº† Space X 10 äº¿ç¾å…ƒçš„ D è½®èèµ„ã€‚æœ‰æ¶ˆæ¯ç§°è°·æ­Œæ­£å‡†å¤‡åœ¨æœªæ¥å¯¹è¿™å®¶å®‡èˆªå…¬å¸ç»§ç»­æŠ•èµ„ 90 äº¿ç¾å…ƒï¼Œä»¥è·å¾— 7.5% è‚¡æƒã€‚ è¿™ç§æŠ•èµ„æ´»åŠ¨çš„è§„æ¨¡å¼ºè°ƒäº†å±±æ™¯åŸå¯¹äºå…ˆè¿›ç§‘æŠ€é¢†åŸŸçš„é‡è§†ã€‚è°·æ­Œè®¤ä¸º AR/VR æ˜¯æœªæ¥è®¡ç®—è§†è§‰å‘ˆç°çš„æ ¸å¿ƒã€‚å…¶ Magic Leap çš„äº¤æ˜“å®£ç¤ºäº†å…¬å¸ç­–ç•¥çš„è¿›ä¸€æ­¥å¤šå…ƒåŒ–ï¼ˆè°·æ­Œå·²æœ‰åŒ…æ‹¬åœ¨ 2016 å¹´ 10 æœˆå‘å¸ƒçš„æ¶ˆè´¹çº§äº§å“ Daydream ç§»åŠ¨ VR å¤´ç›”ï¼Œå’Œå…¶ä»–æ—©æœŸäº§å“ï¼Œå¦‚ Cardboardï¼ŒGoogle Glass å’Œ Tangoï¼‰ã€‚ ä¸æ­¤åŒæ—¶ï¼Œè°·æ­Œå‘ SpaceX è¿›è¡Œäº†å¤§ç¬”æŠ•èµ„ï¼Œè¿™å°†å¸®åŠ© Alphabet çš„ã€Œç™»æœˆè®¡åˆ’ã€ä¸ºè°·æ­Œæä¾›åœ°ç†ä¿¡æ¯ï¼ˆTerra Bellaï¼Œå‰ Skybox Imaging é¡¹ç›®ï¼‰ï¼ŒåŒæ—¶å¸®åŠ©æå‡å…¨çƒäº’è”ç½‘è¦†ç›–é¢ç§¯ï¼ˆAccess and Energyï¼Œå‰ Project Loon ç­‰è®¡åˆ’ï¼‰ã€‚å»‰ä»·é«˜æ•ˆçš„åœ°çƒå«æ˜Ÿå‘å°„å°†ä¼šä¸ºå¯¹è¿™ä¸¤ä¸ªæ–¹é¢æä¾›ä¾¿åˆ©ï¼Œè€Œ SpaceX çš„é¦–å¸­æ‰§è¡Œå®˜åŸƒéš†Â·é©¬æ–¯å…‹å¯¹æ­¤ä¹Ÿå¿—è¶£ç›¸æŠ•ï¼Œä»–å†³å¿ƒå»ºç«‹ä¸€ä¸ªä»¥å«æ˜Ÿä¸ºåª’ä»‹çš„å…¨çƒé€šä¿¡ç½‘ç»œã€‚è°·æ­Œç›´æ¥èµ„åŠ©äº†å«æ˜ŸæœåŠ¡å…¬å¸ O3b Networks â”€â”€ è€Œ O3b å·²è¢«æ¬§æ´²å«æ˜Ÿé€šä¿¡å…¬å¸ SES ä»¥ 14 äº¿ç¾å…ƒçš„ä»·æ ¼æ”¶è´­â”€â”€è¿™äº›æŠ•èµ„ä¹Ÿä¸ä¸Šè¿°æ´»åŠ¨ç›¸å…³ã€‚ é™¤äº†æˆ˜ç•¥æŠ•èµ„ï¼Œåœ¨ 2016 å¹´ 4 æœˆè°·æ­Œå»ºç«‹äº† Area 120ï¼Œä¸€ä¸ªä¸ºå…¬å¸å†…éƒ¨å‘˜å·¥å‡†å¤‡çš„åˆ›ä¸šå­µåŒ–å™¨ã€‚è¿™äº›æªæ–½æ˜¯ä¸ºäº†é˜²æ­¢å…¬å¸äººæ‰çš„å¤–æµã€‚å­µåŒ–å™¨çš„åå­—ä¸­æåŠæŒ¤å‡º 20% çš„æ—¶é—´è¿›è¡Œåˆ›ä¸šï¼Œå°±åƒè°·æ­Œçš„å…¶ä»–ä¼ ç»Ÿä¸€æ ·ï¼Œè¿™å·²ç»å˜æˆäº†ä¸€ä¸ªæ­£å¼çš„ï¼Œæ˜ç¡®çš„è®¡åˆ’ã€‚ GVAlphabet é£æŠ•æœºæ„è‡ª 2009 å¹´æˆç«‹ä»¥æ¥ï¼Œå·²ç»æˆä¸ºäº†é£æŠ•ç”Ÿæ€ä¸­çš„é‡è¦ä¸€ç¯ï¼Œå®ƒä¸€ç›´æ˜¯æœ€ä¸ºæ´»è·ƒçš„é£æŠ•å…¬å¸ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥åˆ†æ GVã€‚ æœ‰è¿™æ ·ä¸€ä¸ªäº‹å®ï¼šBill Marisï¼Œä½œä¸ºåˆ›å§‹äººå’Œé¦–å¸­æ‰§è¡Œå®˜åœ¨ 8 æœˆåˆç¦»å¼€äº† GVã€‚æœ‰åŒ¿åæ¶ˆæ¯ç§°è¿™æ¬¡äººå‘˜å˜åŠ¨ä¸ä¸Šçº§å…¬å¸ Alphabet çš„é‡ç»„æœ‰å…³ï¼ˆåœ¨ Maris æ²»ä¸‹çš„ GV ä»¥è‡ªä¸»å†³å®šæƒè€Œé—»åï¼‰ã€‚ç›®å‰äº‹ä»¶çš„åŒæ–¹ä»å…¬å¼€è¡¨ç¤ºå‹å¥½ï¼ŒMaris è¿™æ ·è¯„è®ºï¼š æˆ‘çš„ç¦»å¼€æ˜¯å› ä¸ºæ‰€æœ‰äº‹æƒ…éƒ½å¾ˆæ£’â€¦â€¦æˆ‘ä¸ Alphabet ä¹‹é—´æ²¡æœ‰é—®é¢˜ã€‚ä½† Alphabet çš„æ”¹å˜å¯¹æ‰€æœ‰äººéƒ½æœ‰ä¸€ç‚¹å½±å“ã€‚æˆ‘ä»¬ï¼ˆGVï¼‰ä»ç¬¬ä¸€å¤©å¼€å§‹å°±æ˜¯ç‹¬ç«‹çš„ã€‚ è™½ç„¶å¦‚æ­¤ï¼Œåœ¨å Aphabet æ—¶ä»£é‡Œï¼Œåˆ›å§‹äººçš„ç¦»å»ä»å°†æˆä¸ºä¸»é¢˜ï¼Œè¿™ä¸€å¹•ä¹Ÿè®¸å°†ä¼šåœ¨å…¬å¸çš„å…¶ä»–éƒ¨é—¨ç»§ç»­å‘ˆç°ã€‚ é€šè¿‡ CB Insight çš„æŠ•èµ„åˆ†æå·¥å…·åˆ†æ GV è¿‘æœŸçš„æŠ•èµ„æ´»åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° GV çš„æŠ•èµ„é€Ÿåº¦è‡ª 2013 å¹´æœ«åˆ° 2014 å¹´åˆçš„é¡¶å³°ï¼ˆçº¦æ¯å­£åº¦ 30 ç¬”æŠ•èµ„ï¼‰ä»¥åï¼Œæœ‰é€æ¸ä¸‹é™çš„è¶‹åŠ¿ã€‚è¿™ä¸æˆ‘ä»¬ä¹‹å‰ GV æ­£åœ¨å‡å°‘æ–°æŠ•èµ„æ´»åŠ¨çš„ç»“è®ºç›¸åŒã€‚ GV åœ¨ 2009 å¹´ä»¥ 10 äº¿ç¾å…ƒèµ„æœ¬èµ·å®¶ï¼Œæ¯å¹´è†¨èƒ€ 50 äº¿ç¾å…ƒã€‚éšç€ GV èµ„é‡‘æ¥æºçš„å……è£•ï¼Œå®ƒé€æ¸å‚ä¸è¿›äº†å¤§å‹æŠ•èµ„ï¼Œå¦‚ 2014 å¹´ä¼˜æ­¥ 12 äº¿ç¾å…ƒçš„ D è½®æŠ•èµ„å’Œ Jet.com åœ¨ 2015 å¹´çš„ B è½®æŠ•èµ„ã€‚CB Insight çš„æŠ•èµ„åˆ†æå·¥å…·æ˜¾ç¤ºäº† GV æŒç»­å¢é•¿çš„ä¸­å‹äº¤æ˜“ï¼Œåœ¨ 2016 å¹´ç¬¬ä¸€å­£åº¦ï¼Œå…¬å¸ä¸€è·ƒè¿›å…¥äº†å¤§å‹æŠ•èµ„çš„è¡Œåˆ—ï¼ŒåŒ…æ‹¬ 2 æœˆä»½å¯¹ Oscarï¼ˆ40 äº¿ç¾å…ƒï¼‰å’Œ Magic Leapï¼ˆ7.94 äº¿ç¾å…ƒï¼‰çš„æŠ•èµ„ã€‚æ€»çš„æ¥è¯´ï¼Œæ•°æ®æ˜¾ç¤º GV çš„å¤§å‹æŠ•èµ„è„±ç¦»äº† 2015 å¹´ä»¥å‰çš„ä¸­ä½æ•°ï¼Œå‡ºç°äº†æ€¥å‰§ä¸Šå‡ã€‚ äº¤æ˜“æ•°é‡çš„å‡å°‘å’ŒæŠ•èµ„é‡‘é¢çš„å¢åŠ è¡¨æ˜ GV å·²å®Œå…¨é€€å‡ºå¤©ä½¿è½®æŠ•èµ„å¸‚åœºï¼Œè¿™ä¸ªæ›¾ç»å®ƒèµ–ä»¥ä¸ºç”Ÿçš„é¢†åŸŸã€‚åœ¨è¿‡å»çš„ä¸¤å¹´é‡Œï¼Œå®ƒçš„å¤©ä½¿è½®æŠ•èµ„æ´»åŠ¨æ¯å¹´å‡å°‘ 85%ï¼Œåœ¨ 2016 å¹´ä¸ŠåŠå¹´åˆ™å®Œå…¨æ²¡æœ‰è¿™ç§æŠ•èµ„å‡ºç°ã€‚ Bill Maris åœ¨å»å¹´ 12 æœˆæ‰¿è®¤äº†è¿™ç§å˜åŒ–ï¼Œè®¤ä¸ºåœ¨å‰æœŸæŠ•èµ„ä¸­çš„æœºä¼šæ­£åœ¨å‡å°‘ã€‚åœ¨ ä»Šå¹´ 8 æœˆ Maris ç¦»èŒçš„é‡‡è®¿ä¸­ï¼Œä»–åŒæ ·æŒ‡å‡º GV ç›®å‰å¯¹äºæŠ•èµ„å½¢å¼å­˜åœ¨é™åˆ¶ï¼š å½“ä½ æœ‰ 25 äº¿ç¾å…ƒçš„èµ„é‡‘ï¼Œè¿›è¡Œç§å­è½®æŠ•èµ„å°±æ˜¯æµªè´¹æ—¶é—´äº†ã€‚ åŒæ—¶ï¼ŒGV èèµ„é¡¹ç›®çš„åŒºåŸŸä¹Ÿè¶Šæ¥è¶Šå›ºå®šäº†â”€â”€ä»¥ç¾å›½ä¸ºä¸­å¿ƒã€‚å…¬å¸ 2014 å¹´å¯åŠ¨äº† 12.5 äº¿ç¾å…ƒçš„æ¬§æ´²æŠ•èµ„ä¸“é¡¹èµ„é‡‘ï¼Œç”±äº”ä½åˆä¼™äººè¿›è¡Œç®¡ç†ã€‚ç„¶è€Œï¼Œåœ¨å Alphabet æ—¶ä»£ï¼Œè¿™ä¸ªé¡¹ç›®åœ¨ 2015 å¹´ 12 æœˆå®£å‘Šç»ˆæ­¢ï¼Œå…¶ä¸­èµ„é‡‘è¢«å›æ”¶å¹¶æŠ•å…¥ GV å“ç‰Œå†é€ é¡¹ç›®ã€‚ åœ¨å¤§çº¦ä¸€å¹´åŠä¹‹å‰ï¼Œæ¬§æ´²çš„åˆ†éƒ¨è¿›è¡Œäº†ä¸åˆ°åé¡¹æŠ•èµ„ï¼Œå…¶ä¸­æœ€å¤§çš„äº¤æ˜“æ˜¯å¯¹å®¾é¦†é¢„å®šç½‘ç«™ Secret Escapes 6000 ä¸‡ç¾å…ƒçš„ C è½®èèµ„ï¼ˆOctopus Investments æ˜¯è¿™æ¬¡æŠ•èµ„çš„å¦ä¸€ä¸ªé¢†æŠ•è€…ï¼‰ã€‚ ä»è¡Œä¸šä¸Šçœ‹ï¼ŒGV ä¸€ç›´è¢«å…¶ã€Œç‹¬ç«‹ã€çš„ç­–ç•¥æ‰€æŸç¼šï¼Œå…¬å¸è¡¨é¢ä¸Šè¿½æ±‚é«˜é£é™©ï¼Œä½†æ½œåœ¨é«˜å›æŠ¥çš„ç™»æœˆå¼çš„é¡¹ç›®ï¼Œå®é™…ä¸Šå´ä¸ä¼ ç»Ÿé£æŠ•å…¬å¸åˆ«æ— äºŒè‡´ã€‚Maris çš„ä¸ªäººé­…åŠ›æ¸²æŸ“äº†è°·æ­Œå¯¹äºç™»æœˆå¼é¡¹ç›®çš„è¿½æ±‚ã€‚åŒ»ç–—é¢†åŸŸçš„æŠ•èµ„ä¸ºè¿™ç§çœ‹æ³•åšå‡ºäº†æ³¨è§£ï¼Œæ­£å¦‚ Maris åœ¨ 2015 å¹´æ–‡ä»¶ä¸­æ‰€è¯´ï¼š å¦‚æœä½ ä»Šå¤©é—®æˆ‘ï¼Œæˆ‘ä»¬ä¼šæ´»åˆ° 500 å²å—ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„â€¦â€¦å¦‚æœæœ‰äººè®©ä½ åœ¨å¾ˆå¤šé’±å’Œèƒ½æ´»å¾ˆä¹…ä¸­è¿›è¡Œé€‰æ‹©ï¼Œä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ çš„ç¡®ï¼ŒGV ä¸€ç›´åœ¨å¼ºè°ƒä»–ä»¬ä¼šæŠ•èµ„åŒ»ç–—åˆåˆ›ä¼ä¸šã€‚ä»–ä»¬çš„æŠ•èµ„èŒƒå›´ä»æ•°å­—åŒ»ç–—å…¬å¸ï¼ˆFlatiron Healthï¼‰åˆ°ä¾›åº”å•†ï¼ˆOne Medicalï¼‰ï¼Œä¹ŸåŒ…æ‹¬æ–°æ–¹å‘å¦‚åŸºå› åŒ»ç–—ï¼ˆEditasï¼ŒFoundation Medicineï¼Œ23andMeï¼‰ã€‚è¿‘å¹´æ¥ï¼Œå…¬å¸æ­£åœ¨è¿™äº›å…¬å¸ä¸ŠæŠ•å…¥è¶Šæ¥è¶Šå¤šçš„èµ„é‡‘ã€‚åœ¨ 2015 å¹´ 3 æœˆï¼ŒMaris åœ¨æ¥å—å½­åšç¤¾çš„é‡‡è®¿æ—¶æŠ«éœ²ï¼Œå…¶æ—¶ GV å·²å°† 36% çš„èµ„é‡‘æŠ•å…¥ç”Ÿå‘½ç§‘å­¦é¢†åŸŸï¼Œè€Œåœ¨ 2013 å¹´ï¼Œè¿™ä¸ªæ•°å­—åªæœ‰ 6%ã€‚ GV çš„æŠ•èµ„å’Œ Alphabet å…¶ä»–éƒ¨é—¨ Verily ä¸ Calico çš„æŠ•èµ„å…±åŒæ­£åœ¨ä¸ºå˜é©æ€§åŒ»ç–—ç ”ç©¶åŠ©åŠ›ã€‚å¦‚æ­¤é‡è§†åŒ»ç–—è¡Œä¸šæ— ç–‘æ˜¯å› ä¸º Bill Maris æ‹¥æœ‰ç”Ÿå‘½ç§‘å­¦èƒŒæ™¯ï¼›äº‹å®ä¸Šï¼Œè¿™ä½å‰ç”Ÿç‰©ç§‘å­¦å…¬å¸ç®¡ç†äººç›´æ¥æ¨åŠ¨äº† Calicoï¼ŒAlphabet ç¥ç§˜çš„æŠ—è¡°è€ç ”ç©¶éƒ¨é—¨ã€‚åœ¨ CB Insight ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ·±å…¥äº†è§£ GV å¯¹äºå…¶ä»–é¢†åŸŸçš„æŠ•èµ„ï¼Œè·¨åº¦ä» AR/VR é¢†åŸŸåˆ°æ— äººæœºï¼Œäº’è”ç½‘é‡‘èï¼Œç½‘ç»œå®‰å…¨ï¼Œå†åˆ°äººå·¥æ™ºèƒ½ã€‚GV çš„æŠ•èµ„ç»„åˆä¸ Alphabet ä»¤äººçœ¼èŠ±ç¼­ä¹±çš„èµ„æœ¬æ“ä½œæœ‰ç€å¾ˆå¤šé‡åˆã€‚è‡³å°‘ 6 å®¶ GV æŠ•èµ„çš„å…¬å¸æœ€ç»ˆéƒ½è¢«å±±æ™¯åŸæ”¶è´­ï¼Œå…¶ä¸­å€¼å¾—æ³¨æ„çš„æ˜¯ 2014 å¹´çš„ Nestã€‚ å¦ä¸€æ–¹é¢ï¼Œä¼˜æ­¥çªç„¶å˜æˆäº† GV ç”šè‡³ Alphabet æŠ•èµ„ç­–ç•¥ä¸­æ½œåœ¨çš„ä¸å’Œè°éŸ³ç¬¦ã€‚éšç€ç«äº‰å¯¹æ‰‹çš„å‹åŠ›ï¼Œä¼˜æ­¥å¼€å§‹å°†é‡å¿ƒè½¬å‘ä»–ä»¬çš„è‡ªåŠ¨é©¾é©¶æ±½è½¦ï¼Œè€Œè°·æ­Œæ­¤å‰ä¹ŸæŠ•èµ„äº†æ‹¼è½¦åº”ç”¨ Wazeï¼ˆæ”¶è´­äº 2013 å¹´ï¼‰æ¢ç´¢å…±ä¹˜è½¦å¸‚åœºã€‚éšç€è¿™äº›æ­¥éª¤çš„å®æ–½ï¼Œåœ¨å…±ä¹˜è½¦æœåŠ¡ä¸Šä»–ä»¬æ­£åœ¨å¯¹ä¼˜æ­¥å½¢æˆå¨èƒã€‚ ä½œä¸ºå›åº”ï¼Œä¼˜æ­¥æ­£åœ¨é€æ¸ç¨€é‡Šç®¡ç†å±‚ä¸­ Alphabet çš„åœ°ä½ï¼Œäº¤æ˜“è´Ÿè´£äºº David Drummond ç¦»å¼€äº†ä¼˜æ­¥è‘£äº‹ä¼šã€‚è¿™å®¶æ‰“è½¦å…¬å¸åŒæ—¶é©±é€äº†è‘£äº‹ä¼šè§‚å¯Ÿå‘˜ David Kraneï¼Œåè€…æ˜¯ GV çš„åˆä¼™äººï¼Œç°å·²æˆä¸º Bill Maris çš„ç»§ä»»è€…ã€‚ è°·æ­Œèµ„æœ¬è°·æ­Œèµ„æœ¬æ˜¯ Alphabet é£æŠ•å®¶åº­ä¸­å¹´è½»çš„ä¸€å‘˜ï¼Œäº 2013 å¹´åˆ›ç«‹ã€‚å› å…¶èµ„é‡‘å……è£•ï¼Œå…¬å¸çš„æŠ•èµ„æ–¹å‘æ˜æ˜¾ä¸åŒäºé›†å›¢å†…è€ä¸€ä»£çš„åŒåƒšï¼Œè°·æ­Œèµ„æœ¬ä¸»è¦å‚ä¸åˆåˆ›ä¼ä¸šçš„åæœŸèèµ„é˜¶æ®µã€‚æ®ç§°ï¼Œä»–ä»¬æ¯å¹´çš„æŠ•èµ„æ•°é‡ä¸º 30 äº¿ç¾å…ƒã€‚ä¸€ä¸ªå¥åº·çš„æ•°å­—ï¼Œä½†ç•¥å¾®å°‘äº GVã€‚æ­£å¦‚å…¶å®£ç§°çš„ï¼Œè°·æ­Œèµ„æœ¬å°†è‡ªèº«å®šä½äºç›ˆåˆ©å¯¼å‘ï¼ˆè€Œä¸æ˜¯æˆ˜ç•¥å¯¼å‘ï¼‰çš„æŠ•èµ„è€…ã€‚å½“ç„¶ï¼Œå…¶ä¸æ–­å¢é•¿çš„èµ„é‡‘ä»æ­£åœ¨åˆ©ç”¨ä¸“ä¸šçŸ¥è¯†ï¼Œæ‹›å‹ŸåŸºç¡€å’Œå…¶æ¯å…¬å¸è°·æ­Œçš„å¨æœ›ä½œä¸ºå…¶æ ¸å¿ƒå–ç‚¹ã€‚é›†å›¢çš„å…¶ä»–å…¬å¸æ‰¿è¯ºç»™å¯¹è°·æ­Œèµ„æœ¬å…±äº«èµ„æºã€‚Edward Kimï¼Œè¢«æŠ•èµ„å…¬å¸ Gusto çš„é¦–å¸­æŠ€æœ¯å®˜èµèµè¿™ç§å·¥ä½œæ–¹å¼ï¼š ä»–ä»¬çœŸçš„ä»è°·æ­Œå†…éƒ¨æ‰¾åˆ°äº†ä¸€ä¸ªäººï¼Œä¸€ä¸ªèƒ½å¤Ÿè§£å†³æˆ‘ä»¬é—®é¢˜çš„äººã€‚ç›¸æ¯”èµ„é‡‘ï¼Œä»–ä»¬å…¶å®å¸¦æ¥äº†æ›´å¤šæŠ€æœ¯ä¸Šçš„å¸®åŠ©ã€‚ è‡ªæˆç«‹ä»¥æ¥ï¼Œè°·æ­Œèµ„æœ¬ä¸€ç›´ç»´æŒæ¯” GV æ›´ä½çš„æ´»è·ƒåº¦ã€‚ä»–ä»¬æ¯å­£åº¦çš„æˆäº¤æ•°é‡ç»´æŒåœ¨ 1 è‡³ 3 ç¬”ï¼Œåªåœ¨ 2015 å¹´ç¬¬ä¸‰å­£åº¦è¶…è¿‡äº†è¿™ä¸€æ•°å­—ã€‚ è°·æ­Œèµ„æœ¬é€šå¸¸å‚ä¸ 2500 ä¸‡è‡³ 10 äº¿ç¾å…ƒçš„èèµ„è½®ï¼Œè¿™ä¸å±äºå¾ˆå¤§çš„äº¤æ˜“ã€‚å…¶ä¸­ä¸€äº›åŒ…æ‹¬ CloudFlare çš„ D è½®èèµ„ï¼ˆ11 äº¿ç¾å…ƒï¼‰ï¼ŒFanDuel çš„ E è½®èèµ„ï¼ˆ27.5 äº¿ç¾å…ƒï¼‰ï¼Œå’Œ Oscar çš„ C è½®èèµ„ï¼ˆ40 äº¿ç¾å…ƒï¼‰ã€‚ è°·æ­Œèµ„æœ¬çš„æŠ•èµ„æ–¹å¼åæ˜ äº†ç¡…è°·å¤§å¤šæ•°é«˜ç«¯æŠ•èµ„å…¬å¸çš„ä¹ æƒ¯ï¼Œä¸é‚£äº›è‘—åå¯¹å†²åŸºé‡‘ï¼Œæˆ–è€è™åŸºé‡‘ä¸å¯Œè¾¾æŠ•èµ„çš„ç§‘æŠ€æŠ•èµ„å…±åŒåŸºé‡‘ç›¸ä¼¼ã€‚ GV å¾ˆå°‘åœ¨è°·æ­Œèµ„æœ¬æŠ•èµ„ä¹‹å‰å¯¹åŒä¸€å®¶å…¬å¸è¿›è¡ŒæŠ•èµ„ã€‚å‰è€…ç¡®å®å‡ºç°åœ¨äº†è°·æ­Œèµ„æœ¬æŠ•èµ„çš„ä¸€äº›å…¬å¸çš„å…±åŒæŠ•èµ„äººåå•ä¸Šï¼Œä½†è¿™ä¸€èˆ¬éƒ½æ˜¯åœ¨è¿½é€åˆ©ç›Šæ—¶å‡ºç°çš„å·§åˆã€‚å½“ç„¶ï¼Œéšç€ GV æ­£åœ¨é€æ¸è¿œç¦»æ—©æœŸæŠ•èµ„å¸‚åœºï¼Œä¸¤å®¶æŠ•èµ„æœºæ„çš„é‡å åŒºåŸŸå¯èƒ½ä¼šè¶Šæ¥è¶Šå¤šã€‚ è°·æ­Œèµ„æœ¬ç›®å‰æœ€å€¼å¾—ä¸€æçš„äº¤æ˜“æ˜¯å¯¹ Care.com çš„é¦–æ¬¡å…¬å¼€å¸‚åœºæŠ•èµ„ã€‚ä»Šå¹´ 6 æœˆï¼Œè°·æ­Œèµ„æœ¬å®£å¸ƒäº†å¯¹è¿™å®¶æŠ¤ç†æœåŠ¡å…¬å¸ 4635 ä¸‡ç¾å…ƒçš„æŠ•èµ„ï¼Œè¯¥å…¬å¸äº 2014 å¹´ 1 æœˆä»½ä¸Šå¸‚ã€‚è¿™æ¬¡äº¤æ˜“æ„å‘³ç€å…¬å¸çš„æŠ•èµ„éƒ¨é—¨è·¨è¶Šç§äººä¸å…¬å¼€å¸‚åœºï¼Œè¿™ä¸é‚£äº›å…±åŒåŸºé‡‘å’Œå¯¹å†²åŸºé‡‘çš„ä¸šåŠ¡ç›¸åŒï¼Œæ­£å¦‚è°·æ­Œèµ„æœ¬çš„åˆä¼™äºº Laela Sturdy åœ¨å›ç­”å…¬å¸å¯¹ç§äººå’Œå…¬å¼€å¸‚åœºé¢†åŸŸä¹‹é—´çš„ç«‹åœºçš„é—®é¢˜æ—¶æ‰€è¯´çš„ï¼š Care.com ä½“ç°äº†æœ¬å…¬å¸çš„æŠ•èµ„å–œå¥½ã€‚æˆ‘ä»¬ä¸€ç›´ä¸“æ³¨äºæˆé•¿é˜¶æ®µçš„å…¬å¸ï¼Œæˆ‘ä»¬å”¯ä¸€çš„ç›®æ ‡æ˜¯å¸®åŠ©ä»–ä»¬æˆé•¿ä¸ºæ‹¥æœ‰è°·æ­Œä½“é‡çš„å·¨å¤´ã€‚ æˆ‘ä»¬å¯èƒ½ä¼šçœ‹åˆ°æœªæ¥è°·æ­Œèµ„æœ¬è¿›è¡Œæ›´å¤šçš„ PIPEï¼ˆç§å‹Ÿèµ„æœ¬æŠ•èµ„å…¬å¼€å¸‚åœºï¼‰ï¼Œåˆæˆ–è®¸ä»–ä»¬å°†å›ºå®ˆä¼ ç»Ÿçš„ç§äººæŠ•èµ„é¢†åŸŸã€‚ ä¸“åˆ©æ•°æ®åˆ†æä½¿ç”¨ CBInsights ä¸“åˆ©æ•°æ®ï¼Œæˆ‘ä»¬è¿˜ç­›é€‰å‡ºå…¬å¸ç ”ç©¶æ´»åŠ¨çš„è¶‹åŠ¿ã€‚è¿™é¡¹åˆ†æåœ¨æ‰§è¡Œæ—¶æœ‰å‡ ä¸ªæ³¨æ„äº‹é¡¹ï¼Œä¸»è¦æ˜¯ï¼Œä¸“åˆ©ç”³è¯·è¿‡ç¨‹åœ¨åº”ç”¨å‘å¸ƒå‰æœ‰ä¸€ä¸ªæ˜æ˜¾çš„æ—¶é—´å·®ã€‚è¿™ä¸ªå»¶è¿Ÿæ—¶é—´ä»å‡ ä¸ªæœˆåˆ°ä¸¤å¹´ä¸ç­‰ã€‚æˆ‘ä¹Ÿæ‹¿è°·æ­Œåšè¿‡è¯¥æ–¹é¢åˆ†æï¼Œæ’é™¤äº†å…¶å¤–éƒ¨æ”¶è´­å…¬å¸å¸¦æœ‰çš„ä¸“åˆ©ã€‚ å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè°·æ­Œä¸€ç›´ä»¥æ¥å¯¹ä¸“åˆ©æ‰€æŒçš„æ€åº¦ã€‚è¿‡å»ï¼Œå…¬å¸é«˜ç®¡åŒ…æ‹¬ Larry Page å’Œ Sergey Brin ä»–ä»¬è‡ªå·±éƒ½åå¯¹ç”³è¯·è¿‡å¤šçš„ä¸“åˆ©ï¼Œè¿™ä¼šå¨èƒåˆ°ç¡…è°·çš„åˆ›æ–°ç²¾ç¥ã€‚ä¹”å¸ƒæ–¯å‘å¸ƒç¬¬ä¸€å° iPhone æ—¶ï¼Œè°·æ­Œåªæœ‰ 38 é¡¹ä¸“åˆ©ã€‚åˆ°äº† 2011 å¹´ï¼Œè°·æ­Œé«˜çº§å‰¯æ€»è£æ€»æ³•å¾‹é¡¾é—® Kent Walker æè¿°äº†å…¬å¸å¯¹ä¸“åˆ©åˆ¶åº¦çš„æ™®éåŒæ¶ï¼Œä»–ä»¬å¸Œæœ›è§åˆ°æ”¹é©æªæ–½ï¼š ä¸“åˆ©ä¸æ˜¯åˆ›æ–°ã€‚è¿™æ˜¯ä¸€ç§é˜»æ­¢ä»–äººåˆ›æ–°çš„ç‰¹æƒã€‚ ç„¶è€Œï¼Œéšç€æ™ºèƒ½æ‰‹æœºçš„è¯‰è®¼åœ¨æœ¬ä¸–çºªåˆåŠ å‰§ï¼Œè°·æ­Œè¢«è¿«è½¬å˜äº†ç«‹åœºã€‚2012 å¹´ï¼Œå®ƒä»¥ 125 äº¿ç¾å…ƒçš„ä»·æ ¼æ”¶è´­äº†æ‘©æ‰˜ç½—æ‹‰æ‰‹æœºä¸šåŠ¡ï¼Œè¿™æ˜¯è¿„ä»Šä¸ºæ­¢è¯¥å…¬å¸æœ€å¤§çš„æ”¶è´­ï¼Œè¯¥æ”¶è´­ä¸ºè°·æ­Œä¸æ–­å¢é•¿çš„ IP åº“å¸¦æ¥äº†ä¸°å¯Œçš„æ‰‹æœºä¸“åˆ©ã€‚è°·æ­Œè‡ªå·±ä¹Ÿå¼€å§‹è¿…é€Ÿæäº¤ä¸“åˆ©åº”ç”¨ç”³è¯·ã€‚ å…³é”®æ•°æ®çªå‡ºåœ¨ä¸è°·æ­Œå‰æ²¿äº§å“è®¡åˆ’ç›¸å…³çš„ä¸“åˆ©ä¸Šã€‚Mountain View çš„ä¸“åˆ©ç‚¹äº®äº†å…¶è°·æ­Œçœ¼é•œè®¡ç®—è®¾å¤‡åŠå…¶ä»–å¯ç©¿æˆ´è®¾å¤‡ç ”ç©¶ã€‚ã€ŒBalloonã€ä¹Ÿåœ¨ 2014 å¹´é—®ä¸–ï¼Œå®ƒä»ä»Šå¹´å¹´åˆåˆ°ç°åœ¨ä¸€ç›´å¤„äºä¸‹é¢è¿™å¼ åˆ—è¡¨çš„é¦–ä½ï¼ŒProject Loon çš„æ°”çƒåŠ¨åŠ›äº’è¿ç½‘ç»œå¼€å‘ä¸€ç›´åœ¨æŒç»­ã€‚ å…³é”®è¯ã€Œè½¦è¾†ï¼ˆvehicleï¼‰ã€ä¸Šå‡çš„é¢‘ç‡ä¹Ÿååº”å‡ºè°·æ­Œåœ¨è‡ªåŠ¨é©¾æ±½è½¦é¢†åŸŸä¸Šçš„æŠ•å…¥ï¼Œä»–ä»¬ä¸€ç›´åœ¨æ‰©å¤§è‡ªåŠ¨é©¾é©¶çš„æµ‹è¯•å›¢é˜Ÿï¼Œè¿˜åœ¨å¯»æ‰¾æ±½è½¦åˆ¶é€ å•†åˆä½œä¼™ä¼´ã€‚2012 å¹´ï¼Œå¸¦æœ‰æ±½è½¦å…³é”®è¯çš„åº”ç”¨æ•°é‡æ¿€å¢ï¼Œè€Œä¸”æœ€è¿‘å‡ å¹´ä¸€ç›´åœ¨å¢é•¿ï¼ŒåŒ…æ‹¬ä¸“åˆ©æ•°æ®å¯èƒ½è¿˜ä¸å®Œæ•´çš„ 2014 å¹´ï¼Œæ‰€ä»¥å½“è¿™äº›æ¡£æ¡ˆå…¬å¸ƒäºä¸–æ—¶ï¼Œæ±½è½¦åº”ç”¨çš„æ•°é‡å®é™…ä¸Šç”šè‡³ä¼šæ›´å¤šã€‚ å¾ˆå¤šè¿™äº›ä¸“åˆ©äº§ç”Ÿè®¡åˆ’ï¼ˆmoonshotï¼‰ï¼Œå½“ç„¶åŒ…æ‹¬è‡ªåŠ¨é©¾é©¶æœºè½¦é¡¹ç›®ï¼Œå·²ç»å é¢†äº†è°·æ­Œçš„ X å®éªŒå®¤ã€‚è‡ªä» 2010 å¹´å»ºç«‹ä»¥æ¥ï¼ŒX å®éªŒå®¤ä¸€ç›´åœ¨å°è¯•æˆä¸ºä¸€ä¸ªæˆåŠŸçš„è‡´åŠ›äºå°–ç«¯å‰æ²¿çš„ä¼ä¸šç ”ç©¶æœºæ„ï¼Œå…¶ä»–åƒ PARC å’Œè´å°”å®éªŒå®¤æœ€ç»ˆéƒ½å› å…¶æ¯å…¬å¸è€Œå¤±è´¥äº†ï¼ˆè‡³å°‘åœ¨èµ„é‡‘ä¸Šï¼‰ã€‚ æˆ‘ä»¬çš„è¶‹åŠ¿å·¥å…·æŒ–æ˜äº†æ•°ç™¾ä¸‡æ¡åª’ä½“å…³äºæŠ€æœ¯è¶‹åŠ¿çš„æŠ¥å‘Šåæ˜¾ç¤ºï¼Œã€Œmoonshotã€ä¸€è¯çš„æµè¡Œåº¦ä¸€æ—¶é—´æ¥è¿‘äº†ã€ŒGoogle Xã€ã€‚æ¢å¥è¯è¯´ï¼Œè°·æ­Œçš„å®éªŒå®¤ä¸ moonshot æ¦‚å¿µç´§å¯†ç›¸å…³ï¼Œåƒä¼ ç»Ÿçš„ä¼ä¸šåˆ›æ–°å®éªŒå®¤è¿è¥å•†ä¸€æ ·ï¼ŒAlphabet å·²ç»ä¸å†é¿å¼€ä¸“åˆ©ç³»ç»Ÿäº†ã€‚ ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç»†ç©¶é—çˆ±è°·æ­Œçš„ä¸€äº›ä¼˜å…ˆé¡¹ç›®ï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•èåˆè¿› Alphabet çš„ç‰¹å®šäº§ä¸šç­–ç•¥ä¸­çš„ã€‚ Alphabet åœ¨å„é¢†åŸŸçš„æˆ˜ç•¥å’Œå…¶æŠ•èµ„éƒ¨é—¨å¾ˆåƒï¼ŒAlphabet å…¶ä»–çš„å­å…¬å¸ï¼ˆåŒ…æ‹¬è°·æ­Œï¼‰çš„ä¸šåŠ¡éƒ½æ¶‰è¶³äº†ä¸åŒçš„é¢†åŸŸã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹ Alphabet æ¶‰è¶³çš„é‡ç‚¹é¢†åŸŸè¿›è¡Œåˆ†ç»„æ·±å…¥åˆ†æã€‚å†æ¬¡å¼ºè°ƒï¼Œä¸‹é¢çš„åˆ—è¡¨ä¸­ä¸åŒ…æ‹¬è¿™å®¶å…¬å¸çš„æ‰€æœ‰ä¸šåŠ¡æ´»åŠ¨ï¼Œè€Œæ˜¯ç»¼åˆæ¦‚è¿°äº†å…¶ç›®å‰çš„å…´è¶£é¢†åŸŸã€‚ äººå·¥æ™ºèƒ½ä»Šå¹´ 10 æœˆåœ¨å…¶æœ€æ–°é«˜ç«¯ Pixel æ™ºèƒ½æ‰‹æœºçš„å‘å¸ƒä¼šå±•ç¤ºä¸­ï¼Œè°·æ­Œ CEOSundar Pichai è¯´ä¸–ç•Œæ­£åœ¨ä»ã€Œç§»åŠ¨è‡³ä¸Šã€è½¬å‘ã€Œäººå·¥æ™ºèƒ½è‡³ä¸Šã€ã€‚è°·æ­Œä¸äººå·¥æ™ºèƒ½è¿™ä¸€æ—¶é«¦é¢†åŸŸæœ‰ç€å¯†åˆ‡çš„è”ç³»ï¼Œè€Œä¸”å é¢†è¿™ä¸€é¢†åŸŸçš„æ¬²æœ›è¶Šæ¥è¶Šå¼ºçƒˆï¼Œå¹¶æˆä¸ºäº†æœ€æ´»è·ƒçš„äººå·¥æ™ºèƒ½å…¬å¸å–å®¶ã€‚ åœ¨å…¶å…¬å¸å†…éƒ¨ï¼Œè°·æ­Œå¤§è„‘ä»¥ä¸€ä¸ª X é¡¹ç›®æˆåŠŸå‡¸æ˜¾ã€‚å»å¹´ï¼ŒAstro Teller å°†è°·æ­Œå¤§è„‘æè¿°æˆã€Œè°·æ­Œçš„ç”Ÿäº§ä»·å€¼æ‰€åœ¨ï¼Œå¯ä»¥æŠµå¾—ä¸Š GoogleX çš„æ€»æˆæœ¬äº†ï¼Œã€è¿™ä¸ªå°ç»„å¼€å‘äº† tensorflowï¼Œå¹¶æé«˜äº†ä»ç¿»è¯‘åˆ°è¯­éŸ³æœç´¢çš„æ ¸å¿ƒæŠ€æœ¯ã€‚åœ¨ Alphabet ä»Šå¹´ç¬¬äºŒå­£åº¦ç›ˆåˆ©çš„ç”µè¯ä¼šè®®ä¸Šï¼ŒSundar Pichai ä¹Ÿå¯¹æŠ•èµ„äººé‡å¤å¼ºè°ƒäº†æœºå™¨å­¦ä¹ çš„é‡è¦æ€§ã€‚ æœºå™¨å­¦ä¹ æ˜¯é©±åŠ¨æœªæ¥çš„å¼•æ“â€¦ è°·æ­Œå†…éƒ¨ç›®å‰æœ‰è¶…è¿‡ 100 ä¸ªå›¢é˜Ÿåœ¨ä½¿ç”¨æœºå™¨å­¦ä¹ ï¼Œä»è¡—æ™¯åˆ° gmail åˆ°è¯­éŸ³æœç´¢ç­‰ç­‰ã€‚ é™¤äº†å®ä½“äº§å“å¤–ï¼Œä¸€ä¸ªè„±èƒäº DeepMind çš„ç³»ç»Ÿå·²ç»å¸®åŠ©å…¶è€—ç”µé‡å·¨å¤§çš„æ•°æ®ä¸­å¿ƒå‡å°‘äº†æˆæœ¬å’Œå®ç°äº†ç¯å¢ƒä¿æŠ¤åŠŸèƒ½ï¼Œå°†èƒ½æºä½¿ç”¨æ•ˆç‡æå‡äº† 15%ã€‚ è°·æ­Œæ­£åœ¨å°†æœºå™¨æ™ºèƒ½å’Œå­¦ä¹ éƒ¨ç½²åˆ°å®ƒçš„æ‰€æœ‰ä¸šåŠ¡ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿåœ¨å‡ ä¸ªå…³é”®é¢†åŸŸå¯¹å…¶äººå·¥æ™ºèƒ½æ–¹é¢çš„ä¸šåŠ¡æ´»åŠ¨åšå‡ºåˆ†æã€‚ äº‘&amp; ä¼ä¸šè°·æ­Œçš„äº‘å’Œä¼ä¸šæœåŠ¡å·²å¿«é€Ÿä¸Šå‡è‡³å…¶ä¼˜å…ˆé¡¹ç›®ä¸­äº†ï¼Œè¿™ä¸€ç‚¹åœ¨å…¶ç–¯ç‹‚çš„æ”¶è´­ä¸­å¯è§ä¸€æ–‘ã€‚è¿›ä¸€æ­¥æ¨è¿›æœ‰åˆ©å¯ç›ˆçš„æœåŠ¡å¸‚åœºå»¶ä¼¸äº† Alphabet æ‰€å¼ºè°ƒçš„èƒ½ç›´æ¥å¸¦æ¥è´¢åŠ¡ä¸Šæ¶¨çš„æœºä¼šçš„é€»è¾‘ï¼ˆä¸Šä¸€å­£åº¦ï¼Œäºšé©¬é€Š AWS éƒ¨é—¨äº§ç”Ÿè¿‘ 100 äº¿ç¾å…ƒæ”¶å…¥ï¼‰ åœ¨ Alphabet æˆç«‹è°·æ­Œäº‘äº‹ä¸šéƒ¨ Google Cloud Enterprise åï¼Œè°·æ­Œç«‹å³æŒ–æ¥äº† VMWare çš„å‰ CEODiane Greene ä»»èŒè°·æ­Œçš„äº‘è®¡ç®—äº‹ä¸šéƒ¨çš„é«˜çº§å‰¯æ€»è£ã€‚è°·æ­Œäº‘åŒ…æ‹¬äº† Google for Workã€äº‘å¹³å°ï¼ˆé’ˆå¯¹ AWSï¼‰ã€å’Œ Google Appã€‚è°·æ­Œå·²ç»å¼€å§‹é‡æ–°å®šä½å…¶å“ç‰Œã€‚2016 å¹´ 9 æœˆï¼ŒGoogle for Work å“ç‰Œæ›´åä¸º G Suiteã€‚è§†é¢‘ç¾¤èŠå’Œæ²¡äººçˆ±çš„ Google+ç½‘ç»œä¹Ÿæ­£åœ¨è½¬å‘ä¼ä¸šç”¨æˆ·ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œè°·æ­Œæ­£åœ¨æ”¶è´­å’Œå»ºç«‹ä¼—å¤šå¯¹å¼€å‘äººå‘˜å‹å¥½çš„æœåŠ¡æ¥åŒºåˆ†å…¶å¹³å°ã€‚ç„¶è€Œï¼Œè°·æ­Œä¹Ÿåœ¨å¾ˆå¤šä¸šåŠ¡ä¸­åˆ©ç”¨äº†æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œä»¥ä¾¿åœ¨ä¸å¯¹æ‰‹çš„ç«äº‰ä¸­æŠ¢å å…ˆæœºã€‚ è°·æ­Œå¤§è„‘å’Œå…¬å¸çš„äººå·¥æ™ºèƒ½æ”¶è´­ä¸šåŠ¡æœ‰åŠ©äºæ¨åŠ¨è¿™äº›è¿›å±•ï¼ŒåŒæ—¶ä¹Ÿè‚©è´Ÿç€æé†’æ—è§‚è€… Mountain View åœ¨äººå·¥æ™ºèƒ½é¢†åŸŸçš„é¢†å…ˆåœ°ä½çš„è´£ä»»ã€‚ç„¶è€Œæ®æˆ‘ä»¬çš„è¶‹åŠ¿åˆ†ææ˜¾ç¤ºï¼Œå°±å…¶äº‘äº§å“è€Œè¨€ï¼Œè°·æ­Œåœ¨åª’ä½“æŠ¥é“ä¸Šä¾ç„¶è½åäºå¾®è½¯ Azure å’Œ AWSã€‚ è™½ç„¶è°·æ­Œä¸€ç›´è½åäºäºšé©¬é€Šã€å¾®è½¯ï¼Œç”šè‡³æ˜¯ IBMï¼Œä½†æ—©æœŸçš„å›æŠ¥æ€»æ˜¯ç§¯ææ€§çš„ã€‚ä»Šå¹´ç¬¬äºŒå­£åº¦è°·æ­Œçš„ã€Œå…¶ä»–æ”¶å…¥ã€ï¼ˆåŒ…æ‹¬äº‘åŠè®¸å¯è´¹ç”¨ï¼Œç¡¬ä»¶ã€åŠå…¶ä»–éå¹¿å‘Šä¸šåŠ¡ï¼‰ä¸º 22 äº¿ç¾å…ƒï¼Œå¹¶ä»¥ 33% çš„å¹´å¢é•¿ç‡ä¸Šå‡ã€‚å…¬å¸é«˜ç®¡ä»¬å¾ˆå¿«å°±æ³¨æ„åˆ°äº†ï¼Œäº‘æœåŠ¡æ˜¯è¿™ä¸€å¢é•¿çš„ä¸»è¦é©±åŠ¨åŠ›ï¼Œè€Œä¸”å°†ä»ç„¶æ˜¯è°·æ­Œæ‰¾åˆ°åˆ›æ”¶æ–°é€”å¾„çš„æˆ˜ç•¥åŸºçŸ³ã€‚ æ¶ˆè´¹ç¡¬ä»¶&amp;å¹³å°æˆ‘ä»¬å·²ç»æ¶‰è¶³äº†è¿™ä¸ªé¢†åŸŸï¼Œä½†æ˜¯ Alphabet é¢å‘æ¶ˆè´¹è€…çš„é¡¹ç›®ä¸€ç›´åœ¨åŠªåŠ›å¹³è¡¡ä»–ä»¬åœ¨é‡‘èå®ç”¨ä¸»ä¹‰ä¸Šå¯¹æ¿€è¿›é¡¹ç›®çš„åå¥½ã€‚Nest æœ€è¿‘çš„å·²ç»å‡ºç°åœ¨å„ä¸ªè§’è½ï¼Œä½†æ˜¯å…¶ä»–éƒ¨é—¨çš„ä¸šåŠ¡è¿˜åœ¨é¢ä¸´è‡ªå·±çš„å›°éš¾ã€‚ è°·æ­Œæå‡ºäº† Xï¼Œè€Œ Advanced Technology and Projectsï¼ˆATAPï¼‰çš„ç ”å‘éƒ¨é—¨ä¹Ÿåœ¨å¼€å‘ã€Œepic shitï¼ˆå²è¯—çº§é¡¹ç›®ï¼‰ã€ï¼Œå¹¶ä¸å…¬å¸ä¿æŒé€‚å½“çš„æ•´åˆã€‚ä½†æ˜¯ï¼Œåƒå…¶ä»–çš„éƒ¨é—¨ä¸€æ ·ï¼Œé’ˆå¯¹äºæ¶ˆè´¹è€…çš„ç ”å‘éƒ¨é—¨ä»Šå¹´ä¹Ÿç»å†äº†æ›´æ¢é‡è¦é¢†å¯¼ã€‚ è°·æ­Œè‡ªä»æŠŠæ‘©æ‰˜ç½—æ‹‰å‰æ€»è£ Rick Osterloh æ‹‰å›è‘£äº‹ä¼šä¸»æŒæ–°ä¸€è½®æ´—ç‰Œæ—¶ï¼Œæ±‡é›†äº†åƒ ATAP, Chromecast, Nexus, Pixel æ™ºèƒ½æ‰‹æœºå’Œè°·æ­Œçœ¼é•œï¼ˆåè€…åŸå…ˆç”± Tony Fadell è´Ÿè´£ï¼‰ä¸åŒçš„é¢å‘æ¶ˆè´¹è€…å›¢é˜Ÿã€‚è¿™ä¸ªæ–°çš„ç¡¬ä»¶éƒ¨é—¨æœ€è¿‘æç½®äº† Project Araï¼Œè‡ª 2013 èµ·æ¥ä¸€åº¦å¤§è‚†å®£ä¼ çš„æ¨¡å—åŒ–æ™ºèƒ½æ‰‹æœºã€‚ è°·æ­Œä¸€ç›´å¯¹å…¶è‡ªä¸»æ‰‹æœºç¡¬ä»¶å“ç‰Œäº§å“ Nexus å’Œ Pixel ä¸å¤ªæ»¡æ„ï¼Œç°åœ¨ Pixel å–ä»£äº† Nexusï¼Œå¹¶ä¸è¿è¥å•†ç­¾çº¦äº†æ­£å¼åˆ†é”€åè®®ã€‚ è°·æ­Œçš„æ¶ˆè´¹è®¾å¤‡è·¨è¶Šå„ç§æ™ºèƒ½æ‰‹æœºã€å¹³æ¿ç”µè„‘ã€ç¬”è®°æœ¬ç”µè„‘ï¼Œä»¥åŠä¸€ä¸ªè¿è¡Œ Andromeda çš„æ··åˆè®¾å¤‡ï¼Œä¸€ä¸ªç»Ÿä¸€äº†å®‰å“å’Œ Chrome çš„æ“ä½œç³»ç»Ÿã€‚è¯¥å…¬å¸ç»§ç»­åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè½®æµä¾èµ–äºå¤šå®¶åˆ¶é€ å•†ä¼™ä¼´ï¼ˆä¸‰æ˜Ÿã€HTCã€åä¸ºç­‰ç­‰ï¼‰ä¸ºå…¶ç”Ÿäº§è®¾å¤‡ã€‚ æ˜¾ç„¶ï¼Œè°·æ­Œè°·æ­Œåˆšåˆšå®£å¸ƒäº† Pixel çº¿çš„å“ç‰Œåˆ¶é€ å‚å•†ï¼Œå¹¶ä¿ƒæˆäº†åˆä½œä¼™ä¼´ HTC ä¸å¯Œå£«åº·åˆä½œï¼ˆæ®è¯´å¯¼è‡´åä¸ºé€€å‡ºè¯¥é¡¹ç›®ï¼‰ã€‚ è¿™äº›æ–°æ‰‹æœºä¸ Home å’Œ Daydream ä¸€èµ·åœ¨ 10 æœˆçš„ã€ŒMade by Googleã€å¤§ä¼šä¸Šå‘å¸ƒã€‚è¯¥äº§å“çš„é—ªç”µé—®ä¸–ä¸º Osterloh çš„æ–°ç¡¬ä»¶éƒ¨é—¨å®šä¸‹äº†åŸºè°ƒï¼Œä»¥è°·æ­Œä¸ºä¸­å¿ƒçš„å“ç‰Œæ¨å¹¿é€éœ²ç€è¯¥å…¬å¸æœ‰ç‚¹æ¨¡ä»¿å¾®è½¯ Surface äº§å“çº¿çš„æ„å‘³ï¼Œæ›´åŠ æ¥è¿‘è‹¹æœåœ¨ç¡¬ä»¶è®¾è®¡å’Œè½¯ä»¶æœåŠ¡ä¸Šçš„ä¸šåŠ¡å¸ƒå±€ã€‚æ–°çš„ Pixel è®¾å¤‡çš„æº¢ä»·å®šä»·æ¯”å¯¹äº†ä¹‹å‰ Apple çš„ iPhone7 ç³»äº§å“çš„å®šä»·ã€‚è°·æ­Œåˆä¸€æ¬¡åœ¨ä¸€ä¸ªæˆç†Ÿçš„è¡Œä¸šä¸­è¿½é€ä¸€å—é«˜åˆ©æ¶¦çš„é¦…é¥¼ã€‚ è°·æ­Œä¹Ÿåœ¨å±•æœ›å¯¹è¯æ™ºèƒ½å¹³å°çš„æœªæ¥ï¼Œä» Allo çš„å³æ—¶è®¯æ¯åˆ°æ™ºèƒ½å®¶å±…ã€‚æ­¤å¤–ï¼Œæ–°çš„ Pixel æ™ºèƒ½æ‰‹æœºå·²ç»æœ‰å†…ç½®æ†ç»‘äººå·¥æ™ºèƒ½çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–°çš„è™šæ‹Ÿè°·æ­ŒåŠ©æ‰‹ï¼Œä»¥åŠ Pixel ç”¨æˆ·çš„ç…§ç‰‡å’Œè§†é¢‘æ— é™å­˜å‚¨ã€‚è‡³å°‘ç°åœ¨ï¼Œè°·æ­Œæ­£åœ¨ä¸ºå…¶å“ç‰Œ Pixel å’Œå®¶å±…è®¾å¤‡ä¿ç•™äº†è¯­éŸ³åŠ©æ‰‹ï¼ˆé€šè¿‡ Allo çš„æœºå™¨äººèŠå¤©å¯ä»¥ç”¨ä¸Šè¿™ä¸ªè¯­éŸ³åŠ©æ‰‹ï¼Œä½†æ˜¯æ²¡æœ‰æ•´åˆè¿›æ¥ï¼‰ã€‚ è°·æ­Œä¸€ç›´åœ¨åˆ©ç”¨äººå·¥æ™ºèƒ½æ¥åŒºåˆ†å…¶æ¶ˆè´¹äº‘äº§å“ï¼Œæ¯”å¦‚å…¶å¸¦æœ‰è‡ªç„¶è¯­è¨€æœç´¢å’Œè‡ªåŠ¨è„¸ä¸å¯¹è±¡è¯†åˆ«çš„ç…§ç‰‡äº§å“ åœ¨ç¡¬ä»¶å’Œå³æ—¶è®¯æ¯è¿™ä¸¤ä¸ªä¸šåŠ¡ä¸Šï¼Œè°·æ­Œå·²ç»æ™šäº†ä¸€æ­¥ï¼Œä½†æ˜¯è¿™äº›ä¸¾æªéƒ½å¯¹å±±æ™¯ï¼ˆMountain Viewï¼‰äº§å“åœ¨äººå·¥æ™ºèƒ½æŠ€æœ¯å’Œä½œä¸ºæœç´¢å¹³å°ä¸­å¿ƒä¸Šå¥ å®šé‡è¦åœ°ä½èµ·åˆ°äº†å…³é”®ä½œç”¨ã€‚æ¯ä¸ªé€šè¿‡ä¸€ä¸ª Alexa-æˆ–è€… Siri é©±åŠ¨çš„è®¾å¤‡çš„æŸ¥è¯¢éƒ½å¨èƒåˆ°äº†è°·æ­Œå½“å‰æ”¶å…¥æ¨¡å‹çš„åŸºç¡€ã€‚å³ä¾¿è°·æ­Œåœ¨è¿™é‡Œå–å¾—äº†æˆåŠŸï¼Œä¸€ä¸ªä»¥è¯­éŸ³ä¸ºä¸­å¿ƒçš„æœç´¢å½¢å¼ä»æœ‰å¯èƒ½é¢ è¦†å…¶å·²ç»ä¾èµ–äº†åå‡ å¹´çš„ä¼ ç»Ÿç½‘é¡µæœç´¢å¹¿å‘Šçš„æ˜¾ç¤ºæ¨¡å¼ã€‚ åŒæ—¶ï¼Œå¦‚æœè°·æ­Œèƒ½å°†å…¶è®¾å¤‡å’ŒæœåŠ¡é€šè¿‡å…¶äººå·¥æ™ºèƒ½æŠ€æœ¯å«é‡åŒºåˆ†å¼€æ¥ï¼Œå®ƒå°†æœ‰æœºä¼šåˆ›é€ å‡ºä¸€ä¸ªæ–°çš„ã€æ½œåœ¨çš„é«˜åˆ©æ¶¦ä¸šåŠ¡çº¿ï¼Œç”šè‡³å¯ä»¥é€šè¿‡æ‹“å±•å¸‚åœºä»½é¢åŠ å¼ºå…¶ä¸è‹¹æœå’Œäºšé©¬é€Šçš„å¯¹æŠ—ã€‚ å¢å¼ºç°å®ï¼ˆARï¼‰/è™šæ‹Ÿç°å®ï¼ˆVRï¼‰Alphabet çš„å¢å¼ºç°å®/è™šæ‹Ÿç°å®çš„ç»å…¸æˆ˜ç•¥å·²ç»å¼€å±•æˆäº†å¤šä¸ªå¹¶è¡Œè¿è¡Œçš„é¡¹ç›®ã€‚è¯¥å…¬å¸åœ¨è¿™é¡¹ä¸šåŠ¡ä¸Šå·²ç»ä»é¢„ç®—è™šæ‹Ÿç°å®ï¼ˆCardboardï¼‰ï¼Œåˆ° ARï¼ˆè°·æ­Œçœ¼é•œï¼‰ç¡¬ä»¶å†åˆ° VRï¼ˆDaydreamï¼‰å’Œ ARï¼ˆTangoï¼‰å¹³å°ï¼Œè¿˜æœ‰å…¶å‰é¢æåˆ°çš„ Magic Leapã€‚åœ¨æˆ‘ä»¬çš„å¢å¼ºä¸è™šæ‹Ÿç°å®ç ”ç©¶ç®€æŠ¥ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç ”ç©¶äº†è°·æ­Œå’Œå…¶ä»–ç§‘æŠ€å…¬å¸ã€‚ä»äº§å“åˆ›æ–°æ¥çœ‹ï¼ŒDaydream å¤´æˆ´è®¾å¤‡å¾ˆæœ‰è¶£ï¼Œå®ƒä¸€æ”¹ä¹‹å‰ç¬¨é‡çš„å¡‘æ–™å¥—è€Œä½¿ç”¨äº†è½»ä¾¿çš„å¸ƒçŠ¶ç»‡ç‰©ï¼Œæ˜¯ä¸€æ¬¾é¢å‘å¤§ä¼—æ¶ˆè´¹è€…çš„è™šæ‹Ÿç°å®æ¦‚å¿µçš„æ–°è®¾è®¡äº§å“ã€‚ äº‹å®ä¸Šï¼Œå›´ç»•è°·æ­Œ AR/VR çš„è®¨è®ºå¤§éƒ¨åˆ†éƒ½æ˜¯è®¨è®º VR è€Œä¸æ˜¯ ARï¼Œè¿™å¹¶ä¸æ„å¤–ï¼Œå› ä¸ºå®ƒçš„ AR å¯ç©¿æˆ´äº§å“ Google Glass å¤±è´¥äº†ï¼Œè€Œ Daydream æˆä¸ºäº†è°·æ­Œåœ¨æ­¤é¢†åŸŸä¸­çš„æ——æ‰‹ã€‚ é€šä¿¡ &amp; èƒ½æºAlphabet é€šè¿‡å¤–éƒ¨æŠ•èµ„ï¼ˆSpaceXã€O2b Networksï¼‰ã€æ”¶è´­ï¼ˆTitan Aerospaceï¼Œç°åœ¨æ˜¯ Project Skybenderï¼‰ä»¥åŠä¸€äº›å†…éƒ¨é¡¹ç›®ï¼ŒæŠ•å…¥äº†æ•°åäº¿ç¾å…ƒæ”¹è¿›å…¨çƒäº’è”ç½‘çš„æ¥é€šæ€§ã€‚Google Fiber è¦åšçš„äº‹å·²ç»æ¼”å˜æˆäº†å¯¹å¸‚åœºä¸­ä¼ ç»Ÿç”µä¿¡æœåŠ¡æä¾›å•†çš„æ‰“å‡»ï¼Œä¹Ÿå°±æ˜¯é‚£äº›ä¸ºå¤§åŠåŸå¸‚ç¾¤æä¾›åƒå…†ç½‘ç»œå’Œç”µè§†æœåŠ¡çš„ä¸€æ–¹ã€‚ ç„¶è€Œï¼ŒFiber å·²ç»è¢«éƒ¨ç½²å…‰çº¤ç½‘ç»œçš„æˆæœ¬å›°æ‰°ä¸€æ®µæ—¶é—´äº†ï¼Œæ›´ä¸è¦ææ¥è‡ªåœ¨ä½è€…çš„æ¡ä¾‹å’Œæ³•è§„éš¾é¢˜äº†ï¼ˆFiber æ›¾è¢«æŒ‡ä¸º Alphabetã€ŒOther Betsã€ä¸­æœ€å¤§çš„å•é¡¹æ”¯å‡ºï¼ŒOther Bets æ˜¯è¯¥é›†å›¢å¯¹ç™»æœˆé¡¹ç›®ç»æµæŠ¥å‘Šçš„æ¶µç›–æ€§æœ¯è¯­ã€‚ï¼‰ä¸€æ—¦èµ„æœ¬æ”¯å‡ºè‡ªç”±æµé€šï¼ŒFiber å¦‚ä»Šæ­£è¢«é‚€è¯·æ¥å— Alphabet çš„ç»æµå®¡æŸ¥ï¼Œ8 æœˆä»½æ¥è‡ªé«˜å±‚çš„ä¸€ä»½æªè¾ä¸¥å‰çš„è¦æ±‚å°±å¯è§ä¸€èˆ¬ï¼š Alphabet CEO æ‹‰é‡ŒÂ·ä½©å¥‡å‘½ä»¤ Fiber å‡å°‘å®¢æˆ·æ”«å–æˆæœ¬åˆ°ç›®å‰çš„ 1/10ï¼ŒåŒæ—¶è¦æ±‚ Fiber ä¸»ç®¡ Craig Barratt ç æ‰ä¸€åŠèŒå‘˜ï¼Œä» 1000 åˆ° 500ã€‚ å°±åƒæˆ‘ä»¬ä¸Šé¢æåˆ°çš„ï¼Œå¯¹ Webpass çš„æ”¶è´­å°±åƒä¸€å‰‚è¯è†ï¼Œç›´æ¥ç¼“å’Œäº†è¿™äº›æŸå¤±ã€‚ å…¶ä»–é¡¹ç›®åŒ…æ‹¬è°·æ­Œçš„ Project Fi mobile virtual network operatorï¼ˆMVNOï¼‰ï¼Œè°·æ­Œç§°è¯¥é¡¹ç›®æ˜¯ä¸€é¡¹å®éªŒï¼ŒåŠ¨æœºæ˜¯æ”¹è¿›ç°ä»»è¿è¥å•†ã€‚ä¸€ä¸ª MVNOï¼Œæœ¬è´¨ä¸Šä¹Ÿå°±æ˜¯ä»æ— çº¿å’Œå¸‚åœºæ‰‹æœºæœåŠ¡å•†é‚£é‡Œè´­ä¹°å¸¦å®½æ”¾åˆ°è‡ªå·±å“ç‰Œã€ä»·ä½å’Œæ”¯æ’‘æ–¹æ¡ˆä¸‹é¢ã€‚ Linkã€Skybender å’Œ Loon é¡¹ç›®é’ˆå¯¹çš„æ˜¯åè¿œåœ°åŒºå’Œæ–°å…´å¸‚åœºçš„å®Œå…¨ä¸åŒçš„äººç¾¤ï¼Œä½†è¿™æ˜¾ç„¶æ˜¯ã€Œæ‰€æœ‰äººéƒ½æ¥å…¥ç½‘ç»œã€ç†å¿µçš„å»¶å±•ã€‚å’Œå…¶å®ƒ X å•å…ƒä¸€æ ·ï¼ŒLoon é¡¹ç›®æœ€è¿‘å·²ç»èµ°å‡ºäº† Xï¼Œå¾—åˆ°äº†æ¥è‡ª WildBlue çš„è¡Œä¸šè€å…µ Tom Moore çš„é¢†å¯¼ï¼Œä»¥æ¨åŠ¨è¯¥é¡¹ç›®å®ç°å•†ä¸šåŒ–ã€‚Loon é¡¹ç›®ä¹Ÿåˆ©ç”¨äº†è°·æ­Œçš„æœºå™¨å­¦ä¹ ä¹‹åŠ›ï¼Œéƒ¨ç½²äº†èƒ½å¤Ÿä¼˜åŒ–æ°”çƒçš„ä½ç½®å’Œæ–¹å‘çš„ç®—æ³•ã€‚ åªè¦è¿™äº›ã€Œç™»æœˆé¡¹ç›®ã€ä» X æ¯•ä¸šï¼Œå°±å¾ˆå®¹æ˜“é¢„æƒ³å®ƒä»¬ä¼šè¢«æ”¶çº³åˆ° Alphabet çš„ Access &amp; Energy çš„æ——å¸œä¹‹ä¸‹ã€‚æœ‰ä¼ è¨€è¯´è¿™ä¸ª A&amp;E å•ä½å°†ä¼šæ¢ä¸ªæ–°åå­—ï¼Œä½†ç›®å‰ä»ç„¶è¿˜ä¼šåŒ…æ‹¬ Alphabet åœ¨èƒ½æºæ–¹é¢çš„å·¥ä½œã€‚Sunroof é¡¹ç›®æ˜¯å…¶ä¸­çš„ä¸€é¡¹è®¡åˆ’ï¼ŒMakani æœºè½½é£åŠ›æ¶¡è½®æœºï¼ˆåœ¨ 2013 å¹´æ”¶è´­ï¼‰å¦‚æœæˆåŠŸï¼Œä¹Ÿæ˜¯å¦ä¸€ä¸ªè‡ªç„¶çš„å€™é€‰é¡¹ç›®ã€‚ äº¤é€šå’Œç‰©æµè°·æ­Œè‡ªåŠ¨é©¾é©¶æ±½è½¦é¡¹ç›®äº 2010 å¹´åœ¨ Google X æˆç«‹ï¼›å…¶è¡¨ç°å’Œå…¬ä¼—çŸ¥ååº¦ä½¿ä¹‹æˆä¸ºäº† Google X è¿™ä¸ªéƒ¨é—¨äº‹å®ä¸Šçš„ä»£è¨€äººã€‚è¯¥å…¬å¸å·²ç»ç›¸åº”åœ°è¿›è¡Œäº†æŠ•èµ„ï¼Œæœ‰ä¼ è¨€è¯´è°·æ­Œä¸ºè¿™ä¸ªé•¿æœŸé¡¹ç›®å‡†å¤‡äº† 100 äº¿ç¾å…ƒã€‚ å°±åœ¨ Alphabet çš„é‡ç»„ä¹‹å‰ï¼Œè¯¥é¡¹ç›®ä¹Ÿé›‡ä½£äº†è‡ªå·±çš„è¡Œä¸šè€å…µâ€”â€”æ¥è‡ª Hyundai America å’Œ TrueCar çš„ John Krafcikã€‚è¿™è¢«å¹¿æ³›åœ°è§£è¯»æˆæ˜¯ä½¿è¯¥é¡¹ç›®æ­£å¼å®ç°ç‹¬ç«‹çš„å¼€å§‹ã€‚åœ¨ 4 æœˆä»½çš„ä¸€ä¸ªé‡‡è®¿ä¸­ï¼ŒAstro Teller å°†å…¶æè¿°æˆæ˜¯ã€Œæ­£åœ¨ä» X æ¯•ä¸šçš„è¿‡ç¨‹ä¸­ã€ã€‚ï¼ˆå°½ç®¡ X å·²ç»ä»è°·æ­Œåˆ†ç¦»ï¼Œä½†è¯¥æ±½è½¦é¡¹ç›®ç›®å‰ä»ç„¶ä¿ç•™äº†åŸæ¥çš„åå­—ï¼‰ã€‚ äº‹å®ä¸Šï¼Œè¿™ä¸ªè°·æ­Œæ±½è½¦é¡¹ç›®çš„æµ‹è¯•åœºåœ°å·²ç»ä»å±±æ™¯åŸæ‰©å±•åˆ°äº†å¾·å…‹è¨æ–¯å·ã€äºšåˆ©æ¡‘é‚£å·å’Œåç››é¡¿å·ã€‚åœ¨ 5 æœˆä»½æ—¶ï¼Œå®ƒä¹Ÿä¸ä¸€å®¶ä¸»è¦çš„æ±½è½¦åˆ¶é€ å•†ï¼ˆFiat Chryslerï¼‰ç¡®å®šäº†é¦–æ¬¡åˆä½œå…³ç³»ï¼Œå¹¶ä¸”è¿˜åœ¨ 7 æœˆä»½å¼•å…¥äº†ä¸€ä¸ªæ³•å¾‹é¢†å¯¼ã€‚ ä½†æ˜¯ï¼Œä¸€äº›é•¿æœŸçš„å›¢é˜Ÿæˆå‘˜å·²ç»ç¦»å¼€äº†è¿™ä¸€é¡¹ç›®ã€‚8 æœˆä»½æ—¶å€™æˆ‘ä»¬çœ‹åˆ°é¡¹ç›® CTO Chris Urmson ç¦»å¼€ï¼Œä¸€äº›å·¥ç¨‹å¸ˆä¹Ÿç¦»å¼€äº†å¹¶åˆ›ç«‹äº† Otto å’Œ Nuro.ai ç­‰å…¬å¸ã€‚éšç€å…¶ä»–ç©å®¶çš„åŠ å…¥ï¼Œè°·æ­Œåœ¨è¿™ä¸€é¢†åŸŸçš„ç‹¬ç‰¹åœ°ä½å·²ç»å—åˆ°äº†æŒ‘æˆ˜ï¼Œæ­£å¦‚æˆ‘ä»¬ Trends è¶‹åŠ¿å·¥å…·å¯¹è‡ªåŠ¨é©¾é©¶ç›¸å…³çƒ­ç‚¹çš„è·Ÿè¸ªé‚£æ ·ï¼š åœ¨ç‰©æµæ–¹é¢ï¼ŒAlphabet æœ‰è°·æ­Œ Express åŒæ—¥é€è¾¾æœåŠ¡ï¼Œè¿™é¡¹æœåŠ¡åœ¨ä»Šå¹´ 2 æœˆä»½å·²ç»æ‰©å±•åˆ°ç”Ÿé²œæ‚è´§åº—ã€‚ åœ¨ X æ——ä¸‹ï¼Œè¿˜æœ‰ Wing æ— äººæœºé¡¹ç›®ï¼Œè¯¥é¡¹ç›®æœ€è¿‘å’Œ Chipotle è¿›è¡Œäº†åˆä½œåœ¨å¼—å‰å°¼äºšç†å·¥æµ‹è¯•å·é¥¼é€é€’æœåŠ¡ã€‚ å’Œå…¶å®ƒéƒ¨é—¨ä¸€æ ·ï¼Œè¿™ä¸¤ä¸ªå¿«é€’é¡¹ç›®éƒ½æ˜¯é’ˆå¯¹ç”µå­å•†åŠ¡å·¨å¤´äºšé©¬é€Šçš„æ— äººæœºå’Œå…¶å®ƒç‰©æµé¡¹ç›®çš„é˜²å¾¡ï¼Œä»¥åº”å¯¹å…¶å¯¹è°·æ­Œçš„äº§å“æœç´¢æµé‡çš„å¨èƒã€‚å®ƒä»¬ä¹Ÿå°† Alphabet å¸¦å…¥äº†ä¸ Instacartã€FreshDirect å’Œ Uber çš„ç«äº‰ä¸­ã€‚æˆ‘ä»¬å·²ç»å°† Uber è¯„ä»·ä¸ºäº†è‡ªåŠ¨é©¾é©¶å’Œé©¾ä¹˜å…±äº«çš„æœ‰åŠ›ç«äº‰è€…ã€‚Wing é¡¹ç›®ä¹Ÿä¸è¶Šæ¥è¶Šå¤šè‡ªåŠ¨å¿«é€’æ— äººæœºåˆ›ä¸šå…¬å¸å½¢æˆäº†ç«äº‰å…³ç³»ã€‚ åŒ»ç–—ä¿å¥å’Œæ•°å­—å¥åº·æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼ŒBill Maris é¢†å¯¼çš„ GV å·²ç»æŠ•èµ„äº†å¾ˆå¤šåŒ»ç–—ä¿å¥å’Œæ•°å­—å¥åº·é¢†åŸŸçš„åˆ›ä¸šå…¬å¸ã€‚å°½ç®¡æˆ‘ä»¬ç›®å‰è¿˜ä¸æ¸…æ¥šåœ¨ GV çš„æ–°é¢†å¯¼ä¸‹ï¼Œè¿™ä¸ªè¶‹åŠ¿æ˜¯å¦è¿˜ä¼šç»§ç»­ï¼Œä½† Alphabet æ——ä¸‹å·²ç»æœ‰ä¸¤ä¸ªä»äº‹ç”Ÿå‘½ç§‘å­¦ç ”ç©¶çš„åˆ†æ”¯æœºæ„äº†ã€‚ å…¶ä¸­ Verifyï¼ˆå³åŸæ¥çš„è°·æ­Œç”Ÿå‘½ç§‘å­¦ï¼ˆGoogle Life Sciencesï¼‰ï¼‰è‡ª 2015 å¹´ 12 æœˆä»¥æ¥å¯åŠ¨å¾ˆå¤šé¡¹ç›®ï¼ŒåŒ…æ‹¬æ™ºèƒ½è‘¡è„ç³–æ„Ÿåº”éšå½¢çœ¼é•œã€çº³ç±³è¯Šæ–­å’Œç”¨äºæŠµæŠ—éœ‡é¢¤çš„ stabilized spoonsï¼ˆæ”¶è´­è‡ª Lift Labsï¼‰ã€‚Verily ä¹Ÿä¸ä¸€äº›é¡¶çº§çš„åŒ»ç–—ä¿å¥å“ç‰Œå»ºç«‹äº†åˆä½œï¼Œå…¶ä¸­åŒ…æ‹¬ Johnson &amp; Johnsonï¼ˆVerb Surgicalï¼‰ã€GlaxoSmithKlineï¼ˆGalvani Bioelectronicsï¼‰å’Œ Dexcomï¼ˆè¿ç»­è¡€ç³–ç›‘æµ‹ï¼‰ã€‚ Verily æ˜¯å¦ä¸€ä¸ªè¿˜æ²¡æœ‰æ˜ç¡®çš„å•†ä¸šåŒ–è§„åˆ’çš„ Alphabet éƒ¨é—¨ã€‚Verily å·²ç»å‡ºç°äº†äººæ‰æµå¤±çš„çŠ¶å†µï¼Œä¸€äº›äººå›åˆ°äº†è°·æ­Œçš„æ€€æŠ±ï¼Œä¸€äº›äººåˆ™æˆäº†ç«äº‰å¯¹æ‰‹ã€‚å……æ»¡æ€€ç–‘çš„è§‚å¯Ÿè€…ä¹Ÿåœ¨è´¨ç–‘ Verily é¡¹ç›®çš„æœ‰æ•ˆæ€§å’Œå®ç”¨æ€§ï¼Œå…¶ä¸­åŒ…æ‹¬æ–¯å¦ç¦å¤§å­¦ç–¾ç—…é¢„é˜²å­¦æ•™æˆã€‚ äººä»¬éœ€è¦ææ˜ç™½è¿™äº›ç©æ„å¯¹äºå¸‚åœºå’Œå…¬å¸çš„æ„ä¹‰â”€â”€ä¸€ä¸ªæ–°ä¸–ç•Œâ”€â”€æˆ–è€…æˆ‘ä»¬æ­£åœ¨è°ˆè®ºçš„ä¸œè¥¿å°†å¾ˆå¿«å±•ç°å½±å“â€¦â€¦åè€…æ˜¯éš¾ä»¥æƒ³è±¡çš„ã€‚ åŒæ—¶ Calico å±•ç°äº†ç™»æœˆå“²å­¦çš„çœŸæ­£ç²¾ç¥ï¼Œé€šè¿‡ç ”ç©¶å¹´é¾„åŸºå› å’ŒæŒ‘æˆ˜è¡°è€ç–¾ç—…æ¥å»¶é•¿äººç±»å¯¿å‘½ã€‚ä¸åŒäº Alphabet çš„å…¶ä»–åˆ†æ”¯ï¼ŒCalico ä»é›†å›¢å¤–é›‡ä½£äº†åŒ»ç–—ä¸“å®¶ã€‚åœ¨ 2015 å¹´ 9 æœˆï¼Œè°·æ­ŒæŠ«éœ²äº†è¿™å®¶åˆ†å…¬å¸çš„é¢„ç®—è¾¾åˆ°äº† 24 äº¿ç¾å…ƒï¼Œåœ¨å¿…è¦çš„æƒ…å†µä¸‹å¯ä»¥å¢è‡³ 49 äº¿ç¾å…ƒã€‚ Calico ä¸€ç›´ç¬¼ç½©åœ¨è°œå›¢ä¹‹ä¸­ï¼Œå®ƒåªæœ‰å¾ˆå°‘çš„å…·ä½“äº§å“ï¼Œå´æ›´é‡è§†è¿›è¡Œé•¿æœŸç ”ç©¶é¡¹ç›®ï¼ˆVerily åœ¨å…¶åŸºå› ç ”ç©¶ä¸­æ‰€è¨€ï¼‰ã€‚Calico çš„ç½‘ç«™å†…å®¹ç®€å•ï¼Œä½†ä»ç„¶æ˜¾ç¤ºä»–ä»¬æ­£ä¸è®¸å¤šè‘—åå…¬å¸åˆä½œï¼ŒåŒ…æ‹¬ AbbVieï¼ŒAncestryDNAï¼ŒåŒæ—¶è¿˜æœ‰å¾ˆå¤šå¤§å­¦ã€‚ é‡‘èç§‘æŠ€æˆ‘ä»¬æ›¾è¯¦ç»†ä»‹ç»äº† Alphabet çªç„¶åˆ‡å…¥é‡‘èç§‘æŠ€é¢†åŸŸï¼Œæ‰€ä»¥è¿™é‡Œåªæ˜¯ç®€è¦ä»‹ç»ä¸€ä¸‹ã€‚åœ¨æŠ•èµ„é¢†åŸŸï¼ŒGV å’Œè°·æ­Œèµ„æœ¬åœ¨ç§‘æŠ€é‡‘èçš„æŠ•èµ„ä¸­å æœ‰é‡è¦åœ°ä½ã€‚ ä¿é™©æŠ€æœ¯æ˜¯å…¶ä¸­çš„ç„¦ç‚¹ï¼ŒAlphabet åœ¨ 2015 å¹´ä¸­å‚ä¸äº†è‡³å°‘ 6 æ¬¡è¿™æ–¹é¢çš„åˆä½œä¸æŠ•èµ„ã€‚è¿™åŒ…æ‹¬ Nest ä¸ American Family çš„åˆä½œï¼Œå’Œç°åœ¨å·²ç»ç»“æŸçš„ Google Compareï¼ŒCoverHound å’Œ Compare.com çš„ä¼™ä¼´å…³ç³»ã€‚ ä»Šå¹´å…­æœˆï¼Œè°·æ­Œåˆå®£å¸ƒç¦æ­¢åœ¨å…¶æ‰€æœ‰ç½‘ç«™ä¸Šå‡ºç°å‘è–ªæ—¥è´·æ¬¾çš„å¹¿å‘Šã€‚åœ¨æ”¯ä»˜é¢†åŸŸï¼Œè°·æ­Œåœæ­¢äº†å®ç‰©çš„ Google Wallet å¡æœåŠ¡ï¼Œä½†ä»åœ¨ç»§ç»­è¿è¥ Android Pay å¹³å°ã€‚åè€…é¢ä¸´çš„ç«äº‰å¯¹æ‰‹ä¸ä»…æ˜¯è‹¹æœï¼Œè¿˜åŒ…æ‹¬ Android æˆæƒçš„å¾ˆå¤šå…¬å¸åŒ…æ‹¬ä¸‰æ˜Ÿï¼Œä»–ä»¬ä¹Ÿéƒ½åœ¨è‡ªå·±çš„æ‰‹æœºä¸Šå¼€å‘å‡ºäº†è‡ªå·±çš„æ”¯ä»˜å¹³å°ã€‚ ç»“è¯­æ€»è€Œè¨€ä¹‹ï¼ŒAlphabet ç›®å‰æ­£åœ¨å…¬å¸ç»“æ„çš„è½¬å‹æœŸã€‚å…¬å¸çš„ç›®æ ‡å·²ç»è½¬å˜ä¸ºé¢å‘æ›´åè°ƒçš„ç›®æ ‡å’Œå¤šå…ƒåŒ–çš„ç›ˆåˆ©ã€‚Alphabet å·²ç»åœ¨åŠªåŠ›ä½¿é•¿æœŸä»¥æ¥åˆ†å·¥ä¸ç”šæ˜ç¡®çš„å„ä¸ªåˆ†æ”¯ç›®æ ‡æ›´åŠ æ¸…æ™°ã€‚è§‚å¯Ÿå®¶å’Œè‚¡ä¸œä»¬éƒ½æ¬¢è¿æ–°çš„åˆ†æ”¯ï¼Œç¡¬ä»¶å’Œè½¯ä»¶å›¢é˜Ÿï¼Œå¹¶æ»¡æ„å…¬å¸ä¸“æ³¨äºé¢†å¯¼è¡Œä¸šçš„ç›®æ ‡ã€‚ å½“ç„¶ï¼Œå…¬å¸å†…éƒ¨ä»æœ‰å†—ä½™ï¼Œå¤§é‡ X è®¡åˆ’åœ¨è¿‡æ¸¡æœŸé—´ä»ç„¶å­˜åœ¨ã€‚Alphabet ç›®å‰æ­£å°†é‡å¿ƒè½¬å‘åˆ©æ¶¦å’Œå•†ä¸šæ½œåŠ›ï¼ŒåŒæ—¶ä»¥æ›´ä¸ºé›†ä¸­çš„æ–¹å¼åº”å¯¹ç«äº‰å¯¹æ‰‹çš„æŒ‘æˆ˜ï¼Œå®ƒå·²é€‰æ‹©äº†ä¸€ä¸ªä¸»è¦æ­¦å™¨ï¼šäººå·¥æ™ºèƒ½ã€‚äººå·¥æ™ºèƒ½å°†æ˜¯ Alphabet åœ¨æœªæ¥æ–°å¸‚åœºä¸­çš„æ€æ‰‹é”ã€‚ä½†æ·±è€•äººå·¥æ™ºèƒ½æ˜¯å¦èƒ½ä¸ºè°·æ­Œå¸¦æ¥æˆåŠŸä»æœ‰å¾…è§‚å¯Ÿã€‚è¿™ä¸»è¦å–å†³äºæ‰§è¡Œï¼Œä»¥åŠäººå·¥æ™ºèƒ½çš„åº”ç”¨èƒ½å¦åœ¨è¿è¾“ï¼Œäº‘æœåŠ¡ï¼ŒåŒ»ç–—å’Œæ¶ˆè´¹çº§ç¡¬ä»¶ç­‰å„é¡¹é¢†åŸŸä¸­åŒæ—¶å±•ç°å‡ºç«äº‰åŠ›ã€‚ âœ„ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”Â© æœ¬æ–‡ç”±æœºå™¨ä¹‹å¿ƒç¼–è¯‘ï¼Œè½¬è½½è¯·è”ç³»å¾®ä¿¡å…¬ä¼—å·è·å¾—æˆæƒã€‚âœ„ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”","categories":[],"tags":[{"name":"Google","slug":"Google","permalink":"http://github.com/tags/Google/"}],"keywords":[]},{"title":"æ·±å…¥äº†è§£Android Studioå’ŒGradle","slug":"æ·±å…¥äº†è§£Android Studioå’ŒGradle","date":"2016-10-18T09:08:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/10/18/æ·±å…¥äº†è§£Android Studioå’ŒGradle/","link":"","permalink":"http://github.com/2016/10/18/æ·±å…¥äº†è§£Android Studioå’ŒGradle/","excerpt":"åŸæ–‡é“¾æ¥ï¼š é‡æ–°è®¤è¯†AndroidStudioå’ŒGradleï¼Œè¿™äº›éƒ½æ˜¯æˆ‘ä»¬åº”è¯¥çŸ¥é“çš„ â€” by äº•æ–¹å“¥ å‰è¨€ä¸»è¦ä»AndroidStudioçš„ç¯å¢ƒå®‰è£…å‡çº§ï¼ŒGradleï¼ŒEclipseè½¬AS,å¤šæ¸ é“é…ç½®ï¼ŒMavenç§æœï¼ŒAction,Optionï¼Œå¿«æ·é”®ç­‰å‡ ä¸ªæ–¹é¢å‡ºå‘ï¼Œè®²ä¸€äº›æ“ä½œæŠ€å·§ä»¥åŠæˆ‘å¯¹AndroidStudioä½¿ç”¨çš„ä¸€äº›ç†è§£ä¸ç»éªŒã€‚æœ¬æ–‡è¾ƒå…¨é¢çš„è®²è¿°äº†æˆ‘ä»¬åœ¨å¼€å‘ä¸­å¿…é¡»è¦äº†è§£çš„ï¼Œæ¯”è¾ƒå¤šè€Œå…¨ï¼Œå¯èƒ½ä¸èƒ½é©¬ä¸Šè®°ä½ï¼Œç›®çš„åœ¨äºå¤§å®¶çœ‹æˆ‘ä¹‹åèƒ½æœ‰ä¸€ä¸ªè®¤è¯†ï¼Œåœ¨éœ€è¦ä½¿ç”¨çš„æ—¶å€™çŸ¥é“æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ã€‚å¸Œæœ›å¯¹ä½ çš„å¼€å‘å·¥ä½œæœ‰æ‰€å¸®åŠ©ï¼Œä¸è¶³ä¹‹å¤„ï¼Œè¯·æ‰¹è¯„æŒ‡æ­£ã€‚ ä¸€ã€Install&amp;Settings&amp;Update1ã€GradleGradleå®˜æ–¹ä¼šä¸æ–­æ›´æ–°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ¬åœ°å®‰è£…çš„æ–¹å¼ï¼Œå¹¶é…ç½®pathï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Terminalç›´æ¥è¾“å…¥gradleå‘½ä»¤æ‰§è¡Œæ„å»ºä»»åŠ¡ã€‚å½“ç„¶å¦‚æœæˆ‘ä»¬æƒ³å¿«é€Ÿæ›´æ–°ï¼Œå¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚ é¦–å…ˆï¼Œä¿®æ”¹project\\gradle\\warpper\\gradle-wapper.properties æ–‡ä»¶ï¼Œå…¶ä¸­distributionUrlçš„å€¼ï¼š 1distributionUrl=https\\://services.gradle.org/distributions/gradle-2.4-all.zip è¿™é‡Œå®é™…æ˜¯ä»ç½‘ç»œä¸‹è½½é…ç½®çš„ç‰ˆæœ¬ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹ï¼Œå¦‚æœä¸æ˜¯çš„å°±ä¼šä¸‹è½½ã€‚ ç„¶åä¿®æ”¹ projectçš„build.gradle 123456dependencies &#123; classpath 'com.android.tools.build:gradle:1.3.0' // NOTE: Do not place your application dependencies here; they belong // in the individual module build.gradle files&#125;","text":"åŸæ–‡é“¾æ¥ï¼š é‡æ–°è®¤è¯†AndroidStudioå’ŒGradleï¼Œè¿™äº›éƒ½æ˜¯æˆ‘ä»¬åº”è¯¥çŸ¥é“çš„ â€” by äº•æ–¹å“¥ å‰è¨€ä¸»è¦ä»AndroidStudioçš„ç¯å¢ƒå®‰è£…å‡çº§ï¼ŒGradleï¼ŒEclipseè½¬AS,å¤šæ¸ é“é…ç½®ï¼ŒMavenç§æœï¼ŒAction,Optionï¼Œå¿«æ·é”®ç­‰å‡ ä¸ªæ–¹é¢å‡ºå‘ï¼Œè®²ä¸€äº›æ“ä½œæŠ€å·§ä»¥åŠæˆ‘å¯¹AndroidStudioä½¿ç”¨çš„ä¸€äº›ç†è§£ä¸ç»éªŒã€‚æœ¬æ–‡è¾ƒå…¨é¢çš„è®²è¿°äº†æˆ‘ä»¬åœ¨å¼€å‘ä¸­å¿…é¡»è¦äº†è§£çš„ï¼Œæ¯”è¾ƒå¤šè€Œå…¨ï¼Œå¯èƒ½ä¸èƒ½é©¬ä¸Šè®°ä½ï¼Œç›®çš„åœ¨äºå¤§å®¶çœ‹æˆ‘ä¹‹åèƒ½æœ‰ä¸€ä¸ªè®¤è¯†ï¼Œåœ¨éœ€è¦ä½¿ç”¨çš„æ—¶å€™çŸ¥é“æœ‰è¿™ä¹ˆä¸ªä¸œè¥¿ã€‚å¸Œæœ›å¯¹ä½ çš„å¼€å‘å·¥ä½œæœ‰æ‰€å¸®åŠ©ï¼Œä¸è¶³ä¹‹å¤„ï¼Œè¯·æ‰¹è¯„æŒ‡æ­£ã€‚ ä¸€ã€Install&amp;Settings&amp;Update1ã€GradleGradleå®˜æ–¹ä¼šä¸æ–­æ›´æ–°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ¬åœ°å®‰è£…çš„æ–¹å¼ï¼Œå¹¶é…ç½®pathï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Terminalç›´æ¥è¾“å…¥gradleå‘½ä»¤æ‰§è¡Œæ„å»ºä»»åŠ¡ã€‚å½“ç„¶å¦‚æœæˆ‘ä»¬æƒ³å¿«é€Ÿæ›´æ–°ï¼Œå¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚ é¦–å…ˆï¼Œä¿®æ”¹project\\gradle\\warpper\\gradle-wapper.properties æ–‡ä»¶ï¼Œå…¶ä¸­distributionUrlçš„å€¼ï¼š 1distributionUrl=https\\://services.gradle.org/distributions/gradle-2.4-all.zip è¿™é‡Œå®é™…æ˜¯ä»ç½‘ç»œä¸‹è½½é…ç½®çš„ç‰ˆæœ¬ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹ï¼Œå¦‚æœä¸æ˜¯çš„å°±ä¼šä¸‹è½½ã€‚ ç„¶åä¿®æ”¹ projectçš„build.gradle 123456dependencies &#123; classpath 'com.android.tools.build:gradle:1.3.0' // NOTE: Do not place your application dependencies here; they belong // in the individual module build.gradle files&#125; æ³¨æ„ï¼šè¿™ä¸¤ä¸ªé…ç½®æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ¯”å¦‚gradle-2.4-allå¯¹åº”çš„å°±æ˜¯1.3.0ã€‚åè€…çš„æ„æ€æ˜¯è¿™ä¸ªprojecté…ç½®çš„gradleæ„å»ºç‰ˆæœ¬ä¸º1.3.0ï¼Œå‰è€…çš„æ„æ€æ˜¯è¿™ä¸ªprojectä½¿ç”¨çš„gradleçš„ç‰ˆæœ¬ä¸º2.4ã€‚æˆ‘ä»¬ä¼šå‘ç°ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹å‰è€…ï¼Œå¦‚æœæœ¬åœ°æ²¡æœ‰å®‰è£…è¿™ä¸ªç‰ˆæœ¬çš„gradleï¼Œä¼šè‡ªåŠ¨ä»gradleå®˜ç½‘ä¸‹è½½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹åè€…ï¼Œå®ƒä¼šè‡ªåŠ¨ä»jcenter()ä»“åº“ä¸‹è½½ä¸€äº›pluginä¹‹ç±»çš„ã€‚ 2ã€ASå…·ä½“çš„å®‰è£…å’Œæ›´æ–°ç½‘ä¸Šæœ‰è®¸å¤šçš„è¯¦ç»†æ•™ç¨‹ï¼Œæˆ‘åªæƒ³è¯´ä»¥ä¸‹ä¸‰ç‚¹ã€‚ Android Studioæ˜¯Googleå®˜æ–¹åŸºäºIntelliJ IDEAå¼€å‘çš„ä¸€æ¬¾Androidåº”ç”¨å¼€å‘å·¥å…·,ç»é€¼æ¯”Eclipseå¼ºå¤§ï¼Œè¿˜æ²¡æœ‰è½¬çš„å°½å¿«å§: å…³é—­AndroidStudioçš„è‡ªæ£€å‡çº§ï¼Œå¦‚æœå‡†å¤‡å¥½å‡çº§è¿˜æ˜¯è‡ªå·±é€‰æ‹©æƒ³å‡çº§çš„ç‰ˆæœ¬å‡çº§é è°±ï¼› å‡çº§å‰å¯¼å‡ºAndroidStudioçš„é…ç½®æ–‡ä»¶settings.jar(C:\\Users\\Administrator.AndroidStudio1.4\\configç›®å½•ä¸‹ï¼Œæˆ–è€…æ“ä½œFile|Export Setingså¯¼å‡º)ï¼Œå‡çº§åå¯¼å…¥Settings.jarï¼Œè¿™æ ·å°±ä¸éœ€è¦é‡æ–°é…ç½®ï¼Œæœ‰å¿…è¦çš„è¯ç»™è‡ªå·±å¤‡ä»½ä¸€ä¸ªï¼Œè¯´ä¸å®šè€å¤©æ— ç¼˜æ— æ•…æŒ‚äº†é‡è£…å¾ˆæ–¹ä¾¿ã€‚ å…·ä½“ç»†èŠ‚çš„é…ç½®å¯ä»¥é˜…è¯»ï¼Œå¼ºçƒˆå»ºè®®ç›´æ¥æ‰“å¼€ASçš„è®¾ç½®çª—å£ï¼Œå¤šè½¬å‡ æ¬¡å°±ç†Ÿæ‚‰äº†é‡Œè¾¹çš„å„ç§é…ç½®å•¦ã€‚ä¹Ÿå¯ä»¥å‚è€ƒè¿™è¾¹æ–‡ç« ï¼Œï¼ˆ1.4ç‰ˆæœ¬ï¼Œæœ‰ç‚¹æ—§äº†ï¼Œå·®ä¸å¤šå¤Ÿç”¨ï¼‰æ‰“é€ ä½ çš„å¼€å‘å·¥å…·ï¼Œsettingså¿…å¤‡ äºŒã€Gradle1 ç®€è¿°Groovyè¯­è¨€Groovyæ˜¯ä¸€ç§å¼€å‘è¯­è¨€ï¼Œæ˜¯åœ¨Javaå¹³å°ä¸Šçš„ï¼Œå…·æœ‰å‘Pythonï¼ŒRubyè¯­è¨€ç‰¹æ€§çš„çµæ´»åŠ¨æ€è¯­è¨€,Groovyä¿é‡äº†è¿™äº›ç‰¹æ€§åƒJavaè¯­æ³•ä¸€æ ·è¢«Javaå¼€å‘è€…ä½¿ç”¨ã€‚ç¼–è¯‘æœ€ç»ˆéƒ½ä¼šè½¬æˆjavaçš„.classæ–‡ä»¶ã€‚ä»–ä»¬çš„å…³ç³»å¦‚ä¸‹å›¾ã€‚æˆ‘æƒ³è¿™å¤§æ¦‚ä¹Ÿæ˜¯Gradleæ„å»ºç³»ç»Ÿä¸ºä»€ä¹ˆè¦é€‰æ‹©Groovyçš„åŸå› ï¼Œå®ƒå…·æœ‰javaè¯­è¨€çš„ç‰¹æ€§ï¼Œå¼€å‘è€…å®¹æ˜“ç†è§£ä½¿ç”¨ã€‚ä¸€å®šè¦æ˜ç™½æˆ‘ä»¬åœ¨build.gradleé‡Œè¾¹ä¸æ˜¯ç®€å•çš„é…ç½®ï¼Œè€Œæ˜¯ç›´æ¥çš„é€»è¾‘å¼€å‘ã€‚å¦‚æœä½ ç†Ÿç»ƒæŒæ¡Groovyï¼Œé‚£ä¹ˆä½ åœ¨build.graleé‡Œè¾¹å¯ä»¥åšä»»ä½•ä½ æƒ³åšçš„äº‹ã€‚ 2 Gradleç¼–ç¨‹æ¡†æ¶Gradleæ˜¯ä¸€ä¸ªå·¥å…·ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ªç¼–ç¨‹æ¡†æ¶ã€‚ä½¿ç”¨è¿™ä¸ªå·¥å…·å¯ä»¥å®Œæˆappçš„ç¼–è¯‘æ‰“åŒ…ç­‰å·¥ä½œï¼Œä¹Ÿå¯ä»¥å¹²åˆ«çš„å·¥ä½œï¼Gradleé‡Œè¾¹æœ‰è®¸å¤šä¸åŒçš„æ’ä»¶ï¼Œå¯¹åº”ä¸åŒçš„å·¥ç¨‹ç»“æ„ã€æ‰“åŒ…æ–¹å¼å’Œè¾“å‡ºæ–‡ä»¶ç±»å‹ã€‚æˆ‘ä»¬ç»å¸¸ä½¿ç”¨åˆ°çš„ä¾¿æ˜¯maven\\java\\com.android.application\\android-libraryç­‰ã€‚å½“æŒ‰ç…§è¦æ±‚é…ç½®å¥½gradleçš„ç¯å¢ƒåï¼Œæ‰§è¡Œgradleçš„taskï¼Œä¾¿ä¼šè‡ªåŠ¨ç¼–è¯‘æ‰“åŒ…è¾“å‡ºä½ æƒ³è¦çš„.apk.aar.jaræ–‡ä»¶,å¦‚æœä½ è¶³å¤Ÿç‰›é€¼ï¼Œä½ æœ‰gradleå°±å¤Ÿäº†ï¼Œç›´æ¥æ‹¿è®°äº‹æœ¬å¼€å‘ï¼› å¦‚ä¸‹å›¾ï¼Œæ˜¯Gradleçš„å·¥ä½œæµç¨‹ã€‚ Initializtion åˆå§‹åŒ–ï¼Œæ‰§è¡Œsettings.gradle(æˆ‘ä»¬çœ‹åˆ°éƒ½æ˜¯includeâ€,å®é™…é‡Œè¾¹å¯æ·±äº†ï¼‰ Hook é€šè¿‡APIæ¥æ·»åŠ ï¼Œè¿™ä¸­é—´æˆ‘ä»¬å¯ä»¥è‡ªå·±ç¼–ç¨‹å¹²äº›è‡ªå·±æƒ³åšçš„äº‹æƒ… Configuration è§£ææ¯ä¸ªprojectçš„build.gradleï¼Œç¡®å®šprojectä»¥åŠå†…éƒ¨Taskå…³ç³»ï¼Œå½¢æˆä¸€ä¸ªæœ‰å‘å›¾ Execution æ‰§è¡Œä»»åŠ¡ï¼Œè¾“å…¥å‘½ä»¤ gradle xxx ,æŒ‰ç…§é¡ºåºæ‰§è¡Œè¯¥taskçš„æ‰€æœ‰ä¾èµ–ä»¥è‡ªå·±æœ¬èº« 3 å…³äºgradleçš„taskæ¯ä¸ªæ„å»ºç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªprojectæ„æˆï¼Œä¸€ä¸ªprojectä»£è¡¨ä¸€ä¸ªjarï¼Œä¸€ä¸ªmoudleç­‰ç­‰ã€‚ä¸€ä¸ªprojectåŒ…å«è‹¥å¹²ä¸ªtaskï¼ŒåŒ…å«å¤šå°‘ç”±æ’ä»¶å†³å®šï¼Œè€Œæ¯ä¸€ä¸ªtaskå°±æ˜¯æ›´ç»†çš„æ„å»ºä»»åŠ¡ï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ªjarã€ç”ŸæˆJavadocã€ä¸Šä¼ aaråˆ°mavenä»“åº“ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰çš„task: 1gradle tasks --all å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ASä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„taskï¼ŒåŒå‡»å°±å¯ä»¥æ‰§è¡Œå•ä¸ªçš„task. å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨build.gradleä¸­å†™è‡ªå·±çš„taskã€‚å…³äºè¯¦ç»†çš„taskä»‹ç»å¯ä»¥æŸ¥çœ‹ç½‘ç»œèµ„æ–™è¿›è¡Œå­¦ä¹ ï¼Œæ¨èGradleå…¥é—¨ç³»åˆ—ï¼ŒåŸºæœ¬èŠ±ä¸ŠåŠå¤©åˆ°ä¸€å¤©çš„æ—¶å€™ç®€å•çš„è¿‡ä¸€éå°±æœ‰ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£ã€‚ 4 Gradleç¯å¢ƒä¸‹Androidçš„æ–‡ä»¶ç»“æ„ project-name gradle module-name build //æ„å»ºç”Ÿæˆæ–‡ä»¶ intermediates//æ„å»ºæ‰“åŒ…çš„èµ„æºæ–‡ä»¶ assets//èµ„æºæ–‡ä»¶ exploded-aar//å¦‚æœæˆ‘ä»¬ä¾èµ–äº†è®¸å¤šçš„aaræˆ–è€…ä¾èµ–å·¥ç¨‹ï¼Œæœ€ç»ˆéƒ½â€œcopyâ€åˆ°äº†è¿™ä¸ªç›®å½•ä¸‹ mainfests//åˆå¹¶çš„mainfest outputs apk//è¾“å‡ºæˆ‘ä»¬éœ€è¦çš„.apkæ–‡ä»¶ lint-results.html//lintæ£€æŸ¥æŠ¥å‘Š reports tests//å•å…ƒæµ‹è¯•æŠ¥å‘Š ivy.xml//moudleçš„é…ç½®ï¼ˆtaskä»»åŠ¡ï¼‰ã€ä¾èµ–å…³ç³»ç­‰ libs //æœ¬åœ°çš„ä¾èµ–jaråŒ…ç­‰ src //æœ¬mouduleæ‰€æœ‰çš„ä»£ç å’Œèµ„æºæ–‡ä»¶ androidTest //éœ€è¦androidç¯å¢ƒçš„å•å…ƒæµ‹è¯•ï¼Œæ¯”å¦‚UIçš„å•å…ƒæµ‹è¯• Test //æ™®é€šçš„javaå•å…ƒæµ‹è¯• main //ä¸»æ¸ é“ java //java code jni //navtive jni so gen res assets AndroidManifest.xml +build.gradle //module build.gradle // for all module gradle.propeties //å…¨å±€é…ç½®æ–‡ä»¶ local.properties //SDKã€NDKé…ç½® config.gradle//è‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶ settings.gradle//moduleç®¡ç† 6 å…³äºå‡ ä¸ªbuid.gradleã€gradle.propetiesæ–‡ä»¶ build.gradleæ–‡ä»¶(ä¸»å·¥ç¨‹çš„Top-level) 12345678910111213141516171819apply from:\"config.gradle\"//å¯ä»¥ç»™æ‰€æœ‰çš„moudleå¼•å…¥ä¸€ä¸ªé…ç½®æ–‡ä»¶buildscript &#123; repositories &#123; jcenter()&#125;dependencies &#123; classpath 'com.android.tools.build:gradle:1.3.0' // NOTE: Do not place your application dependencies here; they belong // in the individual module build.gradle files &#125;&#125;allprojects &#123; repositories &#123; jcenter()//å¼•å…¥è¿œç¨‹ä»“åº“ maven &#123; url MAVEN_URL &#125;//å¼•å…¥è‡ªå·±çš„ç§æœ‰mavenä»“åº“ &#125;&#125; gradle.properties(å…¨å±€é…ç½®æ–‡ä»¶ï¼‰ 1234567# This can really make a significant difference if you are building a very complex project with many sub-module dependencies:#sub-moudleå¹¶è¡Œæ„å»ºorg.gradle.parallel=true#åå°è¿›ç¨‹æ„å»ºorg.gradle.daemon=true#ç§æœ‰mavenä»“åº“åœ°å€MAVEN_URL= http://xxx.xx.1.147:8081/nexus/content/repositories/thirdparty/ build.gradle(module) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647apply plugin: 'com.android.application'//æ’ä»¶ å†³å®šæ˜¯apk\\aar\\jarç­‰android &#123;compileSdkVersion 23buildToolsVersion \"24.0.0\"// æ­¤å¤„æ³¨é‡Šä¿æŒé»˜è®¤æ‰“å¼€ï¼Œå…³é—­åå¯ä½¿ä¸ä¸¥æ ¼çš„å›¾ç‰‡å¯ä»¥é€šè¿‡ç¼–è¯‘,ä½†ä¼šå¯¼è‡´apkåŒ…å˜å¤§//aaptOptions.cruncherEnabled = false//aaptOptions.useNewCruncher = false packagingOptions &#123; exclude 'META-INF/NOTICE.txt'// è¿™é‡Œæ˜¯å…·ä½“çš„å†²çªæ–‡ä»¶å…¨è·¯å¾„ exclude 'META-INF/LICENSE.txt'&#125;//é»˜è®¤é…ç½®defaultConfig &#123; applicationId \"com.locove.meet\" minSdkVersion 16 targetSdkVersion 23 versionCode 1 versionName \"1.0\" multiDexEnabled=true//65536é—®é¢˜&#125;sourceSets &#123; main &#123; jniLibs.srcDirs = ['libs']//é‡æ–°é…ç½®è·¯å¾„ &#125;&#125;buildTypes &#123; release &#123; // zipAlignä¼˜åŒ– zipAlignEnabled true // ç§»é™¤æ— ç”¨çš„resourceæ–‡ä»¶ shrinkResources false // æ··æ·† minifyEnabled false proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro' signingConfig signingConfigs.releaseConfig &#125;&#125;&#125;dependencies &#123; compile fileTree(dir: 'libs', include: ['*.jar']) compile 'com.google.code.gson:gson:2.2.+' testCompile 'junit:junit:4.12'&#125; 7 gradleç¼–è¯‘æ–‡ä»¶å’Œç¼“å­˜æ–‡ä»¶ gradleç¼“å­˜æ–‡ä»¶ï¼šC:\\Users\\Administrator.gradle\\caches\\modules-2\\files-2.1 ideaç¼“å­˜æ–‡ä»¶ï¼š C:\\Users\\Administrator.AndroidStudio1.4 ä¸‰ã€æ„å»ºè¿‡ç¨‹ç®€æè¿™é‡Œå‚è€ƒäº†QQéŸ³ä¹æŠ€æœ¯å›¢é˜ŸAndroidæ„å»ºè¿‡ç¨‹åˆ†æ ä¸‹å›¾æ˜¯æ–‡ç« æœ«å°¾çš„ä¸€å¼ æ„å»ºæµç¨‹å›¾ï¼š è§£å‹åˆå¹¶èµ„æºï¼š ä¸»è¦æ˜¯assetsç›®å½•ï¼Œresç›®å½•ï¼ŒAndroidmainfest.xmlç›®å½•ã€‚å…¶ä¸­åˆå¹¶çš„æ—¶å€™ä¼šæ¶‰åŠåˆ°ä¼˜å…ˆçº§çš„é—®é¢˜ï¼Œè¯¦æƒ…è¯·æŸ¥çœ‹è¯¥ç¯‡æ–‡ç« ã€‚ AAPT(Android Asset Packaging Tool)æ‰“åŒ… R.javaæ–‡ä»¶ èµ„æºID app.ap å‹ç¼©åŒ… å¯¹pngå›¾è¿›è¡Œä¼˜åŒ–ç­‰ æºç ç¼–è¯‘ï¼š ç”Ÿæˆ.classå­—èŠ‚ç ï¼Œåœ¨è¿™é‡Œå¯ä»¥è¿›è¡Œåˆ é™¤æ— ç”¨ç±»ï¼Œå­—èŠ‚ç ä¼˜åŒ–ï¼Œé‡å‘½åï¼ˆåŒ…åï¼‰ï¼Œè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯ä»£ç æ··æ·†ã€‚ ç”Ÿæˆdexã€æ‰“åŒ…ç­¾åã€zipalign","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"Hiker Guide","slug":"Hikerä¸­æ–‡ä½¿ç”¨æ•™ç¨‹","date":"2016-10-17T07:47:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/10/17/Hikerä¸­æ–‡ä½¿ç”¨æ•™ç¨‹/","link":"","permalink":"http://github.com/2016/10/17/Hikerä¸­æ–‡ä½¿ç”¨æ•™ç¨‹/","excerpt":"Hiker An attractive, exquisite theme for Hexo. named â€œHikerâ€, short for â€œHikerNewsâ€. â˜ Live Preview | Hiker ä¸­æ–‡ç‰ˆä½¿ç”¨æ–‡æ¡£","text":"Hiker An attractive, exquisite theme for Hexo. named â€œHikerâ€, short for â€œHikerNewsâ€. â˜ Live Preview | Hiker ä¸­æ–‡ç‰ˆä½¿ç”¨æ–‡æ¡£ Installation Get it from GitHub 1$ git clone https://github.com/iTimeTraveler/hexo-theme-hiker.git themes/hiker Enable Modify theme setting in _config.yml to hiker. 1234# Extensions## Plugins: http://hexo.io/plugins/## Themes: http://hexo.io/themes/theme: hiker Update 12$ cd themes/Hiker$ git pull ConfigurationTheme configuration example1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192# ---------------------------------------------------------------# Site Information Settings# ---------------------------------------------------------------# Header Menumenu: Home: / Archives: archives Categories: categories Tags: tags About: aboutrss: /atom.xmlsince: 2013# Set default keywords (Use a comma to separate)keywords: \"\"# Put your favicon.ico into `hexo-site/themes/hiker/source/` directory.avatar: css/images/mylogo.jpg# Homepage# eg. home_background_image: css/images/home-bg.jpghome_background_image: css/images/home-bg.jpghome_logo_image: enable: false border: false url: css/images/homelogo.jpg# AboutPage backgroundabout_big_image: css/images/pose.jpg# Contentexcerpt_link: Read Morefancybox: true# Sidebarsidebar: rightwidgets:- category- tag- tagcloud- archive- recent_posts# comment ShortName, you can choose only ONE to display.duoshuo_shortname: iTimeTravelerdisqus_shortname:# Code Highlight theme# Available value:# default | normal | night | night eighties | night blue | night bright# https://github.com/chriskempson/tomorrow-themehighlight_theme: default# Article theme color# Available value:# random | orange | blue | red | green | blacktheme_color: random# display widgets at the bottom of index pages (pagination == 2)index_widgets:# - category# - tagcloud# - archive# widget behaviorarchive_type: 'monthly'show_count: true# Google Webmaster tools verification setting# See: https://www.google.com/webmasters/google_site_verification:baidu_site_verification:qihu_site_verification:# Miscellaneousgoogle_analytics:gauges_analytics:twitter:google_plus:fb_admins:fb_app_id: menu - Navigation menu rss - RSS link excerpt_link - â€œRead Moreâ€ link at the bottom of excerpted articles. false to hide the link. fancybox - Enable Fancybox sidebar - Sidebar style. You can choose left, right, bottom or false. widgets - Widgets displaying in sidebar google_analytics - Google Analytics ID favicon - Favicon path twitter - Twiiter ID google_plus - Google+ ID FeaturesHomepage backgroundYou could place the image file in YOUR_HEXO_SITE\\themes\\hiker\\source\\css\\images directory. and modify home_background_image in hiker/_config.yml. 123# Homepage# eg. home_background_image: css/images/home-bg.jpghome_background_image: css/images/home-bg.jpg If you DONâ€™T want any image as your homepage background, just set home_background_image empty in hiker/_config.yml, then you have an default homepage with random decorative pattern. Code Highlight ThemeHiker use Tomorrow Theme for your code block. We have six options in total: default, normal, night, night blue, night bright, night eighties Above preview picture is default theme. the image below show other five Highlight themes. Modify highlight_theme in hiker/_config.yml. 12345# Code Highlight theme# Available value:# default | normal | night | night eighties | night blue | night bright# https://github.com/chriskempson/tomorrow-themehighlight_theme: default Blog Theme ColorHiker provide five color themes for your blog. orange blue red green black You can modify theme_color in hiker/_config.yml. 1234# Article theme color# Available value:# random | orange | blue | red | green | blacktheme_color: random Night modeJust for article reading. In article page, you can click the logo image of header to switch to Night mode. FancyboxHiker uses Fancybox to showcase your photos. You can use Markdown syntax or fancybox tag plugin to add your photos. 123![img caption](img url)&#123;% fancybox img_url [img_thumbnail] [img_caption] %&#125; SidebarYou can put your sidebar in left side, right side or bottom of your site by editing sidebar setting.Hiker provides 5 built-in widgets: category tag tagcloud archives recent_posts All of them are enabled by default. You can edit them in widget setting. Comment supportHiker has native support for DuoShuo &amp; Disqus comment systems. Modify the following snippets to hiker hiker/_config.yml: 123# comment ShortName, you can choose only ONE to display.duoshuo_shortname: iTimeTravelerdisqus_shortname: Browser support ContributingAll kinds of contributions (enhancements, new features, documentation &amp; code improvements, issues &amp; bugs reporting) are welcome. Looking forward to your pull request.","categories":[],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"http://github.com/tags/Hexo/"}],"keywords":[]},{"title":"Chromeè‡ªå¸¦çš„å¼€å‘è€…å·¥å…·è¿›é˜¶æŠ€å·§","slug":"Chromeè‡ªå¸¦çš„å¼€å‘è€…å·¥å…·è¿›é˜¶æŠ€å·§","date":"2016-09-28T10:50:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/09/28/Chromeè‡ªå¸¦çš„å¼€å‘è€…å·¥å…·è¿›é˜¶æŠ€å·§/","link":"","permalink":"http://github.com/2016/09/28/Chromeè‡ªå¸¦çš„å¼€å‘è€…å·¥å…·è¿›é˜¶æŠ€å·§/","excerpt":"åŸæ–‡é“¾æ¥ï¼š Things you probably didnâ€™t know you could do with Chromeâ€™s Developer Consoleä½œè€…ï¼šSwagat Kumar Swain Chromeè‡ªå¸¦å¼€å‘è€…å·¥å…·ã€‚å®ƒçš„åŠŸèƒ½ååˆ†ä¸°å¯Œï¼ŒåŒ…æ‹¬å…ƒç´ ã€ç½‘ç»œã€å®‰å…¨ç­‰ç­‰ã€‚ä»Šå¤©æˆ‘ä»¬ä¸»è¦ä»‹ç»JavaScriptæ§åˆ¶å°éƒ¨åˆ†çš„åŠŸèƒ½ã€‚ æˆ‘æœ€æ—©å†™ä»£ç çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯åœ¨JSæ§åˆ¶å°é‡Œè¾“å‡ºä¸€äº›æœåŠ¡å™¨è¿”å›çš„å†…å®¹ï¼Œæˆ–è€…ä¸€äº›å˜é‡çš„å€¼ã€‚ä½†æ˜¯åæ¥é€šè¿‡ä¸€äº›æ·±å…¥çš„å­¦ä¹ å’Œäº†è§£ï¼Œæˆ‘å‘ç°Chromeçš„JSæ§åˆ¶å°åŸæ¥è¿˜æœ‰è¿™ä¹ˆå¤šç¥å¥‡çš„åŠŸèƒ½ã€‚ åœ¨è¿™é‡Œæˆ‘æ€»ç»“äº†ä¸€äº›ç‰¹åˆ«æœ‰ç”¨çš„åŠŸèƒ½ã€‚è¦æ˜¯ä½ å‡‘å·§åœ¨Chromeé‡Œæµè§ˆè¿™ç¯‡æ–‡ç« çš„è¯ï¼Œç°åœ¨å°±æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œè·Ÿç€éšæ‰‹è¯•è¯•å§ï¼ 1.é€‰å–DOMå…ƒç´ è¦æ˜¯ä½ ç”¨è¿‡ä¸¤å¤©jQueryçš„è¯ï¼Œä¸€å®šå¯¹ $(&#39;.className&#39;) æˆ–è€… $(&#39;#id&#39;) è¿™ç§é€‰æ‹©å™¨ä¸ä¼šé™Œç”Ÿã€‚ä¸Šé¢è¿™ä¿©è´§åˆ†åˆ«æ˜¯jQueryçš„ç±»é€‰æ‹©å™¨å’ŒIDé€‰æ‹©å™¨ã€‚ åœ¨ä¸€ä¸ªç½‘é¡µæ²¡æœ‰å¼•å…¥jQueryçš„æƒ…å†µä¸‹ï¼Œåœ¨æ§åˆ¶å°é‡Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ç±»ä¼¼çš„æ–¹æ³•é€‰å–DOM. ä¸ç®¡ $(&#39;tagName&#39;) $(&#39;.class&#39;) $(&#39;#id&#39;) è¿˜æ˜¯ $(&#39;.class #id&#39;) ç­‰ç±»ä¼¼çš„é€‰æ‹©å™¨ï¼Œéƒ½ç›¸å½“äºåŸç”ŸJSçš„document.querySelector(&#39;&#39;) æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…é€‰æ‹©è§„åˆ™çš„DOMå…ƒç´ ã€‚ åœ¨Chromeçš„æ§åˆ¶å°é‡Œï¼Œä½ å¯ä»¥é€šè¿‡ $$(&#39;tagName&#39;) æˆ–è€… $$(&#39;.className&#39;) è®°å¾—æ˜¯ä¸¤ä¸ª\\$\\$ç¬¦å·æ¥é€‰æ‹©æ‰€æœ‰åŒ¹é…è§„åˆ™çš„DOMå…ƒç´ ã€‚é€‰æ‹©è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥é€šè¿‡æ•°ç»„çš„æ–¹æ³•æ¥è®¿é—®å…¶ä¸­çš„å•ä¸ªå…ƒç´ ã€‚ ä¸¾ä¸ªæ —å­ $$(&#39;className&#39;) ä¼šè¿”å›ç»™ä½ æ‰€æœ‰åŒ…å« className ç±»å±æ€§çš„å…ƒç´ ï¼Œä¹‹åä½ å¯ä»¥é€šè¿‡ $$(&#39;className&#39;)[0] å’Œ$$(&#39;className&#39;)[1] æ¥è®¿é—®å…¶ä¸­çš„æŸä¸ªå…ƒç´ ã€‚","text":"åŸæ–‡é“¾æ¥ï¼š Things you probably didnâ€™t know you could do with Chromeâ€™s Developer Consoleä½œè€…ï¼šSwagat Kumar Swain Chromeè‡ªå¸¦å¼€å‘è€…å·¥å…·ã€‚å®ƒçš„åŠŸèƒ½ååˆ†ä¸°å¯Œï¼ŒåŒ…æ‹¬å…ƒç´ ã€ç½‘ç»œã€å®‰å…¨ç­‰ç­‰ã€‚ä»Šå¤©æˆ‘ä»¬ä¸»è¦ä»‹ç»JavaScriptæ§åˆ¶å°éƒ¨åˆ†çš„åŠŸèƒ½ã€‚ æˆ‘æœ€æ—©å†™ä»£ç çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯åœ¨JSæ§åˆ¶å°é‡Œè¾“å‡ºä¸€äº›æœåŠ¡å™¨è¿”å›çš„å†…å®¹ï¼Œæˆ–è€…ä¸€äº›å˜é‡çš„å€¼ã€‚ä½†æ˜¯åæ¥é€šè¿‡ä¸€äº›æ·±å…¥çš„å­¦ä¹ å’Œäº†è§£ï¼Œæˆ‘å‘ç°Chromeçš„JSæ§åˆ¶å°åŸæ¥è¿˜æœ‰è¿™ä¹ˆå¤šç¥å¥‡çš„åŠŸèƒ½ã€‚ åœ¨è¿™é‡Œæˆ‘æ€»ç»“äº†ä¸€äº›ç‰¹åˆ«æœ‰ç”¨çš„åŠŸèƒ½ã€‚è¦æ˜¯ä½ å‡‘å·§åœ¨Chromeé‡Œæµè§ˆè¿™ç¯‡æ–‡ç« çš„è¯ï¼Œç°åœ¨å°±æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œè·Ÿç€éšæ‰‹è¯•è¯•å§ï¼ 1.é€‰å–DOMå…ƒç´ è¦æ˜¯ä½ ç”¨è¿‡ä¸¤å¤©jQueryçš„è¯ï¼Œä¸€å®šå¯¹ $(&#39;.className&#39;) æˆ–è€… $(&#39;#id&#39;) è¿™ç§é€‰æ‹©å™¨ä¸ä¼šé™Œç”Ÿã€‚ä¸Šé¢è¿™ä¿©è´§åˆ†åˆ«æ˜¯jQueryçš„ç±»é€‰æ‹©å™¨å’ŒIDé€‰æ‹©å™¨ã€‚ åœ¨ä¸€ä¸ªç½‘é¡µæ²¡æœ‰å¼•å…¥jQueryçš„æƒ…å†µä¸‹ï¼Œåœ¨æ§åˆ¶å°é‡Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ç±»ä¼¼çš„æ–¹æ³•é€‰å–DOM. ä¸ç®¡ $(&#39;tagName&#39;) $(&#39;.class&#39;) $(&#39;#id&#39;) è¿˜æ˜¯ $(&#39;.class #id&#39;) ç­‰ç±»ä¼¼çš„é€‰æ‹©å™¨ï¼Œéƒ½ç›¸å½“äºåŸç”ŸJSçš„document.querySelector(&#39;&#39;) æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…é€‰æ‹©è§„åˆ™çš„DOMå…ƒç´ ã€‚ åœ¨Chromeçš„æ§åˆ¶å°é‡Œï¼Œä½ å¯ä»¥é€šè¿‡ $$(&#39;tagName&#39;) æˆ–è€… $$(&#39;.className&#39;) è®°å¾—æ˜¯ä¸¤ä¸ª\\$\\$ç¬¦å·æ¥é€‰æ‹©æ‰€æœ‰åŒ¹é…è§„åˆ™çš„DOMå…ƒç´ ã€‚é€‰æ‹©è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥é€šè¿‡æ•°ç»„çš„æ–¹æ³•æ¥è®¿é—®å…¶ä¸­çš„å•ä¸ªå…ƒç´ ã€‚ ä¸¾ä¸ªæ —å­ $$(&#39;className&#39;) ä¼šè¿”å›ç»™ä½ æ‰€æœ‰åŒ…å« className ç±»å±æ€§çš„å…ƒç´ ï¼Œä¹‹åä½ å¯ä»¥é€šè¿‡ $$(&#39;className&#39;)[0] å’Œ$$(&#39;className&#39;)[1] æ¥è®¿é—®å…¶ä¸­çš„æŸä¸ªå…ƒç´ ã€‚ 2.ä¸€ç§’é’Ÿè®©Chromeå˜æˆæ‰€è§å³æ‰€å¾—çš„ç¼–è¾‘å™¨ä½ å¯èƒ½ç»å¸¸ä¼šå›°æƒ‘ä½ åˆ°åº•èƒ½ä¸èƒ½ç›´æ¥åœ¨æµè§ˆå™¨é‡Œæ›´æ”¹ç½‘é¡µçš„æ–‡æœ¬å†…å®¹ã€‚ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä½ å¯ä»¥åªé€šè¿‡ä¸€è¡Œç®€å•çš„æŒ‡ä»¤æŠŠChromeå˜æˆæ‰€è§å³æ‰€å¾—çš„ç¼–è¾‘å™¨ï¼Œç›´æ¥åœ¨ç½‘é¡µä¸Šéšå¿ƒæ‰€æ¬²åœ°åˆ æ”¹æ–‡å­—ã€‚ ä½ ä¸éœ€è¦å†å‚»å‚»åœ°å³é”®å®¡æŸ¥å…ƒç´ ï¼Œç¼–è¾‘æºä»£ç äº†ã€‚æ‰“å¼€Chromeçš„å¼€å‘è€…æ§åˆ¶å°ï¼Œè¾“å…¥ 1document.body.contentEditable=true ç„¶åå¥‡è¿¹å°±å‘ç”Ÿå•¦ï¼Œä½ ç«Ÿç„¶å¯ä»¥åœ¨ç½‘é¡µé‡Œç›´æ¥ç¼–è¾‘ï¼Œæˆ–è€…éšæ„æ‹–åŠ¨å›¾ç‰‡çš„ä½ç½®äº†ï¼è¦æ˜¯ä½ æ­£åœ¨ç”¨Chromeç°åœ¨å°±å¯ä»¥è¯•è¯•ï¼ 3.è·å–æŸä¸ªDOMå…ƒç´ ç»‘å®šçš„äº‹ä»¶åœ¨è°ƒè¯•çš„æ—¶å€™ï¼Œä½ è‚¯å®šéœ€è¦çŸ¥é“æŸä¸ªå…ƒç´ ä¸Šé¢ç»‘å®šäº†ä»€ä¹ˆè§¦å‘äº‹ä»¶ã€‚Chromeçš„å¼€å‘è€…æ§åˆ¶å°å¯ä»¥è®©ä½ å¾ˆè½»æ¾åœ°æ‰¾åˆ°å®ƒä»¬ã€‚ getEventListeners($(&#39;selector&#39;)) æ–¹æ³•ä»¥æ•°ç»„å¯¹è±¡çš„æ ¼å¼è¿”å›æŸä¸ªå…ƒç´ ç»‘å®šçš„æ‰€æœ‰äº‹ä»¶ã€‚ä½ å¯ä»¥åœ¨æ§åˆ¶å°é‡Œå±•å¼€å¯¹è±¡æŸ¥çœ‹è¯¦ç»†çš„å†…å®¹ã€‚ è¦æ˜¯ä½ éœ€è¦é€‰æ‹©å…¶ä¸­çš„æŸä¸ªäº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ¥è®¿é—®ï¼š 1getEventListeners($('selector')).eventName[0].listener è¿™é‡Œçš„ eventName è¡¨ç¤ºæŸç§äº‹ä»¶ç±»å‹ï¼Œä¾‹å¦‚ï¼š 1getEventListeners($('#firstName')).click[0].listener ä¸Šé¢çš„ä¾‹å­ä¼šè¿”å›IDä¸º firstName å…ƒç´ ç»‘å®šçš„clickäº‹ä»¶ã€‚ 4.ç›‘æµ‹äº‹ä»¶å½“ä½ éœ€è¦ç›‘è§†æŸä¸ªDOMè§¦å‘çš„äº‹ä»¶æ—¶ï¼Œä¹Ÿå¯ä»¥ç”¨åˆ°æ§åˆ¶å°ã€‚ä¾‹å¦‚ä¸‹é¢è¿™äº›æ–¹æ³•ï¼š monitorEvents($(&#39;selector&#39;)) ä¼šç›‘æµ‹æŸä¸ªå…ƒç´ ä¸Šç»‘å®šçš„æ‰€æœ‰äº‹ä»¶ï¼Œä¸€æ—¦è¯¥å…ƒç´ çš„æŸä¸ªäº‹ä»¶è¢«è§¦å‘å°±ä¼šåœ¨æ§åˆ¶å°é‡Œæ˜¾ç¤ºå‡ºæ¥ã€‚ monitorEvents($(&#39;selector&#39;),&#39;eventName&#39;) å¯ä»¥ç›‘å¬æŸä¸ªå…ƒç´ ä¸Šç»‘å®šçš„å…·ä½“äº‹ä»¶ã€‚ç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨äº‹ä»¶ç±»å‹çš„åç§°ã€‚ä¾‹å¦‚ monitorEvents($(&#39;#firstName&#39;),&#39;click&#39;) åªç›‘æµ‹IDä¸ºfirstNameçš„å…ƒç´ ä¸Šçš„clickäº‹ä»¶ã€‚ monitorEvents($(&#39;selector&#39;),[&#39;eventName1&#39;,&#39;eventName3&#39;,â€¦.]) åŒä¸Šã€‚å¯ä»¥åŒæ—¶æ£€æµ‹å…·ä½“æŒ‡å®šçš„å¤šä¸ªäº‹ä»¶ç±»å‹ã€‚ unmonitorEvents($(&#39;selector&#39;)) ç”¨æ¥åœæ­¢å¯¹æŸä¸ªå…ƒç´ çš„äº‹ä»¶ç›‘æµ‹ã€‚ 5.ç”¨è®¡æ—¶å™¨æ¥è·å–æŸæ®µä»£ç å—çš„è¿è¡Œæ—¶é—´é€šè¿‡ console.time(â€˜labelNameâ€™) æ¥è®¾å®šä¸€ä¸ªè®¡æ—¶å™¨ï¼Œå…¶ä¸­çš„ labelName æ˜¯è®¡æ—¶å™¨çš„åç§°ã€‚é€šè¿‡console.timeEnd(â€˜labelNameâ€™) æ–¹æ³•æ¥åœæ­¢å¹¶è¾“å‡ºæŸä¸ªè®¡æ—¶å™¨çš„æ—¶é—´ã€‚ä¾‹å¦‚ï¼š 1234console.time('myTime'); //è®¾å®šè®¡æ—¶å™¨å¼€å§‹ - myTimeconsole.timeEnd('mytime'); //ç»“æŸå¹¶è¾“å‡ºè®¡æ—¶æ—¶é•¿ - myTime//è¾“å‡º: myTime:123.00 ms å†ä¸¾ä¸€ä¸ªé€šè¿‡è®¡æ—¶å™¨æ¥è®¡ç®—ä»£ç å—è¿è¡Œæ—¶é—´çš„ä¾‹å­ï¼š 123456789console.time('myTime'); //å¼€å§‹è®¡æ—¶ - myTimefor(var i=0; i &lt; 100000; i++)&#123; 2+4+5;&#125;console.timeEnd('mytime'); //ç»“æŸå¹¶è¾“å‡ºè®¡æ—¶æ—¶é•¿ - myTime//è¾“å‡º - myTime:12345.00 ms 6.ä»¥è¡¨æ ¼çš„å½¢å¼è¾“å‡ºæ•°ç»„å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåƒä¸‹é¢è¿™æ ·çš„æ•°ç»„ï¼š 1var myArray=[&#123;a:1,b:2,c:3&#125;,&#123;a:1,b:2,c:3,d:4&#125;,&#123;k:11,f:22&#125;,&#123;a:1,b:2,c:3&#125;] è¦æ˜¯ä½ ç›´æ¥åœ¨æ§åˆ¶å°é‡Œè¾“å…¥æ•°ç»„çš„åç§°ï¼ŒChromeä¼šä»¥æ–‡æœ¬çš„å½¢å¼è¿”å›ä¸€ä¸ªæ•°ç»„å¯¹è±¡ã€‚ä½†ä½ å®Œå…¨å¯ä»¥é€šè¿‡console.table(variableName) æ–¹æ³•æ¥ä»¥è¡¨æ ¼çš„å½¢å¼è¾“å‡ºæ¯ä¸ªå…ƒç´ çš„å€¼ã€‚ä¾‹å¦‚ä¸‹å›¾ï¼š 7.é€šè¿‡æ§åˆ¶å°æ–¹æ³•æ¥æ£€æŸ¥å…ƒç´ ä½ å¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°é‡Œè¾“å…¥ä¸‹é¢çš„æ–¹æ³•æ¥æ£€æŸ¥å…ƒç´  inspect($(&#39;selector&#39;)) ä¼šæ£€æŸ¥æ‰€æœ‰åŒ¹é…é€‰æ‹©å™¨çš„DOMå…ƒç´ ï¼Œå¹¶è¿”å›æ‰€æœ‰é€‰æ‹©å™¨é€‰æ‹©çš„DOMå¯¹è±¡ã€‚ä¾‹å¦‚ inspect($(&#39;#firstName&#39;)) é€‰æ‹©æ‰€æœ‰IDæ˜¯ firstName çš„å…ƒç´ ï¼Œinspect($(&#39;a&#39;)[3]) æ£€æŸ¥å¹¶è¿”å›é¡µé¢ä¸Šç¬¬å››ä¸ª på…ƒç´ ã€‚\\$0, \\$1, \\$2ç­‰ç­‰ä¼šè¿”å›ä½ æœ€è¿‘æ£€æŸ¥è¿‡çš„å‡ ä¸ªå…ƒç´ ï¼Œä¾‹å¦‚ \\$0 ä¼šè¿”å›ä½ æœ€åæ£€æŸ¥çš„å…ƒç´ ï¼Œ\\$1 åˆ™è¿”å›å€’æ•°ç¬¬äºŒä¸ªã€‚ 8.åˆ—å‡ºæŸä¸ªå…ƒç´ çš„æ‰€æœ‰å±æ€§ä½ ä¹Ÿå¯ä»¥é€šè¿‡æ§åˆ¶å°åˆ—å‡ºæŸä¸ªå…ƒç´ çš„æ‰€æœ‰å±æ€§ï¼š dir($(â€˜selectorâ€™)) ä¼šè¿”å›åŒ¹é…é€‰æ‹©å™¨çš„DOMå…ƒç´ çš„æ‰€æœ‰å±æ€§ï¼Œä½ å¯ä»¥å±•å¼€è¾“å‡ºçš„ç»“æœæŸ¥çœ‹è¯¦ç»†å†…å®¹ã€‚ 9.è·å–æœ€åè®¡ç®—ç»“æœçš„å€¼ä½ å¯ä»¥æŠŠæ§åˆ¶å°å½“ä½œè®¡ç®—å™¨ä½¿ç”¨ã€‚å½“ä½ åœ¨Chromeæ§åˆ¶å°é‡Œè¿›è¡Œè®¡ç®—æ—¶ï¼Œå¯ä»¥é€šè¿‡$_æ¥è·å–æœ€åçš„è®¡ç®—ç»“æœå€¼ï¼Œè¿˜æ˜¯ç›´æ¥çœ‹ä¾‹å­å§ï¼š 12345678910111213142+3+49 //- The Answer of the SUM is 9$_9 // Gives the last Result$_ * $_81 // As the last Result was 9Math.sqrt($_)9 // As the last Result was 81$_9 // As the Last Result is 9 10.æ¸…ç©ºæ§åˆ¶å°è¾“å‡ºå½“ä½ éœ€è¦è¿™ä¹ˆåšçš„æ—¶å€™ï¼Œåªéœ€è¦è¾“å…¥ clear() ç„¶åå›è½¦å°±å¥½å•¦ï¼ Chromeå¼€å‘è€…å·¥å…·çš„å¼ºå¤§è¿œè¿œè¶…å‡ºä½ çš„æƒ³è±¡ï¼è¿™åªæ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†å°æŠ€å·§è€Œå·²ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åˆ°ä½ ï¼ å‚è€ƒèµ„æ–™ CHROMEå¼€å‘è€…å·¥å…·çš„å°æŠ€å·§ - CoolShell","categories":[],"tags":[{"name":"WebDevelopment","slug":"WebDevelopment","permalink":"http://github.com/tags/WebDevelopment/"}],"keywords":[]},{"title":"ã€Androidã€‘æŠ½è±¡å¸ƒå±€ â€” includeã€merge ã€ViewStub","slug":"ã€Androidã€‘æŠ½è±¡å¸ƒå±€ â€” includeã€merge ã€ViewStub","date":"2016-09-19T03:47:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/09/19/ã€Androidã€‘æŠ½è±¡å¸ƒå±€ â€” includeã€merge ã€ViewStub/","link":"","permalink":"http://github.com/2016/09/19/ã€Androidã€‘æŠ½è±¡å¸ƒå±€ â€” includeã€merge ã€ViewStub/","excerpt":"åœ¨å¸ƒå±€ä¼˜åŒ–ä¸­ï¼ŒAndroiçš„å®˜æ–¹æåˆ°äº†è¿™ä¸‰ç§å¸ƒå±€&lt;include/&gt;ã€&lt;merge /&gt;ã€&lt;ViewStub /&gt;ï¼Œå¹¶ä»‹ç»äº†è¿™ä¸‰ç§å¸ƒå±€å„æœ‰çš„ä¼˜åŠ¿ï¼Œä¸‹é¢ä¹Ÿæ˜¯ç®€å•è¯´ä¸€ä¸‹ä»–ä»¬çš„ä¼˜åŠ¿ï¼Œä»¥åŠæ€ä¹ˆä½¿ç”¨ï¼Œè®°ä¸‹æ¥æƒå½“åšç¬”è®°ã€‚ ä¸€ã€å¸ƒå±€é‡ç”¨&lt;include/&gt;&lt;include /&gt;æ ‡ç­¾èƒ½å¤Ÿé‡ç”¨å¸ƒå±€æ–‡ä»¶ï¼Œç®€å•çš„ä½¿ç”¨å¦‚ä¸‹ï¼š 123456789101112131415&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:orientation=\"vertical\" android:layout_width=â€match_parentâ€ android:layout_height=â€match_parentâ€ android:background=\"@color/app_bg\" android:gravity=\"center_horizontal\"&gt; &lt;include layout=\"@layout/titlebar\"/&gt; &lt;TextView android:layout_width=â€match_parentâ€ android:layout_height=\"wrap_content\" android:text=\"@string/hello\" android:padding=\"10dp\" /&gt; &lt;/LinearLayout&gt;","text":"åœ¨å¸ƒå±€ä¼˜åŒ–ä¸­ï¼ŒAndroiçš„å®˜æ–¹æåˆ°äº†è¿™ä¸‰ç§å¸ƒå±€&lt;include/&gt;ã€&lt;merge /&gt;ã€&lt;ViewStub /&gt;ï¼Œå¹¶ä»‹ç»äº†è¿™ä¸‰ç§å¸ƒå±€å„æœ‰çš„ä¼˜åŠ¿ï¼Œä¸‹é¢ä¹Ÿæ˜¯ç®€å•è¯´ä¸€ä¸‹ä»–ä»¬çš„ä¼˜åŠ¿ï¼Œä»¥åŠæ€ä¹ˆä½¿ç”¨ï¼Œè®°ä¸‹æ¥æƒå½“åšç¬”è®°ã€‚ ä¸€ã€å¸ƒå±€é‡ç”¨&lt;include/&gt;&lt;include /&gt;æ ‡ç­¾èƒ½å¤Ÿé‡ç”¨å¸ƒå±€æ–‡ä»¶ï¼Œç®€å•çš„ä½¿ç”¨å¦‚ä¸‹ï¼š 123456789101112131415&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:orientation=\"vertical\" android:layout_width=â€match_parentâ€ android:layout_height=â€match_parentâ€ android:background=\"@color/app_bg\" android:gravity=\"center_horizontal\"&gt; &lt;include layout=\"@layout/titlebar\"/&gt; &lt;TextView android:layout_width=â€match_parentâ€ android:layout_height=\"wrap_content\" android:text=\"@string/hello\" android:padding=\"10dp\" /&gt; &lt;/LinearLayout&gt; 1) &lt;include /&gt;æ ‡ç­¾å¿…é¡»ä½¿ç”¨å•ç‹¬çš„layoutå±æ€§ã€‚ 2) å¯ä»¥ä½¿ç”¨å…¶ä»–å±æ€§ã€‚&lt;include /&gt;æ ‡ç­¾è‹¥æŒ‡å®šäº†IDå±æ€§ï¼Œè€Œä½ çš„layoutä¹Ÿå®šä¹‰äº†IDï¼Œåˆ™ä½ çš„layoutçš„IDä¼šè¢«è¦†ç›–ã€‚ 3) åœ¨includeæ ‡ç­¾ä¸­æ‰€æœ‰çš„android:layout_*éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå‰ææ˜¯å¿…é¡»è¦å†™layout_widthå’Œlayout_heightä¸¤ä¸ªå±æ€§ã€‚ 4) å¸ƒå±€ä¸­å¯ä»¥åŒ…å«ä¸¤ä¸ªç›¸åŒçš„includeæ ‡ç­¾ï¼Œå¼•ç”¨æ—¶å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•è§£å†³ æ¯”å¦‚è¿™ä¸ªå¸ƒå±€æ–‡ä»¶ï¼š123456789101112131415161718192021222324252627282930313233&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;ScrollView xmlns:android=\"http://schemas.android.com/apk/res/android\"android:layout_width=\"fill_parent\"android:layout_height=\"fill_parent\"android:scrollbars=\"vertical\" &gt; &lt;LinearLayout android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" android:focusable=\"true\" android:focusableInTouchMode=\"true\" android:orientation=\"vertical\" android:padding=\"10dip\" &gt; &lt;include android:id=\"@+id/discovered_servers\" layout=\"@layout/discovered_servers_element\" /&gt; &lt;include android:id=\"@+id/bookmarks\" layout=\"@layout/bookmarks_element\" /&gt; //æ³¨æ„ä»¥ä¸‹è¿™ä¸ªincludeå’Œä¸Šé¢çš„include &lt;include android:id=\"@+id/bookmarks_favourite\" layout=\"@layout/bookmarks_element\" /&gt; &lt;include android:id=\"@+id/new_conn\" layout=\"@layout/new_conn_element\" /&gt; &lt;/LinearLayout&gt;&lt;/ScrollView&gt; è¿™é‡Œæˆ‘ä»¬includeäº†ä¸¤æ¬¡res/layout/bookmarks_element.xmlï¼Œè¿™ä¸ªå­å¸ƒå±€å†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415161718192021&lt;!-- res/layout/bookmarks_element.xml å¸ƒå±€ --&gt;&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;merge xmlns:android=\"http://schemas.android.com/apk/res/android\" &gt; &lt;TextView android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" android:paddingBottom=\"10dip\" android:paddingTop=\"10dip\" android:text=\"@string/bookmarks\" android:textAppearance=\"?android:attr/textAppearanceLarge\" /&gt; &lt;LinearLayout android:id=\"@+id/bookmarks_list\" android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" android:orientation=\"vertical\" android:padding=\"10dip\" /&gt;&lt;/merge&gt; å¦‚æœå‘ä¸‹é¢è¿™æ ·è°ƒç”¨æ˜¯é”™çš„ï¼Œ 1LinearLayout fav_bookmarks = findViewById(R.id.bookmarks_list); // WRONG!!!! æ­£ç¡®çš„æ–¹æ³•æ˜¯è¿™æ ·ï¼š 123View bookmarks_container_2 = findViewById(R.id.bookmarks_favourite); bookmarks_container_2.findViewById(R.id.bookmarks_list); äºŒã€å‡å°‘è§†å›¾å±‚çº§&lt;merge/&gt;&lt;merge /&gt;æ ‡ç­¾ç”¨äºå‡å°‘Viewæ ‘çš„å±‚æ¬¡æ¥ä¼˜åŒ–Androidçš„å¸ƒå±€ã€‚å…ˆæ¥ç”¨ä¸ªä¾‹å­æ¼”ç¤ºä¸€ä¸‹ï¼š é¦–å…ˆä¸»éœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶activity_main.xml 1234567891011&lt;RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" &gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:text=\"mergeæ ‡ç­¾ä½¿ç”¨\" /&gt;&lt;/RelativeLayout&gt; å†æ¥ä¸€ä¸ªæœ€ç®€å•çš„Activityï¼Œæ–‡ä»¶åMainActivity.java 12345678910111213package com.example.merge;import android.app.Activity;import android.os.Bundle;public class MainActivity extends Activity &#123; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); &#125;&#125; æŒ‰ç€ä¸Šé¢çš„ä»£ç åˆ›å»ºå·¥ç¨‹ï¼Œè¿è¡Œåä½¿ç”¨â€œDDMS -&gt; Dump View Hierarchy for UI Automatorâ€å·¥å…·ï¼Œæˆªå›¾å¦‚ä¸‹: merge ä½¿ç”¨å‰ï¼š æœ€ä¸‹é¢ä¸¤å±‚RelativeLayoutä¸TextViewå°±æ˜¯ activity_main.xml å¸ƒå±€ä¸­çš„å†…å®¹ï¼Œä¸Šé¢çš„FrameLayoutæ˜¯Activity setContentViewæ·»åŠ çš„é¡¶å±‚è§†å›¾ã€‚ä¸‹é¢ä½¿ç”¨mergeæ ‡ç­¾å¯ä»¥æŸ¥çœ‹ä¸‹åŒºåˆ«ã€‚ å¸ƒå±€æ–‡ä»¶ activity_main.xml ä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š 1234567891011&lt;merge xmlns:android=\"http://schemas.android.com/apk/res/android\" xmlns:tools=\"http://schemas.android.com/tools\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" &gt; &lt;TextView android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\" android:text=\"mergeæ ‡ç­¾ä½¿ç”¨\" /&gt;&lt;/merge&gt; ä½¿ç”¨â€œDDMS -&gt; Dump View Hierarchy for UI Automatorâ€å·¥å…·ï¼Œæˆªå›¾å¦‚ä¸‹: merge ä½¿ç”¨å å¯ä»¥çœ‹åˆ°ï¼ŒFrameLayoutä¸‹é¢ç›´æ¥å°±æ˜¯TextViewï¼Œä¸ä¹‹å‰çš„ç›¸æ¯”å°‘äº†ä¸€å±‚ RelativeLayout è€Œå®ç°çš„æ•ˆæœç›¸åŒã€‚ é‚£ä¹ˆï¼Œä»€ä¹ˆæƒ…å†µè€ƒè™‘ä½¿ç”¨&lt;merge /&gt;æ ‡ç­¾ï¼Ÿ ä¸€ç§æ˜¯å‘ä¸Šé¢çš„ä¾‹å­ä¸€æ ·ï¼Œå­è§†å›¾ä¸éœ€è¦æŒ‡å®šä»»ä½•é’ˆå¯¹çˆ¶è§†å›¾çš„å¸ƒå±€å±æ€§ï¼Œä¾‹å­ä¸­TextViewä»…ä»…éœ€è¦ç›´æ¥æ·»åŠ åˆ°çˆ¶è§†å›¾ä¸Šç”¨äºæ˜¾ç¤ºå°±è¡Œã€‚ å¦å¤–ä¸€ç§æ˜¯å‡å¦‚éœ€è¦åœ¨LinearLayouté‡Œé¢åµŒå…¥ä¸€ä¸ªå¸ƒå±€ï¼ˆæˆ–è€…è§†å›¾ï¼‰ï¼Œè€Œæ°æ°è¿™ä¸ªå¸ƒå±€ï¼ˆæˆ–è€…è§†å›¾ï¼‰çš„æ ¹èŠ‚ç‚¹ä¹Ÿæ˜¯LinearLayoutï¼Œè¿™æ ·å°±å¤šäº†ä¸€å±‚æ²¡æœ‰ç”¨çš„åµŒå¥—ï¼Œæ— ç–‘è¿™æ ·åªä¼šæ‹–æ…¢ç¨‹åºé€Ÿåº¦ã€‚è€Œè¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬ä½¿ç”¨mergeæ ¹æ ‡ç­¾å°±å¯ä»¥é¿å…é‚£æ ·çš„é—®é¢˜ï¼Œå®˜æ–¹æ–‡æ¡£ Android Layout Tricks #3: Optimize by merging ä¸­çš„ä¾‹å­æ¼”ç¤ºçš„å°±æ˜¯è¿™ç§æƒ…å†µã€‚ &lt;merge /&gt;æ ‡ç­¾æœ‰ä»€ä¹ˆé™åˆ¶æ²¡ï¼Ÿ &lt;merge /&gt;åªèƒ½ä½œä¸ºXMLå¸ƒå±€çš„æ ¹æ ‡ç­¾ä½¿ç”¨ã€‚ å½“ Inflate ä»¥&lt;merge /&gt;å¼€å¤´çš„å¸ƒå±€æ–‡ä»¶æ—¶ï¼Œå¿…é¡»æŒ‡å®šä¸€ä¸ªçˆ¶ViewGroupï¼Œå¹¶ä¸”å¿…é¡»è®¾å®šattachToRootä¸ºtrueã€‚ ä¸‰ã€éœ€è¦æ—¶ä½¿ç”¨&lt;ViewStub /&gt;é™äºç¯‡å¹…ï¼Œè¿™é‡Œåªå¤§æ¦‚æ€»ç»“ä¸€ä¸‹ViewStubçš„ä½¿ç”¨æ–¹æ³•ï¼Œè¯¦ç»†ä»‹ç»å’Œä½¿ç”¨å†™åˆ°åé¢çš„æ–‡ç« ä¸­ã€‚ &lt;ViewStub /&gt;æ ‡ç­¾æœ€å¤§çš„ä¼˜ç‚¹æ˜¯å½“ä½ éœ€è¦æ—¶æ‰ä¼šåŠ è½½ï¼Œä½¿ç”¨ä»–å¹¶ä¸ä¼šå½±å“UIåˆå§‹åŒ–æ—¶çš„æ€§èƒ½ã€‚å„ç§ä¸å¸¸ç”¨çš„å¸ƒå±€æƒ³è¿›åº¦æ¡ã€æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ç­‰å¯ä»¥ä½¿ç”¨&lt;ViewStub /&gt;æ ‡ç­¾ï¼Œä»¥å‡å°‘å†…å­˜ä½¿ç”¨é‡ï¼ŒåŠ å¿«æ¸²æŸ“é€Ÿåº¦ã€‚&lt;ViewStub /&gt;æ˜¯ä¸€ä¸ªä¸å¯è§çš„ï¼Œå¤§å°ä¸º0çš„Viewã€‚&lt;ViewStub /&gt;æ ‡ç­¾ä½¿ç”¨å¦‚ä¸‹ï¼š 1234567&lt;ViewStub android:id=\"@+id/stub_import\" android:inflatedId=\"@+id/panel_import\" android:layout=\"@layout/progress_overlay\" android:layout_width=\"fill_parent\" android:layout_height=\"wrap_content\" android:layout_gravity=\"bottom\" /&gt; å½“ä½ æƒ³åŠ è½½å¸ƒå±€æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å…¶ä¸­ä¸€ç§æ–¹æ³•ï¼š 1((ViewStub) findViewById(R.id.stub_import)).setVisibility(View.VISIBLE); or 1View importPanel = ((ViewStub) findViewById(R.id.stub_import)).inflate(); å½“è°ƒç”¨inflate()å‡½æ•°çš„æ—¶å€™ï¼ŒViewStubè¢«å¼•ç”¨çš„èµ„æºæ›¿ä»£ï¼Œå¹¶ä¸”è¿”å›å¼•ç”¨çš„viewã€‚ è¿™æ ·ç¨‹åºå¯ä»¥ç›´æ¥å¾—åˆ°å¼•ç”¨çš„viewè€Œä¸ç”¨å†æ¬¡è°ƒç”¨å‡½æ•°findViewById()æ¥æŸ¥æ‰¾äº†ã€‚ æ³¨ï¼šViewStub ç›®å‰æœ‰ä¸ªç¼ºé™·å°±æ˜¯è¿˜ä¸æ”¯æŒ &lt;merge /&gt; æ ‡ç­¾ã€‚ æ›´å¤š&lt;ViewStub /&gt;æ ‡ç­¾ä»‹ç»å¯ä»¥å‚è€ƒå®˜ç½‘æ•™ç¨‹ã€ŠAndroid Layout Tricks #3: Optimize with stubsã€‹ ã€å‚è€ƒèµ„æ–™ã€‘ï¼š 1ã€AndroidæŠ½è±¡å¸ƒå±€ â€” includeã€merge ã€ViewStub2ã€Tech Stuff: Android &lt;include/&gt; layout pitfalls3ã€Android æ€§èƒ½ä¼˜åŒ– å›› å¸ƒå±€ä¼˜åŒ–mergeæ ‡ç­¾çš„ä½¿ç”¨4ã€Androidä¹‹mergeå¸ƒå±€5ã€ Androidå®æˆ˜æŠ€å·§ï¼šViewStubçš„åº”ç”¨","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Javaã€‘è®¾è®¡æ¨¡å¼ï¼šæ·±å…¥ç†è§£å•ä¾‹æ¨¡å¼","slug":"ã€Javaã€‘è®¾è®¡æ¨¡å¼ï¼šæ·±å…¥ç†è§£å•ä¾‹æ¨¡å¼","date":"2016-09-08T06:18:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/09/08/ã€Javaã€‘è®¾è®¡æ¨¡å¼ï¼šæ·±å…¥ç†è§£å•ä¾‹æ¨¡å¼/","link":"","permalink":"http://github.com/2016/09/08/ã€Javaã€‘è®¾è®¡æ¨¡å¼ï¼šæ·±å…¥ç†è§£å•ä¾‹æ¨¡å¼/","excerpt":"ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿç®€å•çš„ç†è§£å°±æ˜¯å‰äººç•™ä¸‹æ¥çš„ä¸€äº›ç»éªŒæ€»ç»“è€Œå·²ï¼Œç„¶åæŠŠè¿™äº›ç»éªŒèµ·äº†ä¸ªåå­—å«Design Patternï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯è®¾è®¡æ¨¡å¼ï¼Œé€šè¿‡ä½¿ç”¨è®¾è®¡æ¨¡å¼å¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç å¤ç”¨æ€§æ›´é«˜ï¼Œå¯ç»´æŠ¤æ€§æ›´é«˜ï¼Œè®©ä½ çš„ä»£ç å†™çš„æ›´ä¼˜é›…ã€‚è®¾è®¡æ¨¡å¼ç†è®ºä¸Šæœ‰23ç§ï¼Œä»Šå¤©å°±å…ˆæ¥åˆ†äº«ä¸‹æœ€å¸¸ç”¨çš„å•ä¾‹æ¨¡å¼ã€‚ å¼•è¨€å¯¹äºå•ä¾‹æ¨¡å¼ï¼Œæœ‰å·¥ä½œç»éªŒçš„äººåŸºæœ¬ä¸Šéƒ½ä½¿ç”¨è¿‡ã€‚é¢è¯•çš„æ—¶å€™æåˆ°è®¾è®¡æ¨¡å¼åŸºæœ¬ä¸Šéƒ½ä¼šæåˆ°å•ä¾‹æ¨¡å¼ï¼Œä½†æ˜¯å¾ˆå¤šäººå¯¹å•ä¾‹æ¨¡å¼ä¹Ÿæ˜¯ä¸€çŸ¥åŠè§£ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬æˆ‘å“ˆå“ˆå“ˆ=_=ã€‚æ‰€ä»¥æˆ‘ä»¬æœ‰å¿…è¦æ·±å…¥ç†è§£ä¸€ä¸‹æ‰€è°“çš„ã€Œå•ä¾‹æ¨¡å¼ã€ã€‚ å•ä¾‹æ¨¡å¼å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚ å•ä¾‹æ¨¡å¼ç»“æ„å›¾ï¼š ä½¿ç”¨å•ä¾‹çš„ä¼˜ç‚¹ï¼š å•ä¾‹ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ å…±äº«èµ„æºï¼Œå…¨å±€ä½¿ç”¨ èŠ‚çœåˆ›å»ºæ—¶é—´ï¼Œæé«˜æ€§èƒ½","text":"ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿç®€å•çš„ç†è§£å°±æ˜¯å‰äººç•™ä¸‹æ¥çš„ä¸€äº›ç»éªŒæ€»ç»“è€Œå·²ï¼Œç„¶åæŠŠè¿™äº›ç»éªŒèµ·äº†ä¸ªåå­—å«Design Patternï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯è®¾è®¡æ¨¡å¼ï¼Œé€šè¿‡ä½¿ç”¨è®¾è®¡æ¨¡å¼å¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç å¤ç”¨æ€§æ›´é«˜ï¼Œå¯ç»´æŠ¤æ€§æ›´é«˜ï¼Œè®©ä½ çš„ä»£ç å†™çš„æ›´ä¼˜é›…ã€‚è®¾è®¡æ¨¡å¼ç†è®ºä¸Šæœ‰23ç§ï¼Œä»Šå¤©å°±å…ˆæ¥åˆ†äº«ä¸‹æœ€å¸¸ç”¨çš„å•ä¾‹æ¨¡å¼ã€‚ å¼•è¨€å¯¹äºå•ä¾‹æ¨¡å¼ï¼Œæœ‰å·¥ä½œç»éªŒçš„äººåŸºæœ¬ä¸Šéƒ½ä½¿ç”¨è¿‡ã€‚é¢è¯•çš„æ—¶å€™æåˆ°è®¾è®¡æ¨¡å¼åŸºæœ¬ä¸Šéƒ½ä¼šæåˆ°å•ä¾‹æ¨¡å¼ï¼Œä½†æ˜¯å¾ˆå¤šäººå¯¹å•ä¾‹æ¨¡å¼ä¹Ÿæ˜¯ä¸€çŸ¥åŠè§£ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬æˆ‘å“ˆå“ˆå“ˆ=_=ã€‚æ‰€ä»¥æˆ‘ä»¬æœ‰å¿…è¦æ·±å…¥ç†è§£ä¸€ä¸‹æ‰€è°“çš„ã€Œå•ä¾‹æ¨¡å¼ã€ã€‚ å•ä¾‹æ¨¡å¼å®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚ å•ä¾‹æ¨¡å¼ç»“æ„å›¾ï¼š ä½¿ç”¨å•ä¾‹çš„ä¼˜ç‚¹ï¼š å•ä¾‹ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ å…±äº«èµ„æºï¼Œå…¨å±€ä½¿ç”¨ èŠ‚çœåˆ›å»ºæ—¶é—´ï¼Œæé«˜æ€§èƒ½ å®ƒçš„ä¸ƒç§å†™æ³•å•ä¾‹æ¨¡å¼æœ‰å¤šç§å†™æ³•å„æœ‰åˆ©å¼Šï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å„ç§æ¨¡å¼å†™æ³•ã€‚ 1ã€é¥¿æ±‰å¼12345678public class Singleton &#123; private static Singleton instance = new Singleton(); private Singleton ()&#123; &#125; public static Singleton getInstance() &#123; return instance; &#125; &#125; è¿™ç§æ–¹å¼å’Œåå­—å¾ˆè´´åˆ‡ï¼Œé¥¥ä¸æ‹©é£Ÿï¼Œåœ¨ç±»è£…è½½çš„æ—¶å€™å°±åˆ›å»ºï¼Œä¸ç®¡ä½ ç”¨ä¸ç”¨ï¼Œå…ˆåˆ›å»ºäº†å†è¯´ï¼Œå¦‚æœä¸€ç›´æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œä¾¿æµªè´¹äº†ç©ºé—´ï¼Œå…¸å‹çš„ç©ºé—´æ¢æ—¶é—´ï¼Œæ¯æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦å†åˆ¤æ–­ï¼ŒèŠ‚çœäº†è¿è¡Œæ—¶é—´ã€‚ Java Runtimeå°±æ˜¯ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå®ƒçš„æºä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920public class Runtime &#123; private static Runtime currentRuntime = new Runtime(); /** * Returns the runtime object associated with the current Java application. * Most of the methods of class &lt;code&gt;Runtime&lt;/code&gt; are instance * methods and must be invoked with respect to the current runtime object. * * @return the &lt;code&gt;Runtime&lt;/code&gt; object associated with the current * Java application. */ public static Runtime getRuntime() &#123; return currentRuntime; &#125; /** Don't let anyone else instantiate this class */ private Runtime() &#123;&#125; //ä»¥ä¸‹ä»£ç çœç•¥&#125; æ€»ç»“ï¼šã€Œé¥¿æ±‰å¼ã€æ˜¯æœ€ç®€å•çš„å®ç°æ–¹å¼ï¼Œè¿™ç§å®ç°æ–¹å¼é€‚åˆé‚£äº›åœ¨åˆå§‹åŒ–æ—¶å°±è¦ç”¨åˆ°å•ä¾‹çš„æƒ…å†µï¼Œè¿™ç§æ–¹å¼ç®€å•ç²—æš´ï¼Œå¦‚æœå•ä¾‹å¯¹è±¡åˆå§‹åŒ–éå¸¸å¿«ï¼Œè€Œä¸”å ç”¨å†…å­˜éå¸¸å°çš„æ—¶å€™è¿™ç§æ–¹å¼æ˜¯æ¯”è¾ƒåˆé€‚çš„ï¼Œå¯ä»¥ç›´æ¥åœ¨åº”ç”¨å¯åŠ¨æ—¶åŠ è½½å¹¶åˆå§‹åŒ–ã€‚ ä½†æ˜¯ï¼Œå¦‚æœå•ä¾‹åˆå§‹åŒ–çš„æ“ä½œè€—æ—¶æ¯”è¾ƒé•¿è€Œåº”ç”¨å¯¹äºå¯åŠ¨é€Ÿåº¦åˆæœ‰è¦æ±‚ï¼Œæˆ–è€…å•ä¾‹çš„å ç”¨å†…å­˜æ¯”è¾ƒå¤§ï¼Œå†æˆ–è€…å•ä¾‹åªæ˜¯åœ¨æŸä¸ªç‰¹å®šåœºæ™¯çš„æƒ…å†µä¸‹æ‰ä¼šè¢«ä½¿ç”¨ï¼Œè€Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä¸ä¼šä½¿ç”¨æ—¶ï¼Œä½¿ç”¨ã€Œé¥¿æ±‰å¼ã€çš„å•ä¾‹æ¨¡å¼å°±æ˜¯ä¸åˆé€‚çš„ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°ã€Œæ‡’æ±‰å¼ã€çš„æ–¹å¼å»æŒ‰éœ€å»¶è¿ŸåŠ è½½å•ä¾‹ã€‚ 2ã€æ‡’æ±‰å¼ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰1234567891011public class Singleton &#123; private static Singleton instance; private Singleton ()&#123; &#125; public static Singleton getInstance() &#123; if (instance == null) &#123; instance = new Singleton(); &#125; return instance; &#125; &#125; æ‡’æ±‰æ¨¡å¼ç”³æ˜äº†ä¸€ä¸ªé™æ€å¯¹è±¡ï¼Œåœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶åˆå§‹åŒ–ï¼Œè™½ç„¶èŠ‚çº¦äº†èµ„æºï¼Œä½†ç¬¬ä¸€æ¬¡åŠ è½½æ—¶éœ€è¦å®ä¾‹åŒ–ï¼Œåæ˜ ç¨æ…¢ä¸€äº›ï¼Œè€Œä¸”åœ¨å¤šçº¿ç¨‹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚åœ¨å¤šçº¿ç¨‹è®¿é—®çš„æ—¶å€™ï¼Œå¾ˆå¯èƒ½ä¼šé€ æˆå¤šæ¬¡å®ä¾‹åŒ–ï¼Œå°±ä¸å†æ˜¯å•ä¾‹äº†ã€‚ ã€Œæ‡’æ±‰å¼ã€ä¸ã€Œé¥¿æ±‰å¼ã€çš„æœ€å¤§åŒºåˆ«å°±æ˜¯å°†å•ä¾‹çš„åˆå§‹åŒ–æ“ä½œï¼Œå»¶è¿Ÿåˆ°éœ€è¦çš„æ—¶å€™æ‰è¿›è¡Œï¼Œè¿™æ ·åšåœ¨æŸäº›åœºåˆä¸­æœ‰å¾ˆå¤§ç”¨å¤„ã€‚æ¯”å¦‚æŸä¸ªå•ä¾‹ç”¨çš„æ¬¡æ•°ä¸æ˜¯å¾ˆå¤šï¼Œä½†æ˜¯è¿™ä¸ªå•ä¾‹æä¾›çš„åŠŸèƒ½åˆéå¸¸å¤æ‚ï¼Œè€Œä¸”åŠ è½½å’Œåˆå§‹åŒ–è¦æ¶ˆè€—å¤§é‡çš„èµ„æºï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨ã€Œæ‡’æ±‰å¼ã€å°±æ˜¯éå¸¸ä¸é”™çš„é€‰æ‹©ã€‚ 3ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰1234567891011public class Singleton &#123; private static Singleton instance; private Singleton ()&#123; &#125; public static synchronized Singleton getInstance() &#123; if (instance == null) &#123; instance = new Singleton(); &#125; return instance; &#125; &#125; è¿™ä¸¤ç§ã€Œæ‡’æ±‰å¼ã€å•ä¾‹ï¼Œåå­—èµ·çš„ä¹Ÿå¾ˆè´´åˆ‡ï¼Œä¸€ç›´ç­‰åˆ°å¯¹è±¡å®ä¾‹åŒ–çš„æ—¶å€™æ‰ä¼šåˆ›å»ºï¼Œç¡®å®å¤Ÿæ‡’ï¼Œä¸ç”¨é­å­æŠ½å°±ä¸çŸ¥é“èµ°äº†ï¼Œå…¸å‹çš„æ—¶é—´æ¢ç©ºé—´ï¼Œæ¯æ¬¡è·å–å®ä¾‹çš„æ—¶å€™æ‰ä¼šåˆ¤æ–­ï¼Œçœ‹æ˜¯å¦éœ€è¦åˆ›å»ºï¼Œæµªè´¹åˆ¤æ–­æ—¶é—´ï¼Œå¦‚æœä¸€ç›´æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œå°±ä¸ä¼šè¢«åˆ›å»ºï¼ŒèŠ‚çœç©ºé—´ã€‚ å› ä¸ºè¿™ç§æ–¹å¼åœ¨getInstance()æ–¹æ³•ä¸ŠåŠ äº†åŒæ­¥é”ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ä¼šé€ æˆçº¿ç¨‹é˜»å¡ï¼ŒæŠŠå¤§é‡çš„çº¿ç¨‹é”åœ¨å¤–é¢ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªçº¿ç¨‹ã€‚ Androidä¸­çš„ InputMethodManager ä½¿ç”¨äº†è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒçš„æºç ï¼š 1234567891011121314151617181920public final class InputMethodManager &#123; static InputMethodManager sInstance; /** * Retrieve the global InputMethodManager instance, creating it if it * doesn't already exist. * @hide */ public static InputMethodManager getInstance() &#123; synchronized (InputMethodManager.class) &#123; if (sInstance == null) &#123; IBinder b = ServiceManager.getService(Context.INPUT_METHOD_SERVICE); IInputMethodManager service = IInputMethodManager.Stub.asInterface(b); sInstance = new InputMethodManager(service, Looper.getMainLooper()); &#125; return sInstance; &#125; &#125;&#125; 4ã€åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼‰ä¸Šé¢çš„æ–¹æ³•ã€Œæ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ã€æ¯«æ— ç–‘é—®å­˜åœ¨æ€§èƒ½çš„é—®é¢˜ â€” å¦‚æœå­˜åœ¨å¾ˆå¤šæ¬¡getInstance()çš„è°ƒç”¨ï¼Œé‚£æ€§èƒ½é—®é¢˜å°±ä¸å¾—ä¸è€ƒè™‘äº†ï¼ è®©æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œç©¶ç«Ÿæ˜¯æ•´ä¸ªæ–¹æ³•éƒ½å¿…é¡»åŠ é”ï¼Œè¿˜æ˜¯ä»…ä»…å…¶ä¸­æŸä¸€å¥åŠ é”å°±è¶³å¤Ÿäº†ï¼Ÿæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åŠ é”å‘¢ï¼Ÿåˆ†æä¸€ä¸‹å‡ºç°lazy loadedçš„é‚£ç§æƒ…å½¢çš„åŸå› ã€‚åŸå› å°±æ˜¯æ£€æµ‹nullçš„æ“ä½œå’Œåˆ›å»ºå¯¹è±¡çš„æ“ä½œåˆ†ç¦»äº†ã€‚å¦‚æœè¿™ä¸¤ä¸ªæ“ä½œèƒ½å¤ŸåŸå­åœ°è¿›è¡Œï¼Œé‚£ä¹ˆå•ä¾‹å°±å·²ç»ä¿è¯äº†ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¼€å§‹ä¿®æ”¹ä»£ç ï¼Œå°±æˆäº†ä¸‹é¢çš„åŒé‡æ ¡éªŒé”ï¼ˆDouble Check Lockï¼‰ï¼š 123456789101112131415161718192021public class Singleton &#123; /** * æ³¨æ„æ­¤å¤„ä½¿ç”¨çš„å…³é”®å­— volatileï¼Œ * è¢«volatileä¿®é¥°çš„å˜é‡çš„å€¼ï¼Œå°†ä¸ä¼šè¢«æœ¬åœ°çº¿ç¨‹ç¼“å­˜ï¼Œ * æ‰€æœ‰å¯¹è¯¥å˜é‡çš„è¯»å†™éƒ½æ˜¯ç›´æ¥æ“ä½œå…±äº«å†…å­˜ï¼Œä»è€Œç¡®ä¿å¤šä¸ªçº¿ç¨‹èƒ½æ­£ç¡®çš„å¤„ç†è¯¥å˜é‡ã€‚ */ private volatile static Singleton singleton; private Singleton() &#123; &#125; public static Singleton getInstance() &#123; if (instance == null) &#123; synchronized(Singleton.class) &#123; if (instance == null) &#123; instance = new Singleton(); &#125; &#125; &#125; return singleton; &#125;&#125; è¿™ç§å†™æ³•åœ¨getSingleton()æ–¹æ³•ä¸­å¯¹singletonè¿›è¡Œäº†ä¸¤æ¬¡åˆ¤ç©ºï¼Œç¬¬ä¸€æ¬¡æ˜¯ä¸ºäº†ä¸å¿…è¦çš„åŒæ­¥ï¼Œç¬¬äºŒæ¬¡æ˜¯åœ¨singletonç­‰äºnullçš„æƒ…å†µä¸‹æ‰åˆ›å»ºå®ä¾‹ã€‚åœ¨è¿™é‡Œç”¨åˆ°äº†volatileå…³é”®å­—ï¼Œä¸äº†è§£volatileå…³é”®å­—çš„å¯ä»¥æŸ¥çœ‹ Javaå¤šçº¿ç¨‹ï¼ˆä¸‰ï¼‰volatileåŸŸ å’Œ javaä¸­volatileå…³é”®å­—çš„å«ä¹‰ ä¸¤ç¯‡æ–‡ç« ï¼Œå¯ä»¥çœ‹åˆ°åŒé‡æ£€æŸ¥æ¨¡å¼æ˜¯æ­£ç¡®ä½¿ç”¨volatileå…³é”®å­—çš„åœºæ™¯ä¹‹ä¸€ã€‚ ã€ŒåŒé‡æ ¡éªŒé”ã€ï¼šæ—¢å¯ä»¥è¾¾åˆ°çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿå¯ä»¥ä½¿æ€§èƒ½ä¸å—å¾ˆå¤§çš„å½±å“ï¼Œæ¢å¥è¯è¯´åœ¨ä¿è¯çº¿ç¨‹å®‰å…¨çš„å‰æä¸‹ï¼Œæ—¢èŠ‚çœç©ºé—´ä¹ŸèŠ‚çœäº†æ—¶é—´ï¼Œé›†åˆäº†ã€Œé¥¿æ±‰å¼ã€å’Œä¸¤ç§ã€Œæ‡’æ±‰å¼ã€çš„ä¼˜ç‚¹ï¼Œå–å…¶ç²¾åï¼Œå»å…¶æ§½ç²•ã€‚ å¯¹äºvolatileå…³é”®å­—ï¼Œè¿˜æ˜¯å­˜åœ¨å¾ˆå¤šäº‰è®®çš„ã€‚ç”±äºvolatileå…³é”®å­—å¯èƒ½ä¼šå±è”½æ‰è™šæ‹Ÿæœºä¸­ä¸€äº›å¿…è¦çš„ä»£ç ä¼˜åŒ–ï¼Œæ‰€ä»¥è¿è¡Œæ•ˆç‡å¹¶ä¸æ˜¯å¾ˆé«˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶å¯ä»¥ä½¿ç”¨â€œåŒé‡æ£€æŸ¥åŠ é”â€æœºåˆ¶æ¥å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹ï¼Œä½†å¹¶ä¸å»ºè®®å¤§é‡é‡‡ç”¨ï¼Œå¯ä»¥æ ¹æ®æƒ…å†µæ¥é€‰ç”¨ã€‚ è¿˜æœ‰å°±æ˜¯åœ¨java1.4åŠä»¥å‰ç‰ˆæœ¬ä¸­ï¼Œå¾ˆå¤šJVMå¯¹äºvolatileå…³é”®å­—çš„å®ç°çš„é—®é¢˜ï¼Œä¼šå¯¼è‡´â€œåŒé‡æ£€æŸ¥åŠ é”â€çš„å¤±è´¥ï¼Œå› æ­¤â€œåŒé‡æ£€æŸ¥åŠ é”â€æœºåˆ¶åªåªèƒ½ç”¨åœ¨java1.5åŠä»¥ä¸Šçš„ç‰ˆæœ¬ã€‚ 5ã€é™æ€å†…éƒ¨ç±»å¦å¤–ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹JVMå·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†åŒæ­¥æ§åˆ¶ï¼Œæ¯”å¦‚ï¼š åœ¨static {...}åŒºå—ä¸­åˆå§‹åŒ–çš„æ•°æ® è®¿é—®finalå­—æ®µæ—¶ å› ä¸ºåœ¨JVMè¿›è¡Œç±»åŠ è½½çš„æ—¶å€™ä»–ä¼šä¿è¯æ•°æ®æ˜¯åŒæ­¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å®ç°ï¼šé‡‡ç”¨å†…éƒ¨ç±»ï¼Œåœ¨è¿™ä¸ªå†…éƒ¨ç±»é‡Œé¢å»åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚è¿™æ ·çš„è¯ï¼Œåªè¦åº”ç”¨ä¸­ä¸ä½¿ç”¨å†…éƒ¨ç±» JVM å°±ä¸ä¼šå»åŠ è½½è¿™ä¸ªå•ä¾‹ç±»ï¼Œä¹Ÿå°±ä¸ä¼šåˆ›å»ºå•ä¾‹å¯¹è±¡ï¼Œä»è€Œå®ç°ã€Œæ‡’æ±‰å¼ã€çš„å»¶è¿ŸåŠ è½½å’Œçº¿ç¨‹å®‰å…¨ã€‚ 12345678910public class Singleton &#123; private Singleton()&#123; &#125; public static Singleton getInstance()&#123; return SingletonHolder.sInstance; &#125; private static class SingletonHolder &#123; private static final Singleton sInstance = new Singleton(); &#125; &#125; ç¬¬ä¸€æ¬¡åŠ è½½Singletonç±»æ—¶å¹¶ä¸ä¼šåˆå§‹åŒ–sInstanceï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceæ–¹æ³•æ—¶è™šæ‹ŸæœºåŠ è½½SingletonHolder å¹¶åˆå§‹åŒ–sInstance ï¼Œè¿™æ ·ä¸ä»…èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨ä¹Ÿèƒ½ä¿è¯Singletonç±»çš„å”¯ä¸€æ€§ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼ã€‚ ç„¶è€Œè¿™è¿˜ä¸æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œã€ŠEffective Javaã€‹ä¸­ä½œè€…æ¨èäº†ä¸€ç§æ›´ç®€æ´æ–¹ä¾¿çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±æ˜¯ä½¿ç”¨ã€Œæšä¸¾ã€ã€‚ 6ã€æšä¸¾ã€ŠJavaä¸æ¨¡å¼ã€‹ä¸­ï¼Œä½œè€…è¿™æ ·å†™é“ï¼Œä½¿ç”¨æšä¸¾æ¥å®ç°å•å®ä¾‹æ§åˆ¶ä¼šæ›´åŠ ç®€æ´ï¼Œè€Œä¸”æ— å¿åœ°æä¾›äº†åºåˆ—åŒ–æœºåˆ¶ï¼Œå¹¶ç”±JVMä»æ ¹æœ¬ä¸Šæä¾›ä¿éšœï¼Œç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ï¼Œæ˜¯æ›´ç®€æ´ã€é«˜æ•ˆã€å®‰å…¨çš„å®ç°å•ä¾‹çš„æ–¹å¼ã€‚ 12345678public enum Singleton &#123; //å®šä¹‰ä¸€ä¸ªæšä¸¾çš„å…ƒç´ ï¼Œå®ƒå°±æ˜¯ Singleton çš„ä¸€ä¸ªå®ä¾‹ INSTANCE; public void doSomeThing() &#123; // do something... &#125; &#125; ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 1234public static void main(String args[]) &#123; Singleton singleton = Singleton.instance; singleton.doSomeThing();&#125; æšä¸¾å•ä¾‹çš„ä¼˜ç‚¹å°±æ˜¯ç®€å•ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†åº”ç”¨å¼€å‘å¾ˆå°‘ç”¨æšä¸¾ï¼Œå¯è¯»æ€§å¹¶ä¸æ˜¯å¾ˆé«˜ï¼Œä¸å»ºè®®ç”¨ã€‚ 7. ä½¿ç”¨å®¹å™¨12345678910111213public class SingletonManager &#123; private static Map&lt;String, Object&gt; objMap = new HashMap&lt;String,Object&gt;(); private Singleton() &#123; &#125; public static void registerService(String key, Objectinstance) &#123; if (!objMap.containsKey(key) ) &#123; objMap.put(key, instance) ; &#125; &#125; public static ObjectgetService(String key) &#123; return objMap.get(key) ; &#125;&#125; è¿™ç§äº‹ç”¨SingletonManager å°†å¤šç§å•ä¾‹ç±»ç»Ÿä¸€ç®¡ç†ï¼Œåœ¨ä½¿ç”¨æ—¶æ ¹æ®keyè·å–å¯¹è±¡å¯¹åº”ç±»å‹çš„å¯¹è±¡ã€‚è¿™ç§æ–¹å¼ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç®¡ç†å¤šç§ç±»å‹çš„å•ä¾‹ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨æ—¶å¯ä»¥é€šè¿‡ç»Ÿä¸€çš„æ¥å£è¿›è¡Œè·å–æ“ä½œï¼Œé™ä½äº†ç”¨æˆ·çš„ä½¿ç”¨æˆæœ¬ï¼Œä¹Ÿå¯¹ç”¨æˆ·éšè—äº†å…·ä½“å®ç°ï¼Œé™ä½äº†è€¦åˆåº¦ã€‚ æ€»ç»“å¯¹äºä»¥ä¸Šä¸ƒç§å•ä¾‹ï¼Œåˆ†åˆ«æ˜¯ã€Œé¥¿æ±‰å¼ã€ã€ã€Œæ‡’æ±‰å¼(éçº¿ç¨‹å®‰å…¨)ã€ã€ã€Œæ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨)ã€ã€ã€ŒåŒé‡æ ¡éªŒé”ã€ã€ã€Œé™æ€å†…éƒ¨ç±»ã€ã€ã€Œæšä¸¾ã€å’Œã€Œå®¹å™¨ç±»ç®¡ç†ã€ã€‚å¾ˆå¤šæ—¶å€™å–å†³äººä¸ªäººçš„å–œå¥½ï¼Œè™½ç„¶åŒé‡æ£€æŸ¥æœ‰ä¸€å®šçš„å¼Šç«¯å’Œé—®é¢˜ï¼Œä½†æˆ‘å°±æ˜¯é’Ÿçˆ±åŒé‡æ£€æŸ¥ï¼Œè§‰å¾—è¿™ç§æ–¹å¼å¯è¯»æ€§é«˜ã€å®‰å…¨ã€ä¼˜é›…ï¼ˆä¸ªäººè§‚ç‚¹ï¼‰ã€‚æ‰€ä»¥ä»£ç é‡Œå¸¸å¸¸é»˜å†™è¿™æ ·çš„å•ä¾‹ï¼Œå†™çš„æ—¶å€™çœŸæ„Ÿè§‰è‡ªå·±æ˜¯ä¸ªä¼Ÿå¤§çš„å»ºç­‘å¸ˆå“ˆå“ˆå“ˆå“ˆï¼ˆçœŸä¸è¦è„¸(ï¿¢_ï¿¢)ï¼ˆé€ƒã€‚ ã€å‚è€ƒèµ„æ–™ã€‘ï¼š1ã€Androidè®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼2ã€ååˆ†é’Ÿè®¤è¯†å•ä¾‹æ¨¡å¼çš„å¤šç§å§¿åŠ¿3ã€è®¾è®¡æ¨¡å¼ï¼ˆäºŒï¼‰å•ä¾‹æ¨¡å¼çš„ä¸ƒç§å†™æ³•4ã€æ·±å…¥Javaå•ä¾‹æ¨¡å¼5ã€javaä¸­volatileå…³é”®å­—çš„å«ä¹‰","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"},{"name":"Design Pattern","slug":"Java/Design-Pattern","permalink":"http://github.com/categories/Java/Design-Pattern/"}],"tags":[{"name":"Design Pattern","slug":"Design-Pattern","permalink":"http://github.com/tags/Design-Pattern/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"},{"name":"Design Pattern","slug":"Java/Design-Pattern","permalink":"http://github.com/categories/Java/Design-Pattern/"}]},{"title":"ã€Goè¯­è¨€ã€‘åŸºæœ¬ç±»å‹æ’åºå’Œ slice æ’åº","slug":"ã€Goè¯­è¨€ã€‘åŸºæœ¬ç±»å‹æ’åºå’Œ slice æ’åº","date":"2016-09-07T08:36:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/09/07/ã€Goè¯­è¨€ã€‘åŸºæœ¬ç±»å‹æ’åºå’Œ slice æ’åº/","link":"","permalink":"http://github.com/2016/09/07/ã€Goè¯­è¨€ã€‘åŸºæœ¬ç±»å‹æ’åºå’Œ slice æ’åº/","excerpt":"Go æ˜¯é€šè¿‡ sort åŒ…æä¾›æ’åºå’Œæœç´¢ï¼Œå› ä¸º Go æš‚æ—¶ä¸æ”¯æŒæ³›å‹ï¼ˆå°†æ¥ä¹Ÿä¸å¥½è¯´æ”¯ä¸æ”¯æŒï¼‰ï¼Œæ‰€ä»¥ï¼ŒGo çš„ sort å’Œ search ä½¿ç”¨èµ·æ¥è·Ÿç±»å‹æ˜¯æœ‰å…³çš„ï¼Œæˆ–æ˜¯éœ€è¦åƒ c ä¸€æ ·å†™æ¯”è¾ƒå‡½æ•°ç­‰ï¼Œç¨å¾®æ˜¾å¾—ä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ å¼•è¨€ Go çš„æ’åºæ€è·¯å’Œ C å’Œ C++ æœ‰äº›å·®åˆ«ã€‚ C é»˜è®¤æ˜¯å¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œ C++ æ˜¯å¯¹ä¸€ä¸ªåºåˆ—è¿›è¡Œæ’åºï¼Œ Go åˆ™æ›´å®½æ³›ä¸€äº›ï¼Œå¾…æ’åºçš„å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼Œ è™½ç„¶å¾ˆå¤šæƒ…å†µä¸‹æ˜¯ä¸€ä¸ª slice (åˆ†ç‰‡ï¼Œ ç±»ä¼¼äºæ•°ç»„)ï¼Œæˆ–æ˜¯åŒ…å« slice çš„ä¸€ä¸ªå¯¹è±¡ã€‚ æ’åº(æ¥å£)çš„ä¸‰ä¸ªè¦ç´ ï¼š å¾…æ’åºå…ƒç´ ä¸ªæ•° n ï¼› ç¬¬ i å’Œç¬¬ j ä¸ªå…ƒç´ çš„æ¯”è¾ƒå‡½æ•° cmp ï¼› ç¬¬ i å’Œ ç¬¬ j ä¸ªå…ƒç´ çš„äº¤æ¢ swap ï¼› ä¹ä¸€çœ‹æ¡ä»¶ 3 æ˜¯å¤šä½™çš„ï¼Œ c å’Œ c++ éƒ½ä¸æä¾› swap ã€‚ c çš„ qsort çš„ç”¨æ³•ï¼š qsort(data, n, sizeof(int), cmp_int); data æ˜¯èµ·å§‹åœ°å€ï¼Œ n æ˜¯å…ƒç´ ä¸ªæ•°ï¼Œ sizeof(int) æ˜¯æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œ cmp_int æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¸¤ä¸ª int çš„å‡½æ•°ã€‚ c++ çš„ sort çš„ç”¨æ³•ï¼š sort(data, data+n, cmp_int); data æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œ data+n æ˜¯æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œ cmp_int æ˜¯æ¯”è¾ƒå‡½æ•°ã€‚","text":"Go æ˜¯é€šè¿‡ sort åŒ…æä¾›æ’åºå’Œæœç´¢ï¼Œå› ä¸º Go æš‚æ—¶ä¸æ”¯æŒæ³›å‹ï¼ˆå°†æ¥ä¹Ÿä¸å¥½è¯´æ”¯ä¸æ”¯æŒï¼‰ï¼Œæ‰€ä»¥ï¼ŒGo çš„ sort å’Œ search ä½¿ç”¨èµ·æ¥è·Ÿç±»å‹æ˜¯æœ‰å…³çš„ï¼Œæˆ–æ˜¯éœ€è¦åƒ c ä¸€æ ·å†™æ¯”è¾ƒå‡½æ•°ç­‰ï¼Œç¨å¾®æ˜¾å¾—ä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ å¼•è¨€ Go çš„æ’åºæ€è·¯å’Œ C å’Œ C++ æœ‰äº›å·®åˆ«ã€‚ C é»˜è®¤æ˜¯å¯¹æ•°ç»„è¿›è¡Œæ’åºï¼Œ C++ æ˜¯å¯¹ä¸€ä¸ªåºåˆ—è¿›è¡Œæ’åºï¼Œ Go åˆ™æ›´å®½æ³›ä¸€äº›ï¼Œå¾…æ’åºçš„å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼Œ è™½ç„¶å¾ˆå¤šæƒ…å†µä¸‹æ˜¯ä¸€ä¸ª slice (åˆ†ç‰‡ï¼Œ ç±»ä¼¼äºæ•°ç»„)ï¼Œæˆ–æ˜¯åŒ…å« slice çš„ä¸€ä¸ªå¯¹è±¡ã€‚ æ’åº(æ¥å£)çš„ä¸‰ä¸ªè¦ç´ ï¼š å¾…æ’åºå…ƒç´ ä¸ªæ•° n ï¼› ç¬¬ i å’Œç¬¬ j ä¸ªå…ƒç´ çš„æ¯”è¾ƒå‡½æ•° cmp ï¼› ç¬¬ i å’Œ ç¬¬ j ä¸ªå…ƒç´ çš„äº¤æ¢ swap ï¼› ä¹ä¸€çœ‹æ¡ä»¶ 3 æ˜¯å¤šä½™çš„ï¼Œ c å’Œ c++ éƒ½ä¸æä¾› swap ã€‚ c çš„ qsort çš„ç”¨æ³•ï¼š qsort(data, n, sizeof(int), cmp_int); data æ˜¯èµ·å§‹åœ°å€ï¼Œ n æ˜¯å…ƒç´ ä¸ªæ•°ï¼Œ sizeof(int) æ˜¯æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼Œ cmp_int æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¸¤ä¸ª int çš„å‡½æ•°ã€‚ c++ çš„ sort çš„ç”¨æ³•ï¼š sort(data, data+n, cmp_int); data æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œ data+n æ˜¯æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œ cmp_int æ˜¯æ¯”è¾ƒå‡½æ•°ã€‚ åŸºæœ¬ç±»å‹æ’åº(intã€float64 å’Œ string)1ã€å‡åºæ’åºå¯¹äº int ã€ float64 å’Œ string æ•°ç»„æˆ–æ˜¯åˆ†ç‰‡çš„æ’åºï¼Œ go åˆ†åˆ«æä¾›äº† sort.Ints() ã€ sort.Float64s() å’Œ sort.Strings() å‡½æ•°ï¼Œ é»˜è®¤éƒ½æ˜¯ä»å°åˆ°å¤§æ’åºã€‚ 12345678910111213141516171819package main import ( \"fmt\" \"sort\") func main() &#123; intList := [] int &#123;2, 4, 3, 5, 7, 6, 9, 8, 1, 0&#125; float8List := [] float64 &#123;4.2, 5.9, 12.3, 10.0, 50.4, 99.9, 31.4, 27.81828, 3.14&#125; stringList := [] string &#123;\"a\", \"c\", \"b\", \"d\", \"f\", \"i\", \"z\", \"x\", \"w\", \"y\"&#125; sort.Ints(intList) sort.Float64s(float8List) sort.Strings(stringList) fmt.Printf(\"%v\\n%v\\n%v\\n\", intList, float8List, stringList) &#125; 2ã€é™åºæ’åºint ã€ float64 å’Œ string éƒ½æœ‰é»˜è®¤çš„å‡åºæ’åºå‡½æ•°ï¼Œ ç°åœ¨é—®é¢˜æ˜¯å¦‚æœé™åºå¦‚ä½• ï¼Ÿ æœ‰å…¶ä»–è¯­è¨€ç¼–ç¨‹ç»éªŒçš„äººéƒ½çŸ¥é“ï¼Œåªéœ€è¦äº¤æ¢ cmp çš„æ¯”è¾ƒæ³•åˆ™å°±å¯ä»¥äº†ï¼Œ go çš„å®ç°æ˜¯ç±»ä¼¼çš„ï¼Œç„¶è€Œåˆæœ‰æ‰€ä¸åŒã€‚ go ä¸­å¯¹æŸä¸ª Type çš„å¯¹è±¡ obj æ’åºï¼Œ å¯ä»¥ä½¿ç”¨ sort.Sort(obj) å³å¯ï¼Œå°±æ˜¯éœ€è¦å¯¹ Type ç±»å‹ç»‘å®šä¸‰ä¸ªæ–¹æ³• ï¼š Len() æ±‚é•¿åº¦ã€Less(i,j) æ¯”è¾ƒç¬¬ i å’Œ ç¬¬ j ä¸ªå…ƒç´ å¤§å°çš„å‡½æ•°ã€ Swap(i,j) äº¤æ¢ç¬¬ i å’Œç¬¬ j ä¸ªå…ƒç´ çš„å‡½æ•°ã€‚sort åŒ…ä¸‹çš„ä¸‰ä¸ªç±»å‹ IntSlice ã€ Float64Slice ã€ StringSlice åˆ†åˆ«å®ç°äº†è¿™ä¸‰ä¸ªæ–¹æ³•ï¼Œ å¯¹åº”æ’åºçš„æ˜¯ [] int ã€ [] float64 å’Œ [] string ã€‚å¦‚æœæœŸæœ›é€†åºæ’åºï¼Œ åªéœ€è¦å°†å¯¹åº”çš„ Less å‡½æ•°ç®€å•ä¿®æ”¹ä¸€ä¸‹å³å¯ã€‚ go çš„ sort åŒ…å¯ä»¥ä½¿ç”¨ sort.Reverse(slice) æ¥è°ƒæ¢ slice.Interface.Less ï¼Œä¹Ÿå°±æ˜¯æ¯”è¾ƒå‡½æ•°ï¼Œæ‰€ä»¥ï¼Œ int ã€ float64 å’Œ string çš„é€†åºæ’åºå‡½æ•°å¯ä»¥è¿™ä¹ˆå†™ï¼š 123456789101112131415161718package main import ( \"fmt\" \"sort\") func main() &#123; intList := [] int &#123;2, 4, 3, 5, 7, 6, 9, 8, 1, 0&#125; float8List := [] float64 &#123;4.2, 5.9, 12.3, 10.0, 50.4, 99.9, 31.4, 27.81828, 3.14&#125; stringList := [] string &#123;\"a\", \"c\", \"b\", \"d\", \"f\", \"i\", \"z\", \"x\", \"w\", \"y\"&#125; sort.Sort(sort.Reverse(sort.IntSlice(intList))) sort.Sort(sort.Reverse(sort.Float64Slice(float8List))) sort.Sort(sort.Reverse(sort.StringSlice(stringList))) fmt.Printf(\"%v\\n%v\\n%v\\n\", intList, float8List, stringList)&#125; 3ã€æ·±å…¥ç†è§£æ’åºsort åŒ…ä¸­æœ‰ä¸€ä¸ª sort.Interface æ¥å£ï¼Œè¯¥æ¥å£æœ‰ä¸‰ä¸ªæ–¹æ³• Len() ã€ Less(i,j) å’Œ Swap(i,j) ã€‚ é€šç”¨æ’åºå‡½æ•° sort.Sort å¯ä»¥æ’åºä»»ä½•å®ç°äº† sort.Inferface æ¥å£çš„å¯¹è±¡(å˜é‡)ã€‚å¯¹äº [] int ã€[] float64 å’Œ [] string é™¤äº†ä½¿ç”¨ç‰¹æ®ŠæŒ‡å®šçš„å‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ”¹è£…è¿‡çš„ç±»å‹ IntSclice ã€ Float64Slice å’Œ StringSlice ï¼Œ ç„¶åç›´æ¥è°ƒç”¨å®ƒä»¬å¯¹åº”çš„ Sort() æ–¹æ³•ï¼›å› ä¸ºè¿™ä¸‰ç§ç±»å‹ä¹Ÿå®ç°äº† sort.Interface æ¥å£ï¼Œ æ‰€ä»¥å¯ä»¥é€šè¿‡ sort.Reverse æ¥è½¬æ¢è¿™ä¸‰ç§ç±»å‹çš„ Interface.Less æ–¹æ³•æ¥å®ç°é€†å‘æ’åºï¼Œ è¿™å°±æ˜¯å‰é¢æœ€åä¸€ä¸ªæ’åºçš„ä½¿ç”¨ã€‚ ä¸‹é¢ä½¿ç”¨äº†ä¸€ä¸ªè‡ªå®šä¹‰(ç”¨æˆ·å®šä¹‰)çš„ Reverse ç»“æ„ä½“ï¼Œ è€Œä¸æ˜¯ sort.Reverse å‡½æ•°ï¼Œ æ¥å®ç°é€†å‘æ’åºã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849package main import ( \"fmt\" \"sort\") // è‡ªå®šä¹‰çš„ Reverse ç±»å‹type Reverse struct &#123; sort.Interface // è¿™æ ·ï¼ŒReverseå¯ä»¥æ¥çº³ä»»ä½•å®ç°äº†sort.Interfaceçš„å¯¹è±¡&#125; // Reverse åªæ˜¯å°†å…¶ä¸­çš„ Inferface.Less çš„é¡ºåºå¯¹è°ƒäº†ä¸€ä¸‹func (r Reverse) Less(i, j int) bool &#123; return r.Interface.Less(j, i)&#125; func main() &#123; ints := []int&#123;5, 2, 6, 3, 1, 4&#125; sort.Ints(ints) // ç‰¹æ®Šæ’åºå‡½æ•°ï¼Œå‡åº fmt.Println(\"after sort by Ints:\\t\", ints) doubles := []float64&#123;2.3, 3.2, 6.7, 10.9, 5.4, 1.8&#125; sort.Float64s(doubles) fmt.Println(\"after sort by Float64s:\\t\", doubles) // [1.8 2.3 3.2 5.4 6.7 10.9] strings := []string&#123;\"hello\", \"good\", \"students\", \"morning\", \"people\", \"world\"&#125; sort.Strings(strings) fmt.Println(\"after sort by Strings:\\t\", strings) // [good hello mornig people students world] ipos := sort.SearchInts(ints, -1) // int æœç´¢ fmt.Printf(\"pos of 5 is %d th\\n\", ipos) dpos := sort.SearchFloat64s(doubles, 20.1) // float64 æœç´¢ fmt.Printf(\"pos of 5.0 is %d th\\n\", dpos) fmt.Printf(\"doubles is asc ? %v\\n\", sort.Float64sAreSorted(doubles)) doubles = []float64&#123;3.5, 4.2, 8.9, 100.98, 20.14, 79.32&#125; // sort.Sort(sort.Float64Slice(doubles)) // float64 æ’åºæ–¹æ³• 2 // fmt.Println(\"after sort by Sort:\\t\", doubles) // [3.5 4.2 8.9 20.14 79.32 100.98] (sort.Float64Slice(doubles)).Sort() // float64 æ’åºæ–¹æ³• 3 fmt.Println(\"after sort by Sort:\\t\", doubles) // [3.5 4.2 8.9 20.14 79.32 100.98] sort.Sort(Reverse&#123;sort.Float64Slice(doubles)&#125;) // float64 é€†åºæ’åº fmt.Println(\"after sort by Reversed Sort:\\t\", doubles) // [100.98 79.32 20.14 8.9 4.2 3.5]&#125; sort.Ints / sort.Float64s / sort.Strings åˆ†åˆ«æ¥å¯¹æ•´å‹/æµ®ç‚¹å‹/å­—ç¬¦ä¸²å‹sliceè¿›è¡Œæ’åºã€‚ç„¶åæ˜¯æœ‰ä¸ªæµ‹è¯•æ˜¯å¦æœ‰åºçš„å‡½æ•°ã€‚è¿˜æœ‰åˆ†åˆ«å¯¹åº”çš„ search å‡½æ•°ï¼Œä¸è¿‡ï¼Œå‘ç°æœç´¢å‡½æ•°åªèƒ½å®šä½åˆ°å¦‚æœå­˜åœ¨çš„è¯çš„ä½ç½®ï¼Œä¸å­˜åœ¨çš„è¯ï¼Œä½ç½®æ˜¯ä¸å¯¹çš„ã€‚ å…³äºä¸€èˆ¬çš„æ•°ç»„æ’åºï¼Œç¨‹åºä¸­æ˜¾ç¤ºäº†ï¼Œæœ‰ 3 ç§æ–¹æ³•ï¼ç›®å‰æä¾›çš„ä¸‰ç§ç±»å‹ intï¼Œfloat64 å’Œ string å‘ˆç°å¯¹ç§°çš„ï¼Œä¹Ÿå°±æ˜¯ä½ æœ‰çš„ï¼Œå¯¹åº”çš„æˆ‘ä¹Ÿæœ‰ã€‚å…³äºç¿»è½¬æ’åºæˆ–æ˜¯é€†å‘æ’åºï¼Œå°±æ˜¯ç”¨ä¸ªç¿»è½¬ç»“æ„ä½“ï¼Œé‡å†™ Less() å‡½æ•°å³å¯ã€‚ä¸Šé¢çš„ Reverse æ˜¯ä¸ªé€šç”¨çš„ç»“æ„ä½“ã€‚ ä¸Šé¢è¯´äº†é‚£ä¹ˆå¤šï¼Œ åªæ˜¯å¯¹åŸºæœ¬ç±»å‹è¿›è¡Œæ’åºï¼Œ è¯¥åˆ°è¯´è¯´ struct ç»“æ„ä½“ç±»å‹çš„æ’åºçš„æ—¶å€™äº†ï¼Œ å®é™…ä¸­è¿™ä¸ªç”¨å¾—åˆ°çš„ä¼šæ›´å¤šã€‚ ç»“æ„ä½“ç±»å‹çš„æ’åºç»“æ„ä½“ç±»å‹çš„æ’åºæ˜¯é€šè¿‡ä½¿ç”¨ sort.Sort(slice) å®ç°çš„ï¼Œ åªè¦ slice å®ç°äº† sort.Interface çš„ä¸‰ä¸ªæ–¹æ³•å°±å¯ä»¥ã€‚ è™½ç„¶è¿™ä¹ˆè¯´ï¼Œä½†æ˜¯æ’åºçš„æ–¹æ³•å´æœ‰é‚£ä¹ˆå¥½å‡ ç§ã€‚é¦–å…ˆä¸€ç§å°±æ˜¯æ¨¡æ‹Ÿæ’åº [] int æ„é€ å¯¹åº”çš„ IntSlice ç±»å‹ï¼Œç„¶åå¯¹ IntSlice ç±»å‹å®ç° Interface çš„ä¸‰ä¸ªæ–¹æ³•ã€‚ 1ã€æ¨¡æ‹Ÿ IntSlice æ’åº123456789101112131415161718192021222324252627282930313233343536373839404142package main import ( \"fmt\" \"sort\") type Person struct &#123; Name string Age int&#125; // æŒ‰ç…§ Person.Age ä»å¤§åˆ°å°æ’åºtype PersonSlice [] Person func (a PersonSlice) Len() int &#123; // é‡å†™ Len() æ–¹æ³• return len(a)&#125;func (a PersonSlice) Swap(i, j int)&#123; // é‡å†™ Swap() æ–¹æ³• a[i], a[j] = a[j], a[i]&#125;func (a PersonSlice) Less(i, j int) bool &#123; // é‡å†™ Less() æ–¹æ³•ï¼Œ ä»å¤§åˆ°å°æ’åº return a[j].Age &lt; a[i].Age&#125; func main() &#123; people := [] Person&#123; &#123;\"zhang san\", 12&#125;, &#123;\"li si\", 30&#125;, &#123;\"wang wu\", 52&#125;, &#123;\"zhao liu\", 26&#125;, &#125; fmt.Println(people) sort.Sort(PersonSlice(people)) // æŒ‰ç…§ Age çš„é€†åºæ’åº fmt.Println(people) sort.Sort(sort.Reverse(PersonSlice(people))) // æŒ‰ç…§ Age çš„å‡åºæ’åº fmt.Println(people) &#125; è¿™å®Œå…¨æ˜¯ä¸€ç§æ¨¡æ‹Ÿçš„æ–¹å¼ï¼Œæ‰€ä»¥å¦‚æœæ‡‚äº† IntSlice è‡ªç„¶å°±ç†è§£è¿™é‡Œäº†ï¼Œåè¿‡æ¥ï¼Œç†è§£äº†è¿™é‡Œé‚£ä¹ˆ IntSlice é‚£é‡Œä¹Ÿå°±æ‡‚äº†ã€‚ è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼šæ ¹æ® Age æ’åºéœ€è¦é‡æ–°å®šä¹‰ PersonSlice æ–¹æ³•ï¼Œç»‘å®š Len ã€ Less å’Œ Swap æ–¹æ³•ï¼Œ å¦‚æœéœ€è¦æ ¹æ® Name æ’åºï¼Œ åˆéœ€è¦é‡æ–°å†™ä¸‰ä¸ªå‡½æ•°ï¼› å¦‚æœç»“æ„ä½“æœ‰ 4 ä¸ªå­—æ®µï¼Œæœ‰å››ç§ç±»å‹çš„æ’åºï¼Œé‚£ä¹ˆå°±è¦å†™ 3 Ã— 4 = 12 ä¸ªæ–¹æ³•ï¼Œ å³ä½¿æœ‰ä¸€äº›å®Œå…¨æ˜¯å¤šä½™çš„ï¼Œ O__Oâ€â€¦ ä»”ç»†æ€é‡ä¸€ä¸‹ï¼Œæ ¹æ®ä¸åŒçš„æ ‡å‡† Age æˆ–æ˜¯ Nameï¼Œ çœŸæ­£ä¸åŒçš„ä½“ç°åœ¨ Less æ–¹æ³•ä¸Šï¼Œæ‰€ä»¥å¯ä»¥å°† Less æŠ½è±¡å‡ºæ¥ï¼Œ æ¯ç§æ’åºçš„ Less è®©å…¶å˜æˆåŠ¨æ€çš„ï¼Œæ¯”å¦‚ä¸‹é¢ä¸€ç§æ–¹æ³•ã€‚ 2ã€å°è£…æˆ Wrapper12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849package main import ( \"fmt\" \"sort\") type Person struct &#123; Name string Age int&#125; type PersonWrapper struct &#123; //æ³¨æ„æ­¤å¤„ people [] Person by func(p, q * Person) bool&#125; func (pw PersonWrapper) Len() int &#123; // é‡å†™ Len() æ–¹æ³• return len(pw.people)&#125;func (pw PersonWrapper) Swap(i, j int)&#123; // é‡å†™ Swap() æ–¹æ³• pw.people[i], pw.people[j] = pw.people[j], pw.people[i]&#125;func (pw PersonWrapper) Less(i, j int) bool &#123; // é‡å†™ Less() æ–¹æ³• return pw.by(&amp;pw.people[i], &amp;pw.people[j])&#125; func main() &#123; people := [] Person&#123; &#123;\"zhang san\", 12&#125;, &#123;\"li si\", 30&#125;, &#123;\"wang wu\", 52&#125;, &#123;\"zhao liu\", 26&#125;, &#125; fmt.Println(people) sort.Sort(PersonWrapper&#123;people, func (p, q *Person) bool &#123; return q.Age &lt; p.Age // Age é€’å‡æ’åº &#125;&#125;) fmt.Println(people) sort.Sort(PersonWrapper&#123;people, func (p, q *Person) bool &#123; return p.Name &lt; q.Name // Name é€’å¢æ’åº &#125;&#125;) fmt.Println(people) &#125; è¿™ç§æ–¹æ³•å°† [] Person å’Œæ¯”è¾ƒçš„å‡†åˆ™ cmp å°è£…åœ¨äº†ä¸€èµ·ï¼Œå½¢æˆäº† PersonWrapper å‡½æ•°ï¼Œç„¶ååœ¨å…¶ä¸Šç»‘å®š Len ã€ Less å’Œ Swap æ–¹æ³•ã€‚ å®é™…ä¸Š sort.Sort(pw) æ’åºçš„æ˜¯ pw ä¸­çš„ peopleï¼Œ è¿™å°±æ˜¯å‰é¢è¯´çš„ï¼Œ go çš„æ’åºæœªå¿…å°±æ˜¯é’ˆå¯¹çš„ä¸€ä¸ªæ•°ç»„æˆ–æ˜¯ sliceï¼Œ è€Œå¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ä¸­çš„æ•°ç»„æˆ–æ˜¯ slice ã€‚ 3ã€è¿›ä¸€æ­¥å°è£…æ„Ÿè§‰æ–¹æ³• 2 å·²ç»å¾ˆä¸é”™äº†ï¼Œ å”¯ä¸€ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼Œåœ¨ main ä¸­ä½¿ç”¨çš„æ—¶å€™æš´éœ²äº† sort.Sort çš„ä½¿ç”¨ï¼Œè¿˜æœ‰å°±æ˜¯ PersonWrapper çš„æ„é€ ã€‚ ä¸ºäº†è®© main ä¸­ä½¿ç”¨èµ·æ¥æ›´ä¸ºæ–¹ä¾¿ï¼Œ me ä»¬å¯ä»¥å†ç®€å•çš„å°è£…ä¸€ä¸‹ï¼Œ æ„é€ ä¸€ä¸ª SortPerson æ–¹æ³•ï¼Œ å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657package main import ( \"fmt\" \"sort\") type Person struct &#123; Name string Age int&#125; type PersonWrapper struct &#123; people [] Person by func(p, q * Person) bool&#125; type SortBy func(p, q *Person) bool func (pw PersonWrapper) Len() int &#123; // é‡å†™ Len() æ–¹æ³• return len(pw.people)&#125;func (pw PersonWrapper) Swap(i, j int)&#123; // é‡å†™ Swap() æ–¹æ³• pw.people[i], pw.people[j] = pw.people[j], pw.people[i]&#125;func (pw PersonWrapper) Less(i, j int) bool &#123; // é‡å†™ Less() æ–¹æ³• return pw.by(&amp;pw.people[i], &amp;pw.people[j])&#125; // å°è£…æˆ SortPerson æ–¹æ³•func SortPerson(people [] Person, by SortBy)&#123; sort.Sort(PersonWrapper&#123;people, by&#125;)&#125; func main() &#123; people := [] Person&#123; &#123;\"zhang san\", 12&#125;, &#123;\"li si\", 30&#125;, &#123;\"wang wu\", 52&#125;, &#123;\"zhao liu\", 26&#125;, &#125; fmt.Println(people) sort.Sort(PersonWrapper&#123;people, func (p, q *Person) bool &#123; return q.Age &lt; p.Age // Age é€’å‡æ’åº &#125;&#125;) fmt.Println(people) SortPerson(people, func (p, q *Person) bool &#123; return p.Name &lt; q.Name // Name é€’å¢æ’åº &#125;) fmt.Println(people) &#125; åœ¨æ–¹æ³• 2 çš„åŸºç¡€ä¸Šæ„é€ äº† SortPerson å‡½æ•°ï¼Œä½¿ç”¨çš„æ—¶å€™ä¼ è¿‡å»ä¸€ä¸ª [] Person å’Œä¸€ä¸ª cmp å‡½æ•°ã€‚ 4ã€å¦ä¸€ç§æ€è·¯1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950package main import ( \"fmt\" \"sort\") type Person struct &#123; Name string Weight int&#125; type PersonSlice []Person func (s PersonSlice) Len() int &#123; return len(s) &#125;func (s PersonSlice) Swap(i, j int) &#123; s[i], s[j] = s[j], s[i] &#125; type ByName struct&#123; PersonSlice &#125; // å°† PersonSlice åŒ…è£…èµ·æ¥åˆ° ByName ä¸­ func (s ByName) Less(i, j int) bool &#123; return s.PersonSlice[i].Name &lt; s.PersonSlice[j].Name &#125; // å°† Less ç»‘å®šåˆ° ByName ä¸Š type ByWeight struct&#123; PersonSlice &#125; // å°† PersonSlice åŒ…è£…èµ·æ¥åˆ° ByWeight ä¸­func (s ByWeight) Less(i, j int) bool &#123; return s.PersonSlice[i].Weight &lt; s.PersonSlice[j].Weight &#125; // å°† Less ç»‘å®šåˆ° ByWeight ä¸Š func main() &#123; s := []Person&#123; &#123;\"apple\", 12&#125;, &#123;\"pear\", 20&#125;, &#123;\"banana\", 50&#125;, &#123;\"orange\", 87&#125;, &#123;\"hello\", 34&#125;, &#123;\"world\", 43&#125;, &#125; sort.Sort(ByWeight&#123;s&#125;) fmt.Println(\"People by weight:\") printPeople(s) sort.Sort(ByName&#123;s&#125;) fmt.Println(\"\\nPeople by name:\") printPeople(s) &#125; func printPeople(s []Person) &#123; for _, o := range s &#123; fmt.Printf(\"%-8s (%v)\\n\", o.Name, o.Weight) &#125;&#125; å¯¹ç»“æ„ä½“çš„æ’åºï¼Œ æš‚æ—¶å°±åˆ°è¿™é‡Œã€‚ ç¬¬ä¸€ç§æ’åºå¯¹åªæ ¹æ®ä¸€ä¸ªå­—æ®µçš„æ¯”è¾ƒåˆé€‚ï¼Œ å¦å¤–ä¸‰ä¸ªæ˜¯é’ˆå¯¹å¯èƒ½æ ¹æ®å¤šä¸ªå­—æ®µæ’åºçš„ã€‚æ–¹æ³• 4 æˆ‘è®¤ä¸ºæ¯æ¬¡éƒ½è¦å¤šæ„é€ ä¸€ä¸ª ByXXX ï¼Œ é¢‡ä¸ºä¸ä¾¿ï¼Œ è¿™æ ·å¤šéº»çƒ¦ï¼Œä¸å¦‚æ–¹æ³• 2 å’Œæ–¹æ³• 3 æ¥çš„æ–¹ä¾¿ï¼Œç›´æ¥ä¼ è¿›å»ä¸€ä¸ª cmpã€‚ æ–¹æ³•2ã€ 3 æ²¡æœ‰å¤ªå¤§çš„å·®åˆ«ï¼Œ 3 åªæ˜¯ç®€å•å°è£…äº†ä¸€ä¸‹è€Œå·²ï¼Œ å¯¹äºä½¿ç”¨è€…æ¥è¯´ï¼Œ å¯èƒ½ä¼šæ›´æ–¹ä¾¿ä¸€äº›ï¼Œè€Œä¸”ä¹Ÿä¼šæ›´å°‘çš„å‡ºé”™ã€‚ å‚è€ƒèµ„æ–™ï¼š1ã€goè¯­è¨€çš„æ’åºå’Œæœç´¢","categories":[{"name":"Goè¯­è¨€","slug":"Goè¯­è¨€","permalink":"http://github.com/categories/Goè¯­è¨€/"}],"tags":[{"name":"Goè¯­è¨€","slug":"Goè¯­è¨€","permalink":"http://github.com/tags/Goè¯­è¨€/"}],"keywords":[{"name":"Goè¯­è¨€","slug":"Goè¯­è¨€","permalink":"http://github.com/categories/Goè¯­è¨€/"}]},{"title":"ã€Android ã€‘TextView å±€éƒ¨æ–‡å­—å˜è‰²","slug":"ã€Android ã€‘TextView å±€éƒ¨æ–‡å­—å˜è‰²","date":"2016-09-07T07:02:45.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/09/07/ã€Android ã€‘TextView å±€éƒ¨æ–‡å­—å˜è‰²/","link":"","permalink":"http://github.com/2016/09/07/ã€Android ã€‘TextView å±€éƒ¨æ–‡å­—å˜è‰²/","excerpt":"TextView å¯¹äºå¯Œæ–‡æœ¬æ•ˆæœçš„å®ç°æ”¯æŒä¸æ”¯æŒå‘¢ï¼Ÿæ¯”å¦‚â€œå±€éƒ¨æ–‡å­—é¢œè‰²çš„å˜åŠ¨â€ï¼Œâ€œå±€éƒ¨å­—ä½“çš„å˜åŠ¨â€ ä¸€ã€éœ€æ±‚æ•ˆæœ äºŒã€è§£å†³æ–¹æ¡ˆé’ˆå¯¹è¿™ç±»é—®é¢˜ï¼ŒAndroidæä¾›äº† SpannableStringBuilderï¼Œæ–¹ä¾¿æˆ‘ä»¬è‡ªå®šä¹‰å¯Œæ–‡æœ¬çš„å®ç°ã€‚ 123456789101112131415161718textView = (TextView) findViewById(R.id.textview);SpannableStringBuilder builder = new SpannableStringBuilder(textView.getText().toString());//ForegroundColorSpan ä¸ºæ–‡å­—å‰æ™¯è‰²ï¼ŒBackgroundColorSpanä¸ºæ–‡å­—èƒŒæ™¯è‰²ForegroundColorSpan redSpan = new ForegroundColorSpan(Color.RED);ForegroundColorSpan whiteSpan = new ForegroundColorSpan(Color.WHITE);ForegroundColorSpan blueSpan = new ForegroundColorSpan(Color.BLUE);ForegroundColorSpan greenSpan = new ForegroundColorSpan(Color.GREEN);ForegroundColorSpan yellowSpan = new ForegroundColorSpan(Color.YELLOW); builder.setSpan(redSpan, 0, 1, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);builder.setSpan(whiteSpan, 1, 2, Spannable.SPAN_INCLUSIVE_INCLUSIVE);builder.setSpan(blueSpan, 2, 3, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);builder.setSpan(greenSpan, 3, 4, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);builder.setSpan(yellowSpan, 4,5, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);textView.setText(builder);","text":"TextView å¯¹äºå¯Œæ–‡æœ¬æ•ˆæœçš„å®ç°æ”¯æŒä¸æ”¯æŒå‘¢ï¼Ÿæ¯”å¦‚â€œå±€éƒ¨æ–‡å­—é¢œè‰²çš„å˜åŠ¨â€ï¼Œâ€œå±€éƒ¨å­—ä½“çš„å˜åŠ¨â€ ä¸€ã€éœ€æ±‚æ•ˆæœ äºŒã€è§£å†³æ–¹æ¡ˆé’ˆå¯¹è¿™ç±»é—®é¢˜ï¼ŒAndroidæä¾›äº† SpannableStringBuilderï¼Œæ–¹ä¾¿æˆ‘ä»¬è‡ªå®šä¹‰å¯Œæ–‡æœ¬çš„å®ç°ã€‚ 123456789101112131415161718textView = (TextView) findViewById(R.id.textview);SpannableStringBuilder builder = new SpannableStringBuilder(textView.getText().toString());//ForegroundColorSpan ä¸ºæ–‡å­—å‰æ™¯è‰²ï¼ŒBackgroundColorSpanä¸ºæ–‡å­—èƒŒæ™¯è‰²ForegroundColorSpan redSpan = new ForegroundColorSpan(Color.RED);ForegroundColorSpan whiteSpan = new ForegroundColorSpan(Color.WHITE);ForegroundColorSpan blueSpan = new ForegroundColorSpan(Color.BLUE);ForegroundColorSpan greenSpan = new ForegroundColorSpan(Color.GREEN);ForegroundColorSpan yellowSpan = new ForegroundColorSpan(Color.YELLOW); builder.setSpan(redSpan, 0, 1, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);builder.setSpan(whiteSpan, 1, 2, Spannable.SPAN_INCLUSIVE_INCLUSIVE);builder.setSpan(blueSpan, 2, 3, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);builder.setSpan(greenSpan, 3, 4, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);builder.setSpan(yellowSpan, 4,5, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);textView.setText(builder); é™¤äº†ä¸Šè¿°ä»£ç ä¸­ä½¿ç”¨çš„ ForegroundColorSpan å’Œ BackgroundColorSpanä¹‹å¤–ï¼Œè¿˜æœ‰ä»¥ä¸‹è¿™äº›Spanå¯ä»¥ä½¿ç”¨ï¼š AbsoluteSizeSpan(int size) â€”â€” è®¾ç½®å­—ä½“å¤§å°ï¼Œå‚æ•°æ˜¯ç»å¯¹æ•°å€¼ï¼Œç›¸å½“äºWordä¸­çš„å­—ä½“å¤§å° RelativeSizeSpan(float proportion) â€”â€” è®¾ç½®å­—ä½“å¤§å°ï¼Œå‚æ•°æ˜¯ç›¸å¯¹äºé»˜è®¤å­—ä½“å¤§å°çš„å€æ•°ï¼Œæ¯”å¦‚é»˜è®¤å­—ä½“å¤§å°æ˜¯x, é‚£ä¹ˆè®¾ç½®åçš„å­—ä½“å¤§å°å°±æ˜¯x*proportionï¼Œè¿™ä¸ªç”¨èµ·æ¥æ¯”è¾ƒçµæ´»ï¼Œproportion&gt;1å°±æ˜¯æ”¾å¤§(zoom in), proportion&lt;1å°±æ˜¯ç¼©å°(zoom out) ScaleXSpan(float proportion) â€”â€” ç¼©æ”¾å­—ä½“ï¼Œä¸ä¸Šé¢çš„ç±»ä¼¼ï¼Œé»˜è®¤ä¸º1,è®¾ç½®åå°±æ˜¯åŸæ¥çš„ä¹˜ä»¥proportionï¼Œå¤§äº1æ—¶æ”¾å¤§(zoon in)ï¼Œå°äºæ—¶ç¼©å°(zoom out) BackgroundColorSpan(int color) â€”â€” èƒŒæ™¯ç€è‰²ï¼Œå‚æ•°æ˜¯é¢œè‰²æ•°å€¼ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨android.graphics.Coloré‡Œé¢å®šä¹‰çš„å¸¸é‡ï¼Œæˆ–æ˜¯ç”¨Color.rgb(int, int, int) ForegroundColorSpan(int color) â€”â€” å‰æ™¯ç€è‰²ï¼Œä¹Ÿå°±æ˜¯å­—çš„ç€è‰²ï¼Œå‚æ•°ä¸èƒŒæ™¯ç€è‰²ä¸€è‡´ TypefaceSpan(String family) â€”â€” å­—ä½“ï¼Œå‚æ•°æ˜¯å­—ä½“çš„åå­—æ¯”å¦‚â€œsansâ€, â€œsans-serifâ€ç­‰ StyleSpan(Typeface style) â€”â€” å­—ä½“é£æ ¼ï¼Œæ¯”å¦‚ç²—ä½“ï¼Œæ–œä½“ï¼Œå‚æ•°æ˜¯android.graphics.Typefaceé‡Œé¢å®šä¹‰çš„å¸¸é‡ï¼Œå¦‚Typeface.BOLDï¼ŒTypeface.ITALICç­‰ç­‰ã€‚StrikethroughSpanâ€”-å¦‚æœè®¾ç½®äº†æ­¤é£æ ¼ï¼Œä¼šæœ‰ä¸€æ¡çº¿ä»ä¸­é—´ç©¿è¿‡æ‰€æœ‰çš„å­—ï¼Œå°±åƒè¢«åˆ’æ‰ä¸€æ · ä¸‰ã€åŠ¨æ‰‹è¯•è¯•æ¯”å¦‚å®ç°ä¸‹å›¾ä¸­TextViewçš„æ ·å¼ ç„¶åä»£ç å¦‚ä¸‹ï¼š 1234567891011121314TextView tv = (TextView)view.findViewById(R.id.toast_text);String str1 = \"æäº¤æˆåŠŸï¼\\nç§¯åˆ†\";String str2 = \"+\" + score1;String str3 = \"ï¼å®¡æ ¸é€šè¿‡åå†\";String str4 = \"+\" + score2;SpannableStringBuilder builder = new SpannableStringBuilder(str1 + str2 + str3 + str4 + \"ï¼\");builder.setSpan(new ForegroundColorSpan(Color.parseColor(\"#ffffa200\")), str1.length(), (str1 + str2).length(), Spannable.SPAN_EXCLUSIVE_INCLUSIVE);builder.setSpan(new ForegroundColorSpan(Color.parseColor(\"#ffffa200\")), (str1 + str2 + str3).length(), (str1 + str2 + str3 + str4).length(), Spannable.SPAN_EXCLUSIVE_INCLUSIVE);tv.setText(builder); å‚è€ƒèµ„æ–™ï¼š1ã€Android-ä¿®æ”¹TextViewä¸­éƒ¨åˆ†æ–‡å­—çš„é¢œè‰²2ã€Android TextView è®¾ç½®éƒ¨åˆ†æ–‡å­—èƒŒæ™¯è‰²å’Œæ–‡å­—é¢œè‰²","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘è·å–Viewçš„æˆªå›¾","slug":"ã€Androidã€‘è·å–Viewçš„æˆªå›¾","date":"2016-08-30T02:32:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/08/30/ã€Androidã€‘è·å–Viewçš„æˆªå›¾/","link":"","permalink":"http://github.com/2016/08/30/ã€Androidã€‘è·å–Viewçš„æˆªå›¾/","excerpt":"å¼•è¨€ åœ¨Androidåº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°éœ€è¦å¯¹æ•´ä¸ªç•Œé¢æˆ–è€…æŸä¸€éƒ¨åˆ†è¿›è¡Œæˆªå›¾çš„éœ€æ±‚ã€‚ Androidä¸­å¯¹Viewçš„æˆªå›¾ä¹Ÿæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ä¸¤ä¸ªæ–¹æ³•éƒ½ä¸é€‚ç”¨äºSurfaceViewï¼š ä½¿ç”¨DrawingCacheå¦‚æœä½¿ç”¨DrawingCacheï¼Œåˆ™å¯¹è¦æˆªå›¾çš„Viewæœ‰ä¸€ä¸ªè¦æ±‚ï¼šViewæœ¬èº«å·²ç»æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šã€‚å¦‚æœViewæ²¡æœ‰æ·»åŠ åˆ°ç•Œé¢ä¸Šæˆ–è€…æ²¡æœ‰æ˜¾ç¤ºï¼ˆç»˜åˆ¶ï¼‰è¿‡ï¼Œåˆ™buildDrawingCacheä¼šå¤±è´¥ã€‚è¿™ç§æ–¹å¼æ¯”è¾ƒé€‚åˆå¯¹åº”ç”¨ç•Œé¢æˆ–è€…æŸä¸€éƒ¨åˆ†çš„æˆªå›¾ã€‚æ­¥éª¤å¾ˆç®€å•ï¼š 123456view.setDrawingCacheEnabled(true); view.buildDrawingCache(); //å¯ç”¨DrawingCacheå¹¶åˆ›å»ºä½å›¾ //åˆ›å»ºä¸€ä¸ªDrawingCacheçš„æ‹·è´ï¼Œå› ä¸ºDrawingCacheå¾—åˆ°çš„ä½å›¾åœ¨ç¦ç”¨åä¼šè¢«å›æ”¶ Bitmap bitmap = Bitmap.createBitmap(view.getDrawingCache()); view.setDrawingCacheEnabled(false); //ç¦ç”¨DrawingCahceå¦åˆ™ä¼šå½±å“æ€§èƒ½","text":"å¼•è¨€ åœ¨Androidåº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°éœ€è¦å¯¹æ•´ä¸ªç•Œé¢æˆ–è€…æŸä¸€éƒ¨åˆ†è¿›è¡Œæˆªå›¾çš„éœ€æ±‚ã€‚ Androidä¸­å¯¹Viewçš„æˆªå›¾ä¹Ÿæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ä¸¤ä¸ªæ–¹æ³•éƒ½ä¸é€‚ç”¨äºSurfaceViewï¼š ä½¿ç”¨DrawingCacheå¦‚æœä½¿ç”¨DrawingCacheï¼Œåˆ™å¯¹è¦æˆªå›¾çš„Viewæœ‰ä¸€ä¸ªè¦æ±‚ï¼šViewæœ¬èº«å·²ç»æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šã€‚å¦‚æœViewæ²¡æœ‰æ·»åŠ åˆ°ç•Œé¢ä¸Šæˆ–è€…æ²¡æœ‰æ˜¾ç¤ºï¼ˆç»˜åˆ¶ï¼‰è¿‡ï¼Œåˆ™buildDrawingCacheä¼šå¤±è´¥ã€‚è¿™ç§æ–¹å¼æ¯”è¾ƒé€‚åˆå¯¹åº”ç”¨ç•Œé¢æˆ–è€…æŸä¸€éƒ¨åˆ†çš„æˆªå›¾ã€‚æ­¥éª¤å¾ˆç®€å•ï¼š 123456view.setDrawingCacheEnabled(true); view.buildDrawingCache(); //å¯ç”¨DrawingCacheå¹¶åˆ›å»ºä½å›¾ //åˆ›å»ºä¸€ä¸ªDrawingCacheçš„æ‹·è´ï¼Œå› ä¸ºDrawingCacheå¾—åˆ°çš„ä½å›¾åœ¨ç¦ç”¨åä¼šè¢«å›æ”¶ Bitmap bitmap = Bitmap.createBitmap(view.getDrawingCache()); view.setDrawingCacheEnabled(false); //ç¦ç”¨DrawingCahceå¦åˆ™ä¼šå½±å“æ€§èƒ½ å®Œæ•´çš„æˆªå›¾åŠŸèƒ½å‡½æ•°å¦‚ä¸‹ï¼š 1234567891011121314151617181920/** * è·å–ä¸€ä¸ª View çš„ç¼“å­˜è§†å›¾ * * @param view * @return */ private Bitmap getCacheBitmapFromView(View view) &#123; final boolean drawingCacheEnabled = true; view.setDrawingCacheEnabled(drawingCacheEnabled); view.buildDrawingCache(drawingCacheEnabled); final Bitmap drawingCache = view.getDrawingCache(); Bitmap bitmap; if (drawingCache != null) &#123; bitmap = Bitmap.createBitmap(drawingCache); view.setDrawingCacheEnabled(false); &#125; else &#123; bitmap = null; &#125; return bitmap; &#125; ç›´æ¥è°ƒç”¨View.drawå¦‚æœéœ€è¦æˆªå›¾çš„Viewå¹¶æ²¡æœ‰æ·»åŠ åˆ°ç•Œé¢ä¸Šï¼Œå¯èƒ½æ˜¯é€šè¿‡javaä»£ç åˆ›å»ºçš„æˆ–è€…inflateåˆ›å»ºçš„ï¼Œæ­¤æ—¶è°ƒç”¨DrawingCacheæ–¹æ³•æ˜¯è·å–ä¸åˆ°ä½å›¾çš„ã€‚å› ä¸ºViewåœ¨æ·»åŠ åˆ°å®¹å™¨ä¸­ä¹‹å‰å¹¶æ²¡æœ‰å¾—åˆ°å®é™…çš„å¤§å°ï¼ˆå¦‚æœLayoutWidthæ˜¯MatchParentï¼Œå®ƒè¿˜æ²¡æœ‰Parentâ€¦ï¼‰ï¼Œæ‰€ä»¥é¦–å…ˆéœ€è¦æŒ‡å®šViewçš„å¤§å°ï¼š 12345678910private void layoutView(View v, int width, int height) &#123; // validate view.width and view.height v.layout(0, 0, width, height); int measuredWidth = View.MeasureSpec.makeMeasureSpec(width, View.MeasureSpec.EXACTLY); int measuredHeight = View.MeasureSpec.makeMeasureSpec(height, View.MeasureSpec.EXACTLY); // validate view.measurewidth and view.measureheight v.measure(measuredWidth, measuredHeight); v.layout(0, 0, v.getMeasuredWidth(), v.getMeasuredHeight());i &#125; ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š 1234567int viewWidth = webView.getMeasuredWidth(); int viewHeight = webView.getMeasuredHeight(); if (viewWidth &gt; 0 &amp;&amp; viewHeight &gt; 0) &#123; b = Bitmap.createBitmap(viewWidth, viewHeight, Config.ARGB_8888); Canvas cvs = new Canvas(b); webView.draw(cvs); &#125; å¯¹äºWebViewçš„æˆªå›¾æœ‰ä¸€ç‚¹ç‰¹æ®Šï¼Œç½‘é¡µå†…å®¹å¹¶ä¸èƒ½åœ¨å¸ƒå±€å®Œæˆåç«‹å³æ¸²æŸ“å‡ºæ¥ï¼Œå¤§æ¦‚éœ€è¦300msçš„æ—¶é—´ï¼ˆå¯¹äºä¸åŒæ€§èƒ½çš„è®¾å¤‡ã€ç½‘é¡µå¤æ‚ç¨‹åº¦å’ŒWebkitç‰ˆæœ¬å¯èƒ½ä¸åŒï¼‰ã€‚ å¦‚æœåˆ›å»ºåå°çš„WebViewéœ€è¦æˆªå›¾çš„è¯ï¼Œåº”è¯¥åœ¨åˆ›å»ºæ—¶å°±å¯¹å…¶è¿›è¡Œå¸ƒå±€æ“ä½œï¼Œè¿™æ ·åŠ è½½å®Œæˆåå¤§éƒ¨åˆ†å°±å·²ç»æ¸²æŸ“å®Œæ¯•äº†ï¼ˆé™¤éæœ‰å¼‚æ­¥çš„jså¤„ç†ï¼‰ã€‚ ã€å‚è€ƒèµ„æ–™ã€‘ï¼š 1ã€Androidåº”ç”¨æˆªå›¾ä¸¤ç§æ–¹æ³•2ã€çŸ¥ä¹å’Œç®€ä¹¦çš„å¤œé—´æ¨¡å¼å®ç°å¥—è·¯","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘å¦‚ä½•åŠ é€Ÿ AndroidStudio çš„ç¼–è¯‘æ•ˆç‡","slug":"ã€Androidã€‘å¦‚ä½•åŠ é€Ÿ AndroidStudio çš„ç¼–è¯‘æ•ˆç‡","date":"2016-08-26T07:20:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/08/26/ã€Androidã€‘å¦‚ä½•åŠ é€Ÿ AndroidStudio çš„ç¼–è¯‘æ•ˆç‡/","link":"","permalink":"http://github.com/2016/08/26/ã€Androidã€‘å¦‚ä½•åŠ é€Ÿ AndroidStudio çš„ç¼–è¯‘æ•ˆç‡/","excerpt":"å¼•è¨€å¦‚æœä½ ä¹‹å‰ç”¨eclipseå¼€å‘è¿‡Android appçš„è¯ï¼Œè½¬åˆ°android studioçš„ç¬¬ä¸€ååº”ä¹Ÿè®¸å°±æ˜¯ï¼šâ€ç¼–è¯‘é€Ÿåº¦æœ‰ç‚¹æ…¢â€œï¼Œè¡¨ç°çš„æœ€æ˜æ˜¾çš„ä¸€ç‚¹å°±æ˜¯ï¼Œæ¯æ¬¡android studioä½¿ç”¨gradleç¼–è¯‘ï¼Œå³ä¾¿æ˜¯æ›´æ”¹çš„ä»£ç é‡å¾ˆå°‘ï¼Œä¹Ÿä¼šæŒ‰ç…§é¢„å…ˆè®¾ç½®çš„taskçš„é¡ºåºï¼Œä¾æ¬¡èµ°å®Œç¼–è¯‘çš„å„é¡¹æµç¨‹ã€‚è¿™æ—¶å€™å¦‚æœç”µè„‘CPUé…ç½®ä¸é«˜çš„æ—¶å€™ï¼Œå°±ä¼šè¶…çº§å¡ç•Œé¢ï¼Œæ›´åˆ«è¯´æ”¹ä»£ç äº†ã€‚ æ‰€ä»¥ è¿™ç‚¹å°±è®©äººå¾ˆç—›è‹¦ï¼Œ ç„¶è€Œé—®é¢˜æ€»è¿˜æ˜¯è¦è¢«è§£å†³çš„ï¼Œä½œè€…æ›¾ç»äº²çœ¼çœ‹åˆ°è¿‡ä½¿ç”¨android studioä»…ä»…ç”¨äº†2.5ç§’å°±ç¼–è¯‘å®Œæ¯•(åœ¨ä»£ç æ›´æ”¹å¾ˆå°‘çš„æƒ…å†µä¸‹)ã€‚ ç°åœ¨æŠŠå¦‚ä½•ä¼˜åŒ–gradleç¼–è¯‘é€Ÿåº¦çš„æ–¹æ³•è®°å½•åœ¨æ­¤ï¼Œå¸Œæœ›å¯ä»¥ å¸®åŠ©åˆ°å¹¿å¤§çš„åŒè¡Œä»¬ã€‚ å‡†å¤‡å·¥ä½œé¦–å…ˆï¼Œä¿è¯é¡¹ç›®ä½¿ç”¨çš„Gradleæ˜¯æœ€æ–°çš„ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯2.10ç‰ˆæœ¬ã€‚å› ä¸ºGradle 2.4ä¹‹ååœ¨ç¼–è¯‘æ•ˆç‡ä¸Šé¢æœ‰äº†ä¸€ä¸ªéå¸¸å¤§çš„æé«˜ï¼Œçœ‹ä¸‹å›¾å®˜æ–¹çš„é€Ÿåº¦å¯¹æ¯”ã€‚","text":"å¼•è¨€å¦‚æœä½ ä¹‹å‰ç”¨eclipseå¼€å‘è¿‡Android appçš„è¯ï¼Œè½¬åˆ°android studioçš„ç¬¬ä¸€ååº”ä¹Ÿè®¸å°±æ˜¯ï¼šâ€ç¼–è¯‘é€Ÿåº¦æœ‰ç‚¹æ…¢â€œï¼Œè¡¨ç°çš„æœ€æ˜æ˜¾çš„ä¸€ç‚¹å°±æ˜¯ï¼Œæ¯æ¬¡android studioä½¿ç”¨gradleç¼–è¯‘ï¼Œå³ä¾¿æ˜¯æ›´æ”¹çš„ä»£ç é‡å¾ˆå°‘ï¼Œä¹Ÿä¼šæŒ‰ç…§é¢„å…ˆè®¾ç½®çš„taskçš„é¡ºåºï¼Œä¾æ¬¡èµ°å®Œç¼–è¯‘çš„å„é¡¹æµç¨‹ã€‚è¿™æ—¶å€™å¦‚æœç”µè„‘CPUé…ç½®ä¸é«˜çš„æ—¶å€™ï¼Œå°±ä¼šè¶…çº§å¡ç•Œé¢ï¼Œæ›´åˆ«è¯´æ”¹ä»£ç äº†ã€‚ æ‰€ä»¥ è¿™ç‚¹å°±è®©äººå¾ˆç—›è‹¦ï¼Œ ç„¶è€Œé—®é¢˜æ€»è¿˜æ˜¯è¦è¢«è§£å†³çš„ï¼Œä½œè€…æ›¾ç»äº²çœ¼çœ‹åˆ°è¿‡ä½¿ç”¨android studioä»…ä»…ç”¨äº†2.5ç§’å°±ç¼–è¯‘å®Œæ¯•(åœ¨ä»£ç æ›´æ”¹å¾ˆå°‘çš„æƒ…å†µä¸‹)ã€‚ ç°åœ¨æŠŠå¦‚ä½•ä¼˜åŒ–gradleç¼–è¯‘é€Ÿåº¦çš„æ–¹æ³•è®°å½•åœ¨æ­¤ï¼Œå¸Œæœ›å¯ä»¥ å¸®åŠ©åˆ°å¹¿å¤§çš„åŒè¡Œä»¬ã€‚ å‡†å¤‡å·¥ä½œé¦–å…ˆï¼Œä¿è¯é¡¹ç›®ä½¿ç”¨çš„Gradleæ˜¯æœ€æ–°çš„ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯2.10ç‰ˆæœ¬ã€‚å› ä¸ºGradle 2.4ä¹‹ååœ¨ç¼–è¯‘æ•ˆç‡ä¸Šé¢æœ‰äº†ä¸€ä¸ªéå¸¸å¤§çš„æé«˜ï¼Œçœ‹ä¸‹å›¾å®˜æ–¹çš„é€Ÿåº¦å¯¹æ¯”ã€‚ ç„¶åå…ˆåœ¨ä½ çš„é¡¹ç›®build.gradleæ–‡ä»¶å†…(ä¸æ˜¯appé‡Œé¢çš„gradleæ–‡ä»¶), å°±æ˜¯è¿™é‡Œï¼š æ·»åŠ ä¸€ä¸ªtaskï¼Œ ä»£ç å¦‚ä¸‹: 123task wrapper(type: Wrapper) &#123; gradleVersion = '2.10' //ä½ å®‰è£…çš„æœ€æ–°Gradleç‰ˆæœ¬&#125; åŠ è¿›å»ä»¥åæ˜¯è¿™ä¸ªæ ·å­ï¼š 12345678910111213141516171819202122232425// Top-level build file where you can add configuration options common to all sub-projects/modules.// Running 'gradle wrapper' will generate gradlew - Getting gradle wrapper working and using it will save you a lot of pain.task wrapper(type: Wrapper) &#123; gradleVersion = '2.10'&#125;buildscript &#123; repositories &#123; jcenter() &#125; dependencies &#123; classpath 'com.android.tools.build:gradle:2.1.0' &#125; ext &#123; compileSdkVersion = 21 buildToolsVersion =\"23.0.2\" minSdkVersion = 18 targetSdkVersion = 21 sourceCompatibility = JavaVersion.VERSION_1_7 targetCompatibility = JavaVersion.VERSION_1_7 &#125;&#125; ç„¶åæ‰“å¼€terminal, è¾“å…¥./gradlew wrapperï¼ŒWindows ä¸‹è¾“å…¥ï¼š 1gradlew wrapper ç„¶ågradleå°±ä¼šè‡ªåŠ¨å»ä¸‹è½½2.4ç‰ˆæœ¬,è¿™ä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„æ‰‹åŠ¨è®¾ç½®gradleçš„æ–¹æ³• å®ˆæŠ¤è¿›ç¨‹ï¼Œå¹¶è¡Œç¼–è¯‘é€šè¿‡ä»¥ä¸Šæ­¥éª¤,æˆ‘ä»¬è®¾ç½®å¥½äº† Android Studio ä½¿ç”¨æœ€æ–°çš„ Gradle ç‰ˆæœ¬ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æ­£å¼å¼€å¯ä¼˜åŒ–ä¹‹è·¯äº†ã€‚æˆ‘ä»¬éœ€è¦å°†gradleä½œä¸ºå®ˆæŠ¤è¿›ç¨‹ä¸€ç›´åœ¨åå°è¿è¡Œï¼Œè¿™æ ·å½“æˆ‘ä»¬éœ€è¦ç¼–è¯‘çš„æ—¶å€™ï¼Œgradleå°±ä¼šç«‹å³è·‘è¿‡æ¥ç„¶å å­å“§å­å“§çš„å¼€å§‹å¹²æ´»ã€‚é™¤äº†è®¾ç½®gradleä¸€ç›´å¼€å¯ä¹‹å¤–ï¼Œå½“ä½ çš„å·¥ä½œç©ºé—´å­˜åœ¨å¤šä¸ªprojectçš„æ—¶å€™ï¼Œè¿˜éœ€è¦è®¾ç½®gradleå¯¹è¿™äº›projectså¹¶è¡Œç¼–è¯‘ï¼Œè€Œä¸æ˜¯å•çº¿çš„ä¾æ¬¡è¿›è¡Œç¼–è¯‘æ“ä½œã€‚ è¯´äº†é‚£ä¹ˆå¤šï¼Œ é‚£ä¹ˆæ€ä¹ˆè®¾ç½®å®ˆæŠ¤è¿›ç¨‹å’Œå¹¶è¡Œç¼–è¯‘å‘¢ï¼Ÿå…¶å®éå¸¸ç®€å•ï¼Œgradleæœ¬èº«å·²ç»æœ‰äº†ç›¸å…³çš„é…ç½®é€‰é¡¹ï¼Œåœ¨ä½ ç”µè„‘çš„GRADLE_HOMEè¿™ä¸ªç¯å¢ƒå˜é‡æ‰€æŒ‡çš„é‚£ä¸ªæ–‡ä»¶å¤¹å†…ï¼Œæœ‰ä¸€ä¸ª.gradle/gradle.propertiesæ–‡ä»¶ã€‚ åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼Œæ”¾å…¥ä¸‹é¢ä¸¤å¥è¯å°±OKäº†: 12org.gradle.daemon=trueorg.gradle.parallel=true æœ‰ä¸€ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„çš„æ˜¯,android studio æœ¬èº«åœ¨ç¼–è¯‘çš„æ—¶å€™,å·²ç»æ˜¯ä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹ä¸­çš„gradleäº†,é‚£ä¹ˆè¿™é‡ŒåŠ ä¸Šäº†org.gradle.daemon=trueå°±æ˜¯ä¿è¯äº†ä½ åœ¨ä½¿ç”¨å‘½ä»¤è¡Œç¼–è¯‘apkçš„æ—¶å€™ä¹Ÿæ˜¯ä½¿ç”¨çš„å®ˆæŠ¤è¿›ç¨‹. ä½ ä¹Ÿå¯ä»¥å°†ä¸Šè¿°çš„é…ç½®æ–‡ä»¶æ”¾åˆ°ä½ projectä¸­çš„æ ¹ç›®å½•ä¸‹,ä»¥ç»å¯¹ç¡®ä¿åœ¨ä»»ä½•æƒ…å†µä¸‹,è¿™ä¸ªprojectéƒ½ä¼šä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹è¿›è¡Œç¼–è¯‘.ä¸è¿‡æœ‰äº›ç‰¹æ®Šçš„æƒ…å†µä¸‹ä¹Ÿè®¸ä½ åº”è¯¥æ³¨æ„å®ˆæŠ¤è¿›ç¨‹çš„ä½¿ç”¨,å…·ä½“çš„ç»†èŠ‚å‚è€ƒå®˜ç½‘When should I not use the Gradle Daemon? åœ¨ä½¿ç”¨å¹¶è¡Œç¼–è¯‘çš„æ—¶å€™å¿…é¡»è¦æ³¨æ„çš„å°±æ˜¯,ä½ çš„å„ä¸ªprojectä¹‹é—´ä¸è¦æœ‰ä¾èµ–å…³ç³»,å¦åˆ™çš„è¯,å¾ˆå¯èƒ½å› ä¸ºä½ çš„Project A ä¾èµ–Project B, è€ŒProject Bè¿˜æ²¡æœ‰ç¼–è¯‘å‡ºæ¥çš„æ—¶å€™,gradleå°±å¼€å§‹ç¼–è¯‘Project A äº†.æœ€ç»ˆ å¯¼è‡´ç¼–è¯‘å¤±è´¥.å…·ä½“å¯ä»¥å‚è€ƒå®˜ç½‘Multi-Project Building and Testingã€‚ è¿˜æœ‰ä¸€äº›é¢å¤–çš„gradleè®¾ç½®ä¹Ÿè®¸ä¼šå¼•èµ·ä½ çš„å…´è¶£,ä¾‹å¦‚ä½ æƒ³å¢åŠ å †å†…å­˜çš„ç©ºé—´,æˆ–è€…æŒ‡å®šä½¿ç”¨å“ªä¸ªjvmè™šæ‹Ÿæœºç­‰ç­‰(ä»£ç å¦‚ä¸‹) 12org.gradle.jvmargs=-Xmx768morg.gradle.java.home=/path/to/jvm å¦‚æœä½ æƒ³è¯¦ç»†çš„äº†è§£gradleçš„é…ç½®,è¯·çŒ›æˆ³å®˜ç½‘ Gradle User Guideã€‚ ã€å‚è€ƒèµ„æ–™ã€‘ï¼š1ã€Boosting the performance for Gradle in your Android projects2ã€è¯‘æ–‡ï¼šä¼˜åŒ–android studioç¼–è¯‘æ•ˆç‡çš„æ–¹æ³•3ã€How/when to generate Gradle wrapper files?","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Goã€‘ä¸ºä»€ä¹ˆ Go è¯­è¨€æŠŠç±»å‹å£°æ˜æ”¾åœ¨åé¢ï¼Ÿ","slug":"ã€Goã€‘ä¸ºä»€ä¹ˆ Go è¯­è¨€æŠŠç±»å‹å£°æ˜æ”¾åœ¨åé¢ï¼Ÿ","date":"2016-08-18T08:36:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/08/18/ã€Goã€‘ä¸ºä»€ä¹ˆ Go è¯­è¨€æŠŠç±»å‹å£°æ˜æ”¾åœ¨åé¢ï¼Ÿ/","link":"","permalink":"http://github.com/2016/08/18/ã€Goã€‘ä¸ºä»€ä¹ˆ Go è¯­è¨€æŠŠç±»å‹å£°æ˜æ”¾åœ¨åé¢ï¼Ÿ/","excerpt":"å…³äºç±»å‹ï¼Œå®˜ç½‘ä¸Šæœ‰ä¸€æ®µä»”ç»†åœ°ä»‹ç»äº†ä¸€ä¸‹å‡½æ•°æŒ‡é’ˆçš„éƒ¨åˆ†ï¼Œç°åœ¨çš„è®¾è®¡æ¯”èµ· C çš„è¯­æ³•ï¼Œæ¸…æ™°å¾ˆå¤šã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œç±»å‹æ”¾åœ¨åé¢æ˜¯ä¸ºäº†æ›´åŠ æ¸…æ™°æ˜“æ‡‚ã€‚Rob Pike æ›¾ç»åœ¨ Go å®˜æ–¹åšå®¢è§£é‡Šè¿‡è¿™ä¸ªé—®é¢˜ï¼ˆæŸ¥çœ‹åŸæ–‡ï¼šGoâ€™s Declaration Syntaxï¼‰ï¼Œç®€ç•¥ç¿»è¯‘å¦‚ä¸‹ï¼ˆæ°´å¹³æœ‰é™ç¿»è¯‘çš„ä¸å¯¹çš„åœ°æ–¹è§è°…ï¼‰ï¼š å¼•è¨€Goè¯­è¨€æ–°äººå¸¸å¸¸ä¼šå¾ˆç–‘æƒ‘ä¸ºä»€ä¹ˆè¿™é—¨è¯­è¨€çš„å£°æ˜è¯­æ³•ï¼ˆdeclaration syntaxï¼‰ä¼šå’Œä¼ ç»Ÿçš„Cå®¶æ—è¯­è¨€ä¸åŒã€‚åœ¨è¿™ç¯‡åšæ–‡é‡Œï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œä¸€ä¸ªæ¯”è¾ƒï¼Œå¹¶åšå‡ºè§£ç­”ã€‚ C çš„è¯­æ³•é¦–å…ˆï¼Œå…ˆçœ‹çœ‹ C çš„è¯­æ³•ã€‚C é‡‡ç”¨äº†ä¸€ç§èªæ˜è€Œä¸åŒå¯»å¸¸çš„å£°æ˜è¯­æ³•ã€‚å£°æ˜å˜é‡æ—¶ï¼Œåªéœ€å†™å‡ºä¸€ä¸ªå¸¦æœ‰ç›®æ ‡å˜é‡åçš„è¡¨è¾¾å¼ï¼Œç„¶ååœ¨è¡¨è¾¾å¼é‡ŒæŒ‡æ˜è¯¥è¡¨è¾¾å¼æœ¬èº«çš„ç±»å‹å³å¯ã€‚æ¯”å¦‚ï¼š 1int x; ä¸Šé¢çš„ä»£ç å£°æ˜äº† x å˜é‡ï¼Œå¹¶ä¸”å…¶ç±»å‹ä¸º intâ€”â€”å³ï¼Œè¡¨è¾¾å¼ x ä¸º int ç±»å‹ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œä¸ºäº†æŒ‡æ˜æ–°å˜é‡çš„ç±»å‹ï¼Œæˆ‘ä»¬å¾—å†™å‡ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå…¶ä¸­å«æœ‰æˆ‘ä»¬è¦å£°æ˜çš„å˜é‡ï¼Œè¿™ä¸ªè¡¨è¾¾å¼è¿ç®—çš„ç»“æœå€¼å±äºæŸç§åŸºæœ¬ç±»å‹ï¼Œæˆ‘ä»¬æŠŠè¿™ç§åŸºæœ¬ç±»å‹å†™åˆ°è¡¨è¾¾å¼çš„å·¦è¾¹ã€‚æ‰€ä»¥ï¼Œä¸‹è¿°å£°æ˜ï¼š 12int *p;int a[3];","text":"å…³äºç±»å‹ï¼Œå®˜ç½‘ä¸Šæœ‰ä¸€æ®µä»”ç»†åœ°ä»‹ç»äº†ä¸€ä¸‹å‡½æ•°æŒ‡é’ˆçš„éƒ¨åˆ†ï¼Œç°åœ¨çš„è®¾è®¡æ¯”èµ· C çš„è¯­æ³•ï¼Œæ¸…æ™°å¾ˆå¤šã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œç±»å‹æ”¾åœ¨åé¢æ˜¯ä¸ºäº†æ›´åŠ æ¸…æ™°æ˜“æ‡‚ã€‚Rob Pike æ›¾ç»åœ¨ Go å®˜æ–¹åšå®¢è§£é‡Šè¿‡è¿™ä¸ªé—®é¢˜ï¼ˆæŸ¥çœ‹åŸæ–‡ï¼šGoâ€™s Declaration Syntaxï¼‰ï¼Œç®€ç•¥ç¿»è¯‘å¦‚ä¸‹ï¼ˆæ°´å¹³æœ‰é™ç¿»è¯‘çš„ä¸å¯¹çš„åœ°æ–¹è§è°…ï¼‰ï¼š å¼•è¨€Goè¯­è¨€æ–°äººå¸¸å¸¸ä¼šå¾ˆç–‘æƒ‘ä¸ºä»€ä¹ˆè¿™é—¨è¯­è¨€çš„å£°æ˜è¯­æ³•ï¼ˆdeclaration syntaxï¼‰ä¼šå’Œä¼ ç»Ÿçš„Cå®¶æ—è¯­è¨€ä¸åŒã€‚åœ¨è¿™ç¯‡åšæ–‡é‡Œï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œä¸€ä¸ªæ¯”è¾ƒï¼Œå¹¶åšå‡ºè§£ç­”ã€‚ C çš„è¯­æ³•é¦–å…ˆï¼Œå…ˆçœ‹çœ‹ C çš„è¯­æ³•ã€‚C é‡‡ç”¨äº†ä¸€ç§èªæ˜è€Œä¸åŒå¯»å¸¸çš„å£°æ˜è¯­æ³•ã€‚å£°æ˜å˜é‡æ—¶ï¼Œåªéœ€å†™å‡ºä¸€ä¸ªå¸¦æœ‰ç›®æ ‡å˜é‡åçš„è¡¨è¾¾å¼ï¼Œç„¶ååœ¨è¡¨è¾¾å¼é‡ŒæŒ‡æ˜è¯¥è¡¨è¾¾å¼æœ¬èº«çš„ç±»å‹å³å¯ã€‚æ¯”å¦‚ï¼š 1int x; ä¸Šé¢çš„ä»£ç å£°æ˜äº† x å˜é‡ï¼Œå¹¶ä¸”å…¶ç±»å‹ä¸º intâ€”â€”å³ï¼Œè¡¨è¾¾å¼ x ä¸º int ç±»å‹ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œä¸ºäº†æŒ‡æ˜æ–°å˜é‡çš„ç±»å‹ï¼Œæˆ‘ä»¬å¾—å†™å‡ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå…¶ä¸­å«æœ‰æˆ‘ä»¬è¦å£°æ˜çš„å˜é‡ï¼Œè¿™ä¸ªè¡¨è¾¾å¼è¿ç®—çš„ç»“æœå€¼å±äºæŸç§åŸºæœ¬ç±»å‹ï¼Œæˆ‘ä»¬æŠŠè¿™ç§åŸºæœ¬ç±»å‹å†™åˆ°è¡¨è¾¾å¼çš„å·¦è¾¹ã€‚æ‰€ä»¥ï¼Œä¸‹è¿°å£°æ˜ï¼š 12int *p;int a[3]; æŒ‡æ˜äº† p æ˜¯ä¸€ä¸ªintç±»å‹çš„æŒ‡é’ˆï¼Œå› ä¸º *pçš„ç±»å‹ä¸ºintã€‚è€Œ a æ˜¯ä¸€ä¸ª int æ•°ç»„ï¼Œå› ä¸º a[3]çš„ç±»å‹ä¸º intï¼ˆåˆ«ç®¡è¿™é‡Œå‡ºç°çš„ç´¢å¼•å€¼ï¼Œå®ƒåªæ˜¯ç”¨äºæŒ‡æ˜æ•°ç»„çš„é•¿åº¦ï¼‰ã€‚ æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹å‡½æ•°å£°æ˜çš„æƒ…å†µã€‚C çš„å‡½æ•°å£°æ˜ä¸­å…³äºå‚æ•°çš„ç±»å‹æ˜¯å†™åœ¨æ‹¬å·å¤–çš„ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š 1234int main(argc, argv) int argc; char *argv[];&#123; /* ... */ &#125; å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° main ä¹‹æ‰€ä»¥æ˜¯å‡½æ•°ï¼Œæ˜¯å› ä¸ºè¡¨è¾¾å¼ main(argc, argv) è¿”å› intã€‚åœ¨ç°ä»£è®°æ³•ä¸­æˆ‘ä»¬æ˜¯è¿™ä¹ˆå†™çš„ï¼š 1int main(int argc, char *argv[]) &#123; /* ... */ &#125; å°½ç®¡çœ‹èµ·æ¥æœ‰äº›ä¸åŒï¼Œä½†æ˜¯åŸºæœ¬çš„ç»“æ„æ˜¯ä¸€æ ·çš„ã€‚ æ€»çš„æ¥çœ‹ï¼Œå½“ç±»å‹æ¯”è¾ƒç®€å•æ—¶ï¼ŒCçš„è¯­æ³•æ˜¾å¾—å¾ˆèªæ˜ã€‚ä½†æ˜¯é—æ†¾çš„æ˜¯ä¸€æ—¦ç±»å‹å¼€å§‹å¤æ‚ï¼ŒCçš„è¿™å¥—è¯­æ³•å¾ˆå¿«å°±èƒ½è®©äººè¿·ç³Šäº†ã€‚è‘—åçš„ä¾‹å­å¦‚å‡½æ•°æŒ‡é’ˆï¼Œæˆ‘ä»¬å¾—æŒ‰ä¸‹é¢è¿™æ ·æ¥å†™ï¼š 1int (*fp)(int a, int b); åœ¨è¿™å„¿ï¼Œfp ä¹‹æ‰€ä»¥æ˜¯ä¸€ä¸ªæŒ‡é’ˆæ˜¯å› ä¸ºå¦‚æœä½ å†™å‡º (*fp)(a, b) è¿™æ ·çš„è¡¨è¾¾å¼å°†ä¼šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå…¶è¿”å› int ç±»å‹çš„å€¼ã€‚å¦‚æœå½“ fp çš„æŸä¸ªå‚æ•°æœ¬èº«åˆæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæƒ…å†µä¼šæ€æ ·å‘¢ï¼Ÿ 1int (*fp)(int (*ff)(int x, int y), int b) è¿™è¯»èµ·æ¥å¯å°±ç‚¹éš¾äº†ã€‚ å½“ç„¶äº†ï¼Œæˆ‘ä»¬å£°æ˜å‡½æ•°æ—¶æ˜¯å¯ä»¥ä¸å†™æ˜å‚æ•°çš„åç§°çš„ï¼Œå› æ­¤ main å‡½æ•°å¯ä»¥å£°æ˜ä¸ºï¼š int main(int, char *[]) å›æƒ³ä¸€ä¸‹ï¼Œä¹‹å‰ argv æ˜¯ä¸‹é¢è¿™æ ·çš„ 1char *argv[] ä½ æœ‰æ²¡æœ‰å‘ç°ä½ æ˜¯ä»å£°æ˜çš„ã€Œä¸­é—´ã€å»æ‰å˜é‡åè€Œåæ„é€ å‡ºå…¶å˜é‡ç±»å‹çš„ï¼Ÿå°½ç®¡è¿™ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä½†ä½ å£°æ˜æŸä¸ª char *[]ç±»å‹çš„å˜é‡çš„æ—¶å€™ï¼Œç«Ÿç„¶éœ€è¦æŠŠåå­—æ’å…¥åˆ°å˜é‡ç±»å‹çš„ä¸­é—´ã€‚æˆ‘ä»¬å†æ¥çœ‹çœ‹ï¼Œå¦‚æœæˆ‘ä»¬ä¸å‘½å fp çš„å‚æ•°ä¼šæ€æ ·ï¼š 1int (*fp)(int (*)(int, int), int) è¿™ä¸œè¥¿éš¾æ‡‚çš„åœ°æ–¹å¯ä¸ä»…ä»…æ˜¯è¦è®°å¾—å‚æ•°ååŸæœ¬æ˜¯æ”¾è¿™ä¸­é—´çš„ 1int (*)(int, int) å®ƒæ›´è®©äººæ··æ·†çš„åœ°æ–¹è¿˜åœ¨äºç”šè‡³å¯èƒ½éƒ½æä¸æ¸…è¿™ç«Ÿç„¶æ˜¯ä¸ªå‡½æ•°æŒ‡é’ˆå£°æ˜ã€‚æˆ‘ä»¬æ¥ç€çœ‹çœ‹ï¼Œå¦‚æœè¿”å›å€¼ä¹Ÿæ˜¯ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹åˆä¼šæ€ä¹ˆæ · 1int (*(*fp)(int (*)(int, int), int))(int, int) è¿™å·²ç»å¾ˆéš¾çœ‹å‡ºæ˜¯å…³äº fp çš„å£°æ˜äº†ã€‚ ä½ è‡ªå·±è¿˜å¯ä»¥æ„å»ºå‡ºæ¯”è¿™æ›´å¤æ‚çš„ä¾‹å­ï¼Œä½†è¿™å·²ç»è¶³ä»¥è§£é‡Š C çš„å£°æ˜è¯­æ³•å¼•å…¥çš„æŸäº›å¤æ‚æ€§äº†ã€‚è¿˜æœ‰ä¸€ç‚¹éœ€è¦æŒ‡å‡ºï¼Œç”±äºç±»å‹è¯­æ³•å’Œå£°æ˜è¯­æ³•æ˜¯ä¸€æ ·çš„ï¼Œè¦è§£æä¸­é—´å¸¦æœ‰ç±»å‹çš„è¡¨è¾¾å¼å¯èƒ½ä¼šæœ‰äº›éš¾åº¦ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆï¼ŒC åœ¨åšç±»å‹è½¬æ¢çš„æ—¶å€™æ€»æ˜¯è¦æŠŠç±»å‹ç”¨æ‹¬å·æ‹¬èµ·æ¥çš„åŸå› ï¼Œåƒè¿™æ · 1(int)M_PI Go çš„è¯­æ³•éCå®¶æ—çš„è¯­è¨€é€šå¸¸åœ¨å£°æ˜æ—¶ä½¿ç”¨ä¸€ç§ä¸åŒçš„ç±»å‹è¯­æ³•ã€‚ä¸€èˆ¬æ˜¯åå­—å…ˆå‡ºç°ï¼Œç„¶åå¸¸å¸¸è·Ÿç€ä¸€ä¸ªå†’å·ã€‚æŒ‰ç…§è¿™æ ·æ¥å†™ï¼Œæˆ‘ä»¬ä¸Šé¢æ‰€ä¸¾çš„ä¾‹å­å°±ä¼šå˜æˆä¸‹é¢è¿™æ ·ï¼š 123x: intp: pointer to inta: array[3] of int è¿™æ ·çš„å£°æ˜å³ä¾¿æœ‰äº›å†—é•¿ï¼Œå½“è‡³å°‘æ˜¯æ¸…æ™°çš„â€”â€”ä½ åªéœ€ä»å·¦å‘å³è¯»å°±è¡Œã€‚Go è¯­è¨€æ‰€é‡‡ç”¨çš„æ–¹æ¡ˆå°±æ˜¯ä»¥æ­¤ä¸ºåŸºç¡€çš„ï¼Œä½†ä¸ºäº†è¿½æ±‚ç®€æ´æ€§ï¼ŒGo è¯­è¨€ä¸¢æ‰äº†å†’å·å¹¶å»æ‰äº†éƒ¨åˆ†å…³é”®è¯ï¼Œæˆäº†ä¸‹é¢è¿™æ ·ï¼š 123x intp *inta [3]int åœ¨ [3]int å’Œè¡¨è¾¾å¼ä¸­ açš„ç”¨æ³•æ²¡æœ‰ç›´æ¥çš„å¯¹åº”å…³ç³»ï¼ˆæˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚ä¼šå›è¿‡å¤´æ¥æ¢è®¨æŒ‡é’ˆçš„é—®é¢˜ï¼‰ã€‚è‡³æ­¤ï¼Œä½ è·å¾—äº†ä»£ç æ¸…æ™°æ€§æ–¹é¢çš„æå‡ï¼Œä½†ä»˜å‡ºçš„ä»£ä»·æ˜¯è¯­æ³•ä¸Šéœ€è¦åŒºåˆ«å¯¹å¾…ã€‚ ä¸‹é¢æˆ‘ä»¬æ¥è€ƒè™‘å‡½æ•°çš„é—®é¢˜ã€‚è™½ç„¶åœ¨ Go è¯­è¨€é‡Œï¼Œmain å‡½æ•°å®é™…ä¸Šæ²¡æœ‰å‚æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬å…ˆèªŠæŠ„ä¸€ä¸‹ä¹‹å‰çš„ main å‡½æ•°çš„å£°æ˜ï¼š 1func main(argc int, argv *[]byte) int ç²—ç•¥ä¸€çœ‹å’Œ C æ²¡ä»€ä¹ˆä¸åŒï¼Œä¸è¿‡è‡ªå·¦å‘å³è¯»çš„è¯è¿˜ä¸é”™ã€‚main å‡½æ•°æ¥å—ä¸€ä¸ª int å’Œä¸€ä¸ªæŒ‡é’ˆå¹¶è¿”å›ä¸€ä¸ªintã€‚å¦‚æœæ­¤æ—¶æŠŠå‚æ•°åå»æ‰ï¼Œå®ƒè¿˜æ˜¯å¾ˆæ¸…æ¥šâ€”â€”å› ä¸ºå‚æ•°åæ€»åœ¨ç±»å‹çš„å‰é¢ï¼Œæ‰€ä»¥ä¸ä¼šå¼•èµ·æ··æ·†ã€‚ 1func main(int, *[]byte) int è¿™ç§è‡ªå·¦å‘å³é£æ ¼çš„å£°æ˜çš„ä¸€ä¸ªä»·å€¼åœ¨äºï¼Œå½“ç±»å‹å˜å¾—æ›´å¤æ‚æ—¶ï¼Œå®ƒä¾ç„¶ç›¸å¯¹ç®€å•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå‡½æ•°å˜é‡çš„å£°æ˜ï¼ˆç›¸å½“äº C è¯­è¨€é‡Œçš„å‡½æ•°æŒ‡é’ˆï¼‰ 1f func(func(int,int) int, int) int æˆ–è€…å½“å®ƒè¿”å›ä¸€ä¸ªå‡½æ•°æ—¶ï¼š 1f func(func(int,int) int, int) func(int, int) int ä¸Šé¢çš„å£°æ˜è¯»èµ·æ¥è¿˜æ˜¯å¾ˆæ¸…æ™°ï¼Œè‡ªå·¦å‘å³ï¼Œè€Œä¸”ç©¶ç«Ÿå“ªä¸€ä¸ªå˜é‡åæ˜¯å½“å‰è¢«å£°æ˜çš„ä¹Ÿå®¹æ˜“çœ‹æ‡‚â€”â€”å› ä¸ºå˜é‡åæ°¸è¿œåœ¨é¦–ä½ã€‚ç±»å‹è¯­æ³•å’Œè¡¨è¾¾å¼è¯­æ³•å¸¦æ¥çš„å·®åˆ«ä½¿å¾—åœ¨ Go è¯­è¨€é‡Œè°ƒç”¨é—­åŒ…ä¹Ÿå˜å¾—æ›´ç®€å•ï¼š 1sum := func(a, b int) int &#123; return a+b &#125; (3, 4) æŒ‡é’ˆæŒ‡é’ˆæœ‰äº›ä¾‹å¤–ã€‚æ³¨æ„åœ¨æ•°ç»„ (array )å’Œåˆ‡ç‰‡ (slice) ä¸­ï¼ŒGo çš„ç±»å‹è¯­æ³•æŠŠæ–¹æ‹¬å·æ”¾åœ¨äº†ç±»å‹çš„å·¦è¾¹ï¼Œä½†æ˜¯åœ¨è¡¨è¾¾å¼è¯­æ³•ä¸­å´åˆæŠŠæ–¹æ‹¬å·æ”¾åˆ°äº†å³è¾¹ï¼š 12var a []intx = a[1] ç±»ä¼¼çš„ï¼ŒGo çš„æŒ‡é’ˆæ²¿ç”¨äº† C çš„ * è®°æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬å†™çš„æ—¶å€™ä¹Ÿæ˜¯å£°æ˜æ—¶ åœ¨å˜é‡åå³è¾¹ï¼Œä½†åœ¨è¡¨è¾¾å¼ä¸­å´åˆå¾—æŠŠ æ”¾åˆ°å·¦å·¦è¾¹ï¼š 12var p *intx = *p ä¸èƒ½å†™æˆä¸‹é¢è¿™æ · 12var p *intx = p* å› ä¸ºåç¼€çš„ * å¯èƒ½ä¼šå’Œä¹˜æ³•è¿ç®—æ··æ·†ï¼Œä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥æ”¹ç”¨ Pascal çš„ ^ æ ‡è®°ï¼Œåƒè¿™æ · 12var p ^intx = p^ æˆ‘ä»¬ä¹Ÿè®¸è¿˜çœŸçš„åº”è¯¥æŠŠ * åƒä¸Šé¢è¿™æ ·æ”¹æˆ ^ ï¼ˆå½“ç„¶è¿™ä¹ˆä¸€æ”¹ xor è¿ç®—çš„ç¬¦å·ä¹Ÿå¾—æ”¹ï¼‰ï¼Œå› ä¸ºåœ¨ç±»å‹å’Œè¡¨è¾¾å¼ä¸­çš„ * å‰ç¼€ç¡®å®æŠŠå¥½äº›äº‹å„¿éƒ½æå¾—æœ‰ç‚¹å¤æ‚ï¼Œä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ 1[]int(\"hi\") ä½†åœ¨è½¬æ¢æ—¶ï¼Œå¦‚æœç±»å‹æ˜¯ä»¥ * å¼€å¤´çš„ï¼Œå°±å¾—åŠ ä¸Šæ‹¬å·ï¼š 1(*int)(nil) å¦‚æœæœ‰ä¸€å¤©æˆ‘ä»¬æ„¿æ„æ”¾å¼ƒç”¨ *ä½œä¸ºæŒ‡é’ˆè¯­æ³•çš„è¯ï¼Œé‚£ä¹ˆä¸Šé¢çš„æ‹¬å·å°±å¯ä»¥çœç•¥äº†ã€‚ å¯è§ï¼ŒGo çš„æŒ‡é’ˆè¯­æ³•æ˜¯å’Œ C ç›¸ä¼¼çš„ã€‚ä½†è¿™ç§ç›¸ä¼¼ä¹Ÿæ„å‘³ç€æˆ‘ä»¬æ— æ³•å½»åº•é¿å…åœ¨æ–‡æ³•ä¸­æœ‰æ—¶ä¸ºäº†é¿å…ç±»å‹å’Œè¡¨è¾¾å¼çš„æ­§ä¹‰éœ€è¦è¡¥å……æ‹¬å·çš„æƒ…å†µã€‚ æ€»è€Œè¨€ä¹‹ï¼Œå°½ç®¡å­˜åœ¨ä¸è¶³ï¼Œä½†æˆ‘ä»¬ç›¸ä¿¡ Go çš„ç±»å‹è¯­æ³•è¦æ¯” C çš„å®¹æ˜“æ‡‚ã€‚ç‰¹åˆ«æ˜¯å½“ç±»å‹æ¯”è¾ƒå¤æ‚æ—¶ã€‚ æˆ‘æ“¦ï¼Œè¿™è¾¹æ–‡ç« è¢«çŸ¥è¯†åº“æ”¶å½•è€Œä¸”ä¸Šäº†é¦–é¡µï¼Œå“æ­»å®å®äº†ã€‚èµ¶ç´§æ”¹ä¸ªBugå‹å‹æƒŠ=_=","categories":[{"name":"Goè¯­è¨€","slug":"Goè¯­è¨€","permalink":"http://github.com/categories/Goè¯­è¨€/"}],"tags":[{"name":"Goè¯­è¨€","slug":"Goè¯­è¨€","permalink":"http://github.com/tags/Goè¯­è¨€/"}],"keywords":[{"name":"Goè¯­è¨€","slug":"Goè¯­è¨€","permalink":"http://github.com/categories/Goè¯­è¨€/"}]},{"title":"ã€Machine Learningã€‘æœºå™¨å­¦ä¹ ï¼šç®€æ˜å…¥é—¨æŒ‡å—","slug":"ã€Machine Learningã€‘æœºå™¨å­¦ä¹ ï¼šç®€æ˜å…¥é—¨æŒ‡å—","date":"2016-08-14T09:32:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/08/14/ã€Machine Learningã€‘æœºå™¨å­¦ä¹ ï¼šç®€æ˜å…¥é—¨æŒ‡å—/","link":"","permalink":"http://github.com/2016/08/14/ã€Machine Learningã€‘æœºå™¨å­¦ä¹ ï¼šç®€æ˜å…¥é—¨æŒ‡å—/","excerpt":"æœ¬æ–‡æ˜¯ä¸€ç¯‡è½¬è½½è‡ªä¼¯ä¹åœ¨çº¿çš„è¯‘æ–‡ï¼Œè‹±æ–‡åŸæ–‡æ˜¯è¿™é‡Œï¼šMachine Learning is Fun! â€” by Adam Geitgey åœ¨å¬åˆ°äººä»¬è°ˆè®ºæœºå™¨å­¦ä¹ çš„æ—¶å€™ï¼Œä½ æ˜¯ä¸æ˜¯å¯¹å®ƒçš„æ¶µä¹‰åªæœ‰å‡ ä¸ªæ¨¡ç³Šçš„è®¤è¯†å‘¢ï¼Ÿä½ æ˜¯ä¸æ˜¯å·²ç»åŒå€¦äº†åœ¨å’ŒåŒäº‹äº¤è°ˆæ—¶åªèƒ½ä¸€ç›´ç‚¹å¤´ï¼Ÿè®©æˆ‘ä»¬æ”¹å˜ä¸€ä¸‹å§ï¼ æœ¬æŒ‡å—çš„è¯»è€…å¯¹è±¡æ˜¯æ‰€æœ‰å¯¹æœºå™¨å­¦ä¹ æœ‰æ±‚çŸ¥æ¬²ä½†å´ä¸çŸ¥é“å¦‚ä½•å¼€å¤´çš„æœ‹å‹ã€‚æˆ‘çŒœå¾ˆå¤šäººå·²ç»è¯»è¿‡äº†â€œæœºå™¨å­¦ä¹ â€ â€”â€”ç»´åŸºç™¾ç§‘è¯æ¡ï¼Œå€æ„ŸæŒ«æŠ˜ï¼Œä»¥ä¸ºæ²¡äººèƒ½ç»™å‡ºä¸€ä¸ªé«˜å±‚æ¬¡çš„è§£é‡Šã€‚æœ¬æ–‡å°±æ˜¯ä½ ä»¬æƒ³è¦çš„ä¸œè¥¿ã€‚ æœ¬æ–‡ç›®æ ‡åœ¨äºå¹³æ˜“è¿‘äººï¼Œè¿™æ„å‘³ç€æ–‡ä¸­æœ‰å¤§é‡çš„æ¦‚æ‹¬ã€‚ä½†æ˜¯è°åœ¨ä¹è¿™äº›å‘¢ï¼Ÿåªè¦èƒ½è®©è¯»è€…å¯¹äºMLæ›´æ„Ÿå…´è¶£ï¼Œä»»åŠ¡ä¹Ÿå°±å®Œæˆäº†ã€‚","text":"æœ¬æ–‡æ˜¯ä¸€ç¯‡è½¬è½½è‡ªä¼¯ä¹åœ¨çº¿çš„è¯‘æ–‡ï¼Œè‹±æ–‡åŸæ–‡æ˜¯è¿™é‡Œï¼šMachine Learning is Fun! â€” by Adam Geitgey åœ¨å¬åˆ°äººä»¬è°ˆè®ºæœºå™¨å­¦ä¹ çš„æ—¶å€™ï¼Œä½ æ˜¯ä¸æ˜¯å¯¹å®ƒçš„æ¶µä¹‰åªæœ‰å‡ ä¸ªæ¨¡ç³Šçš„è®¤è¯†å‘¢ï¼Ÿä½ æ˜¯ä¸æ˜¯å·²ç»åŒå€¦äº†åœ¨å’ŒåŒäº‹äº¤è°ˆæ—¶åªèƒ½ä¸€ç›´ç‚¹å¤´ï¼Ÿè®©æˆ‘ä»¬æ”¹å˜ä¸€ä¸‹å§ï¼ æœ¬æŒ‡å—çš„è¯»è€…å¯¹è±¡æ˜¯æ‰€æœ‰å¯¹æœºå™¨å­¦ä¹ æœ‰æ±‚çŸ¥æ¬²ä½†å´ä¸çŸ¥é“å¦‚ä½•å¼€å¤´çš„æœ‹å‹ã€‚æˆ‘çŒœå¾ˆå¤šäººå·²ç»è¯»è¿‡äº†â€œæœºå™¨å­¦ä¹ â€ â€”â€”ç»´åŸºç™¾ç§‘è¯æ¡ï¼Œå€æ„ŸæŒ«æŠ˜ï¼Œä»¥ä¸ºæ²¡äººèƒ½ç»™å‡ºä¸€ä¸ªé«˜å±‚æ¬¡çš„è§£é‡Šã€‚æœ¬æ–‡å°±æ˜¯ä½ ä»¬æƒ³è¦çš„ä¸œè¥¿ã€‚ æœ¬æ–‡ç›®æ ‡åœ¨äºå¹³æ˜“è¿‘äººï¼Œè¿™æ„å‘³ç€æ–‡ä¸­æœ‰å¤§é‡çš„æ¦‚æ‹¬ã€‚ä½†æ˜¯è°åœ¨ä¹è¿™äº›å‘¢ï¼Ÿåªè¦èƒ½è®©è¯»è€…å¯¹äºMLæ›´æ„Ÿå…´è¶£ï¼Œä»»åŠ¡ä¹Ÿå°±å®Œæˆäº†ã€‚ ä½•ä¸ºæœºå™¨å­¦ä¹ ï¼Ÿæœºå™¨å­¦ä¹ è¿™ä¸ªæ¦‚å¿µè®¤ä¸ºï¼Œå¯¹äºå¾…è§£é—®é¢˜ï¼Œä½ æ— éœ€ç¼–å†™ä»»ä½•ä¸“é—¨çš„ç¨‹åºä»£ç ï¼Œé—ä¼ ç®—æ³•ï¼ˆgeneric algorithmsï¼‰èƒ½å¤Ÿåœ¨æ•°æ®é›†ä¸Šä¸ºä½ å¾—å‡ºæœ‰è¶£çš„ç­”æ¡ˆã€‚å¯¹äºé—ä¼ ç®—æ³•ï¼Œä¸ç”¨ç¼–ç ï¼Œè€Œæ˜¯å°†æ•°æ®è¾“å…¥ï¼Œå®ƒå°†åœ¨æ•°æ®ä¹‹ä¸Šå»ºç«‹èµ·å®ƒè‡ªå·±çš„é€»è¾‘ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰ä¸€ç±»ç®—æ³•ç§°ä¸ºåˆ†ç±»ç®—æ³•ï¼Œå®ƒå¯ä»¥å°†æ•°æ®åˆ’åˆ†ä¸ºä¸åŒçš„ç»„åˆ«ã€‚ä¸€ä¸ªç”¨æ¥è¯†åˆ«æ‰‹å†™æ•°å­—çš„åˆ†ç±»ç®—æ³•ï¼Œä¸ç”¨ä¿®æ”¹ä¸€è¡Œä»£ç ï¼Œå°±å¯ä»¥ç”¨æ¥å°†ç”µå­é‚®ä»¶åˆ†ä¸ºåƒåœ¾é‚®ä»¶å’Œæ™®é€šé‚®ä»¶ã€‚ç®—æ³•æ²¡å˜ï¼Œä½†æ˜¯è¾“å…¥çš„è®­ç»ƒæ•°æ®å˜äº†ï¼Œå› æ­¤å®ƒå¾—å‡ºäº†ä¸åŒçš„åˆ†ç±»é€»è¾‘ã€‚ æœºå™¨å­¦ä¹ ç®—æ³•æ˜¯ä¸ªé»‘ç›’ï¼Œå¯ä»¥é‡ç”¨æ¥è§£å†³å¾ˆå¤šä¸åŒçš„åˆ†ç±»é—®é¢˜ã€‚ â€œæœºå™¨å­¦ä¹ â€æ˜¯ä¸€ä¸ªæ¶µç›–æ€§æœ¯è¯­ï¼Œè¦†ç›–äº†å¤§é‡ç±»ä¼¼çš„é—ä¼ ç®—æ³•ã€‚ ä¸¤ç±»æœºå™¨å­¦ä¹ ç®—æ³•ä½ å¯ä»¥è®¤ä¸ºæœºå™¨å­¦ä¹ ç®—æ³•åˆ†ä¸ºä¸¤å¤§ç±»ï¼šç›‘ç£å¼å­¦ä¹ ï¼ˆSupervised Learningï¼‰å’Œéç›‘ç£å¼å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰ã€‚ä¸¤è€…åŒºåˆ«å¾ˆç®€å•ï¼Œä½†å´éå¸¸é‡è¦ã€‚ ç›‘ç£å¼å­¦ä¹ å‡è®¾ä½ æ˜¯ä¸€åæˆ¿äº§ç»çºªï¼Œç”Ÿæ„è¶Šåšè¶Šå¤§ï¼Œå› æ­¤ä½ é›‡äº†ä¸€æ‰¹å®ä¹ ç”Ÿæ¥å¸®ä½ ã€‚ä½†æ˜¯é—®é¢˜æ¥äº†â€”â€”ä½ å¯ä»¥çœ‹ä¸€çœ¼æˆ¿å­å°±çŸ¥é“å®ƒåˆ°åº•å€¼å¤šå°‘é’±ï¼Œå®ä¹ ç”Ÿæ²¡æœ‰ç»éªŒï¼Œä¸çŸ¥é“å¦‚ä½•ä¼°ä»·ã€‚ ä¸ºäº†å¸®åŠ©ä½ çš„å®ä¹ ç”Ÿï¼ˆä¹Ÿè®¸æ˜¯ä¸ºäº†è§£æ”¾ä½ è‡ªå·±å»åº¦ä¸ªå‡ï¼‰ï¼Œä½ å†³å®šå†™ä¸ªå°è½¯ä»¶ï¼Œå¯ä»¥æ ¹æ®æˆ¿å±‹å¤§å°ã€åœ°æ®µä»¥åŠç±»ä¼¼æˆ¿å±‹çš„æˆäº¤ä»·ç­‰å› ç´ æ¥è¯„ä¼°ä½ æ‰€åœ¨åœ°åŒºæˆ¿å±‹çš„ä»·å€¼ã€‚ ä½ æŠŠ3ä¸ªæœˆæ¥åŸé‡Œæ¯ç¬”æˆ¿å±‹äº¤æ˜“éƒ½å†™äº†ä¸‹æ¥ï¼Œæ¯ä¸€å•ä½ éƒ½è®°å½•äº†ä¸€é•¿ä¸²çš„ç»†èŠ‚â€”â€”å§å®¤æ•°é‡ã€æˆ¿å±‹å¤§å°ã€åœ°æ®µç­‰ç­‰ã€‚ä½†æœ€é‡è¦çš„æ˜¯ï¼Œä½ å†™ä¸‹äº†æœ€ç»ˆçš„æˆäº¤ä»·ï¼š è¿™æ˜¯æˆ‘ä»¬çš„â€œè®­ç»ƒæ•°æ®â€: æˆ‘ä»¬è¦åˆ©ç”¨è¿™äº›è®­ç»ƒæ•°æ®æ¥ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥ä¼°ç®—è¯¥åœ°åŒºå…¶ä»–æˆ¿å±‹çš„ä»·å€¼ï¼š è¿™å°±ç§°ä¸ºç›‘ç£å¼å­¦ä¹ ã€‚ä½ å·²ç»çŸ¥é“æ¯ä¸€æ ‹æˆ¿å±‹çš„å”®ä»·ï¼Œæ¢å¥è¯è¯´ï¼Œä½ çŸ¥é“é—®é¢˜çš„ç­”æ¡ˆï¼Œå¹¶å¯ä»¥åå‘æ‰¾å‡ºè§£é¢˜çš„é€»è¾‘ã€‚ ä¸ºäº†ç¼–å†™è½¯ä»¶ï¼Œä½ å°†åŒ…å«æ¯ä¸€å¥—æˆ¿äº§çš„è®­ç»ƒæ•°æ®è¾“å…¥ä½ çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ç®—æ³•å°è¯•æ‰¾å‡ºåº”è¯¥ä½¿ç”¨ä½•ç§è¿ç®—æ¥å¾—å‡ºä»·æ ¼æ•°å­—ã€‚ è¿™å°±åƒæ˜¯ç®—æœ¯ç»ƒä¹ é¢˜ï¼Œç®—å¼ä¸­çš„è¿ç®—ç¬¦å·éƒ½è¢«æ“¦å»äº†ï¼šå¤©å“ªï¼ä¸€ä¸ªé˜´é™©çš„å­¦ç”Ÿå°†è€å¸ˆç­”æ¡ˆä¸Šçš„ç®—æœ¯ç¬¦å·å…¨æ“¦å»äº†ã€‚ çœ‹äº†è¿™äº›é¢˜ï¼Œä½ èƒ½æ˜ç™½è¿™äº›æµ‹éªŒé‡Œé¢æ˜¯ä»€ä¹ˆæ ·çš„æ•°å­¦é—®é¢˜å—ï¼Ÿä½ çŸ¥é“ï¼Œä½ åº”è¯¥å¯¹ç®—å¼å·¦è¾¹çš„æ•°å­—â€œåšäº›ä»€ä¹ˆâ€ä»¥å¾—å‡ºç®—å¼å³è¾¹çš„ç­”æ¡ˆã€‚ åœ¨ç›‘ç£å¼å­¦ä¹ ä¸­ï¼Œä½ æ˜¯è®©è®¡ç®—æœºä¸ºä½ ç®—å‡ºæ•°å­—é—´çš„å…³ç³»ã€‚è€Œä¸€æ—¦ä½ çŸ¥é“äº†è§£å†³è¿™ç±»ç‰¹å®šé—®é¢˜æ‰€éœ€è¦çš„æ•°å­¦æ–¹æ³•åï¼Œä½ å°±å¯ä»¥è§£ç­”åŒç±»çš„å…¶å®ƒé—®é¢˜äº†ã€‚ éç›‘ç£å¼å­¦ä¹ è®©æˆ‘ä»¬å›åˆ°å¼€å¤´é‚£ä¸ªæˆ¿åœ°äº§ç»çºªçš„ä¾‹å­ã€‚è¦æ˜¯ä½ ä¸çŸ¥é“æ¯æ ‹æˆ¿å­çš„å”®ä»·æ€ä¹ˆåŠï¼Ÿå³ä½¿ä½ æ‰€çŸ¥é“çš„åªæ˜¯æˆ¿å±‹çš„å¤§å°ã€ä½ç½®ç­‰ä¿¡æ¯ï¼Œä½ ä¹Ÿå¯ä»¥æå‡ºå¾ˆé…·çš„èŠ±æ ·ã€‚è¿™å°±æ˜¯æ‰€è°“çš„éç›‘ç£å¼å­¦ä¹ ã€‚ å³ä½¿ä½ ä¸æ˜¯æƒ³å»é¢„æµ‹æœªçŸ¥çš„æ•°æ®ï¼ˆå¦‚ä»·æ ¼ï¼‰ï¼Œä½ ä¹Ÿå¯ä»¥è¿ç”¨æœºå™¨å­¦ä¹ å®Œæˆä¸€äº›æœ‰æ„æ€çš„äº‹ã€‚ è¿™å°±æœ‰ç‚¹åƒæœ‰äººç»™ä½ ä¸€å¼ çº¸ï¼Œä¸Šé¢åˆ—å‡ºäº†å¾ˆå¤šæ•°å­—ï¼Œç„¶åå¯¹ä½ è¯´:â€œæˆ‘ä¸çŸ¥é“è¿™äº›æ•°å­—æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œä¹Ÿè®¸ä½ èƒ½ä»ä¸­æ‰¾å‡ºè§„å¾‹æˆ–æ˜¯èƒ½å°†å®ƒä»¬åˆ†ç±»ï¼Œæˆ–æ˜¯å…¶å®ƒä»€ä¹ˆ-ç¥ä½ å¥½è¿ï¼â€ ä½ è¯¥æ€ä¹ˆå¤„ç†è¿™äº›æ•°æ®å‘¢ï¼Ÿé¦–å…ˆï¼Œä½ å¯ä»¥ç”¨ä¸ªç®—æ³•è‡ªåŠ¨åœ°ä»æ•°æ®ä¸­åˆ’åˆ†å‡ºä¸åŒçš„ç»†åˆ†å¸‚åœºã€‚ä¹Ÿè®¸ä½ ä¼šå‘ç°å¤§å­¦é™„è¿‘çš„ä¹°æˆ¿è€…å–œæ¬¢æˆ·å‹å°ä½†å§å®¤å¤šçš„æˆ¿å­ï¼Œè€ŒéƒŠåŒºçš„ä¹°æˆ¿è€…åå¥½ä¸‰å§å®¤çš„å¤§æˆ·å‹ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥ç›´æ¥å¸®åŠ©ä½ çš„è¥é”€ã€‚ ä½ è¿˜å¯ä»¥ä½œä»¶å¾ˆé…·çš„äº‹ï¼Œè‡ªåŠ¨æ‰¾å‡ºæˆ¿ä»·çš„ç¦»ç¾¤æ•°æ®ï¼Œå³ä¸å…¶å®ƒæ•°æ®è¿¥å¼‚çš„å€¼ã€‚è¿™äº›é¹¤ç«‹é¸¡ç¾¤çš„æˆ¿äº§ä¹Ÿè®¸æ˜¯é«˜æ¥¼å¤§å¦ï¼Œè€Œä½ å¯ä»¥å°†æœ€ä¼˜ç§€çš„æ¨é”€å‘˜é›†ä¸­åœ¨è¿™äº›åœ°åŒºï¼Œå› ä¸ºä»–ä»¬çš„ä½£é‡‘æ›´é«˜ã€‚ æœ¬æ–‡ä½™ä¸‹éƒ¨åˆ†æˆ‘ä»¬ä¸»è¦è®¨è®ºç›‘ç£å¼å­¦ä¹ ï¼Œä½†è¿™å¹¶ä¸æ˜¯å› ä¸ºéç›‘ç£å¼å­¦ä¹ ç”¨å¤„ä¸å¤§æˆ–æ˜¯ç´¢ç„¶æ— å‘³ã€‚å®é™…ä¸Šï¼Œéšç€ç®—æ³•æ”¹è‰¯ï¼Œä¸ç”¨å°†æ•°æ®å’Œæ­£ç¡®ç­”æ¡ˆè”ç³»åœ¨ä¸€èµ·ï¼Œå› æ­¤éç›‘ç£å¼å­¦ä¹ æ­£å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚ è€å­¦ç©¶è¯·çœ‹:è¿˜æœ‰å¾ˆå¤šå…¶å®ƒç§ç±»çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ä½†åˆå­¦æ—¶è¿™æ ·ç†è§£ä¸é”™äº†ã€‚ å¤ªé…·äº†ï¼Œä½†æ˜¯è¯„ä¼°æˆ¿ä»·çœŸèƒ½è¢«çœ‹ä½œâ€œå­¦ä¹ â€å—ï¼Ÿä½œä¸ºäººç±»çš„ä¸€å‘˜ï¼Œä½ çš„å¤§è„‘å¯ä»¥åº”ä»˜ç»å¤§å¤šæ•°æƒ…å†µï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•æ˜ç¡®æŒ‡ä»¤ä¹Ÿèƒ½å¤Ÿå­¦ä¹ å¦‚ä½•å¤„ç†è¿™äº›æƒ…å†µã€‚å¦‚æœä½ åšæˆ¿äº§ç»çºªæ—¶é—´å¾ˆé•¿ï¼Œä½ å¯¹äºæˆ¿äº§çš„åˆé€‚å®šä»·ã€å®ƒçš„æœ€ä½³è¥é”€æ–¹å¼ä»¥åŠå“ªäº›å®¢æˆ·ä¼šæ„Ÿå…´è¶£ç­‰ç­‰éƒ½ä¼šæœ‰ä¸€ç§æœ¬èƒ½èˆ¬çš„â€œæ„Ÿè§‰â€ã€‚å¼ºäººå·¥æ™ºèƒ½ï¼ˆStrong AIï¼‰ç ”ç©¶çš„ç›®æ ‡å°±æ˜¯è¦èƒ½å¤Ÿç”¨è®¡ç®—æœºå¤åˆ¶è¿™ç§èƒ½åŠ›ã€‚ ä½†æ˜¯ç›®å‰çš„æœºå™¨å­¦ä¹ ç®—æ³•è¿˜æ²¡æœ‰é‚£ä¹ˆå¥½â€”â€”å®ƒä»¬åªèƒ½ä¸“æ³¨äºéå¸¸ç‰¹å®šçš„ã€æœ‰é™çš„é—®é¢˜ã€‚ä¹Ÿè®¸åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œâ€œå­¦ä¹ â€æ›´è´´åˆ‡çš„å®šä¹‰æ˜¯â€œåœ¨å°‘é‡èŒƒä¾‹æ•°æ®çš„åŸºç¡€ä¸Šæ‰¾å‡ºä¸€ä¸ªç­‰å¼æ¥è§£å†³ç‰¹å®šçš„é—®é¢˜â€ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œâ€œæœºå™¨åœ¨å°‘é‡èŒƒä¾‹æ•°æ®çš„åŸºç¡€ä¸Šæ‰¾å‡ºä¸€ä¸ªç­‰å¼æ¥è§£å†³ç‰¹å®šçš„é—®é¢˜â€è¿™ä¸ªåå­—å¤ªçƒ‚äº†ã€‚æ‰€ä»¥æœ€åæˆ‘ä»¬ç”¨â€œæœºå™¨å­¦ä¹ â€å–è€Œä»£ä¹‹ã€‚ å½“ç„¶ï¼Œè¦æ˜¯ä½ æ˜¯åœ¨50å¹´ä¹‹åæ¥è¯»è¿™ç¯‡æ–‡ç« ï¼Œé‚£æ—¶æˆ‘ä»¬å·²ç»å¾—å‡ºäº†å¼ºäººå·¥æ™ºèƒ½ç®—æ³•ï¼Œè€Œæœ¬æ–‡çœ‹èµ·æ¥å°±åƒä¸ªè€å¤è‘£ã€‚æœªæ¥çš„äººç±»ï¼Œä½ è¿˜æ˜¯åˆ«è¯»äº†ï¼Œå«ä½ çš„æœºå™¨ä»†äººç»™ä½ åšä»½ä¸‰æ˜æ²»å§ã€‚ è®©æˆ‘ä»¬å†™ä»£ç å§!å‰é¢ä¾‹å­ä¸­è¯„ä¼°æˆ¿ä»·çš„ç¨‹åºï¼Œä½ æ‰“ç®—æ€ä¹ˆå†™å‘¢ï¼Ÿå¾€ä¸‹çœ‹ä¹‹å‰ï¼Œå…ˆæ€è€ƒä¸€ä¸‹å§ã€‚ å¦‚æœä½ å¯¹æœºå™¨å­¦ä¹ ä¸€æ— æ‰€çŸ¥ï¼Œå¾ˆæœ‰å¯èƒ½ä½ ä¼šå°è¯•å†™å‡ºä¸€äº›åŸºæœ¬è§„åˆ™æ¥è¯„ä¼°æˆ¿ä»·ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627def estimate_house_sales_price(num_of_bedrooms, sqft, neighborhood): price = 0 # In my area, the average house costs $200 per sqft price_per_sqft = 200 if neighborhood == \"hipsterton\": # but some areas cost a bit more price_per_sqft = 400 elif neighborhood == \"skid row\": # and some areas cost less price_per_sqft = 100 # start with a base price estimate based on how big the place is price = price_per_sqft * sqft # now adjust our estimate based on the number of bedrooms if num_of_bedrooms == 0: # Studio apartments are cheap price = price â€” 20000 else: # places with more bedrooms are usually # more valuable price = price + (num_of_bedrooms * 1000) return price å‡å¦‚ä½ åƒè¿™æ ·çå¿™å‡ ä¸ªå°æ—¶ï¼Œä¹Ÿè®¸ä¼šå–å¾—ä¸€ç‚¹æˆæ•ˆï¼Œä½†æ˜¯ä½ çš„ç¨‹åºæ°¸ä¸ä¼šå®Œç¾ï¼Œè€Œä¸”å½“ä»·æ ¼å˜åŒ–æ—¶å¾ˆéš¾ç»´æŠ¤ã€‚ å¦‚æœèƒ½è®©è®¡ç®—æœºæ‰¾å‡ºå®ç°ä¸Šè¿°å‡½æ•°åŠŸèƒ½çš„åŠæ³•ï¼Œè¿™æ ·å²‚ä¸æ›´å¥½ï¼Ÿåªè¦è¿”å›çš„æˆ¿ä»·æ•°å­—æ­£ç¡®ï¼Œè°ä¼šåœ¨ä¹å‡½æ•°å…·ä½“å¹²äº†äº›ä»€ä¹ˆå‘¢ï¼Ÿ 1234def estimate_house_sales_price(num_of_bedrooms, sqft, neighborhood): price = &lt;computer, plz do some math for me&gt; return price è€ƒè™‘è¿™ä¸ªé—®é¢˜çš„ä¸€ç§è§’åº¦æ˜¯å°†æˆ¿ä»·çœ‹åšä¸€ç¢—ç¾å‘³çš„æ±¤ï¼Œè€Œæ±¤ä¸­æˆåˆ†å°±æ˜¯å§å®¤æ•°ã€é¢ç§¯å’Œåœ°æ®µã€‚å¦‚æœä½ èƒ½ç®—å‡ºæ¯ç§æˆåˆ†å¯¹æœ€ç»ˆçš„ä»·æ ¼æœ‰å¤šå¤§å½±å“ï¼Œä¹Ÿè®¸å°±èƒ½å¾—åˆ°å„ç§æˆåˆ†æ··åˆèµ·æ¥å½¢æˆæœ€ç»ˆä»·æ ¼çš„å…·ä½“æ¯”ä¾‹ã€‚ è¿™æ ·å¯ä»¥å°†ä½ æœ€åˆçš„ç¨‹åºï¼ˆå…¨æ˜¯ç–¯ç‹‚çš„if elseè¯­å¥ï¼‰ç®€åŒ–æˆç±»ä¼¼å¦‚ä¸‹çš„æ ·å­ï¼š 12345678910111213141516def estimate_house_sales_price(num_of_bedrooms, sqft, neighborhood): price = 0 # a little pinch of this price += num_of_bedrooms * .841231951398213 # and a big pinch of that price += sqft * 1231.1231231 # maybe a handful of this price += neighborhood * 2.3242341421 # and finally, just a little extra salt for good measure price += 201.23432095 return price è¯·æ³¨æ„é‚£äº›ç”¨ç²—ä½“æ ‡æ³¨çš„ç¥å¥‡æ•°å­—â€”â€”.841231951398213, 1231.1231231,2.3242341421, å’Œ201.23432095ã€‚å®ƒä»¬ç§°ä¸ºæƒé‡ã€‚å¦‚æœæˆ‘ä»¬èƒ½æ‰¾å‡ºå¯¹æ¯æ ‹æˆ¿å­éƒ½é€‚ç”¨çš„å®Œç¾æƒé‡ï¼Œæˆ‘ä»¬çš„å‡½æ•°å°±èƒ½é¢„æµ‹æ‰€æœ‰çš„æˆ¿ä»·ï¼ æ‰¾å‡ºæœ€ä½³æƒé‡çš„ä¸€ç§ç¬¨åŠæ³•å¦‚ä¸‹æ‰€ç¤ºï¼š æ­¥éª¤1ï¼šé¦–å…ˆï¼Œå°†æ¯ä¸ªæƒé‡éƒ½è®¾ä¸º1.0ï¼š 12345678910111213141516def estimate_house_sales_price(num_of_bedrooms, sqft, neighborhood): price = 0 # a little pinch of this price += num_of_bedrooms * 1.0 # and a big pinch of that price += sqft * 1.0 # maybe a handful of this price += neighborhood * 1.0 # and finally, just a little extra salt for good measure price += 1.0 return price æ­¥éª¤2ï¼šå°†æ¯æ ‹æˆ¿äº§å¸¦å…¥ä½ çš„å‡½æ•°è¿ç®—ï¼Œæ£€éªŒä¼°ç®—å€¼ä¸æ­£ç¡®ä»·æ ¼çš„åç¦»ç¨‹åº¦ï¼š è¿ç”¨ä½ çš„ç¨‹åºé¢„æµ‹æˆ¿å±‹ä»·æ ¼ã€‚ ä¾‹å¦‚ï¼šä¸Šè¡¨ä¸­ç¬¬ä¸€å¥—æˆ¿äº§å®é™…æˆäº¤ä»·ä¸º25ä¸‡ç¾å…ƒï¼Œä½ çš„å‡½æ•°ä¼°ä»·ä¸º17.8ä¸‡ï¼Œè¿™ä¸€å¥—æˆ¿äº§ä½ å°±å·®äº†7.2ä¸‡ã€‚ å†å°†ä½ çš„æ•°æ®é›†ä¸­çš„æ¯å¥—æˆ¿äº§ä¼°ä»·åç¦»å€¼å¹³æ–¹åæ±‚å’Œã€‚å‡è®¾æ•°æ®é›†ä¸­æœ‰500å¥—æˆ¿äº§äº¤æ˜“ï¼Œä¼°ä»·åç¦»å€¼å¹³æ–¹æ±‚å’Œæ€»è®¡ä¸º86,123,373ç¾å…ƒã€‚è¿™å°±åæ˜ äº†ä½ çš„å‡½æ•°ç°åœ¨çš„â€œæ­£ç¡®â€ç¨‹åº¦ã€‚ ç°åœ¨ï¼Œå°†æ€»è®¡å€¼é™¤ä»¥500ï¼Œå¾—åˆ°æ¯å¥—æˆ¿äº§çš„ä¼°ä»·åç¦»å¹³å‡å€¼ã€‚å°†è¿™ä¸ªå¹³å‡è¯¯å·®å€¼ç§°ä¸ºä½ å‡½æ•°çš„ä»£ä»·ã€‚ å¦‚æœä½ èƒ½è°ƒæ•´æƒé‡ä½¿å¾—è¿™ä¸ªä»£ä»·å˜ä¸º0ï¼Œä½ çš„å‡½æ•°å°±å®Œç¾äº†ã€‚å®ƒæ„å‘³ç€ï¼Œæ ¹æ®è¾“å…¥çš„æ•°æ®ï¼Œä½ çš„ç¨‹åºå¯¹æ¯ä¸€ç¬”æˆ¿äº§äº¤æ˜“çš„ä¼°ä»·éƒ½æ˜¯åˆ†æ¯«ä¸å·®ã€‚è€Œè¿™å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡â€”â€”å°è¯•ä¸åŒçš„æƒé‡å€¼ä»¥ä½¿ä»£ä»·å°½å¯èƒ½çš„ä½ã€‚ æ­¥éª¤3ï¼šä¸æ–­é‡å¤æ­¥éª¤2ï¼Œå°è¯•æ‰€æœ‰å¯èƒ½çš„æƒé‡å€¼ç»„åˆã€‚å“ªä¸€ä¸ªç»„åˆä½¿å¾—ä»£ä»·æœ€æ¥è¿‘äº0ï¼Œå®ƒå°±æ˜¯ä½ è¦ä½¿ç”¨çš„ï¼Œä½ åªè¦æ‰¾åˆ°äº†è¿™æ ·çš„ç»„åˆï¼Œé—®é¢˜å°±å¾—åˆ°äº†è§£å†³! æ€æƒ³æ‰°åŠ¨æ—¶é—´è¿™å¤ªç®€å•äº†ï¼Œå¯¹å§ï¼Ÿæƒ³ä¸€æƒ³åˆšæ‰ä½ åšäº†äº›ä»€ä¹ˆã€‚ä½ å–å¾—äº†ä¸€äº›æ•°æ®ï¼Œå°†å®ƒä»¬è¾“å…¥è‡³ä¸‰ä¸ªé€šç”¨çš„ç®€å•æ­¥éª¤ä¸­ï¼Œæœ€åä½ å¾—åˆ°äº†ä¸€ä¸ªå¯ä»¥å¯¹ä½ æ‰€åœ¨åŒºåŸŸçš„æˆ¿å±‹è¿›è¡Œä¼°ä»·çš„å‡½æ•°ã€‚æˆ¿ä»·ç½‘ï¼Œè¦å½“å¿ƒå’¯ï¼ä½†æ˜¯ä¸‹é¢çš„äº‹å®å¯èƒ½ä¼šæ‰°ä¹±ä½ çš„æ€æƒ³ï¼š 1.è¿‡å»40å¹´æ¥ï¼Œå¾ˆå¤šé¢†åŸŸï¼ˆå¦‚è¯­è¨€å­¦/ç¿»è¯‘å­¦ï¼‰çš„ç ”ç©¶è¡¨æ˜ï¼Œè¿™ç§é€šç”¨çš„â€œæ…åŠ¨æ•°æ®æ±¤â€ï¼ˆæˆ‘ç¼–é€ çš„è¯ï¼‰å¼çš„å­¦ä¹ ç®—æ³•å·²ç»èƒœè¿‡äº†éœ€è¦åˆ©ç”¨çœŸäººæ˜ç¡®è§„åˆ™çš„æ–¹æ³•ã€‚æœºå™¨å­¦ä¹ çš„â€œç¬¨â€åŠæ³•æœ€ç»ˆæ‰“è´¥äº†äººç±»ä¸“å®¶ã€‚ 2.ä½ æœ€åå†™å‡ºçš„å‡½æ•°çœŸæ˜¯ç¬¨ï¼Œå®ƒç”šè‡³ä¸çŸ¥é“ä»€ä¹ˆæ˜¯â€œé¢ç§¯â€å’Œâ€œå§å®¤æ•°â€ã€‚å®ƒçŸ¥é“çš„åªæ˜¯æ…åŠ¨ï¼Œæ”¹å˜æ•°å­—æ¥å¾—åˆ°æ­£ç¡®çš„ç­”æ¡ˆã€‚ 3.å¾ˆå¯èƒ½ä½ éƒ½ä¸çŸ¥é“ä¸ºä½•ä¸€ç»„ç‰¹æ®Šçš„æƒé‡å€¼èƒ½èµ·æ•ˆã€‚æ‰€ä»¥ä½ åªæ˜¯å†™å‡ºäº†ä¸€ä¸ªä½ å®é™…ä¸Šå¹¶ä¸ç†è§£å´èƒ½è¯æ˜çš„å‡½æ•°ã€‚ 4.è¯•æƒ³ä¸€ä¸‹ï¼Œä½ çš„ç¨‹åºé‡Œæ²¡æœ‰ç±»ä¼¼â€œé¢ç§¯â€å’Œâ€œå§å®¤æ•°â€è¿™æ ·çš„å‚æ•°ï¼Œè€Œæ˜¯æ¥å—äº†ä¸€ç»„æ•°å­—ã€‚å‡è®¾æ¯ä¸ªæ•°å­—ä»£è¡¨äº†ä½ è½¦é¡¶å®‰è£…çš„æ‘„åƒå¤´æ•æ‰çš„ç”»é¢ä¸­çš„ä¸€ä¸ªåƒç´ ï¼Œå†å°†é¢„æµ‹çš„è¾“å‡ºä¸ç§°ä¸ºâ€œä»·æ ¼â€è€Œæ˜¯å«åšâ€œæ–¹å‘ç›˜è½¬åŠ¨åº¦æ•°â€ï¼Œè¿™æ ·ä½ å°±å¾—åˆ°äº†ä¸€ä¸ªç¨‹åºå¯ä»¥è‡ªåŠ¨æ“çºµä½ çš„æ±½è½¦äº†ï¼ å¤ªç–¯ç‹‚äº†ï¼Œå¯¹å§ï¼Ÿ æ­¥éª¤3ä¸­çš„â€œå°è¯•æ¯ä¸ªæ•°å­—â€æ€ä¹ˆå›äº‹ï¼Ÿå¥½å§ï¼Œå½“ç„¶ä½ ä¸å¯èƒ½å°è¯•æ‰€æœ‰å¯èƒ½çš„æƒé‡å€¼æ¥æ‰¾åˆ°æ•ˆæœæœ€å¥½çš„ç»„åˆã€‚é‚£å¯çœŸè¦èŠ±å¾ˆé•¿æ—¶é—´ï¼Œå› ä¸ºè¦å°è¯•çš„æ•°å­—å¯èƒ½æ— ç©·æ— å°½ã€‚ ä¸ºé¿å…è¿™ç§æƒ…å†µï¼Œæ•°å­¦å®¶ä»¬æ‰¾åˆ°äº†å¾ˆå¤šèªæ˜çš„åŠæ³•ï¼ˆæ¯”å¦‚Gradient descentç®—æ³•ï¼‰æ¥å¿«é€Ÿæ‰¾åˆ°ä¼˜ç§€çš„æƒé‡å€¼ï¼Œè€Œä¸éœ€è¦å°è¯•è¿‡å¤šã€‚ä¸‹é¢æ˜¯å…¶ä¸­ä¸€ç§ï¼š é¦–å…ˆï¼Œå†™å‡ºä¸€ä¸ªç®€å•çš„ç­‰å¼è¡¨ç¤ºå‰è¿°æ­¥éª¤2ï¼Œè¿™æ˜¯ä½ çš„ä»£ä»·å‡½æ•°ï¼š æ¥ç€ï¼Œè®©æˆ‘ä»¬å°†è¿™åŒä¸€ä¸ªç­‰å¼ç”¨æœºå™¨å­¦ä¹ çš„æ•°å­¦æœ¯è¯­ï¼ˆç°åœ¨ä½ å¯ä»¥å¿½ç•¥å®ƒä»¬ï¼‰è¿›è¡Œé‡å†™ï¼š Î¸è¡¨ç¤ºå½“å‰çš„æƒé‡å€¼ã€‚ J(Î¸) æ„ä¸ºâ€œå½“å‰æƒé‡å€¼å¯¹åº”çš„ä»£ä»·â€ã€‚ è¿™ä¸ªç­‰å¼è¡¨ç¤ºæˆ‘ä»¬çš„ä¼°ä»·ç¨‹åºåœ¨å½“å‰æƒé‡å€¼ä¸‹åç¦»ç¨‹åº¦çš„å¤§å°ã€‚å¦‚æœå°†æ‰€æœ‰èµ‹ç»™å§å®¤æ•°å’Œé¢ç§¯çš„å¯èƒ½æƒé‡å€¼ä»¥å›¾å½¢å½¢å¼æ˜¾ç¤ºï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ç±»ä¼¼ä¸‹å›¾çš„å›¾è¡¨ï¼š ä»£ä»·å‡½æ•°çš„å›¾å½¢åƒä¸€æ”¯ç¢—ã€‚çºµè½´è¡¨ç¤ºä»£ä»·ã€‚ å›¾ä¸­è“è‰²çš„æœ€ä½ç‚¹å°±æ˜¯ä»£ä»·æœ€ä½çš„åœ°æ–¹â€”â€”å³æˆ‘ä»¬çš„ç¨‹åºåç¦»æœ€å°ã€‚æœ€é«˜ç‚¹æ„å‘³ç€åç¦»æœ€å¤§ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€ç»„æƒé‡å€¼å¸¦é¢†æˆ‘ä»¬åˆ°è¾¾å›¾ä¸­çš„æœ€ä½ç‚¹ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†ç­”æ¡ˆï¼ å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒæ•´æƒé‡å€¼ä½¿æˆ‘ä»¬åœ¨å›¾ä¸Šèƒ½å‘ç€æœ€ä½ç‚¹â€œèµ°ä¸‹å¡è·¯â€ã€‚å¦‚æœå¯¹äºæƒé‡çš„ç»†å°è°ƒèŠ‚èƒ½ä¸€ç›´ä½¿æˆ‘ä»¬ä¿æŒå‘æœ€ä½ç‚¹ç§»åŠ¨ï¼Œé‚£ä¹ˆæœ€ç»ˆæˆ‘ä»¬ä¸ç”¨å°è¯•å¤ªå¤šæƒé‡å€¼å°±èƒ½åˆ°è¾¾é‚£é‡Œã€‚ å¦‚æœä½ è¿˜è®°å¾—ä¸€ç‚¹å¾®ç§¯åˆ†çš„è¯ï¼Œä½ ä¹Ÿè®¸è®°å¾—å¦‚æœä½ å¯¹ä¸€ä¸ªå‡½æ•°æ±‚å¯¼ï¼Œç»“æœä¼šå‘Šè¯‰ä½ å‡½æ•°åœ¨ä»»ä¸€ç‚¹çš„æ–œç‡ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºå›¾ä¸Šç»™å®šä¸€ç‚¹ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬é‚£æ¡è·¯æ˜¯ä¸‹å¡è·¯ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æœåº•éƒ¨è¿›å‘ã€‚ æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬å¯¹ä»£ä»·å‡½æ•°å…³äºæ¯ä¸€ä¸ªæƒé‡æ±‚åå¯¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä»æ¯ä¸€ä¸ªæƒé‡ä¸­å‡å»è¯¥å€¼ã€‚è¿™æ ·å¯ä»¥è®©æˆ‘ä»¬æ›´åŠ æ¥è¿‘å±±åº•ã€‚ä¸€ç›´è¿™æ ·åšï¼Œæœ€ç»ˆæˆ‘ä»¬å°†åˆ°è¾¾åº•éƒ¨ï¼Œå¾—åˆ°æƒé‡çš„æœ€ä¼˜å€¼ã€‚ï¼ˆè¯»ä¸æ‡‚ï¼Ÿä¸ç”¨æ‹…å¿ƒï¼Œæ¥ç€å¾€ä¸‹è¯»ï¼‰ã€‚ è¿™ç§æ‰¾å‡ºæœ€ä½³æƒé‡çš„åŠæ³•è¢«ç§°ä¸ºæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼Œä¸Šé¢æ˜¯å¯¹å®ƒçš„é«˜åº¦æ¦‚æ‹¬ã€‚å¦‚æœæƒ³ææ‡‚ç»†èŠ‚ï¼Œä¸è¦å®³æ€•ï¼Œç»§ç»­æ·±å…¥ä¸‹å»å§ã€‚ å½“ä½ ä½¿ç”¨æœºå™¨å­¦ä¹ ç®—æ³•åº“æ¥è§£å†³å®é™…é—®é¢˜ï¼Œæ‰€æœ‰è¿™äº›éƒ½å·²ç»ä¸ºä½ å‡†å¤‡å¥½äº†ã€‚ä½†æ˜ç™½ä¸€äº›å…·ä½“ç»†èŠ‚æ€»æ˜¯æœ‰ç”¨çš„ã€‚ è¿˜æœ‰ä»€ä¹ˆä½ éšä¾¿å°±ç•¥è¿‡äº†ï¼Ÿä¸Šé¢æˆ‘æè¿°çš„ä¸‰æ­¥ç®—æ³•è¢«ç§°ä¸ºå¤šå…ƒçº¿æ€§å›å½’ã€‚ä½ ä¼°ç®—ç­‰å¼æ˜¯åœ¨æ±‚ä¸€æ¡èƒ½å¤Ÿæ‹Ÿåˆæ‰€æœ‰æˆ¿ä»·æ•°æ®ç‚¹çš„ç›´çº¿ã€‚ç„¶åï¼Œä½ å†æ ¹æ®æˆ¿ä»·åœ¨ä½ çš„ç›´çº¿ä¸Šå¯èƒ½å‡ºç°çš„ä½ç½®ç”¨è¿™ä¸ªç­‰å¼æ¥ä¼°ç®—ä»æœªè§è¿‡çš„æˆ¿å±‹çš„ä»·æ ¼ã€‚è¿™ä¸ªæƒ³æ³•å¨åŠ›å¼ºå¤§ï¼Œå¯ä»¥ç”¨å®ƒæ¥è§£å†³â€œå®é™…â€é—®é¢˜ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä¸ºä½ å±•ç¤ºçš„è¿™ç§æ–¹æ³•å¯èƒ½åœ¨ç®€å•çš„æƒ…å†µä¸‹æœ‰æ•ˆï¼Œå®ƒä¸ä¼šåœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½æœ‰ç”¨ã€‚åŸå› ä¹‹ä¸€æ˜¯å› ä¸ºæˆ¿ä»·ä¸ä¼šä¸€ç›´é‚£ä¹ˆç®€å•åœ°è·Ÿéšä¸€æ¡è¿ç»­ç›´çº¿ã€‚ ä½†æ˜¯ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæœ‰å¾ˆå¤šåŠæ³•æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚å¯¹äºéçº¿æ€§æ•°æ®ï¼Œå¾ˆå¤šå…¶ä»–ç±»å‹çš„æœºå™¨å­¦ä¹ ç®—æ³•å¯ä»¥å¤„ç†ï¼ˆå¦‚ç¥ç»ç½‘ç»œæˆ–æœ‰æ ¸å‘é‡æœºï¼‰ã€‚è¿˜æœ‰å¾ˆå¤šæ–¹æ³•è¿ç”¨çº¿æ€§å›å½’æ›´çµæ´»ï¼Œæƒ³åˆ°äº†ç”¨æ›´å¤æ‚çš„çº¿æ¡æ¥æ‹Ÿåˆã€‚åœ¨æ‰€æœ‰çš„æƒ…å†µä¸­ï¼Œå¯»æ‰¾æœ€ä¼˜æƒé‡å€¼è¿™ä¸€åŸºæœ¬æ€è·¯ä¾ç„¶é€‚ç”¨ã€‚ è¿˜æœ‰ï¼Œæˆ‘å¿½ç•¥äº†è¿‡æ‹Ÿåˆçš„æ¦‚å¿µã€‚å¾ˆå®¹æ˜“ç¢°ä¸Šè¿™æ ·ä¸€ç»„æƒé‡å€¼ï¼Œå®ƒä»¬å¯¹äºä½ åŸå§‹æ•°æ®é›†ä¸­çš„æˆ¿ä»·éƒ½èƒ½å®Œç¾é¢„æµ‹ï¼Œä½†å¯¹äºåŸå§‹æ•°æ®é›†ä¹‹å¤–çš„ä»»ä½•æ–°æˆ¿å±‹éƒ½é¢„æµ‹ä¸å‡†ã€‚è¿™ç§æƒ…å†µçš„è§£å†³ä¹‹é“ä¹Ÿæœ‰ä¸å°‘ï¼ˆå¦‚æ­£åˆ™åŒ–ä»¥åŠä½¿ç”¨äº¤å‰éªŒè¯æ•°æ®é›†ï¼‰ã€‚å­¦ä¼šå¦‚ä½•å¤„ç†è¿™ä¸€é—®é¢˜å¯¹äºé¡ºåˆ©åº”ç”¨æœºå™¨å­¦ä¹ è‡³å…³é‡è¦ã€‚ æ¢è¨€ä¹‹ï¼ŒåŸºæœ¬æ¦‚å¿µéå¸¸ç®€å•ï¼Œè¦æƒ³è¿ç”¨æœºå™¨å­¦ä¹ å¾—åˆ°æœ‰ç”¨çš„ç»“æœè¿˜éœ€è¦ä¸€äº›æŠ€å·§å’Œç»éªŒã€‚ä½†æ˜¯ï¼Œè¿™æ˜¯æ¯ä¸ªå¼€å‘è€…éƒ½èƒ½å­¦ä¼šçš„æŠ€å·§ã€‚ æœºå™¨å­¦ä¹ æ³•åŠ›æ— è¾¹å—ï¼Ÿä¸€æ—¦ä½ å¼€å§‹æ˜ç™½æœºå™¨å­¦ä¹ æŠ€æœ¯å¾ˆå®¹æ˜“åº”ç”¨äºè§£å†³è²Œä¼¼å¾ˆå›°éš¾çš„é—®é¢˜ï¼ˆå¦‚æ‰‹å†™è¯†åˆ«ï¼‰ï¼Œä½ å¿ƒä¸­ä¼šæœ‰ä¸€ç§æ„Ÿè§‰ï¼Œåªè¦æœ‰è¶³å¤Ÿçš„æ•°æ®ï¼Œä½ å°±èƒ½å¤Ÿç”¨æœºå™¨å­¦ä¹ è§£å†³ä»»ä½•é—®é¢˜ã€‚åªéœ€è¦å°†æ•°æ®è¾“å…¥è¿›å»ï¼Œå°±èƒ½çœ‹åˆ°è®¡ç®—æœºå˜æˆæ³•ä¸€æ ·æ‰¾å‡ºæ‹Ÿåˆæ•°æ®çš„ç­‰å¼ã€‚ ä½†æ˜¯å¾ˆé‡è¦çš„ä¸€ç‚¹ä½ è¦è®°ä½ï¼Œæœºå™¨å­¦ä¹ åªèƒ½å¯¹ç”¨ä½ å æœ‰çš„æ•°æ®å®é™…å¯è§£çš„é—®é¢˜æ‰é€‚ç”¨ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä½ å»ºç«‹äº†ä¸€ä¸ªæ¨¡å‹æ¥æ ¹æ®æ¯å¥—æˆ¿å±‹å†…ç›†æ ½æ•°é‡æ¥é¢„æµ‹æˆ¿ä»·ï¼Œå®ƒå°±æ°¸è¿œä¸ä¼šæˆåŠŸã€‚æˆ¿å±‹å†…ç›†æ ½æ•°é‡å’Œæˆ¿ä»·ä¹‹é—´æ²¡æœ‰ä»»ä½•çš„å…³ç³»ã€‚æ‰€ä»¥ï¼Œæ— è®ºå®ƒæ€ä¹ˆå»å°è¯•ï¼Œè®¡ç®—æœºä¹Ÿæ¨å¯¼ä¸å‡ºä¸¤è€…ä¹‹é—´çš„å…³ç³»ã€‚ ä½ åªèƒ½å¯¹å®é™…å­˜åœ¨çš„å…³ç³»å»ºæ¨¡ã€‚ æ€æ ·æ·±å…¥å­¦ä¹ æœºå™¨å­¦ä¹ æˆ‘è®¤ä¸ºï¼Œå½“å‰æœºå™¨å­¦ä¹ çš„æœ€å¤§é—®é¢˜æ˜¯å®ƒä¸»è¦æ´»è·ƒäºå­¦æœ¯ç•Œå’Œå•†ä¸šç ”ç©¶ç»„ç»‡ä¸­ã€‚å¯¹äºåœˆå¤–æƒ³è¦æœ‰ä¸ªå¤§ä½“äº†è§£è€Œä¸æ˜¯æƒ³æˆä¸ºä¸“å®¶çš„äººä»¬ï¼Œç®€å•æ˜“æ‡‚çš„å­¦ä¹ èµ„æ–™ä¸å¤šã€‚ä½†æ˜¯è¿™ä¸€æƒ…å†µæ¯ä¸€å¤©éƒ½åœ¨æ”¹å–„ã€‚ å´æ©è¾¾æ•™æˆï¼ˆAndrew Ngï¼‰åœ¨Courseraä¸Šçš„æœºå™¨å­¦ä¹ å…è´¹è¯¾ç¨‹éå¸¸ä¸é”™ã€‚æˆ‘å¼ºçƒˆå»ºè®®ç”±æ­¤å…¥é—¨ã€‚ä»»ä½•æ‹¥æœ‰è®¡ç®—æœºç§‘å­¦å­¦ä½ã€è¿˜èƒ½è®°ä½ä¸€ç‚¹ç‚¹æ•°å­¦çš„äººåº”è¯¥éƒ½èƒ½ç†è§£ã€‚ å¦å¤–ï¼Œä½ è¿˜å¯ä»¥ä¸‹è½½å®‰è£…SciKit-Learnï¼Œç”¨å®ƒæ¥è¯•éªŒæˆåƒä¸Šä¸‡çš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚å®ƒæ˜¯ä¸€ä¸ªpythonæ¡†æ¶ï¼Œå¯¹äºæ‰€æœ‰çš„æ ‡å‡†ç®—æ³•éƒ½æœ‰â€œé»‘ç›’â€ç‰ˆæœ¬ã€‚","categories":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://github.com/categories/Machine-Learning/"}],"tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://github.com/tags/Machine-Learning/"}],"keywords":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://github.com/categories/Machine-Learning/"}]},{"title":"ã€Machine Learningã€‘Githubä¸Šå…³æ³¨æœ€å¤šçš„53ä¸ªæ·±åº¦å­¦ä¹ é¡¹ç›®","slug":"ã€Machine Learningã€‘Githubä¸Šå…³æ³¨æœ€å¤šçš„53ä¸ªæ·±åº¦å­¦ä¹ é¡¹ç›®","date":"2016-08-12T07:22:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/08/12/ã€Machine Learningã€‘Githubä¸Šå…³æ³¨æœ€å¤šçš„53ä¸ªæ·±åº¦å­¦ä¹ é¡¹ç›®/","link":"","permalink":"http://github.com/2016/08/12/ã€Machine Learningã€‘Githubä¸Šå…³æ³¨æœ€å¤šçš„53ä¸ªæ·±åº¦å­¦ä¹ é¡¹ç›®/","excerpt":"Top Deep Learning ProjectsA list of popular github projects related to deep learning (ranked by stars). Last Update: 2016.08.09","text":"Top Deep Learning ProjectsA list of popular github projects related to deep learning (ranked by stars). Last Update: 2016.08.09 Project Name Stars Description TensorFlow 29622 Computation using data flow graphs for scalable machine learning. Caffe 11799 Caffe: a fast open framework for deep learning. Neural Style 10148 Torch implementation of neural style algorithm. Deep Dream 9042 Deep Dream. Keras 7502 Deep Learning library for Python. Convnets, recurrent neural networks, and more. Runs on Theano and TensorFlow. Roc AlphaGo 7170 An independent, student-led replication of DeepMindâ€™s 2016 Nature publication, â€œMastering the game of Go with deep neural networks and tree searchâ€ (Nature 529, 484-489, 28 Jan 2016). TensorFlow Models 6671 Models built with TensorFlow Neural Doodle 6275 Turn your two-bit doodles into fine artworks with deep neural networks, generate seamless textures from photos, transfer style from one image to another, perform example-based upscaling, but waitâ€¦ thereâ€™s more! (An implementation of Semantic Style Transfer.) CNTK 5957 Computational Network Toolkit (CNTK). TensorFlow Examples 5872 TensorFlow tutorials and code examples for beginners. ConvNet JS 5231 Deep Learning in Javascript. Train Convolutional Neural Networks (or ordinary ones) in your browser. Torch 5133 Torch7, Deep Learning Library. OpenFace 4855 Face recognition with deep neural networks. MXNet 4685 Lightweight, Portable, Flexible Distributed/Mobile Deep Learning with Dynamic, Mutation-aware Dataflow Dep Scheduler; for Python, R, Julia, Scala, Go, Javascript and more. Nupic 4364 Numenta Platform for Intelligent Computing: a brain-inspired machine intelligence platform, and biologically accurate neural network based on cortical learning algorithms. Theano 4286 Theano is a Python library that allows you to define, optimize, and evaluate mathematical expressions involving multi-dimensional arrays efficiently. It can use GPUs and perform efficient symbolic differentiation. Leaf 4281 Open Machine Intelligence Framework for Hackers. Char RNN 3820 Multi-layer Recurrent Neural Networks (LSTM, GRU, RNN) for character-level language models in Torch. Neural Talk 3694 NeuralTalk is a Python+numpy project for learning Multimodal Recurrent Neural Networks that describe images with sentences. deeplearning4j 3673 Deep Learning for Java, Scala &amp; Clojure on Hadoop, Spark. TFLearn 3368 Deep learning library featuring a higher-level API for TensorFlow. TensorFlow Playground 3352 Play with neural networks! OpenAI Gym 3020 A toolkit for developing and comparing reinforcement learning algorithms. Magenta 2914 Magenta: Music and Art Generation with Machine Intelligence Colornet 2798 Neural Network to colorize grayscale images. Synaptic 2666 architecture-free neural network library for node.js and the browser Neural Talk 2 2550 Efficient Image Captioning code in Torch, runs on GPU. Image Analogies 2540 Generate image analogies using neural matching and blending. TensorFlow Tutorials 2413 From the basics to slightly more interesting applications of Tensorflow. Lasagne 2355 Lightweight library to build and train neural networks in Theano. PyLearn2 2153 A Machine Learning library based on Theano. LISA-lab Deep Learning Tutorials 2134 Deep Learning Tutorial notes and code. See the wiki for more info. Neon 2121 Fast, scalable, easy-to-use Python based Deep Learning Framework by Nervanaâ„¢. Matlab Deep Learning Toolbox 2032 Matlab/Octave toolbox for deep learning. Includes Deep Belief Nets, Stacked Autoencoders, Convolutional Neural Nets, Convolutional Autoencoders and vanilla Neural Nets. Each method has examples to get you started. Deep Learning Flappy Bird 1721 Flappy Bird hack using Deep Reinforcement Learning (Deep Q-learning). Chainer 1573 A flexible framework of neural networks for deep learning. Neural Story Teller 1514 A recurrent neural network for generating little stories about images. DIGITS 1353 Deep Learning GPU Training System. Deep Jazz 1229 Deep learning driven jazz generation using Keras &amp; Theano! Brainstorm 1143 Fast, flexible and fun neural networks. Darknet 937 Open Source Neural Networks in C Theano Tutorials 904 Bare bones introduction to machine learning from linear regression to convolutional neural networks using Theano. RNN Music Composition 904 A recurrent neural network designed to generate classical music. Blocks 866 A Theano framework for building and training neural networks. TDB 860 Interactive, node-by-node debugging and visualization for TensorFlow. Scikit Neural Net 849 Deep neural networks without the learning cliff! Classifiers and regressors compatible with scikit-learn. Veles 760 Distributed machine learning platform (Python, CUDA, OpenCL) Deep Detect 759 Deep Learning API and Server in C++11 with Python bindings and support for Caffe. TensorFlow DeepQ 759 A deep Q learning demonstration using Google Tensorflow. Caffe on Spark 724 Caffe On Spark. Nolearn 702 Abstractions around neural net libraries, most notably Lasagne. DCGAN TensorFlow 568 A tensorflow implementation of Deep Convolutional Generative Adversarial Networks MatConvNet 479 MATLAB CNN toolbox for computer vision applications. DeepCL 413 OpenCL library to train deep convolutional neural networks. ä¸­æ–‡ç‰ˆ é¡¹ ç›® å ç§° Stars é¡¹ç›®ä»‹ç» TensorFlow 29622 ä½¿ç”¨æ•°æ®æµå›¾è®¡ç®—å¯æ‰©å±•æœºå™¨å­¦ä¹ é—®é¢˜ Caffe 11799 Caffeæ˜¯ä¸€ä¸ªé«˜æ•ˆçš„å¼€æºæ·±åº¦å­¦ä¹ æ¡†æ¶ Neural Style 10148 Torchå®ç°çš„ç¥ç»ç½‘ç»œç®—æ³• Deep Dream 9042 Deep Dreamï¼Œä¸€æ¬¾å›¾åƒè¯†åˆ«å·¥å…· Keras 7502 ä¸€æ¬¾Pythonå®ç°çš„æ·±åº¦å­¦ä¹ åº“ï¼ŒåŒ…æ‹¬å·ç§¯ç¥ç»ç½‘ç»œã€é€’å½’ç¥ç»ç½‘ç»œç­‰ã€‚è¿è¡Œåœ¨Theanoå’ŒTensorFlowä¹‹ä¸Šã€‚ Roc AlphaGo 7170 å­¦ç”Ÿä¸»å¯¼çš„ä¸€ä¸ªç‹¬ç«‹é¡¹ç›®ï¼Œä»æ–°å®ç°äº† DeepMindåœ¨2016 Natureå‘è¡¨çš„å†…å®¹ï¼Œ ã€Šç”¨æ·±åº¦ç¥ç»ç½‘ç»œå’Œæ ‘æœç´¢å­¦ä¹ å›´æ£‹ã€‹ (Nature 529, 484-489, 28 Jan 2016). TensorFlow Models 6671 åŸºäºTensorFlowå¼€å‘çš„æ¨¡å‹ Neural Doodle 6275 è¿ç”¨æ·±åº¦ç¥ç»ç½‘ç»œå°†æ¶‚é¸¦å˜ä¸ºä¼˜é›…çš„è‰ºæœ¯å“ï¼Œä»ç…§ç‰‡ç”Ÿæˆæ— ç¼çº¹ç†ï¼Œè½¬å˜å›¾ç‰‡é£æ ¼ï¼Œè¿›è¡ŒåŸºäºå®ä¾‹çš„æå‡ï¼Œç­‰ç­‰â€¦è¿˜æœ‰æ›´å¤šï¼ï¼ˆè¯­ä¹‰é£æ ¼ä¼ é€’çš„å®ç°ï¼‰ CNTK 5957 è®¡ç®—ç½‘ç»œå·¥å…·ï¼ˆComputational Network Toolkitï¼ŒCNTKï¼‰ TensorFlow Examples 5872 åˆå­¦è€…çš„TensorFlowæ•™ç¨‹å’Œä»£ç ç¤ºä¾‹ã€‚ ConvNet JS 5231 åŸºäºJavascriptçš„æ·±åº¦å­¦ä¹ åº“ã€‚åœ¨æµè§ˆå™¨ä¸­è®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ï¼ˆæˆ–è€…æ™®é€šæ¨¡å‹ï¼‰ã€‚ Torch 5133 Torch7ï¼Œæ·±åº¦å­¦ä¹ åº“ã€‚ OpenFace 4855 åŸºäºæ·±åº¦å­¦ä¹ ç½‘ç»œçš„é¢éƒ¨è¯†åˆ«ã€‚ MXNet 4685 è½»å·§ã€ä¾¿æºã€çµæ´»çš„åˆ†å¸ƒå¼/ç§»åŠ¨æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæ”¯æŒPython, R, Julia, Scala, Go, Javascriptç­‰ç­‰è¯­è¨€ã€‚ Nupic 4364 æ™ºèƒ½è®¡ç®—çš„Numentaå¹³å°ï¼šä¸€ä¸ªè„‘å¯å‘å¼çš„è®¡ç®—æ™ºèƒ½å’Œæœºå™¨æ™ºèƒ½å¹³å°ï¼ŒåŸºäºçš®å±‚å­¦ä¹ ç®—æ³•çš„ç”Ÿç‰©ç²¾ç¡®ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚ Theano 4286 Theano æ˜¯ä¸€ä¸ª Python åº“,ç”¨æ¥å®šä¹‰ã€ä¼˜åŒ–å’Œæ¨¡æ‹Ÿæ•°å­¦è¡¨è¾¾å¼è®¡ç®—,ç”¨äºé«˜æ•ˆçš„è§£å†³å¤šç»´æ•°ç»„çš„è®¡ç®—é—®é¢˜ã€‚ Leaf 4281 é»‘å®¢çš„å¼€æºæœºå™¨æ™ºèƒ½æ¡†æ¶ã€‚ Char RNN 3820 å¤šå±‚é€’å½’ç¥ç»ç½‘ç»œçš„å­—ç¬¦çº§åˆ«è¯­è¨€æ¨¡å‹ï¼ŒåŸºäºTorchå¼€å‘ã€‚ Neural Talk 3694 NeuralTalkæ˜¯ä¸€ä¸ªPython+numpyé¡¹ç›®ï¼Œç”¨å¤šæ¨¡å¼é€’å½’ç¥ç»ç½‘ç»œæè¿°å›¾åƒã€‚ deeplearning4j 3673 åŸºäºHadoopå’ŒSparkçš„Java, Scala &amp; Clojureæ·±åº¦å­¦ä¹ å·¥å…·ã€‚ TFLearn 3368 æ·±åº¦å­¦ä¹ åº“ï¼ŒåŒ…æ‹¬é«˜å±‚æ¬¡çš„TensorFlowæ¥å£ã€‚ TensorFlow Playground 3352 ç¥ç»ç½‘ç»œæ¨¡å‹ç¤ºä¾‹ã€‚ OpenAI Gym 3020 ä¸€ç§ç”¨äºå¼€å‘å’Œæ¯”è¾ƒå¼ºåŒ–å­¦ä¹ ç®—æ³•çš„å·¥å…·åŒ…ã€‚ Magenta 2914 Magenta: éŸ³ä¹å’Œè‰ºæœ¯çš„ç”Ÿæˆä¸æœºå™¨æ™ºèƒ½ Colornet 2798 ç”¨ç¥ç»ç½‘ç»œæ¨¡å‹ç»™ç°åº¦å›¾ä¸Šè‰²ã€‚ Synaptic 2666 åŸºäºnode.jså’Œæµè§ˆå™¨çš„å…æ¶æ„ç¥ç»ç½‘ç»œåº“ã€‚ Neural Talk 2 2550 Torchå¼€å‘çš„å›¾åƒç®€ä»‹ç”Ÿæˆä»£ç ï¼Œè¿è¡Œåœ¨GPUä¸Šã€‚ Image Analogies 2540 ä½¿ç”¨ç¥ç»åŒ¹é…å’Œèåˆç”Ÿæˆç›¸ä¼¼å›¾å½¢ã€‚ TensorFlow Tutorials 2413 Tensorflowï¼Œä»åŸºç¡€åŸç†åˆ°åº”ç”¨ã€‚ Lasagne 2355 åŸºäºTheanoè®­ç»ƒå’Œæ„å»ºç¥ç»ç½‘ç»œçš„è½»å‹å‡½æ•°åº“ã€‚ PyLearn2 2153 åŸºäºTheanoçš„æœºå™¨å­¦ä¹ åº“ã€‚ LISA-lab Deep Learning Tutorials 2134 æ·±åº¦å­¦ä¹ æ•™ç¨‹ç¬”è®°å’Œä»£ç ã€‚è¯¦æƒ…å‚è§wikié¡µé¢ã€‚ Neon 2121 Nervanaâ„¢å¼€å‘çš„ä¸€æ¬¾å¿«é€Ÿã€å¯æ‰©å±•ã€æ˜“ä¸Šæ‰‹çš„Pythonæ·±åº¦å­¦ä¹ æ¡†æ¶. Matlab Deep Learning Toolbox 2032 Matlab/Octaveçš„æ·±åº¦å­¦ä¹ å·¥å…·ç®±ã€‚åŒ…æ‹¬æ·±åº¦ä¿¡å¿µç½‘ç»œã€è‡ªåŠ¨ç¼–ç æœºã€å·ç§¯ç¥ç»ç½‘ç»œã€å·ç§¯è‡ªåŠ¨ç¼–ç æœºå’Œvanillaç¥ç»ç½‘ç»œç­‰ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰å…¥é—¨ç¤ºä¾‹ã€‚ Deep Learning Flappy Bird 1721 ä½¿ç”¨æ·±åº¦å¼ºåŒ–å­¦ä¹ ç ´è§£Flappy Birdæ¸¸æˆ(æ·±åº¦ Q-å­¦ä¹ ). Chainer 1573 ä¸€æ¬¾çµæ´»çš„æ·±åº¦å­¦ä¹ ç¥ç»ç½‘ç»œæ¡†æ¶ã€‚ Neural Story Teller 1514 çœ‹å›¾è®²æ•…äº‹çš„é€’å½’ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚ DIGITS 1353 æ·±åº¦å­¦ä¹ GPUè®­ç»ƒç³»ç»Ÿã€‚ Deep Jazz 1229 åŸºäºKeraså’ŒTheanoç”Ÿæˆjazzçš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ Brainstorm 1143 å¿«é€Ÿã€çµæ´»ã€æœ‰è¶£çš„ç¥ç»ç½‘ç»œã€‚ Darknet 937 Cè¯­è¨€ç‰ˆæœ¬çš„å¼€æºç¥ç»ç½‘ç»œã€‚ Theano Tutorials 904 åŸºäºTheanoçš„æœºå™¨å­¦ä¹ å…¥é—¨æ•™ç¨‹ï¼Œä»çº¿æ€§å›å½’åˆ°å·ç§¯ç¥ç»ç½‘ç»œã€‚ RNN Music Composition 904 ä¸€æ¬¾ç”Ÿæˆå¤å…¸éŸ³ä¹çš„é€’å½’ç¥ç»ç½‘ç»œå·¥å…·ã€‚ Blocks 866 ç”¨äºæ„å»ºå’Œè®­ç»ƒç¥ç»ç½‘ç»œæ¨¡å‹çš„Theanoæ¡†æ¶ã€‚ TDB 860 TensorFlowçš„äº¤äº’å¼ã€èŠ‚ç‚¹è°ƒè¯•å’Œå¯è§†åŒ–çš„å·¥å…·ã€‚ Scikit Neural Net 849 æ·±åº¦ç¥ç»ç½‘ç»œå…¥é—¨å·¥å…·ï¼Œç±»ä¼¼scikit-learnçš„åˆ†ç±»å™¨å’Œå›å½’æ¨¡å‹ã€‚ Veles 760 åˆ†å¸ƒå¼æœºå™¨å­¦ä¹ å¹³å°(Python, CUDA, OpenCL) Deep Detect 759 åŸºäºC++11çš„æ·±åº¦å­¦ä¹ æ¥å£å’ŒæœåŠ¡å™¨ï¼Œä¸Pythonç»‘å®šå¹¶æ”¯æŒCaffeã€‚ TensorFlow DeepQ 759 åŸºäºGoogle Tensorflowçš„æ·±åº¦Qå­¦ä¹ æ¼”ç¤ºã€‚ Caffe on Spark 724 åŸºäºSparkçš„Caffeã€‚ Nolearn 702 ç¥ç»ç½‘ç»œåº“çš„æŠ½è±¡ï¼Œè‘—åçš„Lasagneã€‚ DCGAN TensorFlow 568 åŸºäºtensorflowå®ç°çš„æ·±åº¦å·ç§¯ç”Ÿæˆå¯¹æŠ—ç½‘ç»œã€‚ DeepCL 413 ç”¨äºè®­ç»ƒæ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹çš„OpenCLåº“ã€‚ æ¥æºï¼šTop Deep Learning Projects","categories":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://github.com/categories/Machine-Learning/"}],"tags":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://github.com/tags/Machine-Learning/"}],"keywords":[{"name":"Machine Learning","slug":"Machine-Learning","permalink":"http://github.com/categories/Machine-Learning/"}]},{"title":"ã€Androidã€‘ä½¿ç”¨shapeçš„åŒæ—¶ï¼ŒåŠ¨æ€æ›¿æ¢shapeçš„é¢œè‰²å±æ€§","slug":"ã€Androidã€‘ä½¿ç”¨shapeçš„åŒæ—¶ï¼ŒåŠ¨æ€æ›¿æ¢shapeçš„é¢œè‰²å±æ€§","date":"2016-08-08T10:10:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/08/08/ã€Androidã€‘ä½¿ç”¨shapeçš„åŒæ—¶ï¼ŒåŠ¨æ€æ›¿æ¢shapeçš„é¢œè‰²å±æ€§/","link":"","permalink":"http://github.com/2016/08/08/ã€Androidã€‘ä½¿ç”¨shapeçš„åŒæ—¶ï¼ŒåŠ¨æ€æ›¿æ¢shapeçš„é¢œè‰²å±æ€§/","excerpt":"åœ¨å®ç°å¸ƒå±€çš„æ—¶å€™ï¼Œæœ‰äº›æŒ‰é’®å½¢çŠ¶ç›¸åŒï¼Œåªæ˜¯é¢œè‰²æœ‰å·®å¼‚ï¼Œå¦‚æœä½¿ç”¨è‡ªå®šä¹‰shapeå®ç°äº†å…¶ä¸­ä¸€ç§æŒ‰é’®ï¼Œæœ‰æ²¡æœ‰å¯èƒ½ä¸éœ€è¦å†ä¸ºå…¶ä»–æ¯ä¸ªé¢œè‰²éƒ½å†™ä¸€ä¸ªshapeæ–‡ä»¶å‘¢ï¼Ÿ ä¸€ã€é—®é¢˜æ¯”å¦‚ä»¥ä¸‹è¿™ä¸‰ä¸ªæŒ‰é’®ï¼š ä¸ºç¬¬ä¸€ä¸ªç°è‰²æŒ‰é’®è‡ªå®šä¹‰èƒŒæ™¯å¦‚ä¸‹ï¼š1234567891011121314&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"rectangle\" android:color=\"@color/gray\"&gt; &lt;corners android:radius=\"60dip\"/&gt; &lt;stroke android:width=\"0dp\" android:color=\"@color/gray\" /&gt; &lt;solid android:color=\"@color/gray\" /&gt;&lt;/shape&gt; ç„¶åï¼Œå¦‚æœå†ä¸ºæ¯ä¸ªé¢œè‰²çš„æŒ‰é’®éƒ½å†™ä¸€ä¸ªshapeèƒŒæ™¯ä¹Ÿå¤ªéº»çƒ¦ï¼Œé‡ç”¨æ€§å¤ªå·®ã€‚","text":"åœ¨å®ç°å¸ƒå±€çš„æ—¶å€™ï¼Œæœ‰äº›æŒ‰é’®å½¢çŠ¶ç›¸åŒï¼Œåªæ˜¯é¢œè‰²æœ‰å·®å¼‚ï¼Œå¦‚æœä½¿ç”¨è‡ªå®šä¹‰shapeå®ç°äº†å…¶ä¸­ä¸€ç§æŒ‰é’®ï¼Œæœ‰æ²¡æœ‰å¯èƒ½ä¸éœ€è¦å†ä¸ºå…¶ä»–æ¯ä¸ªé¢œè‰²éƒ½å†™ä¸€ä¸ªshapeæ–‡ä»¶å‘¢ï¼Ÿ ä¸€ã€é—®é¢˜æ¯”å¦‚ä»¥ä¸‹è¿™ä¸‰ä¸ªæŒ‰é’®ï¼š ä¸ºç¬¬ä¸€ä¸ªç°è‰²æŒ‰é’®è‡ªå®šä¹‰èƒŒæ™¯å¦‚ä¸‹ï¼š1234567891011121314&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;shape xmlns:android=\"http://schemas.android.com/apk/res/android\" android:shape=\"rectangle\" android:color=\"@color/gray\"&gt; &lt;corners android:radius=\"60dip\"/&gt; &lt;stroke android:width=\"0dp\" android:color=\"@color/gray\" /&gt; &lt;solid android:color=\"@color/gray\" /&gt;&lt;/shape&gt; ç„¶åï¼Œå¦‚æœå†ä¸ºæ¯ä¸ªé¢œè‰²çš„æŒ‰é’®éƒ½å†™ä¸€ä¸ªshapeèƒŒæ™¯ä¹Ÿå¤ªéº»çƒ¦ï¼Œé‡ç”¨æ€§å¤ªå·®ã€‚ äºŒã€è§£å†³æ–¹æ³•å‚è€ƒ stackoverflow è¿™é‡Œï¼Œ åœ¨javaä»£ç é‡Œä½¿ç”¨ GradientDrawable åŠ¨æ€è®¾ç½®12GradientDrawable myGrad = (GradientDrawable)rectangle.getBackground();myGrad.setColor(Color.BLACK); ã€å‚è€ƒèµ„æ–™ã€‘1ã€How to change solid color from the code?","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"BATäººæ‰ä½“ç³»çš„èŒä½å±‚çº§ã€è–ªé…¬ã€æ™‹å‡æ ‡å‡†","slug":"BATäººæ‰ä½“ç³»çš„èŒä½å±‚çº§ã€è–ªé…¬ã€æ™‹å‡æ ‡å‡†å¤§å…¨","date":"2016-08-02T03:06:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/08/02/BATäººæ‰ä½“ç³»çš„èŒä½å±‚çº§ã€è–ªé…¬ã€æ™‹å‡æ ‡å‡†å¤§å…¨/","link":"","permalink":"http://github.com/2016/08/02/BATäººæ‰ä½“ç³»çš„èŒä½å±‚çº§ã€è–ªé…¬ã€æ™‹å‡æ ‡å‡†å¤§å…¨/","excerpt":"äº’è”ç½‘åœˆæœ‰è¿™ä¹ˆä¸€å¥è¯ï¼šç™¾åº¦çš„æŠ€æœ¯ï¼Œé˜¿é‡Œçš„è¿è¥ï¼Œè…¾è®¯çš„äº§å“ã€‚é‚£ä¹ˆä»£è¡¨äº’è”ç½‘ä¸‰åº§å¤§å±±çš„BATï¼Œå†…éƒ¨äººæ‰ä½“ç³»æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ªè¯é¢˜ç™¾åº¦ã€è…¾è®¯å’Œé˜¿é‡Œå†…éƒ¨çš„çº§åˆ«å’Œè–ªèµ„å¾…é‡æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ â˜… è…¾è®¯ â˜…1ã€èŒçº§è…¾è®¯èŒçº§ä½“ç³»åˆ†6çº§ï¼Œæœ€ä½1çº§ï¼Œæœ€é«˜6çº§ã€‚åŒæ—¶æŒ‰ç…§å²—ä½åˆåˆ’åˆ†ä¸ºå››å¤§é€šé“ï¼Œå†…éƒ¨ä¹Ÿå«â€œæ—â€ï¼Œæ¯”å¦‚ï¼š äº§å“/é¡¹ç›®é€šé“ï¼Œç®€ç§°Pæ—æŠ€æœ¯é€šé“ï¼Œç®€ç§°Tæ—å¸‚åœºé€šé“ï¼Œç®€ç§°Mæ—èŒèƒ½é€šé“ï¼Œç®€ç§°Sæ— ä»¥Tæ—ä¸ºä¾‹ï¼Œåˆ†åˆ«ä¸ºï¼š T1ï¼šåŠ©ç†å·¥ç¨‹å¸ˆ ï¼ˆä¸€èˆ¬ä¸ºæ ¡æ‹›æ–°äººï¼‰ T2ï¼šå·¥ç¨‹å¸ˆ T3ï¼šé«˜çº§å·¥ç¨‹å¸ˆ 3-1ç›¸å½“äºé˜¿é‡Œçš„p6+åˆ°p7ï¼ˆèƒ½åŠ›å¼ºå¯èƒ½åˆ°p7ï¼‰ T4ï¼šä¸“å®¶å·¥ç¨‹å¸ˆ T5ï¼šç§‘å­¦å®¶ T6ï¼šé¦–å¸­ç§‘å­¦å®¶","text":"äº’è”ç½‘åœˆæœ‰è¿™ä¹ˆä¸€å¥è¯ï¼šç™¾åº¦çš„æŠ€æœ¯ï¼Œé˜¿é‡Œçš„è¿è¥ï¼Œè…¾è®¯çš„äº§å“ã€‚é‚£ä¹ˆä»£è¡¨äº’è”ç½‘ä¸‰åº§å¤§å±±çš„BATï¼Œå†…éƒ¨äººæ‰ä½“ç³»æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå¯ä»¥å…ˆçœ‹çœ‹è¿™ä¸ªè¯é¢˜ç™¾åº¦ã€è…¾è®¯å’Œé˜¿é‡Œå†…éƒ¨çš„çº§åˆ«å’Œè–ªèµ„å¾…é‡æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ â˜… è…¾è®¯ â˜…1ã€èŒçº§è…¾è®¯èŒçº§ä½“ç³»åˆ†6çº§ï¼Œæœ€ä½1çº§ï¼Œæœ€é«˜6çº§ã€‚åŒæ—¶æŒ‰ç…§å²—ä½åˆåˆ’åˆ†ä¸ºå››å¤§é€šé“ï¼Œå†…éƒ¨ä¹Ÿå«â€œæ—â€ï¼Œæ¯”å¦‚ï¼š äº§å“/é¡¹ç›®é€šé“ï¼Œç®€ç§°Pæ—æŠ€æœ¯é€šé“ï¼Œç®€ç§°Tæ—å¸‚åœºé€šé“ï¼Œç®€ç§°Mæ—èŒèƒ½é€šé“ï¼Œç®€ç§°Sæ— ä»¥Tæ—ä¸ºä¾‹ï¼Œåˆ†åˆ«ä¸ºï¼š T1ï¼šåŠ©ç†å·¥ç¨‹å¸ˆ ï¼ˆä¸€èˆ¬ä¸ºæ ¡æ‹›æ–°äººï¼‰ T2ï¼šå·¥ç¨‹å¸ˆ T3ï¼šé«˜çº§å·¥ç¨‹å¸ˆ 3-1ç›¸å½“äºé˜¿é‡Œçš„p6+åˆ°p7ï¼ˆèƒ½åŠ›å¼ºå¯èƒ½åˆ°p7ï¼‰ T4ï¼šä¸“å®¶å·¥ç¨‹å¸ˆ T5ï¼šç§‘å­¦å®¶ T6ï¼šé¦–å¸­ç§‘å­¦å®¶ ç›®å‰å…¨è…¾è®¯è²Œä¼¼å°±ä¸€ä¸ªT6ã€‚ æ¯ä¸€çº§ä¹‹é—´åˆåˆ†ä¸º3ä¸ªå­çº§ï¼Œ3-1æ˜¯ä»»å‘½ç»„é•¿/å‰¯ç»„é•¿çš„å¿…è¦æ¡ä»¶ï¼Œå…¶ä»–çº¿ä¹Ÿæ˜¯è¿™æ ·ã€‚T4åŸºæœ¬ä¸ºæ€»ç›‘çº§ï¼Œä¹Ÿä¸æ’é™¤æœ‰T3-3çš„æ€»ç›‘ï¼Œå› ä¸ºT4éå¸¸éš¾æ™‹çº§ã€‚ 2ã€æ™‹å‡è…¾è®¯çš„æ™‹çº§è¿˜æ˜¯å¾ˆå›°éš¾çš„ã€‚å°¤å…¶æ˜¯T2 å‡T3ï¼ŒT3å‡T4ã€‚éå¸¸å¤šçš„äººå¡åœ¨2-3,3-3æ²¡åŠæ³•æ™‹çº§ã€‚æœ‰çš„å°ä¼™ä¼´åšäº†3ã€4å¹´çš„2-3 ä¹Ÿå‡ä¸ä¸Šå»å•Šã€‚ 3ã€è–ªæ°´è…¾è®¯è–ªèµ„æ¶æ„ï¼š12+1+1=14è–ª å¹´ç»ˆå¥–ï¼šçœ‹éƒ¨é—¨ç›ˆåˆ©æƒ…å†µï¼Œä¸€èˆ¬æ˜¯3ä¸ªæœˆ èŒçº§å¾…é‡åŸºæœ¬å¦‚ä¸‹(2015å¹´å·¦å³)ï¼š çº§åˆ«è¶Šé«˜baseè–ªé…¬ä¹Ÿè¶Šé«˜ï¼Œä¸€å¹´æ ¹æ®ä½ çš„performanceå¤§æ¦‚èƒ½å‘15.3ä¸ªæœˆè‡³18ä¸ªæœˆçš„å·¥èµ„ï¼ŒT3.1çš„base 2w+ï¼ŒT3ä»¥ä¸Šçº§åˆ«çš„å‘˜å·¥éƒ½ä¼šæœ‰è‚¡ç¥¨æœŸæƒï¼Œè…¾è®¯09ä»¥å‰çš„å‘˜å·¥èµšé’±ä¸»è¦é è‚¡ç¥¨ï¼Œä»08åˆ°ç°åœ¨è‚¡ç¥¨upäº†500%+ï¼ŒT5+çš„baseè–ªé…¬åœ¨600w~800w/å¹´ã€‚ 4ã€äººæ‰äººæ‰æµåŠ¨çš„å¯èƒ½ï¼š æ·±åœ³ï¼šå¾ˆå¤šè…¾è®¯å‘˜å·¥éƒ½ä¹°äº†æˆ¿ï¼Œå½“ä½ çš„æˆ¿å­ï¼Œå¦»å­çš„å·¥ä½œï¼Œå„¿å­çš„å­¦æ ¡ï¼Œä½ çš„æœ‹å‹åœˆï¼Œéƒ½åœ¨ä¸€ä¸ªåŸå¸‚çš„æ—¶å€™ï¼Œæ¢åŸå¸‚å°±æœ‰å›°éš¾äº†ã€‚æ‰€ä»¥åªèƒ½æŒ–ä¸€äº›æ¯”è¾ƒæµ…çš„äººèµ°ã€‚ åŒ—äº¬ï¼šäººæ•°ä¸å°‘ ï¼Œä¸è¿‡éª¨å¹²å‘˜å·¥ä¸å¤šã€‚è…¾è®¯è§†é¢‘çš„ä¸»è¦å›¢é˜Ÿåœ¨åŒ—äº¬çš„å€’æ˜¯ä¸å°‘ã€‚ æˆéƒ½ã€å¤§è¿ï¼šåœ¨è¿™äº›äºŒçº¿åŸå¸‚ï¼Œè…¾è®¯å°±æ˜¯å½“åœ°æœ€å¥½çš„äº’è”ç½‘å…¬å¸äº†ï¼Œæä¾›çš„å¾…é‡ä¹Ÿæ˜¯éå¸¸é«˜çš„ï¼Œä¸å°‘äººéƒ½å¯¹è‡ªå·±çš„è–ªèµ„æ¯”è¾ƒæ»¡æ„ï¼Œå·¥ä½œç¯å¢ƒä¹Ÿå¾ˆæ»¡æ„ã€‚è·³æ§½çš„å¯èƒ½æ€§ä½äº†å¾ˆå¤šã€‚ äººæ‰ç»“æ„ï¼š è…¾è®¯çš„ç ”å‘åºåˆ—ç¡•å£«å­¦å†çš„å å¤šåº¦ï¼Œ211å¤§å­¦ï¼Œ985å¤§å­¦å å¤šæ•°ã€‚å¤§å®¶éƒ½çŸ¥é“è…¾è®¯ç ”ç©¶é™¢è§£æ•£äº†ã€‚å»å¹´èµ°å‡ºæ¥å¾ˆå¤šäººï¼Œè…¾è®¯äººæ‰åˆ›ä¸šæ¯”ä¾‹ä¸é«˜ã€‚ åœ¨è…¾è®¯æœ€å¸¸ç¢°åˆ°çš„æ™‹å‡é—®é¢˜å°±æ˜¯å¤©èŠ±æ¿ã€‚å¯èƒ½æ–°äººè¿›å»ï¼Œå­¦ä¸œè¥¿ä¼šå¾ˆå¤šï¼Œä½†ä¸šåŠ¡çº¿å°±è¿™äº›ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šå‘ï¼Œè‡ªç„¶ä¹Ÿå°±å¾ˆéš¾æ™‹å‡é«˜çº§å²—ã€‚ åœ¨è…¾è®¯æœ€æ‚²å‰§çš„æ—¶åˆ»å°±æ˜¯å…¬å¸æœ‰æ”¶è´­å’Œæ•´åˆã€‚æœç‹—åˆå¹¶ï¼Œæœæœçš„äººå“­äº†ï¼Œäº¬ä¸œåˆä½œï¼Œæ˜“è¿…çš„äººå“­äº†ã€‚åœ¨è…¾è®¯è·³å‡ºæ¥ç¢°åˆ°æœ€å¤§çš„é—®é¢˜å°±æ˜¯ï¼Œå¤–é¢çš„å…¬å¸å¤ªä¸å®Œå–„äº†ã€‚ â˜… é˜¿é‡Œå·´å·´ â˜…1ã€å±‚çº§é˜¿é‡Œçš„èŒç§°å¤§éƒ¨åˆ†éƒ½å½’çº³åœ¨Påºåˆ— ,ä½ çš„title+å·¥ç§ã€‚æ¯”å¦‚P7äº§å“ç»ç†=äº§å“ä¸“å®¶ã€‚ ä¸€èˆ¬åˆ°P3ä¸ºåŠ©ç† P4=ä¸“å‘˜ P5=èµ„æ·±ä¸“å‘˜ P6=é«˜çº§ä¸“å‘˜ï¼ˆä¹Ÿå¯èƒ½æ˜¯é«˜çº§èµ„æ·±ï¼‰ P7=ä¸“å®¶ P8=èµ„æ·±ä¸“å®¶ï¼ˆæ¶æ„å¸ˆï¼‰ P9=é«˜çº§ä¸“å®¶ï¼ˆèµ„æ·±æ¶æ„å¸ˆï¼‰ P10=ç ”ç©¶å‘˜ P11=é«˜çº§ç ”ç©¶å‘˜ P12=ç§‘å­¦å®¶ P13=é¦–å¸­ç§‘å­¦å®¶ P14=é©¬äº‘ åŒæ—¶å¯¹åº”Pçº§è¿˜æœ‰ä¸€å¥—ç®¡ç†å±‚çš„æœºåˆ¶åœ¨ï¼š M1=P6 ä¸»ç®¡ M2=P7 ç»ç† M3=P8 èµ„æ·±ç»ç† M4 =P9 æ€»ç›‘ M5= P10 èµ„æ·±æ€»ç›‘ M6 =P11 å‰¯æ€»è£ M7=P12 èµ„æ·±å‰¯æ€»è£ M8=P13 å­å…¬å¸CEO æˆ–é›†å›¢å…¶ä»–O M9=P14 é™†å…†ç¦§ï¼ˆå‰é©¬äº‘ï¼‰ åœ¨é˜¿é‡Œæ—©äº›æ—¶å€™Pçº§æ™®éåä½ï¼Œä¸“å‘˜å¯èƒ½æ˜¯P2è¿™æ ·ï¼Œåæ¥æœ‰äº†ä¸€æ¬¡Pçº§é€šè´§è†¨èƒ€ï¼Œå‡ºç°äº†æ›´å¤šçš„Pçº§ã€‚åœ¨é˜¿é‡Œåªæœ‰P6ï¼ˆM1ï¼‰åæ‰ç®—æ˜¯å…¬å¸çš„ä¸­å±‚ã€‚ä¸åŒçš„å­å…¬å¸ç»™å‡ºPçº§çš„æ ‡å‡†ä¸ä¸€æ ·ã€‚ æ¯”å¦‚ï¼šB2Bçš„æ™®éPçº§è¾ƒé«˜ï¼Œä½†æ˜¯è–ªèµ„æ°´å¹³ä½äºå¤©çŒ«å­å…¬å¸çš„åŒçº§äººå‘˜ã€‚åŒæ—¶åˆ°è¾¾è¯¥Pçº§å‘˜å·¥æ‰æœ‰äº«å—å…¬å¸RSUçš„æœºä¼šã€‚ï¼ˆä½äºP6çš„é™¤éé¡¹ç›®å‡ºè‰²æœ‰RSUå¥–åŠ±ï¼Œå¦åˆ™1è‚¡éƒ½æ‹¿ä¸åˆ°ï¼‰ 2ã€æ™‹å‡æ™‹å‡å¾ˆç®€å•ï¼š æ™‹å‡èµ„æ ¼ï¼šä¸Šå¹´åº¦KPIè¾¾3.75ã€‚ ä¸»ç®¡æåã€‚ä¸€èˆ¬KPIä¸è¾¾3.75ä¸»ç®¡ä¸ä¼šæåã€‚ æ™‹å‡å§”å‘˜ä¼šé¢è¯•ã€‚ï¼ˆæ™‹å‡å§”å‘˜ä¼šç»„æˆä¸€èˆ¬æ˜¯åˆä½œæ–¹ä¸šåŠ¡éƒ¨é—¨å¤§ä½¬ã€HRGã€è¯¥ä¸šåŠ¡çº¿å¤§ä½¬ç­‰ã€‚ï¼‰ æ™‹å‡å§”å‘˜ä¼šæŠ•ç¥¨ã€‚ P5å‡P6ç›¸å¯¹å®¹æ˜“ï¼Œå†å¾€ä¸Šä¼šè¶Šæ¥è¶Šéš¾ï¼Œä¸€èˆ¬åˆ°P7éƒ½æ˜¯å›¢é˜ŸæŠ€æœ¯leaderäº†ï¼ŒP6åˆ°P7éå¸¸éš¾ï¼Œä»å‘˜å·¥åˆ°ç®¡ç†çš„é‚£ä¸€æ­¥è·¨å‡ºå»ä¸å®¹æ˜“ï¼Œå½“ç„¶æœ‰åŒå­¦è¯´Pä¸€èˆ¬éƒ½æ˜¯ä¸“å®¶ï¼ŒMæ‰æ˜¯ç®¡ç†ï¼Œactuallyï¼Œä¸“å®¶çº¿/ç®¡ç†çº¿æœ‰æ—¶å¹¶ä¸æ˜¯åˆ†çš„é‚£ä¹ˆæ¸…æ¥šçš„ã€‚ 3ã€è–ªæ°´â€¢ é˜¿é‡Œè–ªèµ„ç»“æ„ï¼šä¸€èˆ¬æ˜¯12+1+3=16è–ª â€¢ å¹´åº•çš„å¥–é‡‘ä¸º0-6ä¸ªæœˆè–ªèµ„ï¼Œ90%äººå¯æ‹¿åˆ°3ä¸ªæœˆ â€¢ è‚¡ç¥¨æ˜¯å·¥ä½œæ»¡2å¹´æ‰èƒ½æ‹¿ï¼Œç¬¬ä¸€æ¬¡æ‹¿50%ï¼Œ4å¹´èƒ½å…¨éƒ¨æ‹¿å®Œ â˜… ç™¾åº¦ â˜…1ã€å±‚çº§ç™¾åº¦çš„çº§åˆ«æ¶æ„åˆ†æˆå››æ¡çº¿ã€‚ æŠ€æœ¯åºåˆ— Tï¼šT3 - T11 ï¼ˆä¸€èˆ¬å¯¹åº”é˜¿é‡Œé«˜ä¸€çº§åºåˆ—ï¼Œå¦‚ï¼šç™¾åº¦T3=é˜¿é‡ŒP4ï¼ŒT5/T6å±äºéƒ¨é—¨éª¨å¹²ï¼Œéå¸¸æŠ¢æ‰‹ï¼ŒäººäººçŒä¸­ç›¸å½“ä¸€éƒ¨åˆ†offeräººé€‰éƒ½æ¥è‡ªè¿™ä¸ªåºåˆ—ï¼‰ äº§å“è¿è¥åºåˆ— Pï¼šp3-P11 ï¼ˆäº§å“å’Œè¿è¥å²—ï¼Œå¯¹åº”é˜¿é‡Œé«˜1-1.5çº§åºåˆ— ç™¾åº¦p3=é˜¿é‡ŒP4-P5ä¹‹é—´) åå‹¤æ”¯æŒéƒ¨é—¨ S ï¼šS3-S11 (ä¸»è¦æ˜¯å…¬å…±ã€è¡Œæ”¿ã€æ¸ é“ç­‰ç­‰ï¼Œæ™‹å‡æ¯”è¾ƒå›°éš¾) ç®¡ç†åºåˆ— Mï¼šM1-M5 (æ¯ä¸€çº§åˆåˆ†ä¸º2ä¸ªå­çº§ M1Aã€M1B , æœ€ä½çš„æ˜¯M1Aï¼Œè‡³å°‘æ˜¯éƒ¨é—¨äºŒæŠŠæ‰‹äº†ï¼Œææ˜è¿œæ˜¯M3.2ï¼Œä»¥å‰çš„æ±¤å’Œæ¾éƒ½æ˜¯è¿™ä¸ªçº§åˆ«ï¼Œæå½¦å®æ˜¯å”¯ä¸€çš„M5ï¼Œå…¶å®ä»M3å¼€å§‹å°±æœ‰æœºä¼šåŠ å…¥Eâ€”â€”starï¼Œç±»ä¼¼äºé˜¿é‡Œçš„åˆä¼™äººä¼šè®®ï¼Œå±äºæœ€é«˜æˆ˜ç•¥å†³ç­–å±‚ã€‚ 2ã€è–ªèµ„æœˆè–ª14.6ï¼ˆ12+0.6+2ï¼‰,å…¶ä»–å²—ä½ï¼šæœˆè–ª14 T5ä»¥ä¸Šä¸ºå…³é”®å²—ä½ï¼Œå¦å¤–æœ‰è‚¡ç¥¨ã€æœŸæƒã€‚T5ã€T6å æ¯”æœ€å¤§çš„çº§åˆ«ï¼ŒT8ã€T9å æ¯”æœ€å°ï¼Œçº§åˆ«è¶Šé«˜ï¼Œæ¯æ¡£ä¹‹é—´çš„å®½å¹…è¶Šå¤§ã€‚ 3ã€æ™‹å‡åŸºæœ¬ä¸Šåº”å±Šæ¯•ä¸šç”Ÿåº”è¯¥æ˜¯T3ï¼Œä½†æ˜¯å†…éƒ¨æ™‹å‡éå¸¸æ¿€çƒˆã€‚å…¬å¸é‚£ä¹ˆå¤§ï¼Œéƒ¨é—¨å’Œéƒ¨é—¨ä¹‹é—´æœ‰ä¸šåŠ¡ç«äº‰ï¼Œè‚¯å®šä¹Ÿæœ‰äººæ‰ç«äº‰ã€‚ é€šå¸¸åº”å±Šæ¯•ä¸šç”Ÿå…¥èŒ1å¹´å¤šèƒ½å‡åˆ°T4ï¼Œä½†å¦‚æœä½ çš„éƒ¨é—¨ä¸šåŠ¡è¶³å¤Ÿæ ¸å¿ƒï¼Œæˆ–è®¸1å¹´å°±å¯ä»¥äº†ã€‚3å¹´å‡T5ã€‚ä»ç›®å‰ç™¾åº¦çš„æƒ…å†µæ¥çœ‹ï¼Œæ ¸å¿ƒå·¥ç¨‹å¸ˆé›†ä¸­åœ¨T5/6ï¼Œä½†æ˜¯ä»5/6åˆ°7æ˜¯éå¸¸è‰°éš¾çš„è¿‡ç¨‹ã€‚ ç™¾åº¦æ˜¯å¾ˆå”¯KPIè‡³ä¸Šçš„ï¼Œå…¶æ¬¡éƒ¨é—¨å¾ˆæ ¸å¿ƒï¼Œå†æ¬¡è€å¤§è¯è¯­æƒæ¯”è¾ƒé«˜ï¼Œç›¸å¯¹æ™‹å‡å®¹æ˜“äº›ã€‚ ä¸€èˆ¬æƒ…å†µåˆ†2ç§ï¼š è‡ªå·±æåï¼Œå½“ä½ è‡ªå·±è§‰å¾—å·²ç»å…·å¤‡ä¸‹ä¸€levelçš„ç´ è´¨ï¼Œå¯ä»¥è‡ªå·±æåï¼Œæååè¿›å…¥è€ƒå¯ŸæœŸï¼Œä¸»ç®¡è®¾å®šè€ƒå¯ŸæœŸç›®æ ‡ï¼Œè€ƒå¯Ÿé€šè¿‡é¡ºåˆ©æ™‹å‡ï¼Œè€ƒå¯Ÿä¸é€šè¿‡ç»´æŒåŸå±‚çº§ä¸å˜ï¼› ä¸»ç®¡æåï¼Œå¦‚æœæ˜¯ä¸»ç®¡æåï¼Œä¸€èˆ¬éƒ½æ˜¯ç›´æ¥é€šè¿‡çš„ï¼Œä½†æ˜¯å¦‚æœä½ ç°å±‚çº§å·²ç»æ¯”è¾ƒé«˜äº†ï¼Œé‚£å°±ä¸æ˜¯ç›´æ¥æåè¿™ä¹ˆç®€å•äº†ã€‚ P.S.å¦‚æœä½ èƒ½å‡åˆ°T7ï¼ŒåŸºæœ¬ä¸Šæ˜¯TLçš„çº§åˆ«ï¼Œå†™ä»£ç /ç›´æ¥åšä¸šåŠ¡çš„æ—¶é—´å°±å¾ˆå°‘äº†ã€‚","categories":[{"name":"BAT","slug":"BAT","permalink":"http://github.com/categories/BAT/"}],"tags":[{"name":"BAT","slug":"BAT","permalink":"http://github.com/tags/BAT/"}],"keywords":[{"name":"BAT","slug":"BAT","permalink":"http://github.com/categories/BAT/"}]},{"title":"ã€Androidã€‘dipå’Œpxä¹‹é—´åˆ°åº•å¦‚ä½•è½¬æ¢","slug":"ã€Androidã€‘dipå’Œpxä¹‹é—´åˆ°åº•å¦‚ä½•è½¬æ¢","date":"2016-07-22T04:02:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/07/22/ã€Androidã€‘dipå’Œpxä¹‹é—´åˆ°åº•å¦‚ä½•è½¬æ¢/","link":"","permalink":"http://github.com/2016/07/22/ã€Androidã€‘dipå’Œpxä¹‹é—´åˆ°åº•å¦‚ä½•è½¬æ¢/","excerpt":"åœ¨Android xmlå¸ƒå±€æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥è®¾ç½®pxï¼Œä¹Ÿå¯ä»¥è®¾ç½®dpï¼ˆæˆ–è€…dipï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šé€‰æ‹©ä½¿ç”¨dpï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸åŒå±å¹•åˆ†è¾¨ç‡çš„æœºå™¨ä¸Šå¸ƒå±€ä¸€è‡´ã€‚ ä½†æ˜¯åœ¨ä»£ç ä¸­ï¼Œå¦‚ä½•å¤„ç†å‘¢ï¼Ÿå¾ˆå¤šæ§ä»¶çš„æ–¹æ³•ä¸­éƒ½åªæä¾›äº†è®¾ç½®pxçš„æ–¹æ³•ï¼Œä¾‹å¦‚setPaddingï¼Œå¹¶æ²¡æœ‰æä¾›è®¾ç½®dpçš„æ–¹æ³•ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœéœ€è¦è®¾ç½®dpçš„è¯ï¼Œå°±è¦å°†dpè½¬æ¢æˆpxäº†ã€‚ ä¸€ã€åè¯ä»‹ç»1. PPI = Pixels per inchï¼Œæ¯è‹±å¯¸ä¸Šçš„åƒç´ æ•°,å³ â€œåƒç´ å¯†åº¦â€ xhdpi: 2.0 hdpi: 1.5 mdpi: 1.0 (baseline) ldpi: 0.75 ä¸‹å›¾æ˜¯Androidå®˜ç½‘dpiçš„å®šä¹‰ï¼ˆå…¶å®åœ¨è®¡ç®—æœºä¸­dpiå°±æ˜¯ppiï¼Œä¸æ˜ç™½å¯ä»¥çœ‹è¿™é‡Œ dpiä¸ppiåŒºåˆ«ï¼‰ï¼š åŒæ—¶ä¹Ÿæ³¨æ„ï¼Œæ˜¯dpiï¼Œä¸æ˜¯dipã€‚ dpiæ˜¯Dots Per Inchï¼Œæ¯è‹±å¯¸ç‚¹æ•°ã€‚ï¼ˆä¸€ä¸ªé‡åº¦å•ä½ï¼Œç”¨äºç‚¹é˜µæ•°ç å½±åƒï¼ŒæŒ‡æ¯ä¸€è‹±å¯¸é•¿åº¦ä¸­ï¼Œå–æ ·ã€å¯æ˜¾ç¤ºæˆ–è¾“å‡ºç‚¹çš„æ•°ç›®ã€‚æ˜¯ç°å®æ¦‚å¿µï¼‰ã€‚ dipæ˜¯Device Independent Pixelsï¼Œè®¾å¤‡ç‹¬ç«‹åƒç´ ã€‚ï¼ˆåˆç§°è®¾å¤‡æ— å…³åƒï¼Œæ˜¯äººä¸ºæŠ½è±¡æ¦‚å¿µ ï¼‰ã€‚ 2. dp = ä¹Ÿå°±æ˜¯dipï¼ˆdevice independent pixelsï¼‰ï¼Œè®¾å¤‡ç‹¬ç«‹åƒç´ ã€‚ä»¥160PPIå±å¹•ä¸ºæ ‡å‡†ï¼Œåˆ™1dp=1pxï¼Œåœ¨ä¸åŒçš„åƒç´ å¯†åº¦çš„è®¾å¤‡ä¸Šä¼šè‡ªåŠ¨é€‚é…ï¼Œæ¯”å¦‚: åœ¨320x480åˆ†è¾¨ç‡ï¼Œåƒç´ å¯†åº¦ä¸º160ï¼Œ1dp=1px åœ¨480x800åˆ†è¾¨ç‡ï¼Œåƒç´ å¯†åº¦ä¸º240ï¼Œ1dp=1.5px è®¡ç®—å…¬å¼ï¼š1dp*åƒç´ å¯†åº¦/160 = å®é™…åƒç´ æ•° 3. sp = scaled pixelsï¼Œæ”¾å¤§åƒç´ ï¼Œå®ƒæ˜¯å®‰å“çš„å­—ä½“å•ä½ä¸»è¦ç”¨äºå­—ä½“æ˜¾ç¤ºbest for textsizeã€‚æ ¹æ® google çš„å»ºè®®ï¼ŒTextView çš„å­—å·æœ€å¥½ä½¿ç”¨ sp åšå•ä½ï¼Œè€Œä¸”æŸ¥çœ‹TextViewçš„æºç å¯çŸ¥ Android é»˜è®¤ä½¿ç”¨ sp ä½œä¸ºå­—å·å•ä½ã€‚","text":"åœ¨Android xmlå¸ƒå±€æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥è®¾ç½®pxï¼Œä¹Ÿå¯ä»¥è®¾ç½®dpï¼ˆæˆ–è€…dipï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¼šé€‰æ‹©ä½¿ç”¨dpï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸åŒå±å¹•åˆ†è¾¨ç‡çš„æœºå™¨ä¸Šå¸ƒå±€ä¸€è‡´ã€‚ ä½†æ˜¯åœ¨ä»£ç ä¸­ï¼Œå¦‚ä½•å¤„ç†å‘¢ï¼Ÿå¾ˆå¤šæ§ä»¶çš„æ–¹æ³•ä¸­éƒ½åªæä¾›äº†è®¾ç½®pxçš„æ–¹æ³•ï¼Œä¾‹å¦‚setPaddingï¼Œå¹¶æ²¡æœ‰æä¾›è®¾ç½®dpçš„æ–¹æ³•ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœéœ€è¦è®¾ç½®dpçš„è¯ï¼Œå°±è¦å°†dpè½¬æ¢æˆpxäº†ã€‚ ä¸€ã€åè¯ä»‹ç»1. PPI = Pixels per inchï¼Œæ¯è‹±å¯¸ä¸Šçš„åƒç´ æ•°,å³ â€œåƒç´ å¯†åº¦â€ xhdpi: 2.0 hdpi: 1.5 mdpi: 1.0 (baseline) ldpi: 0.75 ä¸‹å›¾æ˜¯Androidå®˜ç½‘dpiçš„å®šä¹‰ï¼ˆå…¶å®åœ¨è®¡ç®—æœºä¸­dpiå°±æ˜¯ppiï¼Œä¸æ˜ç™½å¯ä»¥çœ‹è¿™é‡Œ dpiä¸ppiåŒºåˆ«ï¼‰ï¼š åŒæ—¶ä¹Ÿæ³¨æ„ï¼Œæ˜¯dpiï¼Œä¸æ˜¯dipã€‚ dpiæ˜¯Dots Per Inchï¼Œæ¯è‹±å¯¸ç‚¹æ•°ã€‚ï¼ˆä¸€ä¸ªé‡åº¦å•ä½ï¼Œç”¨äºç‚¹é˜µæ•°ç å½±åƒï¼ŒæŒ‡æ¯ä¸€è‹±å¯¸é•¿åº¦ä¸­ï¼Œå–æ ·ã€å¯æ˜¾ç¤ºæˆ–è¾“å‡ºç‚¹çš„æ•°ç›®ã€‚æ˜¯ç°å®æ¦‚å¿µï¼‰ã€‚ dipæ˜¯Device Independent Pixelsï¼Œè®¾å¤‡ç‹¬ç«‹åƒç´ ã€‚ï¼ˆåˆç§°è®¾å¤‡æ— å…³åƒï¼Œæ˜¯äººä¸ºæŠ½è±¡æ¦‚å¿µ ï¼‰ã€‚ 2. dp = ä¹Ÿå°±æ˜¯dipï¼ˆdevice independent pixelsï¼‰ï¼Œè®¾å¤‡ç‹¬ç«‹åƒç´ ã€‚ä»¥160PPIå±å¹•ä¸ºæ ‡å‡†ï¼Œåˆ™1dp=1pxï¼Œåœ¨ä¸åŒçš„åƒç´ å¯†åº¦çš„è®¾å¤‡ä¸Šä¼šè‡ªåŠ¨é€‚é…ï¼Œæ¯”å¦‚: åœ¨320x480åˆ†è¾¨ç‡ï¼Œåƒç´ å¯†åº¦ä¸º160ï¼Œ1dp=1px åœ¨480x800åˆ†è¾¨ç‡ï¼Œåƒç´ å¯†åº¦ä¸º240ï¼Œ1dp=1.5px è®¡ç®—å…¬å¼ï¼š1dp*åƒç´ å¯†åº¦/160 = å®é™…åƒç´ æ•° 3. sp = scaled pixelsï¼Œæ”¾å¤§åƒç´ ï¼Œå®ƒæ˜¯å®‰å“çš„å­—ä½“å•ä½ä¸»è¦ç”¨äºå­—ä½“æ˜¾ç¤ºbest for textsizeã€‚æ ¹æ® google çš„å»ºè®®ï¼ŒTextView çš„å­—å·æœ€å¥½ä½¿ç”¨ sp åšå•ä½ï¼Œè€Œä¸”æŸ¥çœ‹TextViewçš„æºç å¯çŸ¥ Android é»˜è®¤ä½¿ç”¨ sp ä½œä¸ºå­—å·å•ä½ã€‚ äºŒã€æ¢ç®—å…¬å¼ PPI çš„è¿ç®—æ–¹å¼æ˜¯ï¼šPPI = âˆšï¼ˆé•¿åº¦åƒç´ æ•°Â² + å®½åº¦åƒç´ æ•°Â²ï¼‰ / å±å¹•å¯¹è§’çº¿è‹±å¯¸æ•° dpå’Œpxçš„æ¢ç®—å…¬å¼ ï¼šdp*ppi/160 = pxã€‚æ¯”å¦‚1dp x 320ppi/160 = 2pxã€‚ sp ä¸ px çš„æ¢ç®—å…¬å¼ï¼šsp*ppi/160 = px ä¸‰ã€æ€»ç»“px = dp*ppi/160dp = px / (ppi / 160) px = sp*ppi/160sp = px / (ppi / 160) dp = sp? å››ã€è½¬æ¢ä»£ç  ä¸ºäº†æ–¹ä¾¿è¿›è¡Œpxå’Œdpä¹‹é—´çš„è½¬æ¢ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ã€‚ 1234567891011121314151617181920import android.content.Context; public class DensityUtil &#123; /** * æ ¹æ®æ‰‹æœºçš„åˆ†è¾¨ç‡ä» dp çš„å•ä½ è½¬æˆä¸º px(åƒç´ ) */ public static int dip2px(Context context, float dpValue) &#123; final float scale = context.getResources().getDisplayMetrics().density; return (int) (dpValue * scale + 0.5f); &#125; /** * æ ¹æ®æ‰‹æœºçš„åˆ†è¾¨ç‡ä» px(åƒç´ ) çš„å•ä½ è½¬æˆä¸º dp */ public static int px2dip(Context context, float pxValue) &#123; final float scale = context.getResources().getDisplayMetrics().density; return (int) (pxValue / scale + 0.5f); &#125; &#125; ã€å‚è€ƒèµ„æ–™ã€‘1ã€px ä¸ dp, spæ¢ç®—å…¬å¼2ã€dpã€spã€pxå‚»å‚»åˆ†ä¸æ¸…æ¥š[å®Œæ•´]","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘Monkeyå‹åŠ›æµ‹è¯•ä¸åœæ­¢","slug":"ã€Androidã€‘Monkeyå‹åŠ›æµ‹è¯•ä¸åœæ­¢","date":"2016-07-19T03:09:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/07/19/ã€Androidã€‘Monkeyå‹åŠ›æµ‹è¯•ä¸åœæ­¢/","link":"","permalink":"http://github.com/2016/07/19/ã€Androidã€‘Monkeyå‹åŠ›æµ‹è¯•ä¸åœæ­¢/","excerpt":"ä¸€ã€Monkey æ˜¯ä»€ä¹ˆï¼ŸMonkeyæµ‹è¯•æ˜¯Androidè‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ç§æ‰‹æ®µã€‚è¯¥å·¥å…·ç”¨äºè¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œå°±æ˜¯æ¨¡æ‹Ÿç”¨æˆ·çš„æŒ‰é”®è¾“å…¥ï¼Œè§¦æ‘¸å±è¾“å…¥ï¼Œæ‰‹åŠ¿è¾“å…¥ç­‰ï¼Œçœ‹è®¾å¤‡å¤šé•¿æ—¶é—´ä¼šå‡ºå¼‚å¸¸ã€‚ ç„¶åå¼€å‘äººå‘˜ç»“åˆmonkey æ‰“å°çš„æ—¥å¿— å’Œç³»ç»Ÿæ‰“å°çš„æ—¥å¿—ï¼Œç»“å±€æµ‹è¯•ä¸­å‡ºç°çš„é—®é¢˜ã€‚ äºŒã€Monkeyå‘½ä»¤1ï¼‰. æ ‡å‡†çš„monkey å‘½ä»¤[adb shell] monkey [options] &lt; eventcount &gt; , ä¾‹å¦‚ï¼š adb shell monkey -v 500 äº§ç”Ÿ500æ¬¡éšæœºäº‹ä»¶ï¼Œä½œç”¨åœ¨ç³»ç»Ÿä¸­æ‰€æœ‰activityï¼ˆå…¶å®ä¹Ÿä¸æ˜¯æ‰€æœ‰çš„activityï¼Œè€Œæ˜¯åŒ…å« Intent.CATEGORY_LAUNCHER æˆ–Intent.CATEGORY_MONKEY çš„activityï¼‰ã€‚ä¸Šé¢åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®é™…æƒ…å†µä¸­é€šå¸¸ä¼šæœ‰å¾ˆå¤šçš„options é€‰é¡¹. 2ï¼‰. å››å¤§ç±» å¸¸ç”¨é€‰é¡¹ äº‹ä»¶é€‰é¡¹ çº¦æŸé€‰é¡¹ è°ƒè¯•é€‰é¡¹ å…·ä½“çš„å‘½ä»¤è§£é‡Šå¯ä»¥çœ‹è¿™é‡Œï¼šandroid å‹åŠ›æµ‹è¯•å‘½ä»¤monkeyè¯¦è§£","text":"ä¸€ã€Monkey æ˜¯ä»€ä¹ˆï¼ŸMonkeyæµ‹è¯•æ˜¯Androidè‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ç§æ‰‹æ®µã€‚è¯¥å·¥å…·ç”¨äºè¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œå°±æ˜¯æ¨¡æ‹Ÿç”¨æˆ·çš„æŒ‰é”®è¾“å…¥ï¼Œè§¦æ‘¸å±è¾“å…¥ï¼Œæ‰‹åŠ¿è¾“å…¥ç­‰ï¼Œçœ‹è®¾å¤‡å¤šé•¿æ—¶é—´ä¼šå‡ºå¼‚å¸¸ã€‚ ç„¶åå¼€å‘äººå‘˜ç»“åˆmonkey æ‰“å°çš„æ—¥å¿— å’Œç³»ç»Ÿæ‰“å°çš„æ—¥å¿—ï¼Œç»“å±€æµ‹è¯•ä¸­å‡ºç°çš„é—®é¢˜ã€‚ äºŒã€Monkeyå‘½ä»¤1ï¼‰. æ ‡å‡†çš„monkey å‘½ä»¤[adb shell] monkey [options] &lt; eventcount &gt; , ä¾‹å¦‚ï¼š adb shell monkey -v 500 äº§ç”Ÿ500æ¬¡éšæœºäº‹ä»¶ï¼Œä½œç”¨åœ¨ç³»ç»Ÿä¸­æ‰€æœ‰activityï¼ˆå…¶å®ä¹Ÿä¸æ˜¯æ‰€æœ‰çš„activityï¼Œè€Œæ˜¯åŒ…å« Intent.CATEGORY_LAUNCHER æˆ–Intent.CATEGORY_MONKEY çš„activityï¼‰ã€‚ä¸Šé¢åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®é™…æƒ…å†µä¸­é€šå¸¸ä¼šæœ‰å¾ˆå¤šçš„options é€‰é¡¹. 2ï¼‰. å››å¤§ç±» å¸¸ç”¨é€‰é¡¹ äº‹ä»¶é€‰é¡¹ çº¦æŸé€‰é¡¹ è°ƒè¯•é€‰é¡¹ å…·ä½“çš„å‘½ä»¤è§£é‡Šå¯ä»¥çœ‹è¿™é‡Œï¼šandroid å‹åŠ›æµ‹è¯•å‘½ä»¤monkeyè¯¦è§£ ä¸€ä¸ªç®€å•çš„Monkeyå‘½ä»¤å¦‚ä¸‹ï¼š adb shell monkey -p com.example.xystudy -s 500 -v 10000 å·¥ä½œä¸­ä¸ºäº†ä¿è¯æµ‹è¯•æ•°é‡çš„å®Œæ•´è¿›è¡Œï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šåœ¨å‘ç”Ÿé”™è¯¯æ—¶ç«‹åˆ»é€€å‡ºå‹åŠ›æµ‹è¯•ã€‚monkey æµ‹è¯•å‘½ä»¤å¦‚ä¸‹ï¼š 1234567/** * monkey ä½œç”¨çš„åŒ…ï¼šcom.ckt.android.junit * äº§ç”Ÿæ—¶é—´åºåˆ—çš„ç§å­å€¼ï¼š500 * å¿½ç•¥ç¨‹åºå´©æºƒã€ å¿½ç•¥è¶…æ—¶ã€ ç›‘è§†æœ¬åœ°ç¨‹åºå´©æºƒã€ è¯¦ç»†ä¿¡æ¯çº§åˆ«ä¸º2ï¼Œ äº§ç”Ÿ10000ä¸ªäº‹ä»¶ ã€‚ */adb shell monkey -p com.xy.android.junit -s 500 --ignore-crashes--ignore-timeouts --monitor-native-crashes -v -v 10000 &gt; E:\\monkey_log\\java_monkey_log.txt ä¸‰ã€å¼ºåˆ¶åœæ­¢Monkeyæµ‹è¯•1adb shell ps | awk '/com\\.android\\.commands\\.monkey/ &#123; system(\"adb shell kill \" $2) &#125;' ã€å‚è€ƒèµ„æ–™ã€‘1ã€android å‹åŠ›æµ‹è¯•å‘½ä»¤monkeyè¯¦è§£2ã€Monkey çš„ä¸“é¡¹æµ‹è¯•æµ…è°ˆ","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘Appåº”ç”¨å´©æºƒ(Crash-Force Close)ä¹‹åå¦‚ä½•è®©å®ƒè‡ªåŠ¨é‡å¯ï¼Ÿ","slug":"ã€Androidã€‘Appåº”ç”¨å´©æºƒ(Crash-Force Close)ä¹‹åå¦‚ä½•è®©å®ƒè‡ªåŠ¨é‡å¯ï¼Ÿ","date":"2016-07-14T08:27:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/07/14/ã€Androidã€‘Appåº”ç”¨å´©æºƒ(Crash-Force Close)ä¹‹åå¦‚ä½•è®©å®ƒè‡ªåŠ¨é‡å¯ï¼Ÿ/","link":"","permalink":"http://github.com/2016/07/14/ã€Androidã€‘Appåº”ç”¨å´©æºƒ(Crash-Force Close)ä¹‹åå¦‚ä½•è®©å®ƒè‡ªåŠ¨é‡å¯ï¼Ÿ/","excerpt":"è‹±æ–‡åŸæ–‡ï¼š Auto Restart application after Crash/Force Close in Android. æ‰‹æœºä¸Šçš„Androidåº”ç”¨ï¼Œç»å¸¸ä¼šå‡ºç°â€œForce Closeâ€çš„é”™è¯¯ï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯å› ä¸ºä»£ç ä¸­æ²¡æœ‰æ­£ç¡®è·å–åˆ°Exceptionsã€‚é‚£ä¹ˆå¦‚æœæƒ³è®©Appåœ¨å‡ºç°è¿™ç§é”™è¯¯å´©æºƒCrashä»¥åè‡ªåŠ¨é‡å¯ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿™ç¯‡æ•™ç¨‹æˆ‘ä»¬å°†å­¦åˆ°å¦‚ä½•è‡ªåŠ¨å¤„ç†Exceptionï¼Œå¹¶ä¸”äº†è§£åœ¨App Crashä»¥åå¦‚ä½•è‡ªåŠ¨é‡å¯ã€‚ å…¶å®æ–¹æ³•å¾ˆç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ° Thread.setDefaultUncaughtExceptionHandler()ï¼Œå½“åº”ç”¨å´©æºƒçš„æ—¶å€™ä»£ç å°±ä¼šè‡ªåŠ¨è°ƒç”¨ uncaughtException() è¿™ä¸ªæ–¹æ³•ã€‚","text":"è‹±æ–‡åŸæ–‡ï¼š Auto Restart application after Crash/Force Close in Android. æ‰‹æœºä¸Šçš„Androidåº”ç”¨ï¼Œç»å¸¸ä¼šå‡ºç°â€œForce Closeâ€çš„é”™è¯¯ï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯å› ä¸ºä»£ç ä¸­æ²¡æœ‰æ­£ç¡®è·å–åˆ°Exceptionsã€‚é‚£ä¹ˆå¦‚æœæƒ³è®©Appåœ¨å‡ºç°è¿™ç§é”™è¯¯å´©æºƒCrashä»¥åè‡ªåŠ¨é‡å¯ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿™ç¯‡æ•™ç¨‹æˆ‘ä»¬å°†å­¦åˆ°å¦‚ä½•è‡ªåŠ¨å¤„ç†Exceptionï¼Œå¹¶ä¸”äº†è§£åœ¨App Crashä»¥åå¦‚ä½•è‡ªåŠ¨é‡å¯ã€‚ å…¶å®æ–¹æ³•å¾ˆç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ° Thread.setDefaultUncaughtExceptionHandler()ï¼Œå½“åº”ç”¨å´©æºƒçš„æ—¶å€™ä»£ç å°±ä¼šè‡ªåŠ¨è°ƒç”¨ uncaughtException() è¿™ä¸ªæ–¹æ³•ã€‚ æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š Step 1 åƒä¸‹é¢è¿™æ ·åˆ›å»ºä¸€ä¸ªé‡å¯ç›®æ ‡ Activity çš„ Intentï¼Œå¹¶æ·»åŠ ä¸€äº› Activity å¯åŠ¨çš„ Flagsï¼š 1234Intent intent = new Intent(activity, RelaunchActivity.class);intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK); å…¶ä¸­ï¼Œ Intent.FLAG_ACTIVITY_CLEAR_TOP ï¼š é”€æ¯ç›®æ ‡Activityå’Œå®ƒä¹‹ä¸Šçš„æ‰€æœ‰Activityï¼Œé‡æ–°åˆ›å»ºç›®æ ‡Activityã€‚ Intent.FLAG_ACTIVITY_CLEAR_TASK ï¼š å¯åŠ¨Activityæ—¶ï¼Œæ¸…é™¤ä¹‹å‰å·²ç»å­˜åœ¨çš„Activityå®ä¾‹æ‰€åœ¨çš„taskï¼Œè¿™è‡ªç„¶ä¹Ÿå°±æ¸…é™¤äº†ä¹‹å‰å­˜åœ¨çš„Activityå®ä¾‹ï¼ Intent.FLAG_ACTIVITY_NEW_TASK ï¼š å¾ˆå°‘å•ç‹¬ä½¿ç”¨ï¼Œé€šå¸¸ä¸FLAG_ACTIVITY_CLEAR_TASKæˆ–FLAG_ACTIVITY_CLEAR_TOPè”åˆä½¿ç”¨ã€‚ Step 2 åœ¨ uncaughtException() æ–¹æ³•ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 12345678910PendingIntent pendingIntent = PendingIntent.getActivity( YourApplication.getInstance().getBaseContext(), 0, intent, intent.getFlags()); AlarmManager mgr = (AlarmManager) YourApplication.getInstance().getBaseContext() .getSystemService(Context.ALARM_SERVICE);mgr.set(AlarmManager.RTC, System.currentTimeMillis() + 2000, pendingIntent); activity.finish();System.exit(2); è¿™é‡Œçš„ PendingIntent ä¸åŒäºå¸¸è§çš„ Intent ï¼ŒPendingIntent æ˜¯å¯¹ Intent çš„ä¸€ä¸ªåŒ…è£…ï¼Œå¯ä»¥ä¿å­˜ä¸‹æ¥åœ¨å°†æ¥æŸä¸€åˆ»æ‰§è¡Œã€‚å®ƒå­˜å‚¨äº†request codeã€intent å’Œ flagsã€‚ AlarmManager æ˜¯ä¸ºäº†è®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨æ¥å»¶è¿Ÿä¸¤ç§’å†æ‰§è¡Œ pendingIntent çš„ï¼Œä¹Ÿå°±æ˜¯é‡å¯æˆ‘ä»¬çš„Activityçš„ä»»åŠ¡ã€‚ Step 3 æœ€åï¼Œåœ¨ Activity çš„ onCreate() æ–¹æ³•ä¸­è°ƒç”¨å¦‚ä¸‹ä»£ç ï¼š 1Thread.setDefaultUncaughtExceptionHandler(new DefaultExceptionHandler(this)); ã€å®Œæ•´ä»£ç ã€‘ YourApplication.java 1234567891011121314151617181920212223242526272829import android.app.Application; /** * This custom class is used to Application level things. * * @author Chintan Rathod (http://www.chintanrathod.com) */public class YourApplication extends Application &#123; private static Context mContext; public static YourApplication instace; @Override public void onCreate() &#123; super.onCreate(); mContext = getApplicationContext(); instace = this; &#125; @Override public Context getApplicationContext() &#123; return super.getApplicationContext(); &#125; public static YourApplication getIntance() &#123; return instace; &#125;&#125; DefaultExceptionHandler.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import java.io.File;import java.io.FileOutputStream;import java.io.IOException;import java.io.OutputStreamWriter;import java.lang.Thread.UncaughtExceptionHandler;import java.text.SimpleDateFormat;import java.util.Date; import android.app.Activity;import android.app.AlarmManager;import android.app.PendingIntent;import android.content.Context;import android.content.Intent;import android.os.Environment;import android.util.Log; /** * This custom class is used to handle exception. * * @author Chintan Rathod (http://www.chintanrathod.com) */public class DefaultExceptionHandler implements UncaughtExceptionHandler &#123; private UncaughtExceptionHandler defaultUEH; Activity activity; public DefaultExceptionHandler(Activity activity) &#123; this.activity = activity; &#125; @Override public void uncaughtException(Thread thread, Throwable ex) &#123; try &#123; Intent intent = new Intent(activity, RelaunchActivity.class); intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK); PendingIntent pendingIntent = PendingIntent.getActivity( YourApplication.getInstance().getBaseContext(), 0, intent, intent.getFlags()); //Following code will restart your application after 2 seconds AlarmManager mgr = (AlarmManager) YourApplication.getInstance().getBaseContext() .getSystemService(Context.ALARM_SERVICE); mgr.set(AlarmManager.RTC, System.currentTimeMillis() + 1000, pendingIntent); //This will finish your activity manually activity.finish(); //This will stop your application and take out from it. System.exit(2); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; ã€å‚è€ƒèµ„æ–™ã€‘ï¼š 1ã€Activityå¯åŠ¨æ¨¡å¼(äºŒ)ä¹‹ Intentçš„Flagå±æ€§","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€SVNã€‘ä½¿ç”¨patchå‘½ä»¤ä¿å­˜æ›´æ”¹","slug":"ã€SVNã€‘ä½¿ç”¨patchå‘½ä»¤ä¿å­˜æ›´æ”¹","date":"2016-06-12T03:06:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/06/12/ã€SVNã€‘ä½¿ç”¨patchå‘½ä»¤ä¿å­˜æ›´æ”¹/","link":"","permalink":"http://github.com/2016/06/12/ã€SVNã€‘ä½¿ç”¨patchå‘½ä»¤ä¿å­˜æ›´æ”¹/","excerpt":"ä½¿ç”¨svnç®¡ç†å·¥ç¨‹ä»£ç æ—¶ï¼Œæœ‰äº›æ—¶å€™çš„æ›´æ”¹å°šæœªæ•´ç†å¥½ï¼Œéœ€è¦æš‚æ—¶æç½®ï¼Œè½¬è€Œè¿›è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œæ­¤æ—¶å°±éœ€è¦å°†å½“å‰çš„æ›´æ”¹ï¼ˆdiffï¼‰æš‚æ—¶ä¿å­˜ä¸‹æ¥ï¼Œå¿™å®Œå…¶ä»–çš„ä»»åŠ¡ä¹‹åå†ç»§ç»­è¿›è¡Œã€‚ä½†æ˜¯å¦‚æœä¸è¿›è¡Œcommitï¼Œæ€ä¹ˆä¿å­˜å½“å‰çš„æ›´æ”¹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨ patch å‘½ä»¤ï¼ ä¸€ã€ç”Ÿæˆpatchæ–‡ä»¶12svn diff &gt; patchFile // æ•´ä¸ªå·¥ç¨‹çš„å˜åŠ¨ç”Ÿæˆpatchsvn diff FILE_NAME &gt; patchFile // æŸä¸ªæ–‡ä»¶å•ç‹¬å˜åŠ¨çš„patch äºŒã€svnå›æ»š123svn revert FILE // å•ä¸ªæ–‡ä»¶å›æ»šsvn revert DIR --depth=infinity // æ•´ä¸ªç›®å½•è¿›è¡Œé€’å½’å›æ»šsvn revert . --depth=infinity // å½“å‰ç›®å½•è¿›è¡Œé€’å½’å›æ»š","text":"ä½¿ç”¨svnç®¡ç†å·¥ç¨‹ä»£ç æ—¶ï¼Œæœ‰äº›æ—¶å€™çš„æ›´æ”¹å°šæœªæ•´ç†å¥½ï¼Œéœ€è¦æš‚æ—¶æç½®ï¼Œè½¬è€Œè¿›è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œæ­¤æ—¶å°±éœ€è¦å°†å½“å‰çš„æ›´æ”¹ï¼ˆdiffï¼‰æš‚æ—¶ä¿å­˜ä¸‹æ¥ï¼Œå¿™å®Œå…¶ä»–çš„ä»»åŠ¡ä¹‹åå†ç»§ç»­è¿›è¡Œã€‚ä½†æ˜¯å¦‚æœä¸è¿›è¡Œcommitï¼Œæ€ä¹ˆä¿å­˜å½“å‰çš„æ›´æ”¹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨ patch å‘½ä»¤ï¼ ä¸€ã€ç”Ÿæˆpatchæ–‡ä»¶12svn diff &gt; patchFile // æ•´ä¸ªå·¥ç¨‹çš„å˜åŠ¨ç”Ÿæˆpatchsvn diff FILE_NAME &gt; patchFile // æŸä¸ªæ–‡ä»¶å•ç‹¬å˜åŠ¨çš„patch äºŒã€svnå›æ»š123svn revert FILE // å•ä¸ªæ–‡ä»¶å›æ»šsvn revert DIR --depth=infinity // æ•´ä¸ªç›®å½•è¿›è¡Œé€’å½’å›æ»šsvn revert . --depth=infinity // å½“å‰ç›®å½•è¿›è¡Œé€’å½’å›æ»š ä¸‰ã€æ‰“patch12patch -p0 &lt; test.patch // -p0 é€‰é¡¹è¦ä»å½“å‰ç›®å½•æŸ¥æ‰¾ç›®çš„æ–‡ä»¶ï¼ˆå¤¹ï¼‰patch -p1 &lt; test.patch // -p1 é€‰é¡¹è¦ä»å½“å‰ç›®å½•æŸ¥æ‰¾ç›®çš„æ–‡ä»¶ï¼Œä¸åŒ…å«patchä¸­çš„æœ€ä¸Šçº§ç›®å½•ï¼ˆå¤¹ï¼‰","categories":[{"name":"SVN","slug":"SVN","permalink":"http://github.com/categories/SVN/"}],"tags":[{"name":"SVN","slug":"SVN","permalink":"http://github.com/tags/SVN/"}],"keywords":[{"name":"SVN","slug":"SVN","permalink":"http://github.com/categories/SVN/"}]},{"title":"ã€Androidã€‘æŠ€æœ¯è°ƒç ”ï¼šç”¨ä»£ç æ¨¡æ‹Ÿå±å¹•ç‚¹å‡»ã€è§¦æ‘¸äº‹ä»¶","slug":"ã€Androidã€‘æŠ€æœ¯è°ƒç ”ï¼šç”¨ä»£ç æ¨¡æ‹Ÿå±å¹•ç‚¹å‡»ã€è§¦æ‘¸äº‹ä»¶","date":"2016-06-02T03:55:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/06/02/ã€Androidã€‘æŠ€æœ¯è°ƒç ”ï¼šç”¨ä»£ç æ¨¡æ‹Ÿå±å¹•ç‚¹å‡»ã€è§¦æ‘¸äº‹ä»¶/","link":"","permalink":"http://github.com/2016/06/02/ã€Androidã€‘æŠ€æœ¯è°ƒç ”ï¼šç”¨ä»£ç æ¨¡æ‹Ÿå±å¹•ç‚¹å‡»ã€è§¦æ‘¸äº‹ä»¶/","excerpt":"åœ¨Androidä¸­ï¼Œæœ‰äº›åœºæ™¯éœ€è¦ä½¿ç”¨ä»£ç æ¥æ¨¡æ‹Ÿäººçš„æ“ä½œï¼Œæ¯”å¦‚å¾®ä¿¡è‡ªåŠ¨æŠ¢çº¢åŒ…ã€UIæµ‹è¯•ç­‰éƒ½éœ€è¦æ¨¡æ‹Ÿå®ç°ç‚¹å‡»äº‹ä»¶ï¼ˆClickï¼‰ã€è§¦æ‘¸äº‹ä»¶ï¼ˆTouchï¼‰ã€é”®ç›˜äº‹ä»¶ï¼ˆKeyBoardï¼‰ç­‰ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ç°æˆçš„æ–¹æ¡ˆå¯ä»¥å®ç°å‘¢ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„å•¦ï¼Œå¾€ä¸‹çœ‹ã€‚ ç»è¿‡è°ƒç ”å‘ç°ï¼Œç»™ç³»ç»Ÿæ¨¡æ‹Ÿæ³¨å…¥è¾“å…¥äº‹ä»¶æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š ä¸€ã€ä½¿ç”¨shellå‘½ä»¤ä½¿ç”¨androidè‡ªå¸¦çš„adb shellï¼Œé‡Œé¢è‡ªå¸¦ä¸€ä¸ªinputå·¥å…·ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 123adb shell #è¿›å…¥ç³»ç»Ÿinput keyevent KEYCODE_BACK #æ¨¡æ‹ŸæŒ‰è¿”å›é”®input keyevent KEYCODE_HOME #æ¨¡æ‹ŸæŒ‰Homeé”®","text":"åœ¨Androidä¸­ï¼Œæœ‰äº›åœºæ™¯éœ€è¦ä½¿ç”¨ä»£ç æ¥æ¨¡æ‹Ÿäººçš„æ“ä½œï¼Œæ¯”å¦‚å¾®ä¿¡è‡ªåŠ¨æŠ¢çº¢åŒ…ã€UIæµ‹è¯•ç­‰éƒ½éœ€è¦æ¨¡æ‹Ÿå®ç°ç‚¹å‡»äº‹ä»¶ï¼ˆClickï¼‰ã€è§¦æ‘¸äº‹ä»¶ï¼ˆTouchï¼‰ã€é”®ç›˜äº‹ä»¶ï¼ˆKeyBoardï¼‰ç­‰ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ç°æˆçš„æ–¹æ¡ˆå¯ä»¥å®ç°å‘¢ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯è‚¯å®šçš„å•¦ï¼Œå¾€ä¸‹çœ‹ã€‚ ç»è¿‡è°ƒç ”å‘ç°ï¼Œç»™ç³»ç»Ÿæ¨¡æ‹Ÿæ³¨å…¥è¾“å…¥äº‹ä»¶æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š ä¸€ã€ä½¿ç”¨shellå‘½ä»¤ä½¿ç”¨androidè‡ªå¸¦çš„adb shellï¼Œé‡Œé¢è‡ªå¸¦ä¸€ä¸ªinputå·¥å…·ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 123adb shell #è¿›å…¥ç³»ç»Ÿinput keyevent KEYCODE_BACK #æ¨¡æ‹ŸæŒ‰è¿”å›é”®input keyevent KEYCODE_HOME #æ¨¡æ‹ŸæŒ‰Homeé”® è¿˜å¯ä»¥ç›´æ¥è¾“å…¥ç‚¹å‡»å±å¹•çš„äº‹ä»¶ï¼Œæ¨¡æ‹Ÿç‚¹å‡»å±å¹•ï¼š 1input tap 100 200 #åœ¨å±å¹•åæ ‡(100, 200)å¤„ç‚¹å‡» è¯¦ç»†çš„ç”¨æ³•å¦‚ä¸‹ï¼š äºŒã€ä½¿ç”¨ InstrumentationInstrumentationæœ¬èº«æ˜¯Androidç”¨æ¥åšæµ‹è¯•çš„å·¥å…·ï¼Œå¯ä»¥é€šè¿‡å®ƒç›‘æµ‹ç³»ç»Ÿä¸åº”ç”¨ç¨‹åºä¹‹é—´çš„äº¤äº’ã€‚è¯¦æƒ…å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£[Test Your App]ã€‚æˆ‘ä»¬è¿™é‡Œåªå…³æ³¨æ€ä¹ˆä½¿ç”¨Instrumentationäº§ç”Ÿå‘é€æŒ‰é”®æˆ–è€…è§¦å±äº‹ä»¶ã€‚ å®ƒå¯ä»¥å‘é€æŒ‰é”®ï¼š 12Instrumentation mInst = new Instrumentation(); mInst.sendKeyDownUpSync(KeyEvent.KEYCODE_CAMERA); ä¹Ÿå¯ä»¥å‘é€è§¦å±äº‹ä»¶ï¼š12345Instrumentation mInst = new Instrumentation(); mInst.sendPointerSync(MotionEvent.obtain(SystemClock.uptimeMillis(), SystemClock.uptimeMillis(), MotionEvent.ACTION_DOWN, x, y, 0); //x,y å³æ˜¯äº‹ä»¶çš„åæ ‡mInst.sendPointerSync(MotionEvent.obtain(SystemClock.uptimeMillis(), SystemClock.uptimeMillis(), MotionEvent.ACTION_UP, x, y, 0); ä¸Shellå·¥å…·ä¸€æ ·ï¼Œè¿˜æœ‰ç±»ä¼¼sendStringSync()å‘é€æ–‡æœ¬ï¼ŒsendTrackballEventSync()å‘é€è½¨è¿¹çƒäº‹ä»¶ç­‰æ–¹æ³•ã€‚ 1234sendCharacterSync(int keyCode) //ç”¨äºå‘é€æŒ‡å®šKeyCodeçš„æŒ‰é”®sendKeyDownUpSync(int key) //ç”¨äºå‘é€æŒ‡å®šKeyCodeçš„æŒ‰é”®sendPointerSync(MotionEvent event) //ç”¨äºæ¨¡æ‹ŸTouchsendStringSync(String text) //ç”¨äºå‘é€å­—ç¬¦ä¸² éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›æ–¹æ³•å‡ä¸å¯ä»¥åœ¨UIä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå¿…é¡»æ”¾åˆ°å­çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚å¦å¤–ï¼Œä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œéœ€è¦åœ¨AndroidManifast.xmlä¸­ç”³æ˜å¦‚ä¸‹æƒé™ï¼š 1&lt;uses-permission android:name=\"android.permission.INJECT_EVENTS\"/&gt; ä¸‰ã€ä½¿ç”¨Androidå†…éƒ¨APIåœ¨Androidç³»ç»Ÿä¸­ï¼Œæœ‰äº›å†…éƒ¨çš„APIæä¾›æ³¨å…¥äº‹ä»¶çš„æ–¹æ³•ã€‚å› ä¸ºæ˜¯å†…éƒ¨APIï¼Œåœ¨ä¸åŒç‰ˆæœ¬ä¸Šå¯èƒ½å˜åŒ–æ¯”è¾ƒå¤§ã€‚ä½¿ç”¨å¦‚æœæƒ³åœ¨æ™®é€šAppä¸­ä½¿ç”¨ï¼Œå¯èƒ½éœ€è¦é€šè¿‡åå°„æœºåˆ¶æ¥è°ƒç”¨ã€‚ åœ¨Android API 16ä¹‹å‰ï¼ŒWindownManageræœ‰ç›¸åº”çš„æ–¹æ³•æä¾›æ³¨å…¥äº‹ä»¶çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š 123456IBinder wmbinder = ServiceManager.getService(\"window\"); IWindowManager wm = IWindowManager.Stub.asInterface(wmbinder); //pointer wm.injectPointerEvent(myMotionEvent, false); //key wm.injectKeyEvent(new KeyEvent(KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_A), false); wm.injectKeyEvent(new KeyEvent(KeyEvent.ACTION_UP, KeyEvent.KEYCODE_A), false); //trackball wm.injectTrackballEvent(myMotionEvent, false); åœ¨API 15ä¹‹åï¼Œå¼•å…¥äº†InputManagerï¼ŒæŠŠä¸Šé¢çš„å“ªäº›injectXXXEvent()æ–¹æ³•ä»WindowManagerä¸­ç§»é™¤äº†ã€‚ä½¿ç”¨æ–¹æ³•ç±»ä¼¼ï¼š 1234567891011121314IBinder imBinder = ServiceManager.getService(\"input\"); IInputManager im = IInputManager.Stub.asInterface(imBinder);//inject key eventfinal KeyEvent keyEvent = new KeyEvent(downTime, eventTime, action, code, repeatCount, metaState, deviceId, scancode, flags | KeyEvent.FLAG_FROM_SYSTEM |KeyEvent.FLAG_KEEP_TOUCH_MODE | KeyEvent.FLAG_SOFT_KEYBOARD, source);event.setSource(InputDevice.SOURCE_ANY) im.injectInputEvent(keyEvent, InputManager.INJECT_INPUT_EVENT_MODE_WAIT_FOR_FINISH);//inject pointer eventmotionEvent.setSource(InputDevice.SOURCE_TOUCHSCREEN); im.injectInputEvent(motionEvent, InputManager.INJECT_INPUT_EVENT_MODE_WAIT_FOR_FINISH); ä»API 16å¼€å§‹ï¼ŒInputManagerå°±æˆäº†ä¸€ä¸ªå…¬å¼€çš„ç±»äº†ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•è·å¾—InputManagerå®ä¾‹ï¼š 1InputManager im = (InputManager) getSystemService(Context.INPUT_SERVICE); æ³¨æ„ï¼Œä½¿ç”¨injectEvent()åŒæ ·éœ€è¦ç”³æ˜android:name=â€android.permission.INJECT_EVENTSâ€æƒé™ã€‚ å››ã€å¯ä»¥è€ƒè™‘ä½¿ç”¨Monkeyæµ‹è¯•æ¡†æ¶è¿™ç§æ–¹æ¡ˆå°±æ˜¯å¸Œæœ›èƒ½å¤Ÿæ¨¡æ‹ŸAndroid Monkeyçš„æµ‹è¯•æ–¹æ³•ï¼Œä¸è¿‡åšä¸»å¹¶æ²¡æœ‰æ¥å¾—åŠå¯¹è¿™æ–¹é¢è¿›è¡Œæ·±å…¥çš„ç ”ç©¶ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« Android Monkeyæºç è§£æ ã€å‚è€ƒèµ„æ–™ã€‘ï¼š1ã€Androidæ¨¡æ‹Ÿäº§ç”Ÿäº‹ä»¶2ã€Android æ¨¡æ‹Ÿé”®ç›˜é¼ æ ‡äº‹ä»¶ï¼ˆSocket+Instrumentationå®ç°ï¼‰3ã€Android Monkeyæºç è§£æ","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Javaã€‘æŒ‰ä½å­˜å‚¨ï¼šä½¿ç”¨intå­˜å‚¨booleanæ•°ç»„","slug":"ã€Javaã€‘æŒ‰ä½å­˜å‚¨ï¼šä½¿ç”¨intå­˜å‚¨booleanæ•°ç»„","date":"2016-06-02T03:55:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/06/02/ã€Javaã€‘æŒ‰ä½å­˜å‚¨ï¼šä½¿ç”¨intå­˜å‚¨booleanæ•°ç»„/","link":"","permalink":"http://github.com/2016/06/02/ã€Javaã€‘æŒ‰ä½å­˜å‚¨ï¼šä½¿ç”¨intå­˜å‚¨booleanæ•°ç»„/","excerpt":"æœ‰ä¸€ç§åœºæ™¯ï¼Œæ¯”å¦‚Appè®¾ç½®é¡µä¸­ä¼šæœ‰ä¸€ç»„å¼€å…³é€‰é¡¹ï¼Œè¿™ä¸ªæ—¶å€™ä¿å­˜è¿™äº›å¼€å…³çš„çŠ¶æ€ï¼Œå¦‚æœæ¯ä¸ªæŒ‰é’®éƒ½å¯¹åº”ä¸€ä¸ªbooleanå€¼çš„è¯ï¼Œå¤ªå¤§æå°ç”¨æ˜¾å¾—é¸¡è‚‹ï¼Œé¢‘ç¹è¯»å–SharedPreferences å­˜å–æ•ˆç‡è‡ªç„¶å¿«ä¸è¿‡ä¸€æ¬¡è¯»å–ã€‚ é¦–å…ˆï¼Œæ•²å®šæ¯ä¸ªbooleanå€¼å­˜å‚¨çš„ä½ç½®12345private int mBroadcastCustomValue = 0; //ç”¨æ¥å­˜å‚¨çš„intå€¼public static final int BROADCAST_TYPE_CUSTOM_BASE = 1;public static final int BROADCAST_TYPE_CUSTOM_TRAFFIC = 1 &lt;&lt; 1;public static final int BROADCAST_TYPE_CUSTOM_CAMERA = 1 &lt;&lt; 2;public static final int BROADCAST_TYPE_CUSTOM_SAFE = 1 &lt;&lt; 3; ä¸€ã€æ·»åŠ Add123456private void addLevel(int level)&#123; mBroadcastCustomValue |= level; //add&#125;//è°ƒç”¨æ–¹å¼å¦‚ä¸‹addLevel(BROADCAST_TYPE_CUSTOM_BASE);","text":"æœ‰ä¸€ç§åœºæ™¯ï¼Œæ¯”å¦‚Appè®¾ç½®é¡µä¸­ä¼šæœ‰ä¸€ç»„å¼€å…³é€‰é¡¹ï¼Œè¿™ä¸ªæ—¶å€™ä¿å­˜è¿™äº›å¼€å…³çš„çŠ¶æ€ï¼Œå¦‚æœæ¯ä¸ªæŒ‰é’®éƒ½å¯¹åº”ä¸€ä¸ªbooleanå€¼çš„è¯ï¼Œå¤ªå¤§æå°ç”¨æ˜¾å¾—é¸¡è‚‹ï¼Œé¢‘ç¹è¯»å–SharedPreferences å­˜å–æ•ˆç‡è‡ªç„¶å¿«ä¸è¿‡ä¸€æ¬¡è¯»å–ã€‚ é¦–å…ˆï¼Œæ•²å®šæ¯ä¸ªbooleanå€¼å­˜å‚¨çš„ä½ç½®12345private int mBroadcastCustomValue = 0; //ç”¨æ¥å­˜å‚¨çš„intå€¼public static final int BROADCAST_TYPE_CUSTOM_BASE = 1;public static final int BROADCAST_TYPE_CUSTOM_TRAFFIC = 1 &lt;&lt; 1;public static final int BROADCAST_TYPE_CUSTOM_CAMERA = 1 &lt;&lt; 2;public static final int BROADCAST_TYPE_CUSTOM_SAFE = 1 &lt;&lt; 3; ä¸€ã€æ·»åŠ Add123456private void addLevel(int level)&#123; mBroadcastCustomValue |= level; //add&#125;//è°ƒç”¨æ–¹å¼å¦‚ä¸‹addLevel(BROADCAST_TYPE_CUSTOM_BASE); äºŒã€åˆ é™¤Delete123456private void deleteLevel(int level)&#123; mBroadcastCustomValue ^= mBroadcastCustomValue &amp; level; //delete&#125;//è°ƒç”¨æ–¹å¼å¦‚ä¸‹deleteLevel(BROADCAST_TYPE_CUSTOM_BASE); ä¸‰ã€è¯»å–Read123456789101112/** * ä»valueä¸­è¯»å–levelçš„è®¾ç½®å€¼ï¼Œlevelå³æ˜¯æŸä¸ªbooleanå€¼çš„ä½ç½® */private boolean isLevelAccess(int value, int level)&#123; if((value &amp; level) == level)&#123; return true; &#125; return false;&#125;//è°ƒç”¨æ–¹å¼å¦‚ä¸‹boolean a = isLevelAccess(mBroadcastCustomValue, BROADCAST_TYPE_CUSTOM_BASE);","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€MySQLã€‘æŸ¥è¯¢ä¿æŒINä¸­çš„é¡ºåº","slug":"ã€MySQLã€‘æŸ¥è¯¢ä¿æŒINä¸­çš„é¡ºåº","date":"2016-04-29T07:36:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/04/29/ã€MySQLã€‘æŸ¥è¯¢ä¿æŒINä¸­çš„é¡ºåº/","link":"","permalink":"http://github.com/2016/04/29/ã€MySQLã€‘æŸ¥è¯¢ä¿æŒINä¸­çš„é¡ºåº/","excerpt":"select * from table_name where id in ()çš„æ—¶å€™ï¼ŒMySQLä¼šè‡ªåŠ¨æŒ‰ä¸»é”®è‡ªå¢æ’åºï¼Œè¦æ˜¯æŒ‰INä¸­ç»™å®šçš„é¡ºåºæ¥å–ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ æ¯”å¦‚ä¸‹é¢è¿™ä¸ªæŸ¥è¯¢ç»“æœï¼Œmysqlä¼šé»˜è®¤ä½¿ç”¨ä¸»é”®idçš„ASCè‡ªå¢æ’åºç»“æœé›†ï¼š","text":"select * from table_name where id in ()çš„æ—¶å€™ï¼ŒMySQLä¼šè‡ªåŠ¨æŒ‰ä¸»é”®è‡ªå¢æ’åºï¼Œè¦æ˜¯æŒ‰INä¸­ç»™å®šçš„é¡ºåºæ¥å–ï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ æ¯”å¦‚ä¸‹é¢è¿™ä¸ªæŸ¥è¯¢ç»“æœï¼Œmysqlä¼šé»˜è®¤ä½¿ç”¨ä¸»é”®idçš„ASCè‡ªå¢æ’åºç»“æœé›†ï¼š é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç»´æŒæŸ¥è¯¢è¯­å¥ä¸­IN(26613,26612,26611,26610,26609,26608,26607)çš„é¡ºåºå¯ä»¥ä¹ˆï¼Ÿå½“ç„¶å¯ä»¥ï¼Œåƒä¸‹é¢è¿™æ ·ï¼Œä½¿ç”¨Order by field()ï¼š 1SELECT * from `models` where `id` in (26612,26611,26610) order by field(id,26612,26611,26610); è¿™æ ·è¯»å–å‡ºæ¥çš„é¡ºåºå°±æ˜¯INï¼ˆï¼‰è¯­å¥ä¸­çš„é¡ºåºã€‚","categories":[{"name":"MySQL","slug":"MySQL","permalink":"http://github.com/categories/MySQL/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"http://github.com/tags/MySQL/"}],"keywords":[{"name":"MySQL","slug":"MySQL","permalink":"http://github.com/categories/MySQL/"}]},{"title":"ã€Linuxã€‘æ‰§è¡Œshellè„šæœ¬å‡ºç°å¼‚å¸¸ï¼šbad interpreter- No such file or directoryå¦‚ä½•è§£å†³","slug":"ã€Linuxã€‘æ‰§è¡Œshellè„šæœ¬å‡ºç°å¼‚å¸¸ï¼šbad interpreter- No such file or directoryå¦‚ä½•è§£å†³","date":"2016-04-29T03:37:09.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/04/29/ã€Linuxã€‘æ‰§è¡Œshellè„šæœ¬å‡ºç°å¼‚å¸¸ï¼šbad interpreter- No such file or directoryå¦‚ä½•è§£å†³/","link":"","permalink":"http://github.com/2016/04/29/ã€Linuxã€‘æ‰§è¡Œshellè„šæœ¬å‡ºç°å¼‚å¸¸ï¼šbad interpreter- No such file or directoryå¦‚ä½•è§£å†³/","excerpt":"åœ¨Linuxä¸­æ‰§è¡Œ.shè„šæœ¬ï¼Œå¼‚å¸¸/bin/bash^M: bad interpreter: No such file or directory. ä¸€ã€åˆ†æè¿™æ˜¯ä¸åŒç³»ç»Ÿç¼–ç æ ¼å¼å¼•èµ·çš„ï¼šåœ¨windowsç³»ç»Ÿä¸­ç¼–è¾‘çš„.shæ–‡ä»¶å¯èƒ½æœ‰ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥åœ¨Linuxç³»ç»Ÿä¸‹æ‰§è¡Œä¼šæŠ¥ä»¥ä¸Šå¼‚å¸¸ä¿¡æ¯ã€‚ äºŒã€è§£å†³1ï¼‰åœ¨windowsä¸‹è½¬æ¢ï¼šåˆ©ç”¨ä¸€äº›ç¼–è¾‘å™¨å¦‚UltraEditæˆ–EditPlusç­‰å·¥å…·å…ˆå°†è„šæœ¬ç¼–ç è½¬æ¢ï¼Œå†æ”¾åˆ°Linuxä¸­æ‰§è¡Œã€‚è½¬æ¢æ–¹å¼å¦‚ä¸‹ï¼ˆUltraEditï¼‰ï¼šFileâ€“&gt;Conversionsâ€“&gt;DOS-&gt;UNIXå³å¯ã€‚","text":"åœ¨Linuxä¸­æ‰§è¡Œ.shè„šæœ¬ï¼Œå¼‚å¸¸/bin/bash^M: bad interpreter: No such file or directory. ä¸€ã€åˆ†æè¿™æ˜¯ä¸åŒç³»ç»Ÿç¼–ç æ ¼å¼å¼•èµ·çš„ï¼šåœ¨windowsç³»ç»Ÿä¸­ç¼–è¾‘çš„.shæ–‡ä»¶å¯èƒ½æœ‰ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥åœ¨Linuxç³»ç»Ÿä¸‹æ‰§è¡Œä¼šæŠ¥ä»¥ä¸Šå¼‚å¸¸ä¿¡æ¯ã€‚ äºŒã€è§£å†³1ï¼‰åœ¨windowsä¸‹è½¬æ¢ï¼šåˆ©ç”¨ä¸€äº›ç¼–è¾‘å™¨å¦‚UltraEditæˆ–EditPlusç­‰å·¥å…·å…ˆå°†è„šæœ¬ç¼–ç è½¬æ¢ï¼Œå†æ”¾åˆ°Linuxä¸­æ‰§è¡Œã€‚è½¬æ¢æ–¹å¼å¦‚ä¸‹ï¼ˆUltraEditï¼‰ï¼šFileâ€“&gt;Conversionsâ€“&gt;DOS-&gt;UNIXå³å¯ã€‚ 2ï¼‰ç›´æ¥åœ¨Linuxä¸­è½¬æ¢ï¼ˆæ¨èåšæ³•ï¼‰ï¼š é¦–å…ˆè¦ç¡®ä¿æ–‡ä»¶æœ‰å¯æ‰§è¡Œæƒé™ 1#sh&gt; chmod a+x filename ç„¶åä¿®æ”¹æ–‡ä»¶æ ¼å¼ 1#sh&gt; vi filename åˆ©ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶æ ¼å¼ 1:set ff æˆ– :set fileformat å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ fileformat=dos æˆ– fileformat=unix åˆ©ç”¨å¦‚ä¸‹å‘½ä»¤ä¿®æ”¹æ–‡ä»¶æ ¼å¼ 12:set ff=unix æˆ– :set fileformat=unix :wq (å­˜ç›˜é€€å‡º) æœ€åå†æ‰§è¡Œæ–‡ä»¶ 1#sh&gt;./filename","categories":[{"name":"Linux","slug":"Linux","permalink":"http://github.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"http://github.com/tags/Linux/"}],"keywords":[{"name":"Linux","slug":"Linux","permalink":"http://github.com/categories/Linux/"}]},{"title":"â€äºŒåˆ†æŸ¥æ‰¾â€œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦","slug":"â€äºŒåˆ†æŸ¥æ‰¾â€œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦","date":"2016-04-06T06:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/04/06/â€äºŒåˆ†æŸ¥æ‰¾â€œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦/","link":"","permalink":"http://github.com/2016/04/06/â€äºŒåˆ†æŸ¥æ‰¾â€œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦/","excerpt":"ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ— éå°±æ˜¯forã€whileç­‰åŒ…å«èµ·æ¥çš„åŸºæœ¬è¿ç®—å•å…ƒçš„å¾ªç¯æ¬¡æ•° 1ã€äºŒåˆ†æŸ¥æ‰¾äºŒåˆ†æŸ¥æ‰¾ï¼ˆbinary searchï¼‰ï¼Œä¹Ÿç§°ä½œæŠ˜åŠæŸ¥æ‰¾ï¼ˆhalf-interval searchï¼‰ï¼Œæ¯æ¬¡åˆ’åˆ†ä¸€åŠè¿›è¡Œä¸‹ä¸€æ­¥æœç´¢ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ— éå°±æ˜¯whileå¾ªç¯çš„æ¬¡æ•°ï¼","text":"ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ— éå°±æ˜¯forã€whileç­‰åŒ…å«èµ·æ¥çš„åŸºæœ¬è¿ç®—å•å…ƒçš„å¾ªç¯æ¬¡æ•° 1ã€äºŒåˆ†æŸ¥æ‰¾äºŒåˆ†æŸ¥æ‰¾ï¼ˆbinary searchï¼‰ï¼Œä¹Ÿç§°ä½œæŠ˜åŠæŸ¥æ‰¾ï¼ˆhalf-interval searchï¼‰ï¼Œæ¯æ¬¡åˆ’åˆ†ä¸€åŠè¿›è¡Œä¸‹ä¸€æ­¥æœç´¢ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ— éå°±æ˜¯whileå¾ªç¯çš„æ¬¡æ•°ï¼ 123456789101112131415161718//äºŒåˆ†æŸ¥æ‰¾ Java å®ç°public static int binarySearch(Integer[] srcArray, int des) &#123; int low = 0; int high = srcArray.length - 1; while ((low &lt;= high) &amp;&amp; (low &lt;= srcArray.length - 1) &amp;&amp; (high &lt;= srcArray.length - 1)) &#123; int middle = (high + low) &gt;&gt; 1; if (des == srcArray[middle]) &#123; return middle; &#125; else if (des &lt; srcArray[middle]) &#123; high = middle - 1; &#125; else &#123; low = middle + 1; &#125; &#125; return -1;&#125; 2ã€æ—¶é—´å¤æ‚åº¦æ¯”å¦‚ï¼šæ€»å…±æœ‰nä¸ªå…ƒç´ ï¼Œæ¯æ¬¡æŸ¥æ‰¾çš„åŒºé—´å¤§å°å°±æ˜¯nï¼Œn/2ï¼Œn/4ï¼Œâ€¦ï¼Œn/2^kï¼ˆæ¥ä¸‹æ¥æ“ä½œå…ƒç´ çš„å‰©ä½™ä¸ªæ•°ï¼‰ï¼Œå…¶ä¸­kå°±æ˜¯å¾ªç¯çš„æ¬¡æ•°ã€‚ç”±äºn/2^kå–æ•´å&gt;=1ï¼Œå³ä»¤n/2^k=1ï¼Œå¯å¾—k=log2n,ï¼ˆæ˜¯ä»¥2ä¸ºåº•ï¼Œnçš„å¯¹æ•°ï¼‰ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦å¯ä»¥è¡¨ç¤ºO()=O(logn)","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ç»™å¤§å®¶æ¨èä¸€æ¬¾Sublime Textçš„ä¸»é¢˜â€brogrammer-themeâ€œ","slug":"ç»™å¤§å®¶æ¨èä¸€æ¬¾Sublime Textçš„ä¸»é¢˜â€brogrammer-themeâ€œ","date":"2016-03-30T08:46:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/03/30/ç»™å¤§å®¶æ¨èä¸€æ¬¾Sublime Textçš„ä¸»é¢˜â€brogrammer-themeâ€œ/","link":"","permalink":"http://github.com/2016/03/30/ç»™å¤§å®¶æ¨èä¸€æ¬¾Sublime Textçš„ä¸»é¢˜â€brogrammer-themeâ€œ/","excerpt":"å…ˆç»™å¤§å®¶çœ‹ä¸€ä¸‹è¿™ä¸ªä¸»é¢˜çš„é¢œå€¼ï¼š","text":"å…ˆç»™å¤§å®¶çœ‹ä¸€ä¸‹è¿™ä¸ªä¸»é¢˜çš„é¢œå€¼ï¼š å¿«çœ‹å®‰è£…æ–¹æ³•ï¼š1ã€ä¸‹è½½ï¼šhttps://github.com/kenwheeler/brogrammer-theme/archive/master.zip 2ã€è§£å‹åå°†æ–‡ä»¶å¤¹æ”¹åæˆTheme - Brogrammerï¼Œç„¶åæ‰“å¼€sublime text3ï¼Œæ‰¾åˆ°é‡Œé¢çš„ Preferences -&gt; Browse Packagesï¼Œå°†æ”¹ååçš„æ–‡ä»¶å¤¹copyåˆ°å¼¹å‡ºçš„æ–‡ä»¶å¤¹ä¸­ 3ã€ç„¶åé¦–é€‰é¡¹-&gt;è®¾ç½®ç”¨æˆ·ï¼ˆPreferences -&gt; setting uerï¼‰ï¼Œå°†ä¸‹åˆ—ä»£ç æ‹·è¿›å»ï¼š 1234&#123; &quot;color_scheme&quot;: &quot;Packages/brogrammer-theme-master/brogrammer.tmTheme&quot;, &quot;font_size&quot;: 10&#125; ã€å®˜æ–¹æ–‡æ¡£ã€‘ï¼š brogrammer-theme on Github Theme - Brogrammer on Package Control","categories":[],"tags":[],"keywords":[]},{"title":"ã€Androidã€‘PicassoåŠ è½½æœ¬åœ°å›¾ç‰‡å¦‚ä½•æ¸…ç†ç¼“å­˜cacheï¼Ÿ","slug":"ã€Androidã€‘PicassoåŠ è½½æœ¬åœ°å›¾ç‰‡å¦‚ä½•æ¸…ç†ç¼“å­˜cacheï¼Ÿ","date":"2016-03-08T07:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/03/08/ã€Androidã€‘PicassoåŠ è½½æœ¬åœ°å›¾ç‰‡å¦‚ä½•æ¸…ç†ç¼“å­˜cacheï¼Ÿ/","link":"","permalink":"http://github.com/2016/03/08/ã€Androidã€‘PicassoåŠ è½½æœ¬åœ°å›¾ç‰‡å¦‚ä½•æ¸…ç†ç¼“å­˜cacheï¼Ÿ/","excerpt":"","text":"ä½¿ç”¨PicassoåŠ è½½SDå¡å›¾ç‰‡çš„æ—¶å€™ï¼ŒPicassoä¹Ÿä¼šå¯¹è¯¥å›¾ç‰‡è¿›è¡Œç¼“å­˜ã€‚æ‰€ä»¥å¦‚æœè¯¥å›¾ç‰‡å³ä½¿å·²ç»å˜äº†ï¼ŒPicassoåœ¨åŠ è½½æ—¶ä¼šä»ç„¶ä½¿ç”¨ç¼“å­˜ï¼Œè€Œä¸æ›´æ–°å›¾ç‰‡ã€‚ 1ã€Picassoç¼“å­˜ç­–ç•¥æˆ‘ä»¬éƒ½çŸ¥é“å›¾ç‰‡ç¼“å­˜ä½¿ç”¨çš„æ˜¯Mapé”®å€¼å¯¹å­˜å‚¨çš„ï¼Œè¿™é‡Œçš„Keyå°±æ˜¯åŠ è½½çš„å›¾ç‰‡çš„Urlï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„ImageUrlå»åŠ è½½å›¾ç‰‡çš„è¯ï¼Œå¦‚æœä½¿ç”¨äº†ç¼“å­˜ï¼ŒPicassoä¼šç›´æ¥è¯»å–ç¼“å­˜çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä»SDå¡ã€æˆ–è€…ç½‘ç»œHttpä¸­é‡æ–°åŠ è½½ã€‚ 2ã€Picassoå¦‚ä½•è·³è¿‡ç¼“å­˜è¯•äº†å¾ˆå¤šç½‘ä¸Šæ¨èçš„æ–¹æ³•å‡ä¸è§èµ·æ•ˆï¼Œæœ€åä½¿ç”¨äº†ä¸‹é¢è¿™ç§ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯åŠ è½½å›¾ç‰‡æ—¶ç›´æ¥è·³è¿‡ç¼“å­˜ 1Picasso.with(getContext()).load(imageUrl).memoryPolicy(MemoryPolicy.NO_CACHE).into(image); æ³¨æ„å…¶ä¸­çš„.memoryPolicy(MemoryPolicy.NO_CACHE)å³æ˜¯å…³é”®ä»£ç ï¼Œå…¶ä¸­ MemoryPolicy.NO_CACHEï¼šæ˜¯æŒ‡å›¾ç‰‡åŠ è½½æ—¶æ”¾å¼ƒåœ¨å†…å­˜ç¼“å­˜ä¸­æŸ¥æ‰¾ã€‚ MemoryPolicy.NO_STOREï¼šæ˜¯æŒ‡å›¾ç‰‡åŠ è½½å®Œä¸ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚ psï¼šæ­¤å¤„çš„æ–¹æ³•å¹¶ä¸æ˜¯çœŸæ­£çš„æ¸…ç†ç¼“å­˜ï¼Œè€Œæ˜¯è·³è¿‡ç¼“å­˜ç›´æ¥ä»æºå¤´è·å–ã€‚ ç½‘ä¸Šæœ‰å‡ ç§é”™è¯¯çš„æ–¹æ³•å¦‚ä¸‹ï¼Œç»éªŒè¯å‡ä¸èµ·æ•ˆï¼š 1ã€Picasso.with(getActivity()).invalidate(file);2ã€Picasso.with(getActivity()).load(url).skipMemoryCache().into(image); æœ€åè¿˜æ˜¯åœ¨StackOverFlowçš„Clear Cache memory of PicassoæŸ¥åˆ°äº†å¦‚ä¸Šçš„è§£å†³åŠæ³•ã€‚","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"å¦‚ä½•ç”Ÿæˆ100ä¸ª1-100ä»¥å†…çš„ä¸é‡å¤çš„éšæœºæ•°","slug":"å¦‚ä½•ç”Ÿæˆ100ä¸ª1-100ä»¥å†…çš„ä¸é‡å¤çš„éšæœºæ•°","date":"2016-01-22T03:55:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/01/22/å¦‚ä½•ç”Ÿæˆ100ä¸ª1-100ä»¥å†…çš„ä¸é‡å¤çš„éšæœºæ•°/","link":"","permalink":"http://github.com/2016/01/22/å¦‚ä½•ç”Ÿæˆ100ä¸ª1-100ä»¥å†…çš„ä¸é‡å¤çš„éšæœºæ•°/","excerpt":"è¿™æ˜¯ä¸ªç»å…¸çš„é¢è¯•é¢˜ç›®ï¼šç”Ÿæˆé•¿åº¦ä¸º100çš„æ•°ç»„ï¼Œæ’å…¥1-100ä»¥å†…çš„ä½†å‡ä¸é‡å¤çš„éšæœºæ•° ä¸€ã€ç®€å•å®ç°æ€è·¯:(1) æŠŠNä¸ªæ•°æ”¾å…¥Hashtable æˆ–è€…arrayList ä¸­. (2) ä»ä¸Šé¢çš„é›†åˆä¸­éšæœºæŠ½å–ä¸€ä¸ªæ•°æ”¾å…¥intæ•°ç»„ä¸­. (3) æŠŠå–å‡ºçš„è¿™ä¸ªæ•°ä»ä¸Šé¢çš„é›†åˆä¸­åˆ é™¤. (4) å¾ªç¯ (2),(3) æ­¥éª¤,ç›´åˆ°intæ•°ç»„å–æ»¡ä¸ºæ­¢.","text":"è¿™æ˜¯ä¸ªç»å…¸çš„é¢è¯•é¢˜ç›®ï¼šç”Ÿæˆé•¿åº¦ä¸º100çš„æ•°ç»„ï¼Œæ’å…¥1-100ä»¥å†…çš„ä½†å‡ä¸é‡å¤çš„éšæœºæ•° ä¸€ã€ç®€å•å®ç°æ€è·¯:(1) æŠŠNä¸ªæ•°æ”¾å…¥Hashtable æˆ–è€…arrayList ä¸­. (2) ä»ä¸Šé¢çš„é›†åˆä¸­éšæœºæŠ½å–ä¸€ä¸ªæ•°æ”¾å…¥intæ•°ç»„ä¸­. (3) æŠŠå–å‡ºçš„è¿™ä¸ªæ•°ä»ä¸Šé¢çš„é›†åˆä¸­åˆ é™¤. (4) å¾ªç¯ (2),(3) æ­¥éª¤,ç›´åˆ°intæ•°ç»„å–æ»¡ä¸ºæ­¢. è¿™æ˜¯ä¸€ç§æ¯”è¾ƒç®€å•çš„å®ç°æ€è·¯ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233import java.util.ArrayList;import java.util.Collections;import java.util.Random;public class Main &#123; private static int range = 100; private static ArrayList&lt;Integer&gt; originalList = new ArrayList&lt;Integer&gt;(); private static ArrayList&lt;Integer&gt; result = new ArrayList&lt;Integer&gt;(); static &#123; for (int i = 1; i &lt;= range; i++) &#123; originalList.add(i); &#125; &#125; public static void main(String args[]) &#123; for (int i = 0; i &lt; range; i++) &#123; int j = range - i; int r = (int) (new Random().nextInt(j)); result.add(originalList.get(r)); System.out.print(originalList.get(r) + \", \"); originalList.remove(r); &#125; Collections.sort(result); System.out.println(\"\\n\\nç”Ÿæˆçš„æ•°ç»„å¤§å°æ˜¯ï¼š\" + result.size() + \"------ä»¥ä¸‹æ˜¯æ’åºç»“æœï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„éšæœºæ•°\"); for (Integer i : result) &#123; System.out.print(i + \", \"); &#125; &#125;&#125; æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š 123474, 75, 47, 76, 59, 94, 2, 33, 23, 66, 60, 13, 44, 34, 7, 92, 11, 86, 4, 38, 26, 55, 64, 99, 1, 54, 30, 72, 80, 87, 15, 24, 25, 37, 83, 49, 28, 81, 79, 35, 18, 68, 61, 46, 98, 58, 85, 29, 39, 48, 53, 14, 8, 91, 42, 36, 65, 62, 6, 52, 21, 78, 63, 73, 16, 88, 5, 69, 19, 51, 50, 43, 40, 70, 89, 10, 12, 71, 96, 45, 93, 9, 31, 22, 95, 20, 17, 3, 67, 90, 41, 82, 57, 84, 100, 32, 77, 27, 97, 56, ç”Ÿæˆçš„æ•°ç»„å¤§å°æ˜¯ï¼š100------ä»¥ä¸‹æ˜¯æ’åºç»“æœï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„éšæœºæ•°1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, äºŒã€æ”¹è¿›ç®—æ³•æˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šæƒ³åˆ°è¿™ç§åšæ³•,ä½†æ˜¯å½“Hashtableæˆ–è€…ArrayListä¸­æ”¾å‡ åƒä¸‡,å‡ äº¿æ•°æ®æ—¶,è¿™æ—¶ä»é›†åˆä¸­åˆ é™¤å…ƒç´ å°†ä¸¥é‡å½±å“æ€§èƒ½,å¦‚æœçªç ´æ­¤ç“¶é¢ˆ? ç½‘ä¸Šæ‰¾åˆ°ä¸€ç§æ›´å¥½çš„æ–¹æ³•. (1) æŠŠNä¸ªæ•°æ”¾åˆ°å®¹å™¨A(intæ•°ç»„)ä¸­.(2) ä»Nä¸ªæ•°ä¸­éšæœºå–å‡º1ä¸ªæ•°æ”¾å…¥å®¹å™¨B(intæ•°ç»„)ä¸­.(3) æŠŠå®¹å™¨Aä¸­æœ€åä¸€ä¸ªæ•°ä¸éšæœºæŠ½å–çš„æ•°å¯¹è°ƒ æˆ–è€… æŠŠå®¹å™¨Aä¸­æœ€åä¸€ä¸ªæ•°è¦†ç›–éšæœºæŠ½å–å‡ºæ¥çš„æ•°.(4) è¿™æ—¶ä»å®¹å™¨A(å‡è®¾Nä¸ªæ•°,ç´¢å¼•0 åˆ° ç´¢å¼•N-2)ä¹‹é—´éšæœºå–ä¸€ä¸ªæ•°.å†æ”¾å…¥å®¹å™¨Bä¸­,é‡å¤æ­¤æ­¥éª¤. è¯´æ˜ï¼šä¹Ÿå°±æ˜¯ç¬¬äºŒæ¬¡æ˜¯ä»å®¹å™¨Aä¸­ ç¬¬ä¸€ä¸ªå…ƒç´ åˆ°å€’æ•°ç¬¬äºŒä¸ªå…ƒç´  ä¸­éšæœºå–ä¸€ä¸ªæ•°.è¿™ç§å¥½å¤„æ˜¯,éšæœºæ•°æ‰€å–èŒƒå›´é€æ­¥ç¼©å°,è€Œä¸”æœç»äº†å¤§æ•°æ®æ—¶é›†åˆæ‰§è¡Œåˆ é™¤æ“ä½œæ—¶äº§ç”Ÿçš„ç“¶é¢ˆ. æ‰€ä»¥ï¼Œå‘ä¸‹é¢è¿™æ ·å®ç°ä¼šæ›´å¥½ï¼š 1234567891011121314151617181920212223242526272829public class Main &#123; private static int range = 100; private static int[] result; public static void main(String args[]) &#123; result = getNumber(range); for (int i = 0; i &lt; range; i++) &#123; System.out.print(result[i] + \", \"); &#125; &#125; public static int[] getNumber(int total)&#123; int[] NumberBox = new int[total]; //å®¹å™¨A int[] rtnNumber = new int[total]; //å®¹å™¨B for (int i = 0; i &lt; total; i++)&#123; NumberBox[i] = i; //å…ˆæŠŠNä¸ªæ•°æ”¾å…¥å®¹å™¨Aä¸­ &#125; int end = total - 1; for (int j = 0; j &lt; total; j++)&#123; int num = new Random().nextInt(end + 1); //å–éšæœºæ•° rtnNumber[j] = NumberBox[num]; //æŠŠéšæœºæ•°æ”¾å…¥å®¹å™¨B NumberBox[num] = NumberBox[end]; //æŠŠå®¹å™¨Aä¸­æœ€åä¸€ä¸ªæ•°è¦†ç›–æ‰€å–çš„éšæœºæ•° end--; //ç¼©å°éšæœºæ•°æ‰€å–èŒƒå›´ &#125; return rtnNumber; //è¿”å›intå‹æ•°ç»„ &#125;&#125; æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š 180, 9, 70, 22, 3, 63, 12, 81, 73, 41, 90, 83, 27, 71, 88, 5, 40, 18, 25, 37, 55, 60, 93, 87, 17, 89, 99, 84, 32, 96, 62, 98, 77, 30, 23, 35, 47, 24, 21, 53, 95, 7, 85, 2, 65, 1, 39, 43, 76, 46, 42, 91, 4, 26, 52, 86, 34, 54, 38, 78, 31, 11, 66, 36, 50, 75, 16, 68, 56, 33, 48, 15, 74, 69, 49, 6, 58, 10, 29, 92, 64, 59, 28, 61, 45, 19, 14, 13, 44, 72, 94, 20, 97, 51, 67, 79, 0, 82, 8, 57,","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Androidã€‘å¦‚ä½•æŸ¥çœ‹Activity Taskæ ˆçš„æƒ…å†µ","slug":"ã€Androidã€‘å¦‚ä½•æŸ¥çœ‹Activity Taskæ ˆçš„æƒ…å†µ","date":"2016-01-19T03:48:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/01/19/ã€Androidã€‘å¦‚ä½•æŸ¥çœ‹Activity Taskæ ˆçš„æƒ…å†µ/","link":"","permalink":"http://github.com/2016/01/19/ã€Androidã€‘å¦‚ä½•æŸ¥çœ‹Activity Taskæ ˆçš„æƒ…å†µ/","excerpt":"æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ¯ä¸ªActivityéƒ½æœ‰taskAffinityå±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‡ºäº†å®ƒå¸Œæœ›è¿›å…¥çš„Taskã€‚ å¦‚æœä¸€ä¸ªActivityæ²¡æœ‰æ˜¾å¼çš„æŒ‡æ˜è¯¥ Activityçš„taskAffinityï¼Œé‚£ä¹ˆå®ƒçš„è¿™ä¸ªå±æ€§å°±ç­‰äºApplicationæŒ‡æ˜çš„taskAffinityï¼Œå¦‚æœ Applicationä¹Ÿæ²¡æœ‰æŒ‡æ˜ï¼Œé‚£ä¹ˆè¯¥taskAffinityçš„å€¼å°±ç­‰äºåŒ…åã€‚è€ŒTaskä¹Ÿæœ‰è‡ªå·±çš„affinityå±æ€§ï¼Œå®ƒçš„å€¼ç­‰äºå®ƒçš„æ ¹ Activityçš„taskAffinityçš„å€¼ã€‚ ä¸€ã€æŸ¥çœ‹taskæ ˆæƒ…å†µ åœ¨cmdå‘½ä»¤è¡Œé‡Œæˆ–è€…Android Studioä¸­çš„Terminalé‡Œæ•²å…¥å¦‚ä¸‹å‘½ä»¤ï¼š1adb shell dumpsys activity ç„¶åä¼šå‡ºç°å¾ˆé•¿ä¸€æ®µè¯¦ç»†ä¿¡æ¯ï¼Œæ»šåˆ°ä¸­é—´çš„åœ°æ–¹ï¼Œä¼šçœ‹åˆ°Taskæ ˆçš„çŠ¶æ€å¦‚ä¸‹ï¼š","text":"æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ¯ä¸ªActivityéƒ½æœ‰taskAffinityå±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‡ºäº†å®ƒå¸Œæœ›è¿›å…¥çš„Taskã€‚ å¦‚æœä¸€ä¸ªActivityæ²¡æœ‰æ˜¾å¼çš„æŒ‡æ˜è¯¥ Activityçš„taskAffinityï¼Œé‚£ä¹ˆå®ƒçš„è¿™ä¸ªå±æ€§å°±ç­‰äºApplicationæŒ‡æ˜çš„taskAffinityï¼Œå¦‚æœ Applicationä¹Ÿæ²¡æœ‰æŒ‡æ˜ï¼Œé‚£ä¹ˆè¯¥taskAffinityçš„å€¼å°±ç­‰äºåŒ…åã€‚è€ŒTaskä¹Ÿæœ‰è‡ªå·±çš„affinityå±æ€§ï¼Œå®ƒçš„å€¼ç­‰äºå®ƒçš„æ ¹ Activityçš„taskAffinityçš„å€¼ã€‚ ä¸€ã€æŸ¥çœ‹taskæ ˆæƒ…å†µ åœ¨cmdå‘½ä»¤è¡Œé‡Œæˆ–è€…Android Studioä¸­çš„Terminalé‡Œæ•²å…¥å¦‚ä¸‹å‘½ä»¤ï¼š1adb shell dumpsys activity ç„¶åä¼šå‡ºç°å¾ˆé•¿ä¸€æ®µè¯¦ç»†ä¿¡æ¯ï¼Œæ»šåˆ°ä¸­é—´çš„åœ°æ–¹ï¼Œä¼šçœ‹åˆ°Taskæ ˆçš„çŠ¶æ€å¦‚ä¸‹ï¼š æ­¤å¤–ï¼Œè¿™äº›ä¿¡æ¯çš„æœ€åº•éƒ¨è¿˜å¯ä»¥çœ‹åˆ°å½“å‰æ˜¾ç¤ºåœ¨å‰å°çš„Activityæ˜¯å“ªä¸€ä¸ªï¼Œè¿˜æœ‰ä½¿ç”¨è®¾å¤‡çš„åˆ†è¾¨ç‡ç­‰ä¿¡æ¯","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"Javaä¸­çš„å°è£…ã€ç»§æ‰¿ä¸å¤šæ€","slug":"Javaä¸­çš„å°è£…ã€ç»§æ‰¿ä¸å¤šæ€","date":"2016-01-15T07:43:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/01/15/Javaä¸­çš„å°è£…ã€ç»§æ‰¿ä¸å¤šæ€/","link":"","permalink":"http://github.com/2016/01/15/Javaä¸­çš„å°è£…ã€ç»§æ‰¿ä¸å¤šæ€/","excerpt":"è¿™æ¬¡æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹é¢å‘å¯¹è±¡çš„ä¸‰å¤§åŸºçŸ³å°è£…ï¼Œç»§æ‰¿ã€å¤šæ€ï¼Œç„¶åå¤§è‡´å¯¹æ¯”ä¸€ä¸‹ç»§æ‰¿å’Œå¤šæ€çš„åŒºåˆ«ã€‚ ä¸€ã€å°è£…ï¼š å°è£…æ˜¯å®ç°é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„ç¬¬ä¸€æ­¥ï¼Œå°è£…å°±æ˜¯å°†æ•°æ®æˆ–å‡½æ•°ç­‰é›†åˆåœ¨ä¸€ä¸ªä¸ªçš„å•å…ƒä¸­ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºç±»ï¼‰ã€‚è¢«å°è£…çš„å¯¹è±¡é€šå¸¸è¢«ç§°ä¸ºæŠ½è±¡æ•°æ®ç±»å‹ã€‚ å°è£…çš„æ„ä¹‰ï¼š å°è£…çš„æ„ä¹‰åœ¨äºä¿æŠ¤æˆ–è€…é˜²æ­¢ä»£ç ï¼ˆæ•°æ®ï¼‰è¢«æˆ‘ä»¬æ— æ„ä¸­ç ´åã€‚åœ¨é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­æ•°æ®è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªä¸­å¿ƒçš„å…ƒç´ å¹¶ä¸”å’Œä½¿ç”¨å®ƒçš„å‡½æ•°ç»“åˆçš„å¾ˆå¯†åˆ‡ï¼Œä»è€Œä¿æŠ¤å®ƒä¸è¢«å…¶å®ƒçš„å‡½æ•°æ„å¤–çš„ä¿®æ”¹ã€‚å°è£…æä¾›äº†ä¸€ä¸ªæœ‰æ•ˆçš„é€”å¾„æ¥ä¿æŠ¤æ•°æ®ä¸è¢«æ„å¤–çš„ç ´åã€‚ç›¸æ¯”æˆ‘ä»¬å°†æ•°æ®ï¼ˆç”¨åŸŸæ¥å®ç°ï¼‰åœ¨ç¨‹åºä¸­å®šä¹‰ä¸ºå…¬ç”¨çš„ï¼ˆpublicï¼‰æˆ‘ä»¬å°†å®ƒä»¬(fields)å®šä¹‰ä¸ºç§æœ‰çš„ï¼ˆprivatï¼‰åœ¨å¾ˆå¤šæ–¹é¢ä¼šæ›´å¥½ã€‚","text":"è¿™æ¬¡æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹é¢å‘å¯¹è±¡çš„ä¸‰å¤§åŸºçŸ³å°è£…ï¼Œç»§æ‰¿ã€å¤šæ€ï¼Œç„¶åå¤§è‡´å¯¹æ¯”ä¸€ä¸‹ç»§æ‰¿å’Œå¤šæ€çš„åŒºåˆ«ã€‚ ä¸€ã€å°è£…ï¼š å°è£…æ˜¯å®ç°é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„ç¬¬ä¸€æ­¥ï¼Œå°è£…å°±æ˜¯å°†æ•°æ®æˆ–å‡½æ•°ç­‰é›†åˆåœ¨ä¸€ä¸ªä¸ªçš„å•å…ƒä¸­ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºç±»ï¼‰ã€‚è¢«å°è£…çš„å¯¹è±¡é€šå¸¸è¢«ç§°ä¸ºæŠ½è±¡æ•°æ®ç±»å‹ã€‚ å°è£…çš„æ„ä¹‰ï¼š å°è£…çš„æ„ä¹‰åœ¨äºä¿æŠ¤æˆ–è€…é˜²æ­¢ä»£ç ï¼ˆæ•°æ®ï¼‰è¢«æˆ‘ä»¬æ— æ„ä¸­ç ´åã€‚åœ¨é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­æ•°æ®è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªä¸­å¿ƒçš„å…ƒç´ å¹¶ä¸”å’Œä½¿ç”¨å®ƒçš„å‡½æ•°ç»“åˆçš„å¾ˆå¯†åˆ‡ï¼Œä»è€Œä¿æŠ¤å®ƒä¸è¢«å…¶å®ƒçš„å‡½æ•°æ„å¤–çš„ä¿®æ”¹ã€‚å°è£…æä¾›äº†ä¸€ä¸ªæœ‰æ•ˆçš„é€”å¾„æ¥ä¿æŠ¤æ•°æ®ä¸è¢«æ„å¤–çš„ç ´åã€‚ç›¸æ¯”æˆ‘ä»¬å°†æ•°æ®ï¼ˆç”¨åŸŸæ¥å®ç°ï¼‰åœ¨ç¨‹åºä¸­å®šä¹‰ä¸ºå…¬ç”¨çš„ï¼ˆpublicï¼‰æˆ‘ä»¬å°†å®ƒä»¬(fields)å®šä¹‰ä¸ºç§æœ‰çš„ï¼ˆprivatï¼‰åœ¨å¾ˆå¤šæ–¹é¢ä¼šæ›´å¥½ã€‚ Javaæœ‰å››ç§è®¿é—®æƒé™ï¼Œå…¶ä¸­ä¸‰ç§æœ‰è®¿é—®æƒé™ä¿®é¥°ç¬¦ï¼Œåˆ†åˆ«ä¸ºprivateï¼Œpublicå’Œprotectedï¼Œè¿˜æœ‰ä¸€ç§ä¸å¸¦ä»»ä½•ä¿®é¥°ç¬¦ï¼š private: Javaè¯­è¨€ä¸­å¯¹è®¿é—®æƒé™é™åˆ¶çš„æœ€çª„çš„ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œç§æœ‰çš„â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•åªèƒ½è¢«è¯¥ç±»çš„å¯¹è±¡è®¿é—®ï¼Œå…¶å­ç±»ä¸èƒ½è®¿é—®ï¼Œæ›´ä¸èƒ½å…è®¸è·¨åŒ…è®¿é—®ã€‚ defaultï¼šå³ä¸åŠ ä»»ä½•è®¿é—®ä¿®é¥°ç¬¦ï¼Œé€šå¸¸ç§°ä¸ºâ€œé»˜è®¤è®¿é—®æ¨¡å¼â€œã€‚è¯¥æ¨¡å¼ä¸‹ï¼Œåªå…è®¸åœ¨åŒä¸€ä¸ªåŒ…ä¸­è¿›è¡Œè®¿é—®ã€‚ protect: ä»‹äºpublic å’Œ private ä¹‹é—´çš„ä¸€ç§è®¿é—®ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œä¿æŠ¤å½¢â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•åªèƒ½è¢«ç±»æœ¬èº«çš„æ–¹æ³•åŠå­ç±»è®¿é—®ï¼Œå³ä½¿å­ç±»åœ¨ä¸åŒçš„åŒ…ä¸­ä¹Ÿå¯ä»¥è®¿é—®ã€‚ publicï¼š Javaè¯­è¨€ä¸­è®¿é—®é™åˆ¶æœ€å®½çš„ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œå…¬å…±çš„â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•ä¸ä»…å¯ä»¥è·¨ç±»è®¿é—®ï¼Œè€Œä¸”å…è®¸è·¨åŒ…ï¼ˆpackageï¼‰è®¿é—®ã€‚ ä¸‹é¢ç”¨è¡¨æ ¼çš„å½¢å¼æ¥å±•ç¤ºå››ç§è®¿é—®æƒé™ä¹‹é—´çš„å¼‚åŒç‚¹ï¼Œè¿™æ ·ä¼šæ›´åŠ å½¢è±¡ã€‚æ³¨æ„å…¶ä¸­protectedå’Œdefaultçš„åŒºåˆ«ï¼Œè¡¨æ ¼å¦‚ä¸‹æ‰€ç¤ºï¼š æƒé™ä¿®é¥°ç¬¦ åŒä¸€ä¸ªç±» åŒä¸€ä¸ªåŒ… ä¸åŒåŒ…çš„å­ç±» ä¸åŒåŒ…çš„éå­ç±» Private âˆš Default âˆš âˆš Protected âˆš âˆš âˆš Public âˆš âˆš âˆš âˆš äºŒã€ç»§æ‰¿ é€šè¿‡ç»§æ‰¿å¯ä»¥å®ç°ä»£ç çš„å¤ç”¨ï¼Œä½¿å­ç±»å¯ä»¥æ‹¥æœ‰çˆ¶ç±»çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•ã€‚ç»§æ‰¿åº”è¯¥ç¬¦åˆä¸‹åˆ—è§„åˆ™ï¼š ç»§æ‰¿æ˜¯å¯ä¼ é€’çš„ã€‚å¦‚æœCä»Bä¸­æ´¾ç”Ÿï¼ŒBåˆä»Aä¸­æ´¾ç”Ÿï¼Œé‚£ä¹ˆCä¸ä»…ç»§æ‰¿äº†Bä¸­å£°æ˜çš„æˆå‘˜ï¼ŒåŒæ ·ä¹Ÿç»§æ‰¿äº†Aä¸­çš„æˆå‘˜ã€‚Objectç±»ä½œä¸ºæ‰€æœ‰ç±»çš„åŸºç±»ã€‚ æ´¾ç”Ÿç±»åº”å½“æ˜¯å¯¹åŸºç±»çš„æ‰©å±•ã€‚æ´¾ç”Ÿç±»å¯ä»¥æ·»åŠ æ–°çš„æˆå‘˜ï¼Œä½†ä¸èƒ½é™¤å»å·²ç»ç»§æ‰¿çš„æˆå‘˜çš„å®šä¹‰ã€‚æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ä¸èƒ½è¢«ç»§æ‰¿ã€‚é™¤æ­¤ä¹‹å¤–çš„å…¶å®ƒæˆå‘˜ï¼Œä¸è®ºå¯¹å®ƒä»¬å®šä¹‰äº†æ€æ ·çš„è®¿é—®æ–¹å¼ï¼Œéƒ½èƒ½è¢«ç»§æ‰¿ã€‚åŸºç±»ä¸­æˆå‘˜çš„è®¿é—®æ–¹å¼åªèƒ½å†³å®šæ´¾ç”Ÿç±»èƒ½å¦è®¿é—®å®ƒä»¬ã€‚ æ´¾ç”Ÿç±»å¦‚æœå®šä¹‰äº†ä¸ç»§æ‰¿è€Œæ¥çš„æˆå‘˜åŒåçš„æ–°æˆå‘˜ï¼Œå°±å¯ä»¥è¦†ç›–å·²ç»§æ‰¿çš„æˆå‘˜ã€‚ä½†è¿™å¹¶ä¸å› ä¸ºè¿™æ´¾ç”Ÿç±»åˆ é™¤äº†è¿™äº›æˆå‘˜ï¼Œåªæ˜¯ä¸èƒ½å†è®¿é—®è¿™äº›æˆå‘˜ã€‚ ç±»å¯ä»¥å®šä¹‰ä¸ºabstractæŠ½è±¡ç±»ï¼Œå®ƒçš„æ´¾ç”Ÿç±»å°±èƒ½å¤Ÿé‡è½½è¿™äº›æˆå‘˜ï¼Œä»è€Œå®ç°ç±»å¯ä»¥å±•ç¤ºå‡ºå¤šæ€æ€§ã€‚ ä¸‰ã€å¤šæ€ å¤šæ€å°±æ˜¯æŒ‡çˆ¶ç±»çš„æŸä¸ªæ–¹æ³•è¢«å­ç±»é‡å†™æ—¶ï¼Œå¯ä»¥å„è‡ªäº§ç”Ÿè‡ªå·±çš„åŠŸèƒ½è¡Œä¸ºã€‚åŒä¸€æ“ä½œä½œç”¨äºä¸åŒçš„å¯¹è±¡ï¼Œå¯ä»¥æœ‰ä¸åŒçš„è§£é‡Šï¼Œäº§ç”Ÿä¸åŒçš„æ‰§è¡Œç»“æœã€‚å°±æ˜¯çˆ¶ç±»å¼•ç”¨å¯ä»¥æŒæœ‰å­ç±»å¯¹è±¡ã€‚è¿™æ—¶å€™åªèƒ½è°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œå­ç±»ä¸­ç‰¹æœ‰æ–¹æ³•æ˜¯æ— æ³•è®¿é—®çš„ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ï¼ˆç¼–è¯‘æ—¶ï¼‰ä½ æŠŠä»–çœ‹ä½œçˆ¶ç±»å¯¹è±¡çš„åŸå› ï¼Œä½†æ˜¯åˆ°äº†è¿è¡Œçš„æ—¶å€™ï¼Œç¼–è¯‘å™¨å°±ä¼šå‘ç°è¿™ä¸ªçˆ¶ç±»å¼•ç”¨ä¸­åŸæ¥æ˜¯ä¸€ä¸ªå­ç±»çš„å¯¹åƒï¼Œæ‰€ä»¥å¦‚æœçˆ¶ç±»å’Œå­ç±»ä¸­æœ‰ç›¸åŒçš„æ–¹æ³•æ—¶ï¼Œè°ƒç”¨çš„ä¼šæ˜¯å­ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯çˆ¶ç±»çš„ã€‚ å¯ä»¥è¿™ä¹ˆè¯´ï¼šç¼–è¯‘æ—¶çœ‹çˆ¶ç±»ï¼Œè¿è¡Œæ—¶çœ‹å­ç±»ã€‚è¿è¡Œæ—¶çš„å¤šæ€æ€§å°±æ˜¯æŒ‡ç›´åˆ°ç³»ç»Ÿè¿è¡Œæ—¶ï¼Œæ‰æ ¹æ®å®é™…æƒ…å†µå†³å®šå®ç°ä½•ç§æ“ä½œã€‚C#ä¸­ï¼Œè¿è¡Œæ—¶çš„å¤šæ€æ€§é€šè¿‡è™šæˆå‘˜å®ç°ã€‚ çˆ¶ç±»A a = new çˆ¶ç±»çš„å­ç±»B();a.æ–¹æ³•();//è¿™å°±æ˜¯å¤šæ€ å®ç°å¤šæ€çš„æ–¹å¼ï¼š æ¥å£å¤šæ€æ€§ã€‚ ç»§æ‰¿å¤šæ€æ€§ã€‚ é€šè¿‡æŠ½è±¡ç±»å®ç°çš„å¤šæ€æ€§ã€‚ å››ã€ç»§æ‰¿ä¸å¤šæ€çš„åŒºåˆ« ç½‘ä¸Šçœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„è¯´æ³•æ˜¯ï¼šç»§æ‰¿æ˜¯å­ç±»ä½¿ç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œè€Œå¤šæ€åˆ™æ˜¯çˆ¶ç±»ä½¿ç”¨å­ç±»çš„æ–¹æ³•ã€‚ ç»§æ‰¿ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»ä¸­æ‰€ä»¥çš„å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯å¯¹äºprivateçš„å±ç›¸å’Œæ–¹æ³•ï¼Œç”±äºè¿™ä¸ªæ˜¯çˆ¶ç±»çš„éšç§ï¼Œæ‰€ä»¥å­ç±»è™½ç„¶æ˜¯ç»§æ‰¿äº†ï¼Œä½†æ˜¯æ²¡æœ‰å¯ä»¥è®¿é—®è¿™äº›å±æ€§å’Œæ–¹æ³•çš„å¼•ç”¨ï¼Œæ‰€ä»¥ç›¸å½“äºæ²¡æœ‰ç»§æ‰¿åˆ°ã€‚å¾ˆå¤šæ—¶å€™ï¼Œå¯ä»¥ç†è§£ä¸ºï¼Œæ²¡æœ‰ç»§æ‰¿ã€‚ å¤šæ€ï¼šå°±æ˜¯çˆ¶ç±»å¼•ç”¨å¯ä»¥æŒæœ‰å­ç±»å¯¹è±¡ã€‚è¿™æ—¶å€™åªèƒ½è°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œå­ç±»ä¸­ç‰¹æœ‰æ–¹æ³•æ˜¯æ— æ³•è®¿é—®çš„ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ï¼ˆç¼–è¯‘æ—¶ï¼‰ä½ æŠŠä»–çœ‹ä½œçˆ¶ç±»å¯¹è±¡çš„åŸå› ï¼Œä½†æ˜¯åˆ°äº†è¿è¡Œçš„æ—¶å€™ï¼Œç¼–è¯‘å™¨å°±ä¼šå‘ç°è¿™ä¸ªçˆ¶ç±»å¼•ç”¨ä¸­åŸæ¥æ˜¯ä¸€ä¸ªå­ç±»çš„å¯¹åƒï¼Œæ‰€ä»¥å¦‚æœçˆ¶ç±»å’Œå­ç±»ä¸­æœ‰ç›¸åŒçš„æ–¹æ³•æ—¶ï¼Œè°ƒç”¨çš„ä¼šæ˜¯å­ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯çˆ¶ç±»çš„ã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼šç¼–è¯‘æ—¶çœ‹çˆ¶ç±»ï¼Œè¿è¡Œæ—¶çœ‹å­ç±»ã€‚ ã€å‚è€ƒèµ„æ–™ã€‘ï¼š1ã€javaç±»çš„è®¿é—®æƒé™2ã€ç»§æ‰¿ã€å°è£…ã€å¤šæ€3ã€javaä¸­ç»§æ‰¿å’Œå¤šæ€åŒºåˆ«.4ã€é‡è½½ï¼Œç»§æ‰¿ï¼Œé‡å†™å’Œå¤šæ€çš„åŒºåˆ«","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"Javaè®¿é—®æƒé™ä¿®é¥°ç¬¦çš„åŒºåˆ«","slug":"Javaè®¿é—®æƒé™ä¿®é¥°ç¬¦çš„åŒºåˆ«","date":"2016-01-15T07:07:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/01/15/Javaè®¿é—®æƒé™ä¿®é¥°ç¬¦çš„åŒºåˆ«/","link":"","permalink":"http://github.com/2016/01/15/Javaè®¿é—®æƒé™ä¿®é¥°ç¬¦çš„åŒºåˆ«/","excerpt":"Javaæœ‰å››ç§è®¿é—®æƒé™ï¼Œå…¶ä¸­ä¸‰ç§æœ‰è®¿é—®æƒé™ä¿®é¥°ç¬¦ï¼Œåˆ†åˆ«ä¸ºprivateï¼Œpublicå’Œprotectedï¼Œè¿˜æœ‰ä¸€ç§ä¸å¸¦ä»»ä½•ä¿®é¥°ç¬¦ï¼š private: Javaè¯­è¨€ä¸­å¯¹è®¿é—®æƒé™é™åˆ¶çš„æœ€çª„çš„ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œç§æœ‰çš„â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•åªèƒ½è¢«è¯¥ç±»çš„å¯¹è±¡è®¿é—®ï¼Œå…¶å­ç±»ä¸èƒ½è®¿é—®ï¼Œæ›´ä¸èƒ½å…è®¸è·¨åŒ…è®¿é—®ã€‚ defaultï¼šå³ä¸åŠ ä»»ä½•è®¿é—®ä¿®é¥°ç¬¦ï¼Œé€šå¸¸ç§°ä¸ºâ€œé»˜è®¤è®¿é—®æ¨¡å¼â€œã€‚è¯¥æ¨¡å¼ä¸‹ï¼Œåªå…è®¸åœ¨åŒä¸€ä¸ªåŒ…ä¸­è¿›è¡Œè®¿é—®ã€‚ protect: ä»‹äºpublic å’Œ private ä¹‹é—´çš„ä¸€ç§è®¿é—®ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œä¿æŠ¤å½¢â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•åªèƒ½è¢«ç±»æœ¬èº«çš„æ–¹æ³•åŠå­ç±»è®¿é—®ï¼Œå³ä½¿å­ç±»åœ¨ä¸åŒçš„åŒ…ä¸­ä¹Ÿå¯ä»¥è®¿é—®ã€‚ publicï¼š Javaè¯­è¨€ä¸­è®¿é—®é™åˆ¶æœ€å®½çš„ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œå…¬å…±çš„â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•ä¸ä»…å¯ä»¥è·¨ç±»è®¿é—®ï¼Œè€Œä¸”å…è®¸è·¨åŒ…ï¼ˆpackageï¼‰è®¿é—®ã€‚","text":"Javaæœ‰å››ç§è®¿é—®æƒé™ï¼Œå…¶ä¸­ä¸‰ç§æœ‰è®¿é—®æƒé™ä¿®é¥°ç¬¦ï¼Œåˆ†åˆ«ä¸ºprivateï¼Œpublicå’Œprotectedï¼Œè¿˜æœ‰ä¸€ç§ä¸å¸¦ä»»ä½•ä¿®é¥°ç¬¦ï¼š private: Javaè¯­è¨€ä¸­å¯¹è®¿é—®æƒé™é™åˆ¶çš„æœ€çª„çš„ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œç§æœ‰çš„â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•åªèƒ½è¢«è¯¥ç±»çš„å¯¹è±¡è®¿é—®ï¼Œå…¶å­ç±»ä¸èƒ½è®¿é—®ï¼Œæ›´ä¸èƒ½å…è®¸è·¨åŒ…è®¿é—®ã€‚ defaultï¼šå³ä¸åŠ ä»»ä½•è®¿é—®ä¿®é¥°ç¬¦ï¼Œé€šå¸¸ç§°ä¸ºâ€œé»˜è®¤è®¿é—®æ¨¡å¼â€œã€‚è¯¥æ¨¡å¼ä¸‹ï¼Œåªå…è®¸åœ¨åŒä¸€ä¸ªåŒ…ä¸­è¿›è¡Œè®¿é—®ã€‚ protect: ä»‹äºpublic å’Œ private ä¹‹é—´çš„ä¸€ç§è®¿é—®ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œä¿æŠ¤å½¢â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•åªèƒ½è¢«ç±»æœ¬èº«çš„æ–¹æ³•åŠå­ç±»è®¿é—®ï¼Œå³ä½¿å­ç±»åœ¨ä¸åŒçš„åŒ…ä¸­ä¹Ÿå¯ä»¥è®¿é—®ã€‚ publicï¼š Javaè¯­è¨€ä¸­è®¿é—®é™åˆ¶æœ€å®½çš„ä¿®é¥°ç¬¦ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºâ€œå…¬å…±çš„â€ã€‚è¢«å…¶ä¿®é¥°çš„ç±»ã€å±æ€§ä»¥åŠæ–¹æ³•ä¸ä»…å¯ä»¥è·¨ç±»è®¿é—®ï¼Œè€Œä¸”å…è®¸è·¨åŒ…ï¼ˆpackageï¼‰è®¿é—®ã€‚ ä¸‹é¢ç”¨è¡¨æ ¼çš„å½¢å¼æ¥å±•ç¤ºå››ç§è®¿é—®æƒé™ä¹‹é—´çš„å¼‚åŒç‚¹ï¼Œè¿™æ ·ä¼šæ›´åŠ å½¢è±¡ã€‚æ³¨æ„å…¶ä¸­protectedå’Œdefaultçš„åŒºåˆ«ï¼Œè¡¨æ ¼å¦‚ä¸‹æ‰€ç¤ºï¼š æƒé™ä¿®é¥°ç¬¦ åŒä¸€ä¸ªç±» åŒä¸€ä¸ªåŒ… ä¸åŒåŒ…çš„å­ç±» ä¸åŒåŒ…çš„éå­ç±» Private âˆš Default âˆš âˆš Protected âˆš âˆš âˆš Public âˆš âˆš âˆš âˆš ã€å‚è€ƒèµ„æ–™ã€‘ï¼š1ã€javaç±»çš„è®¿é—®æƒé™","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€é¢è¯•é¢˜ã€‘Nçº§å°é˜¶ï¼ˆæ¯”å¦‚100çº§ï¼‰ï¼Œæ¯æ¬¡å¯èµ°1æ­¥æˆ–è€…2æ­¥ï¼Œæ±‚æ€»å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Ÿ","slug":"ã€é¢è¯•é¢˜ã€‘Nçº§å°é˜¶ï¼ˆæ¯”å¦‚100çº§ï¼‰ï¼Œæ¯æ¬¡å¯èµ°1æ­¥æˆ–è€…2æ­¥ï¼Œæ±‚æ€»å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Ÿ","date":"2016-01-05T07:31:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/01/05/ã€é¢è¯•é¢˜ã€‘Nçº§å°é˜¶ï¼ˆæ¯”å¦‚100çº§ï¼‰ï¼Œæ¯æ¬¡å¯èµ°1æ­¥æˆ–è€…2æ­¥ï¼Œæ±‚æ€»å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Ÿ/","link":"","permalink":"http://github.com/2016/01/05/ã€é¢è¯•é¢˜ã€‘Nçº§å°é˜¶ï¼ˆæ¯”å¦‚100çº§ï¼‰ï¼Œæ¯æ¬¡å¯èµ°1æ­¥æˆ–è€…2æ­¥ï¼Œæ±‚æ€»å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Ÿ/","excerpt":"èµ°å°é˜¶ç®—æ³•ï¼ˆæœ¬è´¨ä¸Šæ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼‰åœ¨é¢è¯•ä¸­å¸¸ä¼šé‡åˆ°ï¼Œæè¿°å°±å¦‚é¢˜ç›®é‚£æ ·ï¼šæ€»å…±100çº§å°é˜¶ï¼ˆä»»æ„çº§éƒ½è¡Œï¼‰ï¼Œå°æ˜æ¯æ¬¡å¯é€‰æ‹©èµ°1æ­¥ã€2æ­¥æˆ–è€…3æ­¥ï¼Œé—®èµ°å®Œè¿™100çº§å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Ÿ ä¸€ã€ é¢˜ç›®åˆ†æè¿™ä¸ªé—®é¢˜æœ¬è´¨ä¸Šæ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œå‡è®¾åªæœ‰ä¸€ä¸ªå°é˜¶ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ç§è·³æ³•ï¼Œé‚£å°±æ˜¯ä¸€æ¬¡è·³ä¸€çº§ï¼Œf(1)=1ï¼›å¦‚æœæœ‰ä¸¤ä¸ªå°é˜¶ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§è·³æ³•ï¼Œç¬¬ä¸€ç§è·³æ³•æ˜¯ä¸€æ¬¡è·³ä¸€çº§ï¼Œç¬¬äºŒç§è·³æ³•æ˜¯ä¸€æ¬¡è·³ä¸¤çº§,f(2)=2ã€‚å¦‚æœæœ‰å¤§äº2çº§çš„nçº§å°é˜¶ï¼Œé‚£ä¹ˆå‡å¦‚ç¬¬ä¸€æ¬¡è·³ä¸€çº§å°é˜¶ï¼Œå‰©ä¸‹è¿˜æœ‰n-1çº§å°é˜¶ï¼Œæœ‰f(n-1)ç§è·³æ³•ï¼Œå‡å¦‚ç¬¬ä¸€æ¬¡æ¡2çº§å°é˜¶ï¼Œå‰©ä¸‹n-2çº§å°é˜¶ï¼Œæœ‰f(n-2)ç§è·³æ³•ã€‚è¿™å°±è¡¨ç¤ºf(n)=f(n-1)+f(n-2)ã€‚å°†ä¸Šé¢çš„æ–æ³¢é‚£å¥‘æ•°åˆ—ä»£ç ç¨å¾®æ”¹ä¸€ä¸‹å°±æ˜¯æœ¬é¢˜çš„ç­”æ¡ˆã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»£ç çš„å®ç°ã€‚ äºŒã€æ–æ³¢é‚£å¥‘æ•°åˆ—æ³•1234567891011121314151617181920public class Test &#123; static final int s = 100; //è‡ªå®šä¹‰çš„å°é˜¶æ•° static int compute(int stair)&#123; if ( stair &lt;= 0)&#123; return 0; &#125; if (stair == 1)&#123; return 1; &#125; if (stair == 2)&#123; return 2; &#125; return compute(stair-1) + compute(stair-2); &#125; public static void main(String args[]) &#123; System.out.println(\"å…±æœ‰\" + compute(s) + \"ç§èµ°æ³•\"); &#125;&#125;","text":"èµ°å°é˜¶ç®—æ³•ï¼ˆæœ¬è´¨ä¸Šæ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼‰åœ¨é¢è¯•ä¸­å¸¸ä¼šé‡åˆ°ï¼Œæè¿°å°±å¦‚é¢˜ç›®é‚£æ ·ï¼šæ€»å…±100çº§å°é˜¶ï¼ˆä»»æ„çº§éƒ½è¡Œï¼‰ï¼Œå°æ˜æ¯æ¬¡å¯é€‰æ‹©èµ°1æ­¥ã€2æ­¥æˆ–è€…3æ­¥ï¼Œé—®èµ°å®Œè¿™100çº§å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Ÿ ä¸€ã€ é¢˜ç›®åˆ†æè¿™ä¸ªé—®é¢˜æœ¬è´¨ä¸Šæ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œå‡è®¾åªæœ‰ä¸€ä¸ªå°é˜¶ï¼Œé‚£ä¹ˆåªæœ‰ä¸€ç§è·³æ³•ï¼Œé‚£å°±æ˜¯ä¸€æ¬¡è·³ä¸€çº§ï¼Œf(1)=1ï¼›å¦‚æœæœ‰ä¸¤ä¸ªå°é˜¶ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§è·³æ³•ï¼Œç¬¬ä¸€ç§è·³æ³•æ˜¯ä¸€æ¬¡è·³ä¸€çº§ï¼Œç¬¬äºŒç§è·³æ³•æ˜¯ä¸€æ¬¡è·³ä¸¤çº§,f(2)=2ã€‚å¦‚æœæœ‰å¤§äº2çº§çš„nçº§å°é˜¶ï¼Œé‚£ä¹ˆå‡å¦‚ç¬¬ä¸€æ¬¡è·³ä¸€çº§å°é˜¶ï¼Œå‰©ä¸‹è¿˜æœ‰n-1çº§å°é˜¶ï¼Œæœ‰f(n-1)ç§è·³æ³•ï¼Œå‡å¦‚ç¬¬ä¸€æ¬¡æ¡2çº§å°é˜¶ï¼Œå‰©ä¸‹n-2çº§å°é˜¶ï¼Œæœ‰f(n-2)ç§è·³æ³•ã€‚è¿™å°±è¡¨ç¤ºf(n)=f(n-1)+f(n-2)ã€‚å°†ä¸Šé¢çš„æ–æ³¢é‚£å¥‘æ•°åˆ—ä»£ç ç¨å¾®æ”¹ä¸€ä¸‹å°±æ˜¯æœ¬é¢˜çš„ç­”æ¡ˆã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»£ç çš„å®ç°ã€‚ äºŒã€æ–æ³¢é‚£å¥‘æ•°åˆ—æ³•1234567891011121314151617181920public class Test &#123; static final int s = 100; //è‡ªå®šä¹‰çš„å°é˜¶æ•° static int compute(int stair)&#123; if ( stair &lt;= 0)&#123; return 0; &#125; if (stair == 1)&#123; return 1; &#125; if (stair == 2)&#123; return 2; &#125; return compute(stair-1) + compute(stair-2); &#125; public static void main(String args[]) &#123; System.out.println(\"å…±æœ‰\" + compute(s) + \"ç§èµ°æ³•\"); &#125;&#125; ä¸‰ã€ èµ°å°é˜¶é—®é¢˜çš„ç®€å•è§£å†³ç®—æ³•ä½†æˆ‘è‡ªå·±å¯¹äºè¿™ä¸ªé¢˜ç›®æœ€æ—©çš„æƒ³æ³•æ˜¯ä½¿ç”¨æ ‘ï¼ˆå¤šå‰æ ‘ï¼‰çš„æ–¹å¼ï¼Œ100ä¸ºæ ¹èŠ‚ç‚¹ï¼Œæ¯æ¬¡é€‰æ‹©çš„åˆ†æ”¯æœ‰ä¸¤ç§ï¼ˆ1ã€2ï¼‰ï¼Œç„¶åç”Ÿæˆæ·±åº¦ä¸º1çš„æ ‘ï¼Œå†ä»æ¯ä¸ª2çº§èŠ‚ç‚¹å»¶ä¼¸å‡º1ã€2ä¸¤ä¸ªåˆ†æ”¯ï¼Œç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹çš„å€¼&lt;=0ï¼Œæœ€åç»Ÿè®¡å‡ºæ‰€æœ‰å€¼ä¸º0çš„å¶å­èŠ‚ç‚¹çš„æ•°ç›®ï¼Œå°±æ˜¯ç»“æœã€‚ ä¸è¿‡è‡ªå·±æƒ³æ³•å®é™…ä¸ŠæŠŠé—®é¢˜å¤æ‚åŒ–äº†ï¼Œä¸‹é¢è¿™ç§ä½¿ç”¨é€’å½’æ–¹å¼å®ç°çš„ç®—æ³•æœ¬è´¨ä¸Šå’Œæˆ‘çš„æ€æƒ³å·®ä¸å¤šï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾ä¸‹é¢è¿™ä¸ªç®—æ³•ä¼šç®€å•å¾ˆå¤šã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªç®—æ³•çš„å®ç°æ–¹å¼ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142public class Test &#123; static final int s = 100; //è‡ªå®šä¹‰çš„å°é˜¶æ•° static int len = 0, sum = 0; //æœ€å¤šä¹Ÿåªæœ‰èµ°100æ­¥å°±åˆ°äº† static int step[] = new int[s]; static void compute(final int stair) &#123; if (stair &lt; 0) return; //è¡¨ç¤ºå·²ç»èµ°å®Œäº† if (stair == 0) &#123; printSum(); sum++; return; &#125; //æ¯æ¬¡åˆ°ä¸‹ä¸€æ­¥é€‰æ‹©æ—¶éƒ½å¯ä»¥èµ°1-2æ­¥ for (int i = 1; i &lt;= 2; i++) &#123; step[len] = i; len++; //è¿›è¡Œä¸‹ä¸€æ­¥çš„è¿­ä»£ï¼Œè¿­ä»£å®Œä¹‹åå°†æ¯ååŠ ä¸Šçš„ä¸€æ­¥å»æ‰ï¼Œæ¢æˆå…¶å®ƒçš„æ­¥æ•°(å¦‚ä»1æ¢æˆ2) compute(stair - i); len--; &#125; &#125; static void printSum() &#123; System.out.print(\"èµ°æ³•:\"); for (int i = 0; i &lt; len; i++) System.out.print(step[i] + \" \"); System.out.println(); &#125; public static void main(String args[]) &#123; compute(s); System.out.println(\"å…±æœ‰\" + sum + \"ç§èµ°æ³•\"); &#125; &#125; ã€å‚è€ƒèµ„æ–™ã€‘ï¼š é¢è¯•é¢˜9:æ–æ³¢é‚£å¥‘æ•°åˆ— - xwdreamer - åšå®¢å›­ PHPä¸Šå°é˜¶é—®é¢˜ï¼ˆæ–æ³¢çº³å¥‘æ•°åˆ—åº”ç”¨ï¼‰","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"æ–°ä¸»é¢˜é…é…¿ä¸­...","slug":"æ–°ä¸»é¢˜é…é…¿ä¸­","date":"2016-01-04T07:08:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/01/04/æ–°ä¸»é¢˜é…é…¿ä¸­/","link":"","permalink":"http://github.com/2016/01/04/æ–°ä¸»é¢˜é…é…¿ä¸­/","excerpt":"äººä»¬å¯¹äºâ€œç¾â€ï¼Œéƒ½æœ‰ç€è¶…ä¹è‡ªå·±æƒ³è±¡çš„æ‰§å¿µã€‚ Website å†·æ·¡ç®€æ´é£æ ¼ jsdatav.is Akina theme æ·¡è…¾ louie iacool TA4.cn æ³¢æµª EndSkin Wordpressä¸»é¢˜ tagDiv &amp; ï¼ˆæŠ¥çº¸ï¼‰NEWSMAG æ¼‚äº®çš„è’™å±‚ å›¾é›† from Dribbble","text":"äººä»¬å¯¹äºâ€œç¾â€ï¼Œéƒ½æœ‰ç€è¶…ä¹è‡ªå·±æƒ³è±¡çš„æ‰§å¿µã€‚ Website å†·æ·¡ç®€æ´é£æ ¼ jsdatav.is Akina theme æ·¡è…¾ louie iacool TA4.cn æ³¢æµª EndSkin Wordpressä¸»é¢˜ tagDiv &amp; ï¼ˆæŠ¥çº¸ï¼‰NEWSMAG æ¼‚äº®çš„è’™å±‚ å›¾é›† from Dribbble from Dribbble from Dribbble from Dribbble","categories":[{"name":"Hexo","slug":"Hexo","permalink":"http://github.com/categories/Hexo/"}],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"http://github.com/tags/Hexo/"}],"keywords":[{"name":"Hexo","slug":"Hexo","permalink":"http://github.com/categories/Hexo/"}]},{"title":"å¥½çœ‹çš„å¤šè¯´æ ·å¼","slug":"å¥½çœ‹çš„å¤šè¯´æ ·å¼","date":"2016-01-03T07:08:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/01/03/å¥½çœ‹çš„å¤šè¯´æ ·å¼/","link":"","permalink":"http://github.com/2016/01/03/å¥½çœ‹çš„å¤šè¯´æ ·å¼/","excerpt":"ä»‹äºä¸æƒ³ç ´åä¸»é¢˜è¯„è®ºæ¡†ä¸æ•´ä½“çš„åè°ƒæ€§ï¼Œæ‰€ä»¥å°±æŠŠå¤šè¯´è¯„è®ºæ¡†çš„æ ·å¼æ”¹æˆäº†è·Ÿä¸»é¢˜è‡ªå¸¦è¯„è®ºä¸€æ ·çš„æ ·å­â€¦ä¸‹è¾¹æ˜¯æˆªå›¾ å¤šè¯´æ ·å¼ å•Šâ€¦ç®€ç®€å•å•å°±å¥½ï¼Œè¿™ä¸ªæ ·å¼ä¹Ÿæ˜¯æŠ„è¢­ jjlin çš„ï¼Œå¤´åƒä»€ä¹ˆçš„éƒ½æ²¡æœ‰åšåŠ¨ç”» æ²¡æ„ä¹‰æˆ‘è§‰å¾—","text":"ä»‹äºä¸æƒ³ç ´åä¸»é¢˜è¯„è®ºæ¡†ä¸æ•´ä½“çš„åè°ƒæ€§ï¼Œæ‰€ä»¥å°±æŠŠå¤šè¯´è¯„è®ºæ¡†çš„æ ·å¼æ”¹æˆäº†è·Ÿä¸»é¢˜è‡ªå¸¦è¯„è®ºä¸€æ ·çš„æ ·å­â€¦ä¸‹è¾¹æ˜¯æˆªå›¾ å¤šè¯´æ ·å¼ å•Šâ€¦ç®€ç®€å•å•å°±å¥½ï¼Œè¿™ä¸ªæ ·å¼ä¹Ÿæ˜¯æŠ„è¢­ jjlin çš„ï¼Œå¤´åƒä»€ä¹ˆçš„éƒ½æ²¡æœ‰åšåŠ¨ç”» æ²¡æ„ä¹‰æˆ‘è§‰å¾— ä¸‹è¾¹æ˜¯cssä»£ç  å¤‡ä»½ä¸€ä¸‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283#ds-reset .ds-avatar img &#123;width:50px;height:auto ;border;border-radius: 50%;&#125;#ds-thread #ds-reset .ds-comment-body &#123;background:#f5f5f5;padding: 20px 20px;margin-left: 70px;border-radius: 4px;&#125;#ds-thread #ds-reset li.ds-post &#123;border-top: 0px dotted #ddd;&#125;#ds-thread #ds-reset ul.ds-children .ds-avatar img &#123;width: 40px;height: 40px;&#125;#ds-reset .ds-highlight &#123;color: #C76666 !important;&#125;#ds-thread #ds-reset .ds-comment-body, #ds-thread #ds-reset ul.ds-children .ds-comment-body &#123;padding-left: 20px;&#125;#ds-thread #ds-reset .ds-comment-header &#123;padding-top: 1px;padding-bottom: 10px;border-bottom: 1px dashed #ddd;&#125;a.ds-post-repost &#123;display:none&#125;#ds-thread #ds-reset .ds-comment-footer &#123;text-align: right;&#125;#ds-thread #ds-reset .ds-powered-by &#123;display: none;&#125;#ds-thread #ds-reset .ds-comments, #ds-thread #ds-reset .ds-paginator &#123;border-bottom: 0px dotted #ddd;&#125;#ds-reset .ds-avatar &#123;background-color: #FDFDFD;&#125;#ds-thread #ds-reset li.ds-tab a.ds-current &#123;background-color: rgb(50, 69, 93);padding: 10px;color: white;text-shadow: none;border:none&#125;#ds-thread #ds-reset .ds-textarea-wrapper &#123;background: #F5F5F5 !important;height: 110px;border: 0px solid #ccc;&#125;#ds-thread #ds-reset .ds-post-options &#123;margin-right: 0;border: 1px solid #FBFBFB;&#125;#ds-thread #ds-reset .ds-post-options .ds-sync &#123;display:none&#125;#ds-thread #ds-reset .ds-post-button &#123; background:#FF5B5B ;width:100px&#125;#ds-thread #ds-reset .ds-post-button:hover &#123;background:#484848&#125;#ds-thread #ds-reset .ds-replybox &#123;padding: 0 0 0 60px;&#125;#ds-reset .ds-avatar &#123; box-shadow: none;&#125;#ds-thread #ds-reset .ds-replybox .ds-avatar img &#123;width: 40px;height: 40px;&#125;#ds-thread #ds-reset .ds-comment-body p &#123;margin: 1em 0;&#125;","categories":[{"name":"Hexo","slug":"Hexo","permalink":"http://github.com/categories/Hexo/"}],"tags":[],"keywords":[{"name":"Hexo","slug":"Hexo","permalink":"http://github.com/categories/Hexo/"}]},{"title":"ã€Javaã€‘å†…éƒ¨ç±»ï¼ˆInner Classï¼‰å¦‚ä½•åˆ›å»ºï¼ˆnewï¼‰","slug":"ã€Javaã€‘å†…éƒ¨ç±»ï¼ˆInner Classï¼‰å¦‚ä½•åˆ›å»ºï¼ˆnewï¼‰","date":"2016-01-02T13:13:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2016/01/02/ã€Javaã€‘å†…éƒ¨ç±»ï¼ˆInner Classï¼‰å¦‚ä½•åˆ›å»ºï¼ˆnewï¼‰/","link":"","permalink":"http://github.com/2016/01/02/ã€Javaã€‘å†…éƒ¨ç±»ï¼ˆInner Classï¼‰å¦‚ä½•åˆ›å»ºï¼ˆnewï¼‰/","excerpt":"ç®€å•æ¥è¯´ï¼Œå†…éƒ¨ç±»ï¼ˆinner classï¼‰æŒ‡é‚£äº›ç±»å®šä¹‰ä»£ç è¢«ç½®äºå…¶å®ƒç±»å®šä¹‰ä¸­çš„ç±»ï¼›è€Œå¯¹äºä¸€èˆ¬çš„ã€ç±»å®šä¹‰ä»£ç ä¸åµŒå¥—åœ¨å…¶å®ƒç±»å®šä¹‰ä¸­çš„ç±»ï¼Œç§°ä¸ºé¡¶å±‚ï¼ˆtop-levelï¼‰ç±»ã€‚å¯¹äºä¸€ä¸ªå†…éƒ¨ç±»ï¼ŒåŒ…å«å…¶å®šä¹‰ä»£ç çš„ç±»ç§°ä¸ºå®ƒçš„å¤–éƒ¨ï¼ˆouterï¼‰ç±»ã€‚ é‚£ä¹ˆå¯¹äºå†…éƒ¨ç±»ï¼Œè¯¥å¦‚ä½•å»ä½¿ç”¨å‘¢ï¼Ÿ ä¸‹é¢ç»™å‡ºé™æ€æˆå‘˜ç±»ï¼ˆStatic Member Classï¼‰å’Œæ™®é€šæˆå‘˜ç±»ï¼ˆMember Classï¼‰ä½¿ç”¨çš„æ–¹å¼ã€‚ 12345678910111213141516package cuc;import cuc.TestClass.Inner1;public class Main &#123; public static void main(String args[]) &#123; //é™æ€çš„å†…éƒ¨ç±» TestClass.Inner1 inner1 = new Inner1(); //å’Œæ™®é€šçš„é¡¶å±‚ç±»newçš„æ–¹æ³•ä¸€æ · inner1.report(); //æ™®é€šå†…éƒ¨æˆå‘˜ç±» TestClass tc = new TestClass(); TestClass.Inner2 inner2 = tc.new Inner2(); //æ³¨æ„è¿™é‡Œçš„ä½¿ç”¨æ–¹å¼ inner2.report(); &#125;&#125;","text":"ç®€å•æ¥è¯´ï¼Œå†…éƒ¨ç±»ï¼ˆinner classï¼‰æŒ‡é‚£äº›ç±»å®šä¹‰ä»£ç è¢«ç½®äºå…¶å®ƒç±»å®šä¹‰ä¸­çš„ç±»ï¼›è€Œå¯¹äºä¸€èˆ¬çš„ã€ç±»å®šä¹‰ä»£ç ä¸åµŒå¥—åœ¨å…¶å®ƒç±»å®šä¹‰ä¸­çš„ç±»ï¼Œç§°ä¸ºé¡¶å±‚ï¼ˆtop-levelï¼‰ç±»ã€‚å¯¹äºä¸€ä¸ªå†…éƒ¨ç±»ï¼ŒåŒ…å«å…¶å®šä¹‰ä»£ç çš„ç±»ç§°ä¸ºå®ƒçš„å¤–éƒ¨ï¼ˆouterï¼‰ç±»ã€‚ é‚£ä¹ˆå¯¹äºå†…éƒ¨ç±»ï¼Œè¯¥å¦‚ä½•å»ä½¿ç”¨å‘¢ï¼Ÿ ä¸‹é¢ç»™å‡ºé™æ€æˆå‘˜ç±»ï¼ˆStatic Member Classï¼‰å’Œæ™®é€šæˆå‘˜ç±»ï¼ˆMember Classï¼‰ä½¿ç”¨çš„æ–¹å¼ã€‚ 12345678910111213141516package cuc;import cuc.TestClass.Inner1;public class Main &#123; public static void main(String args[]) &#123; //é™æ€çš„å†…éƒ¨ç±» TestClass.Inner1 inner1 = new Inner1(); //å’Œæ™®é€šçš„é¡¶å±‚ç±»newçš„æ–¹æ³•ä¸€æ · inner1.report(); //æ™®é€šå†…éƒ¨æˆå‘˜ç±» TestClass tc = new TestClass(); TestClass.Inner2 inner2 = tc.new Inner2(); //æ³¨æ„è¿™é‡Œçš„ä½¿ç”¨æ–¹å¼ inner2.report(); &#125;&#125; ä¸¤ç§å†…éƒ¨ç±»çš„å®šä¹‰å¦‚ä¸‹ï¼š 123456789101112131415161718package cuc;public class TestClass &#123; //é™æ€æˆå‘˜ç±» public static class Inner1&#123; public void report()&#123; System.out.println(\"This is a inner class. (NOT static)\"); &#125; &#125; //æ™®é€šå†…éƒ¨æˆå‘˜ç±» public class Inner2&#123; public void report()&#123; System.out.println(\"This is a static inner class.\"); &#125; &#125;&#125; ã€å‚è€ƒèµ„æ–™ã€‘ï¼š1ã€java - å†…éƒ¨ç±»(Inner Class)è¯¦è§£","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€Androidã€‘ åŠ è§£å¯†ç®—æ³• HMAC çš„ä½¿ç”¨","slug":"ã€Androidã€‘ åŠ è§£å¯†ç®—æ³• HMAC çš„ä½¿ç”¨","date":"2015-12-31T07:30:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/12/31/ã€Androidã€‘ åŠ è§£å¯†ç®—æ³• HMAC çš„ä½¿ç”¨/","link":"","permalink":"http://github.com/2015/12/31/ã€Androidã€‘ åŠ è§£å¯†ç®—æ³• HMAC çš„ä½¿ç”¨/","excerpt":"1ã€HMACç®—æ³•&nbsp;&nbsp; HMACæ˜¯å¯†é’¥ç›¸å…³çš„å“ˆå¸Œè¿ç®—æ¶ˆæ¯è®¤è¯ç ï¼ˆHash-based Message Authentication Codeï¼‰,HMACè¿ç®—åˆ©ç”¨å“ˆå¸Œç®—æ³•ï¼Œä»¥ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ªæ¶ˆæ¯ä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªæ¶ˆæ¯æ‘˜è¦ä½œä¸ºè¾“å‡ºã€‚ ç®€è€Œè¨€ä¹‹ï¼ŒHMACå°±æ˜¯å«æœ‰å¯†é’¥æ•£åˆ—å‡½æ•°ç®—æ³•ï¼Œå…¼å®¹äº†MDå’ŒSHAç®—æ³•çš„ç‰¹æ€§ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸ŠåŠ ä¸Šäº†å¯†é’¥ã€‚å› æ­¤MACç®—æ³•ä¹Ÿç»å¸¸è¢«ç§°ä½œHMACç®—æ³•ã€‚å…³äºhmacç®—æ³•çš„è¯¦æƒ…å¯ä»¥å‚çœ‹RFC 2104(http://www.ietf.org/rfc/rfc2104.txt)ï¼Œè¿™é‡ŒåŒ…å«äº†HmacMD5ç®—æ³•çš„Cè¯­è¨€å®ç°ã€‚","text":"1ã€HMACç®—æ³•&nbsp;&nbsp; HMACæ˜¯å¯†é’¥ç›¸å…³çš„å“ˆå¸Œè¿ç®—æ¶ˆæ¯è®¤è¯ç ï¼ˆHash-based Message Authentication Codeï¼‰,HMACè¿ç®—åˆ©ç”¨å“ˆå¸Œç®—æ³•ï¼Œä»¥ä¸€ä¸ªå¯†é’¥å’Œä¸€ä¸ªæ¶ˆæ¯ä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªæ¶ˆæ¯æ‘˜è¦ä½œä¸ºè¾“å‡ºã€‚ ç®€è€Œè¨€ä¹‹ï¼ŒHMACå°±æ˜¯å«æœ‰å¯†é’¥æ•£åˆ—å‡½æ•°ç®—æ³•ï¼Œå…¼å®¹äº†MDå’ŒSHAç®—æ³•çš„ç‰¹æ€§ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸ŠåŠ ä¸Šäº†å¯†é’¥ã€‚å› æ­¤MACç®—æ³•ä¹Ÿç»å¸¸è¢«ç§°ä½œHMACç®—æ³•ã€‚å…³äºhmacç®—æ³•çš„è¯¦æƒ…å¯ä»¥å‚çœ‹RFC 2104(http://www.ietf.org/rfc/rfc2104.txt)ï¼Œè¿™é‡ŒåŒ…å«äº†HmacMD5ç®—æ³•çš„Cè¯­è¨€å®ç°ã€‚ 2ã€ä»£ç å®ç°ï¼ˆAndroidï¼‰12345678910111213141516171819202122232425262728293031323334//è¿™æ˜¯HMACçš„Androidä»£ç //ä¹‹æ‰€ä»¥ä¸æ˜¯Javaæ˜¯å› ä¸ºä»£ç ä¸­çš„Base64ä½¿ç”¨çš„æ˜¯android.utilåŒ…ä¸‹çš„Base64ç±»ï¼Œè€Œä¸æ˜¯Javaè‡ªå¸¦çš„Base64ç±»ã€‚public class HMACTest &#123; private static final String LOG_TAG = \"HMACTest\"; private static final String REGISTER_HMAC_KEY = \"12a9cc3f-1fd9-48a3-1fd9-1fd9d027ac2\"; private String stringToSign(String data) &#123; try &#123; Mac mac = Mac.getInstance(\"HmacSHA1\"); SecretKeySpec secret = new SecretKeySpec( REGISTER_HMAC_KEY.getBytes(\"UTF-8\"), mac.getAlgorithm()); mac.init(secret); return Base64.encodeToString(mac.doFinal(data.getBytes()), Base64.NO_WRAP); &#125; catch (NoSuchAlgorithmException e) &#123; Log.e(LOG_TAG, \"Hash algorithm SHA-1 is not supported\", e); &#125; catch (UnsupportedEncodingException e) &#123; Log.e(LOG_TAG, \"Encoding UTF-8 is not supported\", e); &#125; catch (InvalidKeyException e) &#123; Log.e(LOG_TAG, \"Invalid key\", e); &#125; return \"\"; &#125; /* * æµ‹è¯•å‡½æ•° */ public static void test() &#123; HMACTest hmac = new HMACTest(); String str = \"Bello, Miss.Seven\"; System.out.println(\"åŠ å¯†å‰ï¼š\" + str); System.out.println(\"åŠ å¯†åï¼š\" + hmac.stringToSign(str)); &#125;&#125; å‚è€ƒèµ„æ–™ æ¶ˆæ¯æ‘˜è¦ç®—æ³•-HMACç®—æ³• Java åŠ è§£å¯†æŠ€æœ¯ç³»åˆ—ä¹‹ HMAC","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘appæ‰“åŒ…æˆapkæ–‡ä»¶ä»¥åï¼Œå¦‚ä½•æŸ¥çœ‹VersionCodeã€VersionNameç­‰ç‰ˆæœ¬ä¿¡æ¯","slug":"ã€Androidã€‘appæ‰“åŒ…æˆapkæ–‡ä»¶ä»¥åï¼Œå¦‚ä½•æŸ¥çœ‹VersionCodeã€VersionNameç­‰ç‰ˆæœ¬ä¿¡æ¯","date":"2015-12-25T02:57:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/12/25/ã€Androidã€‘appæ‰“åŒ…æˆapkæ–‡ä»¶ä»¥åï¼Œå¦‚ä½•æŸ¥çœ‹VersionCodeã€VersionNameç­‰ç‰ˆæœ¬ä¿¡æ¯/","link":"","permalink":"http://github.com/2015/12/25/ã€Androidã€‘appæ‰“åŒ…æˆapkæ–‡ä»¶ä»¥åï¼Œå¦‚ä½•æŸ¥çœ‹VersionCodeã€VersionNameç­‰ç‰ˆæœ¬ä¿¡æ¯/","excerpt":"","text":"â€‹ Android Appæ‰“åŒ…æˆApkåï¼Œå…¶å®æ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œå¯ä»¥å°†åç¼€åapkæ”¹ä¸ºzipç„¶åç”¨winraræ‰“å¼€ä¹Ÿèƒ½çœ‹åˆ°é‡Œé¢çš„æ–‡ä»¶ç»“æ„ã€‚è¿˜èƒ½çœ‹åˆ°AndroidManifest.xmlã€‚ä½†æ˜¯é‡Œé¢çš„å†…å®¹ç»è¿‡ç¼–ç æ˜¾ç¤ºä¸ºä¹±ç ï¼Œä¸æ–¹ä¾¿æŸ¥çœ‹ã€‚ aaptå·¥å…·ï¼š&nbsp;&nbsp;è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨aaptå·¥å…·æ¥æŸ¥çœ‹ã€‚aapt.exeå·¥å…·å³Android Asset Packaging Toolï¼Œåœ¨SDKçš„build-toolsç›®å½•ä¸‹ã€‚ &nbsp;&nbsp;è¯¥å·¥å…·å¯ä»¥æŸ¥çœ‹ï¼Œåˆ›å»ºï¼Œ æ›´æ–°ZIPæ ¼å¼çš„æ–‡æ¡£é™„ä»¶(zip, jar, apk)ã€‚ä¹Ÿå¯å°†èµ„æºæ–‡ä»¶ç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°½ç®¡ä½ å¯èƒ½æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¿‡aaptå·¥å…·ï¼Œä½†æ˜¯build scriptså’ŒIDEæ’ä»¶ä¼šä½¿ç”¨è¿™ä¸ªå·¥å…·æ‰“åŒ…apkæ–‡ä»¶æ„æˆä¸€ä¸ªAndroid åº”ç”¨ç¨‹åºã€‚åœ¨ä½¿ç”¨aaptä¹‹å‰éœ€è¦åœ¨ç¯å¢ƒå˜é‡é‡Œé¢é…ç½®SDK-toolsè·¯å¾„ï¼Œæˆ–è€…æ˜¯è·¯å¾„+aaptçš„æ–¹å¼è¿›å…¥aaptã€‚ &nbsp;&nbsp;ä¹Ÿå°±æ˜¯è¯´å¹³æ—¶æˆ‘ä»¬ä¸ä¼šç”¨è¿™ä¸ªä¸œè¥¿ï¼Œä½†æ˜¯æ‰“åŒ…æˆApkçš„æ—¶å€™å…¶å®æ˜¯ç”¨åˆ°äº†çš„ï¼Œåªä¸è¿‡IDEæ›¿æˆ‘ä»¬åšäº†è¿™ä¸€æ­¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨è¿™ä¸ªå·¥å…·æ¥æŸ¥çœ‹VersionCodeå’ŒVersionNameã€‚ æ“ä½œæµç¨‹ï¼š1ã€é¦–å…ˆæ‰¾åˆ°aaptå·¥å…·ï¼Œåœ¨Android SDKæ–‡ä»¶å¤¹ä¸‹çš„build-toolsåŒ…é‡Œï¼Œå¦‚ä¸‹ï¼š1cd D:\\Android\\SDK\\build-tools\\23.0.0_rc3 2ã€ç„¶åä½¿ç”¨aapt dump bading XXX.apk1aapt dump badging C:\\Users\\kuguan\\Desktop\\app-release_1.0.9.apk å°±èƒ½çœ‹åˆ°PackageNameï¼ŒVersionCodeï¼ŒLauncherActivityç­‰ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ï¼š åº”ç”¨åŒ…åPackageNameï¼š LauncherActivityï¼š","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Javaã€‘ä¸ç”¨å¾ªç¯è¯­å¥å¦‚ä½•è¾“å…¥æ‰“å°æ•°ç»„å…ƒç´ ","slug":"ã€Javaã€‘ä¸ç”¨å¾ªç¯è¯­å¥å¦‚ä½•è¾“å…¥æ‰“å°æ•°ç»„å…ƒç´ ","date":"2015-12-09T05:58:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/12/09/ã€Javaã€‘ä¸ç”¨å¾ªç¯è¯­å¥å¦‚ä½•è¾“å…¥æ‰“å°æ•°ç»„å…ƒç´ /","link":"","permalink":"http://github.com/2015/12/09/ã€Javaã€‘ä¸ç”¨å¾ªç¯è¯­å¥å¦‚ä½•è¾“å…¥æ‰“å°æ•°ç»„å…ƒç´ /","excerpt":"","text":"Javaä¸­å¯ä»¥ä½¿ç”¨Arrays.toString()æ¥è¾“å‡ºæ•°ç»„ï¼Œå…äº†ä½¿ç”¨å„ç§å¾ªç¯æ¥æŒ¨ä¸ªprintçš„ç—›è‹¦ã€‚ 123456789package javacc.test;import java.util.Arrays; public class Test &#123; public static void main(String[] args) &#123; int[] array = &#123;0,1,4,7,2,5,8,3,6,9&#125;; System.out.println(Arrays.toString(array)); //æ³¨æ„è¿™é‡Œçš„ Arrays.toString() &#125;&#125;","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€Androidã€‘Activityä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»","slug":"ã€Androidã€‘Activityä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»","date":"2015-11-25T06:31:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/11/25/ã€Androidã€‘Activityä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»/","link":"","permalink":"http://github.com/2015/11/25/ã€Androidã€‘Activityä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»/","excerpt":"ä¸€ã€é—®é¢˜æè¿°ï¼š å‡è®¾æœ‰ä¸¤ä¸ªActivityï¼ˆ1å’Œ2ï¼‰,æ¯ä¸ªActivityæ‹¥æœ‰ä¸€ä¸ªFragmentï¼Œå¹¶åˆ†åˆ«æœ‰ä¸€ä¸ªButtonï¼Œç‚¹å‡»Button1å¯ä»¥start Activity2ï¼Œç„¶åç‚¹å‡»Button2å¯ä»¥finishæ‰è‡ªå·±ï¼ˆå³Activity2ï¼‰,ç„¶åè¿”å›åˆ°Activity1ã€‚æ ¹æ®è¿™ä¸ªç®€å•æ¨¡å‹æè¿°ä¸€ä¸‹Activityå’ŒFragmentçš„ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Ÿ","text":"ä¸€ã€é—®é¢˜æè¿°ï¼š å‡è®¾æœ‰ä¸¤ä¸ªActivityï¼ˆ1å’Œ2ï¼‰,æ¯ä¸ªActivityæ‹¥æœ‰ä¸€ä¸ªFragmentï¼Œå¹¶åˆ†åˆ«æœ‰ä¸€ä¸ªButtonï¼Œç‚¹å‡»Button1å¯ä»¥start Activity2ï¼Œç„¶åç‚¹å‡»Button2å¯ä»¥finishæ‰è‡ªå·±ï¼ˆå³Activity2ï¼‰,ç„¶åè¿”å›åˆ°Activity1ã€‚æ ¹æ®è¿™ä¸ªç®€å•æ¨¡å‹æè¿°ä¸€ä¸‹Activityå’ŒFragmentçš„ç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Ÿ äºŒã€ç”Ÿå‘½å‘¨æœŸçŸ¥è¯†Activityå’ŒFragmentçš„ç”Ÿå‘½å‘¨æœŸå›¾è°±å¯ä»¥å‚è€ƒæˆ‘çš„å¦å¤–ä¸€ç¯‡åšå®¢ï¼šã€Androidã€‘Fragmentçš„ç”Ÿå‘½å‘¨æœŸè¯¦è§£ï¼Œä»–ä»¬çš„å…³ç³»å¤§è‡´å¦‚ä¸‹å›¾ï¼š ä¸‰ã€ä»£ç éªŒè¯ MainActivityå’ŒSecondActivityçš„å¸ƒå±€æ˜¯è¿™æ ·çš„ï¼Œé‡Œé¢å„æ·»åŠ äº†ä¸€ä¸ªFragmentï¼š 12345678910111213141516171819202122232425/** * MainActivityå¸ƒå±€xmlæ–‡ä»¶ */&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\" android:orientation=\"vertical\" android:layout_width=\"fill_parent\" android:layout_height=\"fill_parent\"&gt; &lt;Button android:id=\"@+id/button\" android:text=\"å¼€å¯ç¬¬äºŒä¸ªActivity\" android:layout_gravity=\"center\" android:layout_width=\"wrap_content\" android:layout_height=\"wrap_content\"&gt;&lt;/Button&gt; &lt;LinearLayout android:id=\"@+id/linearlayout\" android:layout_width=\"match_parent\" android:layout_height=\"match_parent\" android:orientation=\"vertical\" android:background=\"#339999\"&gt; &lt;/LinearLayout&gt;&lt;/LinearLayout&gt; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667/** * MainActivity.javaä»£ç ï¼ŒSecondActivityçš„ä»£ç ä¸ä¹‹ç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸è´´é‚£ä¹ˆå¤šäº† */public class MainActivity extends Activity &#123; private static final String LOG_TAG = \"MainActivity\"; private Button mButton; @Override public void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Log.w(LOG_TAG, \"==============onCreate()\"); FragmentManager fragmentManager = getFragmentManager(); FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction(); FirstFragment firstFragment = new FirstFragment(); fragmentTransaction.add(R.id.linearlayout, firstFragment); fragmentTransaction.commit(); mButton = (Button) findViewById(R.id.button); mButton.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; Log.w(LOG_TAG, \"------------------mButton onClick-------------------\"); startActivity(new Intent(MainActivity.this, SecondActivity.class)); &#125; &#125;); &#125; @Override protected void onStart() &#123; super.onStart(); Log.w(LOG_TAG, \"==============onStart()\"); &#125; @Override protected void onRestart() &#123; super.onRestart(); Log.w(LOG_TAG, \"==============onRestart()\"); &#125; @Override protected void onResume() &#123; super.onResume(); Log.w(LOG_TAG, \"==============onResume()\"); &#125; @Override protected void onPause() &#123; super.onPause(); Log.w(LOG_TAG, \"==============onPause()\"); &#125; @Override protected void onStop() &#123; super.onStop(); Log.w(LOG_TAG, \"==============onStop()\"); &#125; @Override protected void onDestroy() &#123; super.onDestroy(); Log.w(LOG_TAG, \"==============onDestroy()\"); &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788/** * FirstFragment.javaä»£ç ï¼Œ SecondFragmentå’Œå®ƒå·®ä¸å¤šä¸€æ · */public class FirstFragment extends Fragment &#123; private static final String LOG_TAG = \"FirstFragment\"; private static final String ARG_PARAM1 = \"param1\"; private static final String ARG_PARAM2 = \"param2\"; private String mParam1; private String mParam2; public FirstFragment() &#123; &#125; @Override public void onAttach(Activity activity) &#123; super.onAttach(activity); Log.w(LOG_TAG, \"onAttach...\"); &#125; @Override public void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); Log.w(LOG_TAG, \"onCreate...\"); if (getArguments() != null) &#123; mParam1 = getArguments().getString(ARG_PARAM1); mParam2 = getArguments().getString(ARG_PARAM2); &#125; &#125; @Override public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) &#123; Log.w(LOG_TAG, \"onCreateView...\"); return inflater.inflate(R.layout.fragment_first, container, false); &#125; @Override public void onActivityCreated(Bundle savedInstanceState) &#123; super.onActivityCreated(savedInstanceState); Log.w(LOG_TAG, \"onActivityCreated...\"); &#125; @Override public void onStart() &#123; super.onStart(); Log.w(LOG_TAG, \"onStart...\"); &#125; @Override public void onResume() &#123; super.onResume(); Log.w(LOG_TAG, \"onResume...\"); &#125; @Override public void onPause() &#123; super.onPause(); Log.w(LOG_TAG, \"onPause...\"); &#125; @Override public void onStop() &#123; super.onStop(); Log.w(LOG_TAG, \"onStop...\"); &#125; @Override public void onDestroyView() &#123; super.onDestroyView(); Log.w(LOG_TAG, \"onDestroyView...\"); &#125; @Override public void onDestroy() &#123; super.onDestroy(); Log.w(LOG_TAG, \"onDestroy...\"); &#125; @Override public void onDetach() &#123; super.onDetach(); Log.w(LOG_TAG, \"onDetach...\"); &#125;&#125; å››ã€è¿è¡Œç»“æœ1ã€ç¬¬ä¸€æ¬¡æ‰“å¼€ä»¥åï¼š 123456789com.example.kuguan.anlearning W/MainActivityï¹• ==============onCreate()com.example.kuguan.anlearning W/FirstFragmentï¹• onAttach...com.example.kuguan.anlearning W/FirstFragmentï¹• onCreate...com.example.kuguan.anlearning W/FirstFragmentï¹• onCreateView...com.example.kuguan.anlearning W/FirstFragmentï¹• onActivityCreated...com.example.kuguan.anlearning W/MainActivityï¹• ==============onStart()com.example.kuguan.anlearning W/FirstFragmentï¹• onStart...com.example.kuguan.anlearning W/MainActivityï¹• ==============onResume()com.example.kuguan.anlearning W/FirstFragmentï¹• onResume... 2ã€ç‚¹å‡»MainActivityä¸­çš„æŒ‰é’®â€œæ‰“å¼€ç¬¬äºŒä¸ªActivityâ€ä»¥åï¼š 12345678910111213com.example.kuguan.anlearning W/MainActivityï¹• ----------------mButton onClick-----------------com.example.kuguan.anlearning W/FirstFragmentï¹• onPause...com.example.kuguan.anlearning W/MainActivityï¹• ==============onPause()com.example.kuguan.anlearning W/SecondFragmentï¹• onAttach...com.example.kuguan.anlearning W/SecondFragmentï¹• onCreate...com.example.kuguan.anlearning W/SecondFragmentï¹• onCreateView...com.example.kuguan.anlearning W/SecondFragmentï¹• onActivityCreated...com.example.kuguan.anlearning W/SecondActivityï¹• ==============onStart()com.example.kuguan.anlearning W/SecondFragmentï¹• onStart...com.example.kuguan.anlearning W/SecondActivityï¹• ==============onResume()com.example.kuguan.anlearning W/SecondFragmentï¹• onResume...com.example.kuguan.anlearning W/FirstFragmentï¹• onStop...com.example.kuguan.anlearning W/MainActivityï¹• ==============onStop() 3ã€ç‚¹å‡»SecondActivityçš„æŒ‰é’®â€œfinishâ€ä¹‹åï¼š 1234567891011121314com.example.kuguan.anlearning W/SecondActivityï¹• -----------------mButton onClick------------------com.example.kuguan.anlearning W/SecondFragmentï¹• onPause...com.example.kuguan.anlearning W/SecondActivityï¹• ==============onPause()com.example.kuguan.anlearning W/MainActivityï¹• ==============onRestart()com.example.kuguan.anlearning W/MainActivityï¹• ==============onStart()com.example.kuguan.anlearning W/FirstFragmentï¹• onStart...com.example.kuguan.anlearning W/MainActivityï¹• ==============onResume()com.example.kuguan.anlearning W/FirstFragmentï¹• onResume...com.example.kuguan.anlearning W/SecondFragmentï¹• onStop...com.example.kuguan.anlearning W/SecondActivityï¹• ==============onStop()com.example.kuguan.anlearning W/SecondFragmentï¹• onDestroyView...com.example.kuguan.anlearning W/SecondFragmentï¹• onDestroy...com.example.kuguan.anlearning W/SecondFragmentï¹• onDetach...com.example.kuguan.anlearning W/SecondActivityï¹• ==============onDestroy() 4ã€ç‚¹å‡»backé”®ä½¿MainActivityé€€åˆ°åå°ï¼š 12345678com.example.kuguan.anlearning W/FirstFragmentï¹• onPause...com.example.kuguan.anlearning W/MainActivityï¹• ==============onPause()com.example.kuguan.anlearning W/FirstFragmentï¹• onStop...com.example.kuguan.anlearning W/MainActivityï¹• ==============onStop()com.example.kuguan.anlearning W/FirstFragmentï¹• onDestroyView...com.example.kuguan.anlearning W/FirstFragmentï¹• onDestroy...com.example.kuguan.anlearning W/FirstFragmentï¹• onDetach...com.example.kuguan.anlearning W/MainActivityï¹• ==============onDestroy() 5ã€åœ¨MianActivityæ˜¾ç¤ºçš„æ—¶å€™ï¼ŒæŒ‰HOMEé”®ï¼š 1234com.example.kuguan.anlearning W/FirstFragmentï¹• onPause...com.example.kuguan.anlearning W/MainActivityï¹• ==============onPause()com.example.kuguan.anlearning W/FirstFragmentï¹• onStop...com.example.kuguan.anlearning W/MainActivityï¹• ==============onStop() 6ã€ç„¶åå†ç‚¹å‡»Iconæ‰“å¼€ï¼š 12345com.example.kuguan.anlearning W/MainActivityï¹• ==============onRestart()com.example.kuguan.anlearning W/MainActivityï¹• ==============onStart()com.example.kuguan.anlearning W/FirstFragmentï¹• onStart...com.example.kuguan.anlearning W/MainActivityï¹• ==============onResume()com.example.kuguan.anlearning W/FirstFragmentï¹• onResume... ã€å‚è€ƒèµ„æ–™ã€‘ï¼š1ã€Fragmentå’ŒActivity","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘Fragmentçš„ç”Ÿå‘½å‘¨æœŸè¯¦è§£","slug":"ã€Androidã€‘Fragmentçš„ç”Ÿå‘½å‘¨æœŸè¯¦è§£","date":"2015-11-25T03:43:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/11/25/ã€Androidã€‘Fragmentçš„ç”Ÿå‘½å‘¨æœŸè¯¦è§£/","link":"","permalink":"http://github.com/2015/11/25/ã€Androidã€‘Fragmentçš„ç”Ÿå‘½å‘¨æœŸè¯¦è§£/","excerpt":"ä½œä¸ºAndroidå¼€å‘çš„åŸºç¡€çŸ¥è¯†ï¼Œå¤§å®¶å¯èƒ½éƒ½äº†è§£Activityçš„ç”Ÿå‘½å‘¨æœŸï¼Œä½†æ˜¯Fragmentçš„ç”Ÿå‘½å‘¨æœŸå’ŒActivityç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å…³ç³»åˆ°åº•æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿç›¸äº’è°ƒç”¨æœºåˆ¶åˆå¦‚ä½•å‘¢ï¼Ÿ ä¸€ã€æˆ‘ä»¬é¦–å…ˆè§‚å¯Ÿä¸€ä¸‹Activityçš„ç”Ÿå‘½å‘¨æœŸï¼š","text":"ä½œä¸ºAndroidå¼€å‘çš„åŸºç¡€çŸ¥è¯†ï¼Œå¤§å®¶å¯èƒ½éƒ½äº†è§£Activityçš„ç”Ÿå‘½å‘¨æœŸï¼Œä½†æ˜¯Fragmentçš„ç”Ÿå‘½å‘¨æœŸå’ŒActivityç”Ÿå‘½å‘¨æœŸä¹‹é—´çš„å…³ç³»åˆ°åº•æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿç›¸äº’è°ƒç”¨æœºåˆ¶åˆå¦‚ä½•å‘¢ï¼Ÿ ä¸€ã€æˆ‘ä»¬é¦–å…ˆè§‚å¯Ÿä¸€ä¸‹Activityçš„ç”Ÿå‘½å‘¨æœŸï¼š Fragmentç”Ÿå‘½å‘¨æœŸï¼š Activityå’ŒFragmentç”Ÿå‘½å‘¨æœŸçš„å¯¹æ¯”å›¾ï¼šã€å‚è€ƒèµ„æ–™ã€‘ï¼š1ã€Android Fragmentæºä»£ç 2ã€API Doc for fragments (Fragments | Android Developers)3ã€Fragmentç”Ÿå‘½å‘¨æœŸ","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘é•¿æŒ‰è¿ç»­è§¦å‘äº‹ä»¶çš„å®ç°æ–¹æ³•","slug":"ã€Androidã€‘é•¿æŒ‰è¿ç»­è§¦å‘äº‹ä»¶çš„å®ç°æ–¹æ³•","date":"2015-11-19T06:35:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/11/19/ã€Androidã€‘é•¿æŒ‰è¿ç»­è§¦å‘äº‹ä»¶çš„å®ç°æ–¹æ³•/","link":"","permalink":"http://github.com/2015/11/19/ã€Androidã€‘é•¿æŒ‰è¿ç»­è§¦å‘äº‹ä»¶çš„å®ç°æ–¹æ³•/","excerpt":"é¡¹ç›®ä¸­éœ€è¦å®ç°ä¸€ä¸ªç±»ä¼¼è´­ç‰©è½¦æ•°é‡çš„å°ç»„ä»¶ï¼Œéœ€è¦å•å‡»æ—¶å¢åŠ æ•°é‡ï¼Œé•¿æŒ‰æ—¶å¯ä»¥è¿ç»­å¢å¤§ï¼Œä¹‹å‰çš„ä»£ç å®ç°æ•ˆæœä¸ç†æƒ³ï¼Œgoogleåå¾—åˆ°ä¸€ä¸ªè§£å†³æ–¹æ³•,æµ‹è¯•å¯ä»¥å®Œç¾å®ç°ã€‚ å®ç°æ•ˆæœå¤§è‡´å¦‚å›¾ï¼š ã€åŸç†è¯´æ˜ã€‘ å¤§è‡´åŸç†æ˜¯,å¦‚æœæ‰‹æŒ‡æŒ‰åœ¨viewä¸Šï¼Œåˆ™ä½¿ç”¨ScheduledExecutorServiceå¯¹è±¡æ‰§è¡ŒscheduleWithFixedDelay()æ–¹æ³•ï¼Œæ¯éš”ä¸€ä¸ªé—´éš”ä¸åœåœ°å‘Handlerå‘é€Messageï¼Œæ­¤å¤„Messageé‡Œçš„ä¿¡æ¯æ˜¯View idï¼Œç„¶åç”±Handleråœ¨handlemessageçš„æ—¶å€™å¤„ç†éœ€è¦è§¦å‘çš„äº‹ä»¶ã€‚","text":"é¡¹ç›®ä¸­éœ€è¦å®ç°ä¸€ä¸ªç±»ä¼¼è´­ç‰©è½¦æ•°é‡çš„å°ç»„ä»¶ï¼Œéœ€è¦å•å‡»æ—¶å¢åŠ æ•°é‡ï¼Œé•¿æŒ‰æ—¶å¯ä»¥è¿ç»­å¢å¤§ï¼Œä¹‹å‰çš„ä»£ç å®ç°æ•ˆæœä¸ç†æƒ³ï¼Œgoogleåå¾—åˆ°ä¸€ä¸ªè§£å†³æ–¹æ³•,æµ‹è¯•å¯ä»¥å®Œç¾å®ç°ã€‚ å®ç°æ•ˆæœå¤§è‡´å¦‚å›¾ï¼š ã€åŸç†è¯´æ˜ã€‘ å¤§è‡´åŸç†æ˜¯,å¦‚æœæ‰‹æŒ‡æŒ‰åœ¨viewä¸Šï¼Œåˆ™ä½¿ç”¨ScheduledExecutorServiceå¯¹è±¡æ‰§è¡ŒscheduleWithFixedDelay()æ–¹æ³•ï¼Œæ¯éš”ä¸€ä¸ªé—´éš”ä¸åœåœ°å‘Handlerå‘é€Messageï¼Œæ­¤å¤„Messageé‡Œçš„ä¿¡æ¯æ˜¯View idï¼Œç„¶åç”±Handleråœ¨handlemessageçš„æ—¶å€™å¤„ç†éœ€è¦è§¦å‘çš„äº‹ä»¶ã€‚ ã€å®ç°ã€‘1ã€é¦–å…ˆ,è®©å¯¹åº”çš„Viewè®¾ç½®ä¸€ä¸ªOnTouchListenerï¼Œåœ¨æ‰‹æŒ‡æŒ‰ä¸‹æ—¶è§¦å‘ä¸åœçš„å‘é€æ¶ˆæ¯,æ‰‹æŒ‡æŠ¬èµ·æ—¶åœæ­¢å‘é€ã€‚ 1234567891011subtractButton.setOnTouchListener(new OnTouchListener() &#123; @Override public boolean onTouch(View v, MotionEvent event) &#123; if(event.getAction() == MotionEvent.ACTION_DOWN)&#123; updateAddOrSubtract(v.getId()); //æ‰‹æŒ‡æŒ‰ä¸‹æ—¶è§¦å‘ä¸åœçš„å‘é€æ¶ˆæ¯ &#125;else if(event.getAction() == MotionEvent.ACTION_UP)&#123; stopAddOrSubtract(); //æ‰‹æŒ‡æŠ¬èµ·æ—¶åœæ­¢å‘é€ &#125; return true; &#125; &#125;); 2ã€å‘é€æ¶ˆæ¯ä¸ç»ˆæ­¢æ–¹æ³•ï¼šå…ˆå®šä¹‰ä¸€ä¸ªScheduledExecutorServiceå¯¹è±¡ï¼Œç„¶åè°ƒç”¨scheduleWithFixedDelay()æ–¹æ³• 1234567891011121314151617181920private ScheduledExecutorService scheduledExecutor;private void updateAddOrSubtract(int viewId) &#123; final int vid = viewId; scheduledExecutor = Executors.newSingleThreadScheduledExecutor(); scheduledExecutor.scheduleWithFixedDelay(new Runnable() &#123; @Override public void run() &#123; Message msg = new Message(); msg.what = vid; handler.sendMessage(msg); &#125; &#125;, 0, 100, TimeUnit.MILLISECONDS); //æ¯é—´éš”100mså‘é€Message &#125; private void stopAddOrSubtract() &#123; if (scheduledExecutor != null) &#123; scheduledExecutor.shutdownNow(); scheduledExecutor = null; &#125; &#125; 3ã€ç”¨æ¥å¤„ç†Touchäº‹ä»¶çš„Handlerå®šä¹‰å¦‚ä¸‹ï¼š1234567891011121314private Handler handler = new Handler()&#123; @Override public void handleMessage(Message msg) &#123; int viewId = msg.what; switch (viewId)&#123; case R.id.custom_number_picker_subtract_button: setValue(value - rangeability); //å‡å°æ“ä½œ break; case R.id.custom_number_picker_add_button: setValue(value + rangeability); //å¢å¤§æ“ä½œ break; &#125; &#125; &#125;;","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Javaã€‘HashMap å’Œ HashTable çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ","slug":"ã€Javaã€‘HashMap å’Œ HashTable çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ","date":"2015-11-10T03:55:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/11/10/ã€Javaã€‘HashMap å’Œ HashTable çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ/","link":"","permalink":"http://github.com/2015/11/10/ã€Javaã€‘HashMap å’Œ HashTable çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ/","excerpt":"ç¬¬ä¸€ã€ç»§æ‰¿ä¸åŒç¬¬ä¸€ä¸ªä¸åŒä¸»è¦æ˜¯å†å²åŸå› ã€‚Hashtableæ˜¯åŸºäºé™ˆæ—§çš„Dictionaryç±»çš„ï¼ŒHashMapæ˜¯Java 1.2å¼•è¿›çš„Mapæ¥å£çš„ä¸€ä¸ªå®ç°ã€‚ 12public class HashMap&lt;K, V&gt; extends AbstractMap&lt;K, V&gt; implements Cloneable, Serializable &#123;...&#125;public class Hashtable&lt;K, V&gt; extends Dictionary&lt;K, V&gt; implements Map&lt;K, V&gt;, Cloneable, Serializable &#123;...&#125; è€ŒHashMapç»§æ‰¿çš„æŠ½è±¡ç±»AbstractMapå®ç°äº†Mapæ¥å£ï¼š 1public abstract class AbstractMap&lt;K, V&gt; implements Map&lt;K, V&gt; &#123;...&#125;","text":"ç¬¬ä¸€ã€ç»§æ‰¿ä¸åŒç¬¬ä¸€ä¸ªä¸åŒä¸»è¦æ˜¯å†å²åŸå› ã€‚Hashtableæ˜¯åŸºäºé™ˆæ—§çš„Dictionaryç±»çš„ï¼ŒHashMapæ˜¯Java 1.2å¼•è¿›çš„Mapæ¥å£çš„ä¸€ä¸ªå®ç°ã€‚ 12public class HashMap&lt;K, V&gt; extends AbstractMap&lt;K, V&gt; implements Cloneable, Serializable &#123;...&#125;public class Hashtable&lt;K, V&gt; extends Dictionary&lt;K, V&gt; implements Map&lt;K, V&gt;, Cloneable, Serializable &#123;...&#125; è€ŒHashMapç»§æ‰¿çš„æŠ½è±¡ç±»AbstractMapå®ç°äº†Mapæ¥å£ï¼š 1public abstract class AbstractMap&lt;K, V&gt; implements Map&lt;K, V&gt; &#123;...&#125; ç¬¬äºŒã€çº¿ç¨‹å®‰å…¨ä¸ä¸€æ ·Hashtable ä¸­çš„æ–¹æ³•æ˜¯åŒæ­¥çš„ï¼Œè€ŒHashMapä¸­çš„æ–¹æ³•åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯éåŒæ­¥çš„ã€‚åœ¨å¤šçº¿ç¨‹å¹¶å‘çš„ç¯å¢ƒä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Hashtableï¼Œä½†æ˜¯è¦ä½¿ç”¨HashMapçš„è¯å°±è¦è‡ªå·±å¢åŠ åŒæ­¥å¤„ç†äº†ã€‚ 12345678910111213141516171819202122232425262728293031323334//è¿™æ˜¯Hashtableçš„put()æ–¹æ³•:/** * Associate the specified value with the specified key in this * &#123;@code Hashtable&#125;. If the key already exists, the old value is replaced. * The key and value cannot be null. * * @param key * the key to add. * @param value * the value to add. * @return the old value associated with the specified key, or &#123;@code null&#125; * if the key did not exist. * @see #elements * @see #get * @see #keys * @see java.lang.Object#equals */ public synchronized V put(K key, V value) &#123; if (key == null) &#123; throw new NullPointerException(\"key == null\"); &#125; else if (value == null) &#123; throw new NullPointerException(\"value == null\"); &#125; int hash = Collections.secondaryHash(key); HashtableEntry&lt;K, V&gt;[] tab = table; int index = hash &amp; (tab.length - 1); HashtableEntry&lt;K, V&gt; first = tab[index]; for (HashtableEntry&lt;K, V&gt; e = first; e != null; e = e.next) &#123; if (e.hash == hash &amp;&amp; key.equals(e.key)) &#123; V oldValue = e.value; e.value = value; return oldValue; &#125; &#125; 123456789101112131415161718192021222324252627//è¿™æ˜¯HashMapçš„put()æ–¹æ³•:/** * Maps the specified key to the specified value. * * @param key * the key. * @param value * the value. * @return the value of any previous mapping with the specified key or * &#123;@code null&#125; if there was no such mapping. */ @Override public V put(K key, V value) &#123; if (key == null) &#123; return putValueForNullKey(value); &#125; int hash = Collections.secondaryHash(key); HashMapEntry&lt;K, V&gt;[] tab = table; int index = hash &amp; (tab.length - 1); for (HashMapEntry&lt;K, V&gt; e = tab[index]; e != null; e = e.next) &#123; if (e.hash == hash &amp;&amp; key.equals(e.key)) &#123; preModify(e); V oldValue = e.value; e.value = value; return oldValue; &#125; &#125; ä»ä¸Šé¢çš„æºä»£ç å¯ä»¥çœ‹åˆ°Hashtableçš„put()æ–¹æ³•æ˜¯synchronizedçš„ï¼Œè€ŒHashMapçš„put()æ–¹æ³•å´ä¸æ˜¯ã€‚ ç¬¬ä¸‰ã€å…ä¸å…è®¸nullå€¼ä»ä¸Šé¢çš„put()æ–¹æ³•æºç å¯ä»¥çœ‹åˆ°ï¼ŒHashtableä¸­ï¼Œkeyå’Œvalueéƒ½ä¸å…è®¸å‡ºç°nullå€¼ï¼Œå¦åˆ™ä¼šæŠ›å‡ºNullPointerExceptionå¼‚å¸¸ã€‚è€Œåœ¨HashMapä¸­ï¼Œnullå¯ä»¥ä½œä¸ºé”®ï¼Œè¿™æ ·çš„é”®åªæœ‰ä¸€ä¸ªï¼›å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ‰€å¯¹åº”çš„å€¼ä¸ºnullã€‚å½“get()æ–¹æ³•è¿”å›nullå€¼æ—¶ï¼Œå³å¯ä»¥è¡¨ç¤º HashMapä¸­æ²¡æœ‰è¯¥é”®ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºè¯¥é”®æ‰€å¯¹åº”çš„å€¼ä¸ºnullã€‚å› æ­¤ï¼Œåœ¨HashMapä¸­ä¸èƒ½ç”±get()æ–¹æ³•æ¥åˆ¤æ–­HashMapä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé”®ï¼Œ è€Œåº”è¯¥ç”¨containsKey()æ–¹æ³•æ¥åˆ¤æ–­ã€‚ ç¬¬å››ã€éå†æ–¹å¼çš„å†…éƒ¨å®ç°ä¸Šä¸åŒHashtableã€HashMapéƒ½ä½¿ç”¨äº† Iteratorã€‚è€Œç”±äºå†å²åŸå› ï¼ŒHashtableè¿˜ä½¿ç”¨äº†Enumerationçš„æ–¹å¼ ã€‚ ç¬¬äº”ã€å“ˆå¸Œå€¼çš„ä½¿ç”¨ä¸åŒHashTableç›´æ¥ä½¿ç”¨å¯¹è±¡çš„hashCodeã€‚è€ŒHashMapé‡æ–°è®¡ç®—hashå€¼ã€‚ ç¬¬å…­ã€å†…éƒ¨å®ç°æ–¹å¼çš„æ•°ç»„çš„åˆå§‹å¤§å°å’Œæ‰©å®¹çš„æ–¹å¼ä¸ä¸€æ ·HashTableä¸­çš„hashæ•°ç»„åˆå§‹å¤§å°æ˜¯11ï¼Œå¢åŠ çš„æ–¹å¼æ˜¯ old*2+1ã€‚HashMapä¸­hashæ•°ç»„çš„é»˜è®¤å¤§å°æ˜¯16ï¼Œè€Œä¸”ä¸€å®šæ˜¯2çš„æŒ‡æ•°ã€‚ ã€æ€»ç»“ã€‘ï¼š HashMap çº¿ç¨‹ä¸å®‰å…¨ å…è®¸æœ‰nullçš„é”®å’Œå€¼ æ•ˆç‡é«˜ä¸€ç‚¹ã€ æ–¹æ³•ä¸æ˜¯Synchronizeçš„è¦æä¾›å¤–åŒæ­¥ æœ‰containsvalueå’ŒcontainsKeyæ–¹æ³• HashMap æ˜¯Java1.2 å¼•è¿›çš„Map interface çš„ä¸€ä¸ªå®ç° HashMapæ˜¯Hashtableçš„è½»é‡çº§å®ç° Hashtable çº¿ç¨‹å®‰å…¨ ä¸å…è®¸æœ‰nullçš„é”®å’Œå€¼ æ•ˆç‡ç¨ä½ã€ æ–¹æ³•æ˜¯æ˜¯Synchronizeçš„ æœ‰containsæ–¹æ³•æ–¹æ³• Hashtable ç»§æ‰¿äºDictionary ç±» Hashtable æ¯”HashMap è¦æ—§ ã€å»ºè®®ã€‘ï¼š ä¸€äº›èµ„æ–™å»ºè®®ï¼Œå½“éœ€è¦åŒæ­¥æ—¶ï¼Œç”¨Hashtableï¼Œåä¹‹ç”¨HashMapã€‚ä½†æ˜¯ï¼Œå› ä¸ºåœ¨éœ€è¦æ—¶ï¼ŒHashMapå¯ä»¥è¢«åŒæ­¥ï¼ŒHashMapçš„åŠŸèƒ½æ¯”Hashtableçš„åŠŸèƒ½æ›´å¤šï¼Œè€Œä¸”å®ƒä¸æ˜¯åŸºäºä¸€ä¸ªé™ˆæ—§çš„ç±»çš„ï¼Œæ‰€ä»¥æœ‰äººè®¤ä¸ºï¼Œåœ¨å„ç§æƒ…å†µä¸‹ï¼ŒHashMapéƒ½ä¼˜å…ˆäºHashtableã€‚ ã€å‚è€ƒèµ„æ–™ã€‘ï¼š 1ã€Hashtableã€HashMapæºä»£ç  2ã€Javaçš„HashMapå’ŒHashTable 3ã€HashMapä¸HashTableçš„åŒºåˆ«","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"å„ç§æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦è¡¨","slug":"å„ç§æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦è¡¨","date":"2015-11-03T03:55:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/11/03/å„ç§æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦è¡¨/","link":"","permalink":"http://github.com/2015/11/03/å„ç§æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦è¡¨/","excerpt":"å„ç§æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦è¡¨: æ¯”è¾ƒæ—¶é—´å¤æ‚åº¦å‡½æ•°çš„æƒ…å†µå¦‚ä¸‹å›¾ï¼š å¯¹nè¾ƒå¤§çš„æ’åºè®°å½•ã€‚ä¸€èˆ¬çš„é€‰æ‹©éƒ½æ˜¯æ—¶é—´å¤æ‚åº¦ä¸ºO(nlog2n)çš„æ’åºæ–¹æ³•ï¼š æ¥ä¸‹æ¥åšä¸»æŠ½æ—¶é—´è¦æ•´ç†ä¸€ä¸‹å„ç»å…¸ç®—æ³•æ€æƒ³å’Œå¿ƒå¾—ï¼Œæ•¬è¯·æœŸå¾…","text":"å„ç§æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦è¡¨: æ¯”è¾ƒæ—¶é—´å¤æ‚åº¦å‡½æ•°çš„æƒ…å†µå¦‚ä¸‹å›¾ï¼š å¯¹nè¾ƒå¤§çš„æ’åºè®°å½•ã€‚ä¸€èˆ¬çš„é€‰æ‹©éƒ½æ˜¯æ—¶é—´å¤æ‚åº¦ä¸ºO(nlog2n)çš„æ’åºæ–¹æ³•ï¼š æ¥ä¸‹æ¥åšä¸»æŠ½æ—¶é—´è¦æ•´ç†ä¸€ä¸‹å„ç»å…¸ç®—æ³•æ€æƒ³å’Œå¿ƒå¾—ï¼Œæ•¬è¯·æœŸå¾… ä¸€ã€å¿«é€Ÿæ’åºï¼ˆQuicksortï¼‰12345678910111213141516171819202122232425262728293031323334353637383940import java.util.Arrays;public class MySort &#123; public static void main(String args[])&#123; int[] array = &#123;5,3,9,1,6,4,10,2,8,7&#125;; System.out.println(\"Before: \" + Arrays.toString(array)); new MySort().quickSort(array, 0, array.length-1); System.out.println(\"After: \" + Arrays.toString(array)); &#125; /** * å¿«é€Ÿæ’åºï¼š é€’å½’å®ç°çš„æŒ–å‘å¡«æ•°æ³• * @param array * @param left * @param right */ private void quickSort(int[] array, int left, int right)&#123; if(left &gt;= right)&#123; return; &#125; int i = left; int j = right; int key = array[left]; while(i&lt;j)&#123; while(array[j] &gt;= key &amp;&amp; i&lt;j)&#123; //ä»åå‘å‰æœç´¢ï¼Œæ¯”keyå°çš„å€¼å°±æŒ–å‡ºæ¥å¡«åˆ°iå¤„çš„å‘ j--; &#125; array[i] = array[j]; while(array[i] &lt;= key &amp;&amp; i&lt;j)&#123; //ä»å‰å‘åæœç´¢ï¼Œæ‰¾å‡ºæ¯”keyå¤§çš„å€¼å¡«åˆ°åˆšæ‰jå¤„ç©ºç¼ºçš„å‘ i++; &#125; array[j] = array[i]; &#125; array[i] = key; //æŠŠkeyå›å¡«åˆ°æ•°ç»„çš„ç©ºç¼ºå¤„ System.out.println(\"Sort: \" + Arrays.toString(array)); quickSort(array, left, i-1); quickSort(array, i+1, right); &#125;&#125; 1234567891011å¿«é€Ÿæ’åºçš„æµ‹è¯•ä»£ç è¾“å‡ºç»“æœå¦‚ä¸‹ï¼šBefore: [5, 3, 9, 1, 6, 4, 10, 2, 8, 7]Sort: [2, 3, 4, 1, 5, 6, 10, 9, 8, 7]Sort: [1, 2, 4, 3, 5, 6, 10, 9, 8, 7]Sort: [1, 2, 3, 4, 5, 6, 10, 9, 8, 7]Sort: [1, 2, 3, 4, 5, 6, 10, 9, 8, 7]Sort: [1, 2, 3, 4, 5, 6, 7, 9, 8, 10]Sort: [1, 2, 3, 4, 5, 6, 7, 9, 8, 10]Sort: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]After: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] ã€å‚è€ƒèµ„æ–™ã€‘ï¼š ç™½è¯ç»å…¸ç®—æ³•ç³»åˆ—ä¹‹å…­ å¿«é€Ÿæ’åº å¿«é€Ÿæå®š å¿…é¡»çŸ¥é“çš„å…«å¤§ç§æ’åºç®—æ³•ã€javaå®ç°ã€‘","categories":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/tags/Algorithm/"}],"keywords":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://github.com/categories/Algorithm/"}]},{"title":"ã€Javaã€‘å‡½æ•°ä¸­çš„å‚æ•°ä¼ é€’æ˜¯â€œå¼•ç”¨ä¼ é€’â€è¿˜æ˜¯â€œå€¼ä¼ é€’â€ï¼Ÿ","slug":"ã€Javaã€‘å‡½æ•°ä¸­çš„å‚æ•°ä¼ é€’æ˜¯â€œå¼•ç”¨ä¼ é€’â€è¿˜æ˜¯â€œå€¼ä¼ é€’â€ï¼Ÿ","date":"2015-11-02T07:33:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/11/02/ã€Javaã€‘å‡½æ•°ä¸­çš„å‚æ•°ä¼ é€’æ˜¯â€œå¼•ç”¨ä¼ é€’â€è¿˜æ˜¯â€œå€¼ä¼ é€’â€ï¼Ÿ/","link":"","permalink":"http://github.com/2015/11/02/ã€Javaã€‘å‡½æ•°ä¸­çš„å‚æ•°ä¼ é€’æ˜¯â€œå¼•ç”¨ä¼ é€’â€è¿˜æ˜¯â€œå€¼ä¼ é€’â€ï¼Ÿ/","excerpt":"é—®é¢˜å¼•å…¥ï¼šåœ¨ä¸€ä¸ªå¿«é€Ÿæ’åºçš„å‡½æ•° private void quickSort(List intList, int left, int right) ä¸­ï¼Œä¼ è¿›å»çš„å‚æ•°intListæ˜¯å¯¹è±¡ä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’å‘¢ï¼Ÿ å…ˆæŠ›å‡ºç»“è®ºï¼š å°†å¯¹è±¡ï¼ˆå¯¹è±¡çš„å¼•ç”¨ï¼‰ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ä¼ é€’çš„æ˜¯å¼•ç”¨(ç›¸å½“äºæŒ‡é’ˆ)ã€‚ä¹Ÿå°±æ˜¯è¯´å‡½æ•°å†…å¯¹å‚æ•°æ‰€åšçš„ä¿®æ”¹ä¼šå½±å“åŸæ¥çš„å¯¹è±¡ã€‚ å½“å°†åŸºæœ¬ç±»å‹æˆ–åŸºæœ¬ç±»å‹çš„åŒ…è£…é›†ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ï¼Œä¼ é€’çš„æ˜¯å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´å‡½æ•°å†…å¯¹å‚æ•°æ‰€åšçš„ä¿®æ”¹ä¸ä¼šå½±å“åŸæ¥çš„å˜é‡ã€‚ æ•°ç»„(æ•°ç»„å¼•ç”¨)ï¼‰ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ä¼ é€’çš„æ˜¯å¼•ç”¨(ç›¸å½“äºæŒ‡é’ˆ)ã€‚ä¹Ÿå°±æ˜¯è¯´å‡½æ•°å†…å¯¹å‚æ•°æ‰€åšçš„ä¿®æ”¹ä¼šå½±å“åŸæ¥çš„æ•°ç»„ã€‚ Stringç±»å‹(å¼•ç”¨)ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ä¼ é€’çš„æ˜¯å¼•ç”¨ï¼Œåªæ˜¯å¯¹Stringåšå‡ºä»»ä½•ä¿®æ”¹æ—¶æœ‰ä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ä¼šäº§ç”Ÿï¼ŒåŸæ¥çš„Stringå¯¹è±¡çš„å€¼ä¸ä¼šåšä»»ä½•ä¿®æ”¹ã€‚(ä½†æ˜¯å¯ä»¥å°†æ–°çš„å¯¹è±¡çš„ å¼•ç”¨èµ‹ç»™åŸæ¥çš„å¼•ç”¨,è¿™æ ·ç»™äººçš„è¡¨é¢ç°è±¡å°±æ˜¯åŸæ¥çš„å¯¹è±¡å˜äº†ï¼Œå…¶å®æ²¡æœ‰å˜ï¼Œåªæ˜¯åŸæ¥æŒ‡å‘å®ƒçš„å¼•ç”¨æŒ‡å‘äº†æ–°çš„å¯¹è±¡)ã€‚","text":"é—®é¢˜å¼•å…¥ï¼šåœ¨ä¸€ä¸ªå¿«é€Ÿæ’åºçš„å‡½æ•° private void quickSort(List intList, int left, int right) ä¸­ï¼Œä¼ è¿›å»çš„å‚æ•°intListæ˜¯å¯¹è±¡ä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’å‘¢ï¼Ÿ å…ˆæŠ›å‡ºç»“è®ºï¼š å°†å¯¹è±¡ï¼ˆå¯¹è±¡çš„å¼•ç”¨ï¼‰ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ä¼ é€’çš„æ˜¯å¼•ç”¨(ç›¸å½“äºæŒ‡é’ˆ)ã€‚ä¹Ÿå°±æ˜¯è¯´å‡½æ•°å†…å¯¹å‚æ•°æ‰€åšçš„ä¿®æ”¹ä¼šå½±å“åŸæ¥çš„å¯¹è±¡ã€‚ å½“å°†åŸºæœ¬ç±»å‹æˆ–åŸºæœ¬ç±»å‹çš„åŒ…è£…é›†ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ï¼Œä¼ é€’çš„æ˜¯å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´å‡½æ•°å†…å¯¹å‚æ•°æ‰€åšçš„ä¿®æ”¹ä¸ä¼šå½±å“åŸæ¥çš„å˜é‡ã€‚ æ•°ç»„(æ•°ç»„å¼•ç”¨)ï¼‰ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ä¼ é€’çš„æ˜¯å¼•ç”¨(ç›¸å½“äºæŒ‡é’ˆ)ã€‚ä¹Ÿå°±æ˜¯è¯´å‡½æ•°å†…å¯¹å‚æ•°æ‰€åšçš„ä¿®æ”¹ä¼šå½±å“åŸæ¥çš„æ•°ç»„ã€‚ Stringç±»å‹(å¼•ç”¨)ä½œä¸ºå‚æ•°ä¼ é€’æ—¶ä¼ é€’çš„æ˜¯å¼•ç”¨ï¼Œåªæ˜¯å¯¹Stringåšå‡ºä»»ä½•ä¿®æ”¹æ—¶æœ‰ä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ä¼šäº§ç”Ÿï¼ŒåŸæ¥çš„Stringå¯¹è±¡çš„å€¼ä¸ä¼šåšä»»ä½•ä¿®æ”¹ã€‚(ä½†æ˜¯å¯ä»¥å°†æ–°çš„å¯¹è±¡çš„ å¼•ç”¨èµ‹ç»™åŸæ¥çš„å¼•ç”¨,è¿™æ ·ç»™äººçš„è¡¨é¢ç°è±¡å°±æ˜¯åŸæ¥çš„å¯¹è±¡å˜äº†ï¼Œå…¶å®æ²¡æœ‰å˜ï¼Œåªæ˜¯åŸæ¥æŒ‡å‘å®ƒçš„å¼•ç”¨æŒ‡å‘äº†æ–°çš„å¯¹è±¡)ã€‚ ä¸¾ä¾‹ä¸€ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142public class Mainjava &#123; String str=new String(&quot;good&quot;); char[] ch=&#123;&apos;a&apos;,&apos;b&apos;,&apos;c&apos;&#125;; Integer i = 0; int x = 0; Test t1 = new Test(); Test t2 = new Test(); public static void main(String args[])&#123; Mainjava ex=new Mainjava(); ex.change(ex.str,ex.ch, ex.x, ex.i, ex.t1, ex.t2); System.out.print(ex.str + &quot; and &quot;); System.out.print(String.valueOf(ex.ch) + &quot; and &quot;); System.out.print(ex.x + &quot;,&quot; + ex.i + &quot;,&quot; + ex.t1.getA() + &quot;,&quot; + ex.t2.getA()); &#125; public void change(String str, char ch[], int x, Integer i, Test t1, Test t2)&#123; str=&quot;test ok&quot;; ch[0]=&apos;g&apos;; x = 2; i = 5; Test newT = new Test(); newT.setA(99); t1 = newT; t2.setA(33); &#125;&#125;//Testç±»public class Test &#123; private int a = 0; public void setA(int a)&#123; this.a = a; &#125; public int getA()&#123; return a; &#125;&#125; è¾“å‡ºç»“æœæ˜¯å¤šå°‘å‘¢ï¼Ÿ good and gbc and 0,0,0,33 ä¸ºä»€ä¹ˆä¸æ˜¯â€test ok and gbc and 2,5,99,33â€å‘¢ï¼Ÿ å› ä¸ºstræ˜¯å¼•ç”¨æ•°æ®ç±»å‹String,è€Œå­—ç¬¦æ•°ç»„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹,äºŒè€…å­˜æ”¾åœ¨å†…å­˜ä¸­çš„æœºåˆ¶æ˜¯ä¸ä¸€æ ·çš„!12345public void change(String str, char ch[], int x)&#123; str = &quot;test ok&quot;; ch[0] = &apos;g&apos;; x = 2;&#125; change()æ–¹æ³•ä¼ å…¥str,è™½ç„¶æŠŠâ€test okâ€å¼ºè¡Œèµ‹ç»™str,ä½†æ˜¯è¿™é‡Œçš„strå­˜æ”¾åœ¨æ–°çš„æ ˆå†…å­˜ä¸­,å’ŒåŸæ¥çš„strå­˜æ”¾çš„åœ°å€ä¸ä¸€æ ·,æ‰€ä»¥ä½ System.out.print(ex.str+â€andâ€);è¿™é‡Œçš„è¾“å‡ºè¿˜æ˜¯è°ƒç”¨åŸæ¥å†…å­˜ä¸­çš„str;å­—ç¬¦æ•°ç»„ä¸ä¸€æ ·,ä½ å£°æ˜ä¸€ä¸ªå­—ç¬¦æ•°ç»„ä¹‹å,é‚£ä¸ªæ•°ç»„çš„ä½ç½®å°±å®šæ­»äº†,ä½ è°ƒç”¨change()ä¹‹å,æŠŠåŸæ¥çš„å­—ç¬¦æ•°ç»„çš„ç¬¬1ä¸ªå…ƒç´ æ”¹ä¸ºäº†g.è¿™å°±æ˜¯å¼•ç”¨æ•°æ®ç±»å‹å’ŒåŸºæœ¬æ•°æ®ç±»å‹çš„åŒºåˆ«ã€‚ ä¸¾ä¾‹äºŒï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455import java.util.ArrayList;import java.util.List;public class Mainjava &#123; public static void main(String args[])&#123; List&lt;Integer&gt; integerList = new ArrayList&lt;Integer&gt;(); integerList.add(7); integerList.add(1); integerList.add(3); integerList.add(8); integerList.add(9); integerList.add(2); integerList.add(5); integerList.add(4); integerList.add(10); integerList.add(6); print(integerList); quickSort(integerList, 0, integerList.size()-1); print(integerList); /*å¯¹æ¯”æ’åºå‰åçš„integerListä¸­çš„å€¼ï¼Œå¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œè¯´æ˜æ˜¯å¼•ç”¨ä¼ é€’ï¼Œå³ä¼ é€’çš„æ˜¯å¯¹è±¡åœ°å€å€¼*/ &#125; private static void quickSort(List&lt;Integer&gt; intList, int left, int right)&#123; if(left &gt;= right) &#123; return; &#125; int i = left; int j = right; int key = intList.get(i); System.out.println(&quot;key:&quot;+&quot;intList.get(&quot;+i+&quot;)=&quot;+key); while(i &lt; j)&#123; while(i &lt; j &amp;&amp; intList.get(j) &gt;= key)&#123; j--; &#125; intList.set(i, intList.get(j)); while(i &lt; j &amp;&amp; intList.get(i) &lt;= key)&#123; i++; &#125; intList.set(j, intList.get(i)); &#125; intList.set(i, key); quickSort(intList, left, i - 1); quickSort(intList, i + 1, right); &#125; private static void print(List&lt;Integer&gt; intList)&#123; for (int i = 0; i &lt; intList.size(); i++) &#123; System.out.print(intList.get(i)+&quot;, &quot;); &#125; System.out.println(&quot;&quot;); &#125;&#125; è¿è¡Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 7, 1, 3, 8, 9, 2, 5, 4, 10, 6,key:intList.get(0)=7key:intList.get(0)=6key:intList.get(0)=2key:intList.get(2)=3key:intList.get(3)=4key:intList.get(7)=91, 2, 3, 4, 5, 6, 7, 8, 9, 10, ç»“è®ºï¼š å®éªŒè¯æ˜ï¼ŒJavaä¸­å‡½æ•°ä¼ é€’å¯¹è±¡æ—¶ï¼Œä¼ é€’çš„æ˜¯è¯¥å¯¹è±¡çš„åœ°å€å€¼ï¼Œå³å¼•ç”¨ä¼ é€’ã€‚å‡½æ•°ä¼ é€’åŸºæœ¬ç±»å‹æ•°æ®æ—¶ï¼Œä¼ é€’çš„æ˜¯å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´å‡½æ•°è¿”å›ä¹‹åä¸ä¼šæ”¹å˜è¿™ä¸ªå€¼ã€‚","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]},{"title":"ã€Androidã€‘Activityå››ç§å¯åŠ¨æ¨¡å¼","slug":"ã€Androidã€‘Activityå››ç§å¯åŠ¨æ¨¡å¼","date":"2015-10-09T12:03:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/10/09/ã€Androidã€‘Activityå››ç§å¯åŠ¨æ¨¡å¼/","link":"","permalink":"http://github.com/2015/10/09/ã€Androidã€‘Activityå››ç§å¯åŠ¨æ¨¡å¼/","excerpt":"Taskæ ˆæ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ªä»»åŠ¡æ ˆï¼Œæ˜¯ç”¨æ¥å­˜æ”¾Activityçš„ï¼ŒåŠŸèƒ½ç±»ä¼¼äºå‡½æ•°è°ƒç”¨çš„æ ˆï¼Œå…ˆåé¡ºåºä»£è¡¨äº†Activityçš„å‡ºç°é¡ºåºï¼›æ¯”å¦‚Activity1â€“&gt;Activity2â€“&gt;Activity3ï¼Œåˆ™ä»»åŠ¡æ ˆä¸ºï¼š å››ç§å¯åŠ¨æ¨¡å¼å¯åŠ¨æ¨¡å¼ç®€å•åœ°è¯´å°±æ˜¯Activityå¯åŠ¨æ—¶çš„ç­–ç•¥ï¼Œåœ¨AndroidManifest.xmlä¸­çš„æ ‡ç­¾çš„android:launchModeå±æ€§è®¾ç½®ï¼› å¯åŠ¨æ¨¡å¼æœ‰4ç§ï¼Œåˆ†åˆ«ä¸ºstandardã€singleTopã€singleTaskã€singleInstanceï¼›","text":"Taskæ ˆæ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ªä»»åŠ¡æ ˆï¼Œæ˜¯ç”¨æ¥å­˜æ”¾Activityçš„ï¼ŒåŠŸèƒ½ç±»ä¼¼äºå‡½æ•°è°ƒç”¨çš„æ ˆï¼Œå…ˆåé¡ºåºä»£è¡¨äº†Activityçš„å‡ºç°é¡ºåºï¼›æ¯”å¦‚Activity1â€“&gt;Activity2â€“&gt;Activity3ï¼Œåˆ™ä»»åŠ¡æ ˆä¸ºï¼š å››ç§å¯åŠ¨æ¨¡å¼å¯åŠ¨æ¨¡å¼ç®€å•åœ°è¯´å°±æ˜¯Activityå¯åŠ¨æ—¶çš„ç­–ç•¥ï¼Œåœ¨AndroidManifest.xmlä¸­çš„æ ‡ç­¾çš„android:launchModeå±æ€§è®¾ç½®ï¼› å¯åŠ¨æ¨¡å¼æœ‰4ç§ï¼Œåˆ†åˆ«ä¸ºstandardã€singleTopã€singleTaskã€singleInstanceï¼› 1ã€standardæ¯æ¬¡æ¿€æ´»Activityæ—¶(startActivity)ï¼Œéƒ½åˆ›å»ºActivityå®ä¾‹ï¼Œå¹¶æ”¾å…¥ä»»åŠ¡æ ˆï¼› 2ã€singleTopï¼ˆæ ˆé¡¶å¤ç”¨æ¨¡å¼ï¼‰å¦‚æœæŸä¸ªActivityè‡ªå·±æ¿€æ´»è‡ªå·±ï¼Œå³ä»»åŠ¡æ ˆæ ˆé¡¶å°±æ˜¯è¯¥Activityï¼Œåˆ™ä¸éœ€è¦åˆ›å»ºï¼Œå…¶ä½™æƒ…å†µéƒ½è¦åˆ›å»ºActivityå®ä¾‹ï¼› singleTopæ¨¡å¼åˆ†3ç§æƒ…å†µï¼š å½“å‰æ ˆä¸­å·²æœ‰è¯¥Activityçš„å®ä¾‹å¹¶ä¸”è¯¥å®ä¾‹ä½äºæ ˆé¡¶æ—¶ï¼Œä¸ä¼šæ–°å»ºå®ä¾‹ï¼Œè€Œæ˜¯å¤ç”¨æ ˆé¡¶çš„å®ä¾‹ï¼Œå¹¶ä¸”ä¼šå°†Intentå¯¹è±¡ä¼ å…¥ï¼Œå›è°ƒonNewIntentæ–¹æ³•ã€‚ å½“å‰æ ˆä¸­å·²æœ‰è¯¥Activityçš„å®ä¾‹ä½†æ˜¯è¯¥å®ä¾‹ä¸åœ¨æ ˆé¡¶æ—¶ï¼Œå…¶è¡Œä¸ºå’Œstandardå¯åŠ¨æ¨¡å¼ä¸€æ ·ï¼Œä¾ç„¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ å½“å‰æ ˆä¸­ä¸å­˜åœ¨è¯¥Activityçš„å®ä¾‹æ—¶ï¼Œå…¶è¡Œä¸ºåŒstandardå¯åŠ¨æ¨¡å¼ã€‚ 3ã€singleTaskï¼ˆæ ˆå†…å¤ç”¨æ¨¡å¼ï¼‰å¦‚æœè¦æ¿€æ´»çš„é‚£ä¸ªActivityåœ¨ä»»åŠ¡æ ˆä¸­å­˜åœ¨è¯¥å®ä¾‹ï¼Œåˆ™ä¸éœ€è¦åˆ›å»ºï¼Œåªéœ€è¦æŠŠæ­¤Activityæ”¾å…¥æ ˆé¡¶ï¼Œå¹¶æŠŠè¯¥Activityä»¥ä¸Šçš„Activityå®ä¾‹éƒ½pop singleTaskå¯åŠ¨æ¨¡å¼å¯åŠ¨Activityæ—¶ï¼Œé¦–å…ˆä¼šæ ¹æ®taskAffinityå»å¯»æ‰¾å½“å‰æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå¯¹åº”åå­—çš„ä»»åŠ¡æ ˆ å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Taskï¼Œå¹¶åˆ›å»ºæ–°çš„Activityå®ä¾‹å…¥æ ˆåˆ°æ–°åˆ›å»ºçš„Taskä¸­å» å¦‚æœå­˜åœ¨ï¼Œåˆ™å¾—åˆ°è¯¥ä»»åŠ¡æ ˆï¼ŒæŸ¥æ‰¾è¯¥ä»»åŠ¡æ ˆä¸­æ˜¯å¦å­˜åœ¨è¯¥Activityå®ä¾‹ å¦‚æœå­˜åœ¨å®ä¾‹ï¼Œåˆ™å°†å®ƒä¸Šé¢çš„Activityå®ä¾‹éƒ½å‡ºæ ˆï¼Œç„¶åå›è°ƒå¯åŠ¨çš„Activityå®ä¾‹çš„onNewIntentæ–¹æ³• å¦‚æœä¸å­˜åœ¨è¯¥å®ä¾‹ï¼Œåˆ™æ–°å»ºActivityï¼Œå¹¶å…¥æ ˆ 4ã€singleInstanceï¼ˆå…¨å±€å”¯ä¸€æ¨¡å¼ï¼‰å¦‚æœåº”ç”¨1çš„ä»»åŠ¡æ ˆä¸­åˆ›å»ºäº†MainActivityå®ä¾‹ï¼Œå¦‚æœåº”ç”¨2ä¹Ÿè¦æ¿€æ´»MainActivityï¼Œåˆ™ä¸éœ€è¦åˆ›å»ºï¼Œä¸¤åº”ç”¨å…±äº«è¯¥Activityå®ä¾‹ï¼› è¯¥æ¨¡å¼å…·å¤‡singleTaskæ¨¡å¼çš„æ‰€æœ‰ç‰¹æ€§å¤–ï¼Œä¸å®ƒçš„åŒºåˆ«å°±æ˜¯ï¼Œè¿™ç§æ¨¡å¼ä¸‹çš„Activityä¼šå•ç‹¬å ç”¨ä¸€ä¸ªTaskæ ˆï¼Œå…·æœ‰å…¨å±€å”¯ä¸€æ€§ï¼Œå³æ•´ä¸ªç³»ç»Ÿä¸­å°±è¿™ä¹ˆä¸€ä¸ªå®ä¾‹ã€‚ä»¥singleInstanceæ¨¡å¼å¯åŠ¨çš„Activityåœ¨æ•´ä¸ªç³»ç»Ÿä¸­æ˜¯å•ä¾‹çš„ï¼Œå¦‚æœåœ¨å¯åŠ¨è¿™æ ·çš„Activiytæ—¶ï¼Œå·²ç»å­˜åœ¨äº†ä¸€ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆä¼šæŠŠå®ƒæ‰€åœ¨çš„ä»»åŠ¡è°ƒåº¦åˆ°å‰å°ï¼Œé‡ç”¨è¿™ä¸ªå®ä¾‹ã€‚ æ ¹æ®ä¸Šé¢çš„è®²è§£ï¼Œå¹¶ä¸”å‚è€ƒè°·æ­Œå®˜æ–¹æ–‡æ¡£ï¼ŒsingleInstanceçš„ç‰¹ç‚¹å¯ä»¥å½’ç»“ä¸ºä»¥ä¸‹ä¸‰æ¡ï¼š ä»¥singleInstanceæ¨¡å¼å¯åŠ¨çš„Activityå…·æœ‰å…¨å±€å”¯ä¸€æ€§ï¼Œå³æ•´ä¸ªç³»ç»Ÿä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªè¿™æ ·çš„å®ä¾‹ ä»¥singleInstanceæ¨¡å¼å¯åŠ¨çš„Activityå…·æœ‰ç‹¬å æ€§ï¼Œå³å®ƒä¼šç‹¬è‡ªå ç”¨ä¸€ä¸ªä»»åŠ¡ï¼Œè¢«ä»–å¼€å¯çš„ä»»ä½•activityéƒ½ä¼šè¿è¡Œåœ¨å…¶ä»–ä»»åŠ¡ä¸­ï¼ˆå®˜æ–¹æ–‡æ¡£ä¸Šçš„æè¿°ä¸ºï¼ŒsingleInstanceæ¨¡å¼çš„Activityä¸å…è®¸å…¶ä»–Activityå’Œå®ƒå…±å­˜åœ¨ä¸€ä¸ªä»»åŠ¡ä¸­ï¼‰ è¢«singleInstanceæ¨¡å¼çš„Activityå¼€å¯çš„å…¶ä»–activityï¼Œèƒ½å¤Ÿå¼€å¯ä¸€ä¸ªæ–°ä»»åŠ¡ï¼Œä½†ä¸ä¸€å®šå¼€å¯æ–°çš„ä»»åŠ¡ï¼Œä¹Ÿå¯èƒ½åœ¨å·²æœ‰çš„ä¸€ä¸ªä»»åŠ¡ä¸­å¼€å¯ å‚è€ƒèµ„æ–™ Androidå…¥é—¨ï¼šActivityå››ç§å¯åŠ¨æ¨¡å¼ Androidâ€“Activityçš„å¯åŠ¨æ¨¡å¼ åŸºç¡€æ€»ç»“ç¯‡ä¹‹äºŒï¼šActivityçš„å››ç§launchMode Androidä¸­Activityå››ç§å¯åŠ¨æ¨¡å¼å’ŒtaskAffinityå±æ€§è¯¦è§£ å½»åº•å¼„æ‡‚Activityå››å¤§å¯åŠ¨æ¨¡å¼ Activityå››ç§å¯åŠ¨æ¨¡å¼","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘onActivityResult()å’ŒonResume()çš„è°ƒç”¨é¡ºåºé—®é¢˜","slug":"ã€Androidã€‘onActivityResult()å’ŒonResume()çš„è°ƒç”¨é¡ºåºé—®é¢˜","date":"2015-09-18T09:16:55.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/09/18/ã€Androidã€‘onActivityResult()å’ŒonResume()çš„è°ƒç”¨é¡ºåºé—®é¢˜/","link":"","permalink":"http://github.com/2015/09/18/ã€Androidã€‘onActivityResult()å’ŒonResume()çš„è°ƒç”¨é¡ºåºé—®é¢˜/","excerpt":"åœ¨Androidç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå¦‚æœä½¿ç”¨åˆ°startActivityForResult()ï¼Œåˆ™åœ¨æ–°Activityè¢«finishæ‰ä¹‹åï¼ŒonActivityResult()å’ŒonResume()åˆ°åº•æ˜¯å“ªä¸€ä¸ªå…ˆè°ƒç”¨çš„å‘¢ï¼Ÿ æˆ‘ä»¬æ¥çœ‹å®˜æ–¹æºç ï¼š 12345678910111213141516171819202122232425262728/** * Called when an activity you launched exits, giving you the requestCode * you started it with, the resultCode it returned, and any additional * data from it. The &lt;var&gt;resultCode&lt;/var&gt; will be * &#123;@link #RESULT_CANCELED&#125; if the activity explicitly returned that, * didn't return any result, or crashed during its operation. * * &lt;p&gt;You will receive this call immediately before onResume() when your * activity is re-starting. * * &lt;p&gt;This method is never invoked if your activity sets * &#123;@link android.R.styleable#AndroidManifestActivity_noHistory noHistory&#125; to * &lt;code&gt;true&lt;/code&gt;. * * @param requestCode The integer request code originally supplied to * startActivityForResult(), allowing you to identify who this * result came from. * @param resultCode The integer result code returned by the child activity * through its setResult(). * @param data An Intent, which can return result data to the caller * (various data can be attached to Intent \"extras\"). * * @see #startActivityForResult * @see #createPendingResult * @see #setResult(int) */protected void onActivityResult(int requestCode, int resultCode, Intent data) &#123;&#125;","text":"åœ¨Androidç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå¦‚æœä½¿ç”¨åˆ°startActivityForResult()ï¼Œåˆ™åœ¨æ–°Activityè¢«finishæ‰ä¹‹åï¼ŒonActivityResult()å’ŒonResume()åˆ°åº•æ˜¯å“ªä¸€ä¸ªå…ˆè°ƒç”¨çš„å‘¢ï¼Ÿ æˆ‘ä»¬æ¥çœ‹å®˜æ–¹æºç ï¼š 12345678910111213141516171819202122232425262728/** * Called when an activity you launched exits, giving you the requestCode * you started it with, the resultCode it returned, and any additional * data from it. The &lt;var&gt;resultCode&lt;/var&gt; will be * &#123;@link #RESULT_CANCELED&#125; if the activity explicitly returned that, * didn't return any result, or crashed during its operation. * * &lt;p&gt;You will receive this call immediately before onResume() when your * activity is re-starting. * * &lt;p&gt;This method is never invoked if your activity sets * &#123;@link android.R.styleable#AndroidManifestActivity_noHistory noHistory&#125; to * &lt;code&gt;true&lt;/code&gt;. * * @param requestCode The integer request code originally supplied to * startActivityForResult(), allowing you to identify who this * result came from. * @param resultCode The integer result code returned by the child activity * through its setResult(). * @param data An Intent, which can return result data to the caller * (various data can be attached to Intent \"extras\"). * * @see #startActivityForResult * @see #createPendingResult * @see #setResult(int) */protected void onActivityResult(int requestCode, int resultCode, Intent data) &#123;&#125; &#160; &#160; &#160; &#160;ä»ä¸Šé¢çš„æºç æ³¨é‡Šç¬¬äºŒæ®µå¯ä»¥çœ‹åˆ°ï¼šYou will receive this call immediately before onResume() when your activity is re-starting. æ‰€ä»¥å¾ˆæ˜æ˜¾ï¼Œåœ¨activityé‡æ–°æ¢å¤å¯åŠ¨çš„æ—¶å€™ï¼ŒonActivityResult()ä¼šåœ¨onResume()ä¹‹å‰è°ƒç”¨å®Œæ¯•ã€‚ &#160; &#160; &#160; &#160;è€Œä¸”ï¼ŒonActivityResult()è¿˜ä¼šåœ¨onStart()ä¹‹å‰è°ƒç”¨å®Œæ¯•ã€‚ç»è¿‡æ–­ç‚¹è°ƒè¯•ï¼Œå‘ç°å®ƒä»¬ä¸‰è€…çš„è°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼š onActivityResult() -&gt; onStart() -&gt; onResume()","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘å¦‚ä½•å¯åŠ¨è°ƒç”¨å…¶ä»–appä¸­çš„Activity","slug":"ã€Androidã€‘å¦‚ä½•å¯åŠ¨è°ƒç”¨å…¶ä»–appä¸­çš„Activity","date":"2015-09-15T03:06:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2015/09/15/ã€Androidã€‘å¦‚ä½•å¯åŠ¨è°ƒç”¨å…¶ä»–appä¸­çš„Activity/","link":"","permalink":"http://github.com/2015/09/15/ã€Androidã€‘å¦‚ä½•å¯åŠ¨è°ƒç”¨å…¶ä»–appä¸­çš„Activity/","excerpt":"æœ€è¿‘é¡¹ç›®æ­£åœ¨å°†åŸç³»ç»Ÿæ‹†åˆ†ä¸ºå°å‹Appï¼Œæ‰€ä»¥éœ€è¦åœ¨åŸProjectä¸­å¯åŠ¨å¦ä¸€ä¸ªæ–°çš„Appä¸­çš„Activityã€‚è¿™æ ·çš„è¯å¯åŠ¨è¦ç”¨åˆ°ComponentName ï¼Œå®ƒå°±æ˜¯ç”¨æ¥æ‰“å¼€å…¶ä»–åº”ç”¨ç¨‹åºä¸­çš„Activityæˆ–æœåŠ¡çš„ã€‚ ç”¨æ³•å…¶å®å¾ˆç®€å•ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š 123456//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Activityæ‰€åœ¨çš„packageåŒ…åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å®Œæ•´çš„Classç±»åï¼ˆåŒ…æ‹¬åŒ…è·¯å¾„ï¼‰ComponentName componetName = new ComponentName(\"com.cybo3d.cybox.miya\", \"com.cybo3d.cybox.miya.MainActivity\");Intent intent = new Intent();intent.setComponent(componetName);startActivity(intent);","text":"æœ€è¿‘é¡¹ç›®æ­£åœ¨å°†åŸç³»ç»Ÿæ‹†åˆ†ä¸ºå°å‹Appï¼Œæ‰€ä»¥éœ€è¦åœ¨åŸProjectä¸­å¯åŠ¨å¦ä¸€ä¸ªæ–°çš„Appä¸­çš„Activityã€‚è¿™æ ·çš„è¯å¯åŠ¨è¦ç”¨åˆ°ComponentName ï¼Œå®ƒå°±æ˜¯ç”¨æ¥æ‰“å¼€å…¶ä»–åº”ç”¨ç¨‹åºä¸­çš„Activityæˆ–æœåŠ¡çš„ã€‚ ç”¨æ³•å…¶å®å¾ˆç®€å•ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š 123456//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Activityæ‰€åœ¨çš„packageåŒ…åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å®Œæ•´çš„Classç±»åï¼ˆåŒ…æ‹¬åŒ…è·¯å¾„ï¼‰ComponentName componetName = new ComponentName(\"com.cybo3d.cybox.miya\", \"com.cybo3d.cybox.miya.MainActivity\");Intent intent = new Intent();intent.setComponent(componetName);startActivity(intent); æˆ‘ä»¬æ¥çœ‹æºç ä¸­ComponentNameçš„å‚æ•°ä¿¡æ¯ï¼Œpkgå’Œclså‡ä¸èƒ½ä¸ºnullã€‚æ­¤å¤„ç‰¹åˆ«æ³¨æ„ç¬¬äºŒä¸ªå‚æ•°clså¿…é¡»ä¸º å®Œæ•´çš„Classç±»åã€‚ 1234567891011121314/** * Create a new component identifier. * * @param pkg The name of the package that the component exists in. Can * not be null. * @param cls The name of the class inside of &lt;var&gt;pkg&lt;/var&gt; that * implements the component. Can not be null. */ public ComponentName(String pkg, String cls) &#123; if (pkg == null) throw new NullPointerException(\"package name is null\"); if (cls == null) throw new NullPointerException(\"class name is null\"); mPackage = pkg; mClass = cls; &#125; å¦å¤–ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™ä¸€å®šè¦ä¿è¯åœ¨Manifest.xmlä¸­è®¾ç½®è¢«å¯åŠ¨Activityçš„exported=trueï¼Œå¦åˆ™ä¼šæŠ¥é”™Activity is not found.","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Androidã€‘ä¿å­˜å›¾ç‰‡åˆ°ç³»ç»Ÿå›¾åº“, å¹¶ç«‹å³æ˜¾ç¤ºåœ¨å›¾åº“ä¸­","slug":"ã€Androidã€‘ä¿å­˜å›¾ç‰‡åˆ°ç³»ç»Ÿå›¾åº“, å¹¶ç«‹å³æ˜¾ç¤ºåœ¨å›¾åº“ä¸­","date":"2014-09-12T03:55:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2014/09/12/ã€Androidã€‘ä¿å­˜å›¾ç‰‡åˆ°ç³»ç»Ÿå›¾åº“, å¹¶ç«‹å³æ˜¾ç¤ºåœ¨å›¾åº“ä¸­/","link":"","permalink":"http://github.com/2014/09/12/ã€Androidã€‘ä¿å­˜å›¾ç‰‡åˆ°ç³»ç»Ÿå›¾åº“, å¹¶ç«‹å³æ˜¾ç¤ºåœ¨å›¾åº“ä¸­/","excerpt":"æ¬è¿åŸé“¾æ¥ï¼šhttp://stormzhang.github.io/android/2014/07/24/android-save-image-to-gallery æ­£æ–‡æœ€è¿‘æœ‰äº›ç”¨æˆ·åæ˜ ä¿å­˜å›¾ç‰‡ä¹‹ååœ¨ç³»ç»Ÿå›¾åº“æ‰¾ä¸åˆ°ä¿å­˜çš„å›¾ç‰‡ï¼Œé‚å†³å®šå½»åº•æŸ¥çœ‹å¹¶è§£å†³ä¸‹ã€‚ Androidä¸­ä¿å­˜å›¾ç‰‡çš„æ–¹æ³•å¯èƒ½æœ‰å¦‚ä¸‹ä¸¤ç§ï¼š ç¬¬ä¸€ç§æ˜¯è‡ªå·±å†™æ–¹æ³•ï¼Œå¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718public static File saveImage(Bitmap bmp) &#123; File appDir = new File(Environment.getExternalStorageDirectory(), \"Boohee\"); if (!appDir.exists()) &#123; appDir.mkdir(); &#125; String fileName = System.currentTimeMillis() + \".jpg\"; File file = new File(appDir, fileName); try &#123; FileOutputStream fos = new FileOutputStream(file); bmp.compress(CompressFormat.JPEG, 100, fos); fos.flush(); fos.close(); &#125; catch (FileNotFoundException e) &#123; e.printStackTrace(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125;&#125;","text":"æ¬è¿åŸé“¾æ¥ï¼šhttp://stormzhang.github.io/android/2014/07/24/android-save-image-to-gallery æ­£æ–‡æœ€è¿‘æœ‰äº›ç”¨æˆ·åæ˜ ä¿å­˜å›¾ç‰‡ä¹‹ååœ¨ç³»ç»Ÿå›¾åº“æ‰¾ä¸åˆ°ä¿å­˜çš„å›¾ç‰‡ï¼Œé‚å†³å®šå½»åº•æŸ¥çœ‹å¹¶è§£å†³ä¸‹ã€‚ Androidä¸­ä¿å­˜å›¾ç‰‡çš„æ–¹æ³•å¯èƒ½æœ‰å¦‚ä¸‹ä¸¤ç§ï¼š ç¬¬ä¸€ç§æ˜¯è‡ªå·±å†™æ–¹æ³•ï¼Œå¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718public static File saveImage(Bitmap bmp) &#123; File appDir = new File(Environment.getExternalStorageDirectory(), \"Boohee\"); if (!appDir.exists()) &#123; appDir.mkdir(); &#125; String fileName = System.currentTimeMillis() + \".jpg\"; File file = new File(appDir, fileName); try &#123; FileOutputStream fos = new FileOutputStream(file); bmp.compress(CompressFormat.JPEG, 100, fos); fos.flush(); fos.close(); &#125; catch (FileNotFoundException e) &#123; e.printStackTrace(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125;&#125; ä»¥ä¸Šä»£ç ä¾¿æ˜¯å°†Bitmapä¿å­˜å›¾ç‰‡åˆ°æŒ‡å®šçš„è·¯å¾„/sdcard/Boohee/ä¸‹ï¼Œæ–‡ä»¶åä»¥å½“å‰ç³»ç»Ÿæ—¶é—´å‘½å,ä½†æ˜¯è¿™ç§æ–¹æ³•ä¿å­˜çš„å›¾ç‰‡æ²¡æœ‰åŠ å…¥åˆ°ç³»ç»Ÿå›¾åº“ä¸­ ç¬¬äºŒç§æ˜¯è°ƒç”¨ç³»ç»Ÿæä¾›çš„æ’å…¥å›¾åº“çš„æ–¹æ³•ï¼š 1MediaStore.Images.Media.insertImage(getContentResolver(), bitmap, \"title\", \"description\"); è°ƒç”¨ä»¥ä¸Šç³»ç»Ÿè‡ªå¸¦çš„æ–¹æ³•ä¼šæŠŠbitmapå¯¹è±¡ä¿å­˜åˆ°ç³»ç»Ÿå›¾åº“ä¸­ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•æ— æ³•æŒ‡å®šä¿å­˜çš„è·¯å¾„å’Œåç§°ï¼Œä¸Šè¿°æ–¹æ³•çš„titleã€descriptionå‚æ•°åªæ˜¯æ’å…¥æ•°æ®åº“ä¸­çš„å­—æ®µï¼ŒçœŸå®çš„å›¾ç‰‡åç§°ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†é…ã€‚ çœ‹ä¼¼ä¸Šè¿°ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯æˆ‘ä»¬è¦ç”¨åˆ°çš„æ–¹æ³•ï¼Œä½†æ˜¯å¯æƒœçš„è°ƒç”¨ä¸Šè¿°ç¬¬äºŒç§æ’å…¥å›¾åº“çš„æ–¹æ³•å›¾ç‰‡å¹¶æ²¡æœ‰ç«‹åˆ»æ˜¾ç¤ºåœ¨å›¾åº“ä¸­ï¼Œè€Œæˆ‘ä»¬éœ€è¦ç«‹åˆ»æ›´æ–°ç³»ç»Ÿå›¾åº“ä»¥ä¾¿è®©ç”¨æˆ·å¯ä»¥ç«‹åˆ»æŸ¥çœ‹åˆ°è¿™å¼ å›¾ç‰‡ã€‚ æ›´æ–°ç³»ç»Ÿå›¾åº“çš„æ–¹æ³•1sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse(\"file://\"+ Environment.getExternalStorageDirectory()))); ä¸Šé¢é‚£æ¡å¹¿æ’­æ˜¯æ‰«ææ•´ä¸ªsdå¡çš„å¹¿æ’­ï¼Œå¦‚æœä½ sdå¡é‡Œé¢ä¸œè¥¿å¾ˆå¤šä¼šæ‰«æå¾ˆä¹…ï¼Œåœ¨æ‰«æå½“ä¸­æˆ‘ä»¬æ˜¯ä¸èƒ½è®¿é—®sdå¡ï¼Œæ‰€ä»¥è¿™æ ·å­ç”¨æˆ·ä½“ç°å¾ˆä¸å¥½ï¼Œæ‰€ä»¥ä¸‹é¢æˆ‘ä»¬è¿˜æœ‰å¦‚ä¸‹çš„æ–¹æ³•ï¼š 1sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE, Uri.fromFile(new File(\"/sdcard/Boohee/image.jpg\")));); æˆ–è€…è¿˜æœ‰å¦‚ä¸‹æ–¹æ³•ï¼š 123456789final MediaScannerConnection msc = new MediaScannerConnection(mContext, new MediaScannerConnectionClient() &#123; public void onMediaScannerConnected() &#123; msc.scanFile(\"/sdcard/Boohee/image.jpg\", \"image/jpeg\"); &#125; public void onScanCompleted(String path, Uri uri) &#123; Log.v(TAG, \"scan completed\"); msc.disconnect(); &#125; &#125;); ä¸Šé¢ä»£ç çš„å›¾ç‰‡è·¯å¾„ä¸ç®¡æ˜¯é€šè¿‡è‡ªå·±å†™æ–¹æ³•è¿˜æ˜¯ç³»ç»Ÿæ’å…¥å›¾åº“çš„æ–¹æ³•éƒ½å¯ä»¥å¾ˆå®¹æ˜“çš„è·å–åˆ°ã€‚ ç»ˆæå®Œç¾è§£å†³æ–¹æ¡ˆé‚£ä¹ˆåˆ°è¿™é‡Œå¯èƒ½æœ‰äººåˆä¼šé—®äº†ï¼Œå¦‚æœæˆ‘æƒ³æŠŠå›¾ç‰‡ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶å¤¹ï¼ŒåŒæ—¶åˆéœ€è¦å›¾ç‰‡å‡ºç°åœ¨å›¾åº“é‡Œå‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œsdkè¿˜æä¾›äº†è¿™æ ·ä¸€ä¸ªæ–¹æ³•: 1MediaStore.Images.Media.insertImage(getContentResolver(), \"image path\", \"title\", \"description\"); ä¸Šè¿°æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯image pathï¼Œè¿™æ ·çš„è¯å°±æœ‰æ€è·¯äº†ï¼Œé¦–å…ˆè‡ªå·±å†™æ–¹æ³•æŠŠå›¾ç‰‡æŒ‡å®šåˆ°æŒ‡å®šçš„æ–‡ä»¶å¤¹ï¼Œç„¶åè°ƒç”¨ä¸Šè¿°æ–¹æ³•æŠŠåˆšä¿å­˜çš„å›¾ç‰‡è·¯å¾„ä¼ å…¥è¿›å»ï¼Œæœ€åé€šçŸ¥å›¾åº“æ›´æ–°ã€‚ æ‰€ä»¥å†™äº†ä¸€ä¸ªæ–¹æ³•ï¼Œå®Œæ•´çš„ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829public static void saveImageToGallery(Context context, Bitmap bmp) &#123; // é¦–å…ˆä¿å­˜å›¾ç‰‡ File appDir = new File(Environment.getExternalStorageDirectory(), \"Boohee\"); if (!appDir.exists()) &#123; appDir.mkdir(); &#125; String fileName = System.currentTimeMillis() + \".jpg\"; File file = new File(appDir, fileName); try &#123; FileOutputStream fos = new FileOutputStream(file); bmp.compress(CompressFormat.JPEG, 100, fos); fos.flush(); fos.close(); &#125; catch (FileNotFoundException e) &#123; e.printStackTrace(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; // å…¶æ¬¡æŠŠæ–‡ä»¶æ’å…¥åˆ°ç³»ç»Ÿå›¾åº“ try &#123; MediaStore.Images.Media.insertImage(context.getContentResolver(), file.getAbsolutePath(), fileName, null); &#125; catch (FileNotFoundException e) &#123; e.printStackTrace(); &#125; // æœ€åé€šçŸ¥å›¾åº“æ›´æ–° context.sendBroadcast(new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE, Uri.parse(\"file://\" + path)));&#125;","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"å¦‚ä½•åˆ é™¤å¤šè¡Œé¦–å­—æ¯ï¼ŒSublime Textå¤šè¡Œç¼–è¾‘è¿ç”¨","slug":"å¦‚ä½•åˆ é™¤å¤šè¡Œé¦–å­—æ¯ï¼ŒSublime Textå¤šè¡Œç¼–è¾‘è¿ç”¨","date":"2014-05-15T03:55:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2014/05/15/å¦‚ä½•åˆ é™¤å¤šè¡Œé¦–å­—æ¯ï¼ŒSublime Textå¤šè¡Œç¼–è¾‘è¿ç”¨/","link":"","permalink":"http://github.com/2014/05/15/å¦‚ä½•åˆ é™¤å¤šè¡Œé¦–å­—æ¯ï¼ŒSublime Textå¤šè¡Œç¼–è¾‘è¿ç”¨/","excerpt":"ä¸€ã€é—®é¢˜æè¿°ï¼šé—®ç­”åŒºæœ‰ä¸ªé—®é¢˜æ˜¯è¿™æ ·é—®çš„ï¼šå¦‚ä½•åœ¨eclipseä¸­åˆ é™¤å¤šè¡Œé¦–å­—æ¯ï¼Ÿ é¢˜ä¸»çš„é—®é¢˜æ˜¯ä»£ç ä¸­æ¯è¡Œéƒ½æœ‰åºå·ï¼Œè¿™äº›åºå·ä¸€è¡Œä¸€è¡Œåœ°åˆ å¤ªéº»çƒ¦ï¼Œå¦‚ä½•è¿›è¡Œæ‰¹é‡åˆ é™¤ï¼Ÿæˆ‘ä»¬åœ¨è¿›è¡Œä»£ç é‡ç”¨çš„æ—¶å€™æ—¶å¸¸ä¼šå‡ºç°è¡Œå·åŒæ—¶è¢«å¤åˆ¶çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸‹é¢çš„è¿™ç‚¹ä»£ç ï¼š 12345678910111213141516171819202122232425262728155. @Override 156. public boolean onKeyDown(int keyCode, KeyEvent event) 157. &#123; 158. Log.d(\"onKeyDown:\", \" keyCode=\" + keyCode + \" KeyEvent=\" + event); 159. switch (keyCode) 160. &#123; 161. case KeyEvent.KEYCODE_DPAD_UP: 162. 163. break; 164. case KeyEvent.KEYCODE_DPAD_DOWN: 165. 166. break; 167. case KeyEvent.KEYCODE_DPAD_LEFT: 168. //å³å·¦æŒ‰é”®å¯ä»¥æ§åˆ¶ç¬¬ä¸€è¿›åº¦çš„å¢å‡ 169. pb.setProgress( pb.getProgress()-5 ); 170. break; 171. case KeyEvent.KEYCODE_DPAD_RIGHT: 172. pb.setProgress( pb.getProgress()+5 ); 173. break; 174. case KeyEvent.KEYCODE_DPAD_CENTER: 175. 176. break; 177. case KeyEvent.KEYCODE_0: 178. break; 179. &#125; 180. return super.onKeyDown(keyCode, event); 181. &#125; 182. &#125;","text":"ä¸€ã€é—®é¢˜æè¿°ï¼šé—®ç­”åŒºæœ‰ä¸ªé—®é¢˜æ˜¯è¿™æ ·é—®çš„ï¼šå¦‚ä½•åœ¨eclipseä¸­åˆ é™¤å¤šè¡Œé¦–å­—æ¯ï¼Ÿ é¢˜ä¸»çš„é—®é¢˜æ˜¯ä»£ç ä¸­æ¯è¡Œéƒ½æœ‰åºå·ï¼Œè¿™äº›åºå·ä¸€è¡Œä¸€è¡Œåœ°åˆ å¤ªéº»çƒ¦ï¼Œå¦‚ä½•è¿›è¡Œæ‰¹é‡åˆ é™¤ï¼Ÿæˆ‘ä»¬åœ¨è¿›è¡Œä»£ç é‡ç”¨çš„æ—¶å€™æ—¶å¸¸ä¼šå‡ºç°è¡Œå·åŒæ—¶è¢«å¤åˆ¶çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸‹é¢çš„è¿™ç‚¹ä»£ç ï¼š 12345678910111213141516171819202122232425262728155. @Override 156. public boolean onKeyDown(int keyCode, KeyEvent event) 157. &#123; 158. Log.d(\"onKeyDown:\", \" keyCode=\" + keyCode + \" KeyEvent=\" + event); 159. switch (keyCode) 160. &#123; 161. case KeyEvent.KEYCODE_DPAD_UP: 162. 163. break; 164. case KeyEvent.KEYCODE_DPAD_DOWN: 165. 166. break; 167. case KeyEvent.KEYCODE_DPAD_LEFT: 168. //å³å·¦æŒ‰é”®å¯ä»¥æ§åˆ¶ç¬¬ä¸€è¿›åº¦çš„å¢å‡ 169. pb.setProgress( pb.getProgress()-5 ); 170. break; 171. case KeyEvent.KEYCODE_DPAD_RIGHT: 172. pb.setProgress( pb.getProgress()+5 ); 173. break; 174. case KeyEvent.KEYCODE_DPAD_CENTER: 175. 176. break; 177. case KeyEvent.KEYCODE_0: 178. break; 179. &#125; 180. return super.onKeyDown(keyCode, event); 181. &#125; 182. &#125; è¿™æ˜¯åšä¸»ä»åˆ«å¤„æ‘˜æ¥çš„ä»£ç ç²˜è´´åœ¨Eclipseä¸­çš„ï¼Œå¾ˆæ˜æ˜¾è¡Œå·ä¹Ÿè¢«å¤åˆ¶äº†è¿›æ¥ã€‚ å¯¹äºè¿™æ ·çš„é—®é¢˜ï¼Œå¦‚æœä»£ç è¡Œæ•°çœŸçš„å¤šåˆ°å¯ä»¥ç”¨æ¥æ•°ç»µç¾Šäº†ï¼Œè¿˜ç”¨Deleteé”®ä¸€è¡Œä¸€è¡Œåœ°è§£å†³å¯çœŸå°±è½»è€Œæ˜“ä¸¾åœ°æŠ‘éƒäº†å“­ #å…¶å®æˆ‘æœ‰ç‰¹åˆ«çš„æ‚£æŠ‘éƒç—‡æŠ€å·§# äºŒã€è§£å†³åŠæ³•ï¼šè§£å†³åŠæ³•å°±æ˜¯åˆ©ç”¨Sublime Textçš„å¤šè¡Œç¼–è¾‘åŠŸèƒ½åˆ é™¤æ‰è¡Œé¦–çš„åºå·ã€‚åœ¨Sublime Textä¸­æ‰“å¼€æˆ–è€…ç²˜è´´ä½ æƒ³æ¸…ç†çš„ä»£ç ï¼Œç„¶åé€‰ä¸­æ‰€æœ‰è¡Œ é€‰ä¸­éœ€è¦æ¸…ç†çš„æ‰€æœ‰è¡Œ æŒ‰ä¸‹Ctrl + Shift + Lï¼ˆCommand + Shift + Lï¼‰â€”â€”â€” å¯ä»¥åŒæ—¶ç¼–è¾‘è¿™äº›è¡Œ ç”¨å·¦å³æ–¹å‘é”®æŠŠå…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦–ï¼Œç„¶åæŒ‰ä¸‹ Deleteé”® æˆ–è€… Backspaceé€€æ ¼é”® æ¥åˆ é™¤è¡Œå·ã€‚","categories":[],"tags":[],"keywords":[]},{"title":"Ubuntuä¸ŠEclipseè¯†åˆ«ä¸äº†Androidæ‰‹æœºçš„è§£å†³æ–¹æ³•","slug":"Ubuntuä¸ŠEclipseè¯†åˆ«ä¸äº†Androidæ‰‹æœºçš„è§£å†³æ–¹æ³•","date":"2013-10-20T08:46:00.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2013/10/20/Ubuntuä¸ŠEclipseè¯†åˆ«ä¸äº†Androidæ‰‹æœºçš„è§£å†³æ–¹æ³•/","link":"","permalink":"http://github.com/2013/10/20/Ubuntuä¸ŠEclipseè¯†åˆ«ä¸äº†Androidæ‰‹æœºçš„è§£å†³æ–¹æ³•/","excerpt":"è½¬è½½é“¾æ¥ï¼š http://www.cnblogs.com/AndroidManifest/archive/2011/12/09/2281635.html googleå®˜æ–¹å¼€å‘å‘å¯¼é‡Œå¯¹Androidæ‰‹æœºå·²ç»è®¾ç½®äº†å…è®¸å®‰è£…émarketç¨‹åºï¼Œå¹¶ä¸”å¤„äºusbè°ƒè¯•æ¨¡å¼ï¼Œä½†æ˜¯ä»ç„¶åœ¨usbè¿æ¥ç”µè„‘åæ— æ³•è¢«è¯†åˆ«çš„é—®é¢˜ä½œäº†è§£é‡Šã€‚å®˜æ–¹ç½‘å€ï¼šhttp://developer.android.com/guide/developing/device.html æ“ä½œæ­¥éª¤ï¼šå¦‚æœæ˜¯windowså¹³å°ä¸‹ï¼Œéœ€è¦å®‰è£…ä¸€ä¸ªä¸ºadbå‡†å¤‡çš„usbé©±åŠ¨ã€‚å¦‚æœæ˜¯Ubuntu Linuxéœ€è¦æ·»åŠ ä¸€ä¸ªrulesæ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†æ¯ä¸€ä¸ªæƒ³è¦è°ƒè¯•çš„è®¾å¤‡çš„usbé…ç½®ä¿¡æ¯ã€‚ä»¥HTCæ‰‹æœºä¸ºä¾‹å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š 1ã€åœ¨ç»ˆç«¯è¾“å…¥ : 1sudo gedit /etc/udev/rules.d/51-android.rules","text":"è½¬è½½é“¾æ¥ï¼š http://www.cnblogs.com/AndroidManifest/archive/2011/12/09/2281635.html googleå®˜æ–¹å¼€å‘å‘å¯¼é‡Œå¯¹Androidæ‰‹æœºå·²ç»è®¾ç½®äº†å…è®¸å®‰è£…émarketç¨‹åºï¼Œå¹¶ä¸”å¤„äºusbè°ƒè¯•æ¨¡å¼ï¼Œä½†æ˜¯ä»ç„¶åœ¨usbè¿æ¥ç”µè„‘åæ— æ³•è¢«è¯†åˆ«çš„é—®é¢˜ä½œäº†è§£é‡Šã€‚å®˜æ–¹ç½‘å€ï¼šhttp://developer.android.com/guide/developing/device.html æ“ä½œæ­¥éª¤ï¼šå¦‚æœæ˜¯windowså¹³å°ä¸‹ï¼Œéœ€è¦å®‰è£…ä¸€ä¸ªä¸ºadbå‡†å¤‡çš„usbé©±åŠ¨ã€‚å¦‚æœæ˜¯Ubuntu Linuxéœ€è¦æ·»åŠ ä¸€ä¸ªrulesæ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†æ¯ä¸€ä¸ªæƒ³è¦è°ƒè¯•çš„è®¾å¤‡çš„usbé…ç½®ä¿¡æ¯ã€‚ä»¥HTCæ‰‹æœºä¸ºä¾‹å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š 1ã€åœ¨ç»ˆç«¯è¾“å…¥ : 1sudo gedit /etc/udev/rules.d/51-android.rules 2ã€åœ¨æ‰“å¼€çš„æ–‡ä»¶é‡ŒåŠ å…¥ SUBSYSTEM==&quot;usb&quot;, ATTR{idVendor}==&quot;0bb4&quot;, MODE=&quot;0666&quot; 3ã€ä¿å­˜é€€å‡ºååœ¨ç»ˆç«¯æ‰§è¡Œ : 1sudo chmod a+r /etc/udev/rules.d/51-android.rules é‡æ–°å°†æ‰‹æœºè¿æ¥åˆ°ç”µè„‘åHTCæ‰‹æœºå°±å¯ä»¥è¢«æ­£å¸¸è¯†åˆ«äº†ã€‚æ³¨æ„ï¼šå¦‚æœæŒ‰æ­¥éª¤æ“ä½œä»ä¸èƒ½è¯†åˆ«çš„ï¼Œæ£€æŸ¥ ATTR{idVendor} å€¼é‡Œçš„å­—æ¯æ˜¯å¦æ˜¯å°å†™ã€‚ å¦‚æœæ˜¯åˆ«çš„å‚å®¶çš„æ‰‹æœºï¼Œéœ€è¦åœ¨æ­¥éª¤2æ›´æ”¹ATTR{idVendor}çš„å€¼ã€‚å¦‚æœè¦æ·»åŠ å¤šä¸ªå‚å®¶çš„æ‰‹æœºï¼Œé‡å¤æ­¥éª¤2ã€‚å…¶ä»–usbä¾›åº”å•†çš„IDå¦‚ä¸‹ï¼š Company USB Vendor ID Acer 0502 ASUS 0B05 Dell 413C Foxconn 0489 Garmin-Asus 091E Google 18D1 HTC 0BB4 Huawei 12D1 K-Touch 24E3 KT Tech 2116 Kyocera 0482 Lenevo 17EF LG 1004 Motorola 22B8 NEC 0409 Nook 2080 Nvidia 0955 OTGV 2257 Pantech 10A9 Pegatron 1D4D Philips 0471 PMC-Sierra 04DA Qualcomm 05C6 SK Telesys 1F53 Samsung 04E8 Sharp 04DD Sony Ericsson 0FCE Toshiba 0930 ZTE 19D2 æ³¨æ„ï¼šå¦‚æœæŒ‰æ­¥éª¤æ“ä½œä»ä¸èƒ½è¯†åˆ«çš„ï¼Œæ£€æŸ¥ ATTR{idVendor} å€¼é‡Œçš„å­—æ¯æ˜¯å¦æ˜¯å°å†™ã€‚","categories":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://github.com/tags/Android/"}],"keywords":[{"name":"Android","slug":"Android","permalink":"http://github.com/categories/Android/"}]},{"title":"ã€Javaã€‘æ“ä½œexcelè¡¨ï¼ŒåŒ…æ‹¬åˆ›å»ºã€è¯»å–ã€ä»¥åŠä¿®æ”¹","slug":"ã€Javaã€‘æ“ä½œexcelè¡¨ï¼ŒåŒ…æ‹¬åˆ›å»ºã€è¯»å–ã€ä»¥åŠä¿®æ”¹","date":"2013-08-01T04:31:20.000Z","updated":"2018-03-14T08:13:59.000Z","comments":true,"path":"2013/08/01/ã€Javaã€‘æ“ä½œexcelè¡¨ï¼ŒåŒ…æ‹¬åˆ›å»ºã€è¯»å–ã€ä»¥åŠä¿®æ”¹/","link":"","permalink":"http://github.com/2013/08/01/ã€Javaã€‘æ“ä½œexcelè¡¨ï¼ŒåŒ…æ‹¬åˆ›å»ºã€è¯»å–ã€ä»¥åŠä¿®æ”¹/","excerpt":"ä½œè€…çš„ç½‘ç«™ä¸Šå¯¹å®ƒçš„ç‰¹å¾æœ‰å¦‚ä¸‹æè¿°ï¼š æ”¯æŒExcel 95-2000çš„æ‰€æœ‰ç‰ˆæœ¬ ç”ŸæˆExcel 2000æ ‡å‡†æ ¼å¼ æ”¯æŒå­—ä½“ã€æ•°å­—ã€æ—¥æœŸæ“ä½œ èƒ½å¤Ÿä¿®é¥°å•å…ƒæ ¼å±æ€§ æ”¯æŒå›¾åƒå’Œå›¾è¡¨ åº”è¯¥è¯´ä»¥ä¸ŠåŠŸèƒ½å·²ç»èƒ½å¤Ÿå¤§è‡´æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦ã€‚æœ€å…³é”®çš„æ˜¯è¿™å¥—APIæ˜¯çº¯Javaçš„ï¼Œå¹¶ä¸ä¾èµ–Windowsç³»ç»Ÿï¼Œå³ä½¿è¿è¡Œåœ¨Linuxä¸‹ï¼Œå®ƒåŒæ ·èƒ½å¤Ÿæ­£ç¡®çš„å¤„ç†Excelæ–‡ä»¶ã€‚å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™å¥—APIå¯¹å›¾å½¢å’Œå›¾è¡¨çš„æ”¯æŒå¾ˆæœ‰é™ï¼Œè€Œä¸”ä»…ä»…è¯†åˆ«PNGæ ¼å¼ã€‚ æ­å»ºç¯å¢ƒä¸‹è½½jxl.jarï¼ˆå¯ä»¥ç‚¹å‡»è¿™é‡Œè¿›è¡Œä¸‹è½½ï¼‰ï¼Œæ”¾å…¥classpathï¼Œå®‰è£…å°±å®Œæˆäº†ã€‚","text":"ä½œè€…çš„ç½‘ç«™ä¸Šå¯¹å®ƒçš„ç‰¹å¾æœ‰å¦‚ä¸‹æè¿°ï¼š æ”¯æŒExcel 95-2000çš„æ‰€æœ‰ç‰ˆæœ¬ ç”ŸæˆExcel 2000æ ‡å‡†æ ¼å¼ æ”¯æŒå­—ä½“ã€æ•°å­—ã€æ—¥æœŸæ“ä½œ èƒ½å¤Ÿä¿®é¥°å•å…ƒæ ¼å±æ€§ æ”¯æŒå›¾åƒå’Œå›¾è¡¨ åº”è¯¥è¯´ä»¥ä¸ŠåŠŸèƒ½å·²ç»èƒ½å¤Ÿå¤§è‡´æ»¡è¶³æˆ‘ä»¬çš„éœ€è¦ã€‚æœ€å…³é”®çš„æ˜¯è¿™å¥—APIæ˜¯çº¯Javaçš„ï¼Œå¹¶ä¸ä¾èµ–Windowsç³»ç»Ÿï¼Œå³ä½¿è¿è¡Œåœ¨Linuxä¸‹ï¼Œå®ƒåŒæ ·èƒ½å¤Ÿæ­£ç¡®çš„å¤„ç†Excelæ–‡ä»¶ã€‚å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™å¥—APIå¯¹å›¾å½¢å’Œå›¾è¡¨çš„æ”¯æŒå¾ˆæœ‰é™ï¼Œè€Œä¸”ä»…ä»…è¯†åˆ«PNGæ ¼å¼ã€‚ æ­å»ºç¯å¢ƒä¸‹è½½jxl.jarï¼ˆå¯ä»¥ç‚¹å‡»è¿™é‡Œè¿›è¡Œä¸‹è½½ï¼‰ï¼Œæ”¾å…¥classpathï¼Œå®‰è£…å°±å®Œæˆäº†ã€‚ åŸºæœ¬æ“ä½œä¸€ã€åˆ›å»ºæ–‡ä»¶æ‹Ÿç”Ÿæˆä¸€ä¸ªåä¸ºâ€œæµ‹è¯•æ•°æ®.xlsâ€çš„Excelæ–‡ä»¶ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨è¢«å‘½åä¸ºâ€œç¬¬ä¸€é¡µâ€ã€‚ä»£ç ï¼ˆCreateXLS.javaï¼‰ï¼š 12345678910111213141516171819202122232425262728293031323334//ç”ŸæˆExcelçš„ç±» import java.io. * ;import jxl. * ;import jxl.write. * ;public class CreateXLS &#123; public static void main(String args[]) &#123; try &#123; //æ‰“å¼€æ–‡ä»¶ WritableWorkbook book = Workbook.createWorkbook(new File(â€œæµ‹è¯•.xlsâ€)); //ç”Ÿæˆåä¸ºâ€œç¬¬ä¸€é¡µâ€çš„å·¥ä½œè¡¨ï¼Œå‚æ•°0è¡¨ç¤ºè¿™æ˜¯ç¬¬ä¸€é¡µ WritableSheet sheet = book.createSheet(â€œç¬¬ä¸€é¡µâ€, 0); //åœ¨Labelå¯¹è±¡çš„æ„é€ å­ä¸­æŒ‡åå•å…ƒæ ¼ä½ç½®æ˜¯ç¬¬ä¸€åˆ—ç¬¬ä¸€è¡Œ(0,0) //ä»¥åŠå•å…ƒæ ¼å†…å®¹ä¸ºtest Label label = new Label(0, 0, â€testâ€); //å°†å®šä¹‰å¥½çš„å•å…ƒæ ¼æ·»åŠ åˆ°å·¥ä½œè¡¨ä¸­ sheet.addCell(label); /*ç”Ÿæˆä¸€ä¸ªä¿å­˜æ•°å­—çš„å•å…ƒæ ¼, å¿…é¡»ä½¿ç”¨Numberçš„å®Œæ•´åŒ…è·¯å¾„ï¼Œå¦åˆ™æœ‰è¯­æ³•æ­§ä¹‰ å•å…ƒæ ¼ä½ç½®æ˜¯ç¬¬äºŒåˆ—ï¼Œç¬¬ä¸€è¡Œï¼Œå€¼ä¸º789.123*/ jxl.write.Number number = new jxl.write.Number(1, 0, 789.123); sheet.addCell(number); //å†™å…¥æ•°æ®å¹¶å…³é—­æ–‡ä»¶ book.write(); book.close(); &#125; catch(Exception e) &#123; System.out.println(e); &#125; &#125;&#125; ç¼–è¯‘æ‰§è¡Œåï¼Œä¼šåœ¨å½“å‰ä½ç½®äº§ç”Ÿä¸€ä¸ªExcelæ–‡ä»¶ã€‚ äºŒã€è¯»å–æ–‡ä»¶ä»¥åˆšæ‰æˆ‘ä»¬åˆ›å»ºçš„Excelæ–‡ä»¶ä¸ºä¾‹ï¼Œåšä¸€ä¸ªç®€å•çš„è¯»å–æ“ä½œï¼Œç¨‹åºä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920//è¯»å–Excelçš„ç±» import java.io. * ;import jxl. * ;public class ReadXLS &#123; public static void main(String args[]) &#123; try &#123; Workbook book = Workbook.getWorkbook(new File(â€œæµ‹è¯•.xlsâ€)); //è·å¾—ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨å¯¹è±¡ Sheet sheet = book.getSheet(0); //å¾—åˆ°ç¬¬ä¸€åˆ—ç¬¬ä¸€è¡Œçš„å•å…ƒæ ¼ Cell cell1 = sheet.getCell(0, 0); String result = cell1.getContents(); System.out.println(result); book.close(); &#125; catch(Exception e) &#123; System.out.println(e); &#125; &#125;&#125; ä¸‰ã€ä¿®æ”¹æ–‡ä»¶åˆ©ç”¨jExcelAPIå¯ä»¥ä¿®æ”¹å·²æœ‰çš„Excelæ–‡ä»¶ï¼Œä¿®æ”¹Excelæ–‡ä»¶çš„æ—¶å€™ï¼Œé™¤äº†æ‰“å¼€æ–‡ä»¶çš„æ–¹å¼ä¸åŒä¹‹å¤–ï¼Œå…¶ä»–æ“ä½œå’Œåˆ›å»ºExcelæ˜¯ä¸€æ ·çš„ã€‚ä¸‹é¢çš„ä¾‹å­æ˜¯åœ¨æˆ‘ä»¬å·²ç»ç”Ÿæˆçš„Excelæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªå·¥ä½œè¡¨ï¼š 12345678910111213141516171819202122//ä¿®æ”¹Excelçš„ç±»ï¼Œæ·»åŠ ä¸€ä¸ªå·¥ä½œè¡¨ import java.io.*;import jxl.*;import jxl.write.*;public class UpdateXLS &#123; public static void main(String args[]) &#123; try &#123; //Excelè·å¾—æ–‡ä»¶ Workbook wb = Workbook.getWorkbook(new File(â€œæµ‹è¯•.xlsâ€)); //æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶çš„å‰¯æœ¬ï¼Œå¹¶ä¸”æŒ‡å®šæ•°æ®å†™å›åˆ°åŸæ–‡ä»¶ WritableWorkbook book = Workbook.createWorkbook(new File(â€œæµ‹è¯•.xlsâ€), wb); //æ·»åŠ ä¸€ä¸ªå·¥ä½œè¡¨ WritableSheet sheet = book.createSheet(â€œç¬¬äºŒé¡µâ€, 1); sheet.addCell(new Label(0, 0, â€ç¬¬äºŒé¡µçš„æµ‹è¯•æ•°æ®â€)); book.write(); book.close(); &#125; catch(Exception e) &#123; System.out.println(e); &#125; &#125;&#125; é«˜çº§æ“ä½œä¸€ã€ æ•°æ®æ ¼å¼åŒ–åœ¨Excelä¸­ä¸æ¶‰åŠå¤æ‚çš„æ•°æ®ç±»å‹ï¼Œèƒ½å¤Ÿæ¯”è¾ƒå¥½çš„å¤„ç†å­—ä¸²ã€æ•°å­—å’Œæ—¥æœŸå·²ç»èƒ½å¤Ÿæ»¡è¶³ä¸€èˆ¬çš„åº”ç”¨ã€‚ 1ã€ å­—ä¸²æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ ¼å¼åŒ–æ¶‰åŠåˆ°çš„æ˜¯å­—ä½“ã€ç²—ç»†ã€å­—å·ç­‰å…ƒç´ ï¼Œè¿™äº›åŠŸèƒ½ä¸»è¦ç”±WritableFontå’ŒWritableCellFormatç±»æ¥è´Ÿè´£ã€‚å‡è®¾æˆ‘ä»¬åœ¨ç”Ÿæˆä¸€ä¸ªå«æœ‰å­—ä¸²çš„å•å…ƒæ ¼æ—¶ï¼Œä½¿ç”¨å¦‚ä¸‹è¯­å¥ï¼Œä¸ºæ–¹ä¾¿å™è¿°ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸€è¡Œå‘½ä»¤åŠ äº†ç¼–å·ï¼š WritableFont font1=new WritableFont(WritableFont.TIMES,16,WritableFont.BOLD); æˆ–//è®¾ç½®å­—ä½“æ ¼å¼ä¸ºexcelæ”¯æŒçš„æ ¼å¼ WritableFont font3=new WritableFont(WritableFont.createFont(â€œæ¥·ä½“ _GB2312â€),12,WritableFont.NO_BOLD );â‘  WritableCellFormat format1=new WritableCellFormat(font1); â‘¡ Label label=new Label(0,0,â€data 4 testâ€,format1) â‘¢ å…¶ä¸­â‘ æŒ‡å®šäº†å­—ä¸²æ ¼å¼ï¼šå­—ä½“ä¸ºTIMESï¼Œå­—å·16ï¼ŒåŠ ç²—æ˜¾ç¤ºã€‚WritableFontæœ‰éå¸¸ä¸°å¯Œçš„æ„é€ å­ï¼Œä¾›ä¸åŒæƒ…å†µä¸‹ä½¿ç”¨ï¼ŒjExcelAPIçš„ java-docä¸­æœ‰è¯¦ç»†åˆ—è¡¨ï¼Œè¿™é‡Œä¸å†åˆ—å‡ºã€‚ â‘¡å¤„ä»£ç ä½¿ç”¨äº†WritableCellFormatç±»ï¼Œè¿™ä¸ªç±»éå¸¸é‡è¦ï¼Œé€šè¿‡å®ƒå¯ä»¥æŒ‡å®šå•å…ƒæ ¼çš„å„ç§å±æ€§ï¼Œåé¢çš„å•å…ƒæ ¼æ ¼å¼åŒ–ä¸­ä¼šæœ‰æ›´å¤šæè¿°ã€‚ â‘¢å¤„ä½¿ç”¨äº†Labelç±»çš„æ„é€ å­ï¼ŒæŒ‡å®šäº†å­—ä¸²è¢«èµ‹äºˆé‚£ç§æ ¼å¼ã€‚ åœ¨WritableCellFormatç±»ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ–¹æ³•æ˜¯æŒ‡å®šæ•°æ®çš„å¯¹é½æ–¹å¼ï¼Œæ¯”å¦‚é’ˆå¯¹æˆ‘ä»¬ä¸Šé¢çš„å®ä¾‹ï¼Œå¯ä»¥æŒ‡å®šï¼š 12345678//æŠŠæ°´å¹³å¯¹é½æ–¹å¼æŒ‡å®šä¸ºå±…ä¸­ format1.setAlignment(jxl.format.Alignment.CENTRE); //æŠŠå‚ç›´å¯¹é½æ–¹å¼æŒ‡å®šä¸ºå±…ä¸­ format1.setVerticalAlignment(jxl.format.VerticalAlignment.CENTRE);//è®¾ç½®è‡ªåŠ¨æ¢è¡Œformat1.setWrap(true); äºŒã€å•å…ƒæ ¼æ“ä½œExcelä¸­å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†æ˜¯å¯¹å•å…ƒæ ¼çš„æ“ä½œï¼Œæ¯”å¦‚è¡Œé«˜ã€åˆ—å®½ã€å•å…ƒæ ¼åˆå¹¶ç­‰ï¼Œæ‰€å¹¸jExcelAPIæä¾›äº†è¿™äº›æ”¯æŒã€‚è¿™äº›æ“ä½œç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œä¸‹é¢åªä»‹ç»ä¸€ä¸‹ç›¸å…³çš„APIã€‚ 1ã€ åˆå¹¶å•å…ƒæ ¼ WritableSheet.mergeCells(int m,int n,int p,int q);ä½œç”¨æ˜¯ä»(m,n)åˆ°(p,q)çš„å•å…ƒæ ¼å…¨éƒ¨åˆå¹¶ï¼Œæ¯”å¦‚ï¼š 123WritableSheet sheet=book.createSheet(â€œç¬¬ä¸€é¡µâ€,0); //åˆå¹¶ç¬¬ä¸€åˆ—ç¬¬ä¸€è¡Œåˆ°ç¬¬å…­åˆ—ç¬¬ä¸€è¡Œçš„æ‰€æœ‰å•å…ƒæ ¼ sheet.mergeCells(0,0,5,0); åˆå¹¶æ—¢å¯ä»¥æ˜¯æ¨ªå‘çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯çºµå‘çš„ã€‚åˆå¹¶åçš„å•å…ƒæ ¼ä¸èƒ½å†æ¬¡è¿›è¡Œåˆå¹¶ï¼Œå¦åˆ™ä¼šè§¦å‘å¼‚å¸¸ã€‚ 2ã€ è¡Œé«˜å’Œåˆ—å®½ WritableSheet.setRowView(int i,int height);ä½œç”¨æ˜¯æŒ‡å®šç¬¬i+1è¡Œçš„é«˜åº¦ï¼Œæ¯”å¦‚ï¼š 12//å°†ç¬¬ä¸€è¡Œçš„é«˜åº¦è®¾ä¸º200 sheet.setRowView(0,200); WritableSheet.setColumnView(int i,int width);ä½œç”¨æ˜¯æŒ‡å®šç¬¬i+1åˆ—çš„å®½åº¦ï¼Œæ¯”å¦‚ï¼š 12//å°†ç¬¬ä¸€åˆ—çš„å®½åº¦è®¾ä¸º30 sheet.setColumnView(0,30); ä¸‰ã€æ“ä½œå›¾ç‰‡123456789public static void write() throws Exception &#123; WritableWorkbook wwb = Workbook.createWorkbook(new File(\"c:/1.xls\")); WritableSheet ws = wwb.createSheet(\"Test Sheet 1\", 0); File file = new File(\"C:\\\\jbproject\\\\PVS\\\\WebRoot\\\\weekhit\\\\1109496996281.png\"); WritableImage image = new WritableImage(1, 4, 6, 18, file); ws.addImage(image); wwb.write(); wwb.close();&#125; å¾ˆç®€å•å’Œæ’å…¥å•å…ƒæ ¼çš„æ–¹å¼ä¸€æ ·ï¼Œä¸è¿‡å°±æ˜¯å‚æ•°å¤šäº†äº›ï¼ŒWritableImageè¿™ä¸ªç±»ç»§æ‰¿äº†Drawï¼Œä¸Šé¢åªæ˜¯ä»–æ„é€ æ–¹æ³•çš„ä¸€ç§ï¼Œæœ€åä¸€ä¸ªå‚æ•°ä¸ç”¨äº†è¯´ äº†ï¼Œå‰é¢å››ä¸ªå‚æ•°çš„ç±»å‹éƒ½æ˜¯doubleï¼Œä¾æ¬¡æ˜¯ x, y, width, height,æ³¨æ„ï¼Œè¿™é‡Œçš„å®½å’Œé«˜å¯ä¸æ˜¯å›¾ç‰‡çš„å®½å’Œé«˜ï¼Œè€Œæ˜¯å›¾ç‰‡æ‰€è¦å çš„å•ä½æ ¼çš„ä¸ªæ•°ï¼Œå› ä¸ºç»§æ‰¿çš„Drawæ‰€ä»¥ä»–çš„ç±»å‹å¿…é¡»æ˜¯doubleï¼Œå…·ä½“é‡Œé¢æ€ä¹ˆ å®ç°çš„æˆ‘è¿˜æ²¡ç»†çœ‹ï¼šï¼‰å› ä¸ºç€æ€¥èµ¶æ´»ï¼Œå…ˆå®ŒæˆåŠŸèƒ½ï¼Œå…¶ä»–çš„ä»¥åæœ‰æ—¶é—´æ…¢æ…¢ç ”ç©¶ã€‚ä»¥åä¼šç»§ç»­å†™å‡ºåœ¨ä½¿ç”¨ä¸­çš„å¿ƒå¾—ç»™å¤§å®¶ã€‚ æ€»ç»“1ã€è¯» è¯»çš„æ—¶å€™æ˜¯è¿™æ ·çš„ä¸€ä¸ªæ€è·¯,å…ˆç”¨ä¸€ä¸ªè¾“å…¥æµ(InputStream)å¾—åˆ°Excelæ–‡ä»¶,ç„¶åç”¨jxlä¸­çš„Workbookå¾—åˆ°å·¥ä½œè–„,ç”¨Sheetä»å·¥ä½œè–„ä¸­å¾—åˆ°å·¥ä½œè¡¨,ç”¨Cellå¾—åˆ°å·¥ä½œè¡¨ä¸­å¾—æŸä¸ªå•å…ƒæ ¼.InputStream-&gt;Workbook-&gt;Sheet-&gt;Cell,å°±å¾—åˆ°äº†excelæ–‡ä»¶ä¸­çš„å•å…ƒæ ¼ 12345678String path = \"c:\\\\excel.xls\"; //Excelæ–‡ä»¶URLInputStream is = new FileInputStream(path); //å†™å…¥åˆ°FileInputStreamjxl.Workbook wb = Workbook.getWorkbook(is); //å¾—åˆ°å·¥ä½œè–„ jxl.Sheet st = wb.getSheet(0); //å¾—åˆ°å·¥ä½œè–„ä¸­çš„ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨Cell cell = st.getCell(0, 0); //å¾—åˆ°å·¥ä½œè¡¨çš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼,å³A1String content = cell.getContents(); //getContents()å°†Cellä¸­çš„å­—ç¬¦è½¬ä¸ºå­—ç¬¦ä¸²wb.close(); //å…³é—­å·¥ä½œè–„is.close(); //å…³é—­è¾“å…¥æµ æˆ‘ä»¬å¯ä»¥é€šè¿‡Sheetçš„getCell(x,y)æ–¹æ³•å¾—åˆ°ä»»æ„ä¸€ä¸ªå•å…ƒæ ¼,x,yå’Œexcelä¸­çš„åæ ‡å¯¹åº”.ä¾‹å¦‚A1å¯¹åº”(0,0),A2å¯¹åº”(0,1),D3å¯¹åº”(3,2).Excelä¸­åæ ‡ä»A,1å¼€å§‹,jxlä¸­å…¨éƒ¨æ˜¯ä»0å¼€å§‹.è¿˜å¯ä»¥é€šè¿‡Sheetçš„getRows(),getColumns()æ–¹æ³•å¾—åˆ°è¡Œæ•°åˆ—æ•°,å¹¶ç”¨äºå¾ªç¯æ§åˆ¶,è¾“å‡ºä¸€ä¸ªsheetä¸­çš„æ‰€æœ‰å†…å®¹. 2ã€å†™ å¾€Excelä¸­å†™å…¥å†…å®¹ä¸»è¦æ˜¯ç”¨jxl.writeåŒ…ä¸­çš„ç±».æ€è·¯æ˜¯è¿™æ ·çš„:OutputStream&lt;-WritableWorkbook&lt;-WritableSheet&lt;-Labelè¿™é‡Œé¢Labelä»£è¡¨çš„æ˜¯å†™å…¥Sheetçš„Cellä½ç½®åŠå†…å®¹. 123456789101112131415OutputStream os = new FileOutputStream(\"c:\\\\test.xls\"); WritableWorkbook wwb = Workbook.createWorkbook(os); WritableSheet ws = wwb.createSheet(\"sheet1\", 0); //åˆ›å»ºå¯å†™å·¥ä½œè¡¨Label labelCF = new Label(0, 0, \"hello\"); //åˆ›å»ºå†™å…¥ä½ç½®å’Œå†…å®¹ws.addCell(labelCF); //å°†Labelå†™å…¥sheetä¸­//Labelçš„æ„é€ å‡½æ•°Label(int x, int y,String aString)xyæ„åŒè¯»çš„æ—¶å€™çš„xy,aStringæ˜¯å†™å…¥çš„å†…å®¹.WritableFont wf = new WritableFont(WritableFont.TIMES, 12, WritableFont.BOLD, false); //è®¾ç½®å†™å…¥å­—ä½“WritableCellFormat wcfF = new WritableCellFormat(wf); //è®¾ç½®CellFormatLabel labelCF = new Label(0, 0, \"hello\"); //åˆ›å»ºå†™å…¥ä½ç½®,å†…å®¹å’Œæ ¼å¼//Labelçš„å¦ä¸€æ„é€ å‡½æ•°Label(int c, int r, String cont, CellFormat st)å¯ä»¥å¯¹å†™å…¥å†…å®¹è¿›è¡Œæ ¼å¼åŒ–,è®¾ç½®å­—ä½“åŠå…¶å®ƒçš„å±æ€§. wwb.write();wwb.close();os.close; OK,åªè¦æŠŠè¯»å’Œå†™ç»“åˆèµ·æ¥,å°±å¯ä»¥åœ¨Nä¸ªExcelä¸­è¯»å–æ•°æ®å†™å…¥ä½ å¸Œæœ›çš„Excelæ–°è¡¨ä¸­,è¿˜æ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„. ä¸‹é¢æ˜¯ç¨‹åºä»£ç : 12345678910111213141516171819202122232425262728293031323334353637383940414243sql = \"select * from tablename\";rs = stmt.executeQuery(sql);//æ–°å»ºExcelæ–‡ä»¶String filePath = request.getRealPath(\"aaa.xls\");File myFilePath = new File(filePath);if (!myFilePath.exists()) myFilePath.createNewFile();FileWriter resultFile = new FileWriter(myFilePath);PrintWriter myFile = new PrintWriter(resultFile);resultFile.close();//ç”¨JXLå‘æ–°å»ºçš„æ–‡ä»¶ä¸­æ·»åŠ å†…å®¹OutputStream outf = new FileOutputStream(filePath);jxl.write.WritableWorkbook wwb = Workbook.createWorkbook(outf);jxl.write.WritableSheet ws = wwb.createSheet(\"sheettest\", 0);int i = 0;int j = 0;for (int k = 0; k &lt; rs.getMetaData().getColumnCount(); k++) &#123; ws.addCell(new Label(k, 0, rs.getMetaData().getColumnName(k + 1)));&#125;while (rs.next()) &#123; out.println(rs.getMetaData().getColumnCount()); for (int k = 0; k &lt; rs.getMetaData().getColumnCount(); k++) &#123; ws.addCell(new Label(k, j + i + 1, rs.getString(k + 1))); &#125; i++;&#125;wwb.write();wwb.close();&#125; catch(Exception e) &#123; e.printStackTrace();&#125; finally &#123; rs.close(); conn.close();&#125;response.sendRedirect(\"aaa.xls\");","categories":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}],"tags":[{"name":"Java","slug":"Java","permalink":"http://github.com/tags/Java/"}],"keywords":[{"name":"Java","slug":"Java","permalink":"http://github.com/categories/Java/"}]}]}